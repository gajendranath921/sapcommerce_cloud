/*! For license information please see smarteditcontainer.js.LICENSE.txt */
(function(e){function webpackJsonpCallback(t){var s=t[0];var a=t[1];var r=t[2];var p,m,g=0,u=[];for(;g<s.length;g++){m=s[g];if(Object.prototype.hasOwnProperty.call(o,m)&&o[m]){u.push(o[m][0])}o[m]=0}for(p in a){if(Object.prototype.hasOwnProperty.call(a,p)){e[p]=a[p]}}if(d)d(t);while(u.length){u.shift()()}n.push.apply(n,r||[]);return checkDeferredModules()}function checkDeferredModules(){var e;for(var t=0;t<n.length;t++){var s=n[t];var a=true;for(var r=1;r<s.length;r++){var d=s[r];if(o[d]!==0)a=false}if(a){n.splice(t--,1);e=__webpack_require__(__webpack_require__.s=s[0])}}return e}var t={};var o={0:0};var n=[];function __webpack_require__(o){if(t[o]){return t[o].exports}var n=t[o]={i:o,l:false,exports:{}};e[o].call(n.exports,n,n.exports,__webpack_require__);n.l=true;return n.exports}__webpack_require__.m=e;__webpack_require__.c=t;__webpack_require__.d=function(e,t,o){if(!__webpack_require__.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:o})}};__webpack_require__.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};__webpack_require__.t=function(e,t){if(t&1)e=__webpack_require__(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var o=Object.create(null);__webpack_require__.r(o);Object.defineProperty(o,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)__webpack_require__.d(o,n,function(t){return e[t]}.bind(null,n));return o};__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};__webpack_require__.d(t,"a",t);return t};__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};__webpack_require__.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[];var a=s.push.bind(s);s.push=webpackJsonpCallback;s=s.slice();for(var r=0;r<s.length;r++)webpackJsonpCallback(s[r]);var d=a;n.push([584,1]);return checkDeferredModules()})({182:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(0);var s=o(133);var a=o(274);var r=o(93);var d=o(86);var p=o(42);var m=o(46);var g=o(4);var u=o(197);var v=o(105);var f=o(136);var S=o(20);var C=o(3);var b=o(40);var I=o(556);var w=o(139);var E=o(13);function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(o){if(o!=="default"){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:true,get:function(){return e[o]}})}}))}t["default"]=e;return Object.freeze(t)}var T=_interopNamespace(r);var P=_interopDefaultLegacy(C);(function(){var e=e||window.angular;var t=null;try{t=e.module("coretemplates")}catch(e){}t=t||e.module("coretemplates",[]);t.run(["$templateCache",function(e){e.put("AnnouncementBoardComponent.html",'<ng-container *ngIf="(announcements$ | async) as announcements"><div class="se-announcement-board"><se-announcement *ngFor="                let announcement of (announcements | seReverse);                trackBy: annnouncementTrackBy;                let i = index            " id="se-announcement-{{ i }}" [announcement]="announcement"></se-announcement></div></ng-container>');e.put("AnnouncementComponent.html",'<div class="se-announcement-content"><span *ngIf="isCloseable()" class="sap-icon--decline se-announcement-close" (click)="closeAnnouncement()"></span><div *ngIf="hasMessage()"><h4 *ngIf="hasMessageTitle()">{{ announcement.messageTitle | translate }}</h4><span>{{ announcement.message | translate }}</span></div><ng-container *ngIf="hasComponent()"><ng-container *ngComponentOutlet="announcement.component; injector: announcementInjector"></ng-container></ng-container></div>');e.put("ExperienceSelectorComponent.html",'<se-generic-editor *ngIf="isReady" [smarteditComponentType]="smarteditComponentType" [smarteditComponentId]="smarteditComponentId" [structureApi]="structureApi" [content]="content" [contentApi]="contentApi" (getApi)="getApi($event)"></se-generic-editor>');e.put("ConfigurationModalComponent.html",'<div id="editConfigurationsBody" class="se-config"><form #form="ngForm" novalidate><div class="se-config__sub-header"><span class="se-config__sub-title">{{\'se.configurationform.label.keyvalue\' | translate}}</span> <button class="se-config__add-entry-btn fd-button--compact" type="button" (click)="editor.addEntry()">{{ "se.general.configuration.add.button" | translate }}</button></div><div class="se-config__entry" *ngFor="let entry of editor.filterConfiguration(); let $index = index"><div class="se-config__entry-data"><div class="se-config__entry-key"><input type="text" [ngClass]="{                            \'is-invalid\': entry.errors &&  entry.errors.keys && entry.errors.keys.length > 0,                            \'se-config__entry-key--disabled\': !entry.isNew }" name="{{entry.key}}_{{entry.uuid}}_key" placeholder="{{\'se.configurationform.header.key.name\' | translate}}" [(ngModel)]="entry.key" [required]="true" [disabled]="!entry.isNew" class="se-config__entry-key-input fd-form__control" [title]="entry.key"/><ng-container *ngIf="entry.errors && entry.errors.keys"><span id="{{entry.key}}_error_{{$index}}" *ngFor="let error of entry.errors.keys; let $index = index" class="error-input help-block">{{error.message|translate}}</span></ng-container></div><div class="se-config__entry-value"><textarea [ngClass]="{\'is-invalid\': entry.errors && entry.errors.values && entry.errors.values.length>0}" name="{{entry.key}}_{{entry.uuid}}_value" placeholder="{{\'se.configurationform.header.value.name\' | translate}}" [(ngModel)]="entry.value" [required]="true" class="se-config__entry-text-area fd-form__control" (change)="editor.validateUserInput(entry)"></textarea><div *ngIf="entry.requiresUserCheck"><input id="{{entry.key}}_absoluteUrl_check_{{$index}}" type="checkbox" name="{{entry.key}}_{{entry.uuid}}_isCheckedByUser" [(ngModel)]="entry.isCheckedByUser"/> <span id="{{entry.key}}_absoluteUrl_msg_{{$index}}" [ngClass]="{                                \'warning-check-msg\': true,                                \'not-checked\': entry.hasErrors && !entry.isCheckedByUser                            }">{{\'se.configurationform.absoluteurl.check\' | translate}}</span></div><ng-container *ngIf="entry.errors && entry.errors.values && entry.errors.values"><span id="{{entry.key}}_error_{{$index}}" *ngFor="let error of entry.errors.values; let $index = index" class="error-input help-block">{{error.message|translate}}</span></ng-container></div></div><button type="button" id="{{entry.key}}_removeButton_{{$index}}" class="se-config__entry-remove-btn fd-button--light sap-icon--delete" (click)="editor.removeEntry(entry, form);"></button></div></form></div>');e.put("HeartBeatAlertComponent.html","<div><span>{{ 'se.heartbeat.failure1' | translate }}</span> <span><a (click)=\"switchToPreviewMode()\">{{ 'se.heartbeat.failure2' | translate }}</a></span></div>");e.put("HotkeyNotificationComponentTemplate.html",'<div class="se-notification__hotkey"><div *ngFor="let key of hotkeyNames; let last = last"><div class="se-notification__hotkey--key"><span>{{ key }}</span></div><span *ngIf="!last" class="se-notification__hotkey__icon--add">+</span></div><div class="se-notification__hotkey--text"><div class="se-notification__hotkey--title">{{ title }}</div><div class="se-notification__hotkey--message">{{ message }}</div></div></div>');e.put("NotificationComponentTemplate.html",'<div class="se-notification" id="{{ id }}" *ngIf="notification"><div [seCustomComponentOutlet]="notification.componentName"></div></div>');e.put("NotificationPanelComponentTemplate.html",'<ng-container *ngIf="(notifications$ | async) as notifications"><div class="se-notification-panel" *ngIf="notifications.length > 0" [ngClass]="{\'is-mouseover\': isMouseOver}" (mouseenter)="onMouseEnter()"><div><se-notification *ngFor="let notification of (notifications | seReverse)" [notification]="notification"></se-notification></div></div></ng-container>');e.put("sitesLinkTemplate.html",'<div (click)="goToSites()" class="se-sites-link {{cssClass}}"><a class="se-sites-link__text">{{\'se.toolbar.sites\' | translate}}</a> <span class="icon-navigation-right-arrow se-sites-link__arrow {{iconCssClass}}"></span></div>');e.put("sitesLinkWrapperTemplate.html","<sites-link/>");e.put("UserAccountComponent.html",'<div class="se-user-account-dropdown"><div class="se-user-account-dropdown__role">{{ \'se.toolbar.useraccount.role\' | translate }}</div><div class="user-account-dropdown__name">{{username}}</div><div class="divider"></div><a class="se-sign-out__link fd-menu__item" (click)="signOut()">{{\'se.toolbar.useraccount.signout\' | translate}}</a></div>');e.put("ExperienceSelectorButtonComponent.html",'<fd-popover class="se-experience-selector" [(isOpen)]="status.isOpen" (isOpenChange)="resetExperienceSelector()" [closeOnOutsideClick]="false" [triggers]="[\'click\']" [placement]="\'bottom-end\'"><fd-popover-control><div class="se-experience-selector__control"><se-tooltip [placement]="\'bottom\'" [triggers]="[\'mouseenter\', \'mouseleave\']" *ngIf="isCurrentPageFromParent" class="se-experience-selector__tooltip"><span se-tooltip-trigger class="se-experience-selector__btn--globe"><span class="hyicon hyicon-globe se-experience-selector__btn--globe--icon"></span></span><div se-tooltip-body>{{ parentCatalogVersion }}</div></se-tooltip><button class="se-experience-selector__btn" id="experience-selector-btn"><span [attr.title]="experienceText" class="se-experience-selector__btn-text se-nowrap-ellipsis">{{ experienceText }} </span><span class="se-experience-selector__btn-arrow icon-navigation-down-arrow"></span></button></div></fd-popover-control><fd-popover-body><div class="se-experience-selector__dropdown fd-modal fd-modal__content" role="menu"><se-experience-selector [experience]="experience" [dropdownStatus]="status" [(resetExperienceSelector)]="resetExperienceSelector"></se-experience-selector></div></fd-popover-body></fd-popover>');e.put("inflectionPointSelectorWidgetComponentTemplate.html",'<div class="se-inflection-point dropdown" [class.open]="isOpen" id="inflectionPtDropdown"><button type="button" class="se-inflection-point__toggle" (click)="toggleDropdown($event)" aria-pressed="false" [attr.aria-expanded]="isOpen"><span [ngClass]="getIconClass()" class="se-inflection-point___selected"></span></button><div class="se-inflection-point-dropdown"><nav class="fd-menu"><ul class="fd-menu__list" role="menu"><li *ngFor="let choice of points" class="fd-menu__item inflection-point__device" [ngClass]="{selected: isSelected(choice)}" id="se-device-{{choice.type}}" (click)="selectPoint(choice)"><span [ngClass]="getIconClass(choice)"></span></li></ul></nav></div></div>');e.put("PerspectiveSelectorComponent.html",'<fd-popover [(isOpen)]="isOpen" [closeOnOutsideClick]="false" [triggers]="[\'click\']" *ngIf="hasActivePerspective()" class="se-perspective-selector" [placement]="\'bottom-end\'" [disabled]="isDisabled" [options]="popperOptions"><fd-popover-control><div class="se-perspective-selector__trigger"><se-tooltip [isChevronVisible]="true" [triggers]="[\'mouseenter\', \'mouseleave\']" *ngIf="isTooltipVisible()"><span se-tooltip-trigger id="perspectiveTooltip" class="hyicon hyicon-info se-perspective-selector__hotkey-tooltip--icon"></span><div se-tooltip-body>{{ activePerspective.descriptionI18nKey | translate }}</div></se-tooltip><button class="se-perspective-selector__btn" [disabled]="isDisabled">{{getActivePerspectiveName() | translate}} <span class="se-perspective-selector__btn-arrow icon-navigation-down-arrow"></span></button></div></fd-popover-control><fd-popover-body><ul class="se-perspective__list fd-list-group" [ngClass]="{\'se-perspective__list--tooltip\': isTooltipVisible()}" role="menu"><li *ngFor="let choice of getDisplayedPerspectives()" class="fd-list-group__item se-perspective__list-item fd-has-padding-none"><a class="item se-perspective__list-item-text" (click)="selectPerspective($event, choice.key);">{{choice.nameI18nKey | translate}}</a></li></ul></fd-popover-body></fd-popover>');e.put("PerspectiveSelectorHotkeyNotificationComponentTemplate.html","<se-hotkey-notification [hotkeyNames]=\"['esc']\" [title]=\"'se.application.status.hotkey.title' | translate\" [message]=\"'se.application.status.hotkey.message' | translate\"></se-hotkey-notification>");e.put("LandingPageComponent.html",'<div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar></div><div class="se-landing-page"><div class="se-landing-page-actions"><div class="se-landing-page-container"><h1 class="se-landing-page-title">{{ \'se.landingpage.title\' | translate }}</h1><div class="se-landing-page-site-selection" *ngIf="model"><se-generic-editor-dropdown [field]="field" [qualifier]="qualifier" [model]="model" [id]="sitesId"></se-generic-editor-dropdown></div><p class="se-landing-page-label">{{ \'se.landingpage.label\' | translate }}</p></div></div><p class="se-landing-page-container se-landing-page-sub-header">Content Catalogs</p><div class="se-landing-page-container se-landing-page-catalogs"><div class="se-landing-page-catalog" *ngFor="let catalog of catalogs; let isLast = last"><se-catalog-details [catalog]="catalog" [siteId]="model.site" [isCatalogForCurrentSite]="isLast"></se-catalog-details></div></div><img src="static-resources/images/best-run-sap-logo.svg" class="se-landing-page-footer-logo"/></div>');e.put("PageTreeContainerComponent.html",'<div *ngIf="component" class="page-tree-container"><ng-container *ngComponentOutlet="component"></ng-container></div>');e.put("StorefrontPageComponent.html",'<div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--experience" imageRoot="imageRoot" toolbarName="smartEditExperienceToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--perspective" imageRoot="imageRoot" toolbarName="smartEditPerspectiveToolbar"></se-toolbar></div><div id="js_iFrameWrapper" class="iframeWrapper"><div class="wrap"><div *ngIf="showPageTreeList()" class="page-tree__list"><se-page-tree-container></se-page-tree-container></div><div class="iframe-panel"><iframe id="ySmartEditFrame" src=""></iframe><div id="ySmartEditFrameDragArea"></div></div></div></div>');e.put("MultiProductCatalogVersionConfigurationComponent.html",'<div class="form-group se-multi-product-catalog-version-selector__label">{{\'se.product.catalogs.multiple.list.header\' | translate}}</div><div class="se-multi-product-catalog-version-selector__catalog form-group" *ngFor="let productCatalog of productCatalogs"><label class="se-control-label se-multi-product-catalog-version-selector__catalog-name" id="{{ productCatalog.catalogId }}-label">{{ productCatalog.name | seL10n | async }}</label><div class="se-multi-product-catalog-version-selector__catalog-version"><se-select [id]="productCatalog.catalogId" [(model)]="productCatalog.selectedItem" [onChange]="updateModel()" [fetchStrategy]="productCatalog.fetchStrategy"></se-select></div></div>');e.put("MultiProductCatalogVersionSelectorComponent.html",'<se-tooltip [placement]="\'bottom\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [isChevronVisible]="true" class="se-products-catalog-select-multiple__tooltip"><div id="multi-product-catalog-versions-selector" se-tooltip-trigger (click)="onClickSelector()" class="se-products-catalog-select-multiple"><input type="text" [value]="multiProductCatalogVersionsSelectedOptions$ | async" class="form-control se-products-catalog-select-multiple__catalogs se-nowrap-ellipsis" [name]="\'productCatalogVersions\'" readonly="readonly"/> <span class="hyicon hyicon-optionssm se-products-catalog-select-multiple__icon"></span></div><div class="se-product-catalogs-tooltip" se-tooltip-body><div class="se-product-catalogs-tooltip__h">{{ (\'se.product.catalogs.selector.headline.tooltip\' || \'\') | translate }}</div><div class="se-product-catalog-info" *ngFor="let productCatalog of productCatalogs">{{ getCatalogNameCatalogVersionLabel(productCatalog.catalogId) | async }}</div></div></se-tooltip>');e.put("ProductCatalogVersionsSelectorComponent.html",'<ng-container *ngIf="isReady"><se-select *ngIf="isSingleVersionSelector" [id]="geData.qualifier" [(model)]="geData.model.productCatalogVersions[0]" [(reset)]="reset" [fetchStrategy]="fetchStrategy"></se-select><se-multi-product-catalog-version-selector *ngIf="isMultiVersionSelector" [productCatalogs]="productCatalogs" [(selectedProductCatalogVersions)]="geData.model[geData.qualifier]"></se-multi-product-catalog-version-selector></ng-container>');e.put("ToolbarActionComponent.html",'<div *ngIf="item.isPermissionGranted"><div *ngIf="item.type == type.ACTION" class="toolbar-action"><button type="button" [ngClass]="{                \'toolbar-action--button--compact\': isCompact,                \'toolbar-action--button\': !isCompact            }" class="btn" (click)="toolbar.triggerAction(item, $event)" [attr.aria-pressed]="false" [attr.aria-haspopup]="true" [attr.aria-expanded]="false" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn"><span *ngIf="item.iconClassName" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn_iconclass" class="{{item.iconClassName}}" [ngClass]="{ \'se-toolbar-actions__icon\': isCompact }"></span> <img *ngIf="!item.iconClassName && item.icons" id="{{toolbar.toolbarName}}_option_{{item.key}}" src="{{toolbar.imageRoot}}{{item.icons[0]}}" class="file" title="{{item.name | translate}}" alt="{{item.name | translate}}"/> <span *ngIf="!isCompact" class="toolbar-action-button__txt" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn_lbl">{{item.name | translate}}</span></button></div><fd-popover class="se-toolbar-action__wrapper toolbar-action toolbar-action--hybrid" *ngIf="item.type === type.HYBRID_ACTION" [attr.data-item-key]="item.key" [triggers]="[\'click\']" [noArrow]="false" [isOpen]="item.isOpen" [closeOnOutsideClick]="false" (isOpenChange)="onOpenChange()" [placement]="placement" seClickOutside (clickOutside)="onOutsideClicked()"><fd-popover-control><button *ngIf="item.iconClassName || item.icons" type="button" class="btn" [ngClass]="{                    \'toolbar-action--button--compact\': isCompact,                    \'toolbar-action--button\': !isCompact                }" [disabled]="disabled" [attr.aria-pressed]="false " (click)="toolbar.triggerAction(item, $event)"><span *ngIf="item.iconClassName" class="{{item.iconClassName}}" [ngClass]="{ \'se-toolbar-actions__icon\': isCompact }"></span> <img *ngIf="!item.iconClassName && item.icons" id="{{toolbar.toolbarName}}_option_{{item.key}}" src="{{toolbar.imageRoot}}{{item.icons[0]}}" class="file" title="{{item.name | translate}}" alt="{{item.name | translate}}"/> <span *ngIf="!isCompact" class="toolbar-action-button__txt">{{item.name | translate}}</span></button></fd-popover-control><fd-popover-body class="se-toolbar-action__body" [ngClass]="{                \'toolbar-action--include--compact\': isCompact,                \'toolbar-action--include\': !isCompact                          }"><se-prevent-vertical-overflow><ng-container *ngIf="toolbar.getItemVisibility(item) && item.component"><ng-container *ngComponentOutlet="item.component; injector: actionInjector"></ng-container></ng-container></se-prevent-vertical-overflow></fd-popover-body></fd-popover></div>');e.put("ToolbarComponent.html",'<div class="se-toolbar" [ngClass]="cssClass"><div class="se-toolbar__left"><div *ngFor="let item of aliases | seProperty:{section:\'left\'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__left {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div><div class="se-toolbar__middle"><div *ngFor="let item of aliases | seProperty:{section:\'middle\'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__middle {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div><div class="se-toolbar__right"><div *ngFor="let item of aliases | seProperty:{section:\'right\'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__right {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div></div>');e.put("CatalogDetailsComponent.html",'<div class="se-catalog-details" [attr.data-catalog]="catalog.name | seL10n | async"><div class="se-catalog-header"><div class="se-catalog-header-flex"><div class="se-catalog-details__header">{{ catalog.name | seL10n | async }}</div><div *ngIf="catalog.parents?.length"><a href="javascript:void(0)" (click)="onOpenCatalogHierarchy()">{{ \'se.landingpage.catalog.hierarchy\' | translate }}</a></div></div></div><div class="se-catalog-details__content"><se-catalog-version-details *ngFor="let catalogVersion of sortedCatalogVersions" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion" [siteId]="siteId"></se-catalog-version-details></div></div>');e.put("CatalogHierarchyModalComponent.html",'<div class="se-catalog-hierarchy-header"><span>{{ \'se.catalog.hierarchy.modal.tree.header\' | translate }}</span></div><div *ngIf="this.catalogs$ | async as catalogs" class="se-catalog-hierarchy-body"><se-catalog-hierarchy-node *ngFor="let catalog of catalogs; let i = index" [catalog]="catalog" [index]="i" [isLast]="i === catalogs.length - 1" [siteId]="siteId" (siteSelect)="onSiteSelected()"></se-catalog-hierarchy-node></div>');e.put("CatalogHierarchyNodeComponent.html",'<div class="se-cth-node-name" [style.padding-left.px]="15 * index" [style.padding-right.px]="15 * index" [class.se-cth-node-name__last]="isLast"><fd-icon glyph="navigation-down-arrow"></fd-icon>{{ (isLast ? catalog.name : catalog.catalogName) | seL10n | async }}&nbsp; <span *ngIf="isLast">({{ \'se.catalog.hierarchy.modal.tree.this.catalog\' | translate}})</span></div><div class="se-cth-node-sites"><ng-container><ng-container *ngIf="hasOneSite; else hasManySites"><a class="se-cth-node-anchor" href="" (click)="onNavigateToSite(catalog.sites[0].uid)">{{ catalog.sites[0].name | seL10n | async }}<fd-icon glyph="navigation-right-arrow"></fd-icon></a></ng-container><ng-template #hasManySites><se-dropdown-menu [dropdownItems]="dropdownItems" useProjectedAnchor="1" (click)="onSiteSelect($event)"><span class="se-cth-node-anchor">{{ this.catalog.sites.length }} Sites<fd-icon glyph="navigation-down-arrow"></fd-icon></span></se-dropdown-menu></ng-template></ng-container></div>');e.put("CatalogVersionDetailsComponent.html",'<div class="se-catalog-version-container" [attr.data-catalog-version]="catalogVersion.version"><div class="se-catalog-version-container__left"><se-catalog-versions-thumbnail-carousel [catalogVersion]="catalogVersion" [catalog]="catalog" [siteId]="siteId"></se-catalog-versions-thumbnail-carousel><div><div class="se-catalog-version-container__name">{{catalogVersion.version}}</div><div class="se-catalog-version-container__left__templates"><div class="se-catalog-version-container__left__template" *ngFor="let item of leftItems; let isLast = last"><se-catalog-version-item-renderer [item]="item" [siteId]="siteId" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion"></se-catalog-version-item-renderer><div class="se-catalog-version-container__divider" *ngIf="!isLast"></div></div></div></div></div><div class="se-catalog-version-container__right"><div class="se-catalog-version-container__right__template" *ngFor="let item of rightItems"><se-catalog-version-item-renderer [item]="item" [siteId]="siteId" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion"></se-catalog-version-item-renderer></div></div></div>');e.put("CatalogVersionsThumbnailCarouselComponent.html",'<div class="se-active-catalog-thumbnail"><div class="se-active-catalog-version-container__thumbnail" (click)="onClick()"><div class="se-active-catalog-version-container__thumbnail__default-img"><div class="se-active-catalog-version-container__thumbnail__img" [ngStyle]="{\'background-image\': \'url(\' + catalogVersion.thumbnailUrl + \')\'}"></div></div></div></div>');e.put("HomePageLinkComponent.html",'<div class="home-link-container"><a href="javascript:void(0)" class="home-link-item__link se-catalog-version__link" (click)="onClick()">{{ \'se.landingpage.homepage\' | translate }}</a></div>')}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}var A;(function(e){e[e["SMARTEDITCONTAINER"]=0]="SMARTEDITCONTAINER";e[e["SMARTEDIT"]=1]="SMARTEDIT"})(A||(A={}));t.ConfigurationExtractorService=class ConfigurationExtractorService{constructor(e){this.logService=e}extractSEContainerModules(e){return this._getAppsAndLocations(e,A.SMARTEDITCONTAINER)}extractSEModules(e){return this._getAppsAndLocations(e,A.SMARTEDIT)}orderApplications(e){const t=e.filter((e=>!e.extends));const o=e.filter((e=>!!e.extends)).filter((t=>{const o=e.findIndex((e=>e.name===t.extends));if(o===-1){this.logService.error(`Application ${t.name} located at ${t.location} is ignored because it extends an unknown application '${t.extends}'; SmartEdit functionality may be compromised.`)}return o>-1}));return this._addExtendingAppsInOrder(t,o)}_addExtendingAppsInOrder(e,t,o){o=o||1;const n=[];t.forEach((t=>{const s=e.findIndex((e=>e.name===t.extends));if(s>-1){this.logService.debug(`pass ${o}, ${t.name} requiring ${t.extends} found it at index ${s} (${e.map((e=>e.name))})`);e.splice(s+1,0,t)}else{this.logService.debug(`pass ${o}, ${t.name} requiring ${t.extends} did not find it  (${e.map((e=>e.name))})`);n.push(t)}}));if(n.length){return this._addExtendingAppsInOrder(e,n,++o)}else{return e}}_getAppsAndLocations(e,t){let o;switch(t){case A.SMARTEDITCONTAINER:o="smartEditContainerLocation";break;case A.SMARTEDIT:o="smartEditLocation";break}const n=r.map(e,((e,t)=>({key:t,value:e}))).reduce(((t,n)=>{if(n.key.indexOf("applications")===0&&typeof n.value[o]==="string"){const s={};s.name=n.key.split(".")[1];const a=n.value[o];if(/^https?\:\/\//.test(a)){s.location=a}else{s.location=e.domain+a}const d=n.value.extends;if(d){s.extends=d}t.applications.push(s);t.authenticationMap=r.merge(t.authenticationMap,n.value.authenticationMap)}else if(n.key==="authenticationMap"){t.authenticationMap=r.merge(t.authenticationMap,n.value)}return t}),{applications:[],authenticationMap:{}});return n}};t.ConfigurationExtractorService.$inject=["logService"];t.ConfigurationExtractorService=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.LogService])],t.ConfigurationExtractorService);t.BootstrapService=class BootstrapService{constructor(e,t,o,n,s,a,r,d,p){this.configurationExtractorService=e;this.sharedDataService=t;this.logService=o;this.httpClient=n;this.promiseUtils=s;this.smarteditBootstrapGateway=a;this.moduleUtils=r;this.SMARTEDIT_INNER_FILES=d;this.SMARTEDIT_INNER_FILES_POST=p}bootstrapContainerModules(e){const t=this.promiseUtils.defer();const o=this.configurationExtractorService.extractSEContainerModules(e);const n=this.configurationExtractorService.orderApplications(o.applications);this.logService.debug("outerAppLocations are:",n);this.sharedDataService.set("authenticationMap",o.authenticationMap);this.sharedDataService.set("credentialsMap",e["authentication.credentials"]);const s=this._getConstants(e);Object.keys(s).forEach((e=>{this._getLegacyContainerModule().constant(e,s[e])}));this._getValidApplications(n).then((e=>{d.scriptUtils.injectJS().execute({srcs:e.map((e=>e.location)),callback:()=>{const o=[...window.__smartedit__.pushedModules];["personalizationsmarteditContainer","merchandisingsmarteditContainer","personalizationsearchsmarteditContainer","personalizationpromotionssmarteditContainer","cmssmarteditContainer"].forEach((t=>{e.push({name:t,location:""})}));e.forEach((e=>{this.moduleUtils.addModuleToAngularJSApp("smarteditcontainer",e.name);const t=this.moduleUtils.getNgModule(e.name);if(t){o.push(t)}}));t.resolve({modules:o,constants:s})}})}));return t.promise}bootstrapSEApp(e){const t=this.configurationExtractorService.extractSEModules(e);const o=this.configurationExtractorService.orderApplications(t.applications);this.sharedDataService.set("authenticationMap",t.authenticationMap);this.sharedDataService.set("credentialsMap",e["authentication.credentials"]);const n={properties:this._getConstants(e),js:[{src:e.smarteditroot+"/static-resources/userTracking/trackingUserActions.js"},{src:e.smarteditroot+"/static-resources/thirdparties/piwik/piwik.js"},{src:e.smarteditroot+"/static-resources/thirdparties/blockumd/blockumd.js"},{src:e.smarteditroot+"/static-resources/dist/smartedit-new/vendors.js"},{src:e.smarteditroot+"/static-resources/thirdparties/ckeditor/ckeditor.js"},{src:e.smarteditroot+"/static-resources/dist/smartedit-new/smartedit.js"}]};return this._getValidApplications(o).then((e=>{["personalizationsmartedit","merchandisingsmartedit","personalizationsearchsmartedit","personalizationpromotionssmartedit","cmssmartedit"].forEach((t=>{e.push({name:t,location:""})}));if(false){}n.js=n.js.concat(e.map((e=>{const t={src:e.location};return t})));if(false){}n.properties.applications=e.map((e=>e.name));this.smarteditBootstrapGateway.getInstance().publish("bundle",{resources:n})}))}_getLegacyContainerModule(){return a.module("smarteditcontainer")}_getConstants(e){return{domain:e.domain,smarteditroot:e.smarteditroot}}_getValidApplications(e){return Promise.all(e.map((e=>{const t=this.promiseUtils.defer();this.httpClient.get(e.location,{responseType:"text"}).subscribe((()=>{t.resolve(e)}),(o=>{this.logService.error(`Failed to load application '${e.name}' from location ${e.location}; SmartEdit functionality may be compromised.`);t.resolve()}));return t.promise}))).then((e=>r.merge(r.compact(e))))}};t.BootstrapService.$inject=["configurationExtractorService","sharedDataService","logService","httpClient","promiseUtils","smarteditBootstrapGateway","moduleUtils","SMARTEDIT_INNER_FILES","SMARTEDIT_INNER_FILES_POST"];t.BootstrapService=__decorate([d.SeDowngradeService(),__param(7,n.Inject("SMARTEDIT_INNER_FILES")),__param(8,n.Inject("SMARTEDIT_INNER_FILES_POST")),__metadata("design:paramtypes",[t.ConfigurationExtractorService,d.ISharedDataService,d.LogService,s.HttpClient,d.PromiseUtils,d.SmarteditBootstrapGateway,d.ModuleUtils,Array,Array])],t.BootstrapService);t.LoadConfigManagerService=class LoadConfigManagerService{constructor(e,t,o,n,s,a){this.sharedDataService=t;this.logService=o;this.promiseUtils=n;this.SMARTEDIT_RESOURCE_URI_REGEXP=s;this.SMARTEDIT_ROOT=a;this.restService=e.get(d.CONFIGURATION_URI)}loadAsArray(){const e=this.promiseUtils.defer();this.restService.query().then((t=>{e.resolve(this._parse(t))}),(t=>{this.logService.log("Fail to load the configurations.",t);e.reject()}));return e.promise}loadAsObject(){const e=this.promiseUtils.defer();this.loadAsArray().then((t=>{try{const o=this._convertToObject(t);this.sharedDataService.set("configuration",o);e.resolve(o)}catch(o){this.logService.error("LoadConfigManager.loadAsObject - _convertToObject failed to load configuration:",t);this.logService.error(o);e.reject()}}));return e.promise}_convertToObject(e){const t=e.reduce(((e,t)=>{try{if(typeof e[t.key]!=="undefined"){this.logService.error("LoadConfigManager._convertToObject() - duplicate configuration keys found: "+t.key)}e[t.key]=JSON.parse(t.value)}catch(e){this.logService.error("item _key_ from configuration contains unparsable JSON data _value_ and was ignored".replace("_key_",t.key).replace("_value_",t.value))}return e}),{});try{t.domain=this.SMARTEDIT_RESOURCE_URI_REGEXP.exec(this._getLocation())[1]}catch(e){throw new Error(`location ${this._getLocation()} doesn't match the expected pattern ${this.SMARTEDIT_RESOURCE_URI_REGEXP}`)}t.smarteditroot=t.domain+"/"+this.SMARTEDIT_ROOT;return t}_getLocation(){return document.location.href}_parse(e){const t=r.cloneDeep(e);Object.keys(t).forEach((e=>{try{t[e]=JSON.parse(t[e])}catch(e){}}));return t}};t.LoadConfigManagerService.$inject=["restServicefactory","sharedDataService","logService","promiseUtils","SMARTEDIT_RESOURCE_URI_REGEXP","SMARTEDIT_ROOT"];t.LoadConfigManagerService=__decorate([d.SeDowngradeService(),d.OperationContextRegistered(d.CONFIGURATION_URI,"TOOLING"),__param(4,n.Inject("SMARTEDIT_RESOURCE_URI_REGEXP")),__param(5,n.Inject("SMARTEDIT_ROOT")),__metadata("design:paramtypes",[d.RestServiceFactory,d.ISharedDataService,d.LogService,d.PromiseUtils,RegExp,String])],t.LoadConfigManagerService);const O={timeout:5e3,closeable:true};let x=class AnnouncementService extends d.IAnnouncementService{constructor(e){super();this.logService=e;this.announcements$=new p.BehaviorSubject([])}showAnnouncement(e){this.validateAnnouncementConfig(e);const t=r.clone(e);t.id=d.stringUtils.encode(e);t.timeout=!!t.timeout&&t.timeout>0?t.timeout:O.timeout;if(t.timeout>0){t.timer=setTimeout((()=>{this._closeAnnouncement(t)}),t.timeout)}this.announcements$.next([...this.announcements$.getValue(),t]);return Promise.resolve(t.id)}getAnnouncements(){return this.announcements$.asObservable()}closeAnnouncement(e){const t=this.announcements$.getValue().find((t=>t.id===e));if(t){this._closeAnnouncement(t)}return Promise.resolve()}_closeAnnouncement(e){if(e.timer){clearTimeout(e.timer)}const t=this.announcements$.getValue();const o=t.filter((t=>t.id!==e.id));this.announcements$.next(o)}validateAnnouncementConfig(e){const{message:t,component:o}=e;if(!t&&!o){this.logService.warn("AnnouncementService.validateAnnouncementConfig - announcement must contain at least a message or component property",e)}if(t&&o){throw new Error("AnnouncementService.validateAnnouncementConfig - either message or component must be provided")}}};x.$inject=["logService"];x=__decorate([d.SeDowngradeService(d.IAnnouncementService),d.GatewayProxied("showAnnouncement","closeAnnouncement"),n.Injectable(),__metadata("design:paramtypes",[d.LogService])],x);let D=class NotificationService{constructor(e,t){this.systemEventService=e;this.logService=t;this.notificationsChangeAction=new p.BehaviorSubject(undefined);this.notifications=new p.BehaviorSubject([]);this.initNotificationsChangeAction()}ngOnDestroy(){this.notifications.unsubscribe();this.notificationsChangeAction.unsubscribe()}pushNotification(e){const t={type:"PUSH",payload:e};this.notificationsChangeAction.next(t);return Promise.resolve()}removeNotification(e){const t={type:"REMOVE",payload:{id:e}};this.notificationsChangeAction.next(t);return Promise.resolve()}removeAllNotifications(){const e={type:"REMOVE_ALL"};this.notificationsChangeAction.next(e);return Promise.resolve()}isNotificationDisplayed(e){return!!this.getNotification(e)}getNotification(e){return this.notifications.getValue().find((t=>t.id===e))}getNotifications(){return this.notifications.asObservable()}initNotificationsChangeAction(){this.notificationsChangeAction.pipe(m.distinctUntilChanged(((e,t)=>this.emitWhenActionIsAvailable(t))),m.skip(1),m.map((e=>this.resolveNotifications(e)))).subscribe((e=>{this.notifications.next(e);this.systemEventService.publishAsync(d.EVENT_NOTIFICATION_CHANGED)}))}emitWhenActionIsAvailable(e){const{payload:t}=e;const o=(e.type==="PUSH"||e.type==="REMOVE")&&this.getNotification(t.id);switch(e.type){case"PUSH":if(o){this.logService.debug(`Notification already exists for id:"${t.id}"`);return true}return false;case"REMOVE":if(!o){this.logService.debug(`Attempt to remove a non existing notification for id:"${t.id}"`);return true}return false;case"REMOVE_ALL":return false}}resolveNotifications(e){const{payload:t}=e;switch(e.type){case"PUSH":return[...this.notifications.getValue(),t];case"REMOVE":return this.notifications.getValue().filter((e=>e.id!==t.id));case"REMOVE_ALL":return[]}}};D.$inject=["systemEventService","logService"];D=__decorate([d.SeDowngradeService(d.INotificationService),d.GatewayProxied("pushNotification","removeNotification","removeAllNotifications"),__metadata("design:paramtypes",[d.SystemEventService,d.LogService])],D);let k=class NotificationMouseLeaveDetectionService extends d.INotificationMouseLeaveDetectionService{constructor(e,t){super();this.document=e;this.windowUtils=t;this.notificationPanelBounds=null;this.mouseLeaveCallback=null;this._onMouseMove=this._onMouseMove.bind(this)}startDetection(e,t,o){this.validateBounds(e);if(!o){throw new Error("Callback function is required")}this.notificationPanelBounds=e;this.mouseLeaveCallback=o;this.document.addEventListener("mousemove",this._onMouseMove);if(t){this.validateBounds(t);this._remoteStartDetection(t)}return Promise.resolve()}stopDetection(){this.document.removeEventListener("mousemove",this._onMouseMove);this.notificationPanelBounds=null;this.mouseLeaveCallback=null;if(this.windowUtils.getGatewayTargetFrame()){this._remoteStopDetection()}return Promise.resolve()}_callCallback(){this._getCallback().then((e=>{if(e){e()}}));return Promise.resolve()}_getBounds(){return Promise.resolve(this.notificationPanelBounds)}_getCallback(){return Promise.resolve(this.mouseLeaveCallback)}validateBounds(e){if(!e){throw new Error("Bounds are required for mouse leave detection")}if(!e.hasOwnProperty("x")){throw new Error("Bounds must contain the x coordinate")}if(!e.hasOwnProperty("y")){throw new Error("Bounds must contain the y coordinate")}if(!e.hasOwnProperty("width")){throw new Error("Bounds must contain the width dimension")}if(!e.hasOwnProperty("height")){throw new Error("Bounds must contain the height dimension")}}};k.$inject=["document","windowUtils"];k=__decorate([d.SeDowngradeService(d.INotificationMouseLeaveDetectionService),d.GatewayProxied("stopDetection","_remoteStartDetection","_remoteStopDetection","_callCallback"),n.Injectable(),__param(0,n.Inject(g.DOCUMENT)),__metadata("design:paramtypes",[Document,d.WindowUtils])],k);t.DelegateRestService=class DelegateRestService{constructor(e){this.restServiceFactory=e}delegateForSingleInstance(e,t,o,n,s,a){const r=this.restServiceFactory.get(o,n);if(s){r.activateMetadata()}return r.getMethodForSingleInstance(e)(t,a)}delegateForArray(e,t,o,n,s,a){const r=this.restServiceFactory.get(o,n);if(s){r.activateMetadata()}return r.getMethodForArray(e)(t,a)}delegateForPage(e,t,o,n,s){const a=this.restServiceFactory.get(t,o);if(n){a.activateMetadata()}return a.page(e,s)}delegateForQueryByPost(e,t,o,n,s,a){const r=this.restServiceFactory.get(o,n);if(s){r.activateMetadata()}return r.queryByPost(e,t,a)}};t.DelegateRestService.$inject=["restServiceFactory"];t.DelegateRestService=__decorate([d.SeDowngradeService(),d.GatewayProxied(),__metadata("design:paramtypes",[d.IRestServiceFactory])],t.DelegateRestService);const F=[{orientation:"vertical",key:"se.deviceorientation.vertical.label",default:true},{orientation:"horizontal",key:"se.deviceorientation.horizontal.label"}];const V=[{iconClass:"sap-icon--iphone",type:"phone",width:480},{iconClass:"sap-icon--iphone-2",type:"wide-phone",width:600},{iconClass:"sap-icon--ipad",type:"tablet",width:700},{iconClass:"sap-icon--ipad-2",type:"wide-tablet",width:1024},{iconClass:"sap-icon--sys-monitor",type:"desktop",width:1200},{iconClass:"hyicon hyicon-wide-screen",type:"wide-desktop",width:"100%",default:true}];var U;let $=U=class IframeManagerService{constructor(e,t,o,n,s){this.logService=e;this.httpClient=t;this.yjQuery=o;this.windowUtils=n;this.sharedDataService=s}setCurrentLocation(e){this.currentLocation=e}getIframe(){return this.yjQuery(this.windowUtils.getSmarteditIframe())}isCrossOrigin(){return this.windowUtils.isCrossOrigin(this.currentLocation)}load(e,t,o){if(t){return this._getPageAsync(e).then((()=>{this.getIframe().attr("src",e)}),(e=>{if(e.status===404){this.getIframe().attr("src",o);return}this.logService.error(`IFrameManagerService.load - _getPageAsync failed with error ${e}`)}))}else{this.logService.debug("iframeManagerService::load - loading storefront url:",e);this.getIframe().attr("src",e);return Promise.resolve()}}loadPreview(e,t){this.windowUtils.setTrustedIframeDomain(e);this.logService.debug("loading storefront iframe with preview ticket:",t);let o;if(!/.+\.html/.test(e)){o=this._appendURISuffix(e)}else{o=Promise.resolve(e)}return o.then((o=>{const n=o+(o.indexOf("?")===-1?"?":"&")+"cmsTicketId="+t;if(this._mustLoadAsSuch(e)){return this.load(n)}else{const e=this.isCrossOrigin();return(e?Promise.resolve({}):this._getPageAsync(n)).then((()=>this.load(this.currentLocation,!e,n)),(e=>this.logService.error("failed to load preview",e)))}}))}apply(e,t){let o;let n;let s=true;if(t&&t.orientation){s=t.orientation==="vertical"}if(e){o=s?e.width:e.height;n=s?e.height:e.width;this.getIframe().removeClass().addClass("device-"+(s?"vertical":"horizontal")+" device-default")}else{this.getIframe().removeClass()}this.getIframe().css({width:o||"100%",height:n||"100%",display:"block",margin:"auto"})}applyDefault(){const e=V.find((e=>e.default));const t=F.find((e=>e.default));this.apply(e,t)}_mustLoadAsSuch(e){return!this.currentLocation||d.urlUtils.getURI(e)===d.urlUtils.getURI(this.currentLocation)||"cmsTicketId"in d.urlUtils.parseQuery(this.currentLocation)}_getPageAsync(e){return this.httpClient.get(e,{observe:"body",responseType:"text"}).toPromise()}_appendURISuffix(e){const t=e.split("?");return this.sharedDataService.get("configuration").then((e=>{if(!e||!e.storefrontPreviewRoute){this.logService.debug("SmartEdit configuration for 'storefrontPreviewRoute' is not found. Fallback to default value: '"+U.DEFAULT_PREVIEW_ROUTE+"'");return U.DEFAULT_PREVIEW_ROUTE}return e.storefrontPreviewRoute})).then((e=>t[0].replace(/(.+)([^\/])$/g,"$1$2/"+e).replace(/(.+)\/$/g,"$1/"+e)+(t.length===2?"?"+t[1]:"")))}};$.DEFAULT_PREVIEW_ROUTE="cx-preview";$=U=__decorate([d.SeDowngradeService(),__param(2,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[d.LogService,s.HttpClient,Function,d.WindowUtils,d.ISharedDataService])],$);let K=class DragAndDropCrossOrigin extends d.IDragAndDropCrossOrigin{constructor(e,t,o){super();this.yjQuery=e;this.crossFrameEventService=t;this.iframeManagerService=o;this.onDragStart=()=>{if(!this.isEnabled()){return}this.crossFrameEventService.publish(d.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_CROSS_ORIGIN_START);this.syncIframeDragArea().show().off("dragover").on("dragover",(e=>{e.preventDefault();const t=this.getPositionRelativeToIframe(e.pageX,e.pageY);this.throttledSendMousePosition(t);return false})).off("drop").on("drop",(e=>{e.preventDefault();e.stopPropagation();const t=this.getPositionRelativeToIframe(e.pageX,e.pageY);this.crossFrameEventService.publish(d.SMARTEDIT_DRAG_AND_DROP_EVENTS.DROP_ELEMENT,t);return false}))};this.onDragEnd=()=>{if(!this.isEnabled()){return}this.getIframeDragArea().off("dragover").off("drop").hide()};this.sendMousePosition=e=>{this.crossFrameEventService.publish(d.SMARTEDIT_DRAG_AND_DROP_EVENTS.TRACK_MOUSE_POSITION,e)}}initialize(){this.throttledSendMousePosition=r.throttle(this.sendMousePosition,d.SEND_MOUSE_POSITION_THROTTLE);this.crossFrameEventService.subscribe(d.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_START,this.onDragStart);this.crossFrameEventService.subscribe(d.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_END,this.onDragEnd);this.crossFrameEventService.subscribe(d.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME.START,(()=>{if(this.isEnabled()){this.iframeManagerService.getIframe().css("pointer-events","none")}}));this.crossFrameEventService.subscribe(d.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME.END,(()=>{if(this.isEnabled()){this.iframeManagerService.getIframe().css("pointer-events","auto")}}))}isEnabled(){return this.iframeManagerService.isCrossOrigin()}getIframeDragArea(){return this.yjQuery("#"+d.SMARTEDIT_IFRAME_DRAG_AREA)}getPositionRelativeToIframe(e,t){const o=this.getIframeDragArea().offset();return{x:e-o.left,y:t-o.top}}syncIframeDragArea(){this.getIframeDragArea().width(this.iframeManagerService.getIframe().width());this.getIframeDragArea().height(this.iframeManagerService.getIframe().height());const e=this.iframeManagerService.getIframe().offset();this.getIframeDragArea().css({top:e.top,left:e.left});return this.getIframeDragArea()}};K.$inject=["yjQuery","crossFrameEventService","iframeManagerService"];K=__decorate([d.SeDowngradeService(d.IDragAndDropCrossOrigin),__param(0,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function,d.CrossFrameEventService,$])],K);let Y=class SiteService{constructor(e){this.SITES_FOR_CATALOGS_URI="/cmswebservices/v1/sites/catalogs";this.cache=null;this.siteRestService=e.get(d.SITES_RESOURCE_URI);this.sitesForCatalogsRestService=e.get(this.SITES_FOR_CATALOGS_URI)}getAccessibleSites(){return this.siteRestService.get({}).then((e=>e.sites))}getSites(){return this.getAccessibleSites().then((e=>{const t=e.reduce(((e,t)=>[...e||[],...t.contentCatalogs]),[]);return this.sitesForCatalogsRestService.save({catalogIds:t}).then((e=>{this.cache=e.sites;return this.cache}))}))}getSiteById(e){return this.getSites().then((t=>t.find((t=>t.uid===e))))}};Y.$inject=["restServiceFactory"];__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.authorizationEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],Y.prototype,"getAccessibleSites",null);__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.authorizationEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],Y.prototype,"getSites",null);Y=__decorate([d.OperationContextRegistered("SITES_RESOURCE_URI","CMS"),d.SeDowngradeService(),__metadata("design:paramtypes",[d.RestServiceFactory])],Y);let X=class ExperienceService extends d.IExperienceService{constructor(e,t,o,n,s,a,r,m,g,u,v){super();this.seStorageManager=e;this.storagePropertiesService=t;this.logService=o;this.crossFrameEventService=n;this.siteService=s;this.previewService=a;this.catalogService=r;this.languageService=m;this.sharedDataService=g;this.iframeManagerService=u;this.routingService=v;this.storageLoaded$=new p.BehaviorSubject(false);e.getStorage({storageId:d.EXPERIENCE_STORAGE_KEY,storageType:t.getProperty("STORAGE_TYPE_SESSION_STORAGE")}).then((e=>{this.experienceStorage=e;this.storageLoaded$.next(true)}))}buildAndSetExperience(e){const t=e.siteId;const o=e.catalogId;const n=e.catalogVersion;const s=e.productCatalogVersions;return Promise.all([this.siteService.getSiteById(t),this.catalogService.getContentCatalogsForSite(t),this.catalogService.getProductCatalogsForSite(t),this.languageService.getLanguagesForSite(t)]).then((([a,d,p,m])=>{const g=d.find((e=>e.catalogId===o));const u=g?g.versions.find((e=>e.version===n)):null;if(!u){return Promise.reject(`no catalogVersionDescriptor found for ${o} catalogId and ${n} catalogVersion`)}const v=[];p.forEach((e=>{const t=e.versions.find((e=>s?s.indexOf(e.uuid)>-1:e.active===true));v.push({catalog:e.catalogId,catalogName:e.name,catalogVersion:t.version,active:t.active,uuid:t.uuid})}));const f=e.language?m.find((t=>t.isocode===e.language)):m[0];const S=r.cloneDeep(e);delete S.siteId;delete S.catalogId;delete S.catalogVersion;S.siteDescriptor=a;S.catalogDescriptor={catalogId:o,catalogVersion:u.version,catalogVersionUuid:u.uuid,name:g.name,siteId:t,active:u.active};S.languageDescriptor=f;S.time=S.time||null;S.productCatalogVersions=v;return this.setCurrentExperience(S)}))}updateExperiencePageId(e){return this.getCurrentExperience().then((t=>{if(!t){return null}t.pageId=e;return this.setCurrentExperience(t).then((()=>this.reloadPage()))}))}loadExperience(e){return this.buildAndSetExperience(e).then((()=>this.reloadPage()))}reloadPage(){this.routingService.reload(`${d.NG_ROUTE_PREFIX}${d.STORE_FRONT_CONTEXT}`)}updateExperiencePageContext(e,t){return this.getCurrentExperience().then((o=>this.catalogService.getContentCatalogsForSite(o.catalogDescriptor.siteId).then((n=>{if(!o){return null}const s=n.reduce(((e,t)=>{if(t.parents&&t.parents.length){t.parents.forEach((t=>{e.push(t)}))}return e}),[...n]);const a=r.flatten(s.map((e=>e.versions.map((t=>{t.catalogName=e.name||e.catalogName;t.catalogId=e.catalogId;return t}))))).find((t=>t.uuid===e));return this.catalogService.getCurrentSiteID().then((e=>{o.pageId=t;o.pageContext={catalogId:a.catalogId,catalogName:a.catalogName,catalogVersion:a.version,catalogVersionUuid:a.uuid,siteId:e,active:a.active};return this.setCurrentExperience(o)}))})))).then((e=>{this.crossFrameEventService.publish(d.EVENTS.PAGE_CHANGE,e);return e}))}getCurrentExperience(){return this.storageLoaded$.pipe(m.filter((e=>e)),m.take(1),m.mergeMap((()=>this.experienceStorage.get(d.EXPERIENCE_STORAGE_KEY)))).toPromise()}setCurrentExperience(e){return this.getCurrentExperience().then((t=>{this.previousExperience=t;return this.experienceStorage.put(e,d.EXPERIENCE_STORAGE_KEY).then((()=>this.sharedDataService.set(d.EXPERIENCE_STORAGE_KEY,e).then((()=>e))))}))}hasCatalogVersionChanged(){return this.getCurrentExperience().then((e=>this.previousExperience===undefined||e.catalogDescriptor.catalogId!==this.previousExperience.catalogDescriptor.catalogId||e.catalogDescriptor.catalogVersion!==this.previousExperience.catalogDescriptor.catalogVersion))}initializeExperience(){this.iframeManagerService.setCurrentLocation(null);return this.getCurrentExperience().then((e=>{if(!e){this.routingService.go(d.NG_ROUTE_PREFIX);return null}return this.updateExperience()}),(e=>{this.logService.error("ExperienceService.initializeExperience() - failed to retrieve experience");return Promise.reject(e)}))}updateExperience(e){return this.getCurrentExperience().then((t=>{t=r.cloneDeep(t);r.merge(t,e);return this.previewService.getResourcePathFromPreviewUrl(t.siteDescriptor.previewUrl).then((e=>{const o=this._convertExperienceToPreviewData(t,e);return this.previewService.createPreview(o).then((e=>{window.__smartedit__.smartEditBootstrapped={};this.iframeManagerService.loadPreview(e.resourcePath,e.ticketId);return this.setCurrentExperience(t)}),(e=>{this.logService.error("iframeManagerService.updateExperience() - failed to update experience");return Promise.reject(e)}))}),(e=>{this.logService.error("ExperienceService.updateExperience() - failed to retrieve resource path");return Promise.reject(e)}))}),(e=>{this.logService.error("ExperienceService.updateExperience() - failed to retrieve current experience");return Promise.reject(e)}))}compareWithCurrentExperience(e){if(!e){return Promise.resolve(false)}return this.getCurrentExperience().then((t=>{if(!t){return Promise.resolve(false)}if(t.pageId===e.pageId&&t.siteDescriptor.uid===e.siteId&&t.catalogDescriptor.catalogId===e.catalogId&&t.catalogDescriptor.catalogVersion===e.catalogVersion){return Promise.resolve(true)}return Promise.resolve(false)}))}};X.$inject=["seStorageManager","storagePropertiesService","logService","crossFrameEventService","siteService","previewService","catalogService","languageService","sharedDataService","iframeManagerService","routingService"];X=__decorate([d.SeDowngradeService(d.IExperienceService),d.GatewayProxied("loadExperience","updateExperiencePageContext","getCurrentExperience","hasCatalogVersionChanged","buildRefreshedPreviewUrl","compareWithCurrentExperience"),__param(3,n.Inject(d.EVENT_SERVICE)),__metadata("design:paramtypes",[d.IStorageManager,d.IStoragePropertiesService,d.LogService,d.CrossFrameEventService,Y,d.IPreviewService,d.ICatalogService,d.LanguageService,d.ISharedDataService,$,d.SmarteditRoutingService])],X);let J=class FeatureService extends d.IFeatureService{constructor(e,t){super(t);this.toolbarServiceFactory=e;this.features=[]}getFeatureProperty(e,t){const o=this._getFeatureByKey(e);return Promise.resolve(o?o[t]:null)}getFeatureKeys(){return this.features.map((e=>e.key))}addToolbarItem(e){const t=this.toolbarServiceFactory.getToolbarService(e.toolbarId);e.enablingCallback=function(){this.addItems([e])}.bind(t);e.disablingCallback=function(){this.removeItemByKey(e.key)}.bind(t);return this.register(e)}_registerAliases(e){const t=this._getFeatureByKey(e.key);if(!t){e.id=btoa(e.key);this.features.push(e)}return Promise.resolve()}_getFeatureByKey(e){return this.features.find((t=>t.key===e))}};J.$inject=["toolbarServiceFactory","cloneableUtils"];J=__decorate([d.SeDowngradeService(d.IFeatureService),d.GatewayProxied("_registerAliases","addToolbarItem","register","enable","disable","_remoteEnablingFromInner","_remoteDisablingFromInner","addDecorator","getFeatureProperty","addContextualMenuButton"),__metadata("design:paramtypes",[d.IToolbarServiceFactory,d.CloneableUtils])],J);let ee=class PageInfoService extends d.IPageInfoService{constructor(){super()}};ee=__decorate([d.SeDowngradeService(d.IPageInfoService),d.GatewayProxied("getPageUID","getPageUUID","getCatalogVersionUUIDFromPage","isSameCatalogVersionOfPageAndPageTemplate"),__metadata("design:paramtypes",[])],ee);let te=class PreviewService extends d.IPreviewService{constructor(e,t,o,n){super(n);this.log=e;this.loadConfigManagerService=t;this.restServiceFactory=o;this.ticketIdIdentifier="ticketId"}createPreview(e){return __awaiter(this,void 0,void 0,(function*(){const t=["catalogVersions","resourcePath"];this.validatePreviewDataAttributes(e,t);yield this.prepareRestService();try{const t=yield this.previewRestService.save(e);return d.objectUtils.copy(t)}catch(e){this.log.error("PreviewService.createPreview() - Error creating preview");return Promise.reject(e)}}))}updatePreview(e){return __awaiter(this,void 0,void 0,(function*(){const t=["catalogVersions","resourcePath","ticketId"];this.validatePreviewDataAttributes(e,t);yield this.prepareRestService();try{return yield this.previewByticketRestService.update(e)}catch(e){this.log.error("PreviewService.updatePreview() - Error updating preview");return Promise.reject(e)}}))}getResourcePathFromPreviewUrl(e){return this.prepareRestService().then((()=>this.urlUtils.getAbsoluteURL(this.domain,e)))}prepareRestService(){if(!this.previewRestService||!this.previewByticketRestService){return this.loadConfigManagerService.loadAsObject().then((e=>{const t=e.previewTicketURI||d.PREVIEW_RESOURCE_URI;this.previewRestService=this.restServiceFactory.get(t);this.previewByticketRestService=this.restServiceFactory.get(t,this.ticketIdIdentifier);this.domain=e.domain}),(e=>{this.log.error("PreviewService.getRestService() - Error loading configuration");return Promise.reject(e)}))}return Promise.resolve()}validatePreviewDataAttributes(e,t){if(t){t.forEach((t=>{if(r.isEmpty(e[t])){throw new Error(`ValidatePreviewDataAttributes - ${t} is empty`)}}))}}};te.$inject=["log","loadConfigManagerService","restServiceFactory","urlUtils"];te=__decorate([d.GatewayProxied(),d.SeDowngradeService(d.IPreviewService),__metadata("design:paramtypes",[d.LogService,t.LoadConfigManagerService,d.RestServiceFactory,d.UrlUtils])],te);let ie=class PerspectiveService extends d.IPerspectiveService{constructor(e,t,o,n,s,a,r,p){super();this.routingService=e;this.logService=t;this.systemEventService=o;this.featureService=n;this.waitDialogService=s;this.storageService=a;this.crossFrameEventService=r;this.permissionService=p;this.PERSPECTIVE_COOKIE_NAME="smartedit-perspectives";this.INITIAL_SWITCHTO_ARG="INITIAL_SWITCHTO_ARG";this.data={activePerspective:undefined,previousPerspective:undefined,previousSwitchToArg:this.INITIAL_SWITCHTO_ARG};this.immutablePerspectives=[];this.perspectives=[];this._addDefaultPerspectives();this._registerEventHandlers();this.NON_PERSPECTIVE_OBJECT={key:d.NONE_PERSPECTIVE,nameI18nKey:"",features:[]}}register(e){this._validate(e);let t=this._findByKey(e.key);if(!t){this._addPerspectiveSelectorWidget(e);t=e;t.isHotkeyDisabled=!!e.isHotkeyDisabled;this.immutablePerspectives.push(t);this.perspectives.push(t);this.systemEventService.publishAsync(d.EVENT_PERSPECTIVE_ADDED)}else{t.features=d.objectUtils.uniqueArray(t.features||[],e.features||[]);t.perspectives=d.objectUtils.uniqueArray(t.perspectives||[],e.perspectives||[]);t.permissions=d.objectUtils.uniqueArray(t.permissions||[],e.permissions||[]);this.systemEventService.publishAsync(d.EVENT_PERSPECTIVE_UPDATED)}return Promise.resolve()}getPerspectives(){const e=[];this.immutablePerspectives.forEach((t=>{let o;if(t.permissions&&t.permissions.length>0){o=this.permissionService.isPermitted([{names:t.permissions}])}else{o=Promise.resolve(true)}e.push(o)}));return Promise.all(e).then((e=>this.immutablePerspectives.filter(((t,o)=>e[o]))))}hasActivePerspective(){return Promise.resolve(Boolean(this.data.activePerspective))}getActivePerspective(){return this.data.activePerspective?Object.assign({},this._findByKey(this.data.activePerspective.key)):null}isEmptyPerspectiveActive(){return Promise.resolve(!!this.data.activePerspective&&this.data.activePerspective.key===d.NONE_PERSPECTIVE)}switchTo(e){if(!this._changeActivePerspective(e)){this.waitDialogService.hideWaitModal();return Promise.resolve()}this._handleUnloadEvent(e);this.waitDialogService.showWaitModal();const t=[];if(this.data.previousPerspective){this._fetchAllFeatures(this.data.previousPerspective,t)}const o=[];this._fetchAllFeatures(this.data.activePerspective,o);t.filter((e=>!o.some((t=>e===t)))).forEach((e=>{this.featureService.disable(e)}));const n=[];o.filter((e=>!t.some((t=>e===t)))).forEach((e=>{n.push(this._enableOrDisableFeature(e))}));return Promise.all(n).then((()=>{if(this.data.activePerspective.key===d.NONE_PERSPECTIVE){this.waitDialogService.hideWaitModal()}this.crossFrameEventService.publish(d.EVENT_PERSPECTIVE_CHANGED,this.data.activePerspective.key!==d.NONE_PERSPECTIVE)}))}selectDefault(){return this.getPerspectives().then((e=>this.storageService.getValueFromLocalStorage(this.PERSPECTIVE_COOKIE_NAME,true).then((t=>{const o=e.find((e=>e.key===t));let n;let s;if(!o){this.logService.warn('Cannot select mode "'+t+'" It might not exist or is restricted.');const e=this._findByKey(t);if(!!e){this._disableAllFeaturesForPerspective(e)}n=this.NON_PERSPECTIVE_OBJECT;s=this.NON_PERSPECTIVE_OBJECT}else{const e=this._findByKey(t);n=e?e:this.NON_PERSPECTIVE_OBJECT;s=this.data.previousPerspective?this.data.previousPerspective:n}if(n.key!==this.NON_PERSPECTIVE_OBJECT.key){this._disableAllFeaturesForPerspective(n)}return this.switchTo(s.key)}))))}refreshPerspective(){return this.getPerspectives().then((e=>{const t=this.getActivePerspective();if(!t){return this.selectDefault()}else{this.perspectives=e;if(!this._findByKey(t.key)){return this.switchTo(d.NONE_PERSPECTIVE)}else{const e=[];const o=[];this._fetchAllFeatures(t,e);e.forEach((e=>{o.push(this._enableOrDisableFeature(e))}));return Promise.all(o).then((()=>{this.waitDialogService.hideWaitModal();this.crossFrameEventService.publish(d.EVENT_PERSPECTIVE_REFRESHED,t.key!==d.NONE_PERSPECTIVE)}))}}}))}getActivePerspectiveKey(){const e=this.getActivePerspective();return Promise.resolve(e?e.key:null)}isHotkeyEnabledForActivePerspective(){const e=this.getActivePerspective();return Promise.resolve(e&&!e.isHotkeyDisabled)}_addPerspectiveSelectorWidget(e){e.features=e.features||[];if(e.features.indexOf(d.PERSPECTIVE_SELECTOR_WIDGET_KEY)===-1){e.features.unshift(d.PERSPECTIVE_SELECTOR_WIDGET_KEY)}}_addDefaultPerspectives(){this.register({key:d.NONE_PERSPECTIVE,nameI18nKey:"se.perspective.none.name",isHotkeyDisabled:true,descriptionI18nKey:"se.perspective.none.description.disabled"});this.register({key:d.ALL_PERSPECTIVE,nameI18nKey:"se.perspective.all.name",descriptionI18nKey:"se.perspective.all.description"})}_registerEventHandlers(){this.systemEventService.subscribe(d.EVENTS.LOGOUT,this._clearPerspectiveFeatures.bind(this));this.crossFrameEventService.subscribe(d.EVENTS.USER_HAS_CHANGED,this._clearPerspectiveFeatures.bind(this));this.routingService.routeChangeSuccess().subscribe((e=>{const t=this.routingService.getCurrentUrlFromEvent(e);if((t||"").includes(d.STORE_FRONT_CONTEXT)){this._clearPerspectiveFeatures()}}))}_validate(e){if(d.stringUtils.isBlank(e.key)){throw new Error("perspectiveService.configuration.key.error.required")}if(d.stringUtils.isBlank(e.nameI18nKey)){throw new Error("perspectiveService.configuration.nameI18nKey.error.required")}if([d.NONE_PERSPECTIVE,d.ALL_PERSPECTIVE].indexOf(e.key)===-1&&(d.stringUtils.isBlank(e.features)||e.features.length===0)){throw new Error("perspectiveService.configuration.features.error.required")}}_findByKey(e){return this.perspectives.find((t=>t.key===e))}_fetchAllFeatures(e,t){if(!t){t=[]}if(e.key===d.ALL_PERSPECTIVE){d.objectUtils.uniqueArray(t,this.featureService.getFeatureKeys()||[])}else{d.objectUtils.uniqueArray(t,e.features||[]);(e.perspectives||[]).forEach((e=>{const o=this._findByKey(e);if(o){this._fetchAllFeatures(o,t)}else{this.logService.debug("nested perspective "+e+" was not found in the registry")}}))}}_enableOrDisableFeature(e){return this.featureService.getFeatureProperty(e,"permissions").then((t=>{if(!Array.isArray(t)){t=[]}return this.permissionService.isPermitted([{names:t}]).then((t=>{if(t){this.featureService.enable(e)}else{this.featureService.disable(e)}}))}))}_handleUnloadEvent(e){if(e!==this.data.previousSwitchToArg&&this.data.previousSwitchToArg!==this.INITIAL_SWITCHTO_ARG){this.crossFrameEventService.publish(d.EVENT_PERSPECTIVE_UNLOADING,this.data.previousSwitchToArg)}this.data.previousSwitchToArg=e}_retrievePerspective(e){if(this.data.activePerspective&&this.data.activePerspective.key===e){return null}const t=this._findByKey(e);if(!t){throw new Error("switchTo() - Couldn't find perspective with key "+e)}return t}_changeActivePerspective(e){const t=this._retrievePerspective(e);if(t){this.data.previousPerspective=this.data.activePerspective;this.data.activePerspective=t;this.storageService.setValueInLocalStorage(this.PERSPECTIVE_COOKIE_NAME,t.key,true)}return t}_disableAllFeaturesForPerspective(e){const t=[];this._fetchAllFeatures(e,t);t.forEach((e=>{this.featureService.disable(e)}))}_clearPerspectiveFeatures(){const e=[];if(this.data&&this.data.activePerspective){this._fetchAllFeatures(this.data.activePerspective,e)}e.forEach((e=>{this.featureService.disable(e)}));return Promise.resolve()}};ie.$inject=["routingService","logService","systemEventService","featureService","waitDialogService","storageService","crossFrameEventService","permissionService"];ie=__decorate([d.SeDowngradeService(d.IPerspectiveService),d.GatewayProxied("register","switchTo","hasActivePerspective","isEmptyPerspectiveActive","selectDefault","refreshPerspective","getActivePerspectiveKey","isHotkeyEnabledForActivePerspective"),__metadata("design:paramtypes",[d.SmarteditRoutingService,d.LogService,d.SystemEventService,d.IFeatureService,d.IWaitDialogService,d.IStorageService,d.CrossFrameEventService,d.IPermissionService])],ie);t.SessionService=class SessionService extends d.ISessionService{constructor(e,t,o,n){super();this.$log=e;this.storageService=o;this.cryptographicUtils=n;this.USER_DATA_URI="/cmswebservices/v1/users/:userUid";this.whoAmIService=t.get(d.WHO_AM_I_RESOURCE_URI);this.userRestService=t.get(this.USER_DATA_URI)}getCurrentUserDisplayName(){return this.getCurrentUserData().then((e=>e.displayName))}getCurrentUsername(){return this.getCurrentUserData().then((e=>e.uid))}getCurrentUser(){return this.getCurrentUserData()}hasUserChanged(){const e=Promise.resolve(this.cachedUserHash?this.cachedUserHash:this.storageService.getItem(d.PREVIOUS_USERNAME_HASH));return e.then((e=>this.whoAmIService.get({}).then((t=>!!e&&e!==this.cryptographicUtils.sha1Hash(t.uid)))))}setCurrentUsername(){return this.whoAmIService.get({}).then((e=>{this.cachedUserHash=this.cryptographicUtils.sha1Hash(e.uid);this.storageService.setItem(d.PREVIOUS_USERNAME_HASH,this.cachedUserHash)}))}getCurrentUserData(){return this.whoAmIService.get({}).then((e=>this.userRestService.get({userUid:e.uid}).then((t=>({uid:t.uid,displayName:e.displayName,readableLanguages:t.readableLanguages,writeableLanguages:t.writeableLanguages}))))).catch((e=>{this.$log.warn("[SessionService]: Can't load session information",e);return null}))}};t.SessionService.$inject=["$log","restServiceFactory","storageService","cryptographicUtils"];__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.userEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.SessionService.prototype,"getCurrentUserData",null);t.SessionService=__decorate([d.SeDowngradeService(d.ISessionService),d.GatewayProxied("getCurrentUsername","getCurrentUserDisplayName","hasUserChanged","setCurrentUsername","getCurrentUser"),__metadata("design:paramtypes",[d.LogService,d.RestServiceFactory,d.IStorageService,d.CryptographicUtils])],t.SessionService);t.SharedDataService=class SharedDataService extends d.ISharedDataService{constructor(){super();this.storage={}}get(e){return Promise.resolve(this.storage[e])}set(e,t){this.storage[e]=t;return Promise.resolve()}update(e,t){return this.get(e).then((o=>t(o).then((t=>this.set(e,t)))))}remove(e){const t=this.storage[e];delete this.storage[e];return Promise.resolve(t)}containsKey(e){return Promise.resolve(r.has(this.storage,e))}};t.SharedDataService=__decorate([d.SeDowngradeService(d.ISharedDataService),d.GatewayProxied(),n.Injectable(),__metadata("design:paramtypes",[])],t.SharedDataService);t.StorageService=class StorageService extends d.IStorageService{constructor(e,t,o,n){super();this.logService=e;this.windowUtils=t;this.cryptographicUtils=o;this.fingerPrintingService=n;this.SMARTEDIT_SESSIONS="smartedit-sessions";this.CUSTOM_PROPERTIES="custom_properties"}isInitialized(){const e=this.getAuthTokens();return Promise.resolve(r.values(r.omit(e,[this.CUSTOM_PROPERTIES])).length>0)}storeAuthToken(e,t){const o=this.getAuthTokens();o[e]=t;this._setSmarteditSessions(o);return Promise.resolve()}getAuthToken(e){const t=this.getAuthTokens();return Promise.resolve(t[e])}removeAuthToken(e){const t=this.getAuthTokens();delete t[e];this._setSmarteditSessions(t);return Promise.resolve()}removeAllAuthTokens(){this._removeAllAuthTokens();return Promise.resolve()}getValueFromCookie(e,t){throw new Error("getValueFromCookie deprecated since 1905, use getValueFromLocalStorage")}getValueFromLocalStorage(e,t){return Promise.resolve(this._getValueFromLocalStorage(e,t))}getAuthTokens(){const e=this.windowUtils.getWindow().localStorage.getItem(this.SMARTEDIT_SESSIONS);let t;if(e){try{const o=this.cryptographicUtils.aesDecrypt(e,this.fingerPrintingService.getFingerprint());t=JSON.parse(decodeURIComponent(escape(o)))}catch(e){this.logService.info("Failed to read authentication token. Forcing a re-authentication.")}}return t||{}}putValueInCookie(e,t,o){throw new Error("putValueInCookie deprecated since 1905, use setValueInLocalStorage")}setValueInLocalStorage(e,t,o){return Promise.resolve(this._setValueInLocalStorage(e,t,o))}setItem(e,t){const o=this.getAuthTokens();o[this.CUSTOM_PROPERTIES]=o[this.CUSTOM_PROPERTIES]||{};o[this.CUSTOM_PROPERTIES][e]=t;this._setSmarteditSessions(o);return Promise.resolve()}getItem(e){const t=this.getAuthTokens();t[this.CUSTOM_PROPERTIES]=t[this.CUSTOM_PROPERTIES]||{};return Promise.resolve(t[this.CUSTOM_PROPERTIES][e])}_removeAllAuthTokens(){const e=this.getAuthTokens();const t=r.pick(e,[this.CUSTOM_PROPERTIES]);this._setSmarteditSessions(t)}_getValueFromLocalStorage(e,t){const o=this.windowUtils.getWindow().localStorage.getItem(e);let n=null;if(o){try{n=JSON.parse(t?decodeURIComponent(escape(window.atob(o))):o)}catch(e){this.logService.error("Failed during deserialization ",e)}}return n}_setSmarteditSessions(e){const t=btoa(unescape(encodeURIComponent(JSON.stringify(e))));const o=this.cryptographicUtils.aesBase64Encrypt(t,this.fingerPrintingService.getFingerprint());this.windowUtils.getWindow().localStorage.setItem(this.SMARTEDIT_SESSIONS,o)}_setValueInLocalStorage(e,t,o){let n=JSON.stringify(t);n=o?btoa(unescape(encodeURIComponent(n))):n;this.windowUtils.getWindow().localStorage.setItem(e,n)}};t.StorageService.$inject=["logService","windowUtils","cryptographicUtils","fingerPrintingService"];t.StorageService=__decorate([d.SeDowngradeService(d.IStorageService),d.GatewayProxied("isInitialized","storeAuthToken","getAuthToken","removeAuthToken","removeAllAuthTokens","storePrincipalIdentifier","getPrincipalIdentifier","removePrincipalIdentifier","getValueFromCookie","getValueFromLocalStorage"),n.Injectable(),__metadata("design:paramtypes",[d.LogService,d.WindowUtils,d.CryptographicUtils,d.FingerPrintingService])],t.StorageService);let oe=class PermissionsRegistrationService{constructor(e,t){this.permissionService=e;this.sharedDataService=t}registerRulesAndPermissions(){this.permissionService.registerRule({names:["se.slot.belongs.to.page"],verify:e=>this.sharedDataService.get(d.EXPERIENCE_STORAGE_KEY).then((t=>t.pageContext&&t.pageContext.catalogVersionUuid===e[0].context.slotCatalogVersionUuid))});this.permissionService.registerPermission({aliases:["se.slot.not.external"],rules:["se.slot.belongs.to.page"]})}};oe.$inject=["permissionService","sharedDataService"];oe=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.IPermissionService,d.ISharedDataService])],oe);let ne=class CatalogService extends d.ICatalogService{constructor(e,t,o,n,s,a,r){super();this.logService=e;this.sharedDataService=t;this.siteService=o;this.urlService=n;this.contentCatalogRestService=s;this.productCatalogRestService=a;this.storageService=r;this.SELECTED_SITE_COOKIE_NAME="seselectedsite"}getContentCatalogsForSite(e){return this.contentCatalogRestService.get({siteUID:e}).then((e=>e.catalogs))}getCatalogByVersion(e,t){return this.getContentCatalogsForSite(e).then((e=>e.filter((e=>e.versions.some((e=>e.version===t))))))}isContentCatalogVersionNonActive(e){return this._getContext(e).then((e=>this.getContentCatalogsForSite(e[d.CONTEXT_SITE_ID]).then((t=>{const o=t.find((t=>t.catalogId===e[d.CONTEXT_CATALOG]));const n=o?o.versions.find((t=>t.version===e[d.CONTEXT_CATALOG_VERSION])):null;if(!n){throw new Error(`Invalid uriContext ${e}, cannot find catalog version.`)}return!n.active}))))}getContentCatalogActiveVersion(e){return this._getContext(e).then((e=>this.getContentCatalogsForSite(e[d.CONTEXT_SITE_ID]).then((t=>{const o=t.find((t=>t.catalogId===e[d.CONTEXT_CATALOG]));const n=o?o.versions.find((e=>e.active)):null;if(!n){throw new Error(`Invalid uriContext ${e}, cannot find catalog version.`)}return n.version}))))}getActiveContentCatalogVersionByCatalogId(e){return this._getContext().then((t=>this.getContentCatalogsForSite(t[d.CONTEXT_SITE_ID]).then((t=>{const o=t.find((t=>t.catalogId===e));const n=o?o.versions.find((e=>e.active)):null;if(!n){throw new Error(`Invalid content catalog ${e}, cannot find any active catalog version.`)}return n.version}))))}getContentCatalogVersion(e){return this._getContext(e).then((e=>this.getContentCatalogsForSite(e[d.CONTEXT_SITE_ID]).then((t=>{const o=t.find((t=>t.catalogId===e[d.CONTEXT_CATALOG]));if(!o){throw new Error("no catalog "+e[d.CONTEXT_CATALOG]+" found for site "+e[d.CONTEXT_SITE_ID])}const n=o.versions.find((t=>t.version===e[d.CONTEXT_CATALOG_VERSION]));if(!n){throw new Error(`no catalogVersion ${e[d.CONTEXT_CATALOG_VERSION]} for catalog ${e[d.CONTEXT_CATALOG]} and site ${e[d.CONTEXT_SITE_ID]}`)}n.catalogName=o.name;n.catalogId=o.catalogId;return n}))))}getCurrentSiteID(){return this.storageService.getValueFromLocalStorage(this.SELECTED_SITE_COOKIE_NAME,false)}getDefaultSiteForContentCatalog(e){return this.siteService.getSites().then((t=>{const o=t.filter((t=>{const o=r.last(t.contentCatalogs);return o&&o===e}));if(o.length===0){this.logService.warn(`[catalogService] - No default site found for content catalog ${e}`)}else if(o.length>1){this.logService.warn(`[catalogService] - Many default sites found for content catalog ${e}`)}return o[0]}))}getCatalogVersionByUuid(e,t){return this.getAllContentCatalogsGroupedById().then((o=>{const n=r.reduce(o,((e,t)=>e.concat(t)),[]);const s=r.flatten(n.map((e=>r.cloneDeep(e.versions).map((t=>{t.catalogName=e.name;t.catalogId=e.catalogId;return t}))))).filter((o=>e===o.uuid&&(!t||t===o.siteDescriptor.uid)))[0];if(!s){const o="Cannot find catalog version with UUID "+e+(t?" in site "+t:"");throw new Error(o)}return this.getCurrentSiteID().then((e=>{s.siteId=e;return s}))}))}getAllContentCatalogsGroupedById(){return this.siteService.getSites().then((e=>{const t=e.map((e=>this.getContentCatalogsForSite(e.uid).then((t=>{t.forEach((t=>{t.versions=t.versions.map((t=>{t.siteDescriptor=e;return t}))}));return t}))));return Promise.all(t)}))}getProductCatalogsBySiteKey(e){return this._getContext().then((t=>this.getProductCatalogsForSite(t[e])))}getProductCatalogsForSite(e){return this.productCatalogRestService.get({siteUID:e}).then((e=>e.catalogs))}getActiveProductCatalogVersionByCatalogId(e){return this.getProductCatalogsBySiteKey(d.CONTEXT_SITE_ID).then((t=>{const o=t.find((t=>t.catalogId===e));const n=o?o.versions.find((e=>e.active)):null;if(!n){throw new Error(`Invalid product catalog ${e}, cannot find any active catalog version.`)}return n.version}))}getCatalogVersionUUid(e){return this.getContentCatalogVersion(e).then((e=>e.uuid))}retrieveUriContext(e){return this._getContext(e)}returnActiveCatalogVersionUIDs(e){return e.reduce(((e,t)=>{e.push(t.versions.find((e=>e.active)).uuid);return e}),[])}isCurrentCatalogMultiCountry(){return this.sharedDataService.get(d.EXPERIENCE_STORAGE_KEY).then((e=>{if(e&&e.siteDescriptor&&e.catalogDescriptor){const t=e.siteDescriptor.uid;const o=e.catalogDescriptor.catalogId;return this.getContentCatalogsForSite(t).then((e=>{const t=e.find((e=>e.catalogId===o));return Promise.resolve(t&&t.parents&&t.parents.length?true:false)}))}return false}))}_getContext(e){return e?Promise.resolve(e):this.sharedDataService.get(d.EXPERIENCE_STORAGE_KEY).then((e=>{if(!e){throw new Error("catalogService was not provided with a uriContext and could not retrive an experience from sharedDataService")}return this.urlService.buildUriContext(e.siteDescriptor.uid,e.catalogDescriptor.catalogId,e.catalogDescriptor.catalogVersion)}))}};ne.$inject=["logService","sharedDataService","siteService","urlService","contentCatalogRestService","productCatalogRestService","storageService"];__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.catalogEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],ne.prototype,"getProductCatalogsForSite",null);__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.pageChangeEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],ne.prototype,"isCurrentCatalogMultiCountry",null);ne=__decorate([d.SeDowngradeService(d.ICatalogService),d.GatewayProxied(),__metadata("design:paramtypes",[d.LogService,d.ISharedDataService,Y,d.IUrlService,d.ContentCatalogRestService,d.ProductCatalogRestService,d.IStorageService])],ne);let se=class UrlService extends d.IUrlService{constructor(e,t,o){super();this.router=e;this.location=t;this.windowUtils=o}openUrlInPopup(e){const t=this.windowUtils.getWindow().open(e,"_blank","toolbar=no, scrollbars=yes, resizable=yes");t.focus()}path(e){this.location.go(e);this.router.navigateByUrl(e)}};se.$inject=["router","location","windowUtils"];se=__decorate([d.SeDowngradeService(d.IUrlService),d.GatewayProxied("openUrlInPopup","path"),n.Injectable(),__metadata("design:paramtypes",[u.Router,g.Location,d.WindowUtils])],se);let ae=class WaitDialogService extends d.IWaitDialogService{constructor(e){super();this.modalService=e;this.modalRef=null}showWaitModal(e){const t={component:d.WaitDialogComponent,data:{customLoadingMessageLocalizedKey:e},config:{backdropClickCloseable:false,modalPanelClass:"se-wait-spinner-dialog",focusTrapped:false}};if(this.modalRef===null){this.modalRef=this.modalService.open(t)}}hideWaitModal(){if(this.modalRef!=null){this.modalRef.close();this.modalRef=null}}};ae.$inject=["modalService"];ae=__decorate([d.SeDowngradeService(d.IWaitDialogService),d.GatewayProxied(),__metadata("design:paramtypes",[d.ModalService])],ae);class MemoryStorage{constructor(){this.data={}}clear(){this.data={};return Promise.resolve(true)}dispose(){return Promise.resolve(true)}find(e){return this.get(e).then((e=>[e]))}get(e){return Promise.resolve(this.data[this.getKey(e)])}getLength(){return Promise.resolve(Object.keys(this.data).length)}put(e,t){this.data[this.getKey(t)]=e;return Promise.resolve(true)}remove(e){const t=this.data[this.getKey(e)];delete this.data[this.getKey(e)];return Promise.resolve(t)}entries(){const e=[];Object.keys(this.data).forEach((t=>{e.push([JSON.parse(t),this.data[t]])}));return Promise.resolve(e)}getKey(e){return JSON.stringify(e)}}class MemoryStorageController{constructor(e){this.storages={};this.storageType=e.getProperty("STORAGE_TYPE_IN_MEMORY")}getStorage(e){let t=this.storages[e.storageId];if(!t){t=new MemoryStorage}this.storages[e.storageId]=t;return Promise.resolve(t)}deleteStorage(e){delete this.storages[e];return Promise.resolve(true)}getStorageIds(){return Promise.resolve(Object.keys(this.storages))}}class WebStorage{constructor(e,t){this.controller=e;this.storageConfiguration=t}static ERR_INVALID_QUERY_OBJECT(e,t){return new Error(`WebStorage exception for storage [${t}]. Invalid key [${e}]`)}clear(){this.controller.saveStorageData({});return Promise.resolve(true)}find(e){if(e===undefined){throw WebStorage.ERR_INVALID_QUERY_OBJECT(e,this.storageConfiguration.storageId)}return this.get(e).then((e=>[e]))}get(e){return this.controller.getStorageData().then((t=>{const o=this.getKeyFromQueryObj(e);return Promise.resolve(t[o])}))}put(e,t){return this.controller.getStorageData().then((o=>{o[this.getKeyFromQueryObj(t)]=e;this.controller.saveStorageData(o);return Promise.resolve(true)}))}remove(e){if(e===undefined){throw WebStorage.ERR_INVALID_QUERY_OBJECT(e,this.storageConfiguration.storageId)}const t=this.get(e);return this.controller.getStorageData().then((o=>{delete o[this.getKeyFromQueryObj(e)];this.controller.saveStorageData(o);return t}))}getLength(){return this.controller.getStorageData().then((e=>Promise.resolve(Object.keys(e).length)))}dispose(){return Promise.resolve(true)}entries(){const e=[];return new Promise((t=>{this.controller.getStorageData().then((o=>{Object.keys(o).forEach((t=>{e.push([JSON.parse(t),o[t]])}));t(e)}))}))}getKeyFromQueryObj(e){return JSON.stringify(e)}}class WebStorageBridge{constructor(e,t){this.controller=e;this.configuration=t}saveStorageData(e){return this.controller.saveStorageData(this.configuration.storageId,e)}getStorageData(){return this.controller.getStorageData(this.configuration.storageId)}}class AbstractWebStorageController{getStorage(e){const t=new WebStorageBridge(this,e);const o=new WebStorage(t,e);const n=o.dispose;o.dispose=()=>this.deleteStorage(e.storageId).then((()=>n()));return Promise.resolve(o)}deleteStorage(e){const t=this.getWebStorageContainer();delete t[e];this.setWebStorageContainer(t);return Promise.resolve(true)}getStorageIds(){const e=Object.keys(this.getWebStorageContainer());return Promise.resolve(e)}saveStorageData(e,t){const o=this.getWebStorageContainer();o[e]=t;this.setWebStorageContainer(o);return Promise.resolve(true)}getStorageData(e){const t=this.getWebStorageContainer();if(t[e]){return Promise.resolve(t[e])}return Promise.resolve({})}setWebStorageContainer(e){this.getStorageApi().setItem(this.getStorageRootKey(),JSON.stringify(e))}getWebStorageContainer(){const e=this.getStorageApi().getItem(this.getStorageRootKey());if(!e){return{}}return JSON.parse(e)}}class LocalStorageController extends AbstractWebStorageController{constructor(e){super();this.storagePropertiesService=e;this.storageType=this.storagePropertiesService.getProperty("STORAGE_TYPE_LOCAL_STORAGE")}getStorageApi(){return window.localStorage}getStorageRootKey(){return this.storagePropertiesService.getProperty("LOCAL_STORAGE_ROOT_KEY")}}class SessionStorageController extends AbstractWebStorageController{constructor(e){super();this.storagePropertiesService=e;this.storageType=this.storagePropertiesService.getProperty("STORAGE_TYPE_SESSION_STORAGE")}getStorageApi(){return window.sessionStorage}getStorageRootKey(){return this.storagePropertiesService.getProperty("SESSION_STORAGE_ROOT_KEY")}}let re=class StorageManagerGateway{constructor(e){this.storageManager=e}getStorageSanitityCheck(e){return this.storageManager.getStorage(e).then((()=>true),(()=>false))}deleteExpiredStorages(e){return this.storageManager.deleteExpiredStorages(e)}deleteStorage(e,t){return this.storageManager.deleteStorage(e,t)}hasStorage(e){return this.storageManager.hasStorage(e)}getStorage(e){throw new Error(`getStorage() is not supported from the StorageManagerGateway, please use the storage manager directly`)}registerStorageController(e){throw new Error(`registerStorageController() is not supported from the StorageManagerGateway, please use the storage manager directly`)}};re.$inject=["storageManager"];re=__decorate([d.SeDowngradeService(d.IStorageManagerGateway),d.GatewayProxied("getStorageSanitityCheck","deleteExpiredStorages","deleteStorage","hasStorage"),__param(0,n.Inject(d.DO_NOT_USE_STORAGE_MANAGER_TOKEN)),__metadata("design:paramtypes",[d.IStorageManager])],re);let le=class StorageGateway{constructor(e){this.storageManager=e}handleStorageRequest(e,t,o){return new Promise(((n,s)=>{this.storageManager.getStorage(e).then((e=>n(e[t](...o))),(e=>s(e)))}))}};le.$inject=["storageManager"];le=__decorate([d.SeDowngradeService(d.IStorageGateway),d.GatewayProxied(),__param(0,n.Inject(d.DO_NOT_USE_STORAGE_MANAGER_TOKEN)),__metadata("design:paramtypes",[d.IStorageManager])],le);class MetaDataMapStorage{constructor(e){this.storageKey=e}getAll(){const e=[];const t=this.getDataFromStore();Object.keys(t).forEach((o=>{e.push(t[o])}));return e}get(e){return this.getDataFromStore()[e]}put(e,t){const o=this.getDataFromStore();o[e]=t;this.setDataInStore(o)}remove(e){const t=this.getDataFromStore();delete t[e];this.setDataInStore(t)}removeAll(){window.localStorage.removeItem(this.storageKey)}getDataFromStore(){try{const e=window.localStorage.getItem(this.storageKey);if(e===null){return{}}return JSON.parse(e)}catch(e){return{}}}setDataInStore(e){window.localStorage.setItem(this.storageKey,JSON.stringify(e))}}var ce;let de=ce=class StorageManager{constructor(e,t){this.logService=e;this.storagePropertiesService=t;this.storageControllers={};this.storages={};this.storageMetaDataMap=new MetaDataMapStorage(this.storagePropertiesService.getProperty("LOCAL_STORAGE_KEY_STORAGE_MANAGER_METADATA"))}static ERR_NO_STORAGE_TYPE_CONTROLLER(e){return new Error(`StorageManager Error: Cannot create storage. No Controller available to handle type [${e}]`)}registerStorageController(e){this.storageControllers[e.storageType]=e}getStorage(e){this.setDefaultStorageOptions(e);const t=this.hasStorage(e.storageId);let o=Promise.resolve(true);if(t){const t=this.storageMetaDataMap.get(e.storageId);o=this.verifyMetaData(t,e)}return new Promise(((t,n)=>{o.then((()=>{if(this.storages[e.storageId]){this.updateStorageMetaData(e);t(this.storages[e.storageId])}else{this.getStorageController(e.storageType).getStorage(e).then((o=>{this.applyDisposeDecorator(e.storageId,o);this.updateStorageMetaData(e);this.storages[e.storageId]=o;t(o)}))}})).catch((e=>n(e)))}))}hasStorage(e){return!!this.storageMetaDataMap.get(e)}deleteStorage(e,t=false){delete this.storages[e];if(!this.hasStorage(e)){return Promise.resolve(true)}const o=this.storageMetaDataMap.get(e);if(o){let n;try{n=this.getStorageController(o.storageType)}catch(o){if(t){this.storageMetaDataMap.remove(e)}return Promise.resolve(true)}return n.deleteStorage(e).then((()=>{this.storageMetaDataMap.remove(e);return Promise.resolve(true)}))}else{return Promise.resolve(true)}}deleteExpiredStorages(e=false){const t=[];const o=this.storageMetaDataMap.getAll();o.forEach((o=>{if(this.isStorageExpired(o)){t.push(this.deleteStorage(o.storageId,e))}}));return Promise.all(t).then((()=>true),(()=>false))}updateStorageMetaData(e){this.storageMetaDataMap.put(e.storageId,{storageId:e.storageId,storageType:e.storageType,storageVersion:e.storageVersion,lastAccess:Date.now()})}isStorageExpired(e){const t=Date.now()-e.lastAccess;let o=e.expiresAfterIdle;if(o===undefined){o=this.storagePropertiesService.getProperty("STORAGE_IDLE_EXPIRY")}return t>=o}applyDisposeDecorator(e,t){const o=t.dispose;t.dispose=()=>this.deleteStorage(e).then((()=>o()))}getStorageController(e){const t=this.storageControllers[e];if(!t){throw ce.ERR_NO_STORAGE_TYPE_CONTROLLER(e)}return t}verifyMetaData(e,t){if(e.storageVersion!==t.storageVersion){this.logService.warn(`StorageManager - Removing old storage version for storage ${e.storageId}`);return this.deleteStorage(e.storageId)}if(e.storageType!==t.storageType){this.logService.warn(`StorageManager - Detected a change in storage type for existing storage. Removing old storage with id ${t.storageId}`);return this.deleteStorage(e.storageId)}return Promise.resolve(true)}setDefaultStorageOptions(e){if(!e.storageVersion||e.storageVersion.length<=0){e.storageVersion="0"}}};de=ce=__decorate([n.Injectable(),__metadata("design:paramtypes",[d.LogService,d.IStoragePropertiesService])],de);const pe={STORAGE_IDLE_EXPIRY:1e3*60*60*24*30,STORAGE_TYPE_LOCAL_STORAGE:"se.storage.type.localstorage",STORAGE_TYPE_SESSION_STORAGE:"se.storage.type.sessionstorage",STORAGE_TYPE_IN_MEMORY:"se.storage.type.inmemory",LOCAL_STORAGE_KEY_STORAGE_MANAGER_METADATA:"se.storage.storagemanager.metadata",LOCAL_STORAGE_ROOT_KEY:"se.storage.root",SESSION_STORAGE_ROOT_KEY:"se.storage.root"};let me=class StoragePropertiesService{constructor(e){this.properties=r.cloneDeep(pe);e.forEach((e=>{r.merge(this.properties,e)}))}getProperty(e){return this.properties[e]}};me.$inject=["storageProperties"];me=__decorate([d.SeDowngradeService(d.IStoragePropertiesService),__param(0,n.Inject(d.STORAGE_PROPERTIES_TOKEN)),__metadata("design:paramtypes",[Array])],me);var ge;let ue=ge=class StorageModule{static forRoot(e={}){return{ngModule:ge,providers:[{provide:d.STORAGE_PROPERTIES_TOKEN,multi:true,useValue:e}]}}};ue=ge=__decorate([n.NgModule({providers:[{provide:d.IStoragePropertiesService,useClass:me},{provide:d.DO_NOT_USE_STORAGE_MANAGER_TOKEN,useClass:de},{provide:d.IStorageGateway,useClass:le},{provide:d.IStorageManagerGateway,useClass:re},{provide:d.IStorageManagerFactory,useFactory:(e,t)=>new d.StorageManagerFactory(t),deps:[d.LogService,d.DO_NOT_USE_STORAGE_MANAGER_TOKEN]},{provide:d.IStorageManager,useFactory:e=>e.getStorageManager("se.nsp"),deps:[d.IStorageManagerFactory]},d.moduleUtils.initialize(((e,t)=>{t.registerStorageController(new LocalStorageController(e));t.registerStorageController(new SessionStorageController(e));t.registerStorageController(new MemoryStorageController(e));d.diBridgeUtils.downgradeService("storageManagerFactory",d.IStorageManagerFactory);d.diBridgeUtils.downgradeService("seStorageManager",d.IStorageManager)}),[d.IStoragePropertiesService,d.IStorageManager])]})],ue);var he;const ve="se.permission.service.default.rule";let _e=he=class PermissionService extends d.IPermissionService{constructor(e,t,o){super();this.logService=e;this.systemEventService=t;this.crossFrameEventService=o;this._registerEventHandlers()}static resetForTests(){he.rules=[];he.permissionsRegistry=[];he.cachedResults={}}static hasCacheRegion(e){return he.cachedResults.hasOwnProperty(e)}static getCacheRegion(e){return he.cachedResults[e]}getPermission(e){return he.permissionsRegistry.find((t=>t.aliases.indexOf(e)>-1))}unregisterDefaultRule(){const e=this._getRule(ve);if(e){he.rules.splice(he.rules.indexOf(e),1)}}registerPermission(e){this._validatePermission(e);he.permissionsRegistry.push({aliases:e.aliases,rules:e.rules})}hasCachedResult(e,t){return he.hasCacheRegion(e)&&he.getCacheRegion(e).hasOwnProperty(t)}clearCache(){he.cachedResults={};this.crossFrameEventService.publish(d.EVENTS.PERMISSION_CACHE_CLEANED)}isPermitted(e){const t=this._mapRuleNameToPermissionNames(e);const o=this._getRulePromises(t);const n=Object.keys(o);const s=n.map((e=>o[e]));const onSuccess=e=>{const o=n.reduce(((t,o,n)=>{t[o]=e[n];return t}),{});this._updateCache(t,o);return true};const onError=e=>{if(e===false){return e}this.logService.error(e);return e===undefined?false:e};return Promise.all(s).then(onSuccess,onError)}_addRulePromise(e,t,o){const n=this._getRule(o);const s=t[o];const a=this._generateCacheKey(s);let r;if(this.hasCachedResult(o,a)){r=Promise.resolve(this._getCachedResult(o,a))}else{r=this._callRuleVerify(n.names.join("-"),s).then((e=>e?Promise.resolve(true):Promise.reject(false)))}e[o]=r}_isPermissionNameValid(e){const t=/^[A-Za-z0-9_\-]+\.[A-Za-z0-9_\-\.]+/;return t.test(e)}_getRulePromises(e){const t={};Object.keys(e).forEach((o=>{this._addRulePromise.call(this,t,e,o)}));return t}_hasDefaultRule(){return!!this._getRule(ve)}_getCachedResult(e,t){return he.hasCacheRegion(e)?he.getCacheRegion(e)[t]:null}_generateCacheKey(e){return JSON.stringify(e.sort(((e,t)=>{const o=e.name;const n=t.name;return o===n?0:o<n?-1:1})))}_removeDuplicatePermissionNames(e){Object.keys(e).forEach((t=>{e[t]=e[t].filter((o=>{const n=e[t].find((e=>e.name===o.name));if(n===o){return true}else{const e=n.context;const t=o.context;return JSON.stringify(e)!==JSON.stringify(t)}}))}))}_mapRuleNameToPermissionNames(e){const t={};e.forEach((e=>{if(!e.names){throw Error("Requested Permission requires at least one name")}const o=e.names;const n=e.context;o.forEach((e=>{this._populateRulePermissionNames(t,e,n)}))}));this._removeDuplicatePermissionNames(t);return t}_populateRulePermissionNames(e,t,o){const n=this.getPermission(t);const s=!!n&&!!n.rules&&n.rules.length>0;if(s){n.rules.forEach((n=>{this._addPermissionName(e,n,t,o)}))}else if(this._hasDefaultRule()){this._addPermissionName(e,ve,t,o)}else{throw Error("Permission has no rules")}}_addPermissionName(e,t,o,n){const s=this._getRule(t);if(!s){throw Error("Permission found but no rule found named: "+t)}t=s.names[0];if(!e.hasOwnProperty(t)){e[t]=[]}e[t].push({name:o,context:n})}_getRule(e){return he.rules.find((t=>t.names.indexOf(e)>-1))}_validationRule(e){e.names.forEach((e=>{if(this._getRule(e)){throw Error("Rule already exists: "+e)}}))}_validatePermission(e){if(!(e.aliases instanceof Array)){throw Error("Permission aliases must be an array")}if(e.aliases.length<1){throw Error("Permission requires at least one alias")}if(!(e.rules instanceof Array)){throw Error("Permission rules must be an array")}if(e.rules.length<1){throw Error("Permission requires at least one rule")}e.aliases.forEach((e=>{if(this.getPermission(e)){throw Error("Permission already exists: "+e)}if(!this._isPermissionNameValid(e)){throw Error("Permission aliases must be prefixed with namespace and a full stop")}}));e.rules.forEach((e=>{if(!this._getRule(e)){throw Error("Permission found but no rule found named: "+e)}}))}_updateCache(e,t){Object.keys(t).forEach((o=>{const n=this._generateCacheKey(e[o]);const s=t[o];this._addCachedResult(o,n,s)}))}_addCachedResult(e,t,o){if(!he.hasCacheRegion(e)){he.cachedResults[e]={}}he.cachedResults[e][t]=o}_registerRule(e){this._validationRule(e);if(e.names&&e.names.length&&e.names.indexOf(ve)>-1){throw Error("Register default rule using permissionService.registerDefaultRule()")}he.rules.push({names:e.names})}_registerDefaultRule(e){this._validationRule(e);if(e.names&&e.names.length&&e.names.indexOf(ve)===-1){throw Error("Default rule name must be DEFAULT_RULE_NAME")}he.rules.push({names:e.names})}_callRuleVerify(e,t){if(this.ruleVerifyFunctions&&this.ruleVerifyFunctions[e]){return this.ruleVerifyFunctions[e].verify(t)}return this._remoteCallRuleVerify(e,t)}_registerEventHandlers(){this.crossFrameEventService.subscribe(d.EVENTS.USER_HAS_CHANGED,this.clearCache.bind(this));this.systemEventService.subscribe(d.EVENTS.EXPERIENCE_UPDATE,this.clearCache.bind(this));this.crossFrameEventService.subscribe(d.EVENTS.PAGE_CHANGE,this.clearCache.bind(this));this.crossFrameEventService.subscribe(d.EVENT_PERSPECTIVE_CHANGED,this.clearCache.bind(this))}_remoteCallRuleVerify(e,t){"proxyFunction";return null}};_e.rules=[];_e.permissionsRegistry=[];_e.cachedResults={};_e=he=__decorate([d.SeDowngradeService(d.IPermissionService),d.GatewayProxied("isPermitted","clearCache","registerPermission","unregisterDefaultRule","registerDefaultRule","registerRule","_registerRule","_remoteCallRuleVerify","_registerDefaultRule"),__metadata("design:paramtypes",[d.LogService,d.SystemEventService,d.CrossFrameEventService])],_e);let fe=class CatalogVersionPermissionRestService{constructor(e,t){this.restServiceFactory=e;this.sessionService=t;this.URI="/permissionswebservices/v1/permissions/catalogs/search"}getCatalogVersionPermissions(e,t){this.validateParams(e,t);return this.sessionService.getCurrentUsername().then((o=>{const n=this.restServiceFactory.get(this.URI);return n.queryByPost({principalUid:o},{catalogId:e,catalogVersion:t}).then((({permissionsList:e})=>e[0]||{}))}))}validateParams(e,t){if(!e){throw new Error("catalog.version.permission.service.catalogid.is.required")}if(!t){throw new Error("catalog.version.permission.service.catalogversion.is.required")}}};fe.$inject=["restServiceFactory","sessionService"];__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.userEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String,String]),__metadata("design:returntype",Promise)],fe.prototype,"getCatalogVersionPermissions",null);fe=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.RestServiceFactory,d.ISessionService])],fe);window.__smartedit__.addDecoratorPayload("Component","HeartBeatAlertComponent",{selector:"se-heartbeat-alert",template:`<div><span>{{ 'se.heartbeat.failure1' | translate }}</span> <span><a (click)="switchToPreviewMode()">{{ 'se.heartbeat.failure2' | translate }}</a></span></div>`});let ye=class HeartBeatAlertComponent{constructor(e,t,o){this.alertRef=e;this.perspectiveService=t;this.crossFrameEventService=o}switchToPreviewMode(){this.alertRef.dismiss();this.perspectiveService.switchTo(d.NONE_PERSPECTIVE);this.crossFrameEventService.publish(d.EVENT_STRICT_PREVIEW_MODE_REQUESTED,true)}};ye=__decorate([n.Component({selector:"se-heartbeat-alert",template:`<div><span>{{ 'se.heartbeat.failure1' | translate }}</span> <span><a (click)="switchToPreviewMode()">{{ 'se.heartbeat.failure2' | translate }}</a></span></div>`}),__param(2,n.Inject(d.EVENT_SERVICE)),__metadata("design:paramtypes",[f.AlertRef,d.IPerspectiveService,d.CrossFrameEventService])],ye);let Se=class AlertFactory extends d.BaseAlertFactory{constructor(e,t,o){super(e,t,o)}createAlert(e){e=this.getAlertConfigFromStringOrConfig(e);return super.createAlert(e)}createInfo(e){e=this.getAlertConfigFromStringOrConfig(e);e.type=d.IAlertServiceType.INFO;return super.createInfo(e)}createDanger(e){e=this.getAlertConfigFromStringOrConfig(e);e.type=d.IAlertServiceType.DANGER;return super.createDanger(e)}createWarning(e){e=this.getAlertConfigFromStringOrConfig(e);e.type=d.IAlertServiceType.WARNING;return super.createWarning(e)}createSuccess(e){e=this.getAlertConfigFromStringOrConfig(e);e.type=d.IAlertServiceType.SUCCESS;return super.createSuccess(e)}getAlertConfigFromStringOrConfig(e){if(typeof e==="string"){return{message:e}}const t=e;return Object.assign({},t)}};Se.$inject=["fundamentalAlertService","translateService","ALERT_CONFIG_DEFAULTS"];Se=__decorate([d.SeDowngradeService(),n.Injectable(),__param(2,n.Inject(d.ALERT_CONFIG_DEFAULTS_TOKEN)),__metadata("design:paramtypes",[f.AlertService,v.TranslateService,f.AlertConfig])],Se);let Ce=class AlertService extends d.BaseAlertService{constructor(e){super(e);this._alertFactory=e}showAlert(e){e=this._alertFactory.getAlertConfigFromStringOrConfig(e);super.showAlert(e)}showInfo(e){e=this._alertFactory.getAlertConfigFromStringOrConfig(e);super.showInfo(e)}showDanger(e){e=this._alertFactory.getAlertConfigFromStringOrConfig(e);super.showDanger(e)}showWarning(e){e=this._alertFactory.getAlertConfigFromStringOrConfig(e);super.showWarning(e)}showSuccess(e){e=this._alertFactory.getAlertConfigFromStringOrConfig(e);super.showSuccess(e)}};Ce.$inject=["_alertFactory"];Ce=__decorate([d.SeDowngradeService(d.IAlertService),d.GatewayProxied(),n.Injectable(),__metadata("design:paramtypes",[Se])],Ce);t.AlertServiceModule=class AlertServiceModule{};t.AlertServiceModule=__decorate([n.NgModule({imports:[d.AlertModule],providers:[Se,{provide:d.IAlertService,useClass:Ce}]})],t.AlertServiceModule);var be;let Ie=be=class HeartBeatService{constructor(e,t,o,n,s,a,r,p){this.HEART_BEAT_TIMEOUT_THRESHOLD_MS=e;this.routingService=o;this.windowUtils=n;this.crossFrameEventService=a;this.sharedDataService=p;this.reconnectingInProgress=false;this.resetAndStop=()=>{this.reconnectingInProgress=false;if(this.cancellableTimeoutTimer){clearTimeout(this.cancellableTimeoutTimer);this.cancellableTimeoutTimer=null}this.reconnectingAlert.hide();this.reconnectedAlert.hide()};this.connectionLost=()=>{this.resetAndStop();if(!!this.windowUtils.getGatewayTargetFrame()){this.reconnectingAlert.show()}this.reconnectingInProgress=true};this.reconnectingAlert=s.createInfo({component:ye,duration:-1,dismissible:false});this.reconnectedAlert=s.createInfo({message:t.instant("se.heartbeat.reconnection"),duration:3e3});const m=r.createGateway(be.HEART_BEAT_GATEWAY_ID);m.subscribe(be.HEART_BEAT_MSG_ID,(()=>this.heartBeatReceived()));this.crossFrameEventService.subscribe(d.EVENTS.PAGE_CHANGE,(()=>{this.resetAndStop();return this.heartBeatReceived()}));this.routingService.routeChangeSuccess().subscribe((e=>{const t=this.routingService.getCurrentUrlFromEvent(e);if(t===`/${d.NG_ROUTE_PREFIX}${d.STORE_FRONT_CONTEXT}`){return this.heartBeatReceived()}return Promise.resolve()}));this.routingService.routeChangeStart().subscribe((()=>{this.resetAndStop()}))}heartBeatReceived(){const e=this.reconnectingInProgress;this.resetAndStop();if(e){if(!!this.windowUtils.getGatewayTargetFrame()){this.reconnectedAlert.show()}this.reconnectingInProgress=false;this.crossFrameEventService.publish(d.EVENT_STRICT_PREVIEW_MODE_REQUESTED,false)}return this.sharedDataService.get("configuration").then((({heartBeatTimeoutThreshold:e})=>{if(!e){e=this.HEART_BEAT_TIMEOUT_THRESHOLD_MS}this.cancellableTimeoutTimer=this.windowUtils.runTimeoutOutsideAngular(this.connectionLost,+e)}))}};Ie.HEART_BEAT_GATEWAY_ID="heartBeatGateway";Ie.HEART_BEAT_MSG_ID="heartBeat";Ie=be=__decorate([d.SeDowngradeService(),__param(0,n.Inject(d.HEART_BEAT_TIMEOUT_THRESHOLD_MS_TOKEN)),__metadata("design:paramtypes",[Number,v.TranslateService,d.SmarteditRoutingService,d.WindowUtils,Se,d.CrossFrameEventService,d.GatewayFactory,d.ISharedDataService])],Ie);let we=class ConfigurationService{constructor(e,t,o){this.logService=e;this.loadConfigManagerService=t;this.restServiceFactory=o;this.ABSOLUTE_URI_NOT_APPROVED="URI_EXCEPTION";this.ABSOLUTE_URI_REGEX=/(\"[A-Za-z]+:\/|\/\/)/;this.configuration=[];this.editorCRUDService=this.restServiceFactory.get(d.CONFIGURATION_URI,"key")}addEntry(){const e={key:"",value:"",isNew:true,uuid:r.uniqueId()};this.configuration=[e,...this.configuration||[]]}removeEntry(e,t){if(e.isNew){this.configuration=this.configuration.filter((t=>!t.isNew||t.key!==e.key))}else{t.form.markAsDirty();e.toDelete=true}}filterConfiguration(){return(this.configuration||[]).filter((e=>!e.toDelete))}validateUserInput(e){if(!e.value){return}e.requiresUserCheck=!!e.value.match(this.ABSOLUTE_URI_REGEX)}submit(e){if(!e.dirty||!this.isValid(e)){return Promise.reject([])}e.form.markAsPristine();return Promise.all(this.configuration.map(((e,t)=>this.reconstructConfigurationEntry(e,t))))}init(e){this.loadCallback=e||r.noop;return this.loadAndPresent()}reconstructConfigurationEntry(e,t){const o=d.objectUtils.copy(e);let n;o.secured=false;delete o.toDelete;delete o.errors;delete o.uuid;try{if(e.toDelete){n="remove"}else if(o.isNew){n="save";o.value=this.validate(o)}else{n="update";o.value=this.validate(o)}}catch(t){e.hasErrors=true;if(t instanceof d.Errors.ParseError){this.addValueError(e,"se.configurationform.json.parse.error");return Promise.reject({})}}delete o.isNew;e.hasErrors=false;return this.editorCRUDService[n](o).then((()=>{switch(n){case"save":delete e.isNew;break;case"remove":this.configuration.splice(t,1);break}return Promise.resolve({})}),(()=>{this.addValueError(e,"configurationform.save.error");return Promise.reject({})}))}reset(e){this.configuration=d.objectUtils.copy(this.pristine);if(e){e.form.markAsPristine()}if(this.loadCallback){this.loadCallback()}}addError(e,t,o){e.errors=e.errors||{};e.errors[t]=e.errors[t]||[];e.errors[t].push({message:o})}addKeyError(e,t){this.addError(e,"keys",t)}addValueError(e,t){this.addError(e,"values",t)}prettify(e){const t=d.objectUtils.copy(e);t.forEach((e=>{try{e.value=JSON.stringify(JSON.parse(e.value),null,2)}catch(t){this.addValueError(e,"se.configurationform.json.parse.error")}}));return t}loadAndPresent(){return new Promise(((e,t)=>this.loadConfigManagerService.loadAsArray().then((t=>{this.pristine=this.prettify(t.map((e=>Object.assign(Object.assign({},e),{uuid:r.uniqueId()}))));this.reset();e()}),(()=>{this.logService.log("load failed");t()}))))}isValid(e){this.configuration.forEach((e=>{delete e.errors}));if(e.invalid){this.configuration.forEach((e=>{if(d.stringUtils.isBlank(e.key)){this.addKeyError(e,"se.configurationform.required.entry.error");e.hasErrors=true}if(d.stringUtils.isBlank(e.value)){this.addValueError(e,"se.configurationform.required.entry.error");e.hasErrors=true}}))}return e.valid&&!this.configuration.reduce(((e,t)=>{if(e.keys.indexOf(t.key)>-1){this.addKeyError(t,"se.configurationform.duplicate.entry.error");e.errors=true}else{e.keys.push(t.key)}return e}),{keys:[],errors:false}).errors}validate(e){try{if(e.requiresUserCheck&&!e.isCheckedByUser){throw new Error(this.ABSOLUTE_URI_NOT_APPROVED)}return JSON.stringify(JSON.parse(e.value))}catch(t){throw new d.Errors.ParseError(e.value)}}};we.$inject=["logService","loadConfigManagerService","restServiceFactory"];we=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.LogService,t.LoadConfigManagerService,d.RestServiceFactory])],we);let Ee=class IframeClickDetectionService extends d.IIframeClickDetectionService{constructor(){super();this.callbacks={}}registerCallback(e,t){this.callbacks[e]=t;return this.removeCallback.bind(this,e)}removeCallback(e){if(this.callbacks[e]){delete this.callbacks[e];return true}return false}onIframeClick(){for(const e in this.callbacks){if(this.callbacks.hasOwnProperty(e)){this.callbacks[e]()}}}};Ee=__decorate([d.SeDowngradeService(d.IIframeClickDetectionService),d.GatewayProxied("onIframeClick"),n.Injectable(),__metadata("design:paramtypes",[])],Ee);let Te=class RenderService extends d.IRenderService{constructor(e,t,o,n,s,a,r,d){super(e,o,n,s,a,t,r,d);this.yjQuery=e;this.crossFrameEventService=t;this.systemEventService=o}blockRendering(e){this.renderingBlocked=e}isRenderingBlocked(){return Promise.resolve(this.renderingBlocked||false)}};Te.$inject=["yjQuery","crossFrameEventService","systemEventService","notificationService","pageInfoService","perspectiveService","windowUtils","modalService"];Te=__decorate([d.GatewayProxied("blockRendering","isRenderingBlocked","renderSlots","renderComponent","renderRemoval","toggleOverlay","refreshOverlayDimensions","renderPage"),d.SeDowngradeService(d.IRenderService),__param(0,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Function,d.CrossFrameEventService,d.SystemEventService,d.INotificationService,d.IPageInfoService,d.IPerspectiveService,d.WindowUtils,d.ModalService])],Te);window.__smartedit__.addDecoratorPayload("Injectable","TranslationsFetchService",{providedIn:"root"});t.TranslationsFetchService=class TranslationsFetchService extends d.ITranslationsFetchService{constructor(e,t){super();this.httpClient=e;this.promiseUtils=t;this.ready=false}get(e){return this.httpClient.get(`${d.RestServiceFactory.getGlobalBasePath()}${d.I18N_RESOURCE_URI}/${e}`,{responseType:"json"}).pipe(m.map((e=>e.value?e.value:e))).toPromise().then((e=>{this.ready=true;return e}))}isReady(){return Promise.resolve(this.ready)}waitToBeReady(){return this.promiseUtils.resolveToCallbackWhenCondition((()=>this.ready),(()=>{}))}};t.TranslationsFetchService.$inject=["httpClient","promiseUtils"];__decorate([d.Cached({actions:[d.rarelyChangingContent]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.TranslationsFetchService.prototype,"get",null);t.TranslationsFetchService=__decorate([d.SeDowngradeService(d.ITranslationsFetchService),d.GatewayProxied(),n.Injectable({providedIn:"root"}),__metadata("design:paramtypes",[s.HttpClient,d.PromiseUtils])],t.TranslationsFetchService);var Pe;(function(e){e["READ"]="read";e["WRITE"]="write"})(Pe||(Pe={}));let Ae=class CatalogVersionPermissionService extends d.ICatalogVersionPermissionService{constructor(e,t){super();this.catalogVersionPermissionRestService=e;this.catalogService=t}hasPermission(e,t,o,n){return __awaiter(this,void 0,void 0,(function*(){const[s,a]=yield Promise.all([this.shouldIgnoreCatalogPermissions(e,t,o,n),this.catalogVersionPermissionRestService.getCatalogVersionPermissions(t,o)]);if(this.isCatalogVersionPermissionResponse(a)){const t=a.permissions.find((t=>t.key===e));const o=t?t.value:"false";return o==="true"||s}return false}))}hasSyncPermissionFromCurrentToActiveCatalogVersion(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.retrieveUriContext();return yield this.hasSyncPermissionToActiveCatalogVersion(e[d.CONTEXT_CATALOG],e[d.CONTEXT_CATALOG_VERSION])}))}hasSyncPermissionToActiveCatalogVersion(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.catalogService.getActiveContentCatalogVersionByCatalogId(e);return yield this.hasSyncPermission(e,t,o)}))}hasSyncPermission(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.catalogVersionPermissionRestService.getCatalogVersionPermissions(e,t);if(this.isCatalogVersionPermissionResponse(n)&&n.syncPermissions&&n.syncPermissions.length>0){const e=n.syncPermissions.some((e=>e?e.canSynchronize===true&&e.targetCatalogVersion===o:false));return e}return false}))}hasWritePermissionOnCurrent(){return this.hasCurrentCatalogPermission(Pe.WRITE)}hasReadPermissionOnCurrent(){return this.hasCurrentCatalogPermission(Pe.READ)}hasWritePermission(e,t){return this.hasPermission(Pe.WRITE,e,t)}hasReadPermission(e,t){return this.hasPermission(Pe.READ,e,t)}shouldIgnoreCatalogPermissions(e,t,o,n){return __awaiter(this,void 0,void 0,(function*(){const s=n&&e===Pe.READ?this.catalogService.getActiveContentCatalogVersionByCatalogId(t):Promise.resolve();const a=yield s;return a===o}))}hasCurrentCatalogPermission(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.retrieveUriContext();return yield this.hasPermission(e,t[d.CONTEXT_CATALOG],t[d.CONTEXT_CATALOG_VERSION],t[d.CONTEXT_SITE_ID])}))}isCatalogVersionPermissionResponse(e){return!r.isEmpty(e)}};Ae.$inject=["catalogVersionPermissionRestService","catalogService"];Ae=__decorate([d.SeDowngradeService(d.ICatalogVersionPermissionService),d.GatewayProxied("hasWritePermission","hasReadPermission","hasWritePermissionOnCurrent","hasReadPermissionOnCurrent"),__metadata("design:paramtypes",[fe,d.ICatalogService])],Ae);let Oe=class PreviewDatalanguageDropdownPopulator extends d.DropdownPopulatorInterface{constructor(e){super(T,e)}fetchAll(e){if(e.model[e.field.dependsOn]){const t=e.model[e.field.dependsOn].split("|")[0];return this.getLanguageDropdownChoices(t,e.search)}return Promise.resolve([])}getLanguageDropdownChoices(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield this.languageService.getLanguagesForSite(e);let n=o.map((({isocode:e,nativeName:t})=>{const o={};o.id=e;o.label=t;return o}));if(t){n=n.filter((e=>e.label.toUpperCase().indexOf(t.toUpperCase())>-1))}return n}catch(e){throw new Error(e)}}))}};Oe.$inject=["languageService"];Oe=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.LanguageService])],Oe);let xe=class PreviewDatapreviewCatalogDropdownPopulator extends d.DropdownPopulatorInterface{constructor(e,t,o,n){super(T,n);this.catalogService=e;this.sharedDataService=t;this.l10nPipe=o}fetchAll(e){return this.initCatalogVersionDropdownChoices(e.search)}initCatalogVersionDropdownChoices(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.sharedDataService.get(d.EXPERIENCE_STORAGE_KEY);const o=t.siteDescriptor;const n=yield this.getDropdownChoices(o,e);const s=r.flatten(n).sort(((e,t)=>e.label.localeCompare(t.label)));return s}catch(e){throw new Error(e)}}))}getDropdownChoices(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.catalogService.getContentCatalogsForSite(e.uid);const n=r.flatten(o).map((t=>this.getTranslatedCatalogVersionsOptions(e,t)));const s=yield Promise.all(r.flatten(n));return s.filter((e=>t?e.label.toUpperCase().includes(t.toUpperCase()):true))}))}getTranslatedCatalogVersionsOptions(e,t){return t.versions.map((o=>__awaiter(this,void 0,void 0,(function*(){const n=yield this.l10nPipe.transform(t.name).pipe(m.take(1)).toPromise();return{id:`${e.uid}|${t.catalogId}|${o.version}`,label:`${n} - ${o.version}`}}))))}};xe.$inject=["catalogService","sharedDataService","l10nPipe","languageService"];xe=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.ICatalogService,d.ISharedDataService,d.L10nPipe,d.LanguageService])],xe);var De;t.CatalogAwareRouteResolverHelper=De=class CatalogAwareRouteResolverHelper{constructor(e,t,o,n,s,a){this.logService=e;this.route=t;this.systemEventService=o;this.experienceService=n;this.sharedDataService=s;this.catalogVersionPermissionService=a}static executeAndCheckCatalogPermissions(e,t,o,n,s){return s().then((()=>e.hasReadPermissionOnCurrent().then((e=>{if(!e){t.info("no permission to access the storefront view with this experience");return Promise.reject()}return o.hasCatalogVersionChanged().then((e=>{if(e){n.publishAsync(d.EVENTS.EXPERIENCE_UPDATE)}return true}))}),(()=>{t.info("failed to evaluate permissions to access the storefront view with this experience");return Promise.reject()}))),(e=>{t.error("could not retrieve experience from storage or route params",e);throw new Error(e)}))}static checkExperienceIsSet(e,t){return new Promise(((o,n)=>{e.getCurrentExperience().then((e=>{if(!e){return n()}t.set(d.EXPERIENCE_STORAGE_KEY,e);return o(e)}))}))}static buildExperienceFromRoute(e,t){return e.buildAndSetExperience(t).then((e=>{if(!e){return Promise.reject()}return e}))}storefrontResolve(){return this.executeAndCheckCatalogPermissions((()=>this.checkExperienceIsSet()))}experienceFromPathResolve(e){return this.executeAndCheckCatalogPermissions((()=>this.buildExperienceFromRoute(e)))}executeAndCheckCatalogPermissions(e){return De.executeAndCheckCatalogPermissions(this.catalogVersionPermissionService,this.logService,this.experienceService,this.systemEventService,e)}checkExperienceIsSet(){return De.checkExperienceIsSet(this.experienceService,this.sharedDataService)}buildExperienceFromRoute(e){return De.buildExperienceFromRoute(this.experienceService,e||this.route.snapshot.params)}};t.CatalogAwareRouteResolverHelper=De=__decorate([n.Injectable(),__metadata("design:paramtypes",[d.LogService,u.ActivatedRoute,d.SystemEventService,d.IExperienceService,d.ISharedDataService,d.ICatalogVersionPermissionService])],t.CatalogAwareRouteResolverHelper);let Re=class StorefrontPageGuard{constructor(e,t){this.catalogAwareResolverHelper=e;this.routing=t}canActivate(){return this.catalogAwareResolverHelper.storefrontResolve().catch((()=>{this.routing.go(d.NG_ROUTE_PREFIX);return false}))}};Re.$inject=["catalogAwareResolverHelper","routing"];Re=__decorate([n.Injectable(),__metadata("design:paramtypes",[t.CatalogAwareRouteResolverHelper,d.SmarteditRoutingService])],Re);t.ProductService=class ProductService{constructor(e,t){this.restServiceFactory=e;this.languageService=t;this.productService=this.restServiceFactory.get(d.PRODUCT_RESOURCE_API);this.productListService=this.restServiceFactory.get(d.PRODUCT_LIST_RESOURCE_API)}findProducts(e,t){return __awaiter(this,void 0,void 0,(function*(){this._validateProductCatalogInfo(e);const o=yield this.languageService.getResolveLocale();const n=yield this.productListService.get({catalogId:e.catalogId,catalogVersion:e.catalogVersion,text:t.mask,pageSize:t.pageSize,currentPage:t.currentPage,langIsoCode:o});return n}))}getProductById(e,t){return this.productService.get({siteUID:e,productUID:t})}_validateProductCatalogInfo(e){if(!e.catalogId){throw new Error("[productService] - catalog ID missing.")}if(!e.catalogVersion){throw new Error("[productService] - catalog version missing.")}}};t.ProductService.$inject=["restServiceFactory","languageService"];__decorate([d.Cached({actions:[d.rarelyChangingContent],tags:[d.userEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],t.ProductService.prototype,"findProducts",null);t.ProductService=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.RestServiceFactory,d.LanguageService])],t.ProductService);window.__smartedit__.addDecoratorPayload("Component","ConfigurationModalComponent",{selector:"se-configuration-modal",template:`<div id="editConfigurationsBody" class="se-config"><form #form="ngForm" novalidate><div class="se-config__sub-header"><span class="se-config__sub-title">{{'se.configurationform.label.keyvalue' | translate}}</span> <button class="se-config__add-entry-btn fd-button--compact" type="button" (click)="editor.addEntry()">{{ "se.general.configuration.add.button" | translate }}</button></div><div class="se-config__entry" *ngFor="let entry of editor.filterConfiguration(); let $index = index"><div class="se-config__entry-data"><div class="se-config__entry-key"><input type="text" [ngClass]="{\n                            'is-invalid': entry.errors &&  entry.errors.keys && entry.errors.keys.length > 0,\n                            'se-config__entry-key--disabled': !entry.isNew }" name="{{entry.key}}_{{entry.uuid}}_key" placeholder="{{'se.configurationform.header.key.name' | translate}}" [(ngModel)]="entry.key" [required]="true" [disabled]="!entry.isNew" class="se-config__entry-key-input fd-form__control" [title]="entry.key"/><ng-container *ngIf="entry.errors && entry.errors.keys"><span id="{{entry.key}}_error_{{$index}}" *ngFor="let error of entry.errors.keys; let $index = index" class="error-input help-block">{{error.message|translate}}</span></ng-container></div><div class="se-config__entry-value"><textarea [ngClass]="{'is-invalid': entry.errors && entry.errors.values && entry.errors.values.length>0}" name="{{entry.key}}_{{entry.uuid}}_value" placeholder="{{'se.configurationform.header.value.name' | translate}}" [(ngModel)]="entry.value" [required]="true" class="se-config__entry-text-area fd-form__control" (change)="editor.validateUserInput(entry)"></textarea><div *ngIf="entry.requiresUserCheck"><input id="{{entry.key}}_absoluteUrl_check_{{$index}}" type="checkbox" name="{{entry.key}}_{{entry.uuid}}_isCheckedByUser" [(ngModel)]="entry.isCheckedByUser"/> <span id="{{entry.key}}_absoluteUrl_msg_{{$index}}" [ngClass]="{\n                                'warning-check-msg': true,\n                                'not-checked': entry.hasErrors && !entry.isCheckedByUser\n                            }">{{'se.configurationform.absoluteurl.check' | translate}}</span></div><ng-container *ngIf="entry.errors && entry.errors.values && entry.errors.values"><span id="{{entry.key}}_error_{{$index}}" *ngFor="let error of entry.errors.values; let $index = index" class="error-input help-block">{{error.message|translate}}</span></ng-container></div></div><button type="button" id="{{entry.key}}_removeButton_{{$index}}" class="se-config__entry-remove-btn fd-button--light sap-icon--delete" (click)="editor.removeEntry(entry, form);"></button></div></form></div>`});let ke=class ConfigurationModalComponent{constructor(e,t,o){this.editor=e;this.modalManager=t;this.confirmationModalService=o}ngOnInit(){this.editor.init();this.form.statusChanges.subscribe((()=>{if(this.form.valid&&this.form.dirty){this.modalManager.enableButton("save")}if(this.form.invalid||!this.form.dirty){this.modalManager.disableButton("save")}}));this.modalManager.addButtons([{id:"save",style:d.ModalButtonStyle.Primary,label:"se.cms.component.confirmation.modal.save",callback:()=>p.from(this.onSave()),disabled:true},{id:"cancel",label:"se.cms.component.confirmation.modal.cancel",style:d.ModalButtonStyle.Default,action:d.ModalButtonAction.Dismiss,callback:()=>p.from(this.onCancel())}])}trackByFn(e,t){return t.uuid}onCancel(){const{dirty:e}=this.form;const t={description:"se.editor.cancel.confirm"};if(!e){return Promise.resolve()}return this.confirmationModalService.confirm(t).then((()=>this.modalManager.close(null)))}onSave(){return this.editor.submit(this.form).then((()=>{this.modalManager.close(null)}))}};__decorate([n.ViewChild("form",{static:true}),__metadata("design:type",S.NgForm)],ke.prototype,"form",void 0);ke=__decorate([n.Component({selector:"se-configuration-modal",template:`<div id="editConfigurationsBody" class="se-config"><form #form="ngForm" novalidate><div class="se-config__sub-header"><span class="se-config__sub-title">{{'se.configurationform.label.keyvalue' | translate}}</span> <button class="se-config__add-entry-btn fd-button--compact" type="button" (click)="editor.addEntry()">{{ "se.general.configuration.add.button" | translate }}</button></div><div class="se-config__entry" *ngFor="let entry of editor.filterConfiguration(); let $index = index"><div class="se-config__entry-data"><div class="se-config__entry-key"><input type="text" [ngClass]="{\n                            'is-invalid': entry.errors &&  entry.errors.keys && entry.errors.keys.length > 0,\n                            'se-config__entry-key--disabled': !entry.isNew }" name="{{entry.key}}_{{entry.uuid}}_key" placeholder="{{'se.configurationform.header.key.name' | translate}}" [(ngModel)]="entry.key" [required]="true" [disabled]="!entry.isNew" class="se-config__entry-key-input fd-form__control" [title]="entry.key"/><ng-container *ngIf="entry.errors && entry.errors.keys"><span id="{{entry.key}}_error_{{$index}}" *ngFor="let error of entry.errors.keys; let $index = index" class="error-input help-block">{{error.message|translate}}</span></ng-container></div><div class="se-config__entry-value"><textarea [ngClass]="{'is-invalid': entry.errors && entry.errors.values && entry.errors.values.length>0}" name="{{entry.key}}_{{entry.uuid}}_value" placeholder="{{'se.configurationform.header.value.name' | translate}}" [(ngModel)]="entry.value" [required]="true" class="se-config__entry-text-area fd-form__control" (change)="editor.validateUserInput(entry)"></textarea><div *ngIf="entry.requiresUserCheck"><input id="{{entry.key}}_absoluteUrl_check_{{$index}}" type="checkbox" name="{{entry.key}}_{{entry.uuid}}_isCheckedByUser" [(ngModel)]="entry.isCheckedByUser"/> <span id="{{entry.key}}_absoluteUrl_msg_{{$index}}" [ngClass]="{\n                                'warning-check-msg': true,\n                                'not-checked': entry.hasErrors && !entry.isCheckedByUser\n                            }">{{'se.configurationform.absoluteurl.check' | translate}}</span></div><ng-container *ngIf="entry.errors && entry.errors.values && entry.errors.values"><span id="{{entry.key}}_error_{{$index}}" *ngFor="let error of entry.errors.values; let $index = index" class="error-input help-block">{{error.message|translate}}</span></ng-container></div></div><button type="button" id="{{entry.key}}_removeButton_{{$index}}" class="se-config__entry-remove-btn fd-button--light sap-icon--delete" (click)="editor.removeEntry(entry, form);"></button></div></form></div>`}),__metadata("design:paramtypes",[we,d.ModalManagerService,d.IConfirmationModalService])],ke);let Me=class ConfigurationModalService{constructor(e){this.modalService=e}editConfiguration(){this.modalService.open({templateConfig:{title:"se.modal.administration.configuration.edit.title"},component:ke,config:{focusTrapped:false,backdropClickCloseable:false}})}};Me.$inject=["modalService"];Me=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.IModalService])],Me);let Ne=class PageTreeNodeService extends d.IPageTreeNodeService{constructor(){super()}};Ne=__decorate([d.SeDowngradeService(d.IPageTreeNodeService),d.GatewayProxied("getSlotNodes","scrollToElement","existedSmartEditElement"),__metadata("design:paramtypes",[])],Ne);let Fe=class PageTreeService extends d.IPageTreeService{constructor(){super()}registerTreeComponent(e){this.item=e;return Promise.resolve()}getTreeComponent(){return Promise.resolve(this.item)}};Fe=__decorate([d.SeDowngradeService(d.IPageTreeService),d.GatewayProxied("registerTreeComponent","getTreeComponent"),__metadata("design:paramtypes",[])],Fe);let ze=class SmarteditServicesModule{};ze=__decorate([n.NgModule({imports:[d.DragAndDropServiceModule,d.SmarteditCommonsModule,t.AlertServiceModule],providers:[Ie,t.BootstrapService,t.ConfigurationExtractorService,t.DelegateRestService,d.RestServiceFactory,we,Me,Oe,xe,fe,Ae,t.CatalogAwareRouteResolverHelper,Re,d.SmarteditRoutingService,d.UserTrackingService,{provide:d.ICatalogVersionPermissionService,useClass:Ae},{provide:d.IPermissionService,useClass:_e},{provide:d.IPageInfoService,useClass:ee},{provide:d.IRestServiceFactory,useClass:d.RestServiceFactory},{provide:d.IRenderService,useClass:Te},{provide:d.IAnnouncementService,useClass:x},{provide:d.IPerspectiveService,useClass:ie},{provide:d.IFeatureService,useClass:J},{provide:d.INotificationMouseLeaveDetectionService,useClass:k},{provide:d.IWaitDialogService,useClass:ae},{provide:d.IPreviewService,useClass:te},{provide:d.IDragAndDropCrossOrigin,useClass:K},oe,{provide:d.INotificationService,useClass:D},{provide:d.IPageTreeNodeService,useClass:Ne},{provide:d.IPageTreeService,useClass:Fe},t.ProductService,d.moduleUtils.initialize((e=>{}),[d.IPreviewService])]})],ze);let Le=class FilterByFieldFilter{static transform(){return(e,t,o,n)=>d.FilterByFieldPipe.transform(e,t,o,n)}};Le=__decorate([d.SeFilter()],Le);let Ve=class ConfirmationModalService extends d.IConfirmationModalService{constructor(e){super();this.modalService=e}confirm(e){const t=this.modalService.open({component:d.ConfirmDialogComponent,data:e,config:{focusTrapped:false,modalPanelClass:"se-confirmation-dialog",container:document.querySelector("[uib-modal-window]")||"body"},templateConfig:{title:e.title||"se.confirmation.modal.title",buttons:this.getButtons(e),isDismissButtonVisible:true}});return new Promise(((e,o)=>t.afterClosed.subscribe(e,o)))}getButtons(e){return[{id:"confirmOk",label:"se.confirmation.modal.ok",style:d.ModalButtonStyle.Primary,action:d.ModalButtonAction.Close,callback:()=>p.of(true)},!e.showOkButtonOnly&&{id:"confirmCancel",label:"se.confirmation.modal.cancel",style:d.ModalButtonStyle.Default,action:d.ModalButtonAction.Dismiss,callback:()=>p.of(false)}].filter((e=>!!e))}};Ve.$inject=["modalService"];Ve=__decorate([d.SeDowngradeService(d.IConfirmationModalService),d.GatewayProxied("confirm"),__metadata("design:paramtypes",[d.IModalService])],Ve);class ToolbarService extends d.IToolbarService{constructor(e,t,o,n,s){super(o,n,s);this.gatewayId=e;this.onAliasesChange=null;t.initForService(this,["addAliases","removeItemByKey","removeAliasByKey","_removeItemOnInner","triggerActionOnInner"])}addAliases(e){this.aliases=this.aliases.map((t=>this.get(e,t)||t));this.aliases=[...this.aliases||[],...(e||[]).filter((e=>!this.get(this.aliases,e)))];this.aliases=this.sortAliases(this.aliases);if(this.onAliasesChange){this.onAliasesChange(this.aliases)}}removeItemByKey(e){if(e in this.actions){delete this.actions[e]}else{this._removeItemOnInner(e)}this.removeAliasByKey(e)}removeAliasByKey(e){let t=0;for(;t<this.aliases.length;t++){if(this.aliases[t].key===e){break}}if(t<this.aliases.length){this.aliases.splice(t,1)}if(this.onAliasesChange){this.onAliasesChange(this.aliases)}}setOnAliasesChange(e){this.onAliasesChange=e}triggerAction(e){if(e&&this.actions[e.key]){this.actions[e.key].call(e);return}this.triggerActionOnInner(e)}get(e,t){return e.find((({key:e})=>e===t.key))}sortAliases(e){let t=false;let o="In "+this.gatewayId+" the items ";let n=null;const s=[...e||[]].sort(((e,s)=>{if(e.priority===s.priority&&e.section===s.section){n=e.section;o+=e.key+" and "+s.key+" ";t=true;return e.key>s.key?1:-1}return e.priority-s.priority}));if(t){this.logService.warn("WARNING: "+o+"have the same priority withing section:"+n)}return s}}let Ue=class ToolbarServiceFactory{constructor(e,t,o,n){this.gatewayProxy=e;this.logService=t;this.lazy=o;this.permissionService=n;this.toolbarServicesByGatewayId={}}getToolbarService(e){if(!this.toolbarServicesByGatewayId[e]){this.toolbarServicesByGatewayId[e]=new ToolbarService(e,this.gatewayProxy,this.logService,this.lazy.$templateCache(),this.permissionService)}return this.toolbarServicesByGatewayId[e]}};Ue.$inject=["gatewayProxy","logService","lazy","permissionService"];Ue=__decorate([d.SeDowngradeService(d.IToolbarServiceFactory),__metadata("design:paramtypes",[d.GatewayProxy,d.LogService,d.AngularJSLazyDependenciesService,d.IPermissionService])],Ue);var je;window.__smartedit__.addDecoratorPayload("Component","ToolbarComponent",{selector:"se-toolbar",template:`<div class="se-toolbar" [ngClass]="cssClass"><div class="se-toolbar__left"><div *ngFor="let item of aliases | seProperty:{section:'left'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__left {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div><div class="se-toolbar__middle"><div *ngFor="let item of aliases | seProperty:{section:'middle'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__middle {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div><div class="se-toolbar__right"><div *ngFor="let item of aliases | seProperty:{section:'right'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__right {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div></div>`});let $e=je=class ToolbarComponent{constructor(e,t,o,n,s,a,r){this.toolbarServiceFactory=e;this.iframeClickDetectionService=t;this.systemEventService=o;this.injector=n;this.cdr=s;this.routingService=a;this.userTrackingService=r;this.imageRoot="";this.aliases=[];this.unregCloseActions=null;this.unregCloseAll=null;this.unregRecalcPermissions=null}ngOnInit(){this.setup()}ngOnDestroy(){var e,t,o;(e=this.unregCloseActions)===null||e===void 0?void 0:e.call(this);(t=this.unregCloseAll)===null||t===void 0?void 0:t.call(this);(o=this.unregRecalcPermissions)===null||o===void 0?void 0:o.call(this)}triggerAction(e,t){t.preventDefault();this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,e.key);this.toolbarService.triggerAction(e)}getItemVisibility(e){return e.component&&(e.isOpen||e.keepAliveOnClose)}isOnStorefront(){return this.routingService.absUrl().includes(d.STORE_FRONT_CONTEXT)}createInjector(e){return n.Injector.create({parent:this.injector,providers:[{provide:d.TOOLBAR_ITEM,useValue:e}]})}trackByFn(e,t){return t.key}closeAllActionItems(){this.aliases.forEach((e=>{e.isOpen=false}))}populatePermissions(){return __awaiter(this,void 0,void 0,(function*(){const e=this.aliases.map((e=>this.toolbarService._populateIsPermissionGranted(e)));this.aliases=yield Promise.all(e)}))}setup(){this.buildAliases();this.populatePermissions();this.registerCallbacks()}buildAliases(){this.toolbarService=this.toolbarServiceFactory.getToolbarService(this.toolbarName);this.toolbarService.setOnAliasesChange((e=>{this.aliases=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}));this.aliases=this.toolbarService.getAliases()}registerCallbacks(){this.unregCloseActions=this.iframeClickDetectionService.registerCallback(je.CLOSE_ALL_ACTION_ITEMS+this.toolbarName,(()=>this.closeAllActionItems()));this.unregCloseAll=this.systemEventService.subscribe(d.EVENTS.PAGE_SELECTED,(()=>this.closeAllActionItems()));this.unregRecalcPermissions=this.systemEventService.subscribe(d.EVENTS.PERMISSION_CACHE_CLEANED,(()=>this.populatePermissions()))}};$e.CLOSE_ALL_ACTION_ITEMS="closeAllActionItems";__decorate([n.Input(),__metadata("design:type",String)],$e.prototype,"cssClass",void 0);__decorate([n.Input(),__metadata("design:type",String)],$e.prototype,"toolbarName",void 0);__decorate([n.Input(),__metadata("design:type",Object)],$e.prototype,"imageRoot",void 0);$e=je=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-toolbar",template:`<div class="se-toolbar" [ngClass]="cssClass"><div class="se-toolbar__left"><div *ngFor="let item of aliases | seProperty:{section:'left'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__left {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div><div class="se-toolbar__middle"><div *ngFor="let item of aliases | seProperty:{section:'middle'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__middle {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div><div class="se-toolbar__right"><div *ngFor="let item of aliases | seProperty:{section:'right'}; trackBy: trackByFn" class="se-template-toolbar se-template-toolbar__right {{item.className}}"><se-toolbar-section-item [item]="item"></se-toolbar-section-item></div></div></div>`}),__metadata("design:paramtypes",[d.IToolbarServiceFactory,d.IIframeClickDetectionService,d.SystemEventService,n.Injector,n.ChangeDetectorRef,d.SmarteditRoutingService,d.UserTrackingService])],$e);window.__smartedit__.addDecoratorPayload("Component","ToolbarActionComponent",{selector:"se-toolbar-action",template:`<div *ngIf="item.isPermissionGranted"><div *ngIf="item.type == type.ACTION" class="toolbar-action"><button type="button" [ngClass]="{\n                'toolbar-action--button--compact': isCompact,\n                'toolbar-action--button': !isCompact\n            }" class="btn" (click)="toolbar.triggerAction(item, $event)" [attr.aria-pressed]="false" [attr.aria-haspopup]="true" [attr.aria-expanded]="false" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn"><span *ngIf="item.iconClassName" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn_iconclass" class="{{item.iconClassName}}" [ngClass]="{ 'se-toolbar-actions__icon': isCompact }"></span> <img *ngIf="!item.iconClassName && item.icons" id="{{toolbar.toolbarName}}_option_{{item.key}}" src="{{toolbar.imageRoot}}{{item.icons[0]}}" class="file" title="{{item.name | translate}}" alt="{{item.name | translate}}"/> <span *ngIf="!isCompact" class="toolbar-action-button__txt" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn_lbl">{{item.name | translate}}</span></button></div><fd-popover class="se-toolbar-action__wrapper toolbar-action toolbar-action--hybrid" *ngIf="item.type === type.HYBRID_ACTION" [attr.data-item-key]="item.key" [triggers]="['click']" [noArrow]="false" [isOpen]="item.isOpen" [closeOnOutsideClick]="false" (isOpenChange)="onOpenChange()" [placement]="placement" seClickOutside (clickOutside)="onOutsideClicked()"><fd-popover-control><button *ngIf="item.iconClassName || item.icons" type="button" class="btn" [ngClass]="{\n                    'toolbar-action--button--compact': isCompact,\n                    'toolbar-action--button': !isCompact\n                }" [disabled]="disabled" [attr.aria-pressed]="false " (click)="toolbar.triggerAction(item, $event)"><span *ngIf="item.iconClassName" class="{{item.iconClassName}}" [ngClass]="{ 'se-toolbar-actions__icon': isCompact }"></span> <img *ngIf="!item.iconClassName && item.icons" id="{{toolbar.toolbarName}}_option_{{item.key}}" src="{{toolbar.imageRoot}}{{item.icons[0]}}" class="file" title="{{item.name | translate}}" alt="{{item.name | translate}}"/> <span *ngIf="!isCompact" class="toolbar-action-button__txt">{{item.name | translate}}</span></button></fd-popover-control><fd-popover-body class="se-toolbar-action__body" [ngClass]="{\n                'toolbar-action--include--compact': isCompact,\n                'toolbar-action--include': !isCompact\n              \n            }"><se-prevent-vertical-overflow><ng-container *ngIf="toolbar.getItemVisibility(item) && item.component"><ng-container *ngComponentOutlet="item.component; injector: actionInjector"></ng-container></ng-container></se-prevent-vertical-overflow></fd-popover-body></fd-popover></div>`});let Be=class ToolbarActionComponent{constructor(e){this.toolbar=e;this.type=d.ToolbarItemType}ngOnInit(){this.setup()}ngOnChanges(e){if(e.item){this.setup()}}get isCompact(){return this.item.actionButtonFormat==="compact"}get placement(){if(this.item.section===d.ToolbarSection.left||this.item.section===d.ToolbarSection.middle){return"bottom-start"}else if(this.item.section===d.ToolbarSection.right){return"bottom-end"}switch(this.item.dropdownPosition){case d.ToolbarDropDownPosition.left:return"bottom-start";case d.ToolbarDropDownPosition.right:return"bottom-end";default:return"bottom"}}onOutsideClicked(){this.item.isOpen=false}onOpenChange(){this.item.isOpen=!this.item.isOpen}setup(){this.actionInjector=this.toolbar.createInjector(this.item)}};__decorate([n.Input(),__metadata("design:type",Object)],Be.prototype,"item",void 0);Be=__decorate([n.Component({selector:"se-toolbar-action",template:`<div *ngIf="item.isPermissionGranted"><div *ngIf="item.type == type.ACTION" class="toolbar-action"><button type="button" [ngClass]="{\n                'toolbar-action--button--compact': isCompact,\n                'toolbar-action--button': !isCompact\n            }" class="btn" (click)="toolbar.triggerAction(item, $event)" [attr.aria-pressed]="false" [attr.aria-haspopup]="true" [attr.aria-expanded]="false" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn"><span *ngIf="item.iconClassName" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn_iconclass" class="{{item.iconClassName}}" [ngClass]="{ 'se-toolbar-actions__icon': isCompact }"></span> <img *ngIf="!item.iconClassName && item.icons" id="{{toolbar.toolbarName}}_option_{{item.key}}" src="{{toolbar.imageRoot}}{{item.icons[0]}}" class="file" title="{{item.name | translate}}" alt="{{item.name | translate}}"/> <span *ngIf="!isCompact" class="toolbar-action-button__txt" id="{{toolbar.toolbarName}}_option_{{item.key}}_btn_lbl">{{item.name | translate}}</span></button></div><fd-popover class="se-toolbar-action__wrapper toolbar-action toolbar-action--hybrid" *ngIf="item.type === type.HYBRID_ACTION" [attr.data-item-key]="item.key" [triggers]="['click']" [noArrow]="false" [isOpen]="item.isOpen" [closeOnOutsideClick]="false" (isOpenChange)="onOpenChange()" [placement]="placement" seClickOutside (clickOutside)="onOutsideClicked()"><fd-popover-control><button *ngIf="item.iconClassName || item.icons" type="button" class="btn" [ngClass]="{\n                    'toolbar-action--button--compact': isCompact,\n                    'toolbar-action--button': !isCompact\n                }" [disabled]="disabled" [attr.aria-pressed]="false " (click)="toolbar.triggerAction(item, $event)"><span *ngIf="item.iconClassName" class="{{item.iconClassName}}" [ngClass]="{ 'se-toolbar-actions__icon': isCompact }"></span> <img *ngIf="!item.iconClassName && item.icons" id="{{toolbar.toolbarName}}_option_{{item.key}}" src="{{toolbar.imageRoot}}{{item.icons[0]}}" class="file" title="{{item.name | translate}}" alt="{{item.name | translate}}"/> <span *ngIf="!isCompact" class="toolbar-action-button__txt">{{item.name | translate}}</span></button></fd-popover-control><fd-popover-body class="se-toolbar-action__body" [ngClass]="{\n                'toolbar-action--include--compact': isCompact,\n                'toolbar-action--include': !isCompact\n              \n            }"><se-prevent-vertical-overflow><ng-container *ngIf="toolbar.getItemVisibility(item) && item.component"><ng-container *ngComponentOutlet="item.component; injector: actionInjector"></ng-container></ng-container></se-prevent-vertical-overflow></fd-popover-body></fd-popover></div>`}),__param(0,n.Inject(n.forwardRef((()=>$e)))),__metadata("design:paramtypes",[$e])],Be);window.__smartedit__.addDecoratorPayload("Component","ToolbarActionOutletComponent",{selector:"se-toolbar-action-outlet",template:`\n        <div\n            class="se-template-toolbar__action-template"\n            [ngClass]="{\n                'se-toolbar-action': isSectionRight,\n                'se-toolbar-action--active': isSectionRight && isPermitionGranted\n            }"\n        >\n            <ng-container *ngIf="item.component && item.type === type.TEMPLATE">\n                <ng-container\n                    *ngComponentOutlet="item.component; injector: actionInjector"\n                ></ng-container>\n            </ng-container>\n\n            \x3c!--ACTION and HYBRID_ACTION types--\x3e\n\n            <div *ngIf="item.type !== type.TEMPLATE">\n                <se-toolbar-action [item]="item"></se-toolbar-action>\n            </div>\n        </div>\n    `});let Ge=class ToolbarActionOutletComponent{constructor(e){this.toolbar=e;this.type=d.ToolbarItemType}ngOnInit(){this.setup()}ngOnChanges(e){if(e.item){this.setup()}}get isSectionRight(){return this.item.section===d.ToolbarSection.right}get isPermitionGranted(){return this.item.isPermissionGranted}setup(){this.actionInjector=this.toolbar.createInjector(this.item)}};__decorate([n.Input(),__metadata("design:type",Object)],Ge.prototype,"item",void 0);Ge=__decorate([n.Component({selector:"se-toolbar-action-outlet",template:`\n        <div\n            class="se-template-toolbar__action-template"\n            [ngClass]="{\n                'se-toolbar-action': isSectionRight,\n                'se-toolbar-action--active': isSectionRight && isPermitionGranted\n            }"\n        >\n            <ng-container *ngIf="item.component && item.type === type.TEMPLATE">\n                <ng-container\n                    *ngComponentOutlet="item.component; injector: actionInjector"\n                ></ng-container>\n            </ng-container>\n\n            \x3c!--ACTION and HYBRID_ACTION types--\x3e\n\n            <div *ngIf="item.type !== type.TEMPLATE">\n                <se-toolbar-action [item]="item"></se-toolbar-action>\n            </div>\n        </div>\n    `}),__param(0,n.Inject(n.forwardRef((()=>$e)))),__metadata("design:paramtypes",[$e])],Ge);window.__smartedit__.addDecoratorPayload("Component","ToolbarItemContextComponent",{selector:"se-toolbar-item-context",template:`\n        <div\n            *ngIf="displayContext"\n            id="toolbar_item_context_{{ itemKey }}_btn"\n            class="se-toolbar-actionable-item-context"\n            [ngClass]="{ 'se-toolbar-actionable-item-context--open': isOpen }"\n        >\n            <div *ngIf="contextComponent" class="se-toolbar-actionable-context__btn">\n                <ng-container *ngComponentOutlet="contextComponent"></ng-container>\n            </div>\n        </div>\n    `});let He=class ToolbarItemContextComponent{constructor(e){this.crossFrameEventService=e;this.displayContext=false}ngOnInit(){this.registerCallbacks()}ngOnDestroy(){this.unregShowContext();this.unregHideContext()}showContext(e){this.displayContext=e}registerCallbacks(){this.unregShowContext=this.crossFrameEventService.subscribe(d.SHOW_TOOLBAR_ITEM_CONTEXT,((e,t)=>{if(t===this.itemKey){this.showContext(true)}}));this.unregHideContext=this.crossFrameEventService.subscribe(d.HIDE_TOOLBAR_ITEM_CONTEXT,((e,t)=>{if(t===this.itemKey){this.showContext(false)}}))}};__decorate([n.Input(),__metadata("design:type",String)],He.prototype,"itemKey",void 0);__decorate([n.Input(),__metadata("design:type",Boolean)],He.prototype,"isOpen",void 0);__decorate([n.Input(),__metadata("design:type",n.Type)],He.prototype,"contextComponent",void 0);He=__decorate([n.Component({selector:"se-toolbar-item-context",template:`\n        <div\n            *ngIf="displayContext"\n            id="toolbar_item_context_{{ itemKey }}_btn"\n            class="se-toolbar-actionable-item-context"\n            [ngClass]="{ 'se-toolbar-actionable-item-context--open': isOpen }"\n        >\n            <div *ngIf="contextComponent" class="se-toolbar-actionable-context__btn">\n                <ng-container *ngComponentOutlet="contextComponent"></ng-container>\n            </div>\n        </div>\n    `}),__param(0,n.Inject(d.EVENT_SERVICE)),__metadata("design:paramtypes",[d.CrossFrameEventService])],He);window.__smartedit__.addDecoratorPayload("Component","ToolbarSectionItemComponent",{selector:"se-toolbar-section-item",host:{class:"se-toolbar-section-item"},template:`\n        <se-toolbar-action-outlet [item]="item"></se-toolbar-action-outlet>\n        <se-toolbar-item-context\n            *ngIf="item.contextComponent"\n            class="se-template-toolbar__context-template"\n            [attr.data-item-key]="item.key"\n            [itemKey]="item.key"\n            [isOpen]="item.isOpen"\n            [contextComponent]="item.contextComponent"\n        ></se-toolbar-item-context>\n    `});let We=class ToolbarSectionItemComponent{};__decorate([n.Input(),__metadata("design:type",Object)],We.prototype,"item",void 0);We=__decorate([n.Component({selector:"se-toolbar-section-item",host:{class:"se-toolbar-section-item"},template:`\n        <se-toolbar-action-outlet [item]="item"></se-toolbar-action-outlet>\n        <se-toolbar-item-context\n            *ngIf="item.contextComponent"\n            class="se-template-toolbar__context-template"\n            [attr.data-item-key]="item.key"\n            [itemKey]="item.key"\n            [isOpen]="item.isOpen"\n            [contextComponent]="item.contextComponent"\n        ></se-toolbar-item-context>\n    `})],We);window.__smartedit__.addDecoratorPayload("Component","DeviceSupportWrapperComponent",{selector:"se-device-support-wrapper",template:`\n        <inflection-point-selector\n            *ngIf="toolbar.isOnStorefront()"\n            class="toolbar-action"\n        ></inflection-point-selector>\n    `});let qe=class DeviceSupportWrapperComponent{constructor(e){this.toolbar=e}};qe=__decorate([n.Component({selector:"se-device-support-wrapper",template:`\n        <inflection-point-selector\n            *ngIf="toolbar.isOnStorefront()"\n            class="toolbar-action"\n        ></inflection-point-selector>\n    `}),__param(0,n.Inject(n.forwardRef((()=>$e)))),__metadata("design:paramtypes",[$e])],qe);window.__smartedit__.addDecoratorPayload("Component","ExperienceSelectorButtonComponent",{selector:"se-experience-selector-button",template:`<fd-popover class="se-experience-selector" [(isOpen)]="status.isOpen" (isOpenChange)="resetExperienceSelector()" [closeOnOutsideClick]="false" [triggers]="['click']" [placement]="'bottom-end'"><fd-popover-control><div class="se-experience-selector__control"><se-tooltip [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" *ngIf="isCurrentPageFromParent" class="se-experience-selector__tooltip"><span se-tooltip-trigger class="se-experience-selector__btn--globe"><span class="hyicon hyicon-globe se-experience-selector__btn--globe--icon"></span></span><div se-tooltip-body>{{ parentCatalogVersion }}</div></se-tooltip><button class="se-experience-selector__btn" id="experience-selector-btn"><span [attr.title]="experienceText" class="se-experience-selector__btn-text se-nowrap-ellipsis">{{ experienceText }} </span><span class="se-experience-selector__btn-arrow icon-navigation-down-arrow"></span></button></div></fd-popover-control><fd-popover-body><div class="se-experience-selector__dropdown fd-modal fd-modal__content" role="menu"><se-experience-selector [experience]="experience" [dropdownStatus]="status" [(resetExperienceSelector)]="resetExperienceSelector"></se-experience-selector></div></fd-popover-body></fd-popover>`,providers:[d.L10nPipe]});let Ke=class ExperienceSelectorButtonComponent{constructor(e,t,o,n,s){this.systemEventService=e;this.crossFrameEventService=t;this.locale=o;this.sharedDataService=n;this.l10nPipe=s;this.status={isOpen:false};this.isCurrentPageFromParent=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield this.updateExperience();yield this.setExperienceText();this.unregFn=this.systemEventService.subscribe(d.EVENTS.EXPERIENCE_UPDATE,(()=>__awaiter(this,void 0,void 0,(function*(){yield this.updateExperience();yield this.setExperienceText()}))));this.unRegNewPageContextEventFn=this.crossFrameEventService.subscribe(d.EVENTS.PAGE_CHANGE,((e,t)=>{this.setPageFromParent(t)}))}))}ngOnDestroy(){this.unregFn();this.unRegNewPageContextEventFn()}updateExperience(){return __awaiter(this,void 0,void 0,(function*(){this.experience=yield this.sharedDataService.get(d.EXPERIENCE_STORAGE_KEY)}))}setPageFromParent(e){return __awaiter(this,void 0,void 0,(function*(){const{pageContext:{catalogName:t,catalogVersion:o,catalogVersionUuid:n},catalogDescriptor:{catalogVersionUuid:s}}=e;const a=yield this.l10nPipe.transform(t).pipe(m.take(1)).toPromise();this.parentCatalogVersion=`${a} (${o})`;this.isCurrentPageFromParent=s!==n}))}setExperienceText(){return __awaiter(this,void 0,void 0,(function*(){if(!this.experience){this.experienceText=""}const{catalogDescriptor:{name:e,catalogVersion:t},languageDescriptor:{nativeName:o},time:n}=this.experience;const s=new g.DatePipe(this.locale);const a=n?`  |  ${s.transform(P["default"](n).isValid()?n:P["default"].now(),d.DATE_CONSTANTS.ANGULAR_SHORT)}`:"";const[r,p]=yield Promise.all([this.l10nPipe.transform(e).pipe(m.take(1)).toPromise(),this.getProductCatalogVersionTextByUuids()]);this.experienceText=`${r} - ${t}  |  ${o}${a}${p}`}))}getProductCatalogVersionTextByUuids(){return __awaiter(this,void 0,void 0,(function*(){const{productCatalogVersions:e}=this.experience;const t="";const o=e.map((({catalogName:e,catalogVersion:t})=>__awaiter(this,void 0,void 0,(function*(){const o=yield this.l10nPipe.transform(e).pipe(m.take(1)).toPromise();return`${o} (${t})`}))));const n=yield Promise.all(o);return[t].concat(n).join(" | ")}))}};Ke.$inject=["systemEventService","crossFrameEventService","locale","sharedDataService","l10nPipe"];Ke=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-experience-selector-button",template:`<fd-popover class="se-experience-selector" [(isOpen)]="status.isOpen" (isOpenChange)="resetExperienceSelector()" [closeOnOutsideClick]="false" [triggers]="['click']" [placement]="'bottom-end'"><fd-popover-control><div class="se-experience-selector__control"><se-tooltip [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" *ngIf="isCurrentPageFromParent" class="se-experience-selector__tooltip"><span se-tooltip-trigger class="se-experience-selector__btn--globe"><span class="hyicon hyicon-globe se-experience-selector__btn--globe--icon"></span></span><div se-tooltip-body>{{ parentCatalogVersion }}</div></se-tooltip><button class="se-experience-selector__btn" id="experience-selector-btn"><span [attr.title]="experienceText" class="se-experience-selector__btn-text se-nowrap-ellipsis">{{ experienceText }} </span><span class="se-experience-selector__btn-arrow icon-navigation-down-arrow"></span></button></div></fd-popover-control><fd-popover-body><div class="se-experience-selector__dropdown fd-modal fd-modal__content" role="menu"><se-experience-selector [experience]="experience" [dropdownStatus]="status" [(resetExperienceSelector)]="resetExperienceSelector"></se-experience-selector></div></fd-popover-body></fd-popover>`,providers:[d.L10nPipe]}),__param(2,n.Inject(n.LOCALE_ID)),__metadata("design:paramtypes",[d.SystemEventService,d.CrossFrameEventService,String,d.ISharedDataService,d.L10nPipe])],Ke);window.__smartedit__.addDecoratorPayload("Component","InflectionPointSelectorComponent",{selector:"inflection-point-selector",template:`<div class="se-inflection-point dropdown" [class.open]="isOpen" id="inflectionPtDropdown"><button type="button" class="se-inflection-point__toggle" (click)="toggleDropdown($event)" aria-pressed="false" [attr.aria-expanded]="isOpen"><span [ngClass]="getIconClass()" class="se-inflection-point___selected"></span></button><div class="se-inflection-point-dropdown"><nav class="fd-menu"><ul class="fd-menu__list" role="menu"><li *ngFor="let choice of points" class="fd-menu__item inflection-point__device" [ngClass]="{selected: isSelected(choice)}" id="se-device-{{choice.type}}" (click)="selectPoint(choice)"><span [ngClass]="getIconClass(choice)"></span></li></ul></nav></div></div>`});let Ye=class InflectionPointSelectorComponent{constructor(e,t,o,n,s){this.systemEventService=e;this.iframeManagerService=t;this.iframeClickDetectionService=o;this.yjQuery=n;this.userTrackingService=s;this.currentPointSelected=V.find((e=>e.default));this.points=V;this.isOpen=false}ngOnInit(){this.iframeClickDetectionService.registerCallback("inflectionPointClose",(()=>this.isOpen=false));const e=d.windowUtils.getWindow();this.documentClick$=p.fromEvent(e.document,"click").pipe(m.filter((e=>this.yjQuery(e.target).parents("inflection-point-selector").length<=0&&this.isOpen))).subscribe((e=>this.isOpen=false));this.unRegFn=this.systemEventService.subscribe(d.OVERLAY_DISABLED_EVENT,(()=>this.isOpen=false))}ngOnDestroy(){this.unRegFn();this.documentClick$.unsubscribe()}selectPoint(e){this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.INFLECTION,e.type);this.currentPointSelected=e;this.isOpen=!this.isOpen;if(e!==undefined){this.iframeManagerService.apply(e)}}toggleDropdown(e){e.preventDefault();e.stopPropagation();this.isOpen=!this.isOpen}getIconClass(e){if(e!==undefined){return e.iconClass}else{return this.currentPointSelected.iconClass}}isSelected(e){if(e!==undefined){return e.type===this.currentPointSelected.type}return false}};Ye.$inject=["systemEventService","iframeManagerService","iframeClickDetectionService","yjQuery","userTrackingService"];Ye=__decorate([d.SeDowngradeComponent(),n.Component({selector:"inflection-point-selector",template:`<div class="se-inflection-point dropdown" [class.open]="isOpen" id="inflectionPtDropdown"><button type="button" class="se-inflection-point__toggle" (click)="toggleDropdown($event)" aria-pressed="false" [attr.aria-expanded]="isOpen"><span [ngClass]="getIconClass()" class="se-inflection-point___selected"></span></button><div class="se-inflection-point-dropdown"><nav class="fd-menu"><ul class="fd-menu__list" role="menu"><li *ngFor="let choice of points" class="fd-menu__item inflection-point__device" [ngClass]="{selected: isSelected(choice)}" id="se-device-{{choice.type}}" (click)="selectPoint(choice)"><span [ngClass]="getIconClass(choice)"></span></li></ul></nav></div></div>`}),__param(2,n.Inject(d.IIframeClickDetectionService)),__param(3,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[d.SystemEventService,$,Ee,Function,d.UserTrackingService])],Ye);window.__smartedit__.addDecoratorPayload("Component","ExperienceSelectorComponent",{selector:"se-experience-selector",template:`<se-generic-editor *ngIf="isReady" [smarteditComponentType]="smarteditComponentType" [smarteditComponentId]="smarteditComponentId" [structureApi]="structureApi" [content]="content" [contentApi]="contentApi" (getApi)="getApi($event)"></se-generic-editor>`,providers:[d.L10nPipe]});let Ze=class ExperienceSelectorComponent{constructor(e,t,o,s,a,r,d,p,m){this.systemEventService=e;this.siteService=t;this.sharedDataService=o;this.iframeClickDetectionService=s;this.iframeManagerService=a;this.experienceService=r;this.catalogService=d;this.l10nPipe=p;this.userTrackingService=m;this.resetExperienceSelectorChange=new n.EventEmitter;this.modalHeaderTitle="se.experience.selector.header";this.siteCatalogs={}}ngOnInit(){setTimeout((()=>{this.resetExperienceSelectorChange.emit((()=>this.resetExperienceSelectorFn()))}));this.unRegCloseExperienceFn=this.iframeClickDetectionService.registerCallback("closeExperienceSelector",(()=>{if(this.dropdownStatus&&this.dropdownStatus.isOpen){this.dropdownStatus.isOpen=false}}));this.unRegFn=this.systemEventService.subscribe("OVERLAY_DISABLED",(()=>{if(this.dropdownStatus&&this.dropdownStatus.isOpen){this.dropdownStatus.isOpen=false}}))}ngOnDestroy(){if(this.unRegFn){this.unRegFn()}if(this.unRegCloseExperienceFn){this.unRegCloseExperienceFn()}}preparePayload(e){return __awaiter(this,void 0,void 0,(function*(){[this.siteCatalogs.siteId,this.siteCatalogs.catalogId,this.siteCatalogs.catalogVersion]=e.previewCatalog.split("|");const t=yield this.catalogService.getProductCatalogsForSite(this.siteCatalogs.siteId);const{domain:o}=yield this.sharedDataService.get("configuration");const{previewUrl:n,uid:s}=yield this.siteService.getSiteById(this.siteCatalogs.siteId);const{language:a,time:r,pageId:p,productCatalogVersions:m}=e;this.siteCatalogs.productCatalogs=t;this.siteCatalogs.productCatalogVersions=m;this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,"update Experience");return Object.assign(Object.assign({},e),{resourcePath:d.urlUtils.getAbsoluteURL(o,n),catalogVersions:[...this._getProductCatalogsByUuids(m),{catalog:this.siteCatalogs.catalogId,catalogVersion:this.siteCatalogs.catalogVersion}],siteId:s,language:a,time:r,pageId:p})}))}updateCallback(e,t){return __awaiter(this,void 0,void 0,(function*(){const{siteId:o,catalogId:n,catalogVersion:s,productCatalogVersions:a}=this.siteCatalogs;const{time:r}=e;const{pageId:p,language:m,ticketId:g}=t;this.smarteditComponentId=null;this.dropdownStatus.isOpen=false;const u=Object.assign(Object.assign({},t),{siteId:o,catalogId:n,catalogVersion:s,productCatalogVersions:a,time:d.dateUtils.formatDateAsUtc(r),pageId:p,language:m});const v=yield this.experienceService.buildAndSetExperience(u);yield this.sharedDataService.set(d.EXPERIENCE_STORAGE_KEY,v);this.systemEventService.publishAsync(d.EVENTS.EXPERIENCE_UPDATE);this.iframeManagerService.loadPreview(v.siteDescriptor.previewUrl,g)}))}getApi(e){e.setPreparePayload(this.preparePayload.bind(this));e.setUpdateCallback(this.updateCallback.bind(this));e.setAlwaysShowSubmit(true);e.setAlwaysShowReset(true);e.setSubmitButtonText("se.componentform.actions.apply");e.setCancelButtonText("se.componentform.actions.cancel");e.setOnReset((()=>{this.dropdownStatus.isOpen=false;return this.dropdownStatus.isOpen}))}_getProductCatalogsByUuids(e){return this.siteCatalogs.productCatalogs.map((({versions:t,catalogId:o})=>({catalogVersion:t.find((({uuid:t})=>e.indexOf(t)>-1)).version,catalog:o})))}resetExperienceSelectorFn(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(d.EXPERIENCE_STORAGE_KEY);const t=yield this.sharedDataService.get("configuration");this.smarteditComponentType="PreviewData";this.smarteditComponentId=null;this.structureApi=d.TYPES_RESOURCE_URI+"?code=:smarteditComponentType&mode=DEFAULT";this.contentApi=t&&t.previewTicketURI||d.PREVIEW_RESOURCE_URI;const o=yield this.l10nPipe.transform(e.siteDescriptor.name).pipe(m.take(1)).toPromise();this.content=Object.assign(Object.assign({},e),{activeSite:o,time:e.time,pageId:e.pageId,productCatalogVersions:e.productCatalogVersions.map((e=>e.uuid)),language:e.languageDescriptor.isocode,previewCatalog:`${e.siteDescriptor.uid}|${e.catalogDescriptor.catalogId}|${e.catalogDescriptor.catalogVersion}`});if(!this.isReady){this.isReady=true}}))}};Ze.$inject=["systemEventService","siteService","sharedDataService","iframeClickDetectionService","iframeManagerService","experienceService","catalogService","l10nPipe","userTrackingService"];__decorate([n.Input(),__metadata("design:type",Object)],Ze.prototype,"experience",void 0);__decorate([n.Input(),__metadata("design:type",Object)],Ze.prototype,"dropdownStatus",void 0);__decorate([n.Input(),__metadata("design:type",Function)],Ze.prototype,"resetExperienceSelector",void 0);__decorate([n.Output(),__metadata("design:type",n.EventEmitter)],Ze.prototype,"resetExperienceSelectorChange",void 0);Ze=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-experience-selector",template:`<se-generic-editor *ngIf="isReady" [smarteditComponentType]="smarteditComponentType" [smarteditComponentId]="smarteditComponentId" [structureApi]="structureApi" [content]="content" [contentApi]="contentApi" (getApi)="getApi($event)"></se-generic-editor>`,providers:[d.L10nPipe]}),__metadata("design:paramtypes",[d.SystemEventService,Y,d.ISharedDataService,d.IIframeClickDetectionService,$,d.IExperienceService,d.ICatalogService,d.L10nPipe,d.UserTrackingService])],Ze);window.__smartedit__.addDecoratorPayload("Component","UserAccountComponent",{selector:"se-user-account",template:`<div class="se-user-account-dropdown"><div class="se-user-account-dropdown__role">{{ 'se.toolbar.useraccount.role' | translate }}</div><div class="user-account-dropdown__name">{{username}}</div><div class="divider"></div><a class="se-sign-out__link fd-menu__item" (click)="signOut()">{{'se.toolbar.useraccount.signout' | translate}}</a></div>`});let Xe=class UserAccountComponent{constructor(e,t,o,n){this.authenticationService=e;this.iframeManagerService=t;this.crossFrameEventService=o;this.sessionService=n}ngOnInit(){this.unregUserChanged=this.crossFrameEventService.subscribe(d.EVENTS.USER_HAS_CHANGED,(()=>this.getUsername()));this.getUsername()}ngOnDestroy(){this.unregUserChanged()}signOut(){this.authenticationService.logout();this.iframeManagerService.setCurrentLocation(null)}getUsername(){this.sessionService.getCurrentUserDisplayName().then((e=>{this.username=e}))}};Xe.$inject=["authenticationService","iframeManagerService","crossFrameEventService","sessionService"];Xe=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-user-account",template:`<div class="se-user-account-dropdown"><div class="se-user-account-dropdown__role">{{ 'se.toolbar.useraccount.role' | translate }}</div><div class="user-account-dropdown__name">{{username}}</div><div class="divider"></div><a class="se-sign-out__link fd-menu__item" (click)="signOut()">{{'se.toolbar.useraccount.signout' | translate}}</a></div>`}),__metadata("design:paramtypes",[d.IAuthenticationService,$,d.CrossFrameEventService,d.ISessionService])],Xe);window.__smartedit__.addDecoratorPayload("Component","ExperienceSelectorWrapperComponent",{selector:"se-experience-selector-wrapper",template:`\n        <se-experience-selector-button\n            *ngIf="toolbar.isOnStorefront()"\n        ></se-experience-selector-button>\n    `});let Qe=class ExperienceSelectorWrapperComponent{constructor(e){this.toolbar=e}};Qe=__decorate([n.Component({selector:"se-experience-selector-wrapper",template:`\n        <se-experience-selector-button\n            *ngIf="toolbar.isOnStorefront()"\n        ></se-experience-selector-button>\n    `}),__param(0,n.Inject(n.forwardRef((()=>$e)))),__metadata("design:paramtypes",[$e])],Qe);window.__smartedit__.addDecoratorPayload("Component","LogoComponent",{selector:"se-logo",template:`\n        <div class="se-app-logo">\n            <img src="static-resources/images/SAP_scrn_R.png" class="se-logo-image" />\n            <div class="se-logo-text">{{ 'se.application.name' | translate }}</div>\n        </div>\n    `});let Je=class LogoComponent{};Je=__decorate([n.Component({selector:"se-logo",template:`\n        <div class="se-app-logo">\n            <img src="static-resources/images/SAP_scrn_R.png" class="se-logo-image" />\n            <div class="se-logo-text">{{ 'se.application.name' | translate }}</div>\n        </div>\n    `})],Je);!function(){const e=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,t=Symbol(),o=new Map;class i{constructor(e,o){if(this._$cssResult$=!0,o!==t)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){let t=o.get(this.cssText);return e&&void 0===t&&(o.set(this.cssText,t=new CSSStyleSheet),t.replaceSync(this.cssText)),t}toString(){return this.cssText}}const n=e?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let o="";for(const t of e.cssRules)o+=t.cssText;return(e=>new i("string"==typeof e?e:e+"",t))(o)})(e):e;var s,a;const r={toAttribute(e,t){switch(t){case Boolean:e=e?"":null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let o=e;switch(t){case Boolean:o=null!==e;break;case Number:o=null===e?null:Number(e);break;case Object:case Array:try{o=JSON.parse(e)}catch(e){o=null}}return o}},l=(e,t)=>t!==e&&(t==t||e==e),d={attribute:!0,type:String,converter:r,reflect:!1,hasChanged:l};class c extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(e){var t;null!==(t=this.l)&&void 0!==t||(this.l=[]),this.l.push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,o)=>{const n=this._$Eh(o,t);void 0!==n&&(this._$Eu.set(n,o),e.push(n))})),e}static createProperty(e,t=d){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const o="symbol"==typeof e?Symbol():"__"+e,n=this.getPropertyDescriptor(e,o,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}}static getPropertyDescriptor(e,t,o){return{get(){return this[t]},set(n){const s=this[e];this[t]=n,this.requestUpdate(e,s,o)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||d}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),this.elementProperties=new Map(e.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const o of t)this.createProperty(o,e[o])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const o=new Set(e.flat(1/0).reverse());for(const e of o)t.unshift(n(e))}else void 0!==e&&t.push(n(e));return t}static _$Eh(e,t){const o=t.attribute;return!1===o?void 0:"string"==typeof o?o:"string"==typeof e?e.toLowerCase():void 0}o(){var e;this._$Ev=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Ep(),this.requestUpdate(),null===(e=this.constructor.l)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,o;(null!==(t=this._$Em)&&void 0!==t?t:this._$Em=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(o=e.hostConnected)||void 0===o||o.call(e))}removeController(e){var t;null===(t=this._$Em)||void 0===t||t.splice(this._$Em.indexOf(e)>>>0,1)}_$Ep(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Et.set(t,this[t]),delete this[t])}))}createRenderRoot(){var t;const o=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,o)=>{e?t.adoptedStyleSheets=o.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):o.forEach((e=>{const o=document.createElement("style"),n=window.litNonce;void 0!==n&&o.setAttribute("nonce",n),o.textContent=e.cssText,t.appendChild(o)}))})(o,this.constructor.elementStyles),o}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$Em)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$Em)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,o){this._$AK(e,o)}_$Eg(e,t,o=d){var n,s;const a=this.constructor._$Eh(e,o);if(void 0!==a&&!0===o.reflect){const d=(null!==(s=null===(n=o.converter)||void 0===n?void 0:n.toAttribute)&&void 0!==s?s:r.toAttribute)(t,o.type);this._$Ei=e,null==d?this.removeAttribute(a):this.setAttribute(a,d),this._$Ei=null}}_$AK(e,t){var o,n,s;const a=this.constructor,d=a._$Eu.get(e);if(void 0!==d&&this._$Ei!==d){const e=a.getPropertyOptions(d),p=e.converter,m=null!==(s=null!==(n=null===(o=p)||void 0===o?void 0:o.fromAttribute)&&void 0!==n?n:"function"==typeof p?p:null)&&void 0!==s?s:r.fromAttribute;this._$Ei=d,this[d]=m(t,e.type),this._$Ei=null}}requestUpdate(e,t,o){let n=!0;void 0!==e&&(((o=o||this.constructor.getPropertyOptions(e)).hasChanged||l)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===o.reflect&&this._$Ei!==e&&(void 0===this._$ES&&(this._$ES=new Map),this._$ES.set(e,o))):n=!1),!this.isUpdatePending&&n&&(this._$Ev=this._$EC())}async _$EC(){this.isUpdatePending=!0;try{await this._$Ev}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Et&&(this._$Et.forEach(((e,t)=>this[t]=e)),this._$Et=void 0);let t=!1;const o=this._$AL;try{t=this.shouldUpdate(o),t?(this.willUpdate(o),null===(e=this._$Em)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(o)):this._$ET()}catch(e){throw t=!1,this._$ET(),e}t&&this._$AE(o)}willUpdate(e){}_$AE(e){var t;null===(t=this._$Em)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$ET(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ev}shouldUpdate(e){return!0}update(e){void 0!==this._$ES&&(this._$ES.forEach(((e,t)=>this._$Eg(t,this[t],e))),this._$ES=void 0),this._$ET()}updated(e){}firstUpdated(e){}}var p,m;c.finalized=!0,c.elementProperties=new Map,c.elementStyles=[],c.shadowRootOptions={mode:"open"},null===(s=globalThis.reactiveElementPolyfillSupport)||void 0===s||s.call(globalThis,{ReactiveElement:c}),(null!==(a=globalThis.reactiveElementVersions)&&void 0!==a?a:globalThis.reactiveElementVersions=[]).push("1.0.0");const g=globalThis.trustedTypes,u=g?g.createPolicy("lit-html",{createHTML:e=>e}):void 0,v=`lit$${(Math.random()+"").slice(9)}$`,f="?"+v,S=`<${f}>`,C=document,_=(e="")=>C.createComment(e),y=e=>null===e||"object"!=typeof e&&"function"!=typeof e,b=Array.isArray,I=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,w=/-->/g,E=/>/g,T=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,P=/'/g,A=/"/g,O=/^(?:script|style|textarea)$/i,x=(e=>(t,...o)=>({_$litType$:e,strings:t,values:o}))(1),D=Symbol.for("lit-noChange"),k=Symbol.for("lit-nothing"),F=new WeakMap,V=C.createTreeWalker(C,129,null,!1),N=(e,t)=>{const o=e.length-1,n=[];let s,a=2===t?"<svg>":"",r=I;for(let t=0;t<o;t++){const o=e[t];let d,p,m=-1,g=0;for(;g<o.length&&(r.lastIndex=g,p=r.exec(o),null!==p);)g=r.lastIndex,r===I?"!--"===p[1]?r=w:void 0!==p[1]?r=E:void 0!==p[2]?(O.test(p[2])&&(s=RegExp("</"+p[2],"g")),r=T):void 0!==p[3]&&(r=T):r===T?">"===p[0]?(r=null!=s?s:I,m=-1):void 0===p[1]?m=-2:(m=r.lastIndex-p[2].length,d=p[1],r=void 0===p[3]?T:'"'===p[3]?A:P):r===A||r===P?r=T:r===w||r===E?r=I:(r=T,s=void 0);const u=r===T&&e[t+1].startsWith("/>")?" ":"";a+=r===I?o+S:m>=0?(n.push(d),o.slice(0,m)+"$lit$"+o.slice(m)+v+u):o+v+(-2===m?(n.push(void 0),t):u)}const d=a+(e[o]||"<?>")+(2===t?"</svg>":"");return[void 0!==u?u.createHTML(d):d,n]};class L{constructor({strings:e,_$litType$:t},o){let n;this.parts=[];let s=0,a=0;const r=e.length-1,d=this.parts,[p,m]=N(e,t);if(this.el=L.createElement(p,o),V.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(n=V.nextNode())&&d.length<r;){if(1===n.nodeType){if(n.hasAttributes()){const e=[];for(const t of n.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(v)){const o=m[a++];if(e.push(t),void 0!==o){const e=n.getAttribute(o.toLowerCase()+"$lit$").split(v),t=/([.?@])?(.*)/.exec(o);d.push({type:1,index:s,name:t[2],strings:e,ctor:"."===t[1]?M:"?"===t[1]?j:"@"===t[1]?Q:q})}else d.push({type:6,index:s})}for(const t of e)n.removeAttribute(t)}if(O.test(n.tagName)){const e=n.textContent.split(v),t=e.length-1;if(t>0){n.textContent=g?g.emptyScript:"";for(let o=0;o<t;o++)n.append(e[o],_()),V.nextNode(),d.push({type:2,index:++s});n.append(e[t],_())}}}else if(8===n.nodeType)if(n.data===f)d.push({type:2,index:s});else{let e=-1;for(;-1!==(e=n.data.indexOf(v,e+1));)d.push({type:7,index:s}),e+=v.length-1}s++}}static createElement(e,t){const o=C.createElement("template");return o.innerHTML=e,o}}function B(e,t,o=e,n){var s,a,r,d;if(t===D)return t;let p=void 0!==n?null===(s=o._$Cl)||void 0===s?void 0:s[n]:o._$Cu;const m=y(t)?void 0:t._$litDirective$;return(null==p?void 0:p.constructor)!==m&&(null===(a=null==p?void 0:p._$AO)||void 0===a||a.call(p,!1),void 0===m?p=void 0:(p=new m(e),p._$AT(e,o,n)),void 0!==n?(null!==(r=(d=o)._$Cl)&&void 0!==r?r:d._$Cl=[])[n]=p:o._$Cu=p),void 0!==p&&(t=B(e,p._$AS(e,t.values),p,n)),t}class R{constructor(e,t){this.v=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(e){var t;const{el:{content:o},parts:n}=this._$AD,s=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:C).importNode(o,!0);V.currentNode=s;let a=V.nextNode(),r=0,d=0,p=n[0];for(;void 0!==p;){if(r===p.index){let t;2===p.type?t=new H(a,a.nextSibling,this,e):1===p.type?t=new p.ctor(a,p.name,p.strings,this,e):6===p.type&&(t=new z(a,this,e)),this.v.push(t),p=n[++d]}r!==(null==p?void 0:p.index)&&(a=V.nextNode(),r++)}return s}m(e){let t=0;for(const o of this.v)void 0!==o&&(void 0!==o.strings?(o._$AI(e,o,t),t+=o.strings.length-2):o._$AI(e[t])),t++}}class H{constructor(e,t,o,n){var s;this.type=2,this._$AH=k,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=o,this.options=n,this._$Cg=null===(s=null==n?void 0:n.isConnected)||void 0===s||s}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cg}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=B(this,e,t),y(e)?e===k||null==e||""===e?(this._$AH!==k&&this._$AR(),this._$AH=k):e!==this._$AH&&e!==D&&this.$(e):void 0!==e._$litType$?this.T(e):void 0!==e.nodeType?this.S(e):(e=>{var t;return b(e)||"function"==typeof(null===(t=e)||void 0===t?void 0:t[Symbol.iterator])})(e)?this.M(e):this.$(e)}A(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}S(e){this._$AH!==e&&(this._$AR(),this._$AH=this.A(e))}$(e){this._$AH!==k&&y(this._$AH)?this._$AA.nextSibling.data=e:this.S(C.createTextNode(e)),this._$AH=e}T(e){var t;const{values:o,_$litType$:n}=e,s="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=L.createElement(n.h,this.options)),n);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===s)this._$AH.m(o);else{const e=new R(s,this),t=e.p(this.options);e.m(o),this.S(t),this._$AH=e}}_$AC(e){let t=F.get(e.strings);return void 0===t&&F.set(e.strings,t=new L(e)),t}M(e){b(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let o,n=0;for(const s of e)n===t.length?t.push(o=new H(this.A(_()),this.A(_()),this,this.options)):o=t[n],o._$AI(s),n++;n<t.length&&(this._$AR(o&&o._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var o;for(null===(o=this._$AP)||void 0===o||o.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cg=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class q{constructor(e,t,o,n,s){this.type=1,this._$AH=k,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=s,o.length>2||""!==o[0]||""!==o[1]?(this._$AH=Array(o.length-1).fill(new String),this.strings=o):this._$AH=k}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,o,n){const s=this.strings;let a=!1;if(void 0===s)e=B(this,e,t,0),a=!y(e)||e!==this._$AH&&e!==D,a&&(this._$AH=e);else{const n=e;let r,d;for(e=s[0],r=0;r<s.length-1;r++)d=B(this,n[o+r],t,r),d===D&&(d=this._$AH[r]),a||(a=!y(d)||d!==this._$AH[r]),d===k?e=k:e!==k&&(e+=(null!=d?d:"")+s[r+1]),this._$AH[r]=d}a&&!n&&this.k(e)}k(e){e===k?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class M extends q{constructor(){super(...arguments),this.type=3}k(e){this.element[this.name]=e===k?void 0:e}}class j extends q{constructor(){super(...arguments),this.type=4}k(e){e&&e!==k?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name)}}class Q extends q{constructor(e,t,o,n,s){super(e,t,o,n,s),this.type=5}_$AI(e,t=this){var o;if((e=null!==(o=B(this,e,t,0))&&void 0!==o?o:k)===D)return;const n=this._$AH,s=e===k&&n!==k||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,a=e!==k&&(n===k||s);s&&this.element.removeEventListener(this.name,this,n),a&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,o;"function"==typeof this._$AH?this._$AH.call(null!==(o=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==o?o:this.element,e):this._$AH.handleEvent(e)}}class z{constructor(e,t,o){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=o}get _$AU(){return this._$AM._$AU}_$AI(e){B(this,e)}}var U,$,K;null===(p=globalThis.litHtmlPolyfillSupport)||void 0===p||p.call(globalThis,L,H),(null!==(m=globalThis.litHtmlVersions)&&void 0!==m?m:globalThis.litHtmlVersions=[]).push("2.0.0");class G extends c{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var e,t;const o=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=o.firstChild),o}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Dt=((e,t,o)=>{var n,s;const a=null!==(n=null==o?void 0:o.renderBefore)&&void 0!==n?n:t;let r=a._$litPart$;if(void 0===r){const e=null!==(s=null==o?void 0:o.renderBefore)&&void 0!==s?s:null;a._$litPart$=r=new H(t.insertBefore(_(),e),e,void 0,null!=o?o:{})}return r._$AI(e),r})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Dt)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Dt)||void 0===e||e.setConnected(!1)}render(){return D}}function Z(e,t){let o=e;const n=(t||"").split("/"),s=n.length;n.forEach(((e,t)=>{Object.prototype.hasOwnProperty.call(o,e)&&(t===s-1?delete o[e]:o=o[e])}))}G.finalized=!0,G._$litElement$=!0,null===(U=globalThis.litElementHydrateSupport)||void 0===U||U.call(globalThis,{LitElement:G}),null===($=globalThis.litElementPolyfillSupport)||void 0===$||$.call(globalThis,{LitElement:G}),(null!==(K=globalThis.litElementVersions)&&void 0!==K?K:globalThis.litElementVersions=[]).push("3.0.0");const Y="surveyTriggerButton";function W(e){return!(!e.QSI||!e.QSI.API||"function"!=typeof e.QSI.API.unload)}const X={init:function(e){const{interceptUrl:t,globalObj:o,contextRootPath:n,contextParamPaths:s,customContextParamPaths:a,surveyLaunchMethod:r}=e;return new Promise(((e,d)=>{if(t)try{const p={},h=()=>{var t,m;o.QSI.API?(p.QSI=o.QSI,p.apiLoadedListener=h,p.setParameters=new Set([]),p.globalObj=o,p.destroyed=!1,p.firstNonExistingRoot=function(e,t){if("string"!=typeof t||0===t.length)return null;const o=t.split("/");let n="",s=e;for(let e=0;e<o.length;e++){const t=o[e];if(!Object.prototype.hasOwnProperty.call(s,t))return n+(0===n.length?"":"/")+t;s=s[t],n+=(0===e?"":"/")+t}return t===n?null:n}(o,n),p.contextRootPath=n,p.contextParamPaths=(t=s,m=a,Object.keys(t||{}).reduce(((e,o)=>(e[o]=t[o],e)),JSON.parse(JSON.stringify(m||{})))),p.surveyLaunchMethod=r,e(p)):d(new Error("Survey intercept was loaded but API could not be found"))};if(!o.document||!o.document.body)throw new Error("Cannot inject elements in the document: document.body is not available.");switch(r){case"invisibleButton":if(document.getElementById(Y))throw new Error("An element with id surveyTriggerButton already exists in this page. The survey won't be launched unless the existing button is removed or its id is renamed.");const e=function(){const e=document.createElement("button");return e.setAttribute("id","surveyTriggerButton"),e.style.display="none",document.body.appendChild(e),e}();p.invisibleButtonElement=e;break;case"qsiApi":break;default:throw new Error(`Unsupported launch method: ${r}.`)}W(o)?o.QSI.API.load().then(h):(!function(e,t){const o=t.document.createElement("script");o.type="text/javascript",o.src=e,t.document.body.appendChild(o)}(t,o),o.addEventListener("qsi_js_loaded",h,!1))}catch(e){d(e)}else d(new Error("No intercept URL was provided. This is a mandatory parameter."))}))},destroy:function(e){W(e)&&e.QSI.API.unload(),e.apiLoadedListener&&e.globalObj.removeEventListener("qsi_js_loaded",e.apiLoadedListener);let t=e.contextRootPath;e.firstNonExistingRoot?Z(e.globalObj,e.firstNonExistingRoot):e.setParameters.forEach((o=>{const n=e.contextParamPaths[o];n&&(t=`${t}/${n}`),Z(e.globalObj,t)})),e.invisibleButtonElement&&e.invisibleButtonElement.remove(),e.destroyed=!0},setContextParameters:function(e,t){const o=function(e,t,o){2===arguments.length&&(o=!0);let n=e;const s=(t||"").split("/");for(const e of s){if(!Object.prototype.hasOwnProperty.call(n,e)){if(!o)return;n[e]={}}n=n[e]}return n}(e.globalObj,e.contextRootPath);Object.keys(t).forEach((n=>{const s=e.contextParamPaths[n]||n;!function(e,t,o){let n=e;if(""===t)throw new Error("Path cannot be empty");const s=(t||"").split("/"),a=s.length;s.forEach(((e,t)=>{Object.prototype.hasOwnProperty.call(n,e)||(n[e]={}),t===a-1&&(n[e]=o),n=n[e]}))}(o,s,t[n]),e.setParameters.add(n)}))},startSurvey:function(e){if(0===e.setParameters.size)throw new Error("Cannot start a survey without context parameters. Call setContextParameters first.");"invisibleButton"!==e.surveyLaunchMethod?(e.QSI.API.unload(),e.QSI.API.load().then(e.QSI.API.run.bind(e.QSI.API))):e.invisibleButtonElement&&e.invisibleButtonElement.dispatchEvent(new Event("click"))}},J="cx-qtx-sbtn-timestamp",ee="cx-qtx-sbtn-localstorage-test";const te={saveUserInteractionTime:function(e){if(e.enabled)try{e.globalObj.localStorage.setItem(J,+new Date)}catch(e){return}},determineNotificationStatus:function(e){return new Promise(((t,o)=>{var n;if(!e.enabled)return void t(!1);if(!function(e){var t;if("boolean"==typeof e._IS_LOCAL_STORAGE_AVAILABLE_CACHE)return e._IS_LOCAL_STORAGE_AVAILABLE_CACHE;const o=null==e||null===(t=e.globalObj)||void 0===t?void 0:t.localStorage;let n;try{o.setItem(ee,"true"),o.removeItem(ee),n=!0}catch(e){n=!1}return e._IS_LOCAL_STORAGE_AVAILABLE_CACHE=n,n}(e))return void t(!1);const s=null==e||null===(n=e.range)||void 0===n?void 0:n.type;if("months"!==s)return void o(new Error(`Invalid range type configured: ${s}`));const a=(new Date).getMonth()+1,r=function(e){var t,o;return"months"===(null==e||null===(t=e.range)||void 0===t?void 0:t.type)?null==e||null===(o=e.range)||void 0===o?void 0:o.value.map((e=>window.parseInt(e,10))):[]}(e),d=r.indexOf(a)>=0,p=function(e){try{return e.globalObj.localStorage.getItem(J)}catch(e){return null}}(e);if(!p)return void t(d);const m=parseInt(p,10),g=new Date(m).getMonth()+1;t(d&&a!==g)}))}};let ie,oe,ne,se,st=e=>e;class rt extends G{constructor(){super(),this._version="1.0.2",this.apiContext=null,this.notifyUser=null,this.surveyLaunchMethod="invisibleButton",this.contextParams={},this.fiori3Compatible=!1,this.interceptUrl="",this.contextRootPath="sap/qtx",this.notificationConfig={enabled:!0,range:{type:"months",value:[2,5,8,11]}},this.title="Give Feedback",this.ariaLabel="Give Feedback",this.contextParamPaths={Q_Language:"appcontext/languageTag",language:"appcontext/languageTag",appFrameworkVersion:"appcontext/appFrameworkVersion",theme:"appcontext/theme",appId:"appcontext/appId",appVersion:"appcontext/appVersion",technicalAppComponentId:"appcontext/technicalAppComponentId",appTitle:"appcontext/appTitle",appSupportInfo:"appcontext/appSupportInfo",tenantId:"session/tenantId",tenantRole:"session/tenantRole",appFrameworkId:"appcontext/appFrameworkId",productName:"session/productName",platformType:"session/platformType",pushSrcType:"push/pushSrcType",pushSrcAppId:"push/pushSrcAppId",pushSrcTrigger:"push/pushSrcTrigger",clientAction:"appcontext/clientAction",previousTheme:"appcontext/previousTheme",followUpCount:"appcontext/followUpCount",deviceType:"device/type",orientation:"device/orientation",osName:"device/osName",browserName:"device/browserName"},this.customContextParamPaths={}}static get properties(){return{title:{type:String,attribute:"title",reflect:!1},ariaLabel:{type:String,attribute:"aria-label",reflect:!1},surveyLaunchMethod:{type:String,attribute:"survey-launch-method",reflect:!1},notifyUser:{type:Boolean,attribute:"notify-user",reflect:!0},notificationConfig:{type:Object,attribute:"notification-config",reflect:!0},interceptUrl:{type:String,attribute:"intercept-url",reflect:!0},customContextParamPaths:{type:Object,attribute:"custom-context-param-paths",reflect:!0},contextParamPaths:{type:Object,attribute:"context-param-paths",reflect:!0},contextRootPath:{type:String,attribute:"context-root-path",reflect:!0},contextParams:{type:Object,attribute:"context-params",reflect:!0},fiori3Compatible:{type:Boolean,attribute:"fiori3-compatible",reflect:!0}}}_onClick(){this._turnOffNotification(),te.saveUserInteractionTime({...this.notificationConfig,globalObj:window}),this._runSurvey()}_turnOffNotification(){this.notifyUser=!1,this.requestUpdate()}_runSurvey(){this._getAPIContext().then((e=>{const t=this.contextParams;this.apiContext=e,X.setContextParameters(this.apiContext,t),X.startSurvey(this.apiContext)}),(e=>{console.log(e)}))}_getAPIContext(){return this.apiContext?Promise.resolve(this.apiContext):X.init({interceptUrl:this.interceptUrl,globalObj:window,contextRootPath:this.contextRootPath,contextParamPaths:this.contextParamPaths,customContextParamPaths:this.customContextParamPaths,surveyLaunchMethod:this.surveyLaunchMethod})}setContextParams(e){this.contextParams=JSON.parse(JSON.stringify(e))}updateContextParam(e,t){this.contextParams[e]=t}connectedCallback(){super.connectedCallback(),this.addEventListener("click",this._onClick),this.setAttribute("aria-hidden","true"),te.determineNotificationStatus({...this.notificationConfig,globalObj:window}).then((e=>{null===this.notifyUser&&(this.notifyUser=e,this.requestUpdate())}),(e=>{console.log(e)}))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("click",this._onClick),this.apiContext&&(X.destroy(this.apiContext),this.apiContext=null)}render(){const e=this.fiori3Compatible?x(ie||(ie=st`<svg
  version="1.1"
  viewBox="0 0 16 15"
  width="16"
  height="15"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:svg="http://www.w3.org/2000/svg"
>
  <g class="pathGroup">
      <path
          class="backgroundCircle"
          style="stroke-width:0.0257446"
          d="m 11.5,0.79276785 q 0.77234,0 1.441702,0.29606375 0.66936,0.2960636 1.171381,0.7980845 0.502022,0.5020211 0.798086,1.1713824 0.296063,0.6693614 0.296063,1.4417015 0,0.77234 -0.296063,1.4417015 Q 14.615105,6.6110627 14.113083,7.1130839 13.611062,7.6151046 12.941702,7.9111681 12.27234,8.2072317 11.5,8.2072317 q -0.77234,0 -1.441701,-0.2960636 Q 9.3889383,7.6151046 8.8869163,7.1130839 8.3848954,6.6110627 8.0888316,5.9417015 7.792768,5.27234 7.792768,4.5 q 0,-0.7723401 0.2960636,-1.4417015 Q 8.3848954,2.3889372 8.8869163,1.8869161 9.3889383,1.3848952 10.058299,1.0888316 10.72766,0.79276785 11.5,0.79276785 Z"
      />
      <path
          class="foregroundIcon"
          d="m 11.5,0 q 0.9375,0 1.75,0.359375 0.8125,0.35937501 1.421874,0.96875 Q 15.28125,1.9375 15.640626,2.75 16,3.5625 16,4.5 16,5.4375001 15.640626,6.2500002 15.28125,7.0625 14.671874,7.6718752 14.0625,8.2812502 13.25,8.6406251 12.4375,8.9999998 11.5,8.9999998 q -0.9375,0 -1.7499995,-0.3593747 Q 8.9375006,8.2812502 8.3281251,7.6718752 7.7187501,7.0625 7.359375,6.2500002 7.0000001,5.4375001 7.0000001,4.5 q 0,-0.9375 0.3593749,-1.75 Q 7.7187501,1.9375 8.3281251,1.328125 8.9375006,0.71875001 9.7500005,0.359375 10.5625,0 11.5,0 Z M 7.9375002,4.5 q 0,0.7500001 0.2812498,1.3906251 Q 8.5,6.53125 8.984375,7.0156251 9.4687505,7.5000001 10.109376,7.7812502 10.75,8.0625 11.5,8.0625 q 0.75,0 1.390624,-0.2812498 Q 13.53125,7.5000001 14.015625,7.0156251 14.5,6.53125 14.78125,5.8906251 15.062499,5.2500001 15.062499,4.5 q 0,-0.75 -0.281249,-1.3906249 Q 14.5,2.4687501 14.015625,1.9843751 13.53125,1.5 12.890624,1.21875 12.25,0.93750001 11.5,0.93750001 q -0.75,0 -1.390624,0.28124999 Q 9.4687505,1.5 8.984375,1.9843751 8.5,2.4687501 8.21875,3.1093751 7.9375002,3.75 7.9375002,4.5 Z M 0,3.9999998 Q 0,3.1875001 0.59375,2.59375 1.1875,2.0000002 2.0000002,2.0000002 h 4.59375 Q 6.375,2.40625 6.2187502,3 h -4.21875 Q 1.5624999,3 1.28125,3.3124999 0.99999999,3.59375 0.99999999,3.9999998 v 6.0000001 q 0,0.4375001 0.28125001,0.7187491 Q 1.5624999,11 2.0000002,11 h 1.9999996 v 2.500001 L 6.0000001,11.03125 13.000001,11 q 0.4375,0 0.718749,-0.281251 Q 14,10.4375 14,10.000001 V 9.406253 Q 14.3125,9.218753 14.5625,9.0625025 14.8125,8.9062526 15,8.7500027 v 1.2500003 q 0,0.84375 -0.578124,1.421875 -0.578126,0.578125 -1.421875,0.578125 H 6.5000001 l -2.4375,2.875 q -0.125,0.125001 -0.4062502,0.125001 -0.2499998,0 -0.4531248,-0.171875 Q 3,14.656254 3,14.375003 V 12.000004 H 2.0000002 q -0.8437503,0 -1.4218752,-0.578125 Q 0,10.84375 0,9.9999999 Z M 12.09375,3.0625001 Q 12.09375,2.75 12.296874,2.59375 12.5,2.4375 12.750001,2.4375 q 0.25,0 0.437499,0.15625 0.1875,0.15625 0.1875,0.4687501 0,0.3125 -0.1875,0.4687501 Q 13.000001,3.6875 12.750001,3.6875 12.5,3.6875 12.296874,3.5312502 12.09375,3.3750001 12.09375,3.0625001 Z M 10.249999,2.4375 q 0.25,0 0.437501,0.15625 0.187501,0.15625 0.187501,0.4687501 0,0.3125 -0.187501,0.4687501 Q 10.499999,3.6875 10.249999,3.6875 9.9999999,3.6875 9.7968755,3.5312502 9.5937501,3.3750001 9.5937501,3.0625001 9.5937501,2.75 9.7968755,2.59375 9.9999999,2.4375 10.249999,2.4375 Z m -1.0937487,2.7499999 0.062501,-0.062499 q 0.093749,-0.093751 0.21875,-0.093751 0.1562504,0 0.2500004,0.125 0.8437513,0.9375001 1.8124993,0.9375001 1.031251,0 1.8125,-0.9375001 0.09374,-0.093751 0.25,-0.093751 0.125,0 0.21875,0.093751 h 0.03125 q 0,0.031249 0.01561,0.031249 0.01562,0 0.01562,0.03125 0.125001,0.1249999 0.125001,0.21875 0,0.125 -0.09376,0.21875 -0.5,0.6250001 -1.109375,0.9218751 -0.609376,0.2968747 -1.234374,0.2968747 -0.625001,0 -1.250001,-0.2968747 Q 9.6562318,6.2812505 9.1249813,5.6562504 9.0312322,5.5625 9.0312322,5.4687503 q 0,-0.03125 0.015627,-0.109375 0.015628,-0.078125 0.1093752,-0.1718751 z"
          style="stroke-width:0.0312499"
      />
  </g>
</svg>
`)):x(oe||(oe=st`<svg
    version="1.1"
    width="18.190166"
    height="20"
    viewBox="0 0 18.190167 20"
    xmlns="http://www.w3.org/2000/svg"
    xmlns:svg="http://www.w3.org/2000/svg"
>
    <g class="pathGroup">
        <path
            d="M 3.665181,2.7601972 H 2.7601972 c -0.9996179,0 -1.80996746,0.8103496 -1.80996746,1.8099675 v 9.0498373 c 0,0.999645 0.81034956,1.809967 1.80996746,1.809967 h 1.8099675 v 3.619936 L 8.1900998,15.429969 H 15.42997 c 0.999645,0 1.809967,-0.810322 1.809967,-1.809967 v -0.904984"
            stroke-linecap="round"
            stroke-linejoin="round"
        />
        <path
            class="smiley"
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="m 11.810035,11.810035 c 2.998844,0 5.429902,-2.4310584 5.429902,-5.4299028 0,-2.9988537 -2.431058,-5.42990246 -5.429902,-5.42990246 -2.9988444,0 -5.4299028,2.43104876 -5.4299028,5.42990246 0,2.9988444 2.4310584,5.4299028 5.4299028,5.4299028 z"
            stroke-linecap="round"
            stroke-linejoin="round"
        />
        <path
            d="m 10.000068,7.2851161 c 0,0 0.452491,0.9049837 1.809967,0.9049837 1.357475,0 1.809967,-0.9049837 1.809967,-0.9049837"
            stroke-linecap="round"
            stroke-linejoin="round"
        />
        <path
            class="eye"
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="m 10.000068,5.4751485 c 0.499821,0 0.904983,-0.4051794 0.904983,-0.9049838 0,-0.4998044 -0.405162,-0.9049838 -0.904983,-0.9049838 -0.4998231,0 -0.904984,0.4051794 -0.904984,0.9049838 0,0.4998044 0.4051609,0.9049838 0.904984,0.9049838 z"
        />
        <path
            class="eye"
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="m 13.620002,5.4751485 c 0.499823,0 0.904984,-0.4051794 0.904984,-0.9049838 0,-0.4998044 -0.405161,-0.9049838 -0.904984,-0.9049838 -0.499822,0 -0.904984,0.4051794 -0.904984,0.9049838 0,0.4998044 0.405162,0.9049838 0.904984,0.9049838 z"
        />
    </g>
</svg>
`));return x(ne||(ne=st`
            <button title="${0}" aria-label="${0}">
                ${0}
            </button>
        `),this.title,this.ariaLabel,e)}static get styles(){return((e,...o)=>{const n=1===e.length?e[0]:o.reduce(((t,o,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(o)+e[n+1]),e[0]);return new i(n,t)})(se||(se=st`/*
 * Prevent focus effect on the host, the button only should be focussed.
 */
:host(:focus) {
    outline: none;
    box-shadow: none;
}

:host(:focus) button {
    background-color: initial;
}

button {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    width: var(--qtxSurveyButton_Size, 2rem);
    height: var(--qtxSurveyButton_Size, 2rem);

    outline: none;

    shape-rendering: geometricprecision;

    /* Fiori Next buttons have transitions */
    -webkit-transition: 0.3s ease-in-out;
    transition: 0.3s ease-in-out;

    font-weight: 400;
    -webkit-box-sizing: border-box;
    box-sizing: border-box;
    margin: 0;
    border: 0;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    cursor: pointer;
    position: relative;
    padding: 6px;
    -webkit-box-shadow: none;
    box-shadow: none;
    border-radius: var(--sapButton_BorderCornerRadius, 0.5rem);
    background: 0 0;
}

button.is-focus,
button:focus {
    z-index: 5;
    background: var(--sapShell_Hover_Background, transparent);
    outline: 0;
    border-color: #fff;
    -webkit-box-shadow: 0 0 2px rgba(27, 144, 255, 0.16),
        0 8px 16px rgba(27, 144, 255, 0.16), 0 0 0 0.125rem #1b90ff,
        inset 0 0 0 0.125rem #fff;
    box-shadow: 0 0 2px rgba(27, 144, 255, 0.16),
        0 8px 16px rgba(27, 144, 255, 0.16), 0 0 0 0.125rem #1b90ff,
        inset 0 0 0 0.125rem #fff;
}

:host([fiori3-compatible]) button {
    /*
     * Fiori 3: use correct sizing
     */
    width: var(--qtxSurveyButton_Size, 2.25rem);
    height: var(--qtxSurveyButton_Size, 2.25rem);

    /*
     * Fiori 3: disable Fiori Next transitions + box shadow
     */
    -webkit-transition: none;
    transition: none;
    box-shadow: none;
    -webkit-box-shadow: none;
}
:host([fiori3-compatible]):host(:hover) button {
    box-shadow: none;
    -webkit-box-shadow: none;
}
:host([fiori3-compatible]):host(:active) button {
    box-shadow: none;
    -webkit-box-shadow: none;
}

/*
 * Fiori3: create visible focus area
 */
:host([fiori3-compatible]):host(:focus) button:after {
    content: "";
    position: absolute;
    width: auto;
    height: auto;
    top: 0.0625rem;
    left: 0.0625rem;
    right: 0.0625rem;
    bottom: 0.0625rem;
    border: var(--sapContent_FocusWidth, 0.0625rem) dotted
        var(--sapContent_ContrastFocusColor, #fff);
    border-radius: 4px;
}

:host(:hover) button {
    background-color: var(--sapShell_Hover_Background, transparent);

    -webkit-box-shadow: 0 0 2px rgba(131, 150, 168, 0.16),
        0 8px 16px rgba(131, 150, 168, 0.16);
    box-shadow: 0 0 2px rgba(131, 150, 168, 0.16),
        0 8px 16px rgba(131, 150, 168, 0.16);
}
:host(:hover) path {
    stroke: var(--sapShell_Active_TextColor, #475e75);
}
:host(:hover) .eye,
:host(:hover) .foregroundIcon {
    fill: var(--sapShell_Active_TextColor, #475e75);
    stroke: transparent;
}
:host(:active) button {
    -webkit-box-shadow: 0 0 2px rgba(131, 150, 168, 0.16),
        0 2px 4px rgba(131, 150, 168, 0.16);
    box-shadow: 0 0 2px rgba(131, 150, 168, 0.16),
        0 2px 4px rgba(131, 150, 168, 0.16);
    background: var(--sapShell_Active_Background, #fff);
}

:host([notify-user]) .smiley,
:host([notify-user]) .backgroundCircle {
    fill: var(
        --qtxSurveyButton_NotificationColor,
        #64edd2
    ); /* Teal 2 */
}
:host([notify-user][fiori3-compatible]) .smiley,
:host([notify-user][fiori3-compatible]) .backgroundCircle {
    fill: var(
        --qtxSurveyButton_NotificationColor,
        var(--sapIndicationColor_6, #0f828f)
    );
}

:host([fiori3-compatible]) .pathGroup {
    transform: scale(var(--qtxSurveyButton_IconScale, 1))
        translate(0, var(--qtxSurveyButton_IconOffsetY, 0));
}
.pathGroup {
    transform: scale(var(--qtxSurveyButton_IconScale, 1))
        translate(0, var(--qtxSurveyButton_IconOffsetY, 0));
    transform-origin: center;
    fill: none;
}

path {
    stroke: var(--sapShell_InteractiveTextColor, #5b738b);
    stroke-width: 2px;
    vector-effect: non-scaling-stroke;
}
.eye,
.foregroundIcon {
    fill: var(--sapShell_InteractiveTextColor, #5b738b);
    stroke: transparent;
}

button::after,
button::before {
    -webkit-box-sizing: inherit;
    box-sizing: inherit;
    font-size: inherit;
}

button.is-pressed,
button[aria-pressed="true"] {
    -webkit-box-shadow: 0 0 2px rgba(131, 150, 168, 0.16),
        0 2px 4px rgba(131, 150, 168, 0.16);
    box-shadow: 0 0 2px rgba(131, 150, 168, 0.16),
        0 2px 4px rgba(131, 150, 168, 0.16);
    background: var(--sapShell_Active_Background, #fff);
}
`))}}var ae,re,le;ae=rt,re="shadowRootOptions",le={...G.shadowRootOptions,mode:"closed",delegatesFocus:"true"},re in ae?Object.defineProperty(ae,re,{value:le,enumerable:!0,configurable:!0,writable:!0}):ae[re]=le,window.customElements.define("cx-qtx-survey-button",rt)}();window.__smartedit__.addDecoratorPayload("Component","QualtricsComponent",{selector:"se-qualtrics",template:`\n        <cx-qtx-survey-button\n            fiori3-compatible="true"\n            style="--qtxSurveyButton_Size:40px; --sapContent_ContrastFocusColor: transparent;"\n            title="{{ 'se.toolbar.qualtrics.title' | translate }}"\n            [attr.intercept-url]="interceptUrl"\n            [attr.context-params]="contextParamsString"\n            (click)="onClick()"\n        >\n        </cx-qtx-survey-button>\n    `});let et=class QualtricsComponent{constructor(e,t,o){this.translateService=e;this.settingService=t;this.userTrackingService=o;this.interceptUrl="";this.contextParamsString="";this.contextParams={}}ngOnDestroy(){document.querySelector("cx-qtx-survey-button").remove()}ngOnInit(){this.contextParams=this._getFixedContextParams();this.settingService.load().then((e=>{const t=`${e["modelt.customer.code"]}-${e["modelt.project.code"]}-${e["modelt.environment.code"]}`;const o=e["modelt.environment.type"];const n=e["build.version.api"];this.contextParamsString=JSON.stringify(Object.assign(Object.assign({},this.contextParams),{tenantId:t,tenantRole:o,appVersion:n}));this.interceptUrl=e["smartedit.qualtrics.interceptUrl"]}));this.translateService.onLangChange.subscribe((e=>{const t=e.lang;const o=e.translations["se.application.name"];this.contextParamsString=JSON.stringify(Object.assign(Object.assign({},this.contextParams),{language:t,productName:o}))}))}onClick(){this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.HEADER_TOOL,"Give Feedback")}_getFixedContextParams(){return{appFrameworkId:4,appFrameworkVersion:n.VERSION.full,appId:"SmartEdit",appTitle:"SmartEdit",appSupportInfo:"CEC-COM-ADM-SEDIT",pushSrcType:2}}};et=__decorate([n.Component({selector:"se-qualtrics",template:`\n        <cx-qtx-survey-button\n            fiori3-compatible="true"\n            style="--qtxSurveyButton_Size:40px; --sapContent_ContrastFocusColor: transparent;"\n            title="{{ 'se.toolbar.qualtrics.title' | translate }}"\n            [attr.intercept-url]="interceptUrl"\n            [attr.context-params]="contextParamsString"\n            (click)="onClick()"\n        >\n        </cx-qtx-survey-button>\n    `}),__metadata("design:paramtypes",[v.TranslateService,d.SettingsService,d.UserTrackingService])],et);let tt=class TopToolbarsModule{};tt=__decorate([n.NgModule({schemas:[n.CUSTOM_ELEMENTS_SCHEMA],imports:[f.PopoverModule,g.CommonModule,d.SeGenericEditorModule,v.TranslateModule.forChild(),d.TooltipModule],declarations:[d.HeaderLanguageDropdownComponent,Xe,Ye,Ke,Ze,qe,Qe,Je,et],entryComponents:[d.HeaderLanguageDropdownComponent,Xe,Ye,Ke,Ze,qe,Qe,Je,et],exports:[d.HeaderLanguageDropdownComponent,Xe,Ye,Ke,Ze,qe,Qe,Je,et]})],tt);t.ToolbarModule=class ToolbarModule{};t.ToolbarModule=__decorate([n.NgModule({imports:[tt,g.CommonModule,v.TranslateModule.forChild(),d.CompileHtmlModule,d.PropertyPipeModule,d.ResizeObserverModule,f.PopoverModule,d.ClickOutsideModule,d.PreventVerticalOverflowModule],providers:[{provide:d.IToolbarServiceFactory,useClass:Ue}],declarations:[Be,Ge,$e,He,We],entryComponents:[Be,Ge,$e,He,We],exports:[Be,Ge,$e,He,We]})],t.ToolbarModule);window.__smartedit__.addDecoratorPayload("Component","AnnouncementBoardComponent",{selector:"se-announcement-board",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="(announcements$ | async) as announcements"><div class="se-announcement-board"><se-announcement *ngFor="\n                let announcement of (announcements | seReverse);\n                trackBy: annnouncementTrackBy;\n                let i = index\n            " id="se-announcement-{{ i }}" [announcement]="announcement"></se-announcement></div></ng-container>`});let it=class AnnouncementBoardComponent{constructor(e){this.announcementService=e}ngOnInit(){this.announcements$=this.announcementService.getAnnouncements()}annnouncementTrackBy(e,t){return t.id}};it=__decorate([n.Component({selector:"se-announcement-board",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="(announcements$ | async) as announcements"><div class="se-announcement-board"><se-announcement *ngFor="\n                let announcement of (announcements | seReverse);\n                trackBy: annnouncementTrackBy;\n                let i = index\n            " id="se-announcement-{{ i }}" [announcement]="announcement"></se-announcement></div></ng-container>`}),__param(0,n.Inject(d.IAnnouncementService)),__metadata("design:paramtypes",[x])],it);window.__smartedit__.addDecoratorPayload("Component","AnnouncementComponent",{selector:"se-announcement",changeDetection:n.ChangeDetectionStrategy.OnPush,animations:[E.trigger("fadeAnimation",[E.transition(":enter",[E.style({opacity:0,transform:"rotateY(90deg)"}),E.animate("0.5s"),E.style({opacity:1,transform:"translateX(0px)"})]),E.transition(":leave",[E.animate("0.25s"),E.style({opacity:"0",transform:"translateX(100%)"})])])],template:`<div class="se-announcement-content"><span *ngIf="isCloseable()" class="sap-icon--decline se-announcement-close" (click)="closeAnnouncement()"></span><div *ngIf="hasMessage()"><h4 *ngIf="hasMessageTitle()">{{ announcement.messageTitle | translate }}</h4><span>{{ announcement.message | translate }}</span></div><ng-container *ngIf="hasComponent()"><ng-container *ngComponentOutlet="announcement.component; injector: announcementInjector"></ng-container></ng-container></div>`});let ot=class AnnouncementComponent{constructor(e,t){this.announcementService=e;this.injector=t}get fadeAnimation(){return true}ngOnChanges(){this.createAnnouncementInjector()}hasComponent(){return this.announcement.hasOwnProperty("component")}hasMessage(){return this.announcement.hasOwnProperty("message")}hasMessageTitle(){return this.announcement.hasOwnProperty("messageTitle")}isCloseable(){return this.announcement.hasOwnProperty("closeable")?this.announcement.closeable:O.closeable}closeAnnouncement(){this.announcementService.closeAnnouncement(this.announcement.id)}createAnnouncementInjector(){this.announcementInjector=n.Injector.create({parent:this.injector,providers:[{provide:d.ANNOUNCEMENT_DATA,useValue:Object.assign({id:this.announcement.id},this.announcement.data)}]})}};__decorate([n.Input(),__metadata("design:type",Object)],ot.prototype,"announcement",void 0);__decorate([n.HostBinding("@fadeAnimation"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],ot.prototype,"fadeAnimation",null);ot=__decorate([n.Component({selector:"se-announcement",changeDetection:n.ChangeDetectionStrategy.OnPush,animations:[E.trigger("fadeAnimation",[E.transition(":enter",[E.style({opacity:0,transform:"rotateY(90deg)"}),E.animate("0.5s"),E.style({opacity:1,transform:"translateX(0px)"})]),E.transition(":leave",[E.animate("0.25s"),E.style({opacity:"0",transform:"translateX(100%)"})])])],template:`<div class="se-announcement-content"><span *ngIf="isCloseable()" class="sap-icon--decline se-announcement-close" (click)="closeAnnouncement()"></span><div *ngIf="hasMessage()"><h4 *ngIf="hasMessageTitle()">{{ announcement.messageTitle | translate }}</h4><span>{{ announcement.message | translate }}</span></div><ng-container *ngIf="hasComponent()"><ng-container *ngComponentOutlet="announcement.component; injector: announcementInjector"></ng-container></ng-container></div>`}),__metadata("design:paramtypes",[d.IAnnouncementService,n.Injector])],ot);window.__smartedit__.addDecoratorPayload("Component","HotkeyNotificationComponent",{selector:"se-hotkey-notification",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<div class="se-notification__hotkey"><div *ngFor="let key of hotkeyNames; let last = last"><div class="se-notification__hotkey--key"><span>{{ key }}</span></div><span *ngIf="!last" class="se-notification__hotkey__icon--add">+</span></div><div class="se-notification__hotkey--text"><div class="se-notification__hotkey--title">{{ title }}</div><div class="se-notification__hotkey--message">{{ message }}</div></div></div>`});let nt=class HotkeyNotificationComponent{};__decorate([n.Input(),__metadata("design:type",Array)],nt.prototype,"hotkeyNames",void 0);__decorate([n.Input(),__metadata("design:type",String)],nt.prototype,"title",void 0);__decorate([n.Input(),__metadata("design:type",String)],nt.prototype,"message",void 0);nt=__decorate([n.Component({selector:"se-hotkey-notification",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<div class="se-notification__hotkey"><div *ngFor="let key of hotkeyNames; let last = last"><div class="se-notification__hotkey--key"><span>{{ key }}</span></div><span *ngIf="!last" class="se-notification__hotkey__icon--add">+</span></div><div class="se-notification__hotkey--text"><div class="se-notification__hotkey--title">{{ title }}</div><div class="se-notification__hotkey--message">{{ message }}</div></div></div>`})],nt);window.__smartedit__.addDecoratorPayload("Component","PerspectiveSelectorHotkeyNotificationComponent",{selector:"se-perspective-selector-hotkey-notification",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<se-hotkey-notification [hotkeyNames]="['esc']" [title]="'se.application.status.hotkey.title' | translate" [message]="'se.application.status.hotkey.message' | translate"></se-hotkey-notification>`});let at=class PerspectiveSelectorHotkeyNotificationComponent{};at=__decorate([d.SeCustomComponent(),n.Component({selector:"se-perspective-selector-hotkey-notification",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<se-hotkey-notification [hotkeyNames]="['esc']" [title]="'se.application.status.hotkey.title' | translate" [message]="'se.application.status.hotkey.message' | translate"></se-hotkey-notification>`})],at);let lt=class HotkeyNotificationModule{};lt=__decorate([n.NgModule({imports:[g.CommonModule,d.TranslationModule.forChild()],declarations:[nt,at],entryComponents:[nt,at]})],lt);window.__smartedit__.addDecoratorPayload("Component","InvalidRouteComponent",{selector:"empty",template:"<div>This page doesn't exist</div>"});let ct=class InvalidRouteComponent{};ct=__decorate([n.Component({selector:"empty",template:"<div>This page doesn't exist</div>"})],ct);function surpressDiErrorForDeprecated(){a.module("alertServiceModule",["legacySmarteditCommonsModule"]);a.module("smarteditServicesModule",[]);a.module("modalServiceModule",[]);a.module("functionsModule",[])}const deprecate=()=>{surpressDiErrorForDeprecated()};deprecate();const dt=o(945);const pt=o(557);const mt="smarteditcontainer";let gt=class Smarteditcontainer{};gt=__decorate([d.SeModule({imports:[d.TemplateCacheDecoratorModule,dt,pt,"coretemplates","paginationFilterModule","resourceLocationsModule","seConstantsModule",d.GenericEditorModule],providers:[],config:["$provide","LANDING_PAGE_PATH","STORE_FRONT_CONTEXT","$routeProvider","$logProvider",(e,t,o,n,s)=>{"ngInject";d.instrument(e,(e=>d.objectUtils.readObjectStructure(e)),mt);d.SeRouteService.init(n);d.SeRouteService.provideLegacyRoute({path:t,route:{redirectTo:d.NG_ROUTE_PREFIX}});d.SeRouteService.provideLegacyRoute({path:`${t}sites/:siteId`,route:{redirectTo:`${d.NG_ROUTE_PREFIX}/sites/:siteId`}});d.SeRouteService.provideLegacyRoute({path:o,route:{redirectTo:`${d.NG_ROUTE_PREFIX}${o}`}});s.debugEnabled(false)}]})],gt);const ut="legacyApp";window.__smartedit__.addDecoratorPayload("Component","SmarteditcontainerComponent",{selector:d.SMARTEDITCONTAINER_COMPONENT_NAME,template:`\n        <router-outlet></router-outlet>\n        <div ng-attr-id="${ut}">\n            <se-announcement-board></se-announcement-board>\n            <se-notification-panel></se-notification-panel>\n            <div ng-view></div>\n        </div>\n    `});let ht=class SmarteditcontainerComponent{constructor(e,t,o,n,s){this.translateService=e;this.upgrade=o;this.elementRef=n;this.bootstrapIndicator=s;this.legacyAppName=ut;this.legacyAppName=ut;this.setApplicationTitle();d.registerCustomComponents(t)}ngOnInit(){Array.prototype.slice.call(document.body.childNodes).filter((e=>!this.isAppComponent(e)&&!this.isSmarteditLoader(e))).forEach((e=>{this.legacyAppNode.appendChild(e)}))}ngAfterViewInit(){this.upgrade.bootstrap(this.legacyAppNode,[gt.moduleName],{strictDi:false});this.bootstrapIndicator.setSmarteditContainerReady()}setApplicationTitle(){this.translateService.get("se.application.name").subscribe((e=>{document.title=e}))}get legacyAppNode(){return this.elementRef.nativeElement.querySelector(`div[ng-attr-id="${this.legacyAppName}"]`)}isAppComponent(e){return e.nodeType===Node.ELEMENT_NODE&&e.tagName===d.SMARTEDITCONTAINER_COMPONENT_NAME.toUpperCase()}isSmarteditLoader(e){return e.nodeType===Node.ELEMENT_NODE&&(e.id==="smarteditloader"||e.tagName===d.SMARTEDITLOADER_COMPONENT_NAME.toUpperCase())}};ht=__decorate([n.Component({selector:d.SMARTEDITCONTAINER_COMPONENT_NAME,template:`\n        <router-outlet></router-outlet>\n        <div ng-attr-id="${ut}">\n            <se-announcement-board></se-announcement-board>\n            <se-notification-panel></se-notification-panel>\n            <div ng-view></div>\n        </div>\n    `}),__metadata("design:paramtypes",[v.TranslateService,n.Injector,w.UpgradeModule,n.ElementRef,d.AngularJSBootstrapIndicatorService])],ht);window.__smartedit__.addDecoratorPayload("Component","NotificationComponent",{selector:"se-notification",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<div class="se-notification" id="{{ id }}" *ngIf="notification"><div [seCustomComponentOutlet]="notification.componentName"></div></div>`});let vt=class NotificationComponent{ngOnInit(){this.id=this.notification&&this.notification.id?"se-notification-"+this.notification.id:""}};__decorate([n.Input(),__metadata("design:type",Object)],vt.prototype,"notification",void 0);vt=__decorate([n.Component({selector:"se-notification",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<div class="se-notification" id="{{ id }}" *ngIf="notification"><div [seCustomComponentOutlet]="notification.componentName"></div></div>`})],vt);window.__smartedit__.addDecoratorPayload("Component","NotificationPanelComponent",{selector:"se-notification-panel",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="(notifications$ | async) as notifications"><div class="se-notification-panel" *ngIf="notifications.length > 0" [ngClass]="{'is-mouseover': isMouseOver}" (mouseenter)="onMouseEnter()"><div><se-notification *ngFor="let notification of (notifications | seReverse)" [notification]="notification"></se-notification></div></div></ng-container>`});let _t=class NotificationPanelComponent{constructor(e,t,o,n,s,a,r,d){this.notificationService=e;this.notificationMouseLeaveDetectionService=t;this.systemEventService=o;this.iframeManagerService=n;this.windowUtils=s;this.element=a;this.yjQuery=r;this.cd=d;this.notificationPanelBounds=null;this.iFrameNotificationPanelBounds=null;this.addMouseMoveEventListenerTimeout=null}ngOnInit(){this.notifications$=this.notificationService.getNotifications();this.isMouseOver=false;this.windowUtils.getWindow().addEventListener("resize",(()=>this.onResize()));this.unRegisterNotificationChangedEventHandler=this.systemEventService.subscribe(d.EVENT_NOTIFICATION_CHANGED,(()=>this.onNotificationChanged()))}ngAfterViewInit(){this.$element=this.yjQuery(this.element.nativeElement)}ngOnDestroy(){this.windowUtils.getWindow().removeEventListener("resize",(()=>this.onResize()));this.notificationMouseLeaveDetectionService.stopDetection();this.unRegisterNotificationChangedEventHandler()}onMouseEnter(){this.isMouseOver=true;this.cd.detectChanges();if(!this.hasBounds()){this.calculateBounds()}this.addMouseMoveEventListenerTimeout=this.addMouseMoveEventListenerTimeout||setTimeout((()=>this.addMouseMoveEventListener()),10)}onMouseLeave(){this.isMouseOver=false;this.cd.detectChanges()}getIFrame(){return this.iframeManagerService.getIframe()[0]}getNotificationPanel(){return this.$element.find(".se-notification-panel")}calculateNotificationPanelBounds(){const e=this.getNotificationPanel();const t=e.position();this.notificationPanelBounds={x:Math.floor(t.left),y:Math.floor(t.top),width:Math.floor(e.width()),height:Math.floor(e.height())}}calculateIFrameNotificationPanelBounds(){const e=this.getIFrame();if(e){this.iFrameNotificationPanelBounds={x:this.notificationPanelBounds.x-e.offsetLeft,y:this.notificationPanelBounds.y-e.offsetTop,width:this.notificationPanelBounds.width,height:this.notificationPanelBounds.height}}}calculateBounds(){this.calculateNotificationPanelBounds();this.calculateIFrameNotificationPanelBounds()}invalidateBounds(){this.notificationPanelBounds=null;this.iFrameNotificationPanelBounds=null}hasBounds(){const e=!!this.notificationPanelBounds;const t=this.getIFrame()?!!this.iFrameNotificationPanelBounds:true;return e&&t}cancelDetection(){this.invalidateBounds();this.notificationMouseLeaveDetectionService.stopDetection();if(this.isMouseOver){this.onMouseLeave()}}onResize(){this.cancelDetection()}onNotificationChanged(){if(!this.isMouseOver){this.cancelDetection()}}addMouseMoveEventListener(){this.addMouseMoveEventListenerTimeout=null;this.notificationMouseLeaveDetectionService.startDetection(this.notificationPanelBounds,this.iFrameNotificationPanelBounds,(()=>this.onMouseLeave()))}};_t=__decorate([n.Component({selector:"se-notification-panel",changeDetection:n.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="(notifications$ | async) as notifications"><div class="se-notification-panel" *ngIf="notifications.length > 0" [ngClass]="{'is-mouseover': isMouseOver}" (mouseenter)="onMouseEnter()"><div><se-notification *ngFor="let notification of (notifications | seReverse)" [notification]="notification"></se-notification></div></div></ng-container>`}),__param(0,n.Inject(d.INotificationService)),__param(1,n.Inject(d.INotificationMouseLeaveDetectionService)),__param(6,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[D,k,d.SystemEventService,$,d.WindowUtils,n.ElementRef,Function,n.ChangeDetectorRef])],_t);let ft=class NotificationPanelModule{};ft=__decorate([n.NgModule({imports:[ze,d.SharedComponentsModule,g.CommonModule,d.CustomComponentOutletDirectiveModule],declarations:[_t,vt],exports:[_t]})],ft);const yt="sites-id";window.__smartedit__.addDecoratorPayload("Component","LandingPageComponent",{selector:"se-landing-page",template:`<div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar></div><div class="se-landing-page"><div class="se-landing-page-actions"><div class="se-landing-page-container"><h1 class="se-landing-page-title">{{ 'se.landingpage.title' | translate }}</h1><div class="se-landing-page-site-selection" *ngIf="model"><se-generic-editor-dropdown [field]="field" [qualifier]="qualifier" [model]="model" [id]="sitesId"></se-generic-editor-dropdown></div><p class="se-landing-page-label">{{ 'se.landingpage.label' | translate }}</p></div></div><p class="se-landing-page-container se-landing-page-sub-header">Content Catalogs</p><div class="se-landing-page-container se-landing-page-catalogs"><div class="se-landing-page-catalog" *ngFor="let catalog of catalogs; let isLast = last"><se-catalog-details [catalog]="catalog" [siteId]="model.site" [isCatalogForCurrentSite]="isLast"></se-catalog-details></div></div><img src="static-resources/images/best-run-sap-logo.svg" class="se-landing-page-footer-logo"/></div>`});let St=class LandingPageComponent{constructor(e,t,o,n,s,a,r,d){this.siteService=e;this.catalogService=t;this.systemEventService=o;this.storageService=n;this.alertService=s;this.route=a;this.location=r;this.yjQuery=d;this.sitesId=yt;this.qualifier="site";this.catalogs=[];this.SELECTED_SITE_COOKIE_NAME="seselectedsite"}ngOnInit(){this.route.paramMap.subscribe((e=>{this.getCurrentSiteId(e.get("siteId")).then((e=>{this.setModel(e)}))}));this.siteService.getAccessibleSites().then((e=>{this.field={idAttribute:"uid",labelAttributes:["name"],editable:true,paged:false,options:e}}));this.removeStorefrontCssClass();this.unregisterSitesDropdownEventHandler=this.systemEventService.subscribe(this.sitesId+d.LINKED_DROPDOWN,this.selectedSiteDropdownEventHandler.bind(this))}ngOnDestroy(){var e;(e=this.unregisterSitesDropdownEventHandler)===null||e===void 0?void 0:e.call(this)}getCurrentSiteId(e){return this.storageService.getValueFromLocalStorage(this.SELECTED_SITE_COOKIE_NAME,false).then((t=>this.siteService.getAccessibleSites().then((o=>{const n=o.some((t=>t.uid===e));if(n){this.setSelectedSite(e);this.updateRouteToRemoveSite();return e}else{if(e){this.alertService.showInfo("se.landingpage.site.url.error");this.updateRouteToRemoveSite()}const n=o.some((e=>e.uid===t));if(!n){const e=o.length>0?o[0].uid:null;return e}else{return t}}}))))}updateRouteToRemoveSite(){this.location.replaceState(d.NG_ROUTE_PREFIX)}removeStorefrontCssClass(){const e=this.yjQuery(document.querySelector("body"));if(e.hasClass("is-storefront")){e.removeClass("is-storefront")}if(e.hasClass("is-safari")){e.removeClass("is-safari")}}selectedSiteDropdownEventHandler(e,t){if(t.optionObject){const e=t.optionObject.id;this.setSelectedSite(e);this.loadCatalogsBySite(e);this.setModel(e)}else{this.catalogs=[]}}setSelectedSite(e){this.storageService.setValueInLocalStorage(this.SELECTED_SITE_COOKIE_NAME,e,false)}loadCatalogsBySite(e){this.catalogService.getContentCatalogsForSite(e).then((e=>this.catalogs=e))}setModel(e){if(this.model){this.model[this.qualifier]=e}else{this.model={[this.qualifier]:e}}}};St.$inject=["siteService","catalogService","systemEventService","storageService","alertService","route","location","yjQuery"];St=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-landing-page",template:`<div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar></div><div class="se-landing-page"><div class="se-landing-page-actions"><div class="se-landing-page-container"><h1 class="se-landing-page-title">{{ 'se.landingpage.title' | translate }}</h1><div class="se-landing-page-site-selection" *ngIf="model"><se-generic-editor-dropdown [field]="field" [qualifier]="qualifier" [model]="model" [id]="sitesId"></se-generic-editor-dropdown></div><p class="se-landing-page-label">{{ 'se.landingpage.label' | translate }}</p></div></div><p class="se-landing-page-container se-landing-page-sub-header">Content Catalogs</p><div class="se-landing-page-container se-landing-page-catalogs"><div class="se-landing-page-catalog" *ngFor="let catalog of catalogs; let isLast = last"><se-catalog-details [catalog]="catalog" [siteId]="model.site" [isCatalogForCurrentSite]="isLast"></se-catalog-details></div></div><img src="static-resources/images/best-run-sap-logo.svg" class="se-landing-page-footer-logo"/></div>`}),__param(7,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[Y,d.ICatalogService,d.SystemEventService,d.IStorageService,d.IAlertService,u.ActivatedRoute,g.Location,Function])],St);window.__smartedit__.addDecoratorPayload("Component","StorefrontPageComponent",{selector:"se-storefront-page",template:`<div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--experience" imageRoot="imageRoot" toolbarName="smartEditExperienceToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--perspective" imageRoot="imageRoot" toolbarName="smartEditPerspectiveToolbar"></se-toolbar></div><div id="js_iFrameWrapper" class="iframeWrapper"><div class="wrap"><div *ngIf="showPageTreeList()" class="page-tree__list"><se-page-tree-container></se-page-tree-container></div><div class="iframe-panel"><iframe id="ySmartEditFrame" src=""></iframe><div id="ySmartEditFrameDragArea"></div></div></div></div>`,styles:[`.wrap{display:flex;justify-content:flex-start;flex-wrap:nowrap;height:100%}.page-tree__list{width:20%;height:100%;padding:16px 8px 16px 8px;min-width:20%}.iframe-panel{width:100%;height:100%}`]});let Ct=class StorefrontPageComponent{constructor(e,t,o,n,s,a,r){this.browserService=e;this.iframeManagerService=t;this.experienceService=o;this.yjQuery=n;this.crossFrameEventService=s;this.storageService=a;this.permissionService=r;this.PAGE_TREE_PANEL_OPEN_COOKIE_NAME="smartedit-page-tree-panel-open";this.isPageTreePanelOpen=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.iframeManagerService.applyDefault();yield this.experienceService.initializeExperience();this.yjQuery(document.body).addClass("is-storefront");if(this.browserService.isSafari()){this.yjQuery(document.body).addClass("is-safari")}const e=yield this.storageService.getValueFromLocalStorage(this.PAGE_TREE_PANEL_OPEN_COOKIE_NAME,true);const t=yield this.permissionService.isPermitted([{names:["se.read.page"]}]);this.isPageTreePanelOpen=e&&t;this.crossFrameEventService.subscribe(d.EVENT_PAGE_TREE_PANEL_SWITCH,(()=>{this.isPageTreePanelOpen=!this.isPageTreePanelOpen;this.updateStorage()}));this.crossFrameEventService.subscribe(d.EVENT_OPEN_IN_PAGE_TREE,(()=>{if(!this.isPageTreePanelOpen){this.isPageTreePanelOpen=true;this.updateStorage()}}));this.crossFrameEventService.subscribe(d.EVENT_PERSPECTIVE_UNLOADING,(()=>{this.isPageTreePanelOpen=false;this.updateStorage()}))}))}showPageTreeList(){return this.isPageTreePanelOpen}updateStorage(){this.storageService.setValueInLocalStorage(this.PAGE_TREE_PANEL_OPEN_COOKIE_NAME,this.isPageTreePanelOpen,true)}};Ct.$inject=["browserService","iframeManagerService","experienceService","yjQuery","crossFrameEventService","storageService","permissionService"];Ct=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-storefront-page",template:`<div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--experience" imageRoot="imageRoot" toolbarName="smartEditExperienceToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--perspective" imageRoot="imageRoot" toolbarName="smartEditPerspectiveToolbar"></se-toolbar></div><div id="js_iFrameWrapper" class="iframeWrapper"><div class="wrap"><div *ngIf="showPageTreeList()" class="page-tree__list"><se-page-tree-container></se-page-tree-container></div><div class="iframe-panel"><iframe id="ySmartEditFrame" src=""></iframe><div id="ySmartEditFrameDragArea"></div></div></div></div>`,styles:[`.wrap{display:flex;justify-content:flex-start;flex-wrap:nowrap;height:100%}.page-tree__list{width:20%;height:100%;padding:16px 8px 16px 8px;min-width:20%}.iframe-panel{width:100%;height:100%}`]}),__param(3,n.Inject(d.YJQUERY_TOKEN)),__metadata("design:paramtypes",[d.BrowserService,$,d.IExperienceService,Function,d.CrossFrameEventService,d.IStorageService,d.IPermissionService])],Ct);window.__smartedit__.addDecoratorPayload("Component","PageTreeContainerComponent",{selector:"se-page-tree-container",template:`<div *ngIf="component" class="page-tree-container"><ng-container *ngComponentOutlet="component"></ng-container></div>`,styles:[`.page-tree-container{height:100%}`]});let bt=class PageTreeContainerComponent{constructor(e){this.pageTreeService=e}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageTreeService.getTreeComponent();this.component=e.component}))}};bt.$inject=["pageTreeService"];bt=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-page-tree-container",template:`<div *ngIf="component" class="page-tree-container"><ng-container *ngComponentOutlet="component"></ng-container></div>`,styles:[`.page-tree-container{height:100%}`]}),__metadata("design:paramtypes",[d.IPageTreeService])],bt);const It="MULTI_PRODUCT_CATALOGS_UPDATED";window.__smartedit__.addDecoratorPayload("Component","MultiProductCatalogVersionConfigurationComponent",{selector:"se-multi-product-catalog-version-configuration",changeDetection:n.ChangeDetectionStrategy.OnPush,host:{"[class.se-multi-product-catalog-version-configuration]":"true"},template:`<div class="form-group se-multi-product-catalog-version-selector__label">{{'se.product.catalogs.multiple.list.header' | translate}}</div><div class="se-multi-product-catalog-version-selector__catalog form-group" *ngFor="let productCatalog of productCatalogs"><label class="se-control-label se-multi-product-catalog-version-selector__catalog-name" id="{{ productCatalog.catalogId }}-label">{{ productCatalog.name | seL10n | async }}</label><div class="se-multi-product-catalog-version-selector__catalog-version"><se-select [id]="productCatalog.catalogId" [(model)]="productCatalog.selectedItem" [onChange]="updateModel()" [fetchStrategy]="productCatalog.fetchStrategy"></se-select></div></div>`});let wt=class MultiProductCatalogVersionConfigurationComponent{constructor(e,t){this.modalManager=e;this.systemEventService=t;this.doneButtonId="done"}ngOnInit(){this.modalManager.getModalData().pipe(m.take(1)).subscribe((e=>{this.selectedCatalogVersions=e.selectedCatalogVersions;this.productCatalogs=e.productCatalogs.map((e=>{const t=e.versions.map((e=>Object.assign(Object.assign({},e),{id:e.uuid,label:e.version})));return Object.assign(Object.assign({},e),{versions:t,fetchStrategy:{fetchAll:()=>Promise.resolve(t)},selectedItem:e.versions.find((e=>this.selectedCatalogVersions.includes(e.uuid))).uuid})}))}));this.modalManager.setDismissCallback((()=>this.onCancel()));this.modalManager.addButtons([{id:this.doneButtonId,label:"se.confirmation.modal.done",style:d.ModalButtonStyle.Primary,action:d.ModalButtonAction.None,disabled:true,callback:()=>p.from(this.onSave())},{id:"cancel",label:"se.confirmation.modal.cancel",style:d.ModalButtonStyle.Default,action:d.ModalButtonAction.Dismiss,callback:()=>p.from(this.onCancel())}])}updateModel(){return()=>{const e=this.productCatalogs.map((e=>e.selectedItem));this.updateSelection(e)}}updateSelection(e){if(!r.isEqual(e,this.selectedCatalogVersions)){this.updatedCatalogVersions=e;this.modalManager.enableButton(this.doneButtonId)}else{this.modalManager.disableButton(this.doneButtonId)}}onCancel(){this.modalManager.close(null);return Promise.resolve()}onSave(){this.systemEventService.publishAsync(It,this.updatedCatalogVersions);this.modalManager.close(null);return Promise.resolve()}};wt=__decorate([n.Component({selector:"se-multi-product-catalog-version-configuration",changeDetection:n.ChangeDetectionStrategy.OnPush,host:{"[class.se-multi-product-catalog-version-configuration]":"true"},template:`<div class="form-group se-multi-product-catalog-version-selector__label">{{'se.product.catalogs.multiple.list.header' | translate}}</div><div class="se-multi-product-catalog-version-selector__catalog form-group" *ngFor="let productCatalog of productCatalogs"><label class="se-control-label se-multi-product-catalog-version-selector__catalog-name" id="{{ productCatalog.catalogId }}-label">{{ productCatalog.name | seL10n | async }}</label><div class="se-multi-product-catalog-version-selector__catalog-version"><se-select [id]="productCatalog.catalogId" [(model)]="productCatalog.selectedItem" [onChange]="updateModel()" [fetchStrategy]="productCatalog.fetchStrategy"></se-select></div></div>`}),__metadata("design:paramtypes",[d.ModalManagerService,d.SystemEventService])],wt);window.__smartedit__.addDecoratorPayload("Component","MultiProductCatalogVersionSelectorComponent",{selector:"se-multi-product-catalog-version-selector",providers:[d.L10nPipe],changeDetection:n.ChangeDetectionStrategy.OnPush,host:{"[class.se-multi-product-catalog-version-selector]":"true"},template:`<se-tooltip [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" class="se-products-catalog-select-multiple__tooltip"><div id="multi-product-catalog-versions-selector" se-tooltip-trigger (click)="onClickSelector()" class="se-products-catalog-select-multiple"><input type="text" [value]="multiProductCatalogVersionsSelectedOptions$ | async" class="form-control se-products-catalog-select-multiple__catalogs se-nowrap-ellipsis" [name]="'productCatalogVersions'" readonly="readonly"/> <span class="hyicon hyicon-optionssm se-products-catalog-select-multiple__icon"></span></div><div class="se-product-catalogs-tooltip" se-tooltip-body><div class="se-product-catalogs-tooltip__h">{{ ('se.product.catalogs.selector.headline.tooltip' || '') | translate }}</div><div class="se-product-catalog-info" *ngFor="let productCatalog of productCatalogs">{{ getCatalogNameCatalogVersionLabel(productCatalog.catalogId) | async }}</div></div></se-tooltip>`});let Et=class MultiProductCatalogVersionSelectorComponent{constructor(e,t,o){this.l10nPipe=e;this.modalService=t;this.systemEventService=o;this.selectedProductCatalogVersionsChange=new n.EventEmitter;this.multiProductCatalogVersionsSelectedOptions$=new p.BehaviorSubject("")}ngOnInit(){this.$unRegEventForMultiProducts=this.systemEventService.subscribe(It,((e,t)=>this.updateProductCatalogVersionsModel(e,t)))}ngOnDestroy(){if(this.$unRegEventForMultiProducts){this.$unRegEventForMultiProducts()}}ngOnChanges(){this.setMultiVersionSelectorTexts(this.productCatalogs)}onClickSelector(){this.modalService.open({component:wt,data:{productCatalogs:this.productCatalogs,selectedCatalogVersions:this.selectedProductCatalogVersions},templateConfig:{title:"se.modal.product.catalog.configuration"},config:{modalPanelClass:"modal-md modal-stretched"}})}getCatalogNameCatalogVersionLabel(e){const t=this.catalogNameCatalogVersionLabelMap.get(e);return this.l10nPipe.transform(t.name).pipe(m.map((e=>`${e} (${t.version})`)))}setMultiVersionSelectorTexts(e){this.catalogNameCatalogVersionLabelMap=this.buildCatalogNameCatalogVersionLabelMap(e,this.selectedProductCatalogVersions);this.setMultiProductCatalogVersionsSelectedOptions(e)}buildCatalogNameCatalogVersionLabelMap(e,t){const o=new Map;e.forEach((e=>{const n=e.versions.find((e=>t&&t.includes(e.uuid)));if(n){o.set(e.catalogId,{name:e.name,version:n.version})}}));return o}setMultiProductCatalogVersionsSelectedOptions(e){if(e){const e=Array.from(this.catalogNameCatalogVersionLabelMap).map((e=>this.getCatalogNameCatalogVersionLabel(e[0])));p.combineLatest(e).pipe(m.take(1),m.map((e=>e.join(", ")))).subscribe((e=>this.multiProductCatalogVersionsSelectedOptions$.next(e)))}else{this.multiProductCatalogVersionsSelectedOptions$.next("")}}updateProductCatalogVersionsModel(e,t){this.selectedProductCatalogVersionsChange.emit(t)}};__decorate([n.Input(),__metadata("design:type",Array)],Et.prototype,"productCatalogs",void 0);__decorate([n.Input(),__metadata("design:type",Array)],Et.prototype,"selectedProductCatalogVersions",void 0);__decorate([n.Output(),__metadata("design:type",Object)],Et.prototype,"selectedProductCatalogVersionsChange",void 0);Et=__decorate([n.Component({selector:"se-multi-product-catalog-version-selector",providers:[d.L10nPipe],changeDetection:n.ChangeDetectionStrategy.OnPush,host:{"[class.se-multi-product-catalog-version-selector]":"true"},template:`<se-tooltip [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" class="se-products-catalog-select-multiple__tooltip"><div id="multi-product-catalog-versions-selector" se-tooltip-trigger (click)="onClickSelector()" class="se-products-catalog-select-multiple"><input type="text" [value]="multiProductCatalogVersionsSelectedOptions$ | async" class="form-control se-products-catalog-select-multiple__catalogs se-nowrap-ellipsis" [name]="'productCatalogVersions'" readonly="readonly"/> <span class="hyicon hyicon-optionssm se-products-catalog-select-multiple__icon"></span></div><div class="se-product-catalogs-tooltip" se-tooltip-body><div class="se-product-catalogs-tooltip__h">{{ ('se.product.catalogs.selector.headline.tooltip' || '') | translate }}</div><div class="se-product-catalog-info" *ngFor="let productCatalog of productCatalogs">{{ getCatalogNameCatalogVersionLabel(productCatalog.catalogId) | async }}</div></div></se-tooltip>`}),__metadata("design:paramtypes",[d.L10nPipe,d.IModalService,d.SystemEventService])],Et);window.__smartedit__.addDecoratorPayload("Component","ProductCatalogVersionsSelectorComponent",{selector:"se-product-catalog-versions-selector",changeDetection:n.ChangeDetectionStrategy.OnPush,host:{"[class.se-product-catalog-versions-selector]":"true"},template:`<ng-container *ngIf="isReady"><se-select *ngIf="isSingleVersionSelector" [id]="geData.qualifier" [(model)]="geData.model.productCatalogVersions[0]" [(reset)]="reset" [fetchStrategy]="fetchStrategy"></se-select><se-multi-product-catalog-version-selector *ngIf="isMultiVersionSelector" [productCatalogs]="productCatalogs" [(selectedProductCatalogVersions)]="geData.model[geData.qualifier]"></se-multi-product-catalog-version-selector></ng-container>`});let Tt=class ProductCatalogVersionsSelectorComponent{constructor(e,t,o,n){this.geData=e;this.catalogService=t;this.systemEventService=o;this.cdr=n}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.contentCatalogVersionId=r.cloneDeep(this.geData.model.previewCatalog);if(this.contentCatalogVersionId){this.isReady=false;this.isSingleVersionSelector=false;this.isMultiVersionSelector=false;const e=(this.geData.id||"")+d.LINKED_DROPDOWN;this.$unRegSiteChangeEvent=this.systemEventService.subscribe(e,((e,t)=>this.resetSelector(e,t)));yield this.setContent()}return Promise.resolve()}))}ngOnDestroy(){if(this.$unRegSiteChangeEvent){this.$unRegSiteChangeEvent()}}resetSelector(e,t){return __awaiter(this,void 0,void 0,(function*(){if(t.qualifier==="previewCatalog"&&t.optionObject&&this.contentCatalogVersionId!==t.optionObject.id){this.contentCatalogVersionId=t.optionObject.id;const e=this.getSiteUIDFromContentCatalogVersionId(this.contentCatalogVersionId);const o=yield this.catalogService.getProductCatalogsForSite(e);const n=yield Promise.resolve(this.catalogService.returnActiveCatalogVersionUIDs(o));this.geData.model[this.geData.qualifier]=n;if(this.isSingleVersionSelector){this.reset()}this.setContent()}}))}setContent(){return __awaiter(this,void 0,void 0,(function*(){const setContent=()=>__awaiter(this,void 0,void 0,(function*(){this.productCatalogs=yield this.catalogService.getProductCatalogsForSite(this.getSiteUIDFromContentCatalogVersionId(this.contentCatalogVersionId));if(this.productCatalogs.length===0){return}if(this.productCatalogs.length===1){this.fetchStrategy={fetchAll:()=>{const e=this.parseSingleCatalogVersion(this.productCatalogs[0].versions);return Promise.resolve(e)}};this.isSingleVersionSelector=true;this.isMultiVersionSelector=false;this.isReady=true;return}this.isSingleVersionSelector=false;this.isMultiVersionSelector=true;this.isReady=true}));yield setContent();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getSiteUIDFromContentCatalogVersionId(e){return e.split("|")[0]}parseSingleCatalogVersion(e){return e.map((e=>({id:e.uuid,label:e.version})))}};Tt=__decorate([n.Component({selector:"se-product-catalog-versions-selector",changeDetection:n.ChangeDetectionStrategy.OnPush,host:{"[class.se-product-catalog-versions-selector]":"true"},template:`<ng-container *ngIf="isReady"><se-select *ngIf="isSingleVersionSelector" [id]="geData.qualifier" [(model)]="geData.model.productCatalogVersions[0]" [(reset)]="reset" [fetchStrategy]="fetchStrategy"></se-select><se-multi-product-catalog-version-selector *ngIf="isMultiVersionSelector" [productCatalogs]="productCatalogs" [(selectedProductCatalogVersions)]="geData.model[geData.qualifier]"></se-multi-product-catalog-version-selector></ng-container>`}),__param(0,n.Inject(d.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,d.ICatalogService,d.SystemEventService,n.ChangeDetectorRef])],Tt);let Pt=class ProductCatalogVersionModule{};Pt=__decorate([n.NgModule({imports:[g.CommonModule,S.FormsModule,d.L10nPipeModule,d.TranslationModule.forChild(),d.SelectModule,d.TooltipModule],declarations:[Tt,wt,Et],entryComponents:[Tt,wt,Et],providers:[d.moduleUtils.initialize((e=>{e.addFieldMapping("ProductCatalogVersionsSelector",null,null,{component:Tt})}),[d.EditorFieldMappingService])]})],Pt);window.__smartedit__.addDecoratorPayload("Component","SitesLinkComponent",{selector:"sites-link",template:`<div (click)="goToSites()" class="se-sites-link {{cssClass}}"><a class="se-sites-link__text">{{'se.toolbar.sites' | translate}}</a> <span class="icon-navigation-right-arrow se-sites-link__arrow {{iconCssClass}}"></span></div>`});let At=class SitesLinkComponent{constructor(e,t,o){this.routingService=e;this.iframeManagerService=t;this.userTrackingService=o;this.iconCssClass="sap-icon--navigation-right-arrow"}goToSites(){this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.NAVIGATION,"Sites");this.iframeManagerService.setCurrentLocation(null);this.routingService.go(d.NG_ROUTE_PREFIX)}};__decorate([n.Input(),__metadata("design:type",String)],At.prototype,"cssClass",void 0);__decorate([n.Input(),__metadata("design:type",Object)],At.prototype,"iconCssClass",void 0);__decorate([n.Input(),__metadata("design:type",Object)],At.prototype,"shortcutLink",void 0);At=__decorate([n.Component({selector:"sites-link",template:`<div (click)="goToSites()" class="se-sites-link {{cssClass}}"><a class="se-sites-link__text">{{'se.toolbar.sites' | translate}}</a> <span class="icon-navigation-right-arrow se-sites-link__arrow {{iconCssClass}}"></span></div>`}),__metadata("design:paramtypes",[d.SmarteditRoutingService,$,d.UserTrackingService])],At);window.__smartedit__.addDecoratorPayload("Component","PerspectiveSelectorComponent",{selector:"se-perspective-selector",template:`<fd-popover [(isOpen)]="isOpen" [closeOnOutsideClick]="false" [triggers]="['click']" *ngIf="hasActivePerspective()" class="se-perspective-selector" [placement]="'bottom-end'" [disabled]="isDisabled" [options]="popperOptions"><fd-popover-control><div class="se-perspective-selector__trigger"><se-tooltip [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']" *ngIf="isTooltipVisible()"><span se-tooltip-trigger id="perspectiveTooltip" class="hyicon hyicon-info se-perspective-selector__hotkey-tooltip--icon"></span><div se-tooltip-body>{{ activePerspective.descriptionI18nKey | translate }}</div></se-tooltip><button class="se-perspective-selector__btn" [disabled]="isDisabled">{{getActivePerspectiveName() | translate}} <span class="se-perspective-selector__btn-arrow icon-navigation-down-arrow"></span></button></div></fd-popover-control><fd-popover-body><ul class="se-perspective__list fd-list-group" [ngClass]="{'se-perspective__list--tooltip': isTooltipVisible()}" role="menu"><li *ngFor="let choice of getDisplayedPerspectives()" class="fd-list-group__item se-perspective__list-item fd-has-padding-none"><a class="item se-perspective__list-item-text" (click)="selectPerspective($event, choice.key);">{{choice.nameI18nKey | translate}}</a></li></ul></fd-popover-body></fd-popover>`});let Ot=class PerspectiveSelectorComponent{constructor(e,t,o,n,s,a,r,d){this.logService=e;this.yjQuery=t;this.perspectiveService=o;this.iframeClickDetectionService=n;this.systemEventService=s;this.crossFrameEventService=a;this.testModeService=r;this.userTrackingService=d;this.isOpen=false;this.popperOptions={placement:"bottom-start",modifiers:{preventOverflow:{enabled:true,escapeWithReference:true,boundariesElement:"viewport"},applyStyle:{gpuAcceleration:false}}};this.isDisabled=false;this.perspectives=[];this.displayedPerspectives=[];this.activePerspective=null}onDocumentClick(e){this.onClickHandler(e)}ngOnInit(){this.activePerspective=null;this.iframeClickDetectionService.registerCallback("perspectiveSelectorClose",(()=>this.closeDropdown()));this.unRegOverlayDisabledFn=this.systemEventService.subscribe("OVERLAY_DISABLED",(()=>this.closeDropdown()));this.unRegPerspectiveAddedFn=this.systemEventService.subscribe(d.EVENT_PERSPECTIVE_ADDED,(()=>this.onPerspectiveAdded()));this.unRegPerspectiveChgFn=this.crossFrameEventService.subscribe(d.EVENT_PERSPECTIVE_CHANGED,(()=>this.refreshPerspectives()));this.unRegPerspectiveRefreshFn=this.crossFrameEventService.subscribe(d.EVENT_PERSPECTIVE_REFRESHED,(()=>this.refreshPerspectives()));this.unRegUserHasChanged=this.crossFrameEventService.subscribe(d.EVENTS.USER_HAS_CHANGED,(()=>this.onPerspectiveAdded()));this.unRegStrictPreviewModeToggleFn=this.crossFrameEventService.subscribe(d.EVENT_STRICT_PREVIEW_MODE_REQUESTED,((e,t)=>this.togglePerspectiveSelector(t)));this.onPerspectiveAdded()}ngOnDestroy(){this.unRegOverlayDisabledFn();this.unRegPerspectiveAddedFn();this.unRegPerspectiveChgFn();this.unRegPerspectiveRefreshFn();this.unRegUserHasChanged();this.unRegStrictPreviewModeToggleFn()}selectPerspective(e,t){e.preventDefault();this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.SELECT_PERSPECTIVE,t);try{this.perspectiveService.switchTo(t);this.closeDropdown()}catch(e){this.logService.error("selectPerspective() - Cannot select perspective.",e)}}getDisplayedPerspectives(){return this.displayedPerspectives}getActivePerspectiveName(){return this.activePerspective?this.activePerspective.nameI18nKey:""}hasActivePerspective(){return this.activePerspective!==null}isTooltipVisible(){return!!this.activePerspective&&!!this.activePerspective.descriptionI18nKey&&this.checkTooltipVisibilityCondition()}checkTooltipVisibilityCondition(){if(this.activePerspective.key!==d.NONE_PERSPECTIVE||this.activePerspective.key===d.NONE_PERSPECTIVE&&this.isDisabled){return true}return false}filterPerspectives(e){return e.filter((e=>{const t=this.activePerspective&&e.key===this.activePerspective.key;const o=e.key===d.ALL_PERSPECTIVE;return!t&&(!o||this.testModeService.isE2EMode())}))}closeDropdown(){this.isOpen=false}onPerspectiveAdded(){this.perspectiveService.getPerspectives().then((e=>{this.perspectives=e;this.displayedPerspectives=this.filterPerspectives(this.perspectives)}))}refreshPerspectives(){this.perspectiveService.getPerspectives().then((e=>{this.perspectives=e;this._refreshActivePerspective();this.displayedPerspectives=this.filterPerspectives(this.perspectives)}))}_refreshActivePerspective(){this.activePerspective=this.perspectiveService.getActivePerspective()}onClickHandler(e){if(this.yjQuery(e.target).parents(".se-perspective-selector").length<=0&&this.isOpen){this.closeDropdown()}}togglePerspectiveSelector(e){this.isDisabled=e}};Ot.$inject=["logService","yjQuery","perspectiveService","iframeClickDetectionService","systemEventService","crossFrameEventService","testModeService","userTrackingService"];__decorate([n.Input(),__metadata("design:type",Object)],Ot.prototype,"isOpen",void 0);__decorate([n.HostListener("document:click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Event]),__metadata("design:returntype",void 0)],Ot.prototype,"onDocumentClick",null);Ot=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-perspective-selector",template:`<fd-popover [(isOpen)]="isOpen" [closeOnOutsideClick]="false" [triggers]="['click']" *ngIf="hasActivePerspective()" class="se-perspective-selector" [placement]="'bottom-end'" [disabled]="isDisabled" [options]="popperOptions"><fd-popover-control><div class="se-perspective-selector__trigger"><se-tooltip [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']" *ngIf="isTooltipVisible()"><span se-tooltip-trigger id="perspectiveTooltip" class="hyicon hyicon-info se-perspective-selector__hotkey-tooltip--icon"></span><div se-tooltip-body>{{ activePerspective.descriptionI18nKey | translate }}</div></se-tooltip><button class="se-perspective-selector__btn" [disabled]="isDisabled">{{getActivePerspectiveName() | translate}} <span class="se-perspective-selector__btn-arrow icon-navigation-down-arrow"></span></button></div></fd-popover-control><fd-popover-body><ul class="se-perspective__list fd-list-group" [ngClass]="{'se-perspective__list--tooltip': isTooltipVisible()}" role="menu"><li *ngFor="let choice of getDisplayedPerspectives()" class="fd-list-group__item se-perspective__list-item fd-has-padding-none"><a class="item se-perspective__list-item-text" (click)="selectPerspective($event, choice.key);">{{choice.nameI18nKey | translate}}</a></li></ul></fd-popover-body></fd-popover>`}),__param(1,n.Inject(d.YJQUERY_TOKEN)),__param(5,n.Inject(d.EVENT_SERVICE)),__metadata("design:paramtypes",[d.LogService,Function,d.IPerspectiveService,d.IIframeClickDetectionService,d.SystemEventService,d.CrossFrameEventService,d.TestModeService,d.UserTrackingService])],Ot);window.__smartedit__.addDecoratorPayload("Component","CatalogHierarchyModalComponent",{selector:"se-catalog-hierarchy-modal",template:`<div class="se-catalog-hierarchy-header"><span>{{ 'se.catalog.hierarchy.modal.tree.header' | translate }}</span></div><div *ngIf="this.catalogs$ | async as catalogs" class="se-catalog-hierarchy-body"><se-catalog-hierarchy-node *ngFor="let catalog of catalogs; let i = index" [catalog]="catalog" [index]="i" [isLast]="i === catalogs.length - 1" [siteId]="siteId" (siteSelect)="onSiteSelected()"></se-catalog-hierarchy-node></div>`});let xt=class CatalogHierarchyModalComponent{constructor(e){this.modalService=e}ngOnInit(){this.catalogs$=this.modalService.getModalData().pipe(m.take(1)).toPromise().then((({catalog:e})=>[...e.parents,e]))}onSiteSelected(){this.modalService.close()}};xt=__decorate([n.Component({selector:"se-catalog-hierarchy-modal",template:`<div class="se-catalog-hierarchy-header"><span>{{ 'se.catalog.hierarchy.modal.tree.header' | translate }}</span></div><div *ngIf="this.catalogs$ | async as catalogs" class="se-catalog-hierarchy-body"><se-catalog-hierarchy-node *ngFor="let catalog of catalogs; let i = index" [catalog]="catalog" [index]="i" [isLast]="i === catalogs.length - 1" [siteId]="siteId" (siteSelect)="onSiteSelected()"></se-catalog-hierarchy-node></div>`}),__metadata("design:paramtypes",[d.ModalManagerService])],xt);window.__smartedit__.addDecoratorPayload("Component","CatalogDetailsComponent",{selector:"se-catalog-details",template:`<div class="se-catalog-details" [attr.data-catalog]="catalog.name | seL10n | async"><div class="se-catalog-header"><div class="se-catalog-header-flex"><div class="se-catalog-details__header">{{ catalog.name | seL10n | async }}</div><div *ngIf="catalog.parents?.length"><a href="javascript:void(0)" (click)="onOpenCatalogHierarchy()">{{ 'se.landingpage.catalog.hierarchy' | translate }}</a></div></div></div><div class="se-catalog-details__content"><se-catalog-version-details *ngFor="let catalogVersion of sortedCatalogVersions" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion" [siteId]="siteId"></se-catalog-version-details></div></div>`});let Dt=class CatalogDetailsComponent{constructor(e){this.modalService=e;this.catalogDividerImage="static-resources/images/icon_catalog_arrow.png"}ngOnInit(){this.activeCatalogVersion=this.catalog.versions.find((e=>e.active));this.sortedCatalogVersions=this.getSortedCatalogVersions();this.collapsibleConfiguration={expandedByDefault:this.isCatalogForCurrentSite}}onOpenCatalogHierarchy(){this.modalService.open({component:xt,data:{catalog:this.catalog},templateConfig:{title:"se.catalog.hierarchy.modal.title",isDismissButtonVisible:true}})}getSortedCatalogVersions(){return[this.activeCatalogVersion,...this.catalog.versions.filter((e=>!e.active))]}};Dt.$inject=["modalService"];__decorate([n.Input(),__metadata("design:type",Object)],Dt.prototype,"catalog",void 0);__decorate([n.Input(),__metadata("design:type",Boolean)],Dt.prototype,"isCatalogForCurrentSite",void 0);__decorate([n.Input(),__metadata("design:type",String)],Dt.prototype,"siteId",void 0);Dt=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-catalog-details",template:`<div class="se-catalog-details" [attr.data-catalog]="catalog.name | seL10n | async"><div class="se-catalog-header"><div class="se-catalog-header-flex"><div class="se-catalog-details__header">{{ catalog.name | seL10n | async }}</div><div *ngIf="catalog.parents?.length"><a href="javascript:void(0)" (click)="onOpenCatalogHierarchy()">{{ 'se.landingpage.catalog.hierarchy' | translate }}</a></div></div></div><div class="se-catalog-details__content"><se-catalog-version-details *ngFor="let catalogVersion of sortedCatalogVersions" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion" [siteId]="siteId"></se-catalog-version-details></div></div>`}),__metadata("design:paramtypes",[d.ModalService])],Dt);let Rt=class CatalogNavigateToSite{constructor(e){this.systemEvent=e}navigate(e){this.systemEvent.publishAsync(yt+d.LINKED_DROPDOWN,{qualifier:"site",optionObject:{contentCatalogs:[],uid:e,id:e,label:{},name:{},previewUrl:""}})}};Rt.$inject=["systemEvent"];Rt=__decorate([n.Injectable(),__metadata("design:paramtypes",[d.SystemEventService])],Rt);window.__smartedit__.addDecoratorPayload("Component","CatalogHierarchyNodeMenuItemComponent",{changeDetection:n.ChangeDetectionStrategy.OnPush,selector:"se-catalog-hierarchy-node-menu-item",template:`\n        <a class="se-dropdown-item fd-menu__item" (click)="onSiteSelect()">\n            {{ name | seL10n | async }}\n        </a>\n    `});let kt=class CatalogHierarchyNodeMenuItemComponent{constructor(e,t){this.activateSite=e;const{name:o,uid:n}=t.dropdownItem;this.name=o;this.uid=n}onSiteSelect(){this.activateSite.navigate(this.uid)}};kt=__decorate([n.Component({changeDetection:n.ChangeDetectionStrategy.OnPush,selector:"se-catalog-hierarchy-node-menu-item",template:`\n        <a class="se-dropdown-item fd-menu__item" (click)="onSiteSelect()">\n            {{ name | seL10n | async }}\n        </a>\n    `}),__param(1,n.Inject(d.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Rt,Object])],kt);const Mt="se-cth-node-anchor";window.__smartedit__.addDecoratorPayload("Component","CatalogHierarchyNodeComponent",{changeDetection:n.ChangeDetectionStrategy.OnPush,selector:"se-catalog-hierarchy-node",template:`<div class="se-cth-node-name" [style.padding-left.px]="15 * index" [style.padding-right.px]="15 * index" [class.se-cth-node-name__last]="isLast"><fd-icon glyph="navigation-down-arrow"></fd-icon>{{ (isLast ? catalog.name : catalog.catalogName) | seL10n | async }}&nbsp; <span *ngIf="isLast">({{ 'se.catalog.hierarchy.modal.tree.this.catalog' | translate}})</span></div><div class="se-cth-node-sites"><ng-container><ng-container *ngIf="hasOneSite; else hasManySites"><a class="se-cth-node-anchor" href="" (click)="onNavigateToSite(catalog.sites[0].uid)">{{ catalog.sites[0].name | seL10n | async }}<fd-icon glyph="navigation-right-arrow"></fd-icon></a></ng-container><ng-template #hasManySites><se-dropdown-menu [dropdownItems]="dropdownItems" useProjectedAnchor="1" (click)="onSiteSelect($event)"><span class="se-cth-node-anchor">{{ this.catalog.sites.length }} Sites<fd-icon glyph="navigation-down-arrow"></fd-icon></span></se-dropdown-menu></ng-template></ng-container></div>`});let Nt=class CatalogHierarchyNodeComponent{constructor(e){this.navigateToSite=e;this.siteSelect=new n.EventEmitter}ngOnChanges(){this.dropdownItems=this.getDropdownItems()}onNavigateToSite(e){this.navigateToSite.navigate(e);this.siteSelect.emit()}onSiteSelect(e){const t=e.target;if(!t.classList.contains(Mt)&&!t.closest(`.${Mt}`)){this.siteSelect.emit()}}get hasOneSite(){return this.catalog.sites.length===1}getDropdownItems(){return this.catalog.sites.map((e=>Object.assign(Object.assign({},e),{component:kt})))}};__decorate([n.Input(),__metadata("design:type",Number)],Nt.prototype,"index",void 0);__decorate([n.Input(),__metadata("design:type",Object)],Nt.prototype,"catalog",void 0);__decorate([n.Input(),__metadata("design:type",String)],Nt.prototype,"siteId",void 0);__decorate([n.Input(),__metadata("design:type",Boolean)],Nt.prototype,"isLast",void 0);__decorate([n.Output(),__metadata("design:type",Object)],Nt.prototype,"siteSelect",void 0);Nt=__decorate([n.Component({changeDetection:n.ChangeDetectionStrategy.OnPush,selector:"se-catalog-hierarchy-node",template:`<div class="se-cth-node-name" [style.padding-left.px]="15 * index" [style.padding-right.px]="15 * index" [class.se-cth-node-name__last]="isLast"><fd-icon glyph="navigation-down-arrow"></fd-icon>{{ (isLast ? catalog.name : catalog.catalogName) | seL10n | async }}&nbsp; <span *ngIf="isLast">({{ 'se.catalog.hierarchy.modal.tree.this.catalog' | translate}})</span></div><div class="se-cth-node-sites"><ng-container><ng-container *ngIf="hasOneSite; else hasManySites"><a class="se-cth-node-anchor" href="" (click)="onNavigateToSite(catalog.sites[0].uid)">{{ catalog.sites[0].name | seL10n | async }}<fd-icon glyph="navigation-right-arrow"></fd-icon></a></ng-container><ng-template #hasManySites><se-dropdown-menu [dropdownItems]="dropdownItems" useProjectedAnchor="1" (click)="onSiteSelect($event)"><span class="se-cth-node-anchor">{{ this.catalog.sites.length }} Sites<fd-icon glyph="navigation-down-arrow"></fd-icon></span></se-dropdown-menu></ng-template></ng-container></div>`}),__metadata("design:paramtypes",[Rt])],Nt);window.__smartedit__.addDecoratorPayload("Component","CatalogVersionDetailsComponent",{selector:"se-catalog-version-details",template:`<div class="se-catalog-version-container" [attr.data-catalog-version]="catalogVersion.version"><div class="se-catalog-version-container__left"><se-catalog-versions-thumbnail-carousel [catalogVersion]="catalogVersion" [catalog]="catalog" [siteId]="siteId"></se-catalog-versions-thumbnail-carousel><div><div class="se-catalog-version-container__name">{{catalogVersion.version}}</div><div class="se-catalog-version-container__left__templates"><div class="se-catalog-version-container__left__template" *ngFor="let item of leftItems; let isLast = last"><se-catalog-version-item-renderer [item]="item" [siteId]="siteId" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion"></se-catalog-version-item-renderer><div class="se-catalog-version-container__divider" *ngIf="!isLast"></div></div></div></div></div><div class="se-catalog-version-container__right"><div class="se-catalog-version-container__right__template" *ngFor="let item of rightItems"><se-catalog-version-item-renderer [item]="item" [siteId]="siteId" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion"></se-catalog-version-item-renderer></div></div></div>`});let Ft=class CatalogVersionDetailsComponent{constructor(e){this.catalogDetailsService=e}ngOnInit(){const{left:e,right:t}=this.catalogDetailsService.getItems();this.leftItems=e;this.rightItems=t}};Ft.$inject=["catalogDetailsService"];__decorate([n.Input(),__metadata("design:type",Object)],Ft.prototype,"catalog",void 0);__decorate([n.Input(),__metadata("design:type",Object)],Ft.prototype,"catalogVersion",void 0);__decorate([n.Input(),__metadata("design:type",Object)],Ft.prototype,"activeCatalogVersion",void 0);__decorate([n.Input(),__metadata("design:type",String)],Ft.prototype,"siteId",void 0);Ft=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-catalog-version-details",template:`<div class="se-catalog-version-container" [attr.data-catalog-version]="catalogVersion.version"><div class="se-catalog-version-container__left"><se-catalog-versions-thumbnail-carousel [catalogVersion]="catalogVersion" [catalog]="catalog" [siteId]="siteId"></se-catalog-versions-thumbnail-carousel><div><div class="se-catalog-version-container__name">{{catalogVersion.version}}</div><div class="se-catalog-version-container__left__templates"><div class="se-catalog-version-container__left__template" *ngFor="let item of leftItems; let isLast = last"><se-catalog-version-item-renderer [item]="item" [siteId]="siteId" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion"></se-catalog-version-item-renderer><div class="se-catalog-version-container__divider" *ngIf="!isLast"></div></div></div></div></div><div class="se-catalog-version-container__right"><div class="se-catalog-version-container__right__template" *ngFor="let item of rightItems"><se-catalog-version-item-renderer [item]="item" [siteId]="siteId" [catalog]="catalog" [catalogVersion]="catalogVersion" [activeCatalogVersion]="activeCatalogVersion"></se-catalog-version-item-renderer></div></div></div>`}),__metadata("design:paramtypes",[d.ICatalogDetailsService])],Ft);window.__smartedit__.addDecoratorPayload("Component","CatalogVersionItemRendererComponent",{selector:"se-catalog-version-item-renderer",template:`\n        <ng-container>\n            <div *ngIf="item.component">\n                <ng-container\n                    *ngComponentOutlet="item.component; injector: itemInjector"\n                ></ng-container>\n            </div>\n        </ng-container>\n    `});let zt=class CatalogVersionItemRendererComponent{constructor(e){this.injector=e}ngOnInit(){this.createInjector()}ngOnChanges(){this.createInjector()}createInjector(){if(!this.item.component){return}this.itemInjector=n.Injector.create({parent:this.injector,providers:[{provide:d.CATALOG_DETAILS_ITEM_DATA,useValue:{siteId:this.siteId,catalog:this.catalog,catalogVersion:this.catalogVersion,activeCatalogVersion:this.activeCatalogVersion}}]})}};zt.$inject=["injector"];__decorate([n.Input(),__metadata("design:type",Object)],zt.prototype,"item",void 0);__decorate([n.Input(),__metadata("design:type",Object)],zt.prototype,"catalog",void 0);__decorate([n.Input(),__metadata("design:type",Object)],zt.prototype,"catalogVersion",void 0);__decorate([n.Input(),__metadata("design:type",Object)],zt.prototype,"activeCatalogVersion",void 0);__decorate([n.Input(),__metadata("design:type",String)],zt.prototype,"siteId",void 0);zt=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-catalog-version-item-renderer",template:`\n        <ng-container>\n            <div *ngIf="item.component">\n                <ng-container\n                    *ngComponentOutlet="item.component; injector: itemInjector"\n                ></ng-container>\n            </div>\n        </ng-container>\n    `}),__metadata("design:paramtypes",[n.Injector])],zt);window.__smartedit__.addDecoratorPayload("Component","CatalogVersionsThumbnailCarouselComponent",{selector:"se-catalog-versions-thumbnail-carousel",template:`<div class="se-active-catalog-thumbnail"><div class="se-active-catalog-version-container__thumbnail" (click)="onClick()"><div class="se-active-catalog-version-container__thumbnail__default-img"><div class="se-active-catalog-version-container__thumbnail__img" [ngStyle]="{'background-image': 'url(' + catalogVersion.thumbnailUrl + ')'}"></div></div></div></div>`});let Lt=class CatalogVersionsThumbnailCarouselComponent{constructor(e){this.experienceService=e}onClick(){this.experienceService.loadExperience({siteId:this.siteId,catalogId:this.catalog.catalogId,catalogVersion:this.catalogVersion.version})}};Lt.$inject=["experienceService"];__decorate([n.Input(),__metadata("design:type",Object)],Lt.prototype,"catalog",void 0);__decorate([n.Input(),__metadata("design:type",Object)],Lt.prototype,"catalogVersion",void 0);__decorate([n.Input(),__metadata("design:type",String)],Lt.prototype,"siteId",void 0);Lt=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-catalog-versions-thumbnail-carousel",template:`<div class="se-active-catalog-thumbnail"><div class="se-active-catalog-version-container__thumbnail" (click)="onClick()"><div class="se-active-catalog-version-container__thumbnail__default-img"><div class="se-active-catalog-version-container__thumbnail__img" [ngStyle]="{'background-image': 'url(' + catalogVersion.thumbnailUrl + ')'}"></div></div></div></div>`}),__metadata("design:paramtypes",[d.IExperienceService])],Lt);window.__smartedit__.addDecoratorPayload("Component","HomePageLinkComponent",{selector:"se-home-page-link",template:`<div class="home-link-container"><a href="javascript:void(0)" class="home-link-item__link se-catalog-version__link" (click)="onClick()">{{ 'se.landingpage.homepage' | translate }}</a></div>`});let Vt=class HomePageLinkComponent{constructor(e,t,o){this.experienceService=e;this.userTrackingService=t;this.data=o}onClick(){const{siteId:e,catalog:{catalogId:t},catalogVersion:{version:o}}=this.data;this.experienceService.loadExperience({siteId:e,catalogId:t,catalogVersion:o});this.userTrackingService.trackingUserAction(d.USER_TRACKING_FUNCTIONALITY.NAVIGATION,o+" - HomePage")}};Vt.$inject=["experienceService","userTrackingService","data"];Vt=__decorate([d.SeDowngradeComponent(),n.Component({selector:"se-home-page-link",template:`<div class="home-link-container"><a href="javascript:void(0)" class="home-link-item__link se-catalog-version__link" (click)="onClick()">{{ 'se.landingpage.homepage' | translate }}</a></div>`}),__param(2,n.Inject(d.CATALOG_DETAILS_ITEM_DATA)),__metadata("design:paramtypes",[d.IExperienceService,d.UserTrackingService,Object])],Vt);let Ut=class CatalogDetailsService{constructor(){this._customItems={left:[{component:Vt}],right:[]}}addItems(e,t){if(t===d.CATALOG_DETAILS_COLUMNS.RIGHT){this._customItems.right=this._customItems.right.concat(e)}else{this._customItems.left=this._customItems.left.splice(0);this._customItems.left.splice(this._customItems.left.length-1,0,...e)}}getItems(){return this._customItems}};Ut=__decorate([d.SeDowngradeService(d.ICatalogDetailsService)],Ut);let jt=class CatalogDetailsModule{};jt=__decorate([n.NgModule({imports:[g.CommonModule,d.CollapsibleContainerModule,d.CompileHtmlModule,d.L10nPipeModule,d.SharedComponentsModule,f.IconModule,v.TranslateModule.forChild()],providers:[{provide:d.ICatalogDetailsService,useClass:Ut},Rt],declarations:[Vt,Dt,Ft,Lt,zt,xt,Nt,kt],entryComponents:[Lt,Ft,Vt,Dt,zt,xt,Nt,kt],exports:[Dt]})],jt);const SmarteditContainerFactory=e=>{let o=class Smarteditcontainer{};o=__decorate([n.NgModule({schemas:[n.CUSTOM_ELEMENTS_SCHEMA],imports:[b.BrowserModule,I.BrowserAnimationsModule,S.FormsModule,S.ReactiveFormsModule,w.UpgradeModule,s.HttpClientModule,d.FundamentalsModule,d.SeGenericEditorModule,d.SharedComponentsModule,d.ClientPagedListModule,d.FilterByFieldPipeModule,ft,ue.forRoot(),t.ToolbarModule,jt,d.SelectModule,lt,Pt,d.ConfirmDialogModule,d.HttpInterceptorModule.forRoot(d.UnauthorizedErrorInterceptor,d.ResourceNotFoundErrorInterceptor,d.RetryInterceptor,d.NonValidationErrorInterceptor,d.PreviewErrorInterceptor,d.PermissionErrorInterceptor),d.SeTranslationModule.forRoot(t.TranslationsFetchService),ze,...e.modules,d.SeRouteService.provideNgRoute([{path:d.NG_ROUTE_PREFIX,shortcutComponent:At,component:St},{path:`${d.NG_ROUTE_PREFIX}/sites/:siteId`,component:St},{path:`${d.NG_ROUTE_PREFIX}/storefront`,canActivate:[Re],priority:30,titleI18nKey:"se.route.storefront.title",component:Ct},{path:d.NG_ROUTE_WILDCARD,component:ct}],{useHash:true,initialNavigation:true,onSameUrlNavigation:"reload"})],declarations:[ht,ct,At,ot,it,ke,Ot,ye,St,Ct,bt],entryComponents:[ht,At,ot,ke,Ot,ye,St,Ct,bt],providers:[{provide:n.ErrorHandler,useClass:d.SmarteditErrorHandler},Y,d.SSOAuthenticationHelper,d.moduleUtils.provideValues(e.constants),{provide:u.UrlHandlingStrategy,useClass:d.CustomHandlingStrategy},{provide:g.APP_BASE_HREF,useValue:"!"},d.LegacyGEWidgetToCustomElementConverter,$,{provide:d.IAuthenticationManagerService,useClass:d.AuthenticationManager},{provide:d.IAuthenticationService,useClass:d.AuthenticationService},{provide:d.IConfirmationModalService,useClass:Ve},{provide:d.ISharedDataService,useClass:t.SharedDataService},d.SeRouteService,{provide:d.ISessionService,useClass:t.SessionService},{provide:d.IStorageService,useClass:t.StorageService},{provide:d.IUrlService,useClass:se},{provide:d.IIframeClickDetectionService,useClass:Ee},{provide:d.ICatalogService,useClass:ne},{provide:d.IExperienceService,useClass:X},d.SmarteditRoutingService,d.ContentCatalogRestService,d.ProductCatalogRestService,t.LoadConfigManagerService,d.moduleUtils.bootstrap(((e,t,o,n,s,a,r,p,m,g,u,v,f,S,C,b,I,w,E,T)=>{t.initForService(e,["filterEntryPoints","isAuthEntryPoint","authenticate","logout","isReAuthInProgress","setReAuthInProgress","isAuthenticated"],d.diNameUtils.buildServiceName(d.AuthenticationService));p.initListener();o.onSmarteditContainerReady().subscribe((()=>{E.init();E.routeChangeSuccess().subscribe((e=>{b.dismissAll()}));r.loadAsObject().then((e=>{C.set("defaultToolingLanguage",e.defaultToolingLanguage);C.set("maxUploadFileSize",e.maxUploadFileSize);if(!!e.typeAheadDebounce){C.set("typeAheadDebounce",e.typeAheadDebounce)}if(!!e.typeAheadMiniSearchTermLength){C.set("typeAheadMiniSearchTermLength",e.typeAheadMiniSearchTermLength)}}));n.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:d.PERSPECTIVE_SELECTOR_WIDGET_KEY,nameI18nKey:"se.perspective.selector.widget",type:"TEMPLATE",priority:1,section:"left",component:Ot});const e=a.getToolbarService("smartEditHeaderToolbar");e.addItems([{key:"headerToolbar.logoTemplate",type:d.ToolbarItemType.TEMPLATE,component:Je,priority:1,section:d.ToolbarSection.left},{key:"headerToolbar.userAccountTemplate",type:d.ToolbarItemType.HYBRID_ACTION,iconClassName:"sap-icon--customer",component:Xe,priority:1,actionButtonFormat:"compact",section:d.ToolbarSection.right,dropdownPosition:d.ToolbarDropDownPosition.right},{key:"headerToolbar.languageSelectorTemplate",type:d.ToolbarItemType.HYBRID_ACTION,iconClassName:"sap-icon--world",component:d.HeaderLanguageDropdownComponent,priority:3,actionButtonFormat:"compact",section:d.ToolbarSection.right,dropdownPosition:d.ToolbarDropDownPosition.center},{key:"headerToolbar.configurationTemplate",type:d.ToolbarItemType.ACTION,actionButtonFormat:"compact",iconClassName:"icon-action-settings",callback:()=>{s.editConfiguration()},priority:4,section:d.ToolbarSection.right,permissions:["smartedit.configurationcenter.read"]},{key:"headerToolbar.qualtricTemplate",type:d.ToolbarItemType.TEMPLATE,priority:2,section:d.ToolbarSection.right,component:et}]);const t=a.getToolbarService("smartEditExperienceToolbar");t.addItems([{key:"se.cms.shortcut",type:d.ToolbarItemType.TEMPLATE,component:d.ShortcutLinkComponent,priority:1,section:d.ToolbarSection.left},{key:"experienceToolbar.deviceSupportTemplate",type:d.ToolbarItemType.TEMPLATE,component:qe,priority:1,section:d.ToolbarSection.right},{type:d.ToolbarItemType.TEMPLATE,key:"experienceToolbar.experienceSelectorTemplate",component:Qe,priority:1,section:d.ToolbarSection.middle}]);function offSetStorefront(){g(d.SMARTEDIT_IFRAME_WRAPPER_ID).css("padding-top",g(".se-toolbar-group").height()+"px")}function getBootstrapNamespace(){if(window.__smartedit__.smartEditBootstrapped){window.__smartedit__.smartEditBootstrapped={}}return window.__smartedit__.smartEditBootstrapped}m.getInstance().subscribe("loading",((e,t)=>{const o=f.defer();u.setCurrentLocation(t.location);v.showWaitModal();const n=getBootstrapNamespace();delete n[t.location];return o.promise}));m.getInstance().subscribe("unloading",((e,t)=>{const o=f.defer();v.showWaitModal();return o.promise}));m.getInstance().subscribe("bootstrapSmartEdit",((e,t)=>{offSetStorefront();const o=f.defer();const n=getBootstrapNamespace();if(!n[t.location]){n[t.location]=true;r.loadAsObject().then((e=>{S.bootstrapSEApp(e);o.resolve()}))}else{o.resolve()}return o.promise}));m.getInstance().subscribe("smartEditReady",(function(){const e=f.defer();e.resolve();v.hideWaitModal();return e.promise}));T.initConfiguration()}))}),[d.IAuthenticationService,d.GatewayProxy,d.AngularJSBootstrapIndicatorService,d.IFeatureService,Me,d.IToolbarServiceFactory,t.LoadConfigManagerService,d.GatewayFactory,d.SmarteditBootstrapGateway,d.YJQUERY_TOKEN,$,d.IWaitDialogService,d.PromiseUtils,t.BootstrapService,d.ISharedDataService,d.IModalService,d.IRenderService,Ie,d.SmarteditRoutingService,d.UserTrackingService]),d.moduleUtils.initialize(((e,t,o,n,a,r,p)=>{d.diBridgeUtils.downgradeService("httpClient",s.HttpClient);d.diBridgeUtils.downgradeService("restServiceFactory",d.RestServiceFactory);d.diBridgeUtils.downgradeService("authenticationService",d.AuthenticationService,d.IAuthenticationService);d.diBridgeUtils.downgradeService("l10nPipe",d.L10nPipe);r.registerDefaultRule({names:[ve],verify:e=>{const t=e.map((e=>e.name));return p.hasGlobalPermissions(t)}});e.convert();a.registerRulesAndPermissions()}),[d.LegacyGEWidgetToCustomElementConverter,t.DelegateRestService,s.HttpClient,d.RestServiceFactory,oe,d.IPermissionService,d.AuthorizationService,d.L10nService])],bootstrap:[ht]})],o);return o};if(true){n.enableProdMode()}t.SmarteditContainerFactory=SmarteditContainerFactory},228:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(4);var s=o(0);var a=o(20);var r=o(86);var d=o(3);var p=o(105);var m=o(42);var g=o(93);var u=o(46);function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}var v=_interopDefaultLegacy(d);(function(){var e=e||window.angular;var t=null;try{t=e.module("personalizationsmarteditCommonTemplates")}catch(e){}t=t||e.module("personalizationsmarteditCommonTemplates",[]);t.run(["$templateCache",function(e){e.put("DatetimePickerRangeComponent.html",'<div class="pe-datetime-range"><div class="col-md-6 pe-datetime-range__from" [ngClass]="{ \'has-error\': !isFromDateValid }"><label for="customization-start-date" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate" class="fd-form__label perso__datetimepicker__label"></label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help"></span></se-help><div id="date-picker-range-from" #datePickerRangeFrom class="input-group se-date-field pe-date-field" *ngIf="isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-start-date" class="fd-form-control se-date-field--input pe-date-field__input" [placeholder]="placeholderText | translate" [attr.disabled]="!isEditable ? true : null" [(ngModel)]="dateFrom" (keyup)="dateFromInputOnKeyup($event)"/> <span class="input-group-addon se-date-field--button pe-datetime-range__picker" *ngIf="isEditable"><span class="sap-icon--calendar pe-datetime-range__picker__icon"></span></span></div><div id="date-picker-range-from" #datePickerRangeFrom class="input-group se-date-field pe-date-field" *ngIf="!isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-start-date" class="fd-form-control se-date-field--input pe-date-field__input pe-input--is-disabled" disabled="disabled" data-date-formatter data-format-type="short" [(ngModel)]="dateFrom"/></div><span *ngIf="!isFromDateValid" class="help-block pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span></div><div class="col-md-6 pe-datetime-range__to" [ngClass]="{ \'has-error\': !isToDateValid, \'has-warning\': isEndDateInThePast }"><label for="customization-end-date" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate" class="fd-form__label perso__datetimepicker__label"></label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help"></span></se-help><div id="date-picker-range-to" #datePickerRangeTo class="input-group se-date-field pe-date-field" *ngIf="isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-end-date" class="fd-form-control se-date-field--input pe-date-field__input" [placeholder]="placeholderText | translate" [attr.disabled]="!isEditable ? true : null" [(ngModel)]="dateTo" (keyup)="dateToInputOnKeyup($event)"/> <span class="input-group-addon se-date-field--button pe-datetime-range__picker" *ngIf="isEditable"><span class="sap-icon--calendar pe-datetime-range__picker__icon"></span></span></div><div id="date-picker-range-to" #datePickerRangeTo class="input-group se-date-field pe-date-field" *ngIf="!isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-end-date" class="fd-form-control se-date-field--input pe-date-field__input pe-input--is-disabled" disabled="disabled" data-date-formatter data-format-type="short" [(ngModel)]="dateTo"/></div><span *ngIf="!isToDateValid" class="help-block pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformat.description"></span> <span *ngIf="isEndDateInThePast" class="help-block pe-datetime__warning-msg pe-datetime__msg"><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span></span></div></div>');e.put("PersonalizationsmarteditInfiniteScrollingComponent.html",'<div [ngClass]="dropDownContainerClass" persoInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div [ngClass]="dropDownClass"><ng-content></ng-content></div></div>');e.put("PersonalizationPreventParentScrollComponent.html","<div persoPreventParentScroll><ng-content></ng-content></div>");e.put("ScrollZoneComponent.html",'<ng-template #scrollZoneBody><personalizationsmartedit-scroll-zone-body-container><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneTop" [isTransparent]="isTransparent" [additionalClasses]="[\'perso__scrollzone--top\']" (scrollZoneBodyMouseenter)="onScrollTopMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneBottom" [isTransparent]="isTransparent" [additionalClasses]="[\'perso__scrollzone--bottom\']" (scrollZoneBodyMouseenter)="onScrollBottomMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body></personalizationsmartedit-scroll-zone-body-container></ng-template>');e.put("ScrollZoneBodyComponent.html",'<div class="perso__scrollzone" [ngClass]="cssClasses" (mouseenter)="onMouseenter()" (mouseleave)="onMouseleave()"></div>');e.put("ScrollZoneBodyContainerComponent.html","<ng-content></ng-content>")}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}const f={SHORT_DATE_FORMAT:"M/D/YY",MODEL_DATE_FORMAT:"YYYY-MM-DDTHH:mm:SSZ"};const S={ANGULAR_FORMAT:"short",MOMENT_FORMAT:"M/D/YY h:mm A",MOMENT_ISO:"YYYY-MM-DDTHH:mm:00ZZ",ISO:"yyyy-MM-ddTHH:mm:00Z"};(function(e){e["ENABLED"]="ENABLED";e["DISABLED"]="DISABLED";e["DELETED"]="DELETED"})(t.PERSONALIZATION_MODEL_STATUS_CODES||(t.PERSONALIZATION_MODEL_STATUS_CODES={}));const C={ALL:"ALL",ENABLED:"ENABLED",DISABLED:"DISABLED"};const b={0:{borderClass:"personalizationsmarteditComponentSelected0",listClass:"personalizationsmarteditComponentSelectedList0"},1:{borderClass:"personalizationsmarteditComponentSelected1",listClass:"personalizationsmarteditComponentSelectedList1"},2:{borderClass:"personalizationsmarteditComponentSelected2",listClass:"personalizationsmarteditComponentSelectedList2"},3:{borderClass:"personalizationsmarteditComponentSelected3",listClass:"personalizationsmarteditComponentSelectedList3"},4:{borderClass:"personalizationsmarteditComponentSelected4",listClass:"personalizationsmarteditComponentSelectedList4"},5:{borderClass:"personalizationsmarteditComponentSelected5",listClass:"personalizationsmarteditComponentSelectedList5"},6:{borderClass:"personalizationsmarteditComponentSelected6",listClass:"personalizationsmarteditComponentSelectedList6"},7:{borderClass:"personalizationsmarteditComponentSelected7",listClass:"personalizationsmarteditComponentSelectedList7"},8:{borderClass:"personalizationsmarteditComponentSelected8",listClass:"personalizationsmarteditComponentSelectedList8"},9:{borderClass:"personalizationsmarteditComponentSelected9",listClass:"personalizationsmarteditComponentSelectedList9"},10:{borderClass:"personalizationsmarteditComponentSelected10",listClass:"personalizationsmarteditComponentSelectedList10"},11:{borderClass:"personalizationsmarteditComponentSelected11",listClass:"personalizationsmarteditComponentSelectedList11"},12:{borderClass:"personalizationsmarteditComponentSelected12",listClass:"personalizationsmarteditComponentSelectedList12"},13:{borderClass:"personalizationsmarteditComponentSelected13",listClass:"personalizationsmarteditComponentSelectedList13"},14:{borderClass:"personalizationsmarteditComponentSelected14",listClass:"personalizationsmarteditComponentSelectedList14"}};const I="personalizationsmartedit.container.combinedview.toolbar";const w="personalizationsmartedit.container.pagecustomizations.toolbar";const E={OLD:"old",NEW:"new",DELETE:"delete",UPDATE:"update"};const T={ALL:"all",ONLY_THIS_PAGE:"onlythispage"};const P={ALL:"all",CURRENT:"current",PARENTS:"parents"};const A="CxCmsComponentContainer";const O="data-smartedit-container-source-id";const x={BASIC_INFO_TAB_NAME:"basicinfotab",BASIC_INFO_TAB_FORM_NAME:"form.basicinfotab",TARGET_GROUP_TAB_NAME:"targetgrptab",TARGET_GROUP_TAB_FORM_NAME:"form.targetgrptab"};const D={CONFIRM_OK:"confirmOk",CONFIRM_CANCEL:"confirmCancel",CONFIRM_NEXT:"confirmNext"};const k={CRITERIA_AND:"AND",CRITERIA_OR:"OR"};t.PersonalizationsmarteditDateUtils=class PersonalizationsmarteditDateUtils{constructor(e){this.translateService=e}formatDate(e,t){t=t||S.MOMENT_FORMAT;if(e){if(e.match&&e.match(/^(\d{4})\-(\d{2})\-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\+|\-)(\d{4})$/)){e=`${e.slice(0,-2)}:${e.slice(-2)}`}return v["default"](new Date(e)).format(t)}else{return""}}formatDateWithMessage(e,t){t=t||f.SHORT_DATE_FORMAT;if(e){return this.formatDate(e,t)}else{return this.translateService.instant("personalization.toolbar.pagecustomizations.nodatespecified")}}isDateInThePast(e){if(r.stringUtils.isBlank(e)){return false}else{return v["default"](e,S.MOMENT_FORMAT).isBefore()}}isDateValidOrEmpty(e){return r.stringUtils.isBlank(e)||this.isDateValid(e)}isDateValid(e){return v["default"](e,S.MOMENT_FORMAT).isValid()}isDateRangeValid(e,t){if(r.stringUtils.isBlank(e)||r.stringUtils.isBlank(t)){return true}else{return v["default"](new Date(e)).isSameOrBefore(v["default"](new Date(t)))}}isDateStrFormatValid(e,t){t=t||S.MOMENT_FORMAT;if(r.stringUtils.isBlank(e)){return false}else{return v["default"](e,t,true).isValid()}}};t.PersonalizationsmarteditDateUtils.$inject=["translateService"];t.PersonalizationsmarteditDateUtils=__decorate([r.SeDowngradeService(),__metadata("design:paramtypes",[p.TranslateService])],t.PersonalizationsmarteditDateUtils);window.__smartedit__.addDecoratorPayload("Component","DatetimePickerRangeComponent",{selector:"datetime-picker-range",template:`<div class="pe-datetime-range"><div class="col-md-6 pe-datetime-range__from" [ngClass]="{ 'has-error': !isFromDateValid }"><label for="customization-start-date" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate" class="fd-form__label perso__datetimepicker__label"></label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help"></span></se-help><div id="date-picker-range-from" #datePickerRangeFrom class="input-group se-date-field pe-date-field" *ngIf="isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-start-date" class="fd-form-control se-date-field--input pe-date-field__input" [placeholder]="placeholderText | translate" [attr.disabled]="!isEditable ? true : null" [(ngModel)]="dateFrom" (keyup)="dateFromInputOnKeyup($event)"/> <span class="input-group-addon se-date-field--button pe-datetime-range__picker" *ngIf="isEditable"><span class="sap-icon--calendar pe-datetime-range__picker__icon"></span></span></div><div id="date-picker-range-from" #datePickerRangeFrom class="input-group se-date-field pe-date-field" *ngIf="!isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-start-date" class="fd-form-control se-date-field--input pe-date-field__input pe-input--is-disabled" disabled="disabled" data-date-formatter data-format-type="short" [(ngModel)]="dateFrom"/></div><span *ngIf="!isFromDateValid" class="help-block pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span></div><div class="col-md-6 pe-datetime-range__to" [ngClass]="{ 'has-error': !isToDateValid, 'has-warning': isEndDateInThePast }"><label for="customization-end-date" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate" class="fd-form__label perso__datetimepicker__label"></label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help"></span></se-help><div id="date-picker-range-to" #datePickerRangeTo class="input-group se-date-field pe-date-field" *ngIf="isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-end-date" class="fd-form-control se-date-field--input pe-date-field__input" [placeholder]="placeholderText | translate" [attr.disabled]="!isEditable ? true : null" [(ngModel)]="dateTo" (keyup)="dateToInputOnKeyup($event)"/> <span class="input-group-addon se-date-field--button pe-datetime-range__picker" *ngIf="isEditable"><span class="sap-icon--calendar pe-datetime-range__picker__icon"></span></span></div><div id="date-picker-range-to" #datePickerRangeTo class="input-group se-date-field pe-date-field" *ngIf="!isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-end-date" class="fd-form-control se-date-field--input pe-date-field__input pe-input--is-disabled" disabled="disabled" data-date-formatter data-format-type="short" [(ngModel)]="dateTo"/></div><span *ngIf="!isToDateValid" class="help-block pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformat.description"></span> <span *ngIf="isEndDateInThePast" class="help-block pe-datetime__warning-msg pe-datetime__msg"><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span></span></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});t.DatetimePickerRangeComponent=class DatetimePickerRangeComponent{constructor(e,t,o,n){this.personalizationsmarteditDateUtils=e;this.browserService=t;this.cdr=o;this.yjQuery=n;this.dateFromChange=new s.EventEmitter;this.dateToChange=new s.EventEmitter;this.placeholderText="personalization.commons.datetimepicker.placeholder";this.isFromDateValid=false;this.isToDateValid=false;this.isEndDateInThePast=false;this.datetimePickerConfig={format:r.DATE_CONSTANTS.MOMENT_FORMAT,showClear:true,showClose:true,useCurrent:false,keepInvalid:true,widgetPositioning:{horizontal:"right",vertical:"bottom"},locale:this.getLocaleForDatetimePicker()}}ngAfterViewInit(){if(this.isEditable){this.initActions();this.initInputValues()}}ngOnChanges(e){const t=e.dateFrom;const o=e.dateTo;if(t&&!t.isFirstChange()&&this.isEditable){this.setDateFrom(t.currentValue)}if(o&&!o.isFirstChange()&&this.isEditable){this.setDateTo(o.currentValue)}}dateFromInputOnKeyup(e){this.validateDateFrom(e.target.value)}dateToInputOnKeyup(e){this.validateDateTo(e.target.value)}validateDateFrom(e){this.isFromDateValid=this.personalizationsmarteditDateUtils.isDateValidOrEmpty(e)}validateDateTo(e){const t=this.personalizationsmarteditDateUtils.isDateValidOrEmpty(e);if(t){this.isToDateValid=true;this.isEndDateInThePast=this.personalizationsmarteditDateUtils.isDateInThePast(e)}else{this.isToDateValid=false;this.isEndDateInThePast=false}}setDateFrom(e){this.validateDateFrom(e);const t=this.getFromDatetimePicker();const o=this.getToDatetimePicker();if(this.personalizationsmarteditDateUtils.isDateStrFormatValid(e,r.DATE_CONSTANTS.MOMENT_FORMAT)){o.minDate(this.getMinToDate(e));t.date(e)}else{o.minDate(v["default"]())}}setDateTo(e){this.validateDateTo(e);const t=this.getFromDatetimePicker();const o=this.getToDatetimePicker();if(this.personalizationsmarteditDateUtils.isDateStrFormatValid(e,r.DATE_CONSTANTS.MOMENT_FORMAT)){t.maxDate(this.getMinOrMaxDateForDatetimePicker(e));o.date(v["default"](new Date(e)))}else if(e===""){t.maxDate(false)}}getMinOrMaxDateForDatetimePicker(e){try{return v["default"](new Date(e))}catch(e){return false}}initActions(){this.getFromPickerNode().datetimepicker(this.datetimePickerConfig).on("dp.update dp.hide dp.change",(e=>{let t=this.personalizationsmarteditDateUtils.formatDate(e.date,undefined);if(this.personalizationsmarteditDateUtils.isDateValidOrEmpty(t)&&this.personalizationsmarteditDateUtils.isDateValidOrEmpty(this.dateTo)&&!this.personalizationsmarteditDateUtils.isDateRangeValid(t,this.dateTo)){t=this.dateTo}this.dateFrom=t;this.dateFromChange.emit(this.dateFrom)}));this.getToPickerNode().datetimepicker(this.datetimePickerConfig).on("dp.update dp.hide dp.change",(e=>{let t=this.personalizationsmarteditDateUtils.formatDate(e.date,undefined);if(this.personalizationsmarteditDateUtils.isDateValidOrEmpty(t)&&this.personalizationsmarteditDateUtils.isDateValidOrEmpty(this.dateFrom)&&!this.personalizationsmarteditDateUtils.isDateRangeValid(this.dateFrom,t)){t=this.dateFrom}this.dateTo=t;this.dateToChange.emit(this.dateTo)}));this.getToDatetimePicker().minDate(v["default"]())}initInputValues(){if(this.dateFrom){this.setDateFrom(this.dateFrom)}else{this.isFromDateValid=true}if(this.dateTo){this.setDateTo(this.dateTo)}else{this.isToDateValid=true}this.cdr.detectChanges()}getLocaleForDatetimePicker(){return this.browserService.getBrowserLocale().split("-")[0]}getMinToDate(e){if(!this.personalizationsmarteditDateUtils.isDateInThePast(e)){return this.getMinOrMaxDateForDatetimePicker(e)}else{return v["default"]()}}getFromPickerNode(){return this.yjQuery(this.datePickerRangeFrom.nativeElement)}getFromDatetimePicker(){return this.getFromPickerNode().datetimepicker().data("DateTimePicker")}getToPickerNode(){return this.yjQuery(this.datePickerRangeTo.nativeElement)}getToDatetimePicker(){return this.getToPickerNode().datetimepicker().data("DateTimePicker")}};__decorate([s.ViewChild("datePickerRangeFrom",{static:false}),__metadata("design:type",s.ElementRef)],t.DatetimePickerRangeComponent.prototype,"datePickerRangeFrom",void 0);__decorate([s.ViewChild("datePickerRangeTo",{static:false}),__metadata("design:type",s.ElementRef)],t.DatetimePickerRangeComponent.prototype,"datePickerRangeTo",void 0);__decorate([s.Input(),__metadata("design:type",String)],t.DatetimePickerRangeComponent.prototype,"dateFrom",void 0);__decorate([s.Input(),__metadata("design:type",String)],t.DatetimePickerRangeComponent.prototype,"dateTo",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],t.DatetimePickerRangeComponent.prototype,"isEditable",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],t.DatetimePickerRangeComponent.prototype,"dateFromChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],t.DatetimePickerRangeComponent.prototype,"dateToChange",void 0);t.DatetimePickerRangeComponent=__decorate([s.Component({selector:"datetime-picker-range",template:`<div class="pe-datetime-range"><div class="col-md-6 pe-datetime-range__from" [ngClass]="{ 'has-error': !isFromDateValid }"><label for="customization-start-date" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate" class="fd-form__label perso__datetimepicker__label"></label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help"></span></se-help><div id="date-picker-range-from" #datePickerRangeFrom class="input-group se-date-field pe-date-field" *ngIf="isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-start-date" class="fd-form-control se-date-field--input pe-date-field__input" [placeholder]="placeholderText | translate" [attr.disabled]="!isEditable ? true : null" [(ngModel)]="dateFrom" (keyup)="dateFromInputOnKeyup($event)"/> <span class="input-group-addon se-date-field--button pe-datetime-range__picker" *ngIf="isEditable"><span class="sap-icon--calendar pe-datetime-range__picker__icon"></span></span></div><div id="date-picker-range-from" #datePickerRangeFrom class="input-group se-date-field pe-date-field" *ngIf="!isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-start-date" class="fd-form-control se-date-field--input pe-date-field__input pe-input--is-disabled" disabled="disabled" data-date-formatter data-format-type="short" [(ngModel)]="dateFrom"/></div><span *ngIf="!isFromDateValid" class="help-block pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description"></span></div><div class="col-md-6 pe-datetime-range__to" [ngClass]="{ 'has-error': !isToDateValid, 'has-warning': isEndDateInThePast }"><label for="customization-end-date" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate" class="fd-form__label perso__datetimepicker__label"></label><se-help><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help"></span></se-help><div id="date-picker-range-to" #datePickerRangeTo class="input-group se-date-field pe-date-field" *ngIf="isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-end-date" class="fd-form-control se-date-field--input pe-date-field__input" [placeholder]="placeholderText | translate" [attr.disabled]="!isEditable ? true : null" [(ngModel)]="dateTo" (keyup)="dateToInputOnKeyup($event)"/> <span class="input-group-addon se-date-field--button pe-datetime-range__picker" *ngIf="isEditable"><span class="sap-icon--calendar pe-datetime-range__picker__icon"></span></span></div><div id="date-picker-range-to" #datePickerRangeTo class="input-group se-date-field pe-date-field" *ngIf="!isEditable"><input type="text" name="data-date-time-from-to-key" id="customization-end-date" class="fd-form-control se-date-field--input pe-date-field__input pe-input--is-disabled" disabled="disabled" data-date-formatter data-format-type="short" [(ngModel)]="dateTo"/></div><span *ngIf="!isToDateValid" class="help-block pe-datetime__error-msg pe-datetime__msg" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformat.description"></span> <span *ngIf="isEndDateInThePast" class="help-block pe-datetime__warning-msg pe-datetime__msg"><span translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span></span></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(3,s.Inject(r.YJQUERY_TOKEN)),__metadata("design:paramtypes",[t.PersonalizationsmarteditDateUtils,r.BrowserService,s.ChangeDetectorRef,Function])],t.DatetimePickerRangeComponent);t.DatetimePickerRangeModule=class DatetimePickerRangeModule{};t.DatetimePickerRangeModule=__decorate([s.NgModule({imports:[n.CommonModule,a.FormsModule,r.SeTranslationModule.forChild(),r.HelpModule],declarations:[t.DatetimePickerRangeComponent],entryComponents:[t.DatetimePickerRangeComponent],exports:[t.DatetimePickerRangeComponent]})],t.DatetimePickerRangeModule);t.PersonalizationInfiniteScrollDirective=class PersonalizationInfiniteScrollDirective{constructor(e){this.element=e;this.scrollPercent=75;this.onScrollAction=new s.EventEmitter}ngOnInit(){this.scrollEvent=m.fromEvent(this.element.nativeElement,"scroll");this.subscription=this.scrollEvent.subscribe((e=>{if((e.target.scrollTop+e.target.offsetHeight)/e.target.scrollHeight>this.scrollPercent/100){this.onScrollAction.emit(null)}}))}ngOnDestroy(){if(this.subscription){this.subscription.unsubscribe()}}};__decorate([s.Input(),__metadata("design:type",Object)],t.PersonalizationInfiniteScrollDirective.prototype,"scrollPercent",void 0);__decorate([s.Output(),__metadata("design:type",Object)],t.PersonalizationInfiniteScrollDirective.prototype,"onScrollAction",void 0);t.PersonalizationInfiniteScrollDirective=__decorate([s.Directive({selector:"[persoInfiniteScroll]"}),__param(0,s.Inject(s.ElementRef)),__metadata("design:paramtypes",[s.ElementRef])],t.PersonalizationInfiniteScrollDirective);window.__smartedit__.addDecoratorPayload("Component","PersonalizationsmarteditInfiniteScrollingComponent",{selector:"personalization-infinite-scrolling",template:`<div [ngClass]="dropDownContainerClass" persoInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div [ngClass]="dropDownClass"><ng-content></ng-content></div></div>`});t.PersonalizationsmarteditInfiniteScrollingComponent=class PersonalizationsmarteditInfiniteScrollingComponent{constructor(){this.distance=80;this.initiated=false}ngOnInit(){this.init()}ngOnChanges(){this.init()}nextPage(){this.fetchPage()}init(){const e=this.initiated;this.initiated=true;if(e){this.nextPage()}}};__decorate([s.Input(),__metadata("design:type",String)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"dropDownContainerClass",void 0);__decorate([s.Input(),__metadata("design:type",String)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"dropDownClass",void 0);__decorate([s.Input(),__metadata("design:type",Object)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"distance",void 0);__decorate([s.Input(),__metadata("design:type",Function)],t.PersonalizationsmarteditInfiniteScrollingComponent.prototype,"fetchPage",void 0);t.PersonalizationsmarteditInfiniteScrollingComponent=__decorate([s.Component({selector:"personalization-infinite-scrolling",template:`<div [ngClass]="dropDownContainerClass" persoInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div [ngClass]="dropDownClass"><ng-content></ng-content></div></div>`})],t.PersonalizationsmarteditInfiniteScrollingComponent);window.__smartedit__.addDecoratorPayload("Component","PersonalizationPreventParentScrollComponent",{selector:"personalization-prevent-parent-scroll",template:`<div persoPreventParentScroll><ng-content></ng-content></div>`});t.PersonalizationPreventParentScrollComponent=class PersonalizationPreventParentScrollComponent{};t.PersonalizationPreventParentScrollComponent=__decorate([s.Component({selector:"personalization-prevent-parent-scroll",template:`<div persoPreventParentScroll><ng-content></ng-content></div>`})],t.PersonalizationPreventParentScrollComponent);t.PersonalizationPreventParentScrollDirective=class PersonalizationPreventParentScrollDirective{constructor(e){this.element=e;this.mouseWheelEventHandler=e=>this.onMouseWheel(e)}ngOnInit(){const e=this.element.nativeElement;e.addEventListener("mousewheel",this.mouseWheelEventHandler);e.addEventListener("DOMMouseScroll",this.mouseWheelEventHandler)}ngOnDestroy(){const e=this.element.nativeElement;e.removeEventListener("mousewheel",this.mouseWheelEventHandler);e.removeEventListener("DOMMouseScroll",this.mouseWheelEventHandler)}onMouseWheel(e){const t=this.element.nativeElement;const o=e.originalEvent&&(e.originalEvent.wheelDeltaY||e.originalEvent.wheelDelta);const n=-(e.deltaY||e.delta)||0;t.parentElement.parentElement.parentElement.scrollTop-=e.wheelDeltaY||o||e.wheelDelta||n;e.stopPropagation();e.preventDefault();e.returnValue=false}};t.PersonalizationPreventParentScrollDirective=__decorate([s.Directive({selector:"[persoPreventParentScroll]"}),__param(0,s.Inject(s.ElementRef)),__metadata("design:paramtypes",[s.ElementRef])],t.PersonalizationPreventParentScrollDirective);window.__smartedit__.addDecoratorPayload("Component","ScrollZoneComponent",{selector:"personalizationsmartedit-scroll-zone",template:`<ng-template #scrollZoneBody><personalizationsmartedit-scroll-zone-body-container><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneTop" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--top']" (scrollZoneBodyMouseenter)="onScrollTopMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneBottom" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--bottom']" (scrollZoneBodyMouseenter)="onScrollBottomMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body></personalizationsmartedit-scroll-zone-body-container></ng-template>`});t.ScrollZoneComponent=class ScrollZoneComponent{constructor(e,t){this.viewContainerRef=e;this.document=t;this.scrollZoneTop=false;this.scrollZoneBottom=false;this.scrollZoneVisible=false;this.isTransparent=false}ngAfterViewInit(){if(this.scrollZoneVisible){this.createScrollZoneBody()}}ngOnChanges(e){const t=e.scrollZoneVisible;if(t&&!t.firstChange){if(t.currentValue){this.createScrollZoneBody()}else{this.destroyScrollZoneBody()}}}ngOnDestroy(){this.destroyScrollZoneBody()}onScrollTopMouseenter(){this.isScrolling=true;this.scrollTop()}onScrollBottomMouseenter(){this.isScrolling=true;this.scrollBottom()}stopScroll(){this.isScrolling=false;clearTimeout(this.scrollZoneTopTimeout);clearTimeout(this.scrollZoneBottomTimeout)}scrollTop(){if(!this.isScrolling){clearTimeout(this.scrollZoneTopTimeout);return}this.scrollZoneTop=this.elementToScroll.scrollTop()<=2?false:true;this.scrollZoneBottom=true;this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()-15);this.scrollZoneTopTimeout=setTimeout((()=>{this.scrollTop()}),100)}scrollBottom(){if(!this.isScrolling){clearTimeout(this.scrollZoneBottomTimeout);return}this.scrollZoneTop=true;const e=this.elementToScroll.get(0).scrollHeight-this.elementToScroll.scrollTop();this.scrollZoneBottom=Math.abs(e-this.elementToScroll.outerHeight())<2?false:true;this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()+15);this.scrollZoneBottomTimeout=setTimeout((()=>{this.scrollBottom()}),100)}createScrollZoneBody(){if(this.viewRef){return}this.viewRef=this.viewContainerRef.createEmbeddedView(this.scrollZoneBody);const e=this.viewRef.rootNodes[0];this.document.body.appendChild(e);this.scrollZoneTop=true;this.scrollZoneBottom=true}destroyScrollZoneBody(){if(!this.viewRef){return}this.viewRef.destroy();this.viewRef=null}};__decorate([s.Input(),__metadata("design:type",Boolean)],t.ScrollZoneComponent.prototype,"scrollZoneVisible",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],t.ScrollZoneComponent.prototype,"isTransparent",void 0);__decorate([s.Input(),__metadata("design:type",Object)],t.ScrollZoneComponent.prototype,"elementToScroll",void 0);__decorate([s.ViewChild("scrollZoneBody",{static:true}),__metadata("design:type",s.TemplateRef)],t.ScrollZoneComponent.prototype,"scrollZoneBody",void 0);t.ScrollZoneComponent=__decorate([s.Component({selector:"personalizationsmartedit-scroll-zone",template:`<ng-template #scrollZoneBody><personalizationsmartedit-scroll-zone-body-container><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneTop" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--top']" (scrollZoneBodyMouseenter)="onScrollTopMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body><personalizationsmartedit-scroll-zone-body [hidden]="!scrollZoneBottom" [isTransparent]="isTransparent" [additionalClasses]="['perso__scrollzone--bottom']" (scrollZoneBodyMouseenter)="onScrollBottomMouseenter()" (scrollZoneBodyMouseleave)="stopScroll()"></personalizationsmartedit-scroll-zone-body></personalizationsmartedit-scroll-zone-body-container></ng-template>`}),__param(1,s.Inject(n.DOCUMENT)),__metadata("design:paramtypes",[s.ViewContainerRef,Document])],t.ScrollZoneComponent);window.__smartedit__.addDecoratorPayload("Component","ScrollZoneBodyComponent",{selector:"personalizationsmartedit-scroll-zone-body",template:`<div class="perso__scrollzone" [ngClass]="cssClasses" (mouseenter)="onMouseenter()" (mouseleave)="onMouseleave()"></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let F=class ScrollZoneBodyComponent{constructor(){this.additionalClasses=[];this.isTransparent=false;this.scrollZoneBodyMouseenter=new s.EventEmitter;this.scrollZoneBodyMouseleave=new s.EventEmitter;this.cssClasses=[]}ngOnChanges(){this.cssClasses=this.getCssClasses(this.isTransparent,this.additionalClasses||[])}onMouseenter(){this.scrollZoneBodyMouseenter.emit()}onMouseleave(){this.scrollZoneBodyMouseleave.emit()}getCssClasses(e,t){const o=e?"perso__scrollzone--transparent":"perso__scrollzone--normal";return[o,...t]}};__decorate([s.Input(),__metadata("design:type",Array)],F.prototype,"additionalClasses",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],F.prototype,"isTransparent",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],F.prototype,"scrollZoneBodyMouseenter",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],F.prototype,"scrollZoneBodyMouseleave",void 0);F=__decorate([s.Component({selector:"personalizationsmartedit-scroll-zone-body",template:`<div class="perso__scrollzone" [ngClass]="cssClasses" (mouseenter)="onMouseenter()" (mouseleave)="onMouseleave()"></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[])],F);window.__smartedit__.addDecoratorPayload("Component","ScrollZoneBodyContainerComponent",{selector:"personalizationsmartedit-scroll-zone-body-container",template:`<ng-content></ng-content>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let V=class ScrollZoneBodyContainerComponent{};V=__decorate([s.Component({selector:"personalizationsmartedit-scroll-zone-body-container",template:`<ng-content></ng-content>`,changeDetection:s.ChangeDetectionStrategy.OnPush})],V);t.ScrollZoneModule=class ScrollZoneModule{};t.ScrollZoneModule=__decorate([s.NgModule({imports:[n.CommonModule,r.TranslationModule.forChild()],providers:[],declarations:[t.ScrollZoneComponent,V,F],entryComponents:[t.ScrollZoneComponent],exports:[F,t.ScrollZoneComponent]})],t.ScrollZoneModule);class IPersonalizationsmarteditContextMenuServiceProxy{openDeleteAction(e){"proxyFunction";return undefined}openAddAction(e){"proxyFunction";return undefined}openEditAction(e){"proxyFunction";return undefined}openEditComponentAction(e){"proxyFunction";return undefined}}class IPersonalizationsmarteditContextServiceProxy{setPersonalization(e){"proxyFunction";return undefined}setCustomize(e){"proxyFunction";return undefined}setCombinedView(e){"proxyFunction";return undefined}setSeData(e){"proxyFunction";return undefined}}class PaginationHelper{constructor(e={}){this.count=e.count||0;this.page=e.page||0;this.totalCount=e.totalCount||0;this.totalPages=e.totalPages||0}reset(){this.count=50;this.page=-1;this.totalPages=1;this.totalCount=0}getCount(){return this.count}getPage(){return this.page}getTotalCount(){return this.totalCount}getTotalPages(){return this.totalPages}isLastPage(){return this.getPage()===this.getTotalPages()}}class PersonalizationsmarteditCommerceCustomizationService{constructor(){this.nonCommerceActionTypes=["cxCmsActionData"];this.types=[]}isNonCommerceAction(e){return this.nonCommerceActionTypes.some((t=>t===e.type))}isCommerceAction(e){return!this.isNonCommerceAction(e)}isTypeEnabled(e,t){return t!==undefined&&t!==null&&t[e.confProperty]===true}registerType(e){const t=e.type;let o=false;this.types.forEach((e=>{if(e.type===t){o=true}}));if(!o){this.types.push(e)}}getAvailableTypes(e){return this.types.filter((t=>this.isTypeEnabled(t,e)))}isCommerceCustomizationEnabled(e){const t=this.getAvailableTypes(e);return t.length>0}getNonCommerceActionsCount(e){return(e.actions||[]).filter(this.isNonCommerceAction,this).length}getCommerceActionsCountMap(e){const t={};(e.actions||[]).filter(this.isCommerceAction,this).forEach((e=>{const o=e.type.toLowerCase();let n=t[o];if(n===undefined){n=1}else{n+=1}t[o]=n}));return t}getCommerceActionsCount(e){return(e.actions||[]).filter(this.isCommerceAction,this).length}}t.PersonalizationsmarteditMessageHandler=class PersonalizationsmarteditMessageHandler{constructor(e){this.alertService=e}sendInformation(e){this.alertService.showInfo(e)}sendError(e){this.alertService.showDanger(e)}sendWarning(e){this.alertService.showWarning(e)}sendSuccess(e){this.alertService.showSuccess(e)}};t.PersonalizationsmarteditMessageHandler.$inject=["alertService"];t.PersonalizationsmarteditMessageHandler=__decorate([r.SeDowngradeService(),__metadata("design:paramtypes",[r.IAlertService])],t.PersonalizationsmarteditMessageHandler);t.PersonalizationsmarteditUtils=class PersonalizationsmarteditUtils{constructor(e,t,o){this.translateService=e;this.l10nPipe=t;this.catalogService=o}pushToArrayIfValueExists(e,t,o){if(o){e.push({key:t,value:o})}}getVariationCodes(e){if(typeof e===undefined||e===null){return[]}const t=e.map((e=>e.code)).filter((e=>typeof e!=="undefined"));return t}getVariationKey(e,t){if(e===undefined||t===undefined){return[]}const o=t.map((t=>({variationCode:t.code,customizationCode:e,catalog:t.catalog,catalogVersion:t.catalogVersion})));return o}getSegmentTriggerForVariation(e){const t=e.triggers||[];const o=t.filter((e=>e.type==="segmentTriggerData"));if(o.length===0){return{}}return o[0]}isPersonalizationItemEnabled(e){return e.status===t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED}getEnablementTextForCustomization(e,t){t=t||"personalization";if(this.isPersonalizationItemEnabled(e)){return this.translateService.instant(t+".customization.enabled")}else{return this.translateService.instant(t+".customization.disabled")}}getEnablementTextForVariation(e,t){t=t||"personalization";if(this.isPersonalizationItemEnabled(e)){return this.translateService.instant(t+".variation.enabled")}else{return this.translateService.instant(t+".variation.disabled")}}getEnablementActionTextForVariation(e,t){t=t||"personalization";if(this.isPersonalizationItemEnabled(e)){return this.translateService.instant(t+".variation.options.disable")}else{return this.translateService.instant(t+".variation.options.enable")}}getActivityStateForCustomization(e){if(e.status===t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED){const t=new Date(e.enabledStartDate);const o=new Date(e.enabledEndDate);const n=v["default"](t).isValid();const s=v["default"](o).isValid();if(!n&&!s||n&&!s&&v["default"]().isAfter(t,"minute")||!n&&s&&v["default"]().isBefore(o,"minute")||v["default"]().isBetween(t,o,"minute","[]")){return"perso__status--enabled"}else{return"perso__status--ignore"}}else{return"perso__status--disabled"}}getActivityStateForVariation(e,t){if(t.enabled){return this.getActivityStateForCustomization(e)}else{return"perso__status--disabled"}}isItemVisible(e){return e.status!==t.PERSONALIZATION_MODEL_STATUS_CODES.DELETED}getVisibleItems(e){return e.filter((e=>this.isItemVisible(e)))}getValidRank(e,t,o){const n=e.indexOf(t);const s=o<0?-1:1;let a=n+o;while(a>=0&&a<e.length&&!this.isItemVisible(e[a])){a+=s}a=a>=e.length?e.length-1:a;a=a<0?0:a;return e[a].rank}getStatusesMapping(){const e=[];e.push({code:C.ALL,text:"personalization.context.status.all",modelStatuses:[t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,t.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]});e.push({code:C.ENABLED,text:"personalization.context.status.enabled",modelStatuses:[t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED]});e.push({code:C.DISABLED,text:"personalization.context.status.disabled",modelStatuses:[t.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]});return e}getClassForElement(e){const t=e%Object.keys(b).length;return b[t].listClass}getLetterForElement(e){const t=e%Object.keys(b).length;return String.fromCharCode("a".charCodeAt(0)+t).toUpperCase()}getCommerceCustomizationTooltip(e,t,o){t=t||"";o=o||"\n";let n="";g.forEach(e.commerceCustomizations,((e,s)=>{n+=t+this.translateService.instant("personalization.modal.manager.commercecustomization."+s)+": "+e+o}));return n}getCommerceCustomizationTooltipHTML(e){return this.getCommerceCustomizationTooltip(e,"<div>","</div>")}isItemFromCurrentCatalog(e,t){const o=t.seExperienceData.catalogDescriptor;return e.catalog===o.catalogId&&e.catalogVersion===o.catalogVersion}hasCommerceActions(e){return e.numberOfCommerceActions>0}getCatalogVersionNameByUuid(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.getCatalogVersionByUuid(e);let o=yield this.l10nPipe.transform(t.catalogName).pipe(u.take(1)).toPromise();o=o+" ("+t.version+")";return o}))}getAndSetCatalogVersionNameL10N(e){return __awaiter(this,void 0,void 0,(function*(){e.catalogVersionNameL10N=yield this.getCatalogVersionNameByUuid(e.catalog+"/"+e.catalogVersion)}))}uniqueArray(e,t,o){o=o||"code";t.forEach((t=>{if(!e.some((e=>e[o]===t[o]))){e.push(t)}}));return e}};t.PersonalizationsmarteditUtils.$inject=["translateService","l10nPipe","catalogService"];t.PersonalizationsmarteditUtils=__decorate([r.SeDowngradeService(),__metadata("design:paramtypes",[p.TranslateService,r.L10nPipe,r.ICatalogService])],t.PersonalizationsmarteditUtils);class Customize{constructor(){this.enabled=false;this.selectedCustomization=null;this.selectedVariations=null;this.selectedComponents=null}}class CombinedView{constructor(){this.enabled=false;this.selectedItems=null;this.customize=new Customize}}class Personalization{constructor(){this.enabled=false}}class SeData{constructor(){this.pageId=null;this.seExperienceData=null;this.seConfigurationData=null}}t.PersonalizationsmarteditContextUtils=class PersonalizationsmarteditContextUtils{getContextObject(){return{personalization:new Personalization,customize:new Customize,combinedView:new CombinedView,seData:new SeData}}clearCustomizeContext(e){const t=e.getCustomize();t.enabled=false;t.selectedCustomization=null;t.selectedVariations=null;t.selectedComponents=null;e.setCustomize(t)}clearCustomizeContextAndReloadPreview(e,t){const o=g.cloneDeep(t.getCustomize().selectedVariations);this.clearCustomizeContext(t);if(g.isObject(o)&&!g.isArray(o)){e.removePersonalizationDataFromPreview()}}clearCombinedViewCustomizeContext(e){const t=e.getCombinedView();t.customize.enabled=false;t.customize.selectedCustomization=null;t.customize.selectedVariations=null;t.customize.selectedComponents=null;if(g.isArray(t.selectedItems)){t.selectedItems.forEach((e=>{delete e.highlighted}))}e.setCombinedView(t)}clearCombinedViewContext(e){const t=e.getCombinedView();t.enabled=false;t.selectedItems=null;e.setCombinedView(t)}clearCombinedViewContextAndReloadPreview(e,t){const o=g.cloneDeep(t.getCombinedView().enabled);const n=g.cloneDeep(t.getCombinedView().selectedItems);this.clearCombinedViewContext(t);if(o&&n){e.removePersonalizationDataFromPreview()}}};t.PersonalizationsmarteditContextUtils=__decorate([r.SeDowngradeService()],t.PersonalizationsmarteditContextUtils);t.PersonalizationsmarteditCommonsComponentsModule=class PersonalizationsmarteditCommonsComponentsModule{};t.PersonalizationsmarteditCommonsComponentsModule=__decorate([s.NgModule({imports:[r.TranslationModule.forChild(),n.CommonModule,r.L10nPipeModule,t.DatetimePickerRangeModule,t.ScrollZoneModule],providers:[{provide:"PaginationHelper",useFactory:()=>e=>new PaginationHelper(e)},r.L10nPipe,t.PersonalizationsmarteditUtils,t.PersonalizationsmarteditDateUtils,t.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditMessageHandler,PersonalizationsmarteditCommerceCustomizationService],declarations:[t.PersonalizationInfiniteScrollDirective,t.PersonalizationPreventParentScrollDirective,t.PersonalizationsmarteditInfiniteScrollingComponent,t.PersonalizationPreventParentScrollComponent],entryComponents:[t.PersonalizationsmarteditInfiniteScrollingComponent,t.PersonalizationPreventParentScrollComponent],exports:[t.PersonalizationInfiniteScrollDirective,t.PersonalizationPreventParentScrollDirective,t.PersonalizationsmarteditInfiniteScrollingComponent,t.PersonalizationPreventParentScrollComponent]})],t.PersonalizationsmarteditCommonsComponentsModule);var U;t.BaseSiteHeaderInterceptor=U=class BaseSiteHeaderInterceptor{constructor(e){this.sharedDataService=e}intercept(e,t){if(U.PERSONALIZATION_ENDPOINT.test(e.url)){return m.from(this.sharedDataService.get("experience")).pipe(u.switchMap((o=>{if(o.catalogDescriptor.siteId){const n=e.clone({headers:e.headers.set(U.HEADER_NAME,o.catalogDescriptor.siteId)});return t.handle(n)}return t.handle(e)})))}else{return t.handle(e)}}};t.BaseSiteHeaderInterceptor.HEADER_NAME="Basesite";t.BaseSiteHeaderInterceptor.PERSONALIZATION_ENDPOINT=/\/personalizationwebservices/;t.BaseSiteHeaderInterceptor=U=__decorate([s.Injectable(),__metadata("design:paramtypes",[r.ISharedDataService])],t.BaseSiteHeaderInterceptor);(function(e){e["AND"]="AND";e["OR"]="OR";e["NOT"]="NOT"})(t.TriggerActionId||(t.TriggerActionId={}));(function(e){e["DEFAULT_TRIGGER"]="defaultTriggerData";e["SEGMENT_TRIGGER"]="segmentTriggerData";e["EXPRESSION_TRIGGER"]="expressionTriggerData";e["GROUP_EXPRESSION"]="groupExpressionData";e["SEGMENT_EXPRESSION"]="segmentExpressionData";e["NEGATION_EXPRESSION"]="negationExpressionData";e["CONTAINER_TYPE"]="container";e["ITEM_TYPE"]="item";e["DROPZONE_TYPE"]="dropzone"})(t.TriggerType||(t.TriggerType={}));const $=new s.InjectionToken("PERSONLIZATION_SEARCH_EXTENSION_TOKEN");const K=new s.InjectionToken("PERSONLIZATION_SEARCH_EXTENSION_INJECTOR_TOKEN");const Y=new s.InjectionToken("PERSONLIZATION_PROMOTION_EXTENSION_TOKEN");const X=new s.InjectionToken("PERSONLIZATION_PROMOTION_EXTENSION_INJECTOR_TOKEN");t.COMBINED_VIEW_TOOLBAR_ITEM_KEY=I;t.COMPONENT_CONTAINER_TYPE=A;t.CONTAINER_SOURCE_ID_ATTR=O;t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS=D;t.CUSTOMIZATION_VARIATION_MANAGEMENT_SEGMENTTRIGGER_GROUPBY=k;t.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS=x;t.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY=w;t.CombinedView=CombinedView;t.Customize=Customize;t.DATE_CONSTANTS=S;t.IPersonalizationsmarteditContextMenuServiceProxy=IPersonalizationsmarteditContextMenuServiceProxy;t.IPersonalizationsmarteditContextServiceProxy=IPersonalizationsmarteditContextServiceProxy;t.PERSONALIZATION_CATALOG_FILTER=P;t.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING=b;t.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES=E;t.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER=T;t.PERSONALIZATION_DATE_FORMATS=f;t.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES=C;t.PERSONLIZATION_PROMOTION_EXTENSION_INJECTOR_TOKEN=X;t.PERSONLIZATION_PROMOTION_EXTENSION_TOKEN=Y;t.PERSONLIZATION_SEARCH_EXTENSION_INJECTOR_TOKEN=K;t.PERSONLIZATION_SEARCH_EXTENSION_TOKEN=$;t.PaginationHelper=PaginationHelper;t.Personalization=Personalization;t.PersonalizationsmarteditCommerceCustomizationService=PersonalizationsmarteditCommerceCustomizationService;t.SeData=SeData},502:function(e,t){function webpackEmptyAsyncContext(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");t.code="MODULE_NOT_FOUND";throw t}))}webpackEmptyAsyncContext.keys=function(){return[]};webpackEmptyAsyncContext.resolve=webpackEmptyAsyncContext;e.exports=webpackEmptyAsyncContext;webpackEmptyAsyncContext.id=502},584:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});o(585);o(601);o(627);o(631);o(633);o(635);o(649);o(668);o(695);o(703);o(733);o(739);o(741);o(743);o(744);o(745);o(784);o(790);o(804);o(366);o(814);o(815);o(816);o(817);window.jQuery=o(219);o(274);o(819);o(822);o(823);o(182);o(947);o(948);o(949);o(950);o(952);o(953);o(955);o(956);o(957);o(958);o(960);o(961)},819:function(e,t,o){(function(e,t){if(!window.smarteditJQuery&&e&&e.noConflict){window.smarteditJQuery=e.noConflict()}window.smarteditLodash=t.noConflict();o(820)}).call(this,o(219),o(93))},821:function(e,t,o){var n={"./af":367,"./af.js":367,"./ar":368,"./ar-dz":369,"./ar-dz.js":369,"./ar-kw":370,"./ar-kw.js":370,"./ar-ly":371,"./ar-ly.js":371,"./ar-ma":372,"./ar-ma.js":372,"./ar-sa":373,"./ar-sa.js":373,"./ar-tn":374,"./ar-tn.js":374,"./ar.js":368,"./az":375,"./az.js":375,"./be":376,"./be.js":376,"./bg":377,"./bg.js":377,"./bm":378,"./bm.js":378,"./bn":379,"./bn-bd":380,"./bn-bd.js":380,"./bn.js":379,"./bo":381,"./bo.js":381,"./br":382,"./br.js":382,"./bs":383,"./bs.js":383,"./ca":384,"./ca.js":384,"./cs":385,"./cs.js":385,"./cv":386,"./cv.js":386,"./cy":387,"./cy.js":387,"./da":388,"./da.js":388,"./de":389,"./de-at":390,"./de-at.js":390,"./de-ch":391,"./de-ch.js":391,"./de.js":389,"./dv":392,"./dv.js":392,"./el":393,"./el.js":393,"./en-au":394,"./en-au.js":394,"./en-ca":395,"./en-ca.js":395,"./en-gb":396,"./en-gb.js":396,"./en-ie":397,"./en-ie.js":397,"./en-il":398,"./en-il.js":398,"./en-in":399,"./en-in.js":399,"./en-nz":400,"./en-nz.js":400,"./en-sg":401,"./en-sg.js":401,"./eo":402,"./eo.js":402,"./es":403,"./es-do":404,"./es-do.js":404,"./es-mx":405,"./es-mx.js":405,"./es-us":406,"./es-us.js":406,"./es.js":403,"./et":407,"./et.js":407,"./eu":408,"./eu.js":408,"./fa":409,"./fa.js":409,"./fi":410,"./fi.js":410,"./fil":411,"./fil.js":411,"./fo":412,"./fo.js":412,"./fr":413,"./fr-ca":414,"./fr-ca.js":414,"./fr-ch":415,"./fr-ch.js":415,"./fr.js":413,"./fy":416,"./fy.js":416,"./ga":417,"./ga.js":417,"./gd":418,"./gd.js":418,"./gl":419,"./gl.js":419,"./gom-deva":420,"./gom-deva.js":420,"./gom-latn":421,"./gom-latn.js":421,"./gu":422,"./gu.js":422,"./he":423,"./he.js":423,"./hi":424,"./hi.js":424,"./hr":425,"./hr.js":425,"./hu":426,"./hu.js":426,"./hy-am":427,"./hy-am.js":427,"./id":428,"./id.js":428,"./is":429,"./is.js":429,"./it":430,"./it-ch":431,"./it-ch.js":431,"./it.js":430,"./ja":432,"./ja.js":432,"./jv":433,"./jv.js":433,"./ka":434,"./ka.js":434,"./kk":435,"./kk.js":435,"./km":436,"./km.js":436,"./kn":437,"./kn.js":437,"./ko":438,"./ko.js":438,"./ku":439,"./ku.js":439,"./ky":440,"./ky.js":440,"./lb":441,"./lb.js":441,"./lo":442,"./lo.js":442,"./lt":443,"./lt.js":443,"./lv":444,"./lv.js":444,"./me":445,"./me.js":445,"./mi":446,"./mi.js":446,"./mk":447,"./mk.js":447,"./ml":448,"./ml.js":448,"./mn":449,"./mn.js":449,"./mr":450,"./mr.js":450,"./ms":451,"./ms-my":452,"./ms-my.js":452,"./ms.js":451,"./mt":453,"./mt.js":453,"./my":454,"./my.js":454,"./nb":455,"./nb.js":455,"./ne":456,"./ne.js":456,"./nl":457,"./nl-be":458,"./nl-be.js":458,"./nl.js":457,"./nn":459,"./nn.js":459,"./oc-lnc":460,"./oc-lnc.js":460,"./pa-in":461,"./pa-in.js":461,"./pl":462,"./pl.js":462,"./pt":463,"./pt-br":464,"./pt-br.js":464,"./pt.js":463,"./ro":465,"./ro.js":465,"./ru":466,"./ru.js":466,"./sd":467,"./sd.js":467,"./se":468,"./se.js":468,"./si":469,"./si.js":469,"./sk":470,"./sk.js":470,"./sl":471,"./sl.js":471,"./sq":472,"./sq.js":472,"./sr":473,"./sr-cyrl":474,"./sr-cyrl.js":474,"./sr.js":473,"./ss":475,"./ss.js":475,"./sv":476,"./sv.js":476,"./sw":477,"./sw.js":477,"./ta":478,"./ta.js":478,"./te":479,"./te.js":479,"./tet":480,"./tet.js":480,"./tg":481,"./tg.js":481,"./th":482,"./th.js":482,"./tk":483,"./tk.js":483,"./tl-ph":484,"./tl-ph.js":484,"./tlh":485,"./tlh.js":485,"./tr":486,"./tr.js":486,"./tzl":487,"./tzl.js":487,"./tzm":488,"./tzm-latn":489,"./tzm-latn.js":489,"./tzm.js":488,"./ug-cn":490,"./ug-cn.js":490,"./uk":491,"./uk.js":491,"./ur":492,"./ur.js":492,"./uz":493,"./uz-latn":494,"./uz-latn.js":494,"./uz.js":493,"./vi":495,"./vi.js":495,"./x-pseudo":496,"./x-pseudo.js":496,"./yo":497,"./yo.js":497,"./zh-cn":498,"./zh-cn.js":498,"./zh-hk":499,"./zh-hk.js":499,"./zh-mo":500,"./zh-mo.js":500,"./zh-tw":501,"./zh-tw.js":501};function webpackContext(e){var t=webpackContextResolve(e);return o(t)}function webpackContextResolve(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");t.code="MODULE_NOT_FOUND";throw t}return n[e]}webpackContext.keys=function webpackContextKeys(){return Object.keys(n)};webpackContext.resolve=webpackContextResolve;e.exports=webpackContext;webpackContext.id=821},822:function(e,t,o){},823:function(e,t,o){},824:function(e,t,o){"use strict";CacheConfigAnnotationFactory.$inject=["logService"];CachedAnnotationFactory.$inject=["cacheService"];InvalidateCacheAnnotationFactory.$inject=["cacheService"];OperationContextAnnotationFactory.$inject=["injector","operationContextService","OPERATION_CONTEXT"];Object.defineProperty(t,"__esModule",{value:true});var n=o(93);var s=o(825);var a=o(0);var r=o(133);var d=o(42);var p=o(46);var m=o(105);var g=o(20);var u=o(136);var v=o(4);class CloneableUtils{makeCloneable(e){const t=n.cloneDeepWith(e,(t=>{if(this._isValueCloneable(t,e)){return this._getCloneableValue(t)}return t}));if(t===undefined||t===null||this.isPrimitive(t)){return t}if(t.hasOwnProperty("length")||t.forEach){return t.map((e=>this.makeCloneable(e)))}return Object.keys(t).reduce(((e,o)=>{if(o.indexOf("$")!==0){e[o]=this.makeCloneable(t[o])}return e}),{})}_isValueCloneable(e,t){return e!==undefined&&e!==null&&!this.isPrimitive(t)}_getCloneableValue(e){if(typeof e==="function"){return null}if(e.then){return null}if(n.isElement(e)){return null}if(typeof e!=="string"&&e.hasOwnProperty("length")&&!e.forEach){return null}return e}isPrimitive(e){return typeof e==="number"||typeof e==="string"||typeof e==="boolean"}}const f=new CloneableUtils;class StringUtils{constructor(){this.sanitize=e=>!this.isBlank(e)?e.split("").reverse().join("").replace(/(?:(([()])(?!\\)))/g,"$1\\").split("").reverse().join(""):e;this.encode=e=>btoa(encodeURIComponent(JSON.stringify(e)).replace(/%([0-9A-F]{2})/g,(function toSolidBytes(e,t){return String.fromCharCode(parseInt(t,16))})));this.replaceAll=(e,t)=>{const o=new RegExp(Object.keys(t).join("|"),"g");return e.replace(o,(function(e){return t[e]}))}}isBlank(e){return typeof e==="undefined"||e===null||e==="null"||e.toString().trim().length===0}regExpFactory(e){const t=new RegExp(/^[a-zA-Z\d]+$/i);const o=new RegExp(/^[a-zA-Z\d\*]+$/i);let n;if(t.test(e)){n=["^","$"].join(e)}else if(o.test(e)){n=["^","$"].join(e.replace(/\*/g,".*"))}else{n=e}return new RegExp(n,"g")}formatHTML(e){return e.replace(/^\s*\n/gm,"").replace(/\>[\t\s]+\</g,"><").replace(/[\r\n\t\s]+/g," ")}}const S=new StringUtils;class URIBuilder{constructor(e){this.uri=e;this.wholeWordMatch="[\\w]+"}build(){return this.uri}replaceParams(e){const t=n.cloneDeep(this);if(e){t.uri=Object.keys(e).sort((function(e,t){return t.length-e.length})).reduce(((t,o)=>this.substituteKeyForValue(t,o,e[o])),t.uri)}return t}sanitize(){const e=n.cloneDeep(this);const t=/(https?:\/\/[^\/]*)(\/.*)/.exec(e.uri);e.uri=t==null?e.uri:t[2];e.uri=this.substituteKeyForValue(e.uri,this.wholeWordMatch,"").replace(/\/\//,"/").replace(/\/\?/,"?").replace(/\/$/,"");e.uri=t==null?e.uri:t[1]+e.uri;return e}substituteKeyForValue(e,t,o){e=e.replace(new RegExp(":"+t+"/"),`${o||""}/`).replace(new RegExp(":"+t+"$"),`${o||""}`).replace(new RegExp(":"+t+"\\?"),`${o||""}?`).replace(new RegExp(":"+t+"&"),`${o||""}&`);if(t!==this.wholeWordMatch&&t.includes("_")){const n=e.includes("?")?e.substr(0,e.indexOf("?")):e;const s=n.replace(new RegExp("\\b"+t+"\\b"),`${o||""}`);e=e.includes("?")?s+e.substr(e.indexOf("?")):s}return e}}class UrlUtils{getOrigin(e){if(e){let t=document.createElement("a");t.setAttribute("href",e);const o=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"");t=null;return o}else{return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}}getURI(e){return e&&e.indexOf("?")>-1?e.split("?")[0]:e}updateUrlParameter(e,t,o){const n=e.indexOf("#");const s=n===-1?"":e.substr(n);e=n===-1?e:e.substr(0,n);const a=new RegExp("([?&])"+t+"=.*?(&|$)","i");const r=e.indexOf("?")!==-1?"&":"?";if(e.match(a)){e=e.replace(a,"$1"+t+"="+o+"$2")}else{e=e+r+t+"="+o}return e+s}getQueryString(e){let t="";if(e){for(const o in e){if(e.hasOwnProperty(o)){(n.isArray(e[o])?e[o]:[e[o]]).forEach((e=>{t+="&"+encodeURIComponent(o)+"="+encodeURIComponent(e)}))}}}return"?"+(!S.isBlank(t)?t.substring(1):t)}parseQuery(e){const t={};e.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),(function(e,o,n,s){t[o]=s}));return t}getAbsoluteURL(e,t){const o=new RegExp("([a-zA-Z0-9]+://)"+"([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?"+"([a-zA-Z0-9.-]+)"+"|([0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+)"+"(:[0-9]+)?"+"(/.*)?");return o.exec(t)?t:e+t}}const C=new UrlUtils;class CryptographicUtils{sha1Hash(e){return s.SHA1(e).toString()}aesBase64Encrypt(e,t){return s.AES.encrypt(s.enc.Base64.parse(e),t).toString()}aesDecrypt(e,t){return s.AES.decrypt(e,t).toString(s.enc.Utf8)}}class FunctionsUtils{constructor(){this.signatureArgsRegexp=/function[\s\w]*\(([\w\s\$,]*)\)[\s]*{/}isEmpty(e){const t=e.toString().match(/\{([\s\S]*)\}/m);return!t||t[1].trim()===""||/(proxyFunction)/g.test(e.toString().replace(/\s/g,""))}getArguments(e){const t=this.signatureArgsRegexp.exec(e.toString());if(t){return t[1].replace(/\s/g,"").split(",")}else{throw new Error(`failed to retrieve arguments list of ${e}`)}}hasArguments(e){const t=this.signatureArgsRegexp.exec(e.toString());if(t){return!n.isEmpty(t[1])}else{throw new Error(`failed to retrieve arguments list of ${e}`)}}getConstructorName(e){let t=e.name;if(!t){const o=/function (\$?\w+)\s*\(/.exec(e.toString());if(o){t=o[1]}else{throw new Error("[FunctionsUtils] - Cannot get name from invalid constructor.")}}return t}getInstanceConstructorName(e){return this.getConstructorName(Object.getPrototypeOf(e).constructor)}extendsConstructor(e,t){const newConstructor=function(...e){return new t(...e)};newConstructor.prototype=e.prototype;Object.entries(Object.getOwnPropertyDescriptors(e)).filter((([,e])=>e.writable)).forEach((([t])=>{newConstructor[t]=e[t]}));return newConstructor}getInstanceMethods(e){const isGetter=(e,t)=>!!e.__lookupGetter__(t);let t=[];const o=e;const onlyOriginalMethods=(e,n,s)=>!isGetter(o,e)&&typeof o[e]==="function"&&e!=="constructor"&&(n===0||e!==s[n-1])&&t.indexOf(e)===-1;do{const o=Object.getOwnPropertyNames(e).sort().filter(onlyOriginalMethods);t=t.concat(o);e=Object.getPrototypeOf(e)}while(e&&Object.getPrototypeOf(e));return t}isUnitTestMode(){return typeof window.__karma__!=="undefined"}assertFail(){const e=jasmine.createSpy("TestShouldNotReachThatPart-CheckYourTryCatchBlock");expect(e).toHaveBeenCalled()}convertToArray(e){return Object.keys(e).reduce(((t,o)=>[...t||[],{key:o,value:e[o]}]),[])}}const b=new FunctionsUtils;const I=new a.NgZone({enableLongStackTrace:false});class WindowUtils{constructor(e){this.ngZone=e;this.isIframe=()=>this.getWindow().top!==this.getWindow();this.ngZone=this.ngZone||I}getWindow(){return window}runTimeoutOutsideAngular(e,t){const o=this.ngZone;if(o!==undefined){return o.runOutsideAngular((()=>setTimeout((()=>o.run(e)),t)))}else{throw new Error("this instance of WindowUtils has not been instantiated through Angular 7 DI")}}runIntervalOutsideAngular(e,t){const o=this.ngZone;if(o===undefined){throw new Error("this instance of WindowUtils has not been instantiated through Angular 7 DI")}return o.runOutsideAngular((()=>setInterval((()=>o.run(e)),t)))}}WindowUtils.SMARTEDIT_IFRAME_ID="ySmartEditFrame";const w=new WindowUtils;function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}t.ModuleUtils=class ModuleUtils{initialize(e,t=[]){return{provide:a.APP_INITIALIZER,useFactory(){e.apply(undefined,Array.prototype.slice.call(arguments));return e=>{}},deps:t,multi:true}}bootstrap(e,t=[]){return{provide:a.APP_BOOTSTRAP_LISTENER,useFactory(){e.apply(undefined,Array.prototype.slice.call(arguments));return e=>{}},deps:t,multi:true}}provideValues(e){const t=e||{};return Object.keys(t).map((e=>({provide:e,useValue:t[e]})))}};t.ModuleUtils=__decorate([a.Injectable()],t.ModuleUtils);const E=new t.ModuleUtils;(function(e){e[e["log"]=0]="log";e[e["debug"]=1]="debug";e[e["info"]=2]="info";e[e["warn"]=3]="warn";e[e["error"]=4]="error"})(t.LogLevel||(t.LogLevel={}));class LogService{constructor(){this.logLevel=t.LogLevel.info}log(...e){this._log(t.LogLevel.log,e)}debug(...e){this._log(t.LogLevel.debug,e)}info(...e){this._log(t.LogLevel.info,e)}warn(...e){this._log(t.LogLevel.warn,e)}error(...e){this._log(t.LogLevel.error,e)}setLogLevel(e){this.logLevel=e}_log(e,o){if(e>=this.logLevel){const n=t.LogLevel[e];if(this._console()&&this._console()[n]){this._console()[n](...o)}}}_console(){return console}}var T;t.PromiseUtils=T=class PromiseUtils{constructor(){this.WAIT_TIMEOUT=4;this.FAILURE_TIMEOUT=2e3;this.handlePromiseRejections=e=>{const t=e.then;const o=this.defaultFailureCallback;e.then=function(e,n){const s=n?n:o;return t.call(this,e,s)};return e};this.defaultFailureCallback=e=>{if(undefined!==e&&null!==e&&"canceled"!==e){if(n.isPlainObject(e)){if(!this.isAjaxError(e)){T.logService.error(`exception caught in promise: ${JSON.stringify(e)}`)}}else if(!n.isBoolean(e)){T.logService.error(e)}}T.logService.error(`defaultFailureCallback:`,e);return Promise.reject(e)}}toPromise(e,t){return function(){try{return Promise.resolve(e.apply(t,Array.prototype.slice.call(arguments)))}catch(e){T.logService.error("execution of a method that was turned into a promise failed");T.logService.error(e);return Promise.reject(e)}}}promise(e){return this.handlePromiseRejections(new Promise(e))}defer(){let e;let t;const o={promise:this.promise(((o,n)=>{e=o;t=n})),resolve(t){e(t)},reject(e,o){if(o===undefined){t(e)}else{t("")}}};return o}sleep(e){return __awaiter(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}isAjaxError(e){return e.hasOwnProperty("headers")}waitOnCondition(e,t,o,n=0){setTimeout((()=>{if(e()){t()}else if(n<this.FAILURE_TIMEOUT){this.waitOnCondition(e,t,o,n+this.WAIT_TIMEOUT)}else{throw new Error(`PromiseUtils: ${o}`)}}),this.WAIT_TIMEOUT)}resolveToCallbackWhenCondition(e,t,o){return __awaiter(this,void 0,void 0,(function*(){return new Promise((n=>{this.waitOnCondition(e,(()=>n(t())),o?o:"condition for promise resolution was never met")}))}))}attempt(e){return e.then((e=>({error:null,data:e}))).catch((e=>({error:e,data:null})))}};t.PromiseUtils.logService=new LogService;t.PromiseUtils=T=__decorate([a.Injectable()],t.PromiseUtils);const P=new t.PromiseUtils;class BooleanUtils{areAllTruthy(...e){return function(){const t=arguments;return e.every((e=>e&&e.apply(e,t)))}}isAnyTruthy(...e){return function(){const t=arguments;return e.some((e=>e&&e.apply(e,t)))}}}const A=new BooleanUtils;class HttpUtils{isGET(e){return e.method==="GET"}isRequestOfAccept(e,t){return!!e.headers&&!!e.headers.get("Accept")&&(e.headers.get("Accept")||"").includes(t)}isResponseOfContentType(e,t){return!!e.headers&&!!e.headers.get("Content-type")&&(e.headers.get("Content-type")||"").indexOf(t)===0}isHTMLRequest(e,t){return this.isGET(e)&&(this.isRequestOfAccept(e,"text/html")||/.+\.html$/.test(e.url)||/.+\.html\?/.test(e.url))}isJSONRequest(e,t){return this.isGET(e)&&(t&&this.isResponseOfContentType(t,"json")||/.+\.json$/.test(e.url))}isJSRequest(e){return this.isGET(e)&&/.+\.js$/.test(e.url)}isCRUDRequest(e,t){return!this.isHTMLRequest(e,t)&&!this.isJSONRequest(e,t)&&!this.isJSRequest(e)}transformHttpParams(e,t){return new r.HttpParams({fromObject:JSON.parse(S.replaceAll(JSON.stringify(this.copyHttpParamsOrHeaders(e)),t))})}copyHttpParamsOrHeaders(e){const t={};e.keys().forEach((o=>{const n=e.getAll(o);if(n!==null){t[o]=n.length>1?n:n[0]}}));return t}buildHttpResponse(e,t){const o=Promise.resolve(t);return d.from(o).pipe(p.switchMap((t=>{const o=t[0];const s=t[1];const a=e.clone({body:s});n.merge(a,{status:o});if(200<=o&&o<300){return new d.Observable((e=>{e.next(new r.HttpResponse(a))}))}else{return d.throwError(new r.HttpErrorResponse(n.merge(a,{error:s})))}})))}}const O=new HttpUtils;class BaseValueAccessor{constructor(){this.disabled=false;this.value=null}onChange(e){}onTouched(){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled=e}writeValue(e){this.value=e}}var x;(function(e){e["Class"]="ClassAnnotation";e["Method"]="MethodAnnotation"})(x||(x={}));class AnnotationService{constructor(){this.INJECTABLE_NAME_KEY="getInjectableName";this.ORIGINAL_CONSTRUCTOR_KEY="originalConstructor";this.getClassAnnotations=n.memoize(this.getClassAnnotationsLogic);this.getMethodAnnotations=n.memoize(this.getMethodAnnotationsLogic,(function(e,t){return JSON.stringify(e.prototype)+t}));this.functionsUtils=new FunctionsUtils;this.annotationFactoryMap={}}getClassAnnotation(e,t){const o=this.getClassAnnotations(e);const n=t.annotationName;if(o){if(n in o){return o[n]}}else{return null}}getMethodAnnotation(e,t,o){const n=this.getMethodAnnotations(e,t);const s=o.annotationName;if(n){if(s in n){return n[s]}}else{return null}}hasClassAnnotation(e,t){const o=this.getClassAnnotations(e);return t.annotationName in o?true:false}hasMethodAnnotation(e,t,o){const n=this.getMethodAnnotations(e,t);return o.annotationName in n?true:false}setClassAnnotationFactory(e,t){this.annotationFactoryMap[e]=t;return t}getClassAnnotationFactory(e){const t=this;const classAnnotationFactory=function(...o){return function(s){const a=t.functionsUtils.extendsConstructor(s,(function(...n){const a=t.annotationFactoryMap[e];if(a){const e=a(o)(this,s,n);if(e){return e}}else{throw new Error(`annotation '${e}' is used on '${s.name}' but its ClassAnnotationFactory may not have been added to the dependency injection`)}}));n.merge(a,s);a.__annotations__=s.__annotations__;a.__parameters__=s.__parameters__;a.__prop__metadata__=s.__prop__metadata__;Reflect.getMetadataKeys(s).forEach((e=>{Reflect.defineMetadata(e,Reflect.getMetadata(e,s),a)}));const r=t.getOriginalConstructor(s);Reflect.defineMetadata(t.ORIGINAL_CONSTRUCTOR_KEY,r,a);Reflect.defineMetadata(x.Class+":"+e,o,r);return a}};classAnnotationFactory.annotationName=e;return classAnnotationFactory}setMethodAnnotationFactory(e,t){this.annotationFactoryMap[e]=t;return t}getMethodAnnotationFactory(e){const t=this;const methodAnnotationFactory=function(...o){return(n,s,a)=>{const r=a.value;a.value=function(){const n=t.annotationFactoryMap[e];if(n){return r?n(o)(this,s,r.bind(this),arguments):undefined}else{throw new Error(`annotation '${e}' is used but its MethodAnnotationFactory may not have been added to the dependency injection`)}};Reflect.defineMetadata(x.Method+":"+e,o,n,s)}};methodAnnotationFactory.annotationName=e;return methodAnnotationFactory}getOriginalConstructor(e){return Reflect.getMetadata(this.ORIGINAL_CONSTRUCTOR_KEY,e)||e}getClassAnnotationsLogic(e){const t=this.getOriginalConstructor(e);const o={};Reflect.getMetadataKeys(t).filter((e=>e.toString().startsWith(x.Class))).map((e=>{o[e.split(":")[1]]=Reflect.getMetadata(e,t)}));return o}getMethodAnnotationsLogic(e,t){const o={};Reflect.getMetadataKeys(e.prototype,t).filter((e=>e.toString().startsWith(x.Method))).map((n=>{o[n.split(":")[1]]=Reflect.getMetadata(n,e.prototype,t)}));return o}}const D=new AnnotationService;const k="CacheConfig";const F=D.getClassAnnotationFactory(k);function CacheConfigAnnotationFactory(e){"ngInject";return D.setClassAnnotationFactory(k,(t=>function(o,n,s){o=new(n.bind(o))(...s);o.cacheConfig=t[0];e.debug(`adding cache config ${JSON.stringify(o.cacheConfig)} to class ${b.getInstanceConstructorName(o)}`,o);return o}))}const V="Cached";const U=D.getMethodAnnotationFactory(V);function CachedAnnotationFactory(e){"ngInject";const t=D.setMethodAnnotationFactory(V,(t=>function(o,s,a,r){let d=[];let p=[];if(t[0]){d=t[0].actions;p=t[0].tags}if(o.cacheConfig){if(o.cacheConfig.actions){d=n.uniq(d.concat(o.cacheConfig.actions))}if(o.cacheConfig.tags){p=n.uniq(p.concat(o.cacheConfig.tags))}}if(!d.length){const e=b.getInstanceConstructorName(o);throw new Error(`method ${s} of ${e} is @Cached annotated but no CacheAction is specified either through @Cached or through class level @CacheConfig annotation`)}return e.handle(o,s,a,Array.prototype.slice.apply(r),d,p)}));return t}const $="InvalidateCache";const InvalidateCache=function(e){return D.getMethodAnnotationFactory($)(e)};function InvalidateCacheAnnotationFactory(e){"ngInject";return D.setMethodAnnotationFactory($,(t=>function(o,n,s,a){let r=[];const d=t[0];if(!d){if(o.cacheConfig&&o.cacheConfig.tags){r=o.cacheConfig.tags}}else{r=[d]}if(!r.length){throw new Error(`method ${n} of ${o.constructor.name} is @InvalidateCache annotated but no EvictionTag is specified either through @InvalidateCache or through class level @CacheConfig annotation`)}const p=s.apply(undefined,Array.prototype.slice.call(a));if(p&&p.then){return p.then((t=>{e.evict(...r);return t}))}else{e.evict(...r);return p}}))}class CacheAction{constructor(e){this.name=e}}const K="@smart/utils";const Y=`${K}_WHO_AM_I_RESOURCE_URI`;const X=`${K}_I18N_RESOURCE_URI`;const J=`${K}_EVENTSERVICE`;const ee="REAUTH_STARTED";const te="/authorizationserver/oauth/token";const ie="/smarteditwebservices/v1/i18n";const oe="smartedit";const ne={["^(?!"+ie+"/.*$).*$"]:te};const se={[te]:{client_id:oe}};const ae="/";const re="SWITCH_LANGUAGE_EVENT";const le="SELECTED_LANGUAGE";const ce={AUTHORIZATION_SUCCESS:"AUTHORIZATION_SUCCESS",USER_HAS_CHANGED:"USER_HAS_CHANGED",LOGOUT:"SE_LOGOUT_EVENT",CLEAR_PERSPECTIVE_FEATURES:"CLEAR_PERSPECTIVE_FEATURES",EXPERIENCE_UPDATE:"experienceUpdate",PERMISSION_CACHE_CLEANED:"PERMISSION_CACHE_CLEANED",PAGE_CHANGE:"PAGE_CHANGE",PAGE_CREATED:"PAGE_CREATED_EVENT",PAGE_UPDATED:"PAGE_UPDATED_EVENT",PAGE_DELETED:"PAGE_DELETED_EVENT",PAGE_SELECTED:"PAGE_SELECTED_EVENT",PAGE_RESTORED:"PAGE_RESTORED_EVENT",REAUTH_STARTED:"REAUTH_STARTED"};const de="en";const pe=new a.InjectionToken("LANGUAGE_SERVICE_CONSTANTS");const me=new a.InjectionToken("LANGUAGE_SERVICE");var ge;t.CacheEngine=ge=class CacheEngine{constructor(e,t,o){this.windowUtils=e;this.promiseUtils=t;this.logService=o;this.cachedItemsRegistry=[];this.startBackgroundMonitoringJob()}addItem(e,t,o){if(this.getItemIndex(e)===-1){this.cachedItemsRegistry.push({item:e,cacheTiming:t,refresh:o,completed:false,processing:false,defer:this.promiseUtils.defer()})}else{this.logService.warn(`CacheEngine - item already exist for id: ${e.id}`)}}getItemById(e){const t=this.cachedItemsRegistry.find((t=>t.item.id===e));return t?t.item:null}handle(e){const t=this.cachedItemsRegistry[this.getItemIndex(e)];if(t.completed&&!this.hasExpired(e)){t.defer.resolve(e.cache)}else if(!t.processing){t.processing=true;this.refreshCache(t)}return t.defer.promise}evict(...e){e.forEach((e=>{this.cachedItemsRegistry.filter((t=>t.item.evictionTags.indexOf(e)>-1)).forEach((e=>this.cachedItemsRegistry.splice(this.getItemIndex(e.item),1)))}))}startBackgroundMonitoringJob(){this.windowUtils.runIntervalOutsideAngular((()=>Promise.all(this.cachedItemsRegistry.filter((e=>this.needRefresh(e.item))).map((e=>this.refreshCache(e))))),ge.BACKGROUND_REFRESH_INTERVAL)}refreshCache(e){return e.refresh().then((t=>{e.cacheTiming.setAge(e.item);e.item.cache=t;e.item.timestamp=(new Date).getTime();e.completed=true;e.processing=false;e.defer.resolve(t)}),(t=>{this.logService.debug(`CacheEngine - unable to refresh cache for id: ${e.item.id}`,t);delete e.item.cache;e.defer.reject(t)}))}hasExpired(e){return e.timestamp+e.expirationAge<=(new Date).getTime()}needRefresh(e){return e.timestamp+e.refreshAge<=(new Date).getTime()}getItemIndex(e){return this.cachedItemsRegistry.findIndex((t=>t.item.id===e.id))}};t.CacheEngine.BACKGROUND_REFRESH_INTERVAL=1e4;t.CacheEngine=ge=__decorate([a.Injectable(),__metadata("design:paramtypes",[WindowUtils,t.PromiseUtils,LogService])],t.CacheEngine);class DefaultCacheTiming{constructor(e,t){this.expirationAge=e;this.refreshAge=t}setAge(e){const t=Object.assign(Object.assign({},e),{expirationAge:this.expirationAge,refreshAge:this.refreshAge});return t}}t.CacheService=class CacheService{constructor(e,t,o,n,s){this.logService=e;this.stringUtils=t;this.functionsUtils=o;this.eventService=n;this.cacheEngine=s;this.predicatesRegistry=[];this.eventListeners=[];this.defaultCacheTiming=new DefaultCacheTiming(24*60*60*1e3,12*60*60*1e3)}register(e,t){this.predicatesRegistry.unshift({test:e,cacheTiming:t});return this}handle(e,t,o,n,s,a){const r=this.functionsUtils.getInstanceConstructorName(e);const d=window.btoa(r+t)+this.stringUtils.encode(n);const p=this.cacheEngine.getItemById(d);let m;if(!p){const e=p||{id:d,timestamp:(new Date).getTime(),evictionTags:this.collectEventNamesFromTags(a),cache:null};const t=this.findCacheTimingByCacheActions(s);if(!t){throw new Error("CacheService::handle - No predicate match.")}m=t.setAge(e);this.cacheEngine.addItem(m,t,o.bind(undefined,...Array.prototype.slice.call(n)));this.listenForEvictionByTags(a)}else{m=p}return this.cacheEngine.handle(m)}evict(...e){const t=this.collectEventNamesFromTags(e);this.cacheEngine.evict(...t);t.forEach((e=>this.eventService.publish(e)))}listenForEvictionByTags(e){this.collectEventNamesFromTags(e).filter((e=>this.eventListeners.indexOf(e)===-1)).forEach((e=>{this.logService.debug(`registering event listener ${e}`);this.eventListeners.push(e);this.eventService.subscribe(e,((t,o)=>{this.logService.debug(`cleaning cache on event ${e}`);this.cacheEngine.evict(e);return Promise.resolve({})}))}))}collectEventNamesFromTags(e){if(e&&e.length){return n.union(...e.map((e=>this.collectEventNamesFromTag(e))))}else{return[]}}collectEventNamesFromTag(e){return n.union([e.event],...e.relatedTags?e.relatedTags.map((e=>this.collectEventNamesFromTag(e))):[])}findCacheTimingByCacheActions(e){const t=this.predicatesRegistry.find((t=>t.test(e)));return t?t.cacheTiming:this.defaultCacheTiming}};t.CacheService=__decorate([a.Injectable(),__param(3,a.Inject(J)),__metadata("design:paramtypes",[LogService,StringUtils,FunctionsUtils,Object,t.CacheEngine])],t.CacheService);class EvictionTag{constructor(e){this.event=e.event;this.relatedTags=e.relatedTags}}const ue="RarelyChangingContent";const he=new CacheAction(ue);class BackendEntry{constructor(e,t){this.pattern=e;this.matchingPayload=t}respond(e){this.mock=e;return this}passThrough(){}}t.HttpBackendService=class HttpBackendService{constructor(){this.matchLatestDefinition=false;this.backends={GET:[],POST:[],PUT:[],PATCH:[],DELETE:[]}}whenGET(e){return this._whenMethod("GET",e)}whenPOST(e,t){return this._whenMethod("POST",e,t)}whenPUT(e,t){return this._whenMethod("PUT",e,t)}whenPATCH(e,t){return this._whenMethod("PATCH",e,t)}whenDELETE(e){return this._whenMethod("DELETE",e)}when(e,t,o){return this._whenMethod(e,t,o)}whenAsync(e,t,o){return this._whenMethod(e,t,o)}matchLatestDefinitionEnabled(e){this.matchLatestDefinition=e}findMatchingMock(e){const t=(this.matchLatestDefinition?this.backends[e.method].slice().reverse():this.backends[e.method]).find((t=>{if(typeof t.pattern==="string"){return e.urlWithParams.endsWith(t.pattern)&&this.matchingPayloadRestriction(t,e)}else{const o=t.pattern.test(e.urlWithParams)&&this.matchingPayloadRestriction(t,e);t.pattern.lastIndex=0;return o}}));return t?t.mock:undefined}_whenMethod(e,t,o){const n=new BackendEntry(t,o);this.backends[e].push(n);return n}matchingPayloadRestriction(e,t){return e.matchingPayload?n.isEqual(e.matchingPayload,t.body):true}};t.HttpBackendService=__decorate([a.Injectable()],t.HttpBackendService);t.BackendInterceptor=class BackendInterceptor{constructor(e,t,o,n){this.httpBackendService=e;this.httpUtils=t;this.urlUtils=o;this.logService=n}intercept(e,t){const o=this.httpBackendService.findMatchingMock(e);if(!o){return t.handle(e)}let s;if(typeof o==="object"){s=[200,n.cloneDeep(o)]}else{let t=null;if(e.method==="GET"){t=decodeURIComponent(this.urlUtils.getQueryString(this.httpUtils.copyHttpParamsOrHeaders(e.params)))}else if(e.headers.get("Content-Type")==="application/x-www-form-urlencoded"){t=e.body}else if(e.method==="POST"||e.method==="PUT"){t=JSON.stringify(e.body)}const n=this.httpUtils.copyHttpParamsOrHeaders(e.headers);s=o(e.method,decodeURIComponent(e.urlWithParams),t,n)}this.logService.debug(`backend ${status} response for ${e.url}: `);return this.httpUtils.buildHttpResponse(e,s).pipe(p.take(1))}};t.BackendInterceptor=__decorate([a.Injectable(),__metadata("design:paramtypes",[t.HttpBackendService,HttpUtils,UrlUtils,LogService])],t.BackendInterceptor);var ve;let _e=ve=class FlawInjectionInterceptor{constructor(e,t){this.httpUtils=e;this.logService=t;this.flawWindow=window;this.flawWindow.allRequests=0;this.flawWindow.flawedRequests=0;this.flawWindow.allResponses=0;this.flawWindow.flawedResponses=0}static registerRequestFlaw(e){this.requestMutations.push(e)}static registerResponseFlaw(e){this.responseMutations.push(e)}intercept(e,t){if(ve.PROBABILITY!==0&&this.httpUtils.isCRUDRequest(e)&&!this._isGET(e)){return this._handleFlawWindow(e,t)}return t.handle(e)}_isGET(e){return e.method==="GET"}_activateWithProbability(e){return Math.random()>=1-e}_generateResultResponse(e,t){return t.pipe(p.map((t=>{if(t instanceof r.HttpResponse&&this._activateWithProbability(ve.PROBABILITY)){this.flawWindow.flawedResponses++;const o=ve.responseMutations.find((t=>t.test(e)));if(o&&t instanceof r.HttpResponse){this.logService.error(`FLAWED RESPONSE-"${e.url}`);return o.mutate(t)}}return t})))}_handleFlawWindow(e,t){let o;this.flawWindow.allRequests++;if(this._activateWithProbability(ve.PROBABILITY)){this.flawWindow.flawedRequests++;const n=ve.requestMutations.find((t=>t.test(e)));if(n){this.logService.error(`FLAWED REQUEST-"${e.url}`);o=t.handle(n.mutate(e))}}o=t.handle(e);return this._generateResultResponse(e,o)}};_e.requestMutations=[];_e.responseMutations=[];_e.PROBABILITY=0;_e=ve=__decorate([a.Injectable(),__metadata("design:paramtypes",[HttpUtils,LogService])],_e);t.FlawInjectionInterceptorModule=class FlawInjectionInterceptorModule{};t.FlawInjectionInterceptorModule=__decorate([a.NgModule({imports:[],providers:[{provide:r.HTTP_INTERCEPTORS,useClass:_e,multi:true},{provide:a.APP_INITIALIZER,useFactory(){_e.registerRequestFlaw({test:e=>/sites\/[\w-]+\//.test(e.url),mutate:e=>e.clone({url:e.url.replace(/sites\/([\w-]+)\//,"sites/"+Math.random()+"/")})});return e=>{}},multi:true}]})],t.FlawInjectionInterceptorModule);(function(e){e["INFO"]="information";e["SUCCESS"]="success";e["WARNING"]="warning";e["DANGER"]="error"})(t.IAlertServiceType||(t.IAlertServiceType={}));class IAlertService{showAlert(e){"proxyFunction";return}showInfo(e){"proxyFunction";return}showDanger(e){"proxyFunction";return}showWarning(e){"proxyFunction";return}showSuccess(e){"proxyFunction";return}}class IAuthenticationService{constructor(){this.reauthInProgress={};this.initialized=false}authenticate(e){"proxyFunction";return Promise.resolve()}logout(){"proxyFunction";return Promise.resolve()}isReAuthInProgress(e){"proxyFunction";return Promise.resolve(false)}setReAuthInProgress(e){"proxyFunction";return Promise.resolve()}filterEntryPoints(e){"proxyFunction";return Promise.resolve([])}isAuthEntryPoint(e){"proxyFunction";return Promise.resolve(false)}isAuthenticated(e){"proxyFunction";return Promise.resolve(false)}}class IStorageService{isInitialized(){"proxyFunction";return Promise.resolve(false)}storeAuthToken(e,t){"proxyFunction";return Promise.resolve()}getAuthToken(e){"proxyFunction";return Promise.resolve(undefined)}removeAuthToken(e){"proxyFunction";return Promise.resolve()}removeAllAuthTokens(){"proxyFunction";return Promise.resolve()}getValueFromLocalStorage(e,t){"proxyFunction";return Promise.resolve()}setValueInLocalStorage(e,t,o){"proxyFunction";return Promise.resolve()}setItem(e,t){"proxyFunction";return Promise.resolve()}getItem(e){"proxyFunction";return Promise.resolve()}}const fe=`${K}_TESTMODESERVICE`;(function(e){e["Default"]="light";e["Primary"]="emphasized"})(t.ModalButtonStyle||(t.ModalButtonStyle={}));(function(e){e["Close"]="close";e["Dismiss"]="dismiss";e["None"]="none"})(t.ModalButtonAction||(t.ModalButtonAction={}));class ISharedDataService{get(e){"proxyFunction";return Promise.resolve({})}set(e,t){"proxyFunction";return Promise.resolve()}update(e,t){"proxyFunction";return Promise.resolve()}remove(e){"proxyFunction";return Promise.resolve({})}containsKey(e){"proxyFunction";return Promise.resolve(true)}}class ISettingsService{load(){"proxyFunction";return Promise.resolve({key:""})}get(e){"proxyFunction";return Promise.resolve("")}getBoolean(e){"proxyFunction";return Promise.resolve(true)}getStringList(e){"proxyFunction";return Promise.resolve([])}}class IModalService{open(e){"proxyFunction";return{}}hasOpenModals(){"proxyFunction";return null}dismissAll(){"proxyFunction";return null}}class ISessionService{getCurrentUsername(){"proxyFunction";return Promise.resolve("")}getCurrentUserDisplayName(){"proxyFunction";return Promise.resolve("")}getCurrentUser(){"proxyFunction";return Promise.resolve({})}hasUserChanged(){"proxyFunction";return Promise.resolve(true)}resetCurrentUserData(){"proxyFunction";return Promise.resolve()}setCurrentUsername(){"proxyFunction";return Promise.resolve()}}class IAuthenticationManagerService{}const ye=[500,502,503,504];const Se=[429];const Ce=[408];function serverErrorPredicate(e,t){return t&&n.includes(ye,t.status)}function clientErrorPredicate(e,t){return t&&n.includes(Se,t.status)}function timeoutErrorPredicate(e,t){return t&&n.includes(Ce,t.status)}function retriableErrorPredicate(e,t){return t&&A.isAnyTruthy(serverErrorPredicate,clientErrorPredicate,timeoutErrorPredicate)(e,t)}function noInternetConnectionErrorPredicate(e,t){return t&&t.status===0}const be=["PUT","POST","DELETE","PATCH"];const Ie=["GET","OPTIONS","HEAD"];function updatePredicate(e,t){return n.includes(be,e.method)}function readPredicate(e,t){return n.includes(Ie,e.method)}const we={MAX_BACKOFF:64e3,MAX_ATTEMPT:5,MIN_BACKOFF:0};class ExponentialRetry{calculateNextDelay(e,t,o){t=t||we.MAX_BACKOFF;o=o||we.MIN_BACKOFF;const n=o+Math.random();return Math.min(Math.pow(2,e)*1e3+n,t)}canRetry(e,t){t=t||we.MAX_ATTEMPT;return e<=t}}const Ee={MAX_ATTEMPT:5,MAX_BACKOFF:32e3,MIN_BACKOFF:0,RETRY_INTERVAL:500};class LinearRetry{calculateNextDelay(e,t,o,n){o=o||Ee.MAX_BACKOFF;n=n||Ee.MIN_BACKOFF;t=t||Ee.RETRY_INTERVAL;const s=n+Math.random();return Math.min(e*t+s,o)}canRetry(e,t){t=t||Ee.MAX_ATTEMPT;return e<=t}}const Te={MAX_ATTEMPT:5,MIN_BACKOFF:0,RETRY_INTERVAL:500};class SimpleRetry{calculateNextDelay(e,t){t=t||Te.MIN_BACKOFF;e=e||Te.RETRY_INTERVAL;const o=t+Math.random();return e+o}canRetry(e,t){const o=t||Te.MAX_ATTEMPT;return e<=o}}const Pe=new a.InjectionToken("DefaultRetryStrategy");function defaultRetryStrategyFactory(e){return class{constructor(){this.firstFastRetry=true;this.attemptCount=0}canRetry(){return e.canRetry(this.attemptCount)}calculateNextDelay(){return e.calculateNextDelay()}}}const Ae=new a.InjectionToken("ExponentialRetryStrategy");function exponentialRetryStrategyFactory(e){return class{constructor(){this.firstFastRetry=true;this.attemptCount=0}canRetry(){return e.canRetry(this.attemptCount)}calculateNextDelay(){return e.calculateNextDelay(this.attemptCount)}}}const Oe=new a.InjectionToken("LinearRetryStrategy");function linearRetryStrategyFactory(e){return class{constructor(){this.firstFastRetry=true;this.attemptCount=0}canRetry(){return e.canRetry(this.attemptCount)}calculateNextDelay(){return e.calculateNextDelay(this.attemptCount)}}}t.OperationContextService=class OperationContextService{constructor(){this.store=[]}register(e,t){if(typeof e!=="string"||n.isEmpty(e)){throw new Error("operationContextService.register error: url is invalid")}if(typeof t!=="string"||n.isEmpty(t)){throw new Error("operationContextService.register error: operationContext is invalid")}const o=this.store.findIndex((o=>o.urlRegex.test(e)===true&&o.operationContext===t));if(o!==-1){return this}const s=new RegExp(e.replace(/\/:[^\/]*/g,"/.*"));this.store.push({urlRegex:s,operationContext:t});return this}findOperationContext(e){const t=this.store.findIndex((t=>t.urlRegex.test(e)===true));return~t?this.store[t].operationContext:null}};t.OperationContextService=__decorate([a.Injectable(),__metadata("design:paramtypes",[])],t.OperationContextService);const xe="OperationContextRegistered";const De=D.getClassAnnotationFactory(xe);function OperationContextAnnotationFactory(e,t,o){"ngInject";return D.setClassAnnotationFactory(xe,(function(n){return function(s,a,r){s=new(a.bind(s))(...r);const d=e.get(n[0],n[0]);if(typeof n[1]==="string"){const e=o[n[1]];t.register(d,e)}else if(Array.isArray(n[1])&&n[1].length>0){n[1].forEach((e=>{t.register(d,o[e])}))}return s}}))}const Re=`${K}_OPERATION_CONTEXT`;t.RetryInterceptor=class RetryInterceptor{constructor(e,t,o,n,s,a,r,d,p){this.httpClient=e;this.translate=t;this.operationContextService=o;this.alertService=n;this.OPERATION_CONTEXT=p;this.TRANSLATE_NAMESPACE="se.gracefuldegradation.";this.predicatesRegistry=[];this.requestToRetryTegistry={};this.register(noInternetConnectionErrorPredicate,r).register(s.isAnyTruthy(clientErrorPredicate,timeoutErrorPredicate),a).register(s.areAllTruthy(readPredicate,retriableErrorPredicate),a).register(serverErrorPredicate,r)}predicate(e,t){return this.findMatchingStrategy(e,t)!==null}responseError(e,t){let o=this.retrieveRetryStrategy(e);if(!o){const n=this.findMatchingStrategy(e,t);if(n){this.alertService.showWarning({message:this.translate.instant(this.TRANSLATE_NAMESPACE+"stillworking")});o=new n;o.attemptCount=0;this.storeRetryStrategy(e,o)}else{return Promise.reject(t)}}return this.handleRetry(o,e,t)}register(e,t){if(typeof e!=="function"){throw new Error("retryInterceptor.register error: predicate must be a function")}if(typeof t!=="function"){throw new Error("retryInterceptor.register error: retryStrategy must be a function")}this.predicatesRegistry.unshift({predicate:e,retryStrategy:t});return this}findMatchingStrategy(e,t){const o=this.operationContextService.findOperationContext(e.url)||this.OPERATION_CONTEXT.INTERACTIVE;const n=this.predicatesRegistry.find((n=>n.predicate(e,t,o)));return n?n.retryStrategy:null}handleRetry(e,t,o){e.attemptCount++;if(e.canRetry()){const o=e.firstFastRetry?0:e.calculateNextDelay();e.firstFastRetry=false;return new Promise(((e,n)=>{setTimeout((()=>{this.httpClient.request(t).toPromise().then((o=>{this.removeRetryStrategy(t);return e(o)}),(e=>n(e)))}),o)}))}else{this.alertService.showDanger({message:this.translate.instant(this.TRANSLATE_NAMESPACE+"somethingwrong")});return Promise.reject(o)}}storeRetryStrategy(e,t){this.requestToRetryTegistry[this.getRequestUUID(e)]=t}removeRetryStrategy(e){delete this.requestToRetryTegistry[this.getRequestUUID(e)]}retrieveRetryStrategy(e){return this.requestToRetryTegistry[this.getRequestUUID(e)]}getRequestUUID(e){return e.clone().toString()}};t.RetryInterceptor=__decorate([a.Injectable(),__param(5,a.Inject(Pe)),__param(6,a.Inject(Ae)),__param(7,a.Inject(Oe)),__param(8,a.Inject(Re)),__metadata("design:paramtypes",[r.HttpClient,m.TranslateService,t.OperationContextService,IAlertService,BooleanUtils,Object,Object,Object,Object])],t.RetryInterceptor);t.PermissionErrorInterceptor=class PermissionErrorInterceptor{constructor(e){this.alertService=e}predicate(e,t){return t.status===403}responseError(e,t){if(t.error&&t.error.errors){t.error.errors.filter((e=>e.type==="TypePermissionError")).forEach((e=>{this.alertService.showDanger({message:e.message,duration:1e4})}))}return Promise.reject(t)}};t.PermissionErrorInterceptor=__decorate([a.Injectable(),__metadata("design:paramtypes",[IAlertService])],t.PermissionErrorInterceptor);const ke={};t.UnauthorizedErrorInterceptor=class UnauthorizedErrorInterceptor{constructor(e,t,o,n,s,a){this.httpClient=e;this.authenticationService=t;this.promiseUtils=o;this.httpUtils=n;this.eventService=a;this.promisesToResolve={};this.rejectedUrls=[/authenticate/];this.rejectedUrls.push(s)}predicate(e,t){return t.status===401&&(e.url?this.httpUtils.isCRUDRequest(e,t)&&this.isUrlNotRejected(e.url):true)}responseError(e,t){const o=this.promiseUtils.defer();const n=o.promise.then((()=>this.httpClient.request(e).toPromise()));this.authenticationService.isAuthEntryPoint(e.url).then((s=>{if(!s){this.authenticationService.filterEntryPoints(e.url).then((t=>{const s=t[0];this.promisesToResolve[s]=this.promisesToResolve[s]||[];this.promisesToResolve[s].push({requestIdentifier:e.url,deferred:o});if(this.httpUtils.isGET(e)){ke[e.url]=n}this.authenticationService.isReAuthInProgress(s).then((t=>{if(!t){this.authenticationService.setReAuthInProgress(s).then((()=>{const t=this.promisesToResolve;this.eventService.publish(ee);this.authenticationService.authenticate(e.url).then(function(){t[this].forEach((e=>{delete ke[e.requestIdentifier];e.deferred.resolve()}));t[this]=[]}.bind(s),function(){t[this].forEach((e=>{delete ke[e.requestIdentifier];e.deferred.reject()}));t[this]=[]}.bind(s))}))}}))}))}else{o.reject(t)}}));return n}isUrlNotRejected(e){return!this.rejectedUrls.some((t=>typeof t==="string"?e.indexOf(t)===0:t.test(e)))}};t.UnauthorizedErrorInterceptor=__decorate([a.Injectable(),__param(4,a.Inject(Y)),__param(5,a.Inject(J)),__metadata("design:paramtypes",[r.HttpClient,IAuthenticationService,t.PromiseUtils,HttpUtils,String,Object])],t.UnauthorizedErrorInterceptor);let Me=class HttpAuthInterceptor{constructor(e,t,o,n){this.authenticationService=e;this.injector=t;this.httpUtils=o;this.I18N_RESOURCE_URI=n}intercept(e,t){if(!this._isCRUDRequest(e)){return t.handle(e)}if(this._isGetRequest(e)){return this._handleGetRequest(e)}return this._handleCUDRequest(e,t)}_isCRUDRequest(e){return!e.url.includes(this.I18N_RESOURCE_URI)&&this.httpUtils.isCRUDRequest(e)}_isGetRequest(e){return this.httpUtils.isGET(e)&&!!ke[e.url]}_handleGetRequest(e){return new d.Observable((t=>{ke[e.url].then((e=>{t.next(new r.HttpResponse({status:200,body:e}))}))}))}_addAuthToResponse(e,t,o){return d.from(this.injector.get(IStorageService).getAuthToken(o[0])).pipe(p.switchMap((o=>{if(!o){return t.handle(e)}const n=e.clone({headers:e.headers.set("Authorization",o.token_type+" "+o.access_token)});return t.handle(n)})))}_handleCUDRequest(e,t){return d.from(this.authenticationService.filterEntryPoints(e.url)).pipe(p.switchMap((o=>{if(!(o&&o.length)){return t.handle(e)}return this._addAuthToResponse(e,t,o)})))}};Me=__decorate([a.Injectable(),__param(3,a.Inject(X)),__metadata("design:paramtypes",[IAuthenticationService,a.Injector,HttpUtils,String])],Me);t.HttpErrorInterceptorService=class HttpErrorInterceptorService{constructor(e,t){this.injector=e;this.promiseUtils=t;this._errorInterceptors=[]}addInterceptors(e){e.forEach((e=>{this.addInterceptor(e)}))}addInterceptor(e){let t;if(e.predicate||e.responseError){t=e}else{t=this.injector.get(e)}this._validateInterceptor(t);this._errorInterceptors.unshift(t);return()=>{this._errorInterceptors.splice(this._errorInterceptors.indexOf(t),1)}}responseError(e,t){const o=this._errorInterceptors.filter((o=>o.predicate(e,t)===true));const s=this.promiseUtils.defer();if(o.length){this._iterateErrorInterceptors(e.clone(),n.cloneDeep(t),o,s)}else{s.reject(t)}return d.from(s.promise)}_iterateErrorInterceptors(e,t,o,n,s=0){if(s===o.length){n.reject(t)}else{const a=this._iterateErrorInterceptors.bind(this);Promise.resolve(o[s].responseError(e,t)).then((e=>{n.resolve(e)}),(t=>{a(e,t,o,n,++s)}))}}_validateInterceptor(e){if(!e.predicate||typeof e.predicate!=="function"){throw new Error("httpErrorInterceptorService.addInterceptor.error.interceptor.has.no.predicate")}if(!e.responseError||typeof e.responseError!=="function"){throw new Error("httpErrorInterceptorService.addInterceptor.error.interceptor.has.no.responseError")}}};t.HttpErrorInterceptorService=__decorate([a.Injectable(),__metadata("design:paramtypes",[a.Injector,t.PromiseUtils])],t.HttpErrorInterceptorService);let Ne=class HttpErrorInterceptor{constructor(e,t){this.httpErrorInterceptorService=e;this.httpUtils=t}intercept(e,t){return t.handle(e).pipe(p.catchError(((t,o)=>{if(!this.httpUtils.isHTMLRequest(e,t)){return this.httpErrorInterceptorService.responseError(e,t)}else{return d.throwError(t)}})))}};Ne=__decorate([a.Injectable(),__metadata("design:paramtypes",[t.HttpErrorInterceptorService,HttpUtils])],Ne);var Fe;t.HttpInterceptorModule=Fe=class HttpInterceptorModule{static forRoot(...e){return{ngModule:Fe,providers:[...e,{provide:r.HTTP_INTERCEPTORS,useClass:Me,multi:true},{provide:r.HTTP_INTERCEPTORS,useClass:Ne,multi:true},{provide:r.HTTP_INTERCEPTORS,useClass:t.BackendInterceptor,multi:true},{provide:a.APP_BOOTSTRAP_LISTENER,useFactory(t){t.addInterceptors(e);return e=>{}},deps:[t.HttpErrorInterceptorService],multi:true}]}}};t.HttpInterceptorModule=Fe=__decorate([a.NgModule({imports:[t.FlawInjectionInterceptorModule],providers:[SimpleRetry,LinearRetry,ExponentialRetry,{provide:Pe,useFactory:defaultRetryStrategyFactory,deps:[SimpleRetry]},{provide:Ae,useFactory:exponentialRetryStrategyFactory,deps:[ExponentialRetry]},{provide:Oe,useFactory:linearRetryStrategyFactory,deps:[SimpleRetry]},t.HttpErrorInterceptorService,t.HttpBackendService]})],t.HttpInterceptorModule);(function(e){e["UNKNOW_ERROR"]="Unknown Error"})(t.StatusText||(t.StatusText={}));class HttpPaginationResponseAdapter{static transform(e){const t=e;const o=t&&t.body&&t.body.pagination;if(!o){return t}const n=Object.keys(t.body).find((e=>e!=="pagination"&&Array.isArray(t.body[e])));return n?t.clone({body:Object.assign(Object.assign({},t.body),{results:t.body[n]})}):t}}t.ResponseAdapterInterceptor=class ResponseAdapterInterceptor{intercept(e,t){return t.handle(e).pipe(p.map(HttpPaginationResponseAdapter.transform))}};t.ResponseAdapterInterceptor=__decorate([a.Injectable()],t.ResponseAdapterInterceptor);class RestClient{constructor(e,t,o){this.httpClient=e;this.url=t;this.identifierName=o;this.DEFAULT_HEADERS={"x-requested-with":"Angular"};this.DEFAULT_OPTIONS={headers:{}};this.metadataActivated=false;this.getMethodForSingleInstance=e=>{switch(e){case"getById":return(e,t=this.DEFAULT_OPTIONS)=>this.getById(e,t);case"get":return(e,t=this.DEFAULT_OPTIONS)=>this.get(e,t);case"update":return(e,t=this.DEFAULT_OPTIONS)=>this.update(e,t);case"save":return(e,t=this.DEFAULT_OPTIONS)=>this.save(e,t);case"patch":return(e,t=this.DEFAULT_OPTIONS)=>this.patch(e,t);case"remove":return(e,t=this.DEFAULT_OPTIONS)=>this.remove(e,t)}};this.getMethodForArray=e=>{switch(e){case"query":return(e,t=this.DEFAULT_OPTIONS)=>this.query(e,t)}}}getById(e,t=this.DEFAULT_OPTIONS){return this.addHeadersToBody(this.httpClient.get(`${this.url}/${e}`,{headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).toPromise()}get(e,t=this.DEFAULT_OPTIONS){const o=this.convertToTypeMapOfString(e);return this.addHeadersToBody(this.httpClient.get(this.interpolateParamsInURL(this.url,o),{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,e)),headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).toPromise()}query(e,t=this.DEFAULT_OPTIONS){const o=e?this.convertToTypeMapOfString(e):e;return this.addHeadersToBody(this.httpClient.get(this.interpolateParamsInURL(this.url,o),{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,e)),headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).pipe(p.map((e=>e||[]))).toPromise()}page(e,t=this.DEFAULT_OPTIONS){return this.addHeadersToBody(this.httpClient.get(this.interpolateParamsInURL(this.url,e),{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,e)),headers:this.buildRequestHeaders(t.headers||{}),observe:"response"})).pipe(p.map((e=>e))).toPromise()}update(e,t=this.DEFAULT_OPTIONS){return this.performIdentifierCheck(e).then((()=>this.buildUrlWithIdentifier(e))).then((o=>this.httpClient.put(o,e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()))}save(e,t=this.DEFAULT_OPTIONS){return this.httpClient.post(this.interpolateParamsInURL(this.url,e),e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()}patch(e,t=this.DEFAULT_OPTIONS){return this.performIdentifierCheck(e).then((()=>this.buildUrlWithIdentifier(e))).then((o=>this.httpClient.patch(o,e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()))}remove(e,t=this.DEFAULT_OPTIONS){return this.performIdentifierCheck(e).then((()=>this.buildUrlWithIdentifier(e))).then((e=>this.httpClient.delete(e,{headers:this.buildRequestHeaders(t.headers||{})}).toPromise()))}queryByPost(e,t,o=this.DEFAULT_OPTIONS){const n=this.convertToTypeMapOfString(t);return this.httpClient.post(this.interpolateParamsInURL(this.url,n),e,{params:this.formatQueryString(this.determineTrueQueryStringParams(this.url,t)),headers:this.buildRequestHeaders(o.headers||{})}).toPromise()}activateMetadata(){this.metadataActivated=true}convertToTypeMapOfString(e){return n.mapValues(e,(e=>String(e)))}formatQueryString(e){return this.sortByKeys(e)}addHeadersToBody(e){return e.pipe(p.map((e=>{const t=e.body;if(this.metadataActivated&&t){t.headers=e.headers}return t})))}interpolateParamsInURL(e,t){if(t&&typeof t!=="string"){return new URIBuilder(e).replaceParams(t).sanitize().build()}else{return e}}determineTrueQueryStringParams(e,t){return typeof t==="object"?Object.keys(t).reduce(((o,s)=>{if(!new RegExp(":"+s+"/").test(e)&&!new RegExp(":"+s+"$").test(e)&&!new RegExp(":"+s+"&").test(e)&&!n.isNil(t[s])){o[s]=t[s]}return o}),{}):{}}sortByKeys(e){const t=n.sortBy(n.keys(e),(e=>e));return n.zipObject(t,n.map(t,(t=>e[t])))}performIdentifierCheck(e){const t=typeof e==="string"?e:e[this.identifierName];if(!t){return Promise.reject("no data was found under the "+t+" field of object "+JSON.stringify(e)+", it is necessary for update and remove operations")}return Promise.resolve()}buildUrlWithIdentifier(e){const t=typeof e==="string"?e:e[this.identifierName];let o=this.interpolateParamsInURL(`${this.url}`,e);o=o.includes("?")||this.url.includes(":"+this.identifierName)?o:`${o}/${t}`;return Promise.resolve(o)}buildRequestHeaders(e){return new r.HttpHeaders(Object.assign(Object.assign({},this.DEFAULT_HEADERS),e))}}var ze;t.RestServiceFactory=ze=class RestServiceFactory{constructor(e){this.httpClient=e;this.map=new Map;this.basePath=null;this.DOMAIN=null;this.IDENTIFIER="identifier"}static setGlobalBasePath(e){if(!ze.globalBasePath){ze.globalBasePath=e}else{ze.logService.warn("The value of a global base path was already set. "+"Update is not possible, the value remained unchanged!")}}static getGlobalBasePath(){return ze.globalBasePath?ze.globalBasePath:""}setDomain(e){this.DOMAIN=e}setBasePath(e){this.basePath=e}get(e,t=this.IDENTIFIER){if(this.map.has(e+t)){return this.map.get(e+t)}if(!/^https?\:\/\//.test(e)){const t=this.getNewBasePath();const o=n.isEmpty(t)?e:t+(/^\//.test(e)?e:`/${e}`);e=this.shouldAppendDomain(e)?`${this.DOMAIN}/${e}`:o}const o=new RestClient(this.httpClient,e,t);this.map.set(e+t,o);return o}shouldAppendDomain(e){return!!this.DOMAIN&&!/^\//.test(e)}getNewBasePath(){return this.basePath?this.basePath:ze.globalBasePath}};t.RestServiceFactory.globalBasePath=null;t.RestServiceFactory.logService=new LogService;t.RestServiceFactory=ze=__decorate([a.Injectable(),__metadata("design:paramtypes",[r.HttpClient])],t.RestServiceFactory);class AbstractCachedRestService{constructor(e,t,o){this.innerRestService=e.get(t,o);this.innerRestService.activateMetadata&&this.innerRestService.activateMetadata()}getById(e,t){return this.innerRestService.getById(e,t)}get(e,t){return this.innerRestService.get(e,t)}query(e,t){return this.innerRestService.query(e,t)}page(e,t){return this.innerRestService.page(e,t)}update(e,t){return this.innerRestService.update(e,t)}patch(e,t){return this.innerRestService.patch(e,t)}remove(e,t){return this.innerRestService.remove(e,t)}save(e,t){return this.innerRestService.save(e,t)}queryByPost(e,t,o){return this.innerRestService.queryByPost(e,t,o)}}__decorate([StripResponseHeaders,U(),__metadata("design:type",Function),__metadata("design:paramtypes",[String,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"getById",null);__decorate([StripResponseHeaders,U(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"get",null);__decorate([StripResponseHeaders,U(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"query",null);__decorate([StripResponseHeaders,U(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"page",null);__decorate([StripResponseHeaders,InvalidateCache(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"update",null);__decorate([StripResponseHeaders,InvalidateCache(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"patch",null);__decorate([InvalidateCache(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"remove",null);__decorate([StripResponseHeaders,__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"save",null);__decorate([StripResponseHeaders,U(),__metadata("design:type",Function),__metadata("design:paramtypes",[Object,Object,Object]),__metadata("design:returntype",Promise)],AbstractCachedRestService.prototype,"queryByPost",null);function StripResponseHeaders(e,t,o){const n=o.value;if(n){o.value=function(){return n.apply(this,Array.prototype.slice.call(arguments)).then((e=>{delete e.headers;return e}))}}}var Le;const Ve="sso";var Ue;(function(e){e["SSO_CLIENT_ID"]="SSO_CLIENT_ID";e["SSO_AUTHENTICATION_ENTRY_POINT"]="SSO_AUTHENTICATION_ENTRY_POINT";e["SSO_LOGOUT_ENTRY_POINT"]="SSO_LOGOUT_ENTRY_POINT";e["SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT"]="SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT"})(Ue||(Ue={}));const je="ssoAuthenticate";const $e="ssoAuthenticateError";const Be="SSODIALOG_WINDOW";t.SSOAuthenticationHelper=Le=class SSOAuthenticationHelper{constructor(e,t,o,n){this.windowUtils=e;this.promiseUtils=t;this.httpClient=o;this.injector=n;this.logoutIframeId="logoutIframe";this.deferred=null;this.listenForAuthTokenBeingSentBack()}launchSSODialog(){this.deferred=this.promiseUtils.defer();const e=this.injector.get(Ue.SSO_AUTHENTICATION_ENTRY_POINT)+this.getSSOContextPath();this.window.open(e,Be,"toolbar=no,scrollbars=no,resizable=no,top=200,left=200,width=1000,height=800");return this.deferred.promise}completeDialog(){return new Promise(((e,t)=>{this.httpClient.post(this.injector.get(Ue.SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT),{client_id:this.injector.get(Ue.SSO_CLIENT_ID)}).subscribe((t=>{this.window.opener.postMessage({eventId:je,authToken:t},this.document.location.origin);this.window.close();e()}),(e=>{const o={error:e.error,status:e.status};this.window.opener.postMessage({eventId:$e,error:o},this.document.location.origin);this.window.close();t()}))}))}isSSODialog(){return this.window.name===Be&&new RegExp(`[?&]${Ve}`).test(location.search)}isAutoSSOMain(){return Le.lastAuthenticatedWithSSO||this.window.name!==Be&&new RegExp(`[?&]${Ve}`).test(location.search)}logout(){let e=this.logoutIframe;if(!e){e=this.document.createElement("iframe");e.id=this.logoutIframeId;e.style.display="none";this.document.body.appendChild(e)}e.src=this.injector.get(Ue.SSO_LOGOUT_ENTRY_POINT);Le.lastAuthenticatedWithSSO=false;this.document.location.href=this.document.location.href.replace(this.getSSOContextPath(),this.document.location.pathname)}getSSOContextPath(){return`${this.document.location.pathname}?${Ve}`}listenForAuthTokenBeingSentBack(){this.window.addEventListener("message",(e=>{if(e.origin!==document.location.origin){return}this.logoutIframe&&this.logoutIframe.remove();if(e.data.eventId===je){Le.lastAuthenticatedWithSSO=true;this.deferred&&this.deferred.resolve(e.data.authToken)}else if(e.data.eventId===$e){this.deferred&&this.deferred.reject(e.data.error)}}),false)}get window(){return this.windowUtils.getWindow()}get document(){return this.window.document}get logoutIframe(){return this.document.querySelector(`iframe#${this.logoutIframeId}`)}};t.SSOAuthenticationHelper.lastAuthenticatedWithSSO=false;t.SSOAuthenticationHelper=Le=__decorate([a.Injectable(),__metadata("design:paramtypes",[WindowUtils,t.PromiseUtils,r.HttpClient,a.Injector])],t.SSOAuthenticationHelper);const Ge=new a.InjectionToken("LoginDialogResourceProvider");t.LoginDialogComponent=class LoginDialogComponent{constructor(e,t,o,n,s,a,d,p){this.modalRef=e;this.logService=t;this.httpClient=o;this.sessionService=n;this.storageService=s;this.urlUtils=a;this.ssoAuthenticationHelper=d;this.resource=p;this.hostClass=true;this.data=null;this.authURIKey="";this.authURI="";this.isFullScreen=false;this.ssoEnabled=false;this.form=new g.FormGroup({username:new g.FormControl("",g.Validators.required),password:new g.FormControl("",g.Validators.required)});this.signinWithSSO=()=>{this.form.setErrors(null);return this.ssoAuthenticationHelper.launchSSODialog().then((e=>this.storeAccessToken(e)),(e=>this.APIAuthenticationFailureReportFactory(e))).then((e=>this.acceptUser(e)))};this.sendCredentials=e=>this.httpClient.request("POST",this.authURI,{headers:(new r.HttpHeaders).set("Content-Type","application/x-www-form-urlencoded"),body:this.urlUtils.getQueryString(e).replace("?",""),observe:"response"}).toPromise()}ngOnInit(){this.data=this.modalRef.data||{};this.authURI=this.data.authURI;this.isFullScreen=this.data.isFullScreen;this.ssoEnabled=this.data.ssoEnabled&&this.isMainEndPoint();this.storageService.removeAuthToken(this.authURI);this.authURIKey=btoa(this.authURI).replace(/=/g,"");if(this.ssoAuthenticationHelper.isAutoSSOMain()){this.signinWithSSO()}}signinWithCredentials(){this.form.setErrors(null);if(this.hasRequiredCredentialsError()){this.form.setErrors({credentialsRequiredError:"se.logindialogform.username.and.password.required"});return Promise.reject()}const e=Object.assign(Object.assign({},this.data.clientCredentials||{}),{username:this.form.get("username").value,password:this.form.get("password").value,grant_type:"password"});return this.sendCredentials(e).then((e=>this.storeAccessToken(e)),(e=>this.APIAuthenticationFailureReportFactory(e))).then((e=>this.acceptUser(e)))}isMainEndPoint(){return te===this.authURI}storeAccessToken(e){const t=e instanceof r.HttpResponse?e.body:e;this.storageService.storeAuthToken(this.authURI,t);this.logService.debug(`API Authentication Success: ${this.authURI}`);return this.isMainEndPoint()?this.sessionService.hasUserChanged():Promise.resolve(false)}APIAuthenticationFailureReportFactory(e){this.logService.debug(`API Authentication Failure: ${this.authURI} status: ${e.status}`);this.form.setErrors({asyncValidationError:e.error&&e.error.error_description||"se.logindialogform.oauth.error.default"});return Promise.reject(e)}acceptUser(e){this.modalRef.close({userHasChanged:e});if(this.isMainEndPoint()){this.sessionService.setCurrentUsername()}return Promise.resolve({userHasChanged:e})}hasRequiredCredentialsError(){const e=this.form.get("username");const t=this.form.get("password");return e.errors&&e.errors.required||t.errors&&t.errors.required}};__decorate([a.HostBinding("class.su-login-dialog"),__metadata("design:type",Object)],t.LoginDialogComponent.prototype,"hostClass",void 0);t.LoginDialogComponent=__decorate([a.Component({selector:"su-login-dialog",styles:[`.su-login{width:500px;min-height:440px;box-shadow:0 1px 4px 0 rgba(0,0,0,.1);background-color:#fff;border-radius:4px;border:1px solid rgba(0,0,0,.2);padding:20px;margin:0 auto}.su-login--wrapper{padding:40px 100px;width:100%}.su-login--form-group{margin-bottom:20px}.su-login--form-sso{margin-top:20px}.su-login--logo-wrapper{display:flex;justify-content:flex-start;align-items:center}.su-login--logo-wrapper.su-login--logo-wrapper_full{padding-bottom:45px}.su-login--logo{height:44px}.su-login--logo-text{font-family:"72",web,"Open Sans",sans-serif;font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;padding-left:16px;color:#32363a;font-weight:700}.su-login--logo__best-run{position:absolute;bottom:30px;left:30px}.su-login--btn{font-size:1rem;line-height:1.4285714286;font-weight:400;width:100%}.su-login--auth-message{padding-top:20px;padding-bottom:20px;font-size:1rem;line-height:1.4285714286;font-weight:400}.su-login--alert-error{margin-bottom:0;box-shadow:none}`],template:`<div class="su-login"><div class="su-login--wrapper"><div class="su-login--logo-wrapper" [ngClass]="{ 'su-login--logo-wrapper_full': !isFullScreen }"><img *ngIf="resource?.topLogoURL" [src]="resource?.topLogoURL" class="su-login--logo"/> <span class="su-login--logo-text" translate="se.application.name"></span></div><form autocomplete="off" novalidate [formGroup]="form" (submit)="signinWithCredentials()" class="su-login--form"><div class="su-login--auth-message" *ngIf="isFullScreen"><div translate="se.logindialogform.reauth.message1"></div><div translate="se.logindialogform.reauth.message2"></div></div><div *ngIf="form.errors" class="su-login--form-group"><fd-alert type="error" class="su-login--alert-error" id="invalidError" [dismissible]="false"><ng-container *ngIf="form.errors?.credentialsRequiredError">{{ form.errors.credentialsRequiredError | translate }}</ng-container><ng-container *ngIf="form.errors?.asyncValidationError">{{ form.errors.asyncValidationError | translate }}</ng-container></fd-alert></div><div class="su-login--form-group"><input fd-form-control type="text" id="username_{{ authURIKey }}" name="username" formControlName="username" placeholder="{{ 'se.authentication.form.input.username' | translate }}" autofocus autocomplete="username"/></div><div class="su-login--form-group"><input fd-form-control type="password" id="password_{{ authURIKey }}" name="password" placeholder="{{ 'se.authentication.form.input.password' | translate }}" formControlName="password" autocomplete="current-password" required/></div><div class="su-login--form-group"><su-language-dropdown class="su-login-language"></su-language-dropdown></div><button fd-button options="emphasized" class="su-login--btn" id="submit_{{ authURIKey }}" name="submit" type="submit" translate="se.authentication.form.button.submit"></button></form><form *ngIf="ssoEnabled" class="su-login--form-sso" name="loginDialogFormSSO" novalidate (submit)="signinWithSSO()"><button fd-button options="emphasized" class="fd-button--emphasized su-login--btn" id="submitSSO_{{ authURIKey }}" name="submitSSO" type="submit" translate="se.authentication.form.button.submit.sso"></button></form></div></div><img *ngIf="resource?.bottomLogoURL" [src]="resource?.bottomLogoURL" class="su-login--logo__best-run"/>`}),__param(7,a.Optional()),__param(7,a.Inject(Ge)),__metadata("design:paramtypes",[u.ModalRef,LogService,r.HttpClient,ISessionService,IStorageService,UrlUtils,t.SSOAuthenticationHelper,Object])],t.LoginDialogComponent);class ITranslationsFetchService{}(function(e){e[e["IE"]=0]="IE";e[e["CHROME"]=1]="CHROME";e[e["FIREFOX"]=2]="FIREFOX";e[e["EDGE"]=3]="EDGE";e[e["SAFARI"]=4]="SAFARI";e[e["UNKNOWN"]=5]="UNKNOWN"})(t.SUPPORTED_BROWSERS||(t.SUPPORTED_BROWSERS={}));class BrowserService{constructor(){this._isSafari=()=>{const e=window.navigator.userAgent;const t=window.navigator.vendor;return t&&t.indexOf("Apple")>-1&&e&&e.indexOf("Safari")>-1};this.isIE=()=>this.getCurrentBrowser()===t.SUPPORTED_BROWSERS.IE;this.isFF=()=>this.getCurrentBrowser()===t.SUPPORTED_BROWSERS.FIREFOX;this.isSafari=()=>this.getCurrentBrowser()===t.SUPPORTED_BROWSERS.SAFARI}getCurrentBrowser(){const e=window;let o=t.SUPPORTED_BROWSERS.UNKNOWN;if(typeof e.InstallTrigger!=="undefined"){o=t.SUPPORTED_BROWSERS.FIREFOX}else if(!!document.documentMode){o=t.SUPPORTED_BROWSERS.IE}else if(!!e.StyleMedia){o=t.SUPPORTED_BROWSERS.EDGE}else if(!!e.chrome&&!!e.chrome.webstore){o=t.SUPPORTED_BROWSERS.CHROME}else if(this._isSafari()){o=t.SUPPORTED_BROWSERS.SAFARI}return o}getBrowserLocale(){const e=window.navigator.language.split("-");return e.length===1?e[0]:e[0]+"_"+e[1].toUpperCase()}}class FingerPrintingService{constructor(){this._fingerprint=S.encode(this.getUserAgent()+this.getPlugins()+this.hasJava()+this.hasFlash()+this.hasLocalStorage()+this.hasSessionStorage()+this.hasCookie()+this.getTimeZone()+this.getLanguage()+this.getSystemLanguage()+this.hasCanvas())}getFingerprint(){return this._fingerprint}getUserAgent(){return navigator.userAgent}getPlugins(){const e=[];for(let t=0,o=navigator.plugins.length;t<o;t++){if(navigator.plugins[t]){e.push(navigator.plugins[t].name)}}return e.join(",")}hasJava(){return navigator.javaEnabled()}hasFlash(){return!!navigator.plugins.namedItem("Shockwave Flash")}hasLocalStorage(){try{const e="test-has-ls";localStorage.setItem(e,e);localStorage.removeItem(e);return true}catch(e){return false}}hasSessionStorage(){try{const e="test-has-ss";sessionStorage.setItem(e,e);sessionStorage.removeItem(e);return true}catch(e){return false}}hasCookie(){return navigator.cookieEnabled}getTimeZone(){return String(String(new Date).split("(")[1]).split(")")[0]}getLanguage(){return navigator.language}getSystemLanguage(){return window.navigator.language}hasCanvas(){try{const e=document.createElement("canvas");return!!(e.getContext&&e.getContext("2d"))}catch(e){return false}}}let He=class TranslateHttpLoader{constructor(e){this.translationsFetchService=e}getTranslation(e){return d.from(this.translationsFetchService.get(e))}};He=__decorate([a.Injectable(),__metadata("design:paramtypes",[ITranslationsFetchService])],He);var We;t.TranslationModule=We=class TranslationModule{static forChild(){return m.TranslateModule.forChild({isolate:false,loader:{provide:m.TranslateLoader,useClass:He}})}static forRoot(e){return{ngModule:We,providers:[{provide:ITranslationsFetchService,useClass:e},{provide:a.APP_INITIALIZER,useFactory(e,t,o){t.getValueFromLocalStorage("SELECTED_LANGUAGE",false).then((e=>e?e.isoCode:o.getBrowserLocale()),(()=>o.getBrowserLocale())).then((t=>{e.setDefaultLang(t);e.use(t)}));return e=>{}},deps:[m.TranslateService,IStorageService,BrowserService],multi:true}]}}};t.TranslationModule=We=__decorate([a.NgModule({imports:[m.TranslateModule.forRoot({isolate:false,loader:{provide:m.TranslateLoader,useClass:He}})],exports:[m.TranslateModule]})],t.TranslationModule);class LanguageDropdownAdapter{static transform(e,t){return{id:t,label:e.name,value:e}}}t.LanguageService=class LanguageService{constructor(e,t,o,n,s,a,r,d){this.logService=e;this.translateService=t;this.promiseUtils=o;this.eventService=n;this.browserService=s;this.storageService=a;this.injector=r;this.languageServiceConstants=d}getToolingLanguages(){return this.i18nLanguageRestService.get({}).then((e=>e.languages)).catch((e=>{this.logService.error("LanguageService.getToolingLanguages() - Error loading tooling languages");return Promise.reject(e)}))}getBrowserLanguageIsoCode(){return window.navigator.language.split("-")[0]}getBrowserLocale(){return this.browserService.getBrowserLocale()}getResolveLocale(){return this._getDefaultLanguage()}getResolveLocaleIsoCode(){return this.getResolveLocale().then((e=>this.convertBCP47TagToJavaTag(e).split("_")[0]))}setSelectedToolingLanguage(e){this.storageService.setValueInLocalStorage(le,e,false);this.translateService.use(e.isoCode);this.setApplicationTitle();this.eventService.publish(re,{isoCode:e.isoCode})}registerSwitchLanguage(){this.eventService.subscribe(re,((e,t)=>{if(this.translateService.currentLang!==t.isoCode){this.translateService.use(t.isoCode)}}))}convertBCP47TagToJavaTag(e){return!!e?e.replace(/-/g,"_"):e}convertJavaTagToBCP47Tag(e){return!!e?e.replace(/_/g,"-"):e}_getDefaultLanguage(){return this.storageService.getValueFromLocalStorage(le,false).then((e=>e?e.isoCode:this.browserService.getBrowserLocale()),(()=>this.browserService.getBrowserLocale()))}setApplicationTitle(){this.translateService.get("se.application.name").subscribe((e=>{document.title=e}))}get i18nLanguageRestService(){return this.injector.get(t.RestServiceFactory).get(this.languageServiceConstants.I18N_LANGUAGES_RESOURCE_URI)}};__decorate([U({actions:[he]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.LanguageService.prototype,"getToolingLanguages",null);t.LanguageService=__decorate([a.Injectable(),__param(3,a.Inject(J)),__param(7,a.Inject(pe)),__metadata("design:paramtypes",[LogService,m.TranslateService,t.PromiseUtils,Object,BrowserService,IStorageService,a.Injector,Object])],t.LanguageService);var qe;(function(e){e["Default"]="default";e["None"]="none"})(qe||(qe={}));class LanguageDropdownHelper{static findSelectLanguageWithIsoCodePredicate(e){return t=>t.value.isoCode===e}static findLanguageWithIsoCode(e,t){return t.find((t=>t.isoCode===e))}static order(e,t,o={strategy:qe.Default}){switch(o.strategy){case qe.Default:const o=t.filter((t=>t.isoCode!==e.isoCode)).sort(((e,t)=>e.isoCode.localeCompare(t.isoCode)));return[e,...o];case qe.None:return t}}}class LanguageDropdown{constructor(e,t){this.languageService=e;this.eventService=t;this.languageSortStrategy=qe.Default;this.selectedLanguage=null;this.items=[];this.initialLanguage=null;this.languages=[];this.unRegisterEventService=null}ngOnInit(){Promise.all([this.languageService.getResolveLocale(),this.languageService.getToolingLanguages()]).then((([e,t])=>{this.items=t.map(LanguageDropdownAdapter.transform);this.languages=t;this.setSelectedLanguage(e);this.setInitialLanguage(e)}));this.unRegisterEventService=this.eventService.subscribe(re,(()=>this.handleLanguageChange()))}ngOnDestroy(){this.unRegisterEventService()}onSelectedLanguage(e){this.languageService.setSelectedToolingLanguage(e.value)}setInitialLanguage(e){this.initialLanguage=this.items.find(LanguageDropdownHelper.findSelectLanguageWithIsoCodePredicate(e))||this.items.find(LanguageDropdownHelper.findSelectLanguageWithIsoCodePredicate(de))}setSelectedLanguage(e){this.selectedLanguage=LanguageDropdownHelper.findLanguageWithIsoCode(e,this.languages);if(this.selectedLanguage){const e=LanguageDropdownHelper.order(this.selectedLanguage,this.languages,{strategy:this.languageSortStrategy});this.items=e.map(LanguageDropdownAdapter.transform);return}this.languageService.getResolveLocaleIsoCode().then((e=>{this.selectedLanguage=LanguageDropdownHelper.findLanguageWithIsoCode(e,this.languages);const t=LanguageDropdownHelper.order(this.selectedLanguage,this.languages,{strategy:this.languageSortStrategy});this.items=t.map(LanguageDropdownAdapter.transform)}))}handleLanguageChange(){this.languageService.getResolveLocale().then((e=>{this.setSelectedLanguage(e)}))}}__decorate([a.Input(),__metadata("design:type",String)],LanguageDropdown.prototype,"languageSortStrategy",void 0);t.LanguageDropdownComponent=class LanguageDropdownComponent extends LanguageDropdown{constructor(e,t){super(e,t);this.eventService=t}};t.LanguageDropdownComponent=__decorate([a.Component({selector:"su-language-dropdown",template:`\n        <su-select\n            class="su-language-selector"\n            [items]="items"\n            [initialValue]="initialLanguage"\n            (onItemSelected)="onSelectedLanguage($event)"\n        >\n        </su-select>\n    `}),__param(0,a.Inject(me)),__param(1,a.Inject(J)),__metadata("design:paramtypes",[t.LanguageService,Object])],t.LanguageDropdownComponent);class ISelectAdapter{static transform(e,t){return{}}}t.ListItemKeyboardControlDirective=class ListItemKeyboardControlDirective{constructor(e,t){this.hostElement=e;this.renderer=t;this.activeClassName="is-active"}ngOnInit(){this.setTabIndex()}getElement(){return this.hostElement.nativeElement}setActive(){const e=this.getElement();this.renderer.addClass(e,this.activeClassName);e.scrollIntoView({block:"nearest"})}setInactive(){this.renderer.removeClass(this.getElement(),this.activeClassName)}setTabIndex(){this.renderer.setAttribute(this.getElement(),"tabindex","-1")}};t.ListItemKeyboardControlDirective=__decorate([a.Directive({selector:"[suListItemKeyboardControl]"}),__metadata("design:paramtypes",[a.ElementRef,a.Renderer2])],t.ListItemKeyboardControlDirective);var Ke;(function(e){e["ArrowDown"]="ArrowDown";e["ArrowUp"]="ArrowUp";e["Enter"]="Enter";e["Esc"]="Escape"})(Ke||(Ke={}));t.ListKeyboardControlDirective=class ListKeyboardControlDirective{constructor(){this.suListKeyboardControlEnabled=true;this.suListKeyboardControlEnterKeydown=new a.EventEmitter;this.suListKeyboardControlEscKeydown=new a.EventEmitter;this.didNgAfterContentInit=false;this.activeItem=null;this.activeItemIndex=null}onKeyDown(e){if(!this.suListKeyboardControlEnabled||this.items.length===0){return}switch(e.key){case Ke.ArrowDown:e.preventDefault();this.handleArrowDown();return;case Ke.ArrowUp:e.preventDefault();this.handleArrowUp();return;case Ke.Enter:e.preventDefault();this.handleEnter();return;case Ke.Esc:this.handleEsc();return}}ngAfterContentInit(){this.items.changes.subscribe((()=>this.onItemsChange()));this.items.notifyOnChanges();this.didNgAfterContentInit=true}ngOnChanges(e){if(!this.didNgAfterContentInit){return}const t=e.suListKeyboardControlEnabled;const o=e.suListKeyboardControlDisabledPredicate;const n=t&&t.currentValue&&!t.previousValue;const s=t&&!t.currentValue&&t.previousValue;const a=o&&o.currentValue&&!!this.suListKeyboardControlEnabled;const r=o&&!o.currentValue&&o.previousValue&&!!this.suListKeyboardControlEnabled;if(this.items.length===0){return}if(n||a){this.setFirstItemActive()}if(s||r){this.unsetActiveItem()}}onItemsChange(){if(this.items.length===0){this.clearActiveItem();return}if(this.suListKeyboardControlEnabled){if(!this.isActiveItemSet()){this.setActiveItemByIndex(0,1)}else if(!this.itemExistsByIndex(this.activeItemIndex)){this.clearActiveItem()}}else{this.clearActiveItem()}}handleArrowUp(){this.setPreviousItemActive()}handleArrowDown(){this.setNextItemActive()}handleEnter(){this.suListKeyboardControlEnterKeydown.emit(this.activeItemIndex)}handleEsc(){this.suListKeyboardControlEscKeydown.emit()}getItemByIndex(e){const t=this.getItemsArray();return t[e]}getItemsArray(){return this.items.toArray()}setActiveItemByIndex(e,t){const o=this.getItemsArray();if(this.suListKeyboardControlDisabledPredicate){while(this.suListKeyboardControlDisabledPredicate(o[e],e)){e+=t;if(!o[e]){return}}}const n=this.getItemByIndex(e);this.setActiveItem(n)}setActiveItem(e){const t=this.getItemsArray();const o=t.indexOf(e);if(this.activeItem){this.activeItem.setInactive()}if(t.length>0){this.activeItem=t[o];this.activeItem.setActive();this.activeItemIndex=o}}unsetActiveItem(){if(!this.activeItem){return}this.activeItem.setInactive();this.activeItemIndex=null}setFirstItemActive(){this.setActiveItemByIndex(0,1)}setNextItemActive(){if(this.activeItemIndex===null){this.setFirstItemActive();return}if(this.activeItemIndex<this.items.length-1){this.setActiveItemByIndex(this.activeItemIndex+1,1)}}setPreviousItemActive(){if(this.activeItemIndex===null){this.setFirstItemActive();return}if(this.activeItemIndex>0){this.setActiveItemByIndex(this.activeItemIndex-1,-1)}}itemExistsByIndex(e){if(e===null){return false}return!!this.getItemByIndex(e)}clearActiveItem(){this.activeItem=null;this.activeItemIndex=null}isActiveItemSet(){return!!this.activeItem}};__decorate([a.Input(),__metadata("design:type",Object)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlEnabled",void 0);__decorate([a.Input(),__metadata("design:type",Function)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlDisabledPredicate",void 0);__decorate([a.Output(),__metadata("design:type",Object)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlEnterKeydown",void 0);__decorate([a.Output(),__metadata("design:type",Object)],t.ListKeyboardControlDirective.prototype,"suListKeyboardControlEscKeydown",void 0);__decorate([a.ContentChildren(t.ListItemKeyboardControlDirective),__metadata("design:type",a.QueryList)],t.ListKeyboardControlDirective.prototype,"items",void 0);__decorate([a.HostListener("document:keydown",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[KeyboardEvent]),__metadata("design:returntype",void 0)],t.ListKeyboardControlDirective.prototype,"onKeyDown",null);t.ListKeyboardControlDirective=__decorate([a.Directive({selector:"[suListKeyboardControl]"})],t.ListKeyboardControlDirective);t.ListKeyboardControlModule=class ListKeyboardControlModule{};t.ListKeyboardControlModule=__decorate([a.NgModule({declarations:[t.ListKeyboardControlDirective,t.ListItemKeyboardControlDirective],exports:[t.ListKeyboardControlDirective,t.ListItemKeyboardControlDirective]})],t.ListKeyboardControlModule);var Ye;t.SelectComponent=Ye=class SelectComponent extends BaseValueAccessor{constructor(){super(...arguments);this.items=[];this.initialValue=null;this.placeholder="";this.isKeyboardControlEnabled=true;this.hasCustomTrigger=false;this.onItemSelected=new a.EventEmitter;this.isOpen=false}selectItem(e){const t=this.items.find((t=>t.id===e));this.setValue(t);this.isOpen=false;this.onItemSelected.emit(t)}ngOnChanges(e){if(e.initialValue&&e.initialValue.currentValue&&!this.value){this.setInitialValue(e.initialValue.currentValue)}}setInitialValue(e){if(typeof e==="number"){this.setValueById(e)}else{this.setValue(e)}}setValue(e){this.writeValue(e);this.onChange(e)}setValueById(e){this.setValue(this.items.find((t=>t.id===e)))}};__decorate([a.Input(),__metadata("design:type",Array)],t.SelectComponent.prototype,"items",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"initialValue",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"placeholder",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"isKeyboardControlEnabled",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"hasCustomTrigger",void 0);__decorate([a.Output(),__metadata("design:type",a.EventEmitter)],t.SelectComponent.prototype,"onItemSelected",void 0);t.SelectComponent=Ye=__decorate([a.Component({selector:"su-select",encapsulation:a.ViewEncapsulation.None,providers:[{provide:g.NG_VALUE_ACCESSOR,useExisting:a.forwardRef((()=>Ye)),multi:true}],styles:[`.su-select,.su-select__popover-control,.su-select__popover-control .fd-dropdown{width:100%}.su-select__popover-control .fd-dropdown__control{overflow:hidden;color:#51555a;text-align:left}.su-select__popover-control .fd-dropdown__control::after{position:absolute;top:0;right:0;display:flex;justify-content:center;align-items:center;padding:0;height:36px;width:36px;margin-top:0;font-size:14px}.su-select__menu .fd-menu__list{max-height:200px;overflow:auto}.su-select__menu .fd-menu__item[select-highlighted]{background:rgba(10,110,209,.07)}.su-select__menu .fd-menu__item[select-highlighted]:focus{outline:0}`],template:`\n        <fd-popover [(isOpen)]="isOpen" fillControlMode="equal" class="su-select">\n            <fd-popover-control class="su-select__popover-control">\n                <button\n                    class="fd-dropdown__control fd-button"\n                    type="button"\n                    *ngIf="!hasCustomTrigger; else customTrigger"\n                >\n                    {{ (value && value.label) || placeholder | translate }}\n                </button>\n\n                <ng-template #customTrigger>\n                    <ng-content select="[su-select-custom-trigger]"></ng-content>\n                </ng-template>\n            </fd-popover-control>\n            <fd-popover-body>\n                <fd-menu class="su-select__menu">\n                    <ul\n                        fd-menu-list\n                        suListKeyboardControl\n                        [suListKeyboardControlEnabled]="isKeyboardControlEnabled && isOpen"\n                        (suListKeyboardControlEnterKeydown)="selectItem($event)"\n                    >\n                        <li\n                            fd-menu-item\n                            suListItemKeyboardControl\n                            [ngClass]="item.listItemClassName"\n                            *ngFor="let item of items"\n                            (click)="selectItem(item.id)"\n                            [attr.tabindex]="-1"\n                            [attr.data-select-id]="item.id"\n                        >\n                            {{ item.label | translate }}\n                        </li>\n                    </ul>\n                </fd-menu>\n            </fd-popover-body>\n        </fd-popover>\n    `})],t.SelectComponent);t.SelectModule=class SelectModule{};t.SelectModule=__decorate([a.NgModule({imports:[u.FundamentalNgxCoreModule,v.CommonModule,t.ListKeyboardControlModule,t.TranslationModule.forChild()],declarations:[t.SelectComponent],entryComponents:[t.SelectComponent],exports:[t.SelectComponent]})],t.SelectModule);t.LanguageDropdownModule=class LanguageDropdownModule{};t.LanguageDropdownModule=__decorate([a.NgModule({imports:[v.CommonModule,t.SelectModule],declarations:[t.LanguageDropdownComponent],entryComponents:[t.LanguageDropdownComponent],exports:[t.LanguageDropdownComponent]})],t.LanguageDropdownModule);t.LoginDialogModule=class LoginDialogModule{};t.LoginDialogModule=__decorate([a.NgModule({imports:[v.CommonModule,t.LanguageDropdownModule,g.FormsModule,g.ReactiveFormsModule,u.AlertModule,t.TranslationModule.forChild(),u.ButtonModule,u.FormModule],declarations:[t.LoginDialogComponent],entryComponents:[t.LoginDialogComponent],exports:[t.LanguageDropdownModule]})],t.LoginDialogModule);t.AuthenticationService=class AuthenticationService extends IAuthenticationService{constructor(e,t,o,n,s,a,r,d){super();this.translationsFetchService=e;this.modalService=t;this.sharedDataService=o;this.storageService=n;this.eventService=s;this.ssoAuthenticationHelper=a;this.settingsService=r;this.authenticationManager=d}filterEntryPoints(e){return this.sharedDataService.get("authenticationMap").then((t=>b.convertToArray(Object.assign(Object.assign({},t||{}),ne)).filter((t=>new RegExp(t.key,"g").test(e))).map((e=>e.value))))}isAuthEntryPoint(e){return this.sharedDataService.get("authenticationMap").then((t=>{const o=b.convertToArray(t||{}).map((e=>e.value));return o.indexOf(e)>-1||e===te}))}authenticate(e){return this._findLoginData(e).then((e=>this._launchAuth(e).then((t=>{Promise.resolve(this.eventService.publish(ce.AUTHORIZATION_SUCCESS,{userHasChanged:t.userHasChanged})).then((()=>{if(t.userHasChanged){this.eventService.publish(ce.USER_HAS_CHANGED)}const e=n.values(this.reauthInProgress).some((e=>e));if(t.userHasChanged&&!e&&this.authenticationManager&&this.authenticationManager.onUserHasChanged){this.authenticationManager.onUserHasChanged()}}));this.reauthInProgress[e.authURI]=false}))))}logout(){return this.eventService.publish(ce.LOGOUT).then((()=>{this.storageService.removeAllAuthTokens();if(this.ssoAuthenticationHelper.isAutoSSOMain()){this.ssoAuthenticationHelper.logout()}else if(this.authenticationManager&&this.authenticationManager.onLogout){this.authenticationManager.onLogout()}}))}isReAuthInProgress(e){return Promise.resolve(this.reauthInProgress[e]===true)}setReAuthInProgress(e){this.reauthInProgress[e]=true;return Promise.resolve()}isAuthenticated(e){return this.filterEntryPoints(e).then((e=>{const t=e&&e[0];return Promise.resolve(this.storageService.getAuthToken(t)).then((e=>!!e))}))}_findLoginData(e){return this.filterEntryPoints(e).then((e=>Promise.resolve(this.sharedDataService.get("credentialsMap").then((t=>{const o=Object.assign(Object.assign({},t||{}),se);const n=e[0];return{authURI:n,clientCredentials:o[n]}})))))}_launchAuth(e){return this.translationsFetchService.waitToBeReady().then((()=>Promise.all([this.storageService.isInitialized(),this.settingsService.getBoolean("smartedit.sso.enabled")]))).then((([o,n])=>{const s=this.modalService.open({component:t.LoginDialogComponent,data:Object.assign(Object.assign({},e),{isFullScreen:o,ssoEnabled:n}),config:{modalPanelClass:"su-login-dialog-container",hasBackdrop:false}});return new Promise(((e,t)=>{s.afterClosed.subscribe(e,t)}))}))}};t.AuthenticationService=__decorate([__param(4,a.Inject(J)),__param(7,a.Optional()),__metadata("design:paramtypes",[ITranslationsFetchService,IModalService,ISharedDataService,IStorageService,Object,t.SSOAuthenticationHelper,ISettingsService,IAuthenticationManagerService])],t.AuthenticationService);t.ModalManagerService=class ModalManagerService{constructor(e){this.modalRef=e;this.title=new d.BehaviorSubject("");this.titleSuffix=new d.BehaviorSubject("");this.modalData=new d.BehaviorSubject({});this.component=new d.BehaviorSubject(undefined);this.isDismissButtonVisible=new d.BehaviorSubject(false);this.buttons=new d.BehaviorSubject([])}init(){this.modalData.next(this.modalRef.data.modalData);this.component.next(this.modalRef.data.component);this.buttons.next(this.modalRef.data.templateConfig.buttons||[]);this.title.next(this.modalRef.data.templateConfig.title||"");this.titleSuffix.next(this.modalRef.data.templateConfig.titleSuffix||"");this.isDismissButtonVisible.next(this.modalRef.data.templateConfig.isDismissButtonVisible)}getComponent(){return this.component.asObservable()}getTitle(){return this.title.asObservable()}getTitleSuffix(){return this.titleSuffix.asObservable()}getButtons(){return this.buttons.asObservable()}getModalData(){return this.modalData.asObservable()}getIsDismissButtonVisible(){return this.isDismissButtonVisible.asObservable()}setDismissButtonVisibility(e){this.isDismissButtonVisible.next(e)}setTitle(e){this.title.next(e)}addButton(e){this.getButtonsValue().subscribe((t=>{const o=[...t,e];this.buttons.next(o)}))}addButtons(e){this.getButtonsValue().subscribe((t=>{const o=[...t,...e];this.buttons.next(o)}))}removeButton(e){this.getButtonsValue().subscribe((t=>{const o=t.filter((t=>t.id!==e));this.buttons.next(o)}))}removeAllButtons(){this.buttons.next([])}disableButton(e){this.getButtonsValue().subscribe((t=>{const o=t.map((t=>t.id===e?Object.assign(Object.assign({},t),{disabled:true}):t));this.buttons.next(o)}))}setDismissCallback(e){this.dismissCallback=e}enableButton(e){this.getButtonsValue().subscribe((t=>{const o=t.map((t=>t.id===e?Object.assign(Object.assign({},t),{disabled:false}):t));this.buttons.next(o)}))}onButtonClicked(e){const o=e.callback?e.callback():d.of(null);if(e.action!==t.ModalButtonAction.None){o.subscribe((o=>e.action===t.ModalButtonAction.Close?this.close(o):this.dismiss(o)))}}close(e){this.modalRef.close(e)}dismiss(e){this.dismissCallback().then((()=>this.modalRef.dismiss(e))).catch(n.noop)}getButtonsValue(){return this.buttons.pipe(p.take(1))}dismissCallback(){return Promise.resolve()}};t.ModalManagerService=__decorate([a.Injectable(),__metadata("design:paramtypes",[u.ModalRef])],t.ModalManagerService);t.ModalTemplateComponent=class ModalTemplateComponent{constructor(e,t){this.modalManager=e;this.cdr=t;this.component$=this.modalManager.getComponent();this.title$=this.modalManager.getTitle();this.titleSuffix$=this.modalManager.getTitleSuffix();this.isDismissButtonVisible$=this.modalManager.getIsDismissButtonVisible();this.buttons$=this.modalManager.getButtons()}ngOnInit(){this.modalManager.init();this.buttonsSubscription=this.buttons$.subscribe((e=>{this.buttons=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){if(this.buttonsSubscription){this.buttonsSubscription.unsubscribe()}}onButtonClicked(e){this.modalManager.onButtonClicked(e)}dismiss(){this.modalManager.dismiss()}};t.ModalTemplateComponent=__decorate([a.Component({selector:"fundamental-modal-template",encapsulation:a.ViewEncapsulation.None,providers:[t.ModalManagerService],styles:[`\n            .fd-modal__title {\n                min-height: 20px;\n            }\n        `],template:`\n        <fd-modal-header>\n            <h1 fd-modal-title id="fd-modal-title-{{ (title$ | async) || '' }}">\n                {{ (title$ | async) || '' | translate }}\n                {{ (titleSuffix$ | async) || '' | translate }}\n            </h1>\n            <button\n                fd-modal-close-btn\n                *ngIf="isDismissButtonVisible$ | async"\n                (click)="dismiss()"\n            ></button>\n        </fd-modal-header>\n        <fd-modal-body>\n            <ng-container *ngIf="component$ | async as component">\n                <ng-container *ngComponentOutlet="component"></ng-container>\n            </ng-container>\n        </fd-modal-body>\n        <fd-modal-footer *ngIf="buttons && buttons.length > 0">\n            <button\n                *ngFor="let button of buttons"\n                [disabled]="button.disabledFn ? button.disabledFn!() : button.disabled"\n                [options]="button.style"\n                [attr.id]="button.id"\n                (click)="onButtonClicked(button)"\n                fd-button\n            >\n                {{ button.label | translate }}\n            </button>\n        </fd-modal-footer>\n    `}),__metadata("design:paramtypes",[t.ModalManagerService,a.ChangeDetectorRef])],t.ModalTemplateComponent);t.FundamentalModalTemplateModule=class FundamentalModalTemplateModule{};t.FundamentalModalTemplateModule=__decorate([a.NgModule({imports:[v.CommonModule,u.ModalModule,u.ButtonModule,t.TranslationModule.forChild()],declarations:[t.ModalTemplateComponent],entryComponents:[t.ModalTemplateComponent],exports:[t.ModalTemplateComponent]})],t.FundamentalModalTemplateModule);t.ModalService=class ModalService{constructor(e){this.fundamentalModalService=e}open(e){const{templateConfig:t}=e;return!!t?this.openWithTemplate(e):this.openStandalone(e)}hasOpenModals(){return this.fundamentalModalService.hasOpenModals()}dismissAll(){this.fundamentalModalService.dismissAll()}openStandalone(e){const{config:t={},component:o,data:n}=e;return this.fundamentalModalService.open(o,Object.assign(Object.assign({},t),{data:n}))}openWithTemplate(e){const{config:o={},templateConfig:n={},component:s,data:a}=e;const r=Object.assign(Object.assign({},o),{data:{templateConfig:n,component:s,modalData:a}});return this.fundamentalModalService.open(t.ModalTemplateComponent,r)}};t.ModalService=__decorate([a.Injectable(),__metadata("design:paramtypes",[u.ModalService])],t.ModalService);class Alert{constructor(e,t,o,s){this._alertConf=e;this.fundamentalAlertService=o;this.translateService=s;this._displayed=false;n.defaultsDeep(this._alertConf,n.cloneDeep(t))}get alertConf(){return this._alertConf}get message(){return this._alertConf.message}get type(){return this._alertConf.type}show(){return __awaiter(this,void 0,void 0,(function*(){if(this.isDisplayed()){return}if(this._alertConf.message){this._alertConf.message=yield this.translateService.get(this._alertConf.message,this._alertConf.messagePlaceholders).toPromise()}const e=typeof this._alertConf.message!=="undefined"?this._alertConf.message:this._alertConf.component||"";this._alertRef=this.fundamentalAlertService.open(e,this._alertConf);this._alertRef.afterDismissed.subscribe((()=>this._displayed=false));this._displayed=true}))}hide(){if(!this.isDisplayed()){return}this._alertRef.dismiss()}isDisplayed(){return this._displayed}}const Ze=new a.InjectionToken("alertConfigToken");const Xe={data:{},type:t.IAlertServiceType.INFO,dismissible:true,duration:3e3,width:"500px"};t.AlertFactory=class AlertFactory{constructor(e,t,o){this.fundamentalAlertService=e;this.translateService=t;this.ALERT_CONFIG_DEFAULTS=o}createAlert(e){const t=this.getAlertConfig(e);return this.createAlertObject(t)}createInfo(e){const o=this.getAlertConfig(e,t.IAlertServiceType.INFO);return this.createAlertObject(o)}createDanger(e){const o=this.getAlertConfig(e,t.IAlertServiceType.DANGER);return this.createAlertObject(o)}createWarning(e){const o=this.getAlertConfig(e,t.IAlertServiceType.WARNING);return this.createAlertObject(o)}createSuccess(e){const o=this.getAlertConfig(e,t.IAlertServiceType.SUCCESS);return this.createAlertObject(o)}getAlertConfig(e,o){if(typeof e==="string"){return{message:e,type:o||t.IAlertServiceType.INFO}}if(!e.type){e.type=o||t.IAlertServiceType.INFO}return e}createAlertObject(e){return new Alert(e,this.ALERT_CONFIG_DEFAULTS,this.fundamentalAlertService,this.translateService)}};t.AlertFactory=__decorate([a.Injectable(),__param(2,a.Inject(Ze)),__metadata("design:paramtypes",[u.AlertService,m.TranslateService,u.AlertConfig])],t.AlertFactory);t.AlertService=class AlertService{constructor(e){this.alertFactory=e}showAlert(e){const t=this.alertFactory.createAlert(e);t.show()}showInfo(e){const t=this.alertFactory.createInfo(e);t.show()}showDanger(e){const t=this.alertFactory.createDanger(e);t.show()}showWarning(e){const t=this.alertFactory.createWarning(e);t.show()}showSuccess(e){const t=this.alertFactory.createSuccess(e);t.show()}};t.AlertService=__decorate([a.Injectable(),__metadata("design:paramtypes",[t.AlertFactory])],t.AlertService);t.AlertModule=class AlertModule{};t.AlertModule=__decorate([a.NgModule({imports:[u.AlertModule,t.TranslationModule],providers:[{provide:Ze,useValue:Xe},t.AlertService,t.AlertFactory]})],t.AlertModule);t.FileReaderService=class FileReaderService{read(e,t){const o=new FileReader;if(t===null||t===void 0?void 0:t.onError){o.onerror=t.onError}if(t===null||t===void 0?void 0:t.onLoadEnd){o.onloadend=t.onLoadEnd}o.readAsArrayBuffer(e);return o}};t.FileReaderService=__decorate([a.Injectable()],t.FileReaderService);t.FileMimeTypeService=class FileMimeTypeService{constructor(e,t){this.fileReaderService=e;this.settingsService=t}isFileMimeTypeValid(e){return new Promise(((t,o)=>__awaiter(this,void 0,void 0,(function*(){const{error:n,data:s}=yield P.attempt(this.settingsService.getStringList("smartedit.validFileMimeTypeCodes"));if(n){o(false);return}this.fileReaderService.read(e,{onLoadEnd:e=>{if(!this.validateMimeTypeFromFile(e.target.result,s)){o();return}t(true)},onError:()=>{o()}})}))))}validateMimeTypeFromFile(e,t){const o=new Uint8Array(e).subarray(0,32);const n=o.reduce(((e,t)=>{let o=t.toString(16);if(o.length===1){o="0"+o}e+=o;return e}),"");return t.some((e=>n.toLowerCase().includes(e.toLowerCase())))}};t.FileMimeTypeService=__decorate([a.Injectable(),__metadata("design:paramtypes",[t.FileReaderService,ISettingsService])],t.FileMimeTypeService);class FileValidatorFactory{build(e){return{validate:(t,o,n)=>this.validate(e,t,o,n)}}validate(e,t,o,n){n=n||[];e.forEach((e=>{const s=t[e.subject];if(!e.validate(s,o)){n.push({subject:e.subject,message:e.message})}}));return n.length===0}}class InputPropertyChange{constructor(e,t){this.key=e;this.value=t}}class InputProperties{constructor(e={}){this.changes=new d.Subject;this._map=new Map(n.toPairs(e))}get(e){return this._map.get(e)}set(e,t,o=true){this._map.set(e,t);if(o){this.changes.next(new InputPropertyChange(e,t))}}}class ValidatorParameters{constructor(e={},t={}){this.validators={};this.asyncValidators={};this.validators=this._omitUndefinedValues(e);this.asyncValidators=this._omitUndefinedValues(t)}has(e){return this.validators.hasOwnProperty(e)}get(e){if(!this.has(e)){return null}return this.validators[e]}hasAsync(e){return this.asyncValidators.hasOwnProperty(e)}getAsync(e){if(!this.hasAsync(e)){return null}return this.asyncValidators[e]}_omitUndefinedValues(e){return n.omitBy(e,n.isUndefined)}}class FormField extends g.FormControl{constructor(e={},t={},{component:o,inputs:n=new InputProperties,validatorParams:s=new ValidatorParameters,persist:a=true}){super(e,t);this.component=o;this.inputs=n;this.inputChanges=n.changes;this.validatorParams=s;this.persist=a}setInput(e,t){this.inputs.set(e,t)}getInput(e){return this.inputs.get(e)}getPersistedValue(){if(!this.persist){return undefined}return this.value===undefined?null:this.value}}class FormGrouping extends g.FormGroup{constructor(e,t={},{component:o,inputs:n=new InputProperties,validatorParams:s=new ValidatorParameters,persist:a=true}){super(e,t);this.component=o;this.inputs=n;this.inputChanges=n.changes;this.validatorParams=s;this.persist=a}setInput(e,t){this.inputs.set(e,t)}getInput(e){return this.inputs.get(e)}setNestedErrors(e=[]){e.forEach((([e,t])=>{const o=this.get(e);if(!o){throw new Error(`FormGrouping - Path not found when setting nested error: ${e}`)}o.setErrors(t)}))}getPersistedValue(){return Object.keys(this.controls).reduce(((e,t)=>{const o=this.controls[t];if(!o.persist){return Object.assign(Object.assign({},e),o.getPersistedValue())}e[t]=o.getPersistedValue();return e}),{})}}class FormList extends g.FormArray{constructor(e,t={},{component:o,inputs:n=new InputProperties,validatorParams:s=new ValidatorParameters,persist:a=true}){super(e,t);this.component=o;this.inputs=n;this.inputChanges=n.changes;this.validatorParams=s;this.persist=a}setInput(e,t){this.inputs.set(e,t)}getInput(e){return this.inputs.get(e)}getPersistedValue(){return this.controls.reduce(((e,t)=>{if(!t.persist){return e.concat(n.values(t.getPersistedValue()))}e.push(t.getPersistedValue());return e}),[])}size(){return this.controls.length}swapFormElements(e,t){if(!this._isInBounds(e)||!this._isInBounds(t)||e===t){return}const o=this.at(e);this.insert(e,this.at(t));this.insert(t,o)}moveFormElement(e,t){if(!this._isInBounds(e)||!this._isInBounds(t)||e===t){return}const o=t<e?-1:1;const n=this.at(e);for(let n=e;n!==t;n+=o){const e=n+o;this.setControl(n,this.at(e))}this.setControl(t,n)}_isInBounds(e){return e<this.controls.length&&e>=0}}const Qe=Symbol("_form_prop_");class PropDecorator{constructor(e){this.property=e}}class InputPropDecorator extends PropDecorator{constructor(e,t){super(e);this.alias=t?t:this.property}}class FormPropDecorator extends PropDecorator{}function makePropertyDecorator(e){return(t,o)=>{const n=t.constructor;if(!n[Qe]){n[Qe]=[]}n[Qe].push(e(o))}}function DynamicForm(){return makePropertyDecorator((e=>new FormPropDecorator(e)))}const DynamicInput=(e=null)=>makePropertyDecorator((t=>new InputPropDecorator(t,e)));t.FormListerComponent=class FormListerComponent{get forms(){return n.values(this.form.controls)}};__decorate([DynamicForm(),__metadata("design:type",FormGrouping)],t.FormListerComponent.prototype,"form",void 0);t.FormListerComponent=__decorate([a.Component({selector:"form-lister",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`<ng-template [formRenderer]="form" *ngFor="let form of forms"></ng-template>`})],t.FormListerComponent);const onChange=({changeDetectorRef:e,instance:t})=>{t.onDynamicInputChange&&t.onDynamicInputChange();e.markForCheck()};const decorate=(e,t)=>{const o=e.instance;const n=o.constructor[Qe];if(!Array.isArray(n)){return new d.Subscription}const s=new Map;n.forEach((e=>{const n=e.property;if(e instanceof InputPropDecorator){const a=e.alias;if(t.getInput(a)===undefined&&o[n]!==undefined){t.setInput(a,o[n])}o[n]=t.getInput(a);s.set(a,e)}else if(e instanceof FormPropDecorator){o[n]=t}}));onChange(e);return t.inputChanges.subscribe((({key:t,value:n})=>{const a=s.get(t);if(!a){return}o[a.property]=n;onChange(e)}))};t.FormRendererDirective=class FormRendererDirective{constructor(e,t){this.componentFactoryResolver=e;this.viewContainerRef=t}set form(e){this._dispose();const t=this.componentFactoryResolver.resolveComponentFactory(e.component);const o=this.viewContainerRef.createComponent(t);this._subscription=decorate(o,e)}ngOnDestroy(){this._dispose()}_dispose(){this._subscription&&this._subscription.unsubscribe();this.viewContainerRef.clear()}};__decorate([a.Input("formRenderer"),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],t.FormRendererDirective.prototype,"form",null);t.FormRendererDirective=__decorate([a.Directive({selector:"[formRenderer]"}),__metadata("design:paramtypes",[a.ComponentFactoryResolver,a.ViewContainerRef])],t.FormRendererDirective);const Je=new a.InjectionToken("COMPONENT_MAP");const et=new a.InjectionToken("ASYNC_VALIDATOR_MAP");const tt=new a.InjectionToken("VALIDATOR_MAP");var it;t.FormBuilderModule=it=class FormBuilderModule{static forRoot(e){return{ngModule:it,providers:[{provide:a.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:[e.types],multi:true},{provide:Je,useValue:e.types},{provide:tt,useValue:e.validators},{provide:et,useValue:e.asyncValidators}]}}};t.FormBuilderModule=it=__decorate([a.NgModule({imports:[v.CommonModule,g.ReactiveFormsModule],declarations:[t.FormRendererDirective,t.FormListerComponent],entryComponents:[t.FormListerComponent],exports:[t.FormRendererDirective]})],t.FormBuilderModule);class Registry{constructor(e={}){this._map=new Map(n.toPairs(e))}add(e,t){if(this._map.has(e)){throw new Error(`${this._service}: is overriding an element named '${e}' in its registry.`)}this._map.set(e,t)}get(e){if(!this._map.has(e)){throw new Error(`${this._service}: does not have '${e}' in its registry.`)}return this._map.get(e)}get _service(){return this.constructor.name}}t.ComponentRegistryService=class ComponentRegistryService extends Registry{constructor(e){super(e)}};t.ComponentRegistryService=__decorate([a.Injectable({providedIn:"root"}),__param(0,a.Optional()),__param(0,a.Inject(Je)),__metadata("design:paramtypes",[Object])],t.ComponentRegistryService);t.AsyncValidatorRegistryService=class AsyncValidatorRegistryService extends Registry{constructor(e){super(e)}};t.AsyncValidatorRegistryService=__decorate([a.Injectable({providedIn:"root"}),__param(0,a.Optional()),__param(0,a.Inject(et)),__metadata("design:paramtypes",[Object])],t.AsyncValidatorRegistryService);t.ValidatorRegistryService=class ValidatorRegistryService extends Registry{constructor(e){super(e)}};t.ValidatorRegistryService=__decorate([a.Injectable({providedIn:"root"}),__param(0,a.Optional()),__param(0,a.Inject(tt)),__metadata("design:paramtypes",[Object])],t.ValidatorRegistryService);t.SchemaCompilerService=class SchemaCompilerService{constructor(e,t,o){this.types=e;this.validators=t;this.asyncValidators=o}compileGroup(e,o,n={}){const s=Object.keys(o.schemas).reduce(((t,s)=>{t[s]=this._toAbstractForm(e?e[s]:null,o.schemas[s],n);return t}),{});return new FormGrouping(s,this._getValidators(o,n),{component:o.component?this._getComponent(o.component,n.components):t.FormListerComponent,inputs:new InputProperties(o.inputs),validatorParams:new ValidatorParameters(o.validators,o.asyncValidators),persist:this._toPersist(o.persist)})}compileList(e,t,o={}){const n=Array.isArray(t.schema)?t.schema:[t.schema];if(!n.length){throw Error("SchemaCompilerService - One or more schemas must be provided to compile a form list.")}const s=(Array.isArray(e)?e:[]).map(((e,t)=>{const s=n[t]?n[t]:n[n.length-1];return this._toAbstractForm(e,s,o)}));return new FormList(s,this._getValidators(t,o),{component:this._getComponent(t.component,o.components),inputs:new InputProperties(t.inputs),validatorParams:new ValidatorParameters(t.validators,t.asyncValidators),persist:this._toPersist(t.persist)})}compileField(e,t,o={}){return new FormField({value:e,disabled:t.disabled},this._getValidators(t,o),{component:this._getComponent(t.component,o.components),inputs:new InputProperties(t.inputs),validatorParams:new ValidatorParameters(t.validators,t.asyncValidators),persist:this._toPersist(t.persist)})}_getValidators(e,t={}){let o=[];let n=[];if(e.validators){o=this._mapValidator(e.validators,this.validators,t.validators)}if(e.asyncValidators){n=this._mapValidator(e.asyncValidators,this.asyncValidators,t.asyncValidators)}return{validators:o,asyncValidators:n}}_toAbstractForm(e,t,o){if(t.type==="field"){return this.compileField(e,t,o)}if(t.type==="group"){return this.compileGroup(e,t,o)}return this.compileList(e,t,o)}_mapValidator(e,t,o={}){return Object.keys(e).reduce(((n,s)=>{const a=e[s];if(a!==undefined){const e=o[s]?o[s]:t.get(s);if(!e){throw new Error(`SchemaCompilerService - Validator not found in ${this.validators.constructor.name} for: ${s}.`)}n.push(e(a))}return n}),[])}_toPersist(e=true){return e}_getComponent(e,t={}){const o=t[e]?t[e]:this.types.get(e);if(!o){throw new Error(`SchemaCompilerService - Did not find component for: ${e}.`)}return o}};t.SchemaCompilerService=__decorate([a.Injectable({providedIn:t.FormBuilderModule}),__metadata("design:paramtypes",[t.ComponentRegistryService,t.ValidatorRegistryService,t.AsyncValidatorRegistryService])],t.SchemaCompilerService);const getPersistenceMap=(e,t={},o=[],n=[])=>{if(e instanceof FormField){if(e.persist){t[o.join(".")]=n}return t}if(e instanceof FormList||e instanceof FormGrouping){if(e.persist&&o.length){t[o.join(".")]=n}Object.keys(e.controls).forEach((s=>{const a=e.controls[s];const r=[...n,s];if(a.persist){return getPersistenceMap(a,t,[...o,s],r)}return getPersistenceMap(a,t,o,r)}))}return t};const toFormValue=(e,t)=>{if(t.type==="field"){return e}if(t.type==="group"){return processGroupSchema(e,t)}return processListSchema(e,t)};const processGroupSchema=(e,t)=>{const o={};Object.keys(t.schemas).forEach((n=>{const s=getInnerData(e,n,t.schemas[n].type);o[n]=toFormValue(s,t.schemas[n])}));return o};const processListSchema=(e,t)=>{const o=t;const n=[];const s=Array.isArray(e)?e:[];const a=Array.isArray(o.schema)?o.schema:[o.schema];s.forEach(((e,t)=>{if(t>a.length-1){t=a.length-1}n.push(toFormValue(e,a[t]))}));return n};const getInnerData=(e,t,o)=>{if(e==null){return null}const n=e[t];if(n!==undefined){return n}else if(o==="field"){return null}return e};Object.defineProperty(t,"ModalConfig",{enumerable:true,get:function(){return u.ModalConfig}});t.ALERT_CONFIG_DEFAULTS=Xe;t.ALERT_CONFIG_DEFAULTS_TOKEN=Ze;t.AbstractCachedRestService=AbstractCachedRestService;t.Alert=Alert;t.AnnotationService=AnnotationService;t.BackendEntry=BackendEntry;t.BaseValueAccessor=BaseValueAccessor;t.BooleanUtils=BooleanUtils;t.BrowserService=BrowserService;t.CacheAction=CacheAction;t.CacheConfig=F;t.CacheConfigAnnotationFactory=CacheConfigAnnotationFactory;t.Cached=U;t.CachedAnnotationFactory=CachedAnnotationFactory;t.CloneableUtils=CloneableUtils;t.CryptographicUtils=CryptographicUtils;t.DEFAULT_AUTHENTICATION_CLIENT_ID=oe;t.DEFAULT_AUTHENTICATION_ENTRY_POINT=te;t.DEFAULT_AUTH_MAP=ne;t.DEFAULT_CREDENTIALS_MAP=se;t.DEFAULT_LANGUAGE_ISO=de;t.DefaultCacheTiming=DefaultCacheTiming;t.DefaultRetryStrategy=Pe;t.DynamicForm=DynamicForm;t.DynamicInput=DynamicInput;t.EVENTS=ce;t.EVENT_SERVICE=J;t.EXPONENTIAL_RETRY_DEFAULT_SETTING=we;t.EvictionTag=EvictionTag;t.ExponentialRetry=ExponentialRetry;t.ExponentialRetryStrategy=Ae;t.FORM_PROP=Qe;t.FileValidatorFactory=FileValidatorFactory;t.FingerPrintingService=FingerPrintingService;t.FormField=FormField;t.FormGrouping=FormGrouping;t.FormList=FormList;t.FormPropDecorator=FormPropDecorator;t.FunctionsUtils=FunctionsUtils;t.GET_REQUESTS_ON_HOLD_MAP=ke;t.HTTP_METHODS_READ=Ie;t.HTTP_METHODS_UPDATE=be;t.HttpUtils=HttpUtils;t.I18N_RESOURCE_URI_TOKEN=X;t.I18N_ROOT_RESOURCE_URI=ie;t.IAlertService=IAlertService;t.IAuthenticationManagerService=IAuthenticationManagerService;t.IAuthenticationService=IAuthenticationService;t.IModalService=IModalService;t.ISelectAdapter=ISelectAdapter;t.ISessionService=ISessionService;t.ISettingsService=ISettingsService;t.ISharedDataService=ISharedDataService;t.IStorageService=IStorageService;t.ITranslationsFetchService=ITranslationsFetchService;t.InputPropDecorator=InputPropDecorator;t.InputProperties=InputProperties;t.InputPropertyChange=InputPropertyChange;t.InvalidateCache=InvalidateCache;t.InvalidateCacheAnnotationFactory=InvalidateCacheAnnotationFactory;t.LANDING_PAGE_PATH=ae;t.LANGUAGE_SERVICE=me;t.LANGUAGE_SERVICE_CONSTANTS=pe;t.LIBRARY_NAME=K;t.LINEAR_RETRY_DEFAULT_SETTING=Ee;t.LanguageDropdown=LanguageDropdown;t.LanguageDropdownAdapter=LanguageDropdownAdapter;t.LanguageDropdownHelper=LanguageDropdownHelper;t.LinearRetry=LinearRetry;t.LinearRetryStrategy=Oe;t.LogService=LogService;t.LoginDialogResourceProvider=Ge;t.OPERATION_CONTEXT_TOKEN=Re;t.OperationContextAnnotationFactory=OperationContextAnnotationFactory;t.OperationContextRegistered=De;t.PropDecorator=PropDecorator;t.REAUTH_STARTED=ee;t.RarelyChangingContentName=ue;t.RestClient=RestClient;t.SELECTED_LANGUAGE=le;t.SIMPLE_RETRY_DEFAULT_SETTING=Te;t.SWITCH_LANGUAGE_EVENT=re;t.SimpleRetry=SimpleRetry;t.StringUtils=StringUtils;t.StripResponseHeaders=StripResponseHeaders;t.TESTMODESERVICE=fe;t.URIBuilder=URIBuilder;t.UrlUtils=UrlUtils;t.ValidatorParameters=ValidatorParameters;t.WHO_AM_I_RESOURCE_URI_TOKEN=Y;t.WindowUtils=WindowUtils;t.annotationService=D;t.booleanUtils=A;t.clientErrorPredicate=clientErrorPredicate;t.cloneableUtils=f;t.commonNgZone=I;t.defaultRetryStrategyFactory=defaultRetryStrategyFactory;t.exponentialRetryStrategyFactory=exponentialRetryStrategyFactory;t.functionsUtils=b;t.getPersistenceMap=getPersistenceMap;t.httpUtils=O;t.linearRetryStrategyFactory=linearRetryStrategyFactory;t.moduleUtils=E;t.noInternetConnectionErrorPredicate=noInternetConnectionErrorPredicate;t.promiseUtils=P;t.rarelyChangingContent=he;t.readPredicate=readPredicate;t.retriableErrorPredicate=retriableErrorPredicate;t.serverErrorPredicate=serverErrorPredicate;t.stringUtils=S;t.timeoutErrorPredicate=timeoutErrorPredicate;t.toFormValue=toFormValue;t.updatePredicate=updatePredicate;t.urlUtils=C;t.windowUtils=w},829:function(e,t){},831:function(e,t){},841:function(e,t){},843:function(e,t){},86:function(e,t,o){"use strict";(function(e){$exceptionHandler.$inject=["$log"];GatewayProxiedAnnotationFactory.$inject=["gatewayProxy"];$translateStaticFilesLoader.$inject=["$q","translationsFetchService"];Object.defineProperty(t,"__esModule",{value:true});var n=o(139);var s=o(824);var a=o(274);var r=o(93);var d=o(0);var p=o(935);var m=o(936);var g=o(133);var u=o(3);var v=o(42);var f=o(4);var S=o(105);var C=o(197);var b=o(46);var I=o(136);var w=o(20);var E=o(556);var P=o(366);var A=o(120);var O=o(40);var x=o(937);function _interopDefaultLegacy(e){return e&&typeof e==="object"&&"default"in e?e:{default:e}}function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(o){if(o!=="default"){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:true,get:function(){return e[o]}})}}))}t["default"]=e;return Object.freeze(t)}var D=_interopNamespace(a);var k=_interopNamespace(r);var F=_interopDefaultLegacy(p);var V=_interopDefaultLegacy(u);var U=_interopDefaultLegacy(P);angular.module("yLoDashModule",[]).factory("lodash",(function(){if(!window.smarteditLodash){if(window._&&window._.noConflict){window.smarteditLodash=window._.noConflict()}else{throw"could not find lodash library under window._ namespace"}}return window.smarteditLodash}));(function(){var e=e||window.angular;var t=null;try{t=e.module("coretemplates")}catch(e){}t=t||e.module("coretemplates",[]);t.run(["$templateCache",function(e){e.put("HelpComponent.html",'<se-tooltip [triggers]="[\'mouseenter\', \'mouseleave\']" placement="auto" [isChevronVisible]="true" [title]="title" class="se-help"><span se-tooltip-trigger class="sap-icon--sys-help se-y-help-icon"></span><ng-content se-tooltip-body></ng-content></se-tooltip>');e.put("ClientPagedListCellComponent.html",'<ng-container *ngIf="key.component; else cellText"><ng-container *ngComponentOutlet="key.component; injector: componentInjector"></ng-container></ng-container><ng-template #cellText><span>{{ item[key.property] }}</span></ng-template>');e.put("ClientPagedListComponent.html",'<div class="fluid-container se-paged-list-result"><p class="se-page-list__page-count" *ngIf="displayCount"><span>({{ totalItems }} {{ \'se.pagelist.countsearchresult\' | translate }})</span></p><table class="se-paged-list-table table table-striped table-hover techne-table"><thead><tr><th *ngFor="let key of keys; trackBy: keysTrackBy" (click)="onOrderByColumn(key.property)" [ngStyle]="{ \'width\': columnWidth + \'%\' }" class="se-paged-list__header" [ngClass]="\'se-paged-list__header-\' + key.property"><ng-container *ngIf="key.i18n">{{ key.i18n | translate }} <span class="header-icon" [hidden]="visibleSortingHeader !== key.property" [ngClass]="{                          \'sap-icon--navigation-down-arrow\': headersSortingState[key.property],                          \'sap-icon--navigation-up-arrow\': !headersSortingState[key.property]                      }"></span></ng-container></th><th class="se-paged-list__header"></th><th class="se-paged-list__header" *ngIf="dropdownItems"></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of filteredItems" class="techne-table-xs-right techne-table-xs-left se-paged-list-item"><td *ngFor="let key of keys" [ngClass]="\'se-paged-list-item-\' + key.property"><se-client-paged-list-cell [item]="item" [key]="key"></se-client-paged-list-cell></td><td><se-tooltip *ngIf="item.icon" [triggers]="[\'mouseenter\', \'mouseleave\']" [placement]="\'bottom\'" [title]="\'se.icon.tooltip.visibility\' | translate: { numberOfRestrictions: item.icon.numberOfRestrictions }" [isChevronVisible]="true"><img [src]="item.icon.src" se-tooltip-trigger/></se-tooltip></td><ng-container *ngIf="dropdownItems"><td *seHasOperationPermission="\'se.edit.page\'" class="paged-list-table__body__td paged-list-table__body__td-menu"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="item" class="pull-right"></se-dropdown-menu></td></ng-container></tr></tbody></table><div class="pagination-container"><se-pagination [totalItems]="totalItems < itemsPerPage ? itemsPerPage : totalItems" [itemsPerPage]="itemsPerPage" (onChange)="onCurrentPageChange($event)" [currentPage]="currentPage" class="pagination-lg"></se-pagination></div></div>');e.put("CollapsibleContainerComponent.html",'<div role="tab" class="collapsible-container__header" [ngClass]="{        \'collapsible-container__header--icon-right\': isIconRight(),        \'collapsible-container__header--icon-left\': isIconLeft()    }" [attr.id]="headingId" [attr.aria-selected]="isOpen" (keypress)="handleKeypress($event)"><button type="button" tabindex="0" class="collapsible-container__header__title" (click)="toggle()" [attr.aria-expanded]="isOpen" [attr.aria-controls]="panelId"><ng-content select="se-collapsible-container-header"></ng-content></button> <a class="collapsible-container__header__button btn btn-link" *ngIf="configuration.iconVisible" [ngClass]="{            \'collapsible-container__header__button--expanded\': isOpen        }" [title]="isOpen            ? \'se.ycollapsible.action.collapse\'            : (\'se.ycollapsible.action.expand\' | translate)        " [attr.aria-expanded]="isOpen" (click)="toggle()"><span class="sap-icon--navigation-down-arrow collapsible-container__header__icon"></span></a></div><div #container class="collapsible-container__content panel" [ngStyle]="{ \'max-height.px\': isOpen ? containerHeight : 0 }" [attr.id]="panelId" [attr.aria-labelledby]="headingId" [attr.aria-hidden]="!isOpen" role="tabpanel"><ng-content select="se-collapsible-container-content"></ng-content></div>');e.put("ConfirmDialogComponent.html",'<ng-container *ngIf="config"><se-message *ngIf="config.message" [type]="config.message.type" [messageId]="config.message.id"><ng-container se-message-description><span [translate]="config.message.text"></span></ng-container></se-message><div id="confirmationModalDescription" [ngClass]="{ \'fd-has-margin-top-small\' : config.message }" [translate]="config.description" [translateParams]="config.descriptionPlaceholders"></div></ng-container>');e.put("DataTableComponent.html",'<table class="se-paged-list-table fd-table"><thead><tr><th *ngFor="let column of columns" (click)="sortColumn(column)" [ngStyle]="{\'width.\': columnWidth + \'%\'}" [ngClass]="\'se-paged-list__header-\'+column.property" class="se-paged-list__header">{{ column.i18n | translate }} <span class="se-data-table__sort" *ngIf="visibleSortingHeader === column.property" [ngClass]="{                         \'sap-icon--sort-descending\': headersSortingState[column.property],                        \'sap-icon--sort-ascending\': !headersSortingState[column.property] }"></span></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of items" class="se-paged-list-item"><td *ngFor="let column of columns" [ngClass]="\'se-paged-list-item-\'+column.property"><se-data-table-renderer [column]="column" [item]="item"></se-data-table-renderer></td></tr></tbody></table>');e.put("DynamicPagedListComponent.html",'<div *ngIf="ready" class="se-dynamic-paged-list"><div class="fd-panel__body fd-panel__body--bleed"><se-data-table [columns]="columns" [config]="config" [items]="items" [sortStatus]="sortStatus" (onSortColumn)="orderByColumn($event)"></se-data-table></div><div class="fd-panel__footer"><se-pagination *ngIf="!!items.length" class="se-dynamic-list__pagination" [totalItems]="totalItems" [itemsPerPage]="config.itemsPerPage" [currentPage]="currentPage" (onChange)="onCurrentPageChange($event)"></se-pagination><span class="se-paged-list__page-count-wrapper se-paged-list__page-count-wrapper--footer"><span class="span-page-list__page-count-text">{{\'se.pagelist.countsearchresult\' | translate}} </span><span class="se-page-list__page-count">({{ totalItems }})</span></span></div></div><se-spinner [isSpinning]="!ready"></se-spinner>');e.put("GenericEditorComponent.html",'<ng-template let-state [formBuilder]="{schema$: editor.schema$, data$: editor.data$}" (stateCreated)="setFormState($event)"><div class="se-generic-editor"><se-generic-editor-breadcrumb></se-generic-editor-breadcrumb><ng-container *ngIf="state; else noSupport"><form novalidate #nativeForm class="no-enter-submit se-generic-editor__form" [contentManager]="{onSave: editor.submit$}" (onSuccess)="editor.onSuccess($event)" (onError)="editor.onFailure($event)"><div class="modal-header se-generic-editor__header" *ngIf="modalHeaderTitle"><h4 class="modal-title">{{modalHeaderTitle| translate}}</h4></div><div class="se-generic-editor__body"><ng-template [formRenderer]="state.group"></ng-template></div><div class="se-generic-editor__footer modal-footer" *ngIf="editor && showCommands()"><button fd-button id="submit" name="submit" options="emphasized" *ngIf="showSubmit()" [seSubmitBtn]="editor.isSubmitDisabled">{{editor.submitButtonText | translate}}</button> <button fd-button id="cancel" type="button" options="light" *ngIf="showCancel()" (click)="_reset()">{{editor.cancelButtonText | translate}}</button></div></form></ng-container><ng-template #noSupport><div class="se-generic-editor__body"><se-message type="info" id="GenericEditor.NoEditingSupportDisclaimer"><ng-container se-message-description>{{ \'se.editor.notification.editing.not.supported\' | translate }}</ng-container></se-message></div></ng-template></div></ng-template>');e.put("InfiniteScrollingComponent.html",'<div #container class="se-infinite-scrolling__container" [ngClass]="dropDownContainerClass" fdInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div class="se-infinite-scrolling__holder" [ngClass]="dropDownClass"><div #content><ng-content></ng-content></div><div class="spinner-container"><se-spinner [isSpinning]="isLoading" [isFluid]="false"></se-spinner></div></div></div>');e.put("genericEditorComponentTemplate.html",'<se-generic-editor [id]="$ctrl.id" [smartedit-component-id]="$ctrl.smarteditComponentId" [smartedit-component-type]="$ctrl.smarteditComponentType" [structure]="$ctrl.structure" [structure-api]="$ctrl.structureApi" [content]="$ctrl.content" [content-api]="$ctrl.contentApi" [(submit)]="$ctrl.submit" [(reset)]="$ctrl.reset" [(is-dirty)]="$ctrl.isDirty" [(is-valid)]="$ctrl.isValid" [editor-stack-id]="$ctrl.editorStackId" [update-callback]="$ctrl.updateCallback" [custom-on-submit]="$ctrl.customOnSubmit" [uri-context]="$ctrl.uriContext" (get-api)="$ctrl.getApi($event)"></se-generic-editor>');e.put("EditableListComponent.html",'<div [ngClass]="{ \'y-editable-list-disabled\': !editable, \'se-editable-list-disabled\': !editable }"><se-tree (onTreeUpdated)="handleTreeUpdated($event)" [removeDefaultTemplate]="true" [rootNodeUid]="rootId" [nodeTemplateUrl]="itemTemplateUrl" [nodeComponent]="itemComponent" [nodeActions]="actions" [dragOptions]="dragOptions" [showAsList]="true"></se-tree></div>');e.put("moreTextTemplate.html",'<se-more-text [text]="$ctrl.text" [limit]="$ctrl.limit" [more-label-i18n-key]="$ctrl.moreLabelI18nKey" [less-label-i18n-key]="$ctrl.lessLabelI18nKey" [ellipsis]="$ctrl.ellipsis"></se-more-text>');e.put("PaginationComponent.html",'<fd-pagination class="se-pagination" [displayTotalItems]="displayTotalItems" [totalItems]="totalItems" [itemsPerPage]="totalItems === 1 ? 1 : itemsPerPage" [currentPage]="currentPage" (pageChangeStart)="onPageChanged($event)" nextLabel="&rsaquo; " previousLabel="&lsaquo; "></fd-pagination>');e.put("SelectComponent.html",'<fd-select [style.display]="\'none\'"></fd-select><div [attr.id]="id + \'-selector\'" class="select-container" [ngClass]="{        \'has-warning\': hasWarning(),        \'has-error\': hasError()    }"><ng-container *ngIf="multiSelect; then multi; else singleSelect"></ng-container><ng-template #singleSelect><fd-popover [triggers]="[\'click\']" [(isOpen)]="isOpen" [placement]="\'bottom\'" (isOpenChange)="onSingleSelectIsOpenChange($event)"><fd-popover-control><div class="selected-container fd-select-custom" [attr.has-selected-option]="!!selected || null"><button fd-button class="fd-select-button-custom toggle-button" [disabled]="isReadOnly"><span *ngIf="!selected; else selectedItem" class="selected-placeholder">{{ placeholder | translate }}</span><ng-template #selectedItem><div class="selected-item"><span *ngIf="controls" class="glyphicon glyphicon-search"></span><se-item-printer *ngIf="selected" [attr.id]="id + \'-selected\'" [item]="selected" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span *ngIf="controls || showRemoveButton" class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, selected)"></span></div></ng-template></button></div></fd-popover-control><fd-popover-body><fd-menu class="se-select-list-container"><ng-container *ngIf="searchEnabled && isOpen"><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></ng-container><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></fd-menu></fd-popover-body></fd-popover></ng-template><ng-template #multi><div [ngClass]="{\'se-multi-select\': selected && selected.length > 0}"><div class="selected-container se-selected-list"><ng-container *ngIf="selected && selected.length > 0"><ol class="selected-list" cdkDropList (cdkDropListDropped)="onDrop($event)"><li *ngFor="let item of selected; trackBy: itemTrackBy" cdkDrag class="selected-list__item selected-item"><se-item-printer [item]="item" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, item)"></span></li></ol></ng-container></div></div><fd-popover class="se-multi-select" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="\'bottom\'"><fd-popover-control><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></fd-popover-control><fd-popover-body><fd-menu class="se-select-list-container"><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></fd-menu></fd-popover-body></fd-popover></ng-template><ng-template #resultsHeader><se-select-results-header [search]="search" [resultsHeaderComponent]="resultsHeaderComponent" [resultsHeaderLabel]="resultsHeaderLabel" [displayResultsHeaderLabel]="showResultsHeaderLabel()" [actionableSearchItem]="actionableSearchItem" (actionButtonClick)="closeAndReset()"></se-select-results-header></ng-template><ng-template #searchInputTemplate><se-select-search-input [isDisabled]="isReadOnly" [isReadOnly]="multiSelect && !searchEnabled" [isTypeAheadEnabled]="!multiSelect" [placeholder]="showPlaceholder() ? (placeholder | translate) : \'\'" [search]="search" (searchKeyup)="onSearchInputKeyup($event.event, $event.value)" (searchChange)="onSearchInputChange($event)"></se-select-search-input></ng-template><ng-template #selectListTemplate><se-select-list [id]="id" [isPagedDropdown]="isPagedDropdown()" [fetchPage]="fetchStrategy.fetchPage" [search]="search" [items]="items" [selected]="selected" [excludeSelected]="multiSelect" [disableChoiceFn]="disableChoiceFn" [itemComponent]="itemComponent" [selectComponentCtx]="this" (optionClick)="onOptionClick($event)" (infiniteScrollItemsChange)="onInfiniteScrollItemsChange()"></se-select-list></ng-template></div>');e.put("ShortcutLinkTemplate.html",'<ng-container #container><ng-template #defaultTemplate let-shortcutLink><div class="se-shortcut-link"><a class="se-shortcut-link__item" [ngClass]="{\'se-shortcut-link__item--active\': shortcutLink.active}" (click)="onClick(shortcutLink)">{{shortcutLink.titleI18nKey | translate}}</a></div></ng-template></ng-container>');e.put("SliderPanelComponent.html",'<div class="se-slider-panel-wrapper" *ngIf="isShown"><div class="se-slider-panel-container slide-in"><div class="se-slider-panel__header" *ngIf="sliderPanelConfiguration.modal"><span class="se-slider-panel__title" *ngIf="sliderPanelConfiguration.modal.title">{{ sliderPanelConfiguration.modal.title | translate }}</span> <button type="button" class="se-slider-panel__close-btn fd-button--light fd-modal__close" aria-label="close" *ngIf="sliderPanelConfiguration.modal.showDismissButton" (click)="sliderPanelDismissAction()"></button></div><div class="se-slider-panel__body"><ng-content></ng-content></div><div class="se-slider-panel__footer" *ngIf="sliderPanelConfiguration.modal && (sliderPanelConfiguration.modal.cancel || sliderPanelConfiguration.modal.save)"><button type="button" class="fd-button--emphasized se-slider-panel__footer-btn se-slider-panel__footer-btn--save" *ngIf="sliderPanelConfiguration.modal.save" (click)="sliderPanelConfiguration.modal.save.onClick()" [disabled]="isSaveDisabled()">{{ sliderPanelConfiguration.modal.save.label | translate }}</button> <button type="button" class="fd-button--light se-slider-panel__footer-btn se-slider-panel__footer-btn--cancel" *ngIf="sliderPanelConfiguration.modal.cancel" (click)="sliderPanelConfiguration.modal.cancel.onClick()">{{ sliderPanelConfiguration.modal.cancel.label | translate }}</button></div></div></div>');e.put("TabComponent.html",'<ng-container *ngComponentOutlet="tab.component; injector: tabInjector"></ng-container>');e.put("TabsComponent.html",'<div class="se-tabset-wrapper"><ul class="nav nav-tabs se-tabset" role="tablist" *ngIf="isInitialized"><ng-container *ngIf="tabsList.length !== numTabsDisplayed"><ng-container *ngFor="let tab of (getVisibleTabs() | async); trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><ng-container *ngIf="tabsList && tabsList.length == numTabsDisplayed"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><su-select class="se-tabset__select" *ngIf="tabsList.length > numTabsDisplayed && (getDropdownTabs() | async)" [items]="dropdownTabs" [isKeyboardControlEnabled]="false" [hasCustomTrigger]="true" (onItemSelected)="selectTab($event.value)"><li [ngClass]="{\'active\': isActiveInMoreTab()}" su-select-custom-trigger><a [ngClass]="{\'sm-tab-error\': dropDownHasErrors()}" class="dropdown-toggle"><span *ngIf="!isActiveInMoreTab()" class="multi-tabs__more-span">{{ \'se.ytabset.tabs.more\' | translate }} </span><span *ngIf="isActiveInMoreTab()" class="multi-tabs__more-span">{{selectedTab.title | translate}} </span><span class="caret"></span></a></li></su-select><ng-template #tabsetLink let-tab><li [ngClass]="{                     \'active\': tab.id === selectedTab.id,                    \'se-tabset__tab--disabled\': tab.disabled                }" [attr.tab-id]="tab.id" class="se-tabset__tab"><a [ngClass]="{\'sm-tab-error\': tab.hasErrors}" class="se-tabset__link mycustomtabset" (click)="selectTab(tab)" *ngIf="!tab.message">{{tab.title | translate}}</a><se-tooltip [triggers]="[\'mouseover\']" *ngIf="tab.message"><a se-tooltip-trigger [ngClass]="{\'sm-tab-error\': tab.hasErrors}" class="se-tabset__link" (click)="selectTab(tab)">{{tab.title | translate}} </a><span se-tooltip-body>{{ tab.message }}</span></se-tooltip></li></ng-template></ul><div class="se-tab-set__content-wrapper" *ngIf="selectedTab"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById"><se-tab [hidden]="tab.id !== selectedTab.id" [attr.tab-id]="tab.id" [tab]="tab" [model]="model"></se-tab></ng-container></div></div>');e.put("TreeComponent.html",'<div class="categoryTable se-tree"><div class="se-tree__body"><div class="desktopLayout"><ol class="se-tree__nodes"><li *ngIf="(this.treeService.dataSource.get() | async).length === 0" class="se-tree__nodes--nodata">{{ \'se.ytree.no.nodes.to.display\' | translate }}</li><li class="se-tree__nodes--item"><se-tree-node [source]="this.treeService.dataSource.get() | async"></se-tree-node></li></ol></div></div></div>');e.put("TreeNodeComponent.html",'<ol class="se-tree-node__ol angular-ui-tree-nodes" cdkDropList (cdkDropListDropped)="onDrop($event)" [cdkDropListData]="source" [cdkDropListDisabled]="isDisabled"><li *ngFor="let node of source" cdkDrag [cdkDragData]="node" class="angular-ui-tree-node se-tree-node__li"><se-tree-node-renderer [node]="node"></se-tree-node-renderer></li></ol>');e.put("TreeNodeRendererComponent.html",'<div class="tree-node tree-node-content se-tree-node angular-ui-tree-handle" [ngClass]="{        \'hovered\': node.mouseHovered,        \'se-tree-node--first-level\': isRootNodeDescendant,        \'se-tree-node--selected\': !collapsed    }" [ngStyle]="{        \'padding-left\': getPaddingLeft(node.level)    }" [attr.level]="node.level" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()"><div *ngIf="!showAsList" class="se-tree-node__expander--wrapper col-xs-1 text-center"><a class="se-tree-node__expander btn btn-link btn-sm" *ngIf="node.hasChildren" [attr.disabled]="isDisabled || null" (click)="toggle($event)"><span [ngClass]="{                    \'sap-icon--slim-arrow-right\': collapsed,                    \'sap-icon--slim-arrow-down\': !collapsed                }"></span></a></div><div *ngIf="displayDefaultTemplate" class="se-tree-node__name col-xs-5" [attr.title]="node.title | seL10n | async "><span>{{node.name}}</span><h6 *ngIf="node.title">{{node.title | seL10n | async }}</h6></div><div [ngStyle]="{\'width\': \'100%\'}" *ngIf="tree.nodeTemplateUrl" [ngInclude]="tree.nodeTemplateUrl" [scope]="{node: node}" [compileHtmlNgController]="legacyController"></div><ng-container *ngIf="tree.nodeComponent"><ng-container *ngComponentOutlet="tree.nodeComponent; injector: nodeComponentInjector"></ng-container></ng-container></div><se-tree-node [source]="node.nodes" *ngIf="node.nodes.length && node.isExpanded"></se-tree-node>');e.put("DropdownMenuComponent.html",'<fd-popover [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="placement || \'bottom-end\'" class="se-dropdown-more-menu"><fd-popover-control><div #toggleMenu><div *ngIf="!useProjectedAnchor; else projectedAnchor;" class="sap-icon--overflow se-dropdown-more-menu__toggle"></div><ng-template #projectedAnchor><ng-content></ng-content></ng-template></div></fd-popover-control><fd-popover-body><fd-menu><ul fd-menu-list class="se-dropdown-menu__list" [ngClass]="additionalClasses"><se-dropdown-menu-item *ngFor="let dropdownItem of clonedDropdownItems" [dropdownItem]="dropdownItem" [selectedItem]="selectedItem"></se-dropdown-menu-item></ul></fd-menu></fd-popover-body></fd-popover>');e.put("DropdownMenuItemComponent.html",'<li *ngIf="dropdownItem.condition(selectedItem)" class="se-dropdown-menu__item-wrapper" [ngClass]="dropdownItem.customCss"><ng-container *ngComponentOutlet="dropdownItem.component; injector: dropdownItemInjector"></ng-container></li>');e.put("DropdownMenuItemDefaultComponent.html",'<a class="se-dropdown-item fd-menu__item" [ngClass]="data.dropdownItem.customCss" (click)="data.dropdownItem.callback(data.selectedItem, data.dropdownItem)"><span *ngIf="data.dropdownItem.icon" [ngClass]="data.dropdownItem.icon"></span> <span>{{ data.dropdownItem.key | translate }}</span></a>');e.put("GenericEditorFIeldMessagesComponent.html",'<div *ngIf="errors.length > 0"><span *ngFor="let error of errors" class="se-generic-editor__error se-help-block--has-error help-block fd-form__message fd-form__message--error">{{ error | translate}}</span></div><div *ngIf="warnings.length > 0"><span *ngFor="let warning of warnings" class="se-generic-editor__warning se-help-block--has-warning help-block fd-form__message fd-form__message--warning">{{ warning | translate }}</span></div>');e.put("GenericEditorFieldComponent.html",'<div [attr.validation-id]="field.qualifier" class="ySEField"><div *ngIf="field.template"><div #widget></div></div><ng-container *ngIf="field.component"><ng-container *ngComponentOutlet="field.component; injector: widgetInjector"></ng-container></ng-container><se-generic-editor-field-messages [field]="field" [qualifier]="qualifier"></se-generic-editor-field-messages><div *ngIf="field.postfix" class="ySEText ySEFieldPostfix">{{ field.postfix | translate }}</div></div>');e.put("GenericEditorTabComponent.html",'<div class="se-generic-editor__row ySErow" *ngFor="let field of fields" [ngClass]="\'se-generic-editor__row--\' + field.qualifier"><label [id]="field.qualifier + \'-label\'" class="se-control-label" *ngIf="!field.hideFieldWidget && !field.hidePrefixLabel && field.i18nKey" [hidden]="field.hideFieldWidget && field.hidePrefixLabel" [ngClass]="{ required: field.required }">{{ field.i18nKey | lowercase | translate }}</label><se-help class="se-help-tooltip" *ngIf="field.tooltip"><span>{{ field.tooltip | translate }}</span></se-help><div class="ySEGenericEditorFieldStructure" [hidden]="field.hideFieldWidget" [id]="field.qualifier" [attr.data-cms-field-qualifier]="field.qualifier" [attr.data-cms-structure-type]="field.cmsStructureType"><ng-template [formRenderer]="getForm(field.qualifier)"></ng-template></div></div>');e.put("LocalizedElementComponent.html",'<se-tabs *ngIf="tabs" class="multi-tabs-editor" [model]="form" [tabsList]="tabs" [numTabsDisplayed]="6"></se-tabs>');e.put("errorMessageTemplate.html",'<span data-ng-if="field.errors" data-ng-repeat="error in field.errors | filter:{language:qualifier}" id="validation-error-{{field.qualifier}}-{{qualifier}}-{{$index}}" class="se-help-block--has-error help-block fd-form__message fd-form__message--error">{{ error.message | translate }}</span>');e.put("ActionableSearchItemComponent.html",'<div *ngIf="search" class="se-actionable-search-item"><div class="se-actionable-search-item__name">{{ search }}</div><button type="button" class="fd-button--light se-actionable-search-item__action-btn" (click)="onButtonClick()">{{ getActionText() | translate }}</button></div>');e.put("DefaultItemPrinterComponent.html",'<span [attr.title]="((data.item.label || data.item.name) | seL10n | async) | translate" class="se-item-printer-text se-nowrap-ellipsis">{{ ((data.item.label || data.item.name) | seL10n | async) | translate }}</span>');e.put("ItemPrinterComponent.html",'<ng-container *ngComponentOutlet="component; injector: componentInjector"></ng-container>');e.put("ResultsHeaderComponent.html",'<div *ngIf="showResultsHeaderItem() || resultsHeaderLabel || actionableSearchItem" class="results-header"><div *ngIf="showResultsHeaderItem()"><ng-container *ngComponentOutlet="resultsHeaderComponent"></ng-container></div><se-actionable-search-item *ngIf="actionableSearchItem" [search]="search" [eventId]="actionableSearchItem.eventId" [actionText]="actionableSearchItem.actionText" (actionButtonClick)="onActionButtonClick()"></se-actionable-search-item><li class="fd-menu__list-header" *ngIf="displayResultsHeaderLabel">{{ resultsHeaderLabel | translate }}</li></div>');e.put("SearchInputComponent.html",'<div class="search"><input #searchInput type="search" class="search__input" [disabled]="isDisabled" [readOnly]="isReadOnly" [placeholder]="placeholder" [ngModel]="search" (ngModelChange)="onChange($event)" (keyup)="onKeyup($event)"/></div>');e.put("SelectListComponent.html",'<se-infinite-scrolling *ngIf="isPagedDropdown; else selectList" [pageSize]="infiniteScrollingPageSize" [mask]="search" [fetchPage]="fetchPage" [context]="selectComponentCtx" (itemsChange)="onInfiniteScrollItemsChange()"><ng-container *ngTemplateOutlet="selectList"></ng-container></se-infinite-scrolling><ng-template #selectList><ol [attr.id]="id +\'-list\'" fd-menu-list suListKeyboardControl [suListKeyboardControlDisabledPredicate]="keyboardControlDisabledPredicate" (suListKeyboardControlEnterKeydown)="onEnterKeydown($event)" [ngClass]="{ \'fd-menu__list--basic\': !isPagedDropdown }"><ng-container *ngFor="let item of items; trackBy: itemTrackBy"><li *ngIf="(excludeSelected && !isItemSelected(item)) || !excludeSelected" suListItemKeyboardControl class="se-select-list__item" [ngClass]="{\'is-selected\': (!excludeSelected && isItemSelected(item)), \'is-disabled\': isItemDisabled(item)}"><fd-option (click)="onOptionClick($event, item)" class="menu-option"><se-item-printer [item]="item" [isSelected]="false" [component]="itemComponent" [selectComponentCtx]="selectComponentCtx"></se-item-printer></fd-option></li></ng-container></ol></ng-template>');e.put("GenericEditorDropdownComponent.html",'<se-select *ngIf="dropdown.initialized" [id]="dropdown.qualifier" (click)="dropdown.onClick()" [placeholder]="field.placeholder" [(model)]="model[qualifier]" [onChange]="dropdown.triggerAction" [fetchStrategy]="dropdown.fetchStrategy" [(reset)]="dropdown.reset" [multiSelect]="dropdown.isMultiDropdown" [controls]="dropdown.isMultiDropdown" [showRemoveButton]="showRemoveButton" [isReadOnly]="!field.editable" [itemComponent]="itemComponent" [resultsHeaderComponent]="resultsHeaderComponent" [actionableSearchItem]="actionableSearchItem" (getApi)="dropdown.setSelectAPI($event)" (resetChange)="onResetChange($event)"></se-select>');e.put("BooleanComponent.html",'<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label" for="{{qualifierId}}-checkbox"><input type="checkbox" id="{{qualifierId}}-checkbox" class="se-boolean__input" [placeholder]="(widget.field.tooltip || \'\') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]" (click)="checkboxOnClick($event.target)"/> <span class="fd-toggle__switch" role="presentation"></span></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>');e.put("DateTimePickerComponent.html",'<div #dateTimePicker *ngIf="isEditable" class="input-group se-date-field" id="date-time-picker-{{widget.field.qualifier}}"><input type="text" class="fd-form-control se-date-field--input" [ngClass]="{            \'is-invalid\': widget.field.hasErrors,            \'is-warning\': widget.field.hasWarnings,            \'se-input--is-disabled\': !isEditable        }" [placeholder]="placeholderText | translate" [attr.name]="widget.field.qualifier"/> <span class="input-group-addon se-date-field--button" [ngClass]="{ \'se-date-field--button-has-error\': widget.field.hasErrors, \'se-date-field--button-has-warning\': widget.field.hasWarnings }"><span class="sap-icon--calendar se-date-field--button-icon"></span></span></div><div class="input-group date se-date-field" *ngIf="!isEditable" id="date-time-picker-{{widget.field.qualifier}}"><input type="text" class="fd-form-control se-date-field--input" [ngClass]="{\'se-input--is-disabled\': !isEditable}" [(ngModel)]="widget.model[this.widget.qualifier]" dateFormatter formatType="short" [disabled]="true"/></div>');e.put("EditableDropdownComponent.html",'<se-generic-editor-dropdown [id]="data.id" [field]="data.field" [qualifier]="data.qualifier" [model]="data.model"></se-generic-editor-dropdown>');e.put("EmailComponent.html",'<input [ngClass]="{ \'is-invalid\': widget.field.hasErrors, \'is-warning\': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || \'\') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [max]="255" type="email" id="{{widget.field.qualifier}}-shortstring" class="fd-form-control"/>');e.put("FloatComponent.html",'<input pattern="^[-]?([0-9]*)(.[0-9]{1,5})?$" type="number" id="{{widget.field.qualifier}}-float" class="fd-form-control" [ngClass]="{ \'is-invalid\': widget.field.hasErrors, \'is-warning\': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || \'\') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [step]="precision"/>');e.put("NumberComponent.html",'<input [min]="1" [ngClass]="{ \'is-invalid\': widget.field.hasErrors, \'is-warning\': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || \'\') | translate" [attr.name]="widget.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" id="{{widget.qualifier}}-number" class="fd-form-control" type="number"/>');e.put("RichTextFieldComponent.html",'<textarea #textarea class="fd-form__control" [ngClass]="{\'has-error\': widget.field.hasErrors}" name="{{widget.field.qualifier}}-{{widget.qualifier}}" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" (change)="reassignUserCheck()"></textarea><div *ngIf="requiresUserCheck()"><div id="richTextWarningMessage" [hidden]="widget.field.isUserChecked"><span fd-status-label [status]="\'warning\'" [icon]="\'message-warning\'">{{\'se.editor.richtext.message.warning\' | translate}}</span></div><input id="richTextWarningCheckBox" type="checkbox" [(ngModel)]="widget.field.isUserChecked" (click)="checkboxOnClick($event.target)"/> <span [ngClass]="{\'warning-check-msg\': true, \'not-checked\': widget.editor.hasFrontEndValidationErrors && !widget.field.isUserChecked}">{{\'se.editor.richtext.check\' | translate}}</span></div>')}])})();const SeEntryModule=function(e){return function(t){window.__smartedit__.modules[e]=t;return t}};function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}class DINameUtils{buildComponentName(e){return this.buildName(e).replace(/Component$/,"").replace(/Directive$/,"")}buildFilterName(e){return this.buildName(e).replace(/Filter$/,"")}buildServiceName(e){return this.buildName(e)}buildModuleName(e){return this.buildName(e).replace(/Module$/,"")}buildName(e){const t=s.annotationService.getOriginalConstructor(e);const o=s.functionsUtils.getConstructorName(t);return this.convertNameCasing(o)}convertNameCasing(e){const t=e.substring(0,1).toLowerCase()+e.substring(1);return t}makeValueProvider(e){const t=Object.keys(e)[0];const o=t.replace(/^DEFAULT_/,"");return{provide:o,useValue:e[t]}}}const $=new DINameUtils;const K={};const SeModule=function(e){return function(t){const o=$.buildName(t);const n=getAngular();const s=[];if(e.imports){e.imports.forEach(((e,t)=>{const a=handleImportStatement(o,e,n,t);if(s.indexOf(a)>-1){throw new Error(`module ${a} is imported more than once into ${o}`)}s.push(a)}))}const a=n.module(o,s);if(e.providers){addArrayOfProvidersToModule(a,e.providers)}if(e.declarations){e.declarations.forEach((e=>{if(e.filterName){addFilterToModule(a,e)}else{addFullComponentGraphToModule(a,e)}}))}if(e.config){a.config(e.config)}if(e.initialize){a.run(e.initialize)}t.moduleName=a.name;return t}};function handleImportStatement(e,t,o,n){const throwUnAnnotatedModuleError=t=>{const o=$.buildName(t);throw new Error(`${o} module was imported into ${e} module but doesn't seem to have been @SeModule annotated`)};function handleDefaultCondition(){if(!(t&&t.seModule)){throw new Error(`the import statement ${t} at index ${n} added to ${e} is neither a legacy string nor an SeModuleConstructor`)}if(!t.seModule.moduleName){throwUnAnnotatedModuleError(t.seModule)}const a=$.buildName(t.seModule);const r=o.module(a);s=r.name;if(t.providers){addArrayOfProvidersToModule(r,t.providers)}}let s;switch(typeof t){case"string":s=t;break;case"function":s=t.moduleName;if(!s){throwUnAnnotatedModuleError(t)}break;default:handleDefaultCondition();break}return s}function addArrayOfProvidersToModule(e,t){t.forEach(((t,o)=>{const n=e.name;if(!t){throw new Error(`At the time a provider at index ${o} was added to module ${n},\n\t\t\t\tit was undefined, this is probably due to the path in your typescript import statement\n\t\t\t\treferencing a barrel file of an alias defined in a higher layer, consider using a relative path instead.`)}if(t.provide&&!t.useValue&&!t.useClass&&!t.useFactory){throw new Error(`At the time a provider named ${t.provide} was added to module ${n}\n\t\t        did not provide an instance of SeValueProvider, SeClassProvider, or FactoryProvider.`)}if(t.multi){t=t;addMultiProviderToModule(e,t)}else{addProviderToModule(e,t)}}))}function addProviderToModule(e,t){if(t.useValue){t=t;e.constant(t.provide,t.useValue);return}if(t.useClass){t=t;e.service(t.provide,t.useClass);return}if(t.useFactory){addSeFactoryProviderToModule(e,t);return}t=t;const o=$.buildServiceName(t);e.service(o,t)}function addSeFactoryProviderToModule(e,t){t=t;const o=Array.isArray(t.useFactory)||t.useFactory.$inject;if(o&&t.deps){throw Error(`At the time a provider ${t.provide} uses ngInject annotations and \n        SeFactoryProvider.deps at the same time. Please use one or the other.`)}const n=t.deps?t.deps.map((e=>typeof e==="string"?e:$.buildServiceName(e))):[];e.factory(t.provide,o?t.useFactory:[...n,t.useFactory])}function addMultiProviderToModule(e,t){const o=e.name+t.provide;let n=K[o];if(!n){n=[]}const s=o+r.uniqueId();n.push(s);K[o]=n;const useFactory=function(){return[].slice.call(arguments)};addProviderToModule(e,Object.assign(Object.assign({},t),{provide:s}));addProviderToModule(e,{provide:t.provide,useFactory:useFactory,deps:n})}function addFilterToModule(e,t){e.filter(t.filterName,t.transform)}function addFullComponentGraphToModule(e,t){const o=t.definition;if(!o){const o=s.functionsUtils.getConstructorName(t);throw new Error(`${o} component was imported into ${e.name} module but doesn't seem to have been @SeComponent or @SeDirective annotated`)}if(t.providers){addArrayOfProvidersToModule(e,t.providers)}const n=t.componentName;const a=t.directiveName;if(n){e.component(n,o);delete t.definition;const s=t.entryComponents;if(s){s.forEach((t=>{addFullComponentGraphToModule(e,t)}))}delete t.entryComponents}else if(a){e.directive(a,(()=>o))}}SeModule.getAngular=function(){return D};function getAngular(){return SeModule.getAngular()}t.DIBridgeModule=class DIBridgeModule{};t.DIBridgeModule=__decorate([SeModule({})],t.DIBridgeModule);const parseDirectiveBindings=function(e){let t;if(e&&e.length){t=e.reduce(((e,t)=>{const o=t.replace(/\s/g,"").split(":");let n=o[o.length-1];if(!n.startsWith("@")&&!n.startsWith("&")&&!n.startsWith("=")){n="<"+n}e[o[0]]=n;return e}),{})}return t};const parseDirectiveName=function(e,t){const o=/^\[([-\w]+)\]$/;const n=/^([-\w]+)$/;if(!e){return{name:$.buildComponentName(t),restrict:"E"}}else if(e.startsWith(".")){return{name:r.camelCase(e.substring(1)),restrict:"C"}}else if(o.test(e)){return{name:r.camelCase(o.exec(e)[1]),restrict:"A"}}else if(n.test(e)){return{name:r.camelCase(n.exec(e)[1]),restrict:"E"}}else{const o=s.functionsUtils.getConstructorName(t);throw new Error(`SeDirective ${o} declared an unexpected selector (${e}). \n\t\tMake sure to use an element name or class (.class) or attribute ([attribute])`)}};const SeDirective=function(e){return function(t){const o={controller:t,scope:typeof e.scope==="undefined"?{}:e.scope,replace:e.replace,transclude:e.transclude,template:e.template,templateUrl:e.templateUrl,controllerAs:e.controllerAs,bindToController:parseDirectiveBindings(e.inputs)||true,require:e.require};const n=parseDirectiveName(e.selector,t);o.restrict=n.restrict;t.directiveName=n.name;t.definition=o;t.providers=e.providers;return t}};class DIBridgeUtils{downgradeComponent(e,t){if(!s.functionsUtils.isUnitTestMode()){const o=parseDirectiveName(e.selector,t);this._getBridgeModule().directive(o.name,n.downgradeComponent({component:t}))}}downgradeService(e,t,o){if(!s.functionsUtils.isUnitTestMode()){window.__smartedit__.downgradedService[e]=t;if(t){const o=window.__smartedit__.getDecoratorPayload("Injectable",t);if(o&&o.providedIn!=="root"){throw new Error(`service ${e} is meant to be downgraded but is not provided in root: make sure to mark it with @Injectable({providedIn: 'root'})`)}}this._getBridgeModule().factory(e,n.downgradeInjectable(o?o:t))}}upgradeProvider(e,t){return{provide:t?t:e,useFactory:t=>t.get(e),deps:["$injector"]}}_getBridgeModule(){return a.module(t.DIBridgeModule.moduleName)}}const Y=new DIBridgeUtils;const X={};const SeDowngradeService=function(e){return function(t){Y.downgradeService($.buildServiceName(t),t,e);return t}};const SeDowngradeComponent=function(){return function(e){if(!s.functionsUtils.isUnitTestMode()){const t=window.__smartedit__.getDecoratorPayload("Component",e);if(!t){const t=s.functionsUtils.getConstructorName(e);throw new Error(`@SeDowngradeComponent ${t} should only be used on a @Component decorated class`)}Y.downgradeComponent(t,e)}return e}};class NodeUtils{collectSmarteditAttributesByElementUuid(e){const t=document.querySelector(`.smartEditComponent[data-smartedit-element-uuid='${e}']`);if(!t){throw new Error(`could not find element with uuid ${e}`)}return Array.from(t.attributes).reduce(((e,t)=>{let o=t.name;if(o.indexOf("smartedit-")>-1){o=r.camelCase(o.replace("data-",""));e[o]=t.value}return e}),{})}hasLegacyAngularJSBootsrap(){return!!document.querySelector("[ng-app], [data-ng-app], [custom-app]")}compareHTMLElementsPosition(e){return function(t,o){if(e){t=t[e];o=o[e]}if(t===o){return 0}if(!t.compareDocumentPosition){return t.sourceIndex-o.sourceIndex}if(t.compareDocumentPosition(o)&2){return 1}return-1}}isPointOverElement(e,t){const o=t.getBoundingClientRect();return e.x>=o.left&&e.x<=o.right&&e.y>=o.top&&e.y<=o.bottom}areIntersecting(e,t){return!(t.left>e.left+e.width||t.left+t.width<e.left||t.top>e.top+e.height||t.top+t.height<e.top)}injectJS(){function getInjector(){return F["default"]}return{getInjector:getInjector,execute(e){const t=e.srcs;let o=e.index;const n=e.callback;if(!t.length){n();return}if(o===undefined){o=0}if(t[o]!==undefined){this.getInjector()(t[o],(()=>{if(o+1<t.length){this.execute({srcs:t,index:o+1,callback:n})}else if(typeof n==="function"){n()}}))}}}}}const J=new NodeUtils;const ee=[];class AbstractDecorator{constructor(){ee.push(this.smarteditElementuuid);const e=this.ngOnDestroy.bind(this);this.ngOnDestroy=()=>{e();ee.splice(ee.indexOf(this.smarteditElementuuid),1)}}set active(e){this._active=e==="true"}get active(){return this._active}static getScopes(){return ee}get componentAttributes(){if(!this._cachedCcomponentAttributes){try{this._cachedCcomponentAttributes=J.collectSmarteditAttributesByElementUuid(this.smarteditElementuuid)}catch(e){console.log(`AbstratcDecorator failed to find original element with uuid ${this.smarteditElementuuid}`)}}return this._cachedCcomponentAttributes}ngOnDestroy(){}}__decorate([d.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],AbstractDecorator.prototype,"active",null);__decorate([d.Input("data-smartedit-element-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditElementuuid",void 0);__decorate([d.Input("data-smartedit-component-id"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditComponentId",void 0);__decorate([d.Input("data-smartedit-component-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditComponentUuid",void 0);__decorate([d.Input("data-smartedit-component-type"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditComponentType",void 0);__decorate([d.Input("data-smartedit-catalog-version-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditCatalogVersionUuid",void 0);__decorate([d.Input("data-smartedit-container-id"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditContainerId",void 0);__decorate([d.Input("data-smartedit-container-uuid"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditContainerUuid",void 0);__decorate([d.Input("data-smartedit-container-type"),__metadata("design:type",String)],AbstractDecorator.prototype,"smarteditContainerType",void 0);const SeCustomComponent=function(){return function(e){const t=s.functionsUtils.getConstructorName(e);const o=window.__smartedit__.getDecoratorPayload("Component",e);if(!o){throw new Error(`@SeCustomComponent ${t} should only be used on a @Component decorated class`)}const n=parseComponentSelector(o.selector,e);e.selector=n;te.unshift(e);return e}};const parseComponentSelector=function(e,t){if(!e){return window.smarteditLodash.kebabCase($.buildComponentName(t))}else{return e}};const te=[];function registerCustomComponents(e){te.forEach((t=>{if(!customElements.get(t.selector)){const o=m.createCustomElement(t,{injector:e});customElements.define(t.selector,o)}}))}const SeDecorator=function(){return function(e){const t=s.functionsUtils.getConstructorName(e);const o=window.__smartedit__.getDecoratorPayload("Component",e);if(!o){throw new Error(`@SeDecorator ${t} should only be used on a @Component decorated class`)}if(o.template&&o.template.indexOf("<ng-content")===-1){throw new Error(`@SeDecorator ${t} should contain <ng-content> node in its template`)}if(!(e.prototype instanceof AbstractDecorator)){throw new Error(`@SeDecorator ${t} should extend AbstractDecorator`)}return(new SeCustomComponent)(e)}};const SeFilter=function(){return function(e){e.filterName=$.buildFilterName(e);return e}};const SeInjectable=function(){return function(e){return e}};const SeComponent=function(e){return function(t){const o=parseDirectiveName(e.selector,t);const n={controller:t,controllerAs:"$ctrl",transclude:e.transclude||true,bindings:parseDirectiveBindings(e.inputs),require:e.require};if(e.templateUrl){n.templateUrl=e.templateUrl}else if(e.template){n.template=e.template}if(o.restrict!=="E"){const e=s.functionsUtils.getConstructorName(t);throw new Error(`component ${e} declared a selector on class or attribute. version 1808 of Smartedit DI limits SeComponents to element selectors`)}t.componentName=o.name;t.definition=n;t.entryComponents=e.entryComponents;t.providers=e.providers;return t}};const ie=new d.InjectionToken("CONTEXTUAL_MENU_ITEM_DATA");class TruncatedText{constructor(e="",t="",o,n=""){this.text=e;this.truncatedText=t;this.truncated=o;this.ellipsis=n;this.text=this.text||"";this.truncatedText=this.truncatedText||""}getUntruncatedText(){return this.text}getTruncatedText(){return this.truncatedText+this.ellipsis}isTruncated(){return this.truncated}}var oe;window.__smartedit__=window.__smartedit__||{};function getDecoratorKey(e,t){return`${e}-${t}:definition`}r.merge(window.__smartedit__,{modules:{},pushedModules:[],smarteditDecoratorPayloads:{},addDecoratorPayload(e,t,o){const n=getDecoratorKey(e,t);if(window.__smartedit__.smarteditDecoratorPayloads[n]){throw new Error("Duplicate class/decorator pair")}window.__smartedit__.smarteditDecoratorPayloads[n]=o},getDecoratorPayload(e,t){const o=s.functionsUtils.getConstructorName(s.annotationService.getOriginalConstructor(t));return window.__smartedit__.smarteditDecoratorPayloads[getDecoratorKey(e,o)]},getComponentDecoratorPayload(e){return window.__smartedit__.smarteditDecoratorPayloads[getDecoratorKey("Component",e)]},downgradedService:{}});window.pushModules=(...e)=>{window.__smartedit__.pushedModules=window.__smartedit__.pushedModules.concat(e)};t.WindowUtils=oe=class WindowUtils extends s.WindowUtils{constructor(e){super(e);this.getGatewayTargetFrame=()=>{if(this.isInCypressIframe()){if(this.getSmarteditIframeFromParent()){return this.getWindow().parent}else if(this.getSmarteditIframeFromWindow()){return this.getWindow().document.getElementById(oe.SMARTEDIT_IFRAME_ID).contentWindow}}else{if(this.isIframe()){return this.getWindow().parent}else if(this.getSmarteditIframeFromWindow()){return this.getWindow().document.getElementById(oe.SMARTEDIT_IFRAME_ID).contentWindow}}return null}}getSmarteditIframeFromWindow(){return this.getWindow().document.getElementById(oe.SMARTEDIT_IFRAME_ID)}isInCypressIframe(){try{return this.getWindow().top.document.querySelector("iframe")&&this.getWindow().top.document.querySelector("iframe").id.includes(oe.CYPRESS_IFRSME_ID)}catch(e){return false}}getSmarteditIframe(){return document.querySelector("iframe#"+oe.SMARTEDIT_IFRAME_ID)}getSmarteditIframeFromParent(){return this.getWindow().parent.document.querySelector("iframe#"+oe.SMARTEDIT_IFRAME_ID)}getIframe(){return document.querySelector("iframe")}setTrustedIframeDomain(e){this.trustedIframeDomain=s.urlUtils.getOrigin(e)}getTrustedIframeDomain(){return this.trustedIframeDomain}isCrossOrigin(e){return s.urlUtils.getOrigin()!==s.urlUtils.getOrigin(e)}customTimeout(e,t){setTimeout((function(){e()}),t)}};t.WindowUtils.SMARTEDIT_IFRAME_ID="ySmartEditFrame";t.WindowUtils.CYPRESS_IFRSME_ID="Your App";t.WindowUtils=oe=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[d.NgZone])],t.WindowUtils);const ne=new t.WindowUtils;window.__smartedit__.addDecoratorPayload("Injectable","ModuleUtils",{providedIn:"root"});t.ModuleUtils=class ModuleUtils extends s.ModuleUtils{constructor(e){super();this.logService=e}getNgModule(e){if(window.__smartedit__.modules){const t=Object.keys(window.__smartedit__.modules).find((t=>t.toLowerCase().endsWith(e.toLowerCase())||t.toLowerCase().endsWith(e.toLowerCase()+"module")));if(!t){return null}return window.__smartedit__.modules[t]}return null}addModuleToAngularJSApp(e,t){try{a.module(t);a.module(e).requires.push(t)}catch(o){this.logService.warn(`Failed to load legacy AngularJS module ${t} into ${e}; SmartEdit functionality may be compromised.`)}}};t.ModuleUtils.$inject=["logService"];t.ModuleUtils=__decorate([d.Injectable({providedIn:"root"}),__metadata("design:paramtypes",[s.LogService])],t.ModuleUtils);const se=new t.ModuleUtils(new s.LogService);class StringUtils extends s.StringUtils{sanitizeHTML(e){if(ae.isBlank(e)){return e}return e.replace(/(\r\n|\n|\r)/gm,"").replace(/>\s+</g,"><").replace(/<\/br\>/g,"")}generateIdentifier(){let e=(new Date).getTime();if(window.performance&&typeof window.performance.now==="function"){e+=window.performance.now()}const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const o=(e+Math.random()*16)%16|0;e=Math.floor(e/16);return(t==="x"?o:o&3|8).toString(16)}));return t}getEncodedString(e){return this.encode(e)}trim(e){return e.trim()}escapeHtml(e){if(typeof e==="string"){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}return e}resourceLocationToRegex(e){return new RegExp(e.replace(/\/:[^\/]*/g,"/.*"))}}const ae=new StringUtils;t.DiscardablePromiseUtils=class DiscardablePromiseUtils{constructor(e){this.logService=e;this._map={}}apply(e,t,o,n){if(!this._map[e]){this._map[e]={promise:t,successCallback:o,failureCallback:n}}else{this.logService.debug(`competing promise for key ${e}`);delete this._map[e].discardableHolder.successCallback;delete this._map[e].discardableHolder.failureCallback;this._map[e].promise=t}this._map[e].discardableHolder={successCallback:this._map[e].successCallback,failureCallback:this._map[e].failureCallback};const s=this;const a=this._map[e].promise;a.then(function(t){if(this.successCallback){delete s._map[e];this.successCallback.apply(undefined,arguments)}else{s.logService.debug(`aborted successCallback for promise identified by ${e}`)}}.bind(this._map[e].discardableHolder),function(t){if(this.failureCallback){delete s._map[e];this.failureCallback.apply(undefined,arguments)}else{s.logService.debug(`aborted failureCallback for promise identified by ${e}`)}}.bind(this._map[e].discardableHolder))}clear(e){if(this.exists(e)){delete this._map[e].discardableHolder.successCallback;delete this._map[e].discardableHolder.failureCallback}}exists(e){return this._map[e]?true:false}};t.DiscardablePromiseUtils.$inject=["logService"];t.DiscardablePromiseUtils=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.LogService])],t.DiscardablePromiseUtils);class SmarteditErrorHandler extends d.ErrorHandler{constructor(){super();this.ignorePatterns=[/Uncaught[\s]*\(in[\s]*promise\)/,/Unhandled[\s]*Promise[\s]*rejection/]}handleError(e){if(false){}const t=e&&e.message?e.message:e;if(t&&this.ignorePatterns.some((e=>e.test(t.toString())))){return}if(e instanceof g.HttpErrorResponse&&e.status===401){return}super.handleError(e)}}const re="domain";const le="smarteditloader-component";const ce="smarteditcontainer-component";const de="smartedit-component";const pe="data-smartedit-element-uuid";const me="data-smartedit-component-id";const ge="data-smartedit-component-type";const ue="ng";const he="**";const ve=1e3;const _e="CURRENT_CONTEXT_CATALOG";const fe="CURRENT_CONTEXT_CATALOG_VERSION";const ye="CURRENT_CONTEXT_SITE_ID";const Se="CURRENT_PAGE_CONTEXT_CATALOG";const Ce="CURRENT_PAGE_CONTEXT_CATALOG_VERSION";const be="CURRENT_PAGE_CONTEXT_SITE_ID";const Ie="_SHOW_SLOT_MENU";const we="HIDE_SLOT_MENU";const Ee="OVERLAY_DISABLED";const Te="en_US";const Pe="CLOSE_CTX_MENU";const Ae="CTX_MENU_DROPDOWN_IS_OPEN";(function(e){e["ADD_OPERATION"]="addedNodes";e["REMOVE_OPERATION"]="removedNodes"})(t.MUTATION_CHILD_TYPES||(t.MUTATION_CHILD_TYPES={}));const Oe={CHILD_LIST:{NAME:"childList",ADD_OPERATION:t.MUTATION_CHILD_TYPES.ADD_OPERATION,REMOVE_OPERATION:t.MUTATION_CHILD_TYPES.REMOVE_OPERATION},ATTRIBUTES:{NAME:"attributes"}};const xe="/permissionswebservices/v1/permissions/catalogs/search";const De={BACKGROUND_TASKS:"Background Tasks",INTERACTIVE:"Interactive",NON_INTERACTIVE:"Non-Interactive",BATCH_OPERATIONS:"Batch Operations",TOOLING:"Tooling",CMS:"CMS"};const Re="/smarteditwebservices/v1/i18n/translations";const ke="/authorizationserver/oauth/whoami";const Me="smartedit";const Ne="/samlsinglesignon/saml";const Fe="/smartedit/authenticate";const ze="/samlsinglesignon/saml/logout";const Le="/previewwebservices/v1/preview";const Ve=/\/cmssmarteditwebservices|\/cmswebservices/;const Ue=/^(.*)\/smartedit/;const je="smartedit";const $e="/smartedit/configuration";const Be="/smartedit/settings";const Ge="EVENT_NOTIFICATION_CHANGED";(function(e){e["Ascending"]="asc";e["Descending"]="desc"})(t.SortDirections||(t.SortDirections={}));const He="REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT";const We="previousUsername";const qe={topLogoURL:"static-resources/images/SAP_R_grad.svg",bottomLogoURL:"static-resources/images/best-run-sap-logo.svg"};const Ke="EVENT_PERSPECTIVE_CHANGED";const Ye="EVENT_PERSPECTIVE_UNLOADING";const Ze="EVENT_PERSPECTIVE_REFRESHED";const Xe="EVENT_PERSPECTIVE_ADDED";const Qe="EVENT_PERSPECTIVE_UPDATED";const Je="EVENT_STRICT_PREVIEW_MODE_REQUESTED";const et="perspectiveToolbar.perspectiveSelectorTemplate";const tt="EVENT_SMARTEDIT_COMPONENT_UPDATED";const it="smarteditoverlay";const ot="EVENT_OUTER_FRAME_CLICKED";const nt="data-smartedit-catalog-version-uuid";const at="smartEditComponent";const lt="data-smartedit-container-id";const ct={PROCESS:"processComponent",REMOVE:"removeComponent",KEEP_VISIBLE:"keepComponentVisible"};const dt={PROCESS_COMPONENTS:"contractChangeListenerProcessComponents",RESTART_PROCESS:"contractChangeListenerRestartProcess"};const pt="overlayRerendered";const mt="data-smartedit-";const gt="smartEditComponentProcessStatus";const ut="data-smartedit-component-uuid";const ht="smartEditComponentX";const vt="ContentSlot";const _t="data-smartedit-container-type";const ft="/cmswebservices/v1/sites/:siteUID/languages";const yt="/smarteditwebservices/v1/i18n/languages";const St="genericEditorLoadedEvent";const Ct="UnrelatedValidationMessagesEvent";const bt={VALIDATION_ERROR:"ValidationError",WARNING:"Warning"};const It="/cmswebservices/v1/enums";const wt="DROPDOWN_IMPLEMENTATION_SUFFIX";const Et="LinkedDropdown";const Tt="ClickDropdown";const Pt="/cmswebservices/v1/sites";const At={ANGULAR_FORMAT:"short",MOMENT_FORMAT:"M/D/YY h:mm A",MOMENT_ISO:"YYYY-MM-DDTHH:mm:00ZZ",ISO:"yyyy-MM-ddTHH:mm:00Z",ANGULAR_SHORT:"M/d/yy h:mm a"};const Ot={LEFT:"left",RIGHT:"right"};const xt="/cmswebservices/v1/types";const Dt="/storefront";const Rt="/cmssmarteditwebservices/v1/sites/:siteUID/products/:productUID";const kt="/cmssmarteditwebservices/v1/productcatalogs/:catalogId/versions/:catalogVersion/products";const Mt="HIDE_TOOLBAR_ITEM_CONTEXT";const Nt="SHOW_TOOLBAR_ITEM_CONTEXT";const Ft={DRAG_DROP_CROSS_ORIGIN_START:"DRAG_DROP_CROSS_ORIGIN_START",DRAG_DROP_START:"EVENT_DRAG_DROP_START",DRAG_DROP_END:"EVENT_DRAG_DROP_END",TRACK_MOUSE_POSITION:"EVENT_TRACK_MOUSE_POSITION",DROP_ELEMENT:"EVENT_DROP_ELEMENT"};const zt="se.none";const Lt="se.all";const Vt=100;const Ut=70;const jt="smartedit-element-hovered";const $t="ySECmsScrollArea";const Bt="ySmartEditFrameDragArea";const Gt={START:"START",END:"END"};const Ht="#js_iFrameWrapper";const Wt=1e4;const qt="EVENT_CONTENT_CATALOG_UPDATE";const Kt=[];const Yt=[];const Zt=`/cmswebservices/v1/catalogs/${_e}/versions/${fe}/media`;const Xt=`/cmswebservices/v1/media`;const Qt=`/cmswebservices/v1/catalogs/${_e}/versions/${fe}/medias`;const Jt="experience";const ei=`/cmswebservices/v1/mediafolders`;const ti="OPEN_PAGE_WORKFLOW_MENU";const ii="CMS_EVENT_OPEN_PAGE_WORKFLOW_MENU";const oi="CMSITEMS_UPDATE";const ni=`/cmswebservices/v1/sites/${be}/catalogs/${Se}/versions/${Ce}/pagescontentslots`;const si="EVENT_PAGE_TREE_PANEL_SWITCH";const ai="EVENT_PAGE_TREE_SLOT_SELECTED";const ri="EVENT_PAGE_TREE_COMPONENT_SELECTED";const li="EVENT_OPEN_IN_PAGE_TREE";const ci="EVENT_PART_REFRESH_TREE_NODE";const di="EVENT_OVERALL_REFRESH_TREE_NODE";const pi="EVENT_PAGE_TREE_SLOT_NEED_UPDATE";const mi={NAVIGATION:"Function Navigation",PAGE_MANAGEMENT:"Page Management",NAVIGATION_MANAGEMENT:"Navigation Management",HEADER_TOOL:"Header Tool Bar",SELECT_PERSPECTIVE:"Perspective Select",TOOL_BAR:"Tool Bar",VERSION_OPERATION:"Version Operation",INFLECTION:"Inflection Select",ADD_COMPONENT:"Add Component",VERSION_MANAGEMENT:"Version Management",CONTEXT_MENU:"Contextual Menu",PAGE_STRUCTURE:"Page Structure"};const gi=new Map([["se.cms.toolbaritem.navigationmenu.name","Navigation"],["se.cms.pagelist.title","Pages"],["se.route.storefront.title","Storefront"],["headerToolbar.configurationTemplate","Configuration"],["headerToolbar.languageSelectorTemplate","Language Select"],["headerToolbar.userAccountTemplate","User Account"],["se.cms.perspective.basic","Basic Edit"],["se.cms.perspective.versioning","Versioning"],["personalizationsmartedit.perspective","Personalization"],["se.cms.perspective.advanced","Advanced Edit"],["se.none","Preview"],["se.cms.componentMenuTemplate","Component"],["se.cms.pageTreeMenu",mi.PAGE_STRUCTURE],["personalizationsmartedit.container.pagecustomizations.toolbar","Personalize - Customization"],["personalizationsmartedit.container.combinedview.toolbar","Personlization - CombinedView"],["personalizationsmartedit.container.manager.toolbar","Personlization - Library"],["se.cms.createVersionMenu","Add Version"],["se.cms.clonePageMenu","Clone"],["se.cms.compomentmenu.tabs.componenttypes","Component Types"],["se.cms.compomentmenu.tabs.customizedcomp","Saved Components"],["se.cms.contextmenu.title.dragndrop","Drag and Drop"],["se.cms.contextmenu.title.edit","Edit"],["se.cms.contextmenu.title.remove","Remove"],["se.cms.contextmenu.title.clone.component","Clone"],["se.cms.pageVersionsMenu","Versions"],["se.cms.contextmenu.title.open.in.page.tree","Open In Page Tree"],["se.cms.version.item.menu.view.label","View"],["se.cms.version.item.menu.edit.label","Edit Details"],["se.cms.version.item.menu.rollback.label","Rollback To This Version"],["se.cms.version.item.menu.delete.label","Delete"],["se.cms.rollbackVersionMenu","Version Rollback"]]);function objectToArray(e){return Object.keys(e).reduce(((t,o)=>[...t||[],{key:o,value:e[o]}]),[])}class AbstractAngularJSBasedCustomElement extends HTMLElement{constructor(e){super();this.upgrade=e;this.PROCESSED_ATTRIBUTE_NAME="processed"}markAsProcessed(){this.setAttribute(this.PROCESSED_ATTRIBUTE_NAME,"true")}connectedCallback(){if(!this.isConnected||this.getAttribute(this.PROCESSED_ATTRIBUTE_NAME)){return}this.internalConnectedCallback()}disconnectedCallback(){if(!this.scope||this.isConnected){return}this.scope.$destroy();this.internalDisconnectedCallback&&this.internalDisconnectedCallback()}attributeChangedCallback(e,t,o){if(!this.shouldReactOnAttributeChange()){return}this.internalAttributeChangedCallback(e,t,o)}shouldReactOnAttributeChange(){return this.internalAttributeChangedCallback&&this.scope&&this.isConnected&&!!this.getAttribute(this.PROCESSED_ATTRIBUTE_NAME)}get $rootScope(){return this.upgrade.injector.get("$rootScope")}get $compile(){return this.upgrade.injector.get("$compile")}}class ObjectUtils{constructor(){this.isObjectEmptyDeep=e=>{if(r.isObject(e)){for(const t in e){if(e.hasOwnProperty(t)){if(!r.isEmpty(e[t])){return false}}}return true}return r.isString(e)?r.isEmpty(e):r.isNil(e)};this.resetObject=(e,t)=>{if(!e){e=this.copy(t)}else{for(const t in e){if(e.hasOwnProperty(t)){delete e[t]}}r.extend(e,this.copy(t))}return e};this.deepIterateOverObjectWith=(e,t)=>r.reduce(e,((e,o,n)=>{if(r.isPlainObject(o)){e[n]=this.deepIterateOverObjectWith(o,t)}else{e[n]=t(o)}return e}),{});this.deepObjectPropertyDiff=(e,t)=>{const o="CHANGED_PROPERTY";const n="NON_CHANGED_PROPERTY";const s=r.mergeWith(r.cloneDeep(e),t,(function(e,t){if(!r.isPlainObject(e)){return!r.isEqual(e,t)?o:n}return undefined}));const a=this.deepIterateOverObjectWith(s,(e=>{if(e!==o&&e!==n){return o}else{return e}}));return this.deepIterateOverObjectWith(a,(e=>e===o?true:false))};this.readObjectStructure=(e,t=0)=>{if(t>25){return this.getClassName(e)}if(e===undefined||e===null||e.then){return e}switch(typeof e){case"function":return"FUNCTION";case"string":return"STRING";case"number":return"NUMBER";case"boolean":return"BOOLEAN";default:return this._getOtherObjectType(e,t)}}}copy(e){return JSON.parse(JSON.stringify(e))}merge(e,t){return Object.assign(e,t)}convertToArray(e){const t=[];for(const o in e){if(!o.startsWith("$")&&!o.startsWith("toJSON")){t.push({key:o,value:e[o]})}}return t}uniqueArray(e,t){const o=new Set(e);t.forEach((t=>{if(!o.has(t)){e.push(t)}}));return e}isFunction(e){return typeof e==="function"}isObject(e){const t={boolean:false,function:true,object:true,number:false,string:false,undefined:false};return!!(e&&t[typeof e])}isTypedMap(e){return e&&this.isObject(e)&&e.constructor===Object}sortBy(e,t,o=false){const n=[...e];const s=o?-1:1;n.sort(((e,o)=>{const n=this.isTypedMap(e)?e[t]:e;const a=this.isTypedMap(o)?o[t]:o;const r=String(n).localeCompare(String(a),undefined,{numeric:true,sensitivity:"base"});return r*s}));return n}extend(e,t){if(!t){t=function(){return}}t.prototype=Object.create(e.prototype);return t}getClassName(e){return e&&e.constructor&&e.constructor.name&&e.constructor.name!=="Object"?e.constructor.name:null}_getOtherObjectType(e,t){if(r.isElement(e)){return"ELEMENT"}if(e.hasOwnProperty&&e.hasOwnProperty("length")){if(e.forEach){const o=[];e.forEach((e=>{t++;o.push(this.readObjectStructure(e,t))}));return o}else{return"JQUERY"}}if(e.constructor&&e.constructor.name&&e.constructor.name!=="Object"){return e.constructor.name}const o={};Object.keys(e).forEach((n=>{if(!n.startsWith("$")){t++;o[n]=this.readObjectStructure(e[n],t)}}));return o}}const ui=new ObjectUtils;class ApiUtils{getDataFromResponse(e){const t=Object.keys(e).filter((function(t){return e[t]instanceof Array}))[0];return e[t]}getKeyHoldingDataFromResponse(e){const t=Object.keys(e).filter((function(t){return e[t]instanceof Array}))[0];return t}}const hi=new ApiUtils;class DateUtils{formatDateAsUtc(e){return V["default"](e).utc().format(At.MOMENT_ISO)}}const vi=new DateUtils;class ScriptUtils{injectJS(){function getInjector(){return F["default"]}return{getInjector:getInjector,execute(e){const t=e.srcs;let o=e.index;const n=e.callback;if(!t.length){n();return}if(o===undefined){o=0}if(t[o]!==undefined){this.getInjector()(t[o],(()=>{if(o+1<t.length){this.execute({srcs:t,index:o+1,callback:n})}else if(typeof n==="function"){n()}}))}}}}}const _i=new ScriptUtils;(function(e){class ParseError{constructor(e){this.value=e}}e.ParseError=ParseError})(t.Errors||(t.Errors={}));const fi=new d.InjectionToken("EXTENDED_VIEW_PORT_MARGIN");const yi=new d.InjectionToken("HEART_BEAT_TIMEOUT_THRESHOLD_MS");t.SystemEventService=class SystemEventService{constructor(e,t){this.logService=e;this.promiseUtils=t;this._eventHandlers={}}publish(e,t){if(!e){this.logService.error("Failed to send event. No event ID provided for data: "+t)}else{if(this._eventHandlers[e]&&this._eventHandlers[e].length>0){return this._invokeEventHandlers(e,t)}}return Promise.resolve()}publishAsync(e,t){return new Promise(((o,n)=>{setTimeout((()=>{this.publish(e,t).then((e=>o(e)),(e=>n(e)))}),0)}))}subscribe(e,t){let o;if(!e||!t){this.logService.error("Failed to subscribe event handler for event: "+e)}else{if(this._eventHandlers[e]===undefined){this._eventHandlers[e]=[]}this._eventHandlers[e].push(t);o=()=>{this._unsubscribe(e,t)}}return o}_unsubscribe(e,t){const o=this._eventHandlers[e];const n=o?this._eventHandlers[e].indexOf(t):-1;if(n>=0){this._eventHandlers[e].splice(n,1)}else{this.logService.warn("Attempting to remove event handler for "+e+" but handler not found.")}}_invokeEventHandlers(e,t){return Promise.all(this._eventHandlers[e].map((o=>{const n=this.promiseUtils.toPromise(o);return n(e,t)}))).then((e=>Promise.resolve(e.pop())),(e=>Promise.reject(e)))}};t.SystemEventService.$inject=["logService","promiseUtils"];t.SystemEventService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.LogService,s.PromiseUtils])],t.SystemEventService);class MessageGateway{constructor(e,t,o,n,s,a,r){this.logService=e;this.systemEventService=t;this.cloneableUtils=o;this.windowUtils=n;this.promiseUtils=s;this.TIMEOUT_TO_RETRY_PUBLISHING=a;this.gatewayId=r;this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID="promiseAcknowledgement";this.PROMISE_RETURN_EVENT_ID="promiseReturn";this.SUCCESS="success";this.FAILURE="failure";this.MAX_RETRIES=5;this.promisesToResolve={}}publish(e,t,o=0,n){if(!e){return Promise.reject(`MessageGateway: Failed to send event. No event ID provided for _data: ${t}`)}const s=this.cloneableUtils.makeCloneable(t);if(!r.isEqual(s,t)){this.logService.debug(`MessageGateway.publish - Non cloneable payload has been sanitized for gateway ${this.gatewayId}, event ${e}:`,s)}const a=this.promisesToResolve[n]||this.promiseUtils.defer();try{const t=this.windowUtils.getGatewayTargetFrame();if(!t){a.reject("It is standalone. There is no iframe");return a.promise}n=n||this._generateIdentifier();try{t.postMessage({pk:n,gatewayId:this.gatewayId,eventId:e,data:s},"*")}catch(t){this.logService.error(t);this.logService.error(`MessageGateway.publish - postMessage has failed for gateway ${this.gatewayId} event ${e} and data `,s)}this.promisesToResolve[n]=a;this._setTimeout((()=>{if(!a.acknowledged&&e!==this.PROMISE_RETURN_EVENT_ID&&e!==this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID){if(o<this.MAX_RETRIES){this.logService.debug(`${document.location.href} is retrying to publish event ${e}`);this.publish(e,s,++o,n).catch((e=>{}))}else{const t=`MessageGateway.publish - Not able to publish event ${e} after max retries for gateway ${this.gatewayId} and data`;a.reject({error:t,data:s},true)}}}),this.TIMEOUT_TO_RETRY_PUBLISHING)}catch(e){a.reject()}return a.promise}subscribe(e,t){let o;if(!e){this.logService.error("MessageGateway: Failed to subscribe event handler for event: "+e)}else{const n=this._getSystemEventId(e);o=this.systemEventService.subscribe(n,t)}return o}processEvent(e){const t=e.data;if(e.eventId!==this.PROMISE_RETURN_EVENT_ID&&e.eventId!==this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID){this.logService.debug(document.location.href,"sending acknowledgement for",e);this.publish(this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID,{pk:e.pk});const t=this._getSystemEventId(e.eventId);return this.systemEventService.publishAsync(t,e.data).then((t=>{this.logService.debug(document.location.href,"sending promise resolve",e);return this.publish(this.PROMISE_RETURN_EVENT_ID,{pk:e.pk,type:this.SUCCESS,resolvedDataOfLastSubscriber:t})}),(()=>{this.logService.debug(document.location.href,"sending promise reject",e);return this.publish(this.PROMISE_RETURN_EVENT_ID,{pk:e.pk,type:this.FAILURE})}))}else if(e.eventId===this.PROMISE_RETURN_EVENT_ID){if(this.promisesToResolve[t.pk]){if(t.type===this.SUCCESS){this.logService.debug(document.location.href,"received promise resolve",e);this.promisesToResolve[t.pk].resolve(t.resolvedDataOfLastSubscriber)}else if(t.type===this.FAILURE){this.logService.debug(document.location.href,"received promise reject",e);this.promisesToResolve[t.pk].reject()}delete this.promisesToResolve[t.pk]}}else if(e.eventId===this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID){if(this.promisesToResolve[t.pk]){this.logService.debug(document.location.href,"received acknowledgement",e);this.promisesToResolve[t.pk].acknowledged=true}}return Promise.resolve()}_setTimeout(e,t){if(s.functionsUtils.isUnitTestMode()){setTimeout(e,t)}else{this.windowUtils.runTimeoutOutsideAngular(e,t)}}_generateIdentifier(){return(new Date).getTime()+Math.random().toString()}_getSystemEventId(e){return this.gatewayId+":"+e}}var Si;t.GatewayFactory=Si=class GatewayFactory{constructor(e,t,o,n,s,a){this.logService=e;this.systemEventService=t;this.cloneableUtils=o;this.windowUtils=n;this.promiseUtils=s;this.functionsUtils=a;this.messageGatewayMap={}}initListener(){const e=[];this.windowUtils.getWindow().addEventListener("message",(t=>{if(t.origin==="https://sapinsights.eu.qualtrics.com"){return}if(this._isAllowed(t.origin)){const o=t.data;if(e.indexOf(o.pk)>-1){return}e.push(o.pk);this.logService.debug("message event handler called",o.eventId);const n=o.gatewayId;const s=this.messageGatewayMap[n];if(!s){this.logService.debug("Incoming message on gateway "+n+", but no destination exists.");return}s.processEvent(o)}else{this.logService.error("disallowed storefront is trying to communicate with smarteditcontainer")}}),false)}createGateway(e){if(this.messageGatewayMap[e]&&!this.functionsUtils.isUnitTestMode()){this.logService.error("Message Gateway for "+e+" already reserved");return null}this.messageGatewayMap[e]=new MessageGateway(this.logService,this.systemEventService,this.cloneableUtils,this.windowUtils,this.promiseUtils,Si.TIMEOUT_TO_RETRY_PUBLISHING,e);return this.messageGatewayMap[e]}_isAllowed(e){return this.windowUtils.isIframe()||this.windowUtils.getTrustedIframeDomain()===e}};t.GatewayFactory.TIMEOUT_TO_RETRY_PUBLISHING=500;t.GatewayFactory=Si=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.LogService,t.SystemEventService,s.CloneableUtils,t.WindowUtils,s.PromiseUtils,s.FunctionsUtils])],t.GatewayFactory);t.GatewayProxy=class GatewayProxy{constructor(e,t,o,n,s){this.logService=e;this.promiseUtils=t;this.stringUtils=o;this.functionsUtils=n;this.gatewayFactory=s;this.nonProxiableMethods=["getMethodForVoid","getMethodForSingleInstance","getMethodForArray"]}initForService(e,t,o){const n=o||e.gatewayId;if(!n){this.logService.error(`initForService() - service expected to have an associated gatewayId - methodsSubset: ${t&&t.length?t.join(","):[]}`);return null}const s=this.gatewayFactory.createGateway(n);let a=t;if(!a){a=this.functionsUtils.getInstanceMethods(e).filter((e=>!this._isNonProxiableMethod(e)))}a.forEach((t=>{if(typeof e[t]==="function"){if(this.functionsUtils.isEmpty(e[t])){this._turnToProxy(t,e,s)}else{e[t]=this.promiseUtils.toPromise(e[t],e);s.subscribe(t,this._onGatewayEvent.bind(null,t,e))}}}))}_isNonProxiableMethod(e){return this.nonProxiableMethods.indexOf(e)>-1||e.startsWith("$")||e==="lodash"||e==="jQuery"}_onGatewayEvent(e,t,o,n){return t[e].apply(t,n.arguments)}_turnToProxy(e,t,o){delete t[e];t[e]=(...t)=>o.publish(e,{arguments:t}).then((e=>{if(!this.stringUtils.isBlank(e)){delete e.$resolved;delete e.$promise}return e}),(n=>{if(n){this.logService.debug(`gatewayProxy - publish failed for gateway ${o.gatewayId} method ${e} and arguments ${t}`)}return Promise.reject(n)}))}};t.GatewayProxy.$inject=["logService","promiseUtils","stringUtils","functionsUtils","gatewayFactory"];t.GatewayProxy=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.LogService,s.PromiseUtils,s.StringUtils,s.FunctionsUtils,t.GatewayFactory])],t.GatewayProxy);const Ci=new d.InjectionToken("ANNOUNCEMENT_DATA");class IAnnouncementService{showAnnouncement(e){"proxyFunction";return null}closeAnnouncement(e){"proxyFunction";return null}}class ICatalogService{retrieveUriContext(e){"proxyFunction";return null}getContentCatalogsForSite(e){"proxyFunction";return null}getAllContentCatalogsGroupedById(){"proxyFunction";return null}getCatalogByVersion(e,t){"proxyFunction";return null}isContentCatalogVersionNonActive(e){"proxyFunction";return null}getContentCatalogActiveVersion(e){"proxyFunction";return null}getActiveContentCatalogVersionByCatalogId(e){"proxyFunction";return null}getCurrentSiteID(){"proxyFunction";return null}getDefaultSiteForContentCatalog(e){"proxyFunction";return null}getContentCatalogVersion(e){"proxyFunction";return null}getCatalogVersionByUuid(e,t){"proxyFunction";return null}getCatalogVersionUUid(e){"proxyFunction";return null}getProductCatalogsBySiteKey(e){"proxyFunction";return null}getProductCatalogsForSite(e){"proxyFunction";return null}getActiveProductCatalogVersionByCatalogId(e){"proxyFunction";return null}returnActiveCatalogVersionUIDs(e){"proxyFunction";return null}isCurrentCatalogMultiCountry(){"proxyFunction";return null}}class IExperienceService{updateExperiencePageContext(e,t){"proxyFunction";return null}getCurrentExperience(){"proxyFunction";return null}setCurrentExperience(e){"proxyFunction";return null}hasCatalogVersionChanged(){"proxyFunction";return null}buildRefreshedPreviewUrl(){"proxyFunction";return null}updateExperience(e){"proxyFunction";return null}loadExperience(e){"proxyFunction";return null}compareWithCurrentExperience(e){"proxyFunction";return null}_convertExperienceToPreviewData(e,t){const o=r.cloneDeep(e);const n=[];delete o.catalogDescriptor;delete o.siteDescriptor;delete o.languageDescriptor;delete o.pageContext;delete o.productCatalogVersions;if(e.productCatalogVersions&&e.productCatalogVersions.length){e.productCatalogVersions.forEach((e=>{n.push({catalog:e.catalog,catalogVersion:e.catalogVersion})}))}n.push({catalog:e.catalogDescriptor.catalogId,catalogVersion:e.catalogDescriptor.catalogVersion});o.catalogVersions=n;o.language=e.languageDescriptor.isocode;o.resourcePath=t;o.siteId=e.siteDescriptor.uid;return o}initializeExperience(){"proxyFunction";return null}buildAndSetExperience(e){"proxyFunction";return null}}class IFeatureService{constructor(e){this.cloneableUtils=e}register(e){this._validate(e);this._featuresToAlias=this._featuresToAlias||{};this._featuresToAlias[e.key]={enablingCallback:e.enablingCallback,disablingCallback:e.disablingCallback};delete e.enablingCallback;delete e.disablingCallback;return this._registerAliases(this.cloneableUtils.makeCloneable(e))}enable(e){if(this._featuresToAlias&&this._featuresToAlias[e]){this._featuresToAlias[e].enablingCallback()}else{this._remoteEnablingFromInner(e)}}disable(e){if(this._featuresToAlias&&this._featuresToAlias[e]){this._featuresToAlias[e].disablingCallback()}else{this._remoteDisablingFromInner(e)}}getFeatureProperty(e,t){"proxyFunction";return null}addToolbarItem(e){"proxyFunction";return null}addDecorator(e){"proxyFunction";return null}addContextualMenuButton(e){"proxyFunction";return null}getFeatureKeys(){"proxyFunction";return null}_remoteEnablingFromInner(e){"proxyFunction";return null}_remoteDisablingFromInner(e){"proxyFunction";return null}_registerAliases(e){"proxyFunction";return null}_validate(e){if(r.isEmpty(e.key)){throw new Error("featureService.configuration.key.error.required")}if(r.isEmpty(e.nameI18nKey)){throw new Error("featureService.configuration.nameI18nKey.error.required")}if(!r.isFunction(e.enablingCallback)){throw new Error("featureService.configuration.enablingCallback.error.not.function")}if(!r.isFunction(e.disablingCallback)){throw new Error("featureService.configuration.disablingCallback.error.not.function")}}}class INotificationMouseLeaveDetectionService{startDetection(e,t,o){"proxyFunction";return null}stopDetection(){"proxyFunction";return null}_remoteStartDetection(e){"proxyFunction";return null}_remoteStopDetection(){"proxyFunction";return null}_callCallback(){"proxyFunction";return null}_onMouseMove(e){this._getBounds().then((t=>{const o=t&&e&&(e.clientX<t.x||e.clientX>t.x+t.width);const n=t&&e&&(e.clientY<t.y||e.clientY>t.y+t.height);if(o||n){this._onMouseLeave()}}))}_getBounds(){"proxyFunction";return null}_getCallback(){"proxyFunction";return null}_onMouseLeave(){this._getCallback().then((e=>{if(e){e();this.stopDetection()}else{this._callCallback().then((()=>{this.stopDetection()}))}}))}}class INotificationService{pushNotification(e){"proxyFunction";return null}removeNotification(e){"proxyFunction";return null}removeAllNotifications(){"proxyFunction";return null}}class IPageInfoService{getPageUID(){"proxyFunction";return null}getPageUUID(){"proxyFunction";return null}getCatalogVersionUUIDFromPage(){"proxyFunction";return null}isSameCatalogVersionOfPageAndPageTemplate(){"proxyFunction";return null}}class IPreviewService{constructor(e){this.urlUtils=e}createPreview(e){"proxyFunction";return null}updatePreview(e){"proxyFunction";return null}getResourcePathFromPreviewUrl(e){"proxyFunction";return null}updateUrlWithNewPreviewTicketId(e,t){return this.createPreview(t).then((t=>this.urlUtils.updateUrlParameter(e,"cmsTicketId",t.ticketId)))}}class IUrlService{openUrlInPopup(e){"proxyFunction";return null}path(e){"proxyFunction";return null}buildUriContext(e,t,o){const n={};n[ye]=e;n[_e]=t;n[fe]=o;return n}buildPageUriContext(e,t,o){const n={};n[be]=e;n[Se]=t;n[Ce]=o;return n}}class IWaitDialogService{showWaitModal(e){"proxyFunction";return null}hideWaitModal(){"proxyFunction";return null}}class IIframeClickDetectionService{onIframeClick(){"proxyFunction";return null}registerCallback(e,t){"proxyFunction";return null}removeCallback(e){"proxyFunction"}}const prepareRuleConfiguration=function(e){this.ruleVerifyFunctions=this.ruleVerifyFunctions||{};this.ruleVerifyFunctions[e.names.join("-")]={verify:e.verify};delete e.verify;return e};const validateRule=function(e){if(!(e.names instanceof Array)){throw Error("Rule names must be array")}if(e.names.length<1){throw Error("Rule requires at least one name")}if(!e.verify){throw Error("Rule requires a verify function")}if(typeof e.verify!=="function"){throw Error("Rule verify must be a function")}};class IPermissionService{clearCache(){"proxyFunction";return}getPermission(e){"proxyFunction";return null}isPermitted(e){"proxyFunction";return null}registerPermission(e){"proxyFunction";return}registerRule(e){validateRule(e);e=prepareRuleConfiguration.bind(this)(e);this._registerRule(e)}registerDefaultRule(e){e=prepareRuleConfiguration.bind(this)(e);this._registerDefaultRule(e)}unregisterDefaultRule(){"proxyFunction";return}_registerRule(e){"proxyFunction";return}_registerDefaultRule(e){"proxyFunction";return}}class IResizeListener{unregister(e){"proxyFunction"}fix(e){"proxyFunction"}register(e,t){"proxyFunction"}init(){"proxyFunction"}dispose(){"proxyFunction"}}class IPositionRegistry{register(e){"proxyFunction"}unregister(e){"proxyFunction"}getRepositionedComponents(){"proxyFunction";return null}dispose(){"proxyFunction"}}class IRenderService{constructor(e,t,o,n,s,a,r,d){this.yjQuery=e;this.systemEventService=t;this.notificationService=o;this.pageInfoService=n;this.perspectiveService=s;this.crossFrameEventService=a;this.windowUtils=r;this.modalService=d;this.KEY_CODES={ESC:27};this.HOTKEY_NOTIFICATION_CONFIGURATION={id:"HOTKEY_NOTIFICATION_ID",componentName:"PerspectiveSelectorHotkeyNotificationComponent"};this._bindEvents()}renderSlots(e){"proxyFunction";return null}renderComponent(e,t){"proxyFunction";return null}renderRemoval(e,t,o){"proxyFunction";return null}renderPage(e){"proxyFunction";return null}toggleOverlay(e){"proxyFunction";return null}refreshOverlayDimensions(){"proxyFunction";return null}blockRendering(e){"proxyFunction";return null}isRenderingBlocked(){"proxyFunction";return null}createComponent(e){"proxyFunction";return null}destroyComponent(e,t,o){"proxyFunction";return null}updateComponentSizeAndPosition(e,t){"proxyFunction";return null}_getDocument(){return document}_bindEvents(){this._getDocument().addEventListener("keyup",(e=>this._keyUpEventHandler(e)));this._getDocument().addEventListener("click",(()=>this._clickEvent()))}_keyUpEventHandler(e){if(!this._areAllModalWindowsClosed()){return Promise.resolve()}return this._shouldEnableKeyPressEvent(e).then((e=>{if(e){this._keyPressEvent()}}))}_shouldEnableKeyPressEvent(e){return new Promise((t=>this.pageInfoService.getPageUUID().then((o=>{if(o){return this.perspectiveService.isHotkeyEnabledForActivePerspective().then((o=>t(e.which===this.KEY_CODES.ESC&&o)))}return t(false)})).catch((()=>t(false)))))}_keyPressEvent(){this.isRenderingBlocked().then((e=>{if(!e){this.blockRendering(true);this.renderPage(false);this.notificationService.pushNotification(this.HOTKEY_NOTIFICATION_CONFIGURATION);this.systemEventService.publishAsync("OVERLAY_DISABLED")}else{this.blockRendering(false);this.renderPage(true);this.notificationService.removeNotification(this.HOTKEY_NOTIFICATION_CONFIGURATION.id)}}))}_clickEvent(){if(!this.windowUtils.isIframe()){this.crossFrameEventService.publish(ot)}return this.isRenderingBlocked().then((e=>{if(e&&!this.windowUtils.isIframe()){this.blockRendering(false);this.renderPage(true);return this.notificationService.removeNotification(this.HOTKEY_NOTIFICATION_CONFIGURATION.id)}return null}))}_areAllModalWindowsClosed(){return!this.modalService.hasOpenModals()}}class IToolbarServiceFactory{getToolbarService(e){"proxyFunction";return null}}class IConfirmationModalService{confirm(e){"proxyFunction";return Promise.resolve(true)}}class ICatalogVersionPermissionService{hasWritePermission(e,t){"proxyFunction";return null}hasReadPermission(e,t){"proxyFunction";return null}hasWritePermissionOnCurrent(){"proxyFunction";return null}hasReadPermissionOnCurrent(){"proxyFunction";return null}hasSyncPermission(e,t,o){"proxyFunction";return null}hasSyncPermissionFromCurrentToActiveCatalogVersion(){"proxyFunction";return null}hasSyncPermissionToActiveCatalogVersion(e,t){"proxyFunction";return null}}class IDecoratorService{addMappings(e){"proxyFunction"}enable(e,t){"proxyFunction"}disable(e){"proxyFunction"}getDecoratorsForComponent(e,t){"proxyFunction";return null}}class IRestServiceFactory{get(e,t){"proxyFunction";return null}setDomain(e){"proxyFunction"}setBasePath(e){"proxyFunction"}setGlobalBasePath(e){"proxyFunction"}}class IDragAndDropCrossOrigin{initialize(){"proxyFunction"}}class IContextualMenuService{addItems(e){"proxyFunction"}removeItemByKey(e){"proxyFunction"}containsItem(e){"proxyFunction";return null}getContextualMenuByType(e){"proxyFunction";return null}refreshMenuItems(){"proxyFunction"}getContextualMenuItems(e){return null}}class ICatalogDetailsService{addItems(e,t){"proxyFunction"}getItems(){"proxyFunction";return null}}class ILegacyDecoratorToCustomElementConverter{getScopes(){return null}convert(e){return null}convertIfNeeded(e){return null}}class ISmartEditContractChangeListener{_newMutationObserver(e){return null}_newIntersectionObserver(e){return null}_addToComponentQueue(e){return null}_componentsQueueLength(){return null}isExtendedViewEnabled(){return null}setEconomyMode(e){return null}initListener(){return null}_processQueue(){return null}isIntersecting(e){return null}_rawProcessQueue(){return null}_addComponents(e){return null}_removeComponents(e,t=false){return null}_registerSizeAndPositionListeners(e){return null}_unregisterSizeAndPositionListeners(e){return null}stopListener(){return null}_stopExpendableListeners(){return null}_startExpendableListeners(){return null}onComponentsAdded(e){return null}onComponentsRemoved(e){return null}onComponentChanged(e){return null}onComponentResized(e){return null}onComponentRepositioned(e){return null}onPageChanged(e){return null}}class ITemplateCacheService{info(){return undefined}put(e,t){return undefined}get(e){return undefined}remove(e){return undefined}removeAll(){return undefined}destroy(){return undefined}}(function(e){e["ALLOWED"]="allowed";e["DISALLOWED"]="disallowed";e["MAYBEALLOWED"]="mayBeAllowed"})(t.COMPONENT_IN_SLOT_STATUS||(t.COMPONENT_IN_SLOT_STATUS={}));class ISlotRestrictionsService{getAllComponentTypesSupportedOnPage(){"proxyFunction";return null}getSlotRestrictions(e){"proxyFunction";return null}isSlotEditable(e){"proxyFunction";return null}isComponentAllowedInSlot(e,t){"proxyFunction";return null}}(function(e){e["ContentPage"]="ContentPage";e["CategoryPage"]="CategoryPage";e["ProductPage"]="ProductPage";e["EmailPage"]="EmailPage"})(t.CMSPageTypes||(t.CMSPageTypes={}));(function(e){e["ACTIVE"]="ACTIVE";e["DELETED"]="DELETED"})(t.CMSPageStatus||(t.CMSPageStatus={}));(function(e){e["APPROVED"]="APPROVED";e["CHECK"]="CHECK";e["UNAPPROVED"]="UNAPPROVED"})(t.CmsApprovalStatus||(t.CmsApprovalStatus={}));class IPageService{getPageById(e){"proxyFunction";return null}getPageByUuid(e){"proxyFunction";return null}getCurrentPageInfo(){"proxyFunction";return null}getCurrentPageInfoByVersion(e){"proxyFunction";return null}isPagePrimary(e){"proxyFunction";return null}isPagePrimaryWithContext(e,t){"proxyFunction";return null}getPrimaryPage(e){"proxyFunction";return null}primaryPageForPageTypeExists(e,t){"proxyFunction";return null}getPaginatedPrimaryPagesForPageType(e,t,o){"proxyFunction";return null}getVariationPages(e){"proxyFunction";return null}updatePageById(e,t){"proxyFunction";return null}forcePageApprovalStatus(e){"proxyFunction";return null}isPageApproved(e){"proxyFunction";return null}buildUriContextForCurrentPage(e,t,o){"proxyFunction";return null}}(function(e){e["RUNNING"]="RUNNING";e["ERROR"]="ERROR";e["FAILURE"]="FAILURE";e["FINISHED"]="FINISHED";e["UNKNOWN"]="UNKNOWN";e["ABORTED"]="ABORTED";e["PENDING"]="PENDING"})(t.JOB_STATUS||(t.JOB_STATUS={}));class ISyncPollingService{registerSyncPollingEvents(){"proxyFunction";return null}changePollingSpeed(e,t){"proxyFunction";return null}fetchSyncStatus(e,t){"proxyFunction";return null}performSync(e,t){"proxyFunction";return null}getSyncStatus(e,t,o){"proxyFunction";return null}}class IEditorModalService{open(e,t,o,n,s,a){"proxyFunction";return null}openAndRerenderSlot(e,t,o,n,s){"proxyFunction";return null}openGenericEditor(e,t,o,n){"proxyFunction";return null}}class IPageTreeNodeService{constructor(){this.slotNodes=[]}buildSlotNodes(){"proxyFunction"}updateSlotNodes(e){"proxyFunction"}getSlotNodes(){"proxyFunction";return null}scrollToElement(e){"proxyFunction";return null}existedSmartEditElement(e){"proxyFunction";return null}_buildSlotNode(e){"proxyFunction";return null}_isValidElement(e){"proxyFunction";return true}}class IPageTreeService{registerTreeComponent(e){"proxyFunction";return null}getTreeComponent(){"proxyFunction";return null}}class IFileValidation{buildAcceptedFileTypesList(){"proxyFunction";return null}validate(e,t,o){"proxyFunction";return null}}class IAnimateService{addClass(e,t,o){return undefined}animate(e,t,o,n,s){return undefined}cancel(e){return undefined}closeAndFlush(){return undefined}enabled(e,t){return false}enter(e,t,o,n){return undefined}flush(){return undefined}leave(e,t){return undefined}move(e,t,o){return undefined}off(e,t,o){return undefined}on(e,t,o){return undefined}pin(e,t){return undefined}removeClass(e,t,o){return undefined}setClass(e,t,o,n){return undefined}}const bi=new d.InjectionToken("WIZARD_MANAGER");const Ii=new d.InjectionToken("WIZARD_API");class WizardService{constructor(e,t){this.defaultWizardActionStrategy=e;this.stringUtils=t;this.onLoadStep=function(e,t){return};this.onClose=function(e){return};this.onCancel=function(){return};this.onStepsUpdated=function(e){return}}initialize(e){this.validateConfig(e);this._actionStrategy=e.actionStrategy||this.defaultWizardActionStrategy;this._actionStrategy.applyStrategy(this,e);this._currentIndex=0;this._conf=Object.assign({},e);this._steps=this._conf.steps;this._getResult=e.resultFn;this.validateStepUids(this._steps);this.goToStepWithIndex(0)}executeAction(e){if(e.executeIfCondition){const t=e.executeIfCondition();return(t instanceof Promise?t:Promise.resolve(t)).then((()=>e.execute(this)))}return Promise.resolve(e.execute(this))}goToStepWithIndex(e){const t=this.getStepWithIndex(e);if(t){this.onLoadStep(e,t);this._currentIndex=e}}goToStepWithId(e){this.goToStepWithIndex(this.getStepIndexFromId(e))}addStep(e,t){if(parseInt(e.id,10)!==0&&!e.id){e.id=this.stringUtils.generateIdentifier()}if(!t){t=0}if(this._currentIndex>=t){this._currentIndex++}this._steps.splice(t,0,e);this.validateStepUids(this._steps);this._actionStrategy.applyStrategy(this,this._conf);this.onStepsUpdated(this._steps)}removeStepById(e){this.removeStepByIndex(this.getStepIndexFromId(e))}removeStepByIndex(e){if(e>=0&&e<this.getStepsCount()){this._steps.splice(e,1);if(e===this._currentIndex){this.goToStepWithIndex(0)}this._actionStrategy.applyStrategy(this,this._conf);this.onStepsUpdated(this._steps)}}close(){let e;if(typeof this._getResult==="function"){e=this._getResult()}this.onClose(e)}cancel(){this.onCancel()}getSteps(){return this._steps}getStepIndexFromId(e){const t=this._steps.findIndex((t=>t.id===e));return t}containsStep(e){return this.getStepIndexFromId(e)>=0}getCurrentStepId(){return this.getCurrentStep().id}getCurrentStepIndex(){return this._currentIndex}getCurrentStep(){return this.getStepWithIndex(this._currentIndex)}getStepsCount(){return this._steps.length}getStepWithId(e){const t=this.getStepIndexFromId(e);if(t>=0){return this.getStepWithIndex(t)}return null}getStepWithIndex(e){if(e>=0&&e<this.getStepsCount()){return this._steps[e]}throw new Error("wizardService.getStepForIndex - Index out of bounds: "+e)}validateConfig(e){if(!e.steps||e.steps.length<=0){throw new Error("Invalid WizardService configuration - no steps provided")}}validateStepUids(e){const t={};e.forEach((e=>{if(!e.id){e.id=this.stringUtils.generateIdentifier()}else if(t[e.id]){throw new Error(`Invalid (Duplicate) step id: ${e.id}`)}else{t[e.id]=e.id}}))}}const wi={id:"wizard_action_id",i18n:"wizard_action_label",isMainAction:true,enableIfCondition(){return true},executeIfCondition(){return true},execute(e){return}};let Ei=class WizardActions{customAction(e){return this.createNewAction(e)}done(e){const t={id:"ACTION_SAVE",i18n:"se.action.save",execute:e=>{e.close()}};return this.createNewAction(e,t)}next(e){const t={id:"ACTION_NEXT",i18n:"se.action.next",execute(e){e.goToStepWithIndex(e.getCurrentStepIndex()+1)}};return this.createNewAction(e,t)}navBarAction(e){if(!e.wizardService||e.destinationIndex===null){throw new Error("Error initializating navBarAction, must provide the wizardService and destinationIndex fields")}const t={id:"ACTION_GOTO",i18n:"action.goto",enableIfCondition:()=>e.wizardService.getCurrentStepIndex()>=e.destinationIndex,execute:t=>{t.goToStepWithIndex(e.destinationIndex)}};return this.createNewAction(e,t)}back(e){const t={id:"ACTION_PREVIOUS",i18n:"se.action.previous",isMainAction:false,execute(e){const t=e.getCurrentStepIndex();if(t<=0){throw new Error("Failure to execute BACK action, no previous index exists!")}e.goToStepWithIndex(t-1)}};return this.createNewAction(e,t)}cancel(){return this.createNewAction({id:"ACTION_CANCEL",i18n:"se.action.cancel",isMainAction:false,execute(e){e.cancel()}})}createNewAction(e=null,t=null){return Object.assign(Object.assign(Object.assign({},wi),t),e)}};Ei=__decorate([SeDowngradeService()],Ei);let Ti=class DefaultWizardActionStrategy{constructor(e){this.wizardActions=e}applyStrategy(e,t){const o=this.applyOverrides(e,this.wizardActions.next(),t.nextLabel,t.onNext,t.isFormValid);const n=this.applyOverrides(e,this.wizardActions.done(),t.doneLabel,t.onDone,t.isFormValid);const s=t.backLabel?{i18n:t.backLabel}:null;const a=this.wizardActions.back(s);t.steps.forEach(((e,s)=>{e.actions=[];if(s>0){e.actions.push(a)}if(s===t.steps.length-1){e.actions.push(n)}else{e.actions.push(o)}}));t.cancelAction=this.applyOverrides(e,this.wizardActions.cancel(),t.cancelLabel,t.onCancel,null);t.templateOverride="modalWizardNavBarTemplate.html"}applyOverrides(e,t,o,n,s){if(o){t.i18n=o}if(n){t.executeIfCondition=function(){return n(e.getCurrentStepId())}}if(s){t.enableIfCondition=function(){return s(e.getCurrentStepId())}}return t}};Ti.$inject=["wizardActions"];Ti=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[Ei])],Ti);window.__smartedit__.addDecoratorPayload("Component","ModalWizardTemplateComponent",{selector:"se-modal-wizard-template",template:`\n        <div id="yModalWizard">\n            <div class="se-modal-wizard-template">\n                <se-modal-wizard-nav-bar\n                    [navActions]="_wizardContext?.navActions"\n                    (executeAction)="executeAction($event)"\n                ></se-modal-wizard-nav-bar>\n                <se-modal-wizard-step-outlet\n                    [steps]="_wizardContext?._steps"\n                    [wizardService]="wizardService"\n                    [wizardApiInjector]="wizardInjector"\n                ></se-modal-wizard-step-outlet>\n            </div>\n        </div>\n    `});t.ModalWizardTemplateComponent=class ModalWizardTemplateComponent{constructor(e,t,o,n,s){this.modalManager=e;this.wizardActions=t;this.defaultWizardActionStrategy=o;this.componentFactoryResolver=n;this.injector=s}ngOnInit(){this.modalManager.getModalData().subscribe((e=>{this.wizardService=new WizardService(this.defaultWizardActionStrategy,ae);this.wizardService.properties=e.properties;if(e.component){this.createWizardApiInjector(e)}if(typeof this.getWizardConfig!=="function"){throw new Error("The provided controller must provide a getWizardConfig() function.")}const t=this.getWizardConfig();this._wizardContext={_steps:t.steps};this.executeAction=e=>{this.wizardService.executeAction(e)};this.wizardService.onLoadStep=(e,t)=>{this.modalManager.setTitle(t.title);if(t.component){this._wizardContext.component=t.component}this.modalManager.removeAllButtons();const o=(t.actions||[]).map((e=>this.convertActionToButtonConf(e)));this.modalManager.addButtons(o)};this.wizardService.onClose=e=>{this.modalManager.close(e)};this.wizardService.onCancel=()=>{this.modalManager.close()};this.wizardService.onStepsUpdated=e=>{this.setupNavBar(e);this._wizardContext._steps=e};this.wizardService.initialize(t);this.setupModal(t)}))}setupNavBar(e){this._wizardContext.navActions=e.map(((e,t)=>{const o=this.wizardActions.navBarAction({id:"NAV-"+e.id,stepIndex:t,wizardService:this.wizardService,destinationIndex:t,i18n:e.name,isCurrentStep:()=>o.stepIndex===this.wizardService.getCurrentStepIndex()});return o}))}setupModal(e){this._wizardContext.templateOverride=e.templateOverride;if(e.cancelAction){this.modalManager.setDismissCallback((()=>this.wizardService.executeAction(e.cancelAction)))}this.setupNavBar(e.steps)}convertActionToButtonConf(e){return{id:e.id,style:e.isMainAction?s.ModalButtonStyle.Primary:s.ModalButtonStyle.Default,label:e.i18n,action:s.ModalButtonAction.None,disabledFn:()=>!e.enableIfCondition(),callback:()=>{this.wizardService.executeAction(e);return v.of(null)}}}createWizardApiInjector(e){const t=d.Injector.create({providers:[{provide:bi,useValue:this.wizardService}],parent:this.injector});const o=this.componentFactoryResolver.resolveComponentFactory(e.component);const n=o.create(t).instance;r.assign(this,n);this.wizardInjector=d.Injector.create({providers:[{provide:Ii,useValue:n}],parent:this.injector})}};t.ModalWizardTemplateComponent=__decorate([d.Component({selector:"se-modal-wizard-template",template:`\n        <div id="yModalWizard">\n            <div class="se-modal-wizard-template">\n                <se-modal-wizard-nav-bar\n                    [navActions]="_wizardContext?.navActions"\n                    (executeAction)="executeAction($event)"\n                ></se-modal-wizard-nav-bar>\n                <se-modal-wizard-step-outlet\n                    [steps]="_wizardContext?._steps"\n                    [wizardService]="wizardService"\n                    [wizardApiInjector]="wizardInjector"\n                ></se-modal-wizard-step-outlet>\n            </div>\n        </div>\n    `}),__metadata("design:paramtypes",[s.ModalManagerService,Ei,Ti,d.ComponentFactoryResolver,d.Injector])],t.ModalWizardTemplateComponent);t.ModalWizard=class ModalWizard{constructor(e){this.modalService=e}open(e){this.validateConfig(e);return new Promise(((o,n)=>{const s=this.modalService.open({component:t.ModalWizardTemplateComponent,templateConfig:{isDismissButtonVisible:true},data:e,config:{focusTrapped:false,backdropClickCloseable:false}});s.afterClosed.subscribe(o,n)}))}validateConfig(e){if(!e.controller&&!e.component){throw new Error("WizardService - initialization exception. No controller nor component provided")}if(e.controller&&e.component){throw new Error("WizardService - initialization exception. Provide either controller or component")}}};t.ModalWizard.$inject=["modalService"];t.ModalWizard=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.IModalService])],t.ModalWizard);class CompileHtml{constructor(e,t,o){this.elementRef=e;this.renderer=t;this.upgrade=o}ngOnChanges(e){const t=this.hasInputChanged(e.template);const o=this.hasInputChanged(e.scope);this.template=t?e.template.currentValue:this.template;if(this.template&&(o||t)){this.setCompiledHTML()}}ngOnDestroy(){this.resetScope();this.removeCompiledHTML()}resetScope(){if(this.$scope){this.$scope.$destroy()}}removeCompiledHTML(){if(this.elementRef.nativeElement.firstChild){this.renderer.removeChild(this.elementRef.nativeElement,this.elementRef.nativeElement.firstChild)}}hasInputChanged(e){return!!e&&!r.isEqual(e.previousValue,e.currentValue)}setCompiledHTML(){this.removeCompiledHTML();this.resetScope();this.renderer.appendChild(this.elementRef.nativeElement,this.compile())}compile(){let e=this.isTemplateUrl(this.template)?this.$templateCache.get(this.template):this.template;this.$scope=this.$rootScope.$new(false);if(!e){throw new Error(`did not find cached template for file ${this.template} when building tab`)}Object.assign(this.$scope,this.scope||{});if(this.compileHtmlNgController){this.$scope[this.compileHtmlNgController.alias]=this;e=this.wrapTemplateIntoNgController(e,this.compileHtmlNgController.alias)}return this.$compile(e)(this.$scope)[0]}wrapTemplateIntoNgController(e,t){return`<div ng-controller="${t}.compileHtmlNgController.value as ${t}">${e}</div>`}isTemplateUrl(e){return/.html$/.test(e)}get $templateCache(){return this.upgrade.$injector.get("$templateCache")}get $compile(){return this.upgrade.$injector.get("$compile")}get $rootScope(){return this.upgrade.$injector.get("$rootScope")}}__decorate([d.Input(),__metadata("design:type",Object)],CompileHtml.prototype,"scope",void 0);__decorate([d.Input(),__metadata("design:type",Object)],CompileHtml.prototype,"compileHtmlNgController",void 0);t.CompileHtmlDirective=class CompileHtmlDirective extends CompileHtml{constructor(e,t,o){super(e,t,o)}ngOnChanges(e){e.template=e.seCompileHtml;super.ngOnChanges(e)}};__decorate([d.Input(),__metadata("design:type",String)],t.CompileHtmlDirective.prototype,"seCompileHtml",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.CompileHtmlDirective.prototype,"scope",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.CompileHtmlDirective.prototype,"compileHtmlNgController",void 0);t.CompileHtmlDirective=__decorate([d.Directive({selector:"[seCompileHtml]"}),__metadata("design:paramtypes",[d.ElementRef,d.Renderer2,n.UpgradeModule])],t.CompileHtmlDirective);t.NgIncludeDirective=class NgIncludeDirective extends CompileHtml{constructor(e,t,o){super(e,t,o)}ngOnChanges(e){e.template=e.ngInclude;super.ngOnChanges(e)}};__decorate([d.Input(),__metadata("design:type",String)],t.NgIncludeDirective.prototype,"ngInclude",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.NgIncludeDirective.prototype,"scope",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.NgIncludeDirective.prototype,"compileHtmlNgController",void 0);t.NgIncludeDirective=__decorate([d.Directive({selector:"[ngInclude]"}),__metadata("design:paramtypes",[d.ElementRef,d.Renderer2,n.UpgradeModule])],t.NgIncludeDirective);t.CompileHtmlModule=class CompileHtmlModule{};t.CompileHtmlModule=__decorate([d.NgModule({declarations:[t.NgIncludeDirective,t.CompileHtmlDirective],exports:[t.NgIncludeDirective,t.CompileHtmlDirective]})],t.CompileHtmlModule);window.__smartedit__.addDecoratorPayload("Component","ModalWizardNavBarComponent",{selector:"se-modal-wizard-nav-bar",template:`\n        <div class="se-modal-wizard__steps-container" *ngIf="navActions">\n            <div *ngFor="let action of navActions; let isLast = last" class="se-modal-wizard__step">\n                <button\n                    [attr.id]="action.id"\n                    [ngClass]="{\n                        'se-modal-wizard-step__action--enabled': action.enableIfCondition(),\n                        'se-modal-wizard-step__action--disabled': !action.enableIfCondition(),\n                        'se-modal-wizard-step__action--current': action.isCurrentStep()\n                    }"\n                    class="se-modal-wizard-step__action"\n                    (click)="onClickAction(action)"\n                    [disabled]="!action.enableIfCondition()"\n                >\n                    {{ action.i18n | translate }}\n                </button>\n                <span\n                    *ngIf="!isLast"\n                    [ngClass]="{\n                        'se-modal-wizard__step-icon-next--enabled': action.enableIfCondition(),\n                        'se-modal-wizard__step-icon-next--disabled': !action.enableIfCondition()\n                    }"\n                    class="sap-icon--navigation-right-arrow se-modal-wizard__step-icon-next"\n                >\n                </span>\n            </div>\n        </div>\n    `});t.ModalWizardNavBarComponent=class ModalWizardNavBarComponent{constructor(){this.executeAction=new d.EventEmitter}onClickAction(e){this.executeAction.emit(e)}};__decorate([d.Input(),__metadata("design:type",Array)],t.ModalWizardNavBarComponent.prototype,"navActions",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.ModalWizardNavBarComponent.prototype,"executeAction",void 0);t.ModalWizardNavBarComponent=__decorate([d.Component({selector:"se-modal-wizard-nav-bar",template:`\n        <div class="se-modal-wizard__steps-container" *ngIf="navActions">\n            <div *ngFor="let action of navActions; let isLast = last" class="se-modal-wizard__step">\n                <button\n                    [attr.id]="action.id"\n                    [ngClass]="{\n                        'se-modal-wizard-step__action--enabled': action.enableIfCondition(),\n                        'se-modal-wizard-step__action--disabled': !action.enableIfCondition(),\n                        'se-modal-wizard-step__action--current': action.isCurrentStep()\n                    }"\n                    class="se-modal-wizard-step__action"\n                    (click)="onClickAction(action)"\n                    [disabled]="!action.enableIfCondition()"\n                >\n                    {{ action.i18n | translate }}\n                </button>\n                <span\n                    *ngIf="!isLast"\n                    [ngClass]="{\n                        'se-modal-wizard__step-icon-next--enabled': action.enableIfCondition(),\n                        'se-modal-wizard__step-icon-next--disabled': !action.enableIfCondition()\n                    }"\n                    class="sap-icon--navigation-right-arrow se-modal-wizard__step-icon-next"\n                >\n                </span>\n            </div>\n        </div>\n    `})],t.ModalWizardNavBarComponent);window.__smartedit__.addDecoratorPayload("Component","ModalWizardStepOutletComponent",{selector:"se-modal-wizard-step-outlet",template:`\n        <ng-container *ngIf="steps && steps.length > 0">\n            <ng-container *ngFor="let step of steps">\n                <div\n                    [ngClass]="{\n                        'se-modal-wizard__content--visible': isActive(step)\n                    }"\n                    class="se-modal-wizard__content"\n                >\n                    <div *ngIf="step.component">\n                        <ng-container\n                            *ngComponentOutlet="step.component; injector: wizardApiInjector"\n                        ></ng-container>\n                    </div>\n                </div>\n            </ng-container>\n        </ng-container>\n    `});t.ModalWizardStepOutletComponent=class ModalWizardStepOutletComponent{isActive(e){return this.wizardService.getCurrentStepId()===e.id}};__decorate([d.Input(),__metadata("design:type",Array)],t.ModalWizardStepOutletComponent.prototype,"steps",void 0);__decorate([d.Input(),__metadata("design:type",WizardService)],t.ModalWizardStepOutletComponent.prototype,"wizardService",void 0);__decorate([d.Input(),__metadata("design:type",d.Injector)],t.ModalWizardStepOutletComponent.prototype,"wizardApiInjector",void 0);t.ModalWizardStepOutletComponent=__decorate([d.Component({selector:"se-modal-wizard-step-outlet",template:`\n        <ng-container *ngIf="steps && steps.length > 0">\n            <ng-container *ngFor="let step of steps">\n                <div\n                    [ngClass]="{\n                        'se-modal-wizard__content--visible': isActive(step)\n                    }"\n                    class="se-modal-wizard__content"\n                >\n                    <div *ngIf="step.component">\n                        <ng-container\n                            *ngComponentOutlet="step.component; injector: wizardApiInjector"\n                        ></ng-container>\n                    </div>\n                </div>\n            </ng-container>\n        </ng-container>\n    `})],t.ModalWizardStepOutletComponent);t.WizardModule=class WizardModule{};t.WizardModule=__decorate([d.NgModule({imports:[f.CommonModule,t.CompileHtmlModule,S.TranslateModule],providers:[t.ModalWizard,Ei,Ti],declarations:[t.ModalWizardTemplateComponent,t.ModalWizardNavBarComponent,t.ModalWizardStepOutletComponent],entryComponents:[t.ModalWizardTemplateComponent,t.ModalWizardNavBarComponent,t.ModalWizardStepOutletComponent]})],t.WizardModule);function $exceptionHandler(e){"ngInject";const t=[/^Possibly unhandled rejection/];const o=[/Unexpected request/,/No more request expected/];return function exceptionHandler(n,s){if(t.some((e=>e.test(n)))){return}if(o.some((e=>e.test(n)))){e.error(`E2E mock issue: ${n}`);return}e.error(n)}}function isAjaxError(e){return e.hasOwnProperty("headers")}function handlePromiseRejections(e,t,o,n){const defaultFailureCallback=n=>{if(undefined!==n&&"canceled"!==n){if(o.isPlainObject(n)){if(!isAjaxError(n)){t.error(`exception caught in promise: ${JSON.stringify(n)}`)}}else if(!o.isBoolean(n)){t.error(n)}}return e.reject(n)};const s=n.then;n.then=function(e,t,o){const n=t?t:defaultFailureCallback;return s.call(this,e,n,o)};return n}t.ConfigModule=class ConfigModule{};t.ConfigModule=__decorate([SeModule({providers:[$exceptionHandler],config:["$qProvider","$provide",(e,t)=>{"ngInject";e.errorOnUnhandledRejections(true);t.decorator("$q",["$delegate","$log","lodash",(e,t,o)=>{"ngInject";const n=e.when;e.when=function(){if(arguments[0]&&!arguments[0].then){return handlePromiseRejections(e,t,o,n.apply(this,arguments))}else{return n.apply(this,arguments)}};const s=e.all;e.all=function(){return handlePromiseRejections(e,t,o,s.apply(e,arguments))};const a=e.defer;e.defer=function(){const n=a.bind(e)();handlePromiseRejections(e,t,o,n.promise);return n};return e}]);t.decorator("$timeout",["$delegate","$q","$log","lodash",(e,t,o,n)=>{"ngInject";const s=e;function wrappedTimeout(){let a;const r=arguments;if(typeof window.Zone==="function"){(new window.Zone).run((()=>{a=handlePromiseRejections(t,o,n,s.apply(e,r))}))}else{a=handlePromiseRejections(t,o,n,s.apply(e,r))}return a}n.merge(wrappedTimeout,s);return wrappedTimeout}])}]})],t.ConfigModule);const Pi=new d.InjectionToken("TOOLBAR_ITEM");(function(e){e["TEMPLATE"]="TEMPLATE";e["ACTION"]="ACTION";e["HYBRID_ACTION"]="HYBRID_ACTION"})(t.ToolbarItemType||(t.ToolbarItemType={}));(function(e){e["left"]="left";e["middle"]="middle";e["right"]="right"})(t.ToolbarSection||(t.ToolbarSection={}));(function(e){e["left"]="left";e["center"]="center";e["right"]="right"})(t.ToolbarDropDownPosition||(t.ToolbarDropDownPosition={}));class IToolbarService{constructor(e,t,o){this.logService=e;this.$templateCache=t;this.permissionService=o;this.aliases=[];this.actions={}}getActions(){return this.actions}getAliases(){return this.aliases}addItems(e){const t=e.filter((e=>{let t=true;if(!e.key){this.logService.error("addItems() - Cannot add item without key.");t=false}return t})).map((e=>{const t=e.key;this.actions[t]=e.callback;const o={key:t,name:e.nameI18nKey,iconClassName:e.iconClassName,description:e.descriptionI18nKey,icons:e.icons,type:e.type,priority:e.priority||500,section:e.section||"left",isOpen:false,component:e.component,actionButtonFormat:e.actionButtonFormat,keepAliveOnClose:e.keepAliveOnClose||false,contextComponent:e.contextComponent,dropdownPosition:e.dropdownPosition,permissions:e.permissions};return this._populateIsPermissionGranted(o)}));return Promise.all(t).then((e=>{if(e.length>0){this.addAliases(e)}return}))}_populateIsPermissionGranted(e){if(e.permissions){return Promise.resolve(this.permissionService.isPermitted([{names:e.permissions}]).then((t=>{e.isPermissionGranted=t;return e})))}else{e.isPermissionGranted=true;return Promise.resolve(e)}}addAliases(e){"proxyFunction";return}removeItemByKey(e){"proxyFunction";return}_removeItemOnInner(e){"proxyFunction";return}removeAliasByKey(e){"proxyFunction";return}triggerActionOnInner(e){"proxyFunction";return}}const Ai=/web.+\/(\w+)\.html/;const delegator=e=>{"ngInject";const t={};const o=e.put;e.put=function(){const n=arguments[0];const s=arguments[1];if(Ai.test(n)){const a=Ai.exec(n)[1]+".html";if(!t[a]){o.apply(e,[a,s]);t[a]=n}else{throw new Error(`[templateCacheDecorator] html templates ${t[a]} and ${n} are conflicting, you must give them different filenames`)}}return o.apply(e,arguments)};return e};delegator.$inject=["$delegate"];t.TemplateCacheDecoratorModule=class TemplateCacheDecoratorModule{};t.TemplateCacheDecoratorModule=__decorate([SeModule({config:["$provide",e=>{"ngInject";e.decorator("$templateCache",["$delegate",delegator])}]})],t.TemplateCacheDecoratorModule);t.TextTruncateService=class TextTruncateService{truncateToNearestWord(e,t,o=""){if(r.isNil(t)||e>t.length){return new TruncatedText(t,t,false)}const n=/(\s)/g;const s=t.match(n);let a=0;if(!s){a=e}else{for(let o=0;o<s.length;o++){const n=this.getPositionOfCharacters(t,s[o],o+1);if(n>e){break}a=n}}const d=t.substr(0,a);return new TruncatedText(t,d,true,o)}getPositionOfCharacters(e,t,o){return e.split(t,o).join(t).length}};t.TextTruncateService=__decorate([SeDowngradeService()],t.TextTruncateService);const Oi="FrequentlyChangingContent";const xi=new s.CacheAction(Oi);const Di="RarelyChangingContent";const Ri=new s.CacheAction(Di);const ki=new s.EvictionTag({event:"AUTHORIZATION_SUCCESS"});const Mi=new s.EvictionTag({event:"USER_HAS_CHANGED"});const Ni=new s.EvictionTag({event:"CATALOG_SYNCHRONIZED_EVENT"});const Fi=new s.EvictionTag({event:"CATALOG_EVENT",relatedTags:[Ni,Mi]});const zi=new s.EvictionTag({event:"PAGE_CREATED_EVENT"});const Li=new s.EvictionTag({event:"PAGE_DELETED_EVENT"});const Vi=new s.EvictionTag({event:"PAGE_UPDATED_EVENT"});const Ui=new s.EvictionTag({event:"PAGE_RESTORED_EVENT"});const ji=new s.EvictionTag({event:"PAGE_CHANGE"});const $i=new s.EvictionTag({event:"pageEvictionTag",relatedTags:[zi,Li,Vi]});const Bi=new s.EvictionTag({event:"EVENT_CONTENT_CATALOG_UPDATE"});const Gi=new s.EvictionTag({event:"EVENT_PERSPECTIVE_CHANGED"});const Hi="/cmssmarteditwebservices/v1/sites/:siteUID/contentcatalogs";t.ContentCatalogRestService=class ContentCatalogRestService extends s.AbstractCachedRestService{constructor(e){super(e,Hi)}};t.ContentCatalogRestService.$inject=["restServiceFactory"];t.ContentCatalogRestService=__decorate([s.CacheConfig({actions:[Ri],tags:[Mi,$i,Bi]}),s.OperationContextRegistered(Hi,["CMS","INTERACTIVE"]),SeDowngradeService(),__metadata("design:paramtypes",[s.RestServiceFactory])],t.ContentCatalogRestService);t.ProductCatalogRestService=class ProductCatalogRestService extends s.AbstractCachedRestService{constructor(e){super(e,"/cmssmarteditwebservices/v1/sites/:siteUID/productcatalogs")}};t.ProductCatalogRestService.$inject=["restServiceFactory"];t.ProductCatalogRestService=__decorate([SeDowngradeService(),s.CacheConfig({actions:[Ri],tags:[Mi]}),__metadata("design:paramtypes",[s.RestServiceFactory])],t.ProductCatalogRestService);t.PermissionsRestService=class PermissionsRestService{constructor(e){this.URI="/permissionswebservices/v1/permissions/global/search";this.resource=e.get(this.URI)}get(e){return this.resource.queryByPost({principalUid:e.user},{permissionNames:e.permissionNames}).then((e=>({permissions:e.permissions})))}};t.PermissionsRestService.$inject=["restServiceFactory"];t.PermissionsRestService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.RestServiceFactory])],t.PermissionsRestService);t.AuthorizationService=class AuthorizationService{constructor(e,t,o){this.logService=e;this.sessionService=t;this.permissionsRestService=o}hasGlobalPermissions(e){if(!e.length||e.length<1){throw new Error("permissionNames must be a non-empty array")}const onSuccess=t=>this.mergePermissionResults(t,e);const onError=()=>{this.logService.error("AuthorizationService - Failed to determine authorization for the following permissions: "+e.toString());return false};return this.getPermissions(e).then(onSuccess,onError)}getPermissionResult(e,t){const o=e.permissions.find((e=>e.key.toLowerCase()===t.toLowerCase()));return!!o&&o.value==="true"}mergePermissionResults(e,t){let o=!!t&&t.length>0;let n=0;while(o&&n<t.length){o=o&&this.getPermissionResult(e,t[n++])}return o}getPermissions(e){return this.sessionService.getCurrentUsername().then((t=>{if(!t){return{permissions:[]}}return this.permissionsRestService.get({user:t,permissionNames:e.join(",")})}))}};t.AuthorizationService.$inject=["logService","sessionService","permissionsRestService"];t.AuthorizationService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.LogService,s.ISessionService,t.PermissionsRestService])],t.AuthorizationService);t.CrossFrameEventServiceGateway=class CrossFrameEventServiceGateway{constructor(e){return e.createGateway("CROSS_FRAME_EVENT")}};t.CrossFrameEventServiceGateway.$inject=["gatewayFactory"];t.CrossFrameEventServiceGateway.crossFrameEventServiceGatewayToken=new d.InjectionToken("crossFrameEventServiceGatewayToken");t.CrossFrameEventServiceGateway=__decorate([d.Injectable(),__metadata("design:paramtypes",[t.GatewayFactory])],t.CrossFrameEventServiceGateway);window.__smartedit__.addDecoratorPayload("Injectable","CrossFrameEventService",{providedIn:"root"});t.CrossFrameEventService=class CrossFrameEventService{constructor(e,t,o){this.systemEventService=e;this.crossFrameEventServiceGateway=t;this.windowUtils=o}publish(e,t){const o=[this.systemEventService.publishAsync(e,t)];if(this.windowUtils.getGatewayTargetFrame()){o.push(this.crossFrameEventServiceGateway.publish(e,t))}return Promise.all(o)}subscribe(e,t){const o=this.systemEventService.subscribe(e,t);const n=this.crossFrameEventServiceGateway.subscribe(e,t);const unsubscribeFn=function(){o();n()};return unsubscribeFn}};t.CrossFrameEventService.$inject=["systemEventService","crossFrameEventServiceGateway","windowUtils"];t.CrossFrameEventService=__decorate([SeDowngradeService(),d.Injectable({providedIn:"root"}),__param(1,d.Inject(t.CrossFrameEventServiceGateway.crossFrameEventServiceGatewayToken)),__metadata("design:paramtypes",[t.SystemEventService,MessageGateway,t.WindowUtils])],t.CrossFrameEventService);const Wi="GatewayProxied";const qi=s.annotationService.getClassAnnotationFactory(Wi);function GatewayProxiedAnnotationFactory(e){"ngInject";return s.annotationService.setClassAnnotationFactory(Wi,(function(t){return function(o,n,s){o=new(n.bind(o))(...s);o.gatewayId=$.buildServiceName(n);e.initForService(o,t.length>0?t:null);return o}}))}let Ki=class Instrumentation{constructor(e){this.readObjectStructure=e;this._FUNCTION_EXECUTION_DATA={};this._DECORATED_MODULES=[];this._DEFAULT_LEVEL=10;this.alreadyBrowsed=[];this.functionsUtils=new s.FunctionsUtils}execute(e,t,o){const n=t||this._DEFAULT_LEVEL;if(e.modules===undefined){return}this._logFunctionArgumentsAndReturnValue=this._logFunctionArgumentsAndReturnValue.bind(this);this._getServiceConfig=this._getServiceConfig.bind(this);this._getIterableDelegate=this._getIterableDelegate.bind(this);this._getDelegateFunctions=this._getDelegateFunctions.bind(this);this._extractComponentBindings=this._extractComponentBindings.bind(this);this._extractDirectiveBindings=this._extractDirectiveBindings.bind(this);e.modules.forEach((t=>{this.alreadyBrowsed.push(t);if(!o){if(this._DECORATED_MODULES.indexOf(t)>-1||!t.endsWith("Module")){return}}this._DECORATED_MODULES.push(t);const s=a.module(t);s._invokeQueue.forEach((o=>{this._handleInvokeQueue(o,this,e,t)}));if(n>0){const t=n-1;s.requires.forEach((o=>{this._loopModueRequires(o,e,t)}))}}))}_loopModueRequires(e,t,o){if(this.alreadyBrowsed.indexOf(e)===-1&&t.defaultExcludeModules.indexOf(e)===-1&&e.indexOf("Mock")===-1){this.execute({globalExcludedRecipes:t.globalExcludedRecipes,globalIncludedRecipes:t.globalIncludedRecipes,globalExcludedFunctions:t.globalExcludedFunctions,globalIncludedFunctions:t.globalIncludedFunctions,modules:[e],$provide:t.$provide,defaultExcludeModules:t.defaultExcludeModules},o,false)}}_handleOriginal(e,t,o,n){if(e[t.name].__DECORATED__){return}const s=o;const a=s.functionsUtils.isEmpty(t.fn);if(a){e[t.name]=function(){"proxyFunction";const e=t.fn.apply(this,...arguments);s._logFunctionArgumentsAndReturnValue(n,t.name,arguments,e);return e}}else{e[t.name]=function(){const e=t.fn.apply(this,...arguments);s._logFunctionArgumentsAndReturnValue(n,t.name,arguments,e);return e}}e[t.name].__DECORATED__=true}_handleDefaultInvoke(e,t,o,n){const s=this._getServiceConfig(n);const a=s.exclude.concat(o.globalExcludedFunctions||[]);const r=s.include.concat(o.globalIncludedFunctions||[]);const d=e[2];const p=d[0];const m=e[1];try{if(!t._isEligible(p,o.globalExcludedRecipes,o.globalIncludedRecipes)){t.warn("not eligible recipe : "+p);return}o.$provide.decorator(p,(e=>{const o=t._getIterableDelegate(e);const n=t._getDelegateFunctions(o,a,r);n.forEach((e=>{this._handleOriginal(o,e,t,p)}));return e}))}catch(e){t.error(e);t.warn(`Warning-No-Service-Exists:  ${p} of type ${m} , moduleName: ${n}`)}}_handleInvokeQueue(e,t,o,n){const s=e[1];if(["factory","component","service","directive"].indexOf(s)<=-1){return}const a=e[2];switch(s){case"component":t._extractComponentBindings(a);break;case"directive":t._extractDirectiveBindings(a);break;default:this._handleDefaultInvoke(e,t,o,n)}}_getServiceConfig(e){return typeof e==="string"?{name:e,exclude:[],include:[]}:e}_getIterableDelegate(e){return e.prototype?e.prototype:e}_matches(e,t){return new RegExp(t,"gi").test(e)}_getDelegateFunctions(e,t,o){const n=[];for(const s in e){if(typeof e[s]==="function"&&this._isEligible(s,t,o)){n.push({name:s,fn:e[s]})}}return n}_isEligible(e,t,o){return(!o.length||!!o.find(this._matches.bind(this,e)))&&(!t.length||!t.find(this._matches.bind(this,e)))}_resultIsPromise(e){return!!e&&(e.$$state!==undefined||!!e.then)}_keyExists(e){if(this._FUNCTION_EXECUTION_DATA[e]!==undefined){return true}return false}_extractComponentBindings(e){const t=e[0];const o=e[1].bindings;this._logDirectiveResult(t,o)}_extractDirectiveBindings(e){const t=e[0];try{const o=e[1];let n=null;if(typeof o==="function"){n=o()}else if(o instanceof Array){n=o[o.length-1]()}if(n){const e=n.scope;const o=n.bindToController;this._logDirectiveResult(t,undefined,e,o)}}catch(e){this._logDirectiveResult(t)}}_logFunctionArgumentsAndReturnValue(e,t,o,n){const successCallback=o=>{try{this._FUNCTION_EXECUTION_DATA[r]={serviceName:e,functionName:t,arguments:s,result:{promiseValue:this.readObjectStructure(o)}};this.warn(a.toJson(this._FUNCTION_EXECUTION_DATA[r]))}catch(e){this.error("COULD NOT STRINGIFY")}return Promise.resolve(o)};const failCallback=o=>{this.error("ERROR WHILE RESOLVING RESULT: "+o);this._FUNCTION_EXECUTION_DATA[r]={serviceName:e,functionName:t,arguments:s,result:{promiseValue:o}};this.warn(a.toJson(this._FUNCTION_EXECUTION_DATA[r]));return Promise.reject(o)};const s=this.readObjectStructure(Array.prototype.slice.call(o));let r=null;try{const o=a.toJson(s);r=`${e} ~ ${t} ~ ${o}`}catch(e){this.error("COULD NOT GENERATE KEY");return n}if(this._keyExists(r)){return n}this._FUNCTION_EXECUTION_DATA[r]={};if(this._resultIsPromise(n)){return n.then(successCallback,failCallback)}this._FUNCTION_EXECUTION_DATA[r]={serviceName:e,functionName:t,arguments:s,result:this.readObjectStructure(n)};try{this.warn(a.toJson(this._FUNCTION_EXECUTION_DATA[r]))}catch(e){this.error("COULD NOT STRINGIFY")}return n}_logDirectiveResult(e,t,o,n){this.warn(a.toJson({directiveName:e,bindings:t,scope:o,bindToController:n}))}warn(e){console.warn(e)}error(e){console.error(e)}};Ki.$inject=["readObjectStructure"];Ki=__decorate([SeInjectable(),__metadata("design:paramtypes",[Function])],Ki);function getItemFromSessionStorage(e){try{return window.sessionStorage.getItem(e)}catch(e){return null}}const instrument=(e,t,o)=>{"ngInject";if(getItemFromSessionStorage("isInstrumented")==="true"){new Ki(t).execute({globalExcludedRecipes:["assetsService","configurationExtractorService","experienceService"],globalIncludedRecipes:["^.*Interface$","^.*Service$","^.*Helper$","^.*Hanlder$","^.*Editor$","^I.*$","^.*Decorator$","^.*Directive$","^.*Registry$","^.*Listener$","^.*Resource$","^.*Populator$","^.*Constants$","^.*Factory$","^.*Facade$","^.*Interceptor$","^.*Manager$","^.*Class$","^.*Strategy","^.*Predicate","^.*Retry","^.*Gateway"],globalExcludedFunctions:["^_.*$","^\\$","lodash","yjQuery"],globalIncludedFunctions:["^.*$"],defaultExcludeModules:["ycmssmarteditModule","ui.bootstrap","ui.select","yjQuery","instrumentModule","ui.tree","treeModule"],modules:[o],$provide:e},15,true)}};instrument.$inject=["$provide","readObjectStructure","TOP_LEVEL_MODULE_NAME"];t.LanguageService=class LanguageService extends s.LanguageService{constructor(e,t,o,n,s,a,r,d){super(e,t,o,n,s,a,r,d);this.logService=e;this.translateService=t;this.promiseUtils=o;this.eventService=n;this.browserService=s;this.storageService=a;this.injector=r;this.languageServiceConstants=d}getLanguagesForSite(e){return this.languageRestService.get({siteUID:e}).then((e=>e.languages),(e=>{this.logService.error("LanguageService.getLanguagesForSite() - Error loading languages");return Promise.reject(e)}))}get languageRestService(){return this.injector.get(s.RestServiceFactory).get(this.languageServiceConstants.LANGUAGE_RESOURCE_URI)}};t.LanguageService.$inject=["logService","translateService","promiseUtils","eventService","browserService","storageService","injector","languageServiceConstants"];__decorate([s.Cached({actions:[s.rarelyChangingContent]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.LanguageService.prototype,"getLanguagesForSite",null);t.LanguageService=__decorate([SeDowngradeService(),__param(3,d.Inject(s.EVENT_SERVICE)),__param(7,d.Inject(s.LANGUAGE_SERVICE_CONSTANTS)),__metadata("design:paramtypes",[s.LogService,S.TranslateService,s.PromiseUtils,Object,s.BrowserService,s.IStorageService,d.Injector,Object])],t.LanguageService);var Yi;t.LanguageServiceGateway=Yi=class LanguageServiceGateway{constructor(e){Yi.instance=Yi.instance||e.createGateway("languageSwitch")}getInstance(){return Yi.instance}};t.LanguageServiceGateway=Yi=__decorate([SeDowngradeService(),d.Injectable(),__metadata("design:paramtypes",[t.GatewayFactory])],t.LanguageServiceGateway);class IPerspectiveService{register(e){"proxyFunction";return null}switchTo(e){"proxyFunction";return null}hasActivePerspective(){"proxyFunction";return null}selectDefault(){"proxyFunction";return null}isEmptyPerspectiveActive(){"proxyFunction";return null}refreshPerspective(){"proxyFunction";return null}getActivePerspectiveKey(){"proxyFunction";return null}isHotkeyEnabledForActivePerspective(){"proxyFunction";return null}getActivePerspective(){"proxyFunction";return null}getPerspectives(){"proxyFunction";return null}}var Zi;t.GenericEditorStackService=Zi=class GenericEditorStackService{constructor(e,t){this.systemEventService=e;this.logService=t;this._editorsStacks={};this.systemEventService.subscribe(Zi.EDITOR_PUSH_TO_STACK_EVENT,this.pushEditorEventHandler.bind(this));this.systemEventService.subscribe(Zi.EDITOR_POP_FROM_STACK_EVENT,this.popEditorEventHandler.bind(this))}isAnyGenericEditorOpened(){return r.size(this._editorsStacks)>=1}areMultipleGenericEditorsOpened(){return r.size(this._editorsStacks)>1||r.some(this._editorsStacks,(e=>e.length>1))}getEditorsStack(e){return this._editorsStacks[e]||null}isTopEditorInStack(e,t){let o=false;const n=this._editorsStacks[e];if(n){const e=n[n.length-1];o=e&&e.editorId===t}return o}pushEditorEventHandler(e,t){this.validateId(t);const o=t.editorStackId;if(!this._editorsStacks[o]){this._editorsStacks[o]=[]}this._editorsStacks[o].push({component:t.component,componentType:t.componentType,editorId:t.editorId})}popEditorEventHandler(e,t){this.validateId(t);const o=t.editorStackId;const n=this._editorsStacks[o];if(!n){this.logService.warn("genericEditorStackService - Stack of editors not found. Cannot pop editor.");return}n.pop();if(n.length===0){delete this._editorsStacks[o]}}validateId(e){if(!e.editorStackId){throw new Error("genericEditorStackService - Must provide a stack id.")}}};t.GenericEditorStackService.EDITOR_PUSH_TO_STACK_EVENT="EDITOR_PUSH_TO_STACK_EVENT";t.GenericEditorStackService.EDITOR_POP_FROM_STACK_EVENT="EDITOR_POP_FROM_STACK_EVENT";t.GenericEditorStackService=Zi=__decorate([SeDowngradeService(),d.Injectable(),__metadata("design:paramtypes",[t.SystemEventService,s.LogService])],t.GenericEditorStackService);t.NonValidationErrorInterceptor=class NonValidationErrorInterceptor{constructor(e,t){this.alertService=e;this.genericEditorStackService=t}predicate(e,t){return t.status===400}responseError(e,t){if(t.error&&t.error.errors){t.error.errors.filter((e=>{const t=e.type==="ValidationError";return!t||t&&!this.genericEditorStackService.isAnyGenericEditorOpened()})).forEach((e=>{this.alertService.showDanger({message:e.message||"se.unknown.request.error",duration:1e4})}))}return Promise.reject(t)}};t.NonValidationErrorInterceptor.$inject=["alertService","genericEditorStackService"];t.NonValidationErrorInterceptor=__decorate([d.Injectable(),__metadata("design:paramtypes",[s.IAlertService,t.GenericEditorStackService])],t.NonValidationErrorInterceptor);t.PreviewErrorInterceptor=class PreviewErrorInterceptor{constructor(e,t,o){this.injector=e;this.logService=t;this.sharedDataService=o}predicate(e,t){return t.status===400&&e.url.indexOf(Le)>-1&&!s.stringUtils.isBlank(e.body.pageId)&&this._hasUnknownIdentifierError(t.error.errors)}responseError(e,t){this.logService.info("The error 400 above on preview is expected in some scenarios, typically when switching catalogs from experience selector.");this.logService.info("Removing the pageId ["+e.body.pageId+"] and creating a preview for homepage");delete e.body.pageId;this.sharedDataService.update(Jt,(function(e){delete e.pageId;return e}));this.injector.get("iframeManagerService").setCurrentLocation(null);return this.injector.get(g.HttpClient).request(e).toPromise()}_hasUnknownIdentifierError(e){const t=e.filter((function(e){return e.type==="UnknownIdentifierError"}));return!!t.length}};t.PreviewErrorInterceptor.$inject=["injector","logService","sharedDataService"];t.PreviewErrorInterceptor=__decorate([d.Injectable(),__metadata("design:paramtypes",[d.Injector,s.LogService,s.ISharedDataService])],t.PreviewErrorInterceptor);t.ResourceNotFoundErrorInterceptor=class ResourceNotFoundErrorInterceptor{constructor(e,t){this.alertService=e;this.httpUtils=t}predicate(e,t){return t.status===404&&!this.httpUtils.isHTMLRequest(e,t)&&!this._isLanguageResourceRequest(e.url)}responseError(e,t){this.alertService.showDanger({message:t.statusText===s.StatusText.UNKNOW_ERROR?"se.unknown.request.error":t.message,duration:1e4});return Promise.reject(t)}_isLanguageResourceRequest(e){const t=new RegExp(ft.replace(/\:.*\//g,".*/"));return t.test(e)}};t.ResourceNotFoundErrorInterceptor.$inject=["alertService","httpUtils"];t.ResourceNotFoundErrorInterceptor=__decorate([d.Injectable(),__metadata("design:paramtypes",[s.IAlertService,s.HttpUtils])],t.ResourceNotFoundErrorInterceptor);function operationContextInteractivePredicate(e,t){return t===De.INTERACTIVE}function operationContextNonInteractivePredicate(e,t){return r.includes([De.BACKGROUND_TASKS,De.NON_INTERACTIVE,De.BATCH_OPERATIONS],t)}function operationContextCMSPredicate(e,t){return t===De.CMS}function operationContextToolingPredicate(e,t){return t===De.TOOLING}t.InterceptorHelper=class InterceptorHelper{constructor(e){this.logService=e}handleRequest(e,t){return this._handle(e,e,t,false)}handleResponse(e,t){return this._handle(e,e.config,t,false)}handleResponseError(e,t){return this._handle(e,e.config,t,true)}_isEligibleForInterceptors(e){return e&&e.url&&!/.+\.html$/.test(e.url)}_handle(e,t,o,n){try{if(this._isEligibleForInterceptors(t)){return o()}else{if(n){return Promise.reject(e)}else{return e}}}catch(t){this.logService.error("caught error in one of the interceptors",t);if(n){return Promise.reject(e)}else{return e}}}};t.InterceptorHelper.$inject=["logService"];t.InterceptorHelper=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.LogService])],t.InterceptorHelper);var Xi;t.TestModeService=Xi=class TestModeService{constructor(e){this.upgrade=e;this.TEST_KEY="e2eMode"}isE2EMode(){return this.isE2EModeLegacy()||this.isE2EModeNg()}isE2EModeNg(){try{return this.upgrade.injector.get(Xi.TEST_TOKEN)}catch(e){return false}}isE2EModeLegacy(){return this.upgrade.$injector&&this.upgrade.$injector.has(this.TEST_KEY)&&this.upgrade.$injector.get(this.TEST_KEY)}};t.TestModeService.TEST_TOKEN=new d.InjectionToken("TEST_KEY_TOKEN");t.TestModeService=Xi=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[n.UpgradeModule])],t.TestModeService);t.PolyfillService=class PolyfillService{constructor(e,t){this.browserService=e;this.testModeService=t}isEligibleForEconomyMode(){return this.browserService.isIE()||this.testModeService.isE2EMode()}isEligibleForExtendedView(){return this.browserService.isIE()||this.browserService.isFF()||this.testModeService.isE2EMode()}isEligibleForThrottledScrolling(){return this.browserService.isIE()}};t.PolyfillService.$inject=["browserService","testModeService"];t.PolyfillService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.BrowserService,t.TestModeService])],t.PolyfillService);t.PriorityService=class PriorityService{constructor(e){this.stringUtils=e}sort(e,t=true){return e.sort(((e,t)=>{let o=e.priority-t.priority;if(o===0){o=this.stringUtils.encode(e).localeCompare(this.stringUtils.encode(t))}return o}))}};t.PriorityService.$inject=["stringUtils"];t.PriorityService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.StringUtils])],t.PriorityService);t.SmarteditBootstrapGateway=class SmarteditBootstrapGateway{constructor(e){this.instance=this.instance||e.createGateway("smartEditBootstrap")}getInstance(){return this.instance}subscribe(e,t){return this.getInstance().subscribe(e,t)}publish(e,t,o=0,n){return this.getInstance().publish(e,t,o,n)}processEvent(e){return this.getInstance().processEvent(e)}};t.SmarteditBootstrapGateway.$inject=["gatewayFactory"];t.SmarteditBootstrapGateway=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[t.GatewayFactory])],t.SmarteditBootstrapGateway);class CustomHandlingStrategy{static isNgRoute(e){return e.startsWith(`/${ue}`)}shouldProcessUrl(e){return CustomHandlingStrategy.isNgRoute(e.toString())}extract(e){return e}merge(e,t){return e}}(function(e){e["NG"]="ng";e["AJS"]="ajs"})(t.NavigationEventSource||(t.NavigationEventSource={}));t.SmarteditRoutingService=class SmarteditRoutingService{constructor(e,t,o,n){this.router=e;this.document=t;this.logService=o;this.upgrade=n;this.listenersInitialized=false;this.routeChangeError$=new v.ReplaySubject;this.routeChangeStart$=new v.ReplaySubject;this.routeChangeSuccess$=new v.ReplaySubject;this.previousRouterUrl=""}init(){if(!this.listenersInitialized){this.notifyOnAngularRouteEvents();this.notifyOnAngularJSRouteEvents();this.listenersInitialized=true}}go(e){return this.router.navigateByUrl(e)}path(){return this.router.url}absUrl(){return this.document.location.href}routeChangeStart(){this.warnAboutListenersNotInitialized();return this.routeChangeStart$.pipe(b.filter((e=>!!e.url&&e.url!==this.previousRouterUrl)),b.map((e=>e.routeData)))}routeChangeSuccess(){this.warnAboutListenersNotInitialized();return this.routeChangeSuccess$.pipe(b.filter((e=>!!e.url&&e.url!==this.previousRouterUrl)),b.map((e=>e.routeData)))}routeChangeError(){this.warnAboutListenersNotInitialized();return this.routeChangeError$.pipe(b.map((e=>e.routeData)))}reload(e=this.router.url){return this.router.navigateByUrl("/",{skipLocationChange:true}).then((()=>this.router.navigateByUrl(e)))}getCurrentUrlFromEvent(e){if(e instanceof C.NavigationStart||e instanceof C.NavigationEnd||e instanceof C.NavigationError){return e.url}return e&&e.current&&e.current.originalPath}warnAboutListenersNotInitialized(){if(!this.listenersInitialized){this.logService.warn("Listeners not initialized, run `init()` first.")}}notifyOnAngularRouteEvents(){this.router.events.subscribe((e=>{if(e&&e.url&&!CustomHandlingStrategy.isNgRoute(e.url)){return}switch(true){case e instanceof C.NavigationStart:{this.routeChangeStart$.next({from:t.NavigationEventSource.NG,url:e.url,routeData:e});break}case e instanceof C.NavigationError:{this.routeChangeError$.next({from:t.NavigationEventSource.NG,url:e.url,routeData:e});break}case e instanceof C.NavigationEnd:{this.routeChangeSuccess$.next({from:t.NavigationEventSource.NG,url:e.url,routeData:e});this.previousRouterUrl=e&&e.url;break}}}))}notifyOnAngularJSRouteEvents(){const e="$rootScope";this.upgrade.$injector.get(e).$on("$routeChangeSuccess",((e,o,n)=>{this.routeChangeSuccess$.next({from:t.NavigationEventSource.AJS,url:o&&o.originalPath,routeData:{event:e,current:o,previous:n}});this.previousRouterUrl=o&&o.originalPath}));this.upgrade.$injector.get(e).$on("$routeChangeError",((e,o,n,s)=>{this.routeChangeError$.next({from:t.NavigationEventSource.AJS,url:o&&o.originalPath,routeData:{event:e,current:o,previous:n,rejection:s}})}));this.upgrade.$injector.get(e).$on("$routeChangeStart",((e,o,n)=>{this.routeChangeStart$.next({from:t.NavigationEventSource.AJS,url:o&&o.originalPath,routeData:{event:e,next:o,current:n}})}))}};t.SmarteditRoutingService.$inject=["router","document","logService","upgrade"];t.SmarteditRoutingService=__decorate([SeDowngradeService(),__param(0,d.Optional()),__param(1,d.Inject(f.DOCUMENT)),__metadata("design:paramtypes",[C.Router,Document,s.LogService,n.UpgradeModule])],t.SmarteditRoutingService);t.AuthenticationManager=class AuthenticationManager extends s.IAuthenticationManagerService{constructor(e){super();this.routing=e}onLogout(){const e=this.routing.path();if(s.stringUtils.isBlank(e)||e===`/${ue}`){this.routing.reload()}else{this.routing.go(ue)}}onUserHasChanged(){this.routing.reload()}};t.AuthenticationManager.$inject=["routing"];t.AuthenticationManager=__decorate([d.Injectable(),__metadata("design:paramtypes",[t.SmarteditRoutingService])],t.AuthenticationManager);t.SettingsService=class SettingsService{constructor(e){this.restService=e.get(Be)}load(){return this.restService.get()}get(e){return this.load().then((t=>t[e]))}getBoolean(e){return this.load().then((t=>t[e]===true||t[e]==="true"))}getStringList(e){return this.load().then((t=>t[e]))}};t.SettingsService.$inject=["restServicefactory"];__decorate([s.Cached({actions:[Ri]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.SettingsService.prototype,"load",null);t.SettingsService=__decorate([SeDowngradeService(s.ISettingsService),d.Injectable(),__metadata("design:paramtypes",[s.RestServiceFactory])],t.SettingsService);class SeRouteService{static init(e){this.$routeProvider=e}static provideNgRoute(e,t){this.validateNgRoutes(e);this.provideRouteShortcutConfigs(e);return C.RouterModule.forRoot(e,t)}static provideLegacyRoute(e){if(!this.$routeProvider){throw new Error("Please call SeRouteService.init($routeProvider) first")}const t={path:e.path,priority:e.priority,titleI18nKey:e.titleI18nKey,shortcutComponent:e.shortcutComponent};this.provideRouteShortcutConfigs([t]);return this.$routeProvider.when(e.path,e.route)}static get routeShortcutConfigs(){return this.routeShortcuts}static provideRouteShortcutConfigs(e){const t=[];this.generateRouteShortcutConfig(t,e);t.filter((e=>this.canRegisterRouteShortcutConfig(e))).forEach((e=>{this.routeShortcuts.push(e)}))}static generateRouteShortcutConfig(e,t,o=""){t.forEach((t=>{if(t.path){const n=this.getFullPath(o,t);e.push({fullPath:n,titleI18nKey:t.titleI18nKey,priority:t.priority,shortcutComponent:t.shortcutComponent})}if(t.children){const n=this.getFullPath(o,t);const s=t.path?n:o;this.generateRouteShortcutConfig(e,t.children,s)}}))}static getFullPath(e,t){return e?e+"/"+t.path:t.path}static validateNgRoutes(e){e.forEach((e=>{if(e.path&&!e.path.startsWith(ue)&&!e.path.startsWith(he)){throw new Error("Angular route must start with "+ue)}}))}static canRegisterRouteShortcutConfig(e){if(!e.fullPath){return false}let t=e.fullPath;this.CATALOG_AWARE_PATH_PLACEHOLDERS.forEach((e=>{t=t.replace(e,"")}));if(t.indexOf(":")>-1){return false}return true}}SeRouteService.CATALOG_AWARE_PATH_PLACEHOLDERS=[":siteId",":catalogId",":catalogVersion"];SeRouteService.routeShortcuts=[];t.SeRouteModule=class SeRouteModule{};t.SeRouteModule=__decorate([SeModule({providers:[SeRouteService]})],t.SeRouteModule);const Qi="yjQuery";function yjQueryServiceFactory(){const t="smarteditJQuery";if(!window[t]){if(e&&e.noConflict){window[t]=e.noConflict(true)}else{window[t]=e}}return window[t]}t.YjqueryModule=class YjqueryModule{};t.YjqueryModule=__decorate([d.NgModule({providers:[{provide:Qi,useFactory:yjQueryServiceFactory},se.initialize((e=>{e.fn.extend({getCssPath(){let e;let t=this;while(t.length){const o=t[0];const n=o.className;if(o.tagName==="BODY"){break}t=t.parent();e=n+(e?">"+e:"")}return e}});Y.downgradeService(Qi,null,Qi)}),[Qi])]})],t.YjqueryModule);const Ji={root:null,threshold:0};const eo={attributes:true,attributeOldValue:false,childList:true,characterData:false,subtree:true};t.InViewElementObserver=class InViewElementObserver{constructor(e,t,o){this.logService=e;this.document=t;this.yjQuery=o;this.componentsQueue=[];this.selectors=[];this.hasClassBasedSelectors=false}elementFromPoint(e){const t=this.document.elementFromPoint(e.x,e.y);return t||this.getInViewElements().find((t=>J.isPointOverElement(e,t)))}addSelector(e,t){if(!ae.isBlank(e)&&this.selectors.map((e=>e.selector)).indexOf(e)===-1){if(/\.[\w]+/.test(e)){this.hasClassBasedSelectors=true}this.selectors.push({selector:e,callback:t});this.restart()}return()=>{const t=this.selectors.map((e=>e.selector)).indexOf(e);this.selectors.splice(t,1);this.restart()}}getAllElements(){return this.componentsQueue.map((e=>e.component))}getInViewElements(){return this.componentsQueue.filter((e=>e.isIntersecting)).map((e=>e.component))}restart(){this.stopListener();this.initListener()}stopListener(){if(this.mutationObserver){this.mutationObserver.disconnect();delete this.mutationObserver}if(this.intersectionObserver){this.intersectionObserver.disconnect();delete this.intersectionObserver}this.componentsQueue=[]}initListener(){if(!this.mutationObserver){this.mutationObserver=this._newMutationObserver(this._mutationObserverCallback.bind(this));if(!this.intersectionObserver){this.intersectionObserver=this._newIntersectionObserver((e=>{const t=e.filter((e=>this._isEligibleComponent(e.target)));t.forEach((e=>{this._updateQueue(e)}));this.selectors.filter((e=>!!e.callback)).forEach((e=>{if(t.find((t=>this.yjQuery(t.target).is(e.selector)))){e.callback()}}))}))}this._getEligibleElements().forEach((e=>{this.intersectionObserver.observe(e)}))}}_aggregateAddedOrRemovedNodes(e,t){const o=r.flatten(e.filter((e=>e.type===Oe.CHILD_LIST.NAME&&(!!t&&e.addedNodes&&e.addedNodes.length||!t&&e.removedNodes&&e.removedNodes.length))).map((e=>{const o=r.flatten(Array.prototype.slice.call(t?e.addedNodes:e.removedNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE)).map((e=>{const t=this._getAllEligibleChildren(e);return this._isEligibleComponent(e)?[e].concat(t):t}))).sort(J.compareHTMLElementsPosition()).reverse();return o})));return r.uniqWith(o,((e,t)=>e.contains(t)||t.contains(e)))}_aggregateMutationsOnClass(e,t){return r.compact(e.filter((e=>e.target&&e.target.nodeType===Node.ELEMENT_NODE&&e.type===Oe.ATTRIBUTES.NAME&&e.attributeName==="class")).map((e=>{if(t&&this._isEligibleComponent(e.target)){return e.target}else if(!t&&this._isEligibleComponent(e.target)){return e.target}return null})))}_mutationObserverCallback(e){this.logService.debug(e);this._aggregateAddedOrRemovedNodes(e,true).forEach((e=>{this.intersectionObserver.observe(e)}));if(this.hasClassBasedSelectors){this._aggregateMutationsOnClass(e,true).forEach((e=>{this.intersectionObserver.observe(e)}))}this._aggregateAddedOrRemovedNodes(e,false).forEach((e=>{const t=this._getComponentIndexInQueue(e);if(t!==-1){this.componentsQueue.splice(t,1)}}));if(this.hasClassBasedSelectors){this._aggregateMutationsOnClass(e,false).forEach((e=>{const t=this._getComponentIndexInQueue(e);if(t!==-1){this.componentsQueue.splice(t,1)}}))}}_updateQueue(e){const t=this._getComponentIndexInQueue(e.target);if(t!==-1){if(!e.intersectionRatio&&!this._isInDOM(e.target)){this.componentsQueue.splice(t,1)}else{this.componentsQueue[t].isIntersecting=!!e.intersectionRatio}}else if(this._isInDOM(e.target)){this.componentsQueue.push({component:e.target,isIntersecting:!!e.intersectionRatio})}}_newMutationObserver(e){const t=new MutationObserver(e);t.observe(this.document.body,r.merge(r.cloneDeep(eo),{attributes:this.hasClassBasedSelectors}));return t}_newIntersectionObserver(e){return new IntersectionObserver(e,Ji)}_getJQuerySelector(){return this.selectors.map((e=>e.selector)).join(",")}_isEligibleComponent(e){return this.yjQuery(e).is(this._getJQuerySelector())}_getEligibleElements(){return Array.prototype.slice.call(this.yjQuery(this._getJQuerySelector()))}_getAllEligibleChildren(e){return Array.prototype.slice.call(e.querySelectorAll(this._getJQuerySelector()))}_getComponentIndexInQueue(e){return this.componentsQueue.findIndex((function(t){return e===t.component}))}_isInDOM(e){return this.yjQuery.contains(this.document.body,e)}};t.InViewElementObserver.$inject=["logService","document","yjQuery"];t.InViewElementObserver=__decorate([SeDowngradeService(),__param(1,d.Inject(f.DOCUMENT)),__param(2,d.Inject(Qi)),__metadata("design:paramtypes",[s.LogService,Document,Function])],t.InViewElementObserver);var to;t.DragAndDropScrollingService=to=class DragAndDropScrollingService{constructor(e,t,o,n){this.windowUtils=e;this.translate=t;this.inViewElementObserver=o;this.yjQuery=n;this.SCROLLING_AREA_HEIGHT=50;this.FAST_SCROLLING_AREA_HEIGHT=25;this.SCROLLING_STEP=5;this.FAST_SCROLLING_STEP=15;this.topScrollArea=null;this.bottomScrollArea=null;this.throttleScrollingEnabled=false;this.inViewElementObserver.addSelector("#"+to.TOP_SCROLL_AREA_ID);this.inViewElementObserver.addSelector("#"+to.BOTTOM_SCROLL_AREA_ID);this.throttledScrollPage=r.throttle(this.scrollPage.bind(this),Ut)}initialize(){this.scrollable=this.getSelector(this.windowUtils.getWindow().document.scrollingElement);this.addScrollAreas();this.addEventListeners();this.scrollDelta=0;this.initialized=true}deactivate(){this.removeEventListeners();this.scrollDelta=0;this.initialized=false}enable(){if(this.initialized){this.scrollLimitY=this.scrollable.get(0).scrollHeight-this.windowUtils.getWindow().innerHeight;this.showScrollAreas()}}disable(){if(this.initialized){const e=this.getScrollAreas();e.trigger("dragleave");e.hide()}}toggleThrottling(e){this.throttleScrollingEnabled=e}addScrollAreas(){this.topScrollArea=this.getSelector('<div id="'+to.TOP_SCROLL_AREA_ID+'" class="'+$t+'"></div>').appendTo("body");this.bottomScrollArea=this.getSelector('<div id="'+to.BOTTOM_SCROLL_AREA_ID+'" class="'+$t+'"></div>').appendTo("body");const e=this.getScrollAreas();e.height(this.SCROLLING_AREA_HEIGHT);this.topScrollArea.css({top:0});this.bottomScrollArea.css({bottom:0});e.hide();let t;let o;return this.translate.get("se.draganddrop.uihint.top").toPromise().then((e=>{t=e;return this.translate.get("se.draganddrop.uihint.bottom").toPromise()})).then((e=>{o=e;this.topScrollArea.text(t);this.bottomScrollArea.text(o)}))}addEventListeners(){const e=this.getScrollAreas();e.on("dragenter",this.onDragEnter.bind(this));e.on("dragover",this.onDragOver.bind(this));e.on("dragleave",this.onDragLeave.bind(this))}removeEventListeners(){const e=this.getScrollAreas();e.off("dragenter");e.off("dragover");e.off("dragleave");e.remove()}onDragEnter(e){let t=this.SCROLLING_STEP;const o=this.getSelector(e.target);const n=o.attr("id");if(n===to.TOP_SCROLL_AREA_ID){t*=-1}this.scrollDelta=t;this.animationFrameId=this.windowUtils.getWindow().requestAnimationFrame(this.scrollPage.bind(this))}onDragOver(e){const t=e.originalEvent;const o=this.getSelector(t.target);const n=o.attr("id");if(n===to.TOP_SCROLL_AREA_ID){if(t.clientY<=this.FAST_SCROLLING_AREA_HEIGHT){this.scrollDelta=-this.FAST_SCROLLING_STEP}else{this.scrollDelta=-this.SCROLLING_STEP}}else{const e=this.windowUtils.getWindow().innerHeight;if(t.clientY>=e-this.FAST_SCROLLING_AREA_HEIGHT){this.scrollDelta=this.FAST_SCROLLING_STEP}else{this.scrollDelta=this.SCROLLING_STEP}}}onDragLeave(){this.scrollDelta=0;this.windowUtils.getWindow().cancelAnimationFrame(this.animationFrameId)}scrollPage(){if(this.scrollDelta){const e=this.scrollable.scrollTop();let t=false;if(this.scrollDelta>0&&e<this.scrollLimitY){t=true}else if(this.scrollDelta<0&&e>0){t=true}if(t){const e=this.scrollable.scrollTop();const t=e+this.scrollDelta;this.scrollable.scrollTop(t);this.animationFrameId=this.windowUtils.getWindow().requestAnimationFrame(this.throttleScrollingEnabled?this.throttledScrollPage:this.scrollPage.bind(this))}this.showScrollAreas()}}getSelector(e){return this.yjQuery(e)}getScrollAreas(){return this.yjQuery(["#"+to.TOP_SCROLL_AREA_ID,"#"+to.BOTTOM_SCROLL_AREA_ID].join(","))}showScrollAreas(){const e=this.scrollable.scrollTop();if(e===0){this.topScrollArea.hide()}else{this.topScrollArea.show()}if(e>=this.scrollLimitY){this.bottomScrollArea.hide()}else{this.bottomScrollArea.show()}}};t.DragAndDropScrollingService.TOP_SCROLL_AREA_ID="top_scroll_page";t.DragAndDropScrollingService.BOTTOM_SCROLL_AREA_ID="bottom_scroll_page";t.DragAndDropScrollingService=to=__decorate([SeDowngradeService(),__param(3,d.Inject(Qi)),__metadata("design:paramtypes",[s.WindowUtils,S.TranslateService,t.InViewElementObserver,Function])],t.DragAndDropScrollingService);var io;t.DragAndDropService=io=class DragAndDropService{constructor(e,t,o,n,s){this.yjQuery=e;this.dragAndDropScrollingService=t;this.inViewElementObserver=o;this.systemEventService=n;this.dragAndDropCrossOrigin=s;this.configurations={};this.isDragAndDropExecuting=false;this.dragAndDropCrossOrigin.initialize()}register(e){if(!e||!e.id){throw new Error("dragAndDropService - register(): Configuration needs an ID.")}this.configurations[e.id]=e;if(!s.stringUtils.isBlank(e.targetSelector)){this.inViewElementObserver.addSelector(e.targetSelector)}}unregister(e){e.forEach((e=>{const t=this.configurations[e];if(t){this.deactivateConfiguration(t);this.deactivateScrolling(t);delete this.configurations[e]}}))}applyAll(){r.forEach(this.configurations,(e=>{this.apply(e.id)}))}apply(e){const t=this.configurations[e];if(t){this.update(t.id);this.cacheDragImages(t);this.initializeScrolling(t)}}update(e){const t=this.configurations[e];if(t){this.deactivateConfiguration(t);this._update(t)}}markDragStarted(){this.setDragAndDropExecutionStatus(true);this.dragAndDropScrollingService.enable()}markDragStopped(){this.setDragAndDropExecutionStatus(false);this.dragAndDropScrollingService.disable()}_update(e){const t=r.isArray(e.sourceSelector)?e.sourceSelector:[e.sourceSelector];t.forEach((t=>{const o=this.getSelector(t+":not([draggable])");o.attr(io.DRAGGABLE_ATTR,"true");o.on("dragstart",this.onDragStart.bind(this,e));o.on("dragend",this.onDragEnd.bind(this,e))}));const o=this.getSelector(e.targetSelector+":not([draggable])");o.attr(io.DROPPABLE_ATTR,"true");o.on("dragenter",this.onDragEnter.bind(this,e));o.on("dragover",this.onDragOver.bind(this,e));o.on("drop",this.onDrop.bind(this,e));o.on("dragleave",this.onDragLeave.bind(this,e))}deactivateConfiguration(e){const t=Array.isArray(e.sourceSelector)?e.sourceSelector.join(","):e.sourceSelector;const o=this.getSelector(t);const n=this.getSelector(e.targetSelector);o.removeAttr(io.DRAGGABLE_ATTR);n.removeAttr(io.DROPPABLE_ATTR);o.off("dragstart");o.off("dragend");n.off("dragenter");n.off("dragover");n.off("dragleave");n.off("drop")}onDragStart(e,t){const o=t.originalEvent;this.setDragTransferData(e,o);setTimeout((()=>{const n=this.yjQuery(t.target).closest("."+ht);this.setDragAndDropExecutionStatus(true,n);this.dragAndDropScrollingService.enable();if(e.startCallback){e.startCallback(o)}}),0)}onDragEnd(e,t){const o=t.originalEvent;this.dragAndDropScrollingService.disable();if(this.isDragAndDropExecuting&&e.stopCallback){e.stopCallback(o)}this.setDragAndDropExecutionStatus(false)}onDragEnter(e,t){const o=t.originalEvent;o.preventDefault();if(this.isDragAndDropExecuting&&e.dragEnterCallback){e.dragEnterCallback(o)}}onDragOver(e,t){const o=t.originalEvent;o.preventDefault();if(this.isDragAndDropExecuting&&e.dragOverCallback){e.dragOverCallback(o)}}onDrop(e,t){const o=t.originalEvent;o.preventDefault();o.stopPropagation();if(o.relatedTarget&&o.relatedTarget.nodeType===3){return true}if(o.target===o.relatedTarget){return true}if(this.isDragAndDropExecuting&&e.dropCallback){e.dropCallback(o)}return false}onDragLeave(e,t){const o=t.originalEvent;o.preventDefault();if(this.isDragAndDropExecuting&&e.outCallback){e.outCallback(o)}}cacheDragImages(e){let t;if(e.helper){t=e.helper()}if(!t){return}if(typeof t==="string"){e._cachedDragImage=new Image;e._cachedDragImage.src=t}else{e._cachedDragImage=t}}setDragTransferData(e,t){t.dataTransfer.setData("Text",e.id);if(e._cachedDragImage&&t.dataTransfer.setDragImage){t.dataTransfer.setDragImage(e._cachedDragImage,0,0)}}getSelector(e){return this.yjQuery(e)}setDragAndDropExecutionStatus(e,t){this.isDragAndDropExecuting=e;this.systemEventService.publish(e?Ft.DRAG_DROP_START:Ft.DRAG_DROP_END,t)}initializeScrolling(e){if(e.enableScrolling&&this.browserRequiresCustomScrolling()){this.dragAndDropScrollingService.initialize()}}deactivateScrolling(e){if(e.enableScrolling&&this.browserRequiresCustomScrolling()){this.dragAndDropScrollingService.deactivate()}}browserRequiresCustomScrolling(){return true}};t.DragAndDropService.DRAGGABLE_ATTR="draggable";t.DragAndDropService.DROPPABLE_ATTR="data-droppable";t.DragAndDropService=io=__decorate([SeDowngradeService(),__param(0,d.Inject(Qi)),__metadata("design:paramtypes",[Function,t.DragAndDropScrollingService,t.InViewElementObserver,t.SystemEventService,IDragAndDropCrossOrigin])],t.DragAndDropService);t.DragAndDropServiceModule=class DragAndDropServiceModule{};t.DragAndDropServiceModule=__decorate([d.NgModule({providers:[t.InViewElementObserver,t.DragAndDropScrollingService,t.DragAndDropService]})],t.DragAndDropServiceModule);const oo={DROP:"drop",DRAG_ENTER:"dragenter",DRAG_OVER:"dragover",DRAG_LEAVE:"dragleave"};class StorageNamespaceConverter{static ERR_INVALID_NAMESPACED_ID(e){return new Error(`StorageNamespaceConverter - Invalid namespaced id [${e}]`)}static getNamespacedStorageId(e,t){return`${e}${this.separator}${t}`}static getStorageIdFromNamespacedId(e){const t=e.match(new RegExp(this.namespaceDecoderRegexStr));if(t&&t[2].length>0){return t[2]}throw StorageNamespaceConverter.ERR_INVALID_NAMESPACED_ID(e)}static getNamespaceFromNamespacedId(e){const t=e.match(new RegExp(this.namespaceDecoderRegexStr));if(t&&t[1].length>0){return t[1]}throw StorageNamespaceConverter.ERR_INVALID_NAMESPACED_ID(e)}}StorageNamespaceConverter.separator="<ns:id>";StorageNamespaceConverter.namespaceDecoderRegexStr="(.*)"+StorageNamespaceConverter.separator+"(.*)";class NamespacedStorageManager{constructor(e,t){this.storageManager=e;this.namespace=t}getStorage(e){e.storageId=this.getNamespaceStorageId(e.storageId);return this.storageManager.getStorage(e)}deleteStorage(e,t=false){return this.storageManager.deleteStorage(this.getNamespaceStorageId(e),t)}deleteExpiredStorages(e=false){return this.storageManager.deleteExpiredStorages(e)}hasStorage(e){return this.storageManager.hasStorage(this.getNamespaceStorageId(e))}registerStorageController(e){return this.storageManager.registerStorageController(e)}getNamespaceStorageId(e){return StorageNamespaceConverter.getNamespacedStorageId(this.namespace,e)}getStorageManager(){return this.storageManager}}class StorageManagerFactory{constructor(e){this.theOneAndOnlyStorageManager=e}static ERR_INVALID_NAMESPACE(e){return new Error(`StorageManagerFactory Error: invalid namespace [${e}]. Namespace must be a non-empty string`)}getStorageManager(e){this.validateNamespace(e);return new NamespacedStorageManager(this.theOneAndOnlyStorageManager,e)}validateNamespace(e){if(typeof e!=="string"||e.length<=0){throw StorageManagerFactory.ERR_INVALID_NAMESPACE(e)}}}class IStorageGateway{handleStorageRequest(e,t,o){"proxyFunction";return Promise.resolve()}}class IStorageManager{registerStorageController(e){"proxyFunction"}hasStorage(e){"proxyFunction";return null}getStorage(e){"proxyFunction";return null}deleteStorage(e,t){"proxyFunction";return Promise.resolve(true)}deleteExpiredStorages(e){"proxyFunction";return Promise.resolve(true)}}class IStorageManagerFactory{getStorageManager(e){"proxyFunction";return null}}class IStorageManagerGateway extends IStorageManager{getStorageSanitityCheck(e){"proxyFunction";return Promise.resolve(true)}}class IStoragePropertiesService{getProperty(e){"proxyFunction";return null}}const no=new d.InjectionToken("storageProperties");const so=new d.InjectionToken("doNotUseStorageManager");class Timer{constructor(e,t,o=1e3){this.zone=e;this._callback=t;this._duration=o;this._timer=null}isActive(){return!!this._timer}restart(e){this._duration=e||this._duration;this.stop();this.start()}start(e){this._duration=e||this._duration;this.zone.runOutsideAngular((()=>{this._timer=setInterval((()=>{try{if(this._callback){this._callback()}else{this.stop()}}catch(e){this.stop()}}),this._duration)}))}stop(){clearInterval(this._timer);this._timer=null}resetDuration(e){this._duration=e||this._duration}teardown(){this.stop();this._callback=null;this._duration=null;this._timer=null}}t.TimerService=class TimerService{constructor(e){this.ngZone=e}createTimer(e,t){return new Timer(this.ngZone,e,t)}};t.TimerService.$inject=["ngZone"];t.TimerService=__decorate([SeDowngradeService(),d.Injectable(),__metadata("design:paramtypes",[d.NgZone])],t.TimerService);t.JQueryUtilsService=class JQueryUtilsService{constructor(e,t,o,n){this.yjQuery=e;this.document=t;this.EXTENDED_VIEW_PORT_MARGIN=o;this.windowUtils=n}extractFromElement(e,t){const o=this.yjQuery(e);return o.filter(t).add(o.find(t))}unsafeParseHTML(e){return this.yjQuery.parseHTML(e,null,true)}isInDOM(e){return this.document.documentElement.contains(e)}isInExtendedViewPort(e){if(!this.document.documentElement.contains(e)){return false}const t=this.yjQuery(e);const o=Object.assign(Object.assign({},t.offset()),{width:t.outerWidth(),height:t.outerHeight()});const n=this.document.scrollingElement||this.document.documentElement;return J.areIntersecting({left:-this.EXTENDED_VIEW_PORT_MARGIN+n.scrollLeft,width:this.windowUtils.getWindow().innerWidth+2*this.EXTENDED_VIEW_PORT_MARGIN,top:-this.EXTENDED_VIEW_PORT_MARGIN+n.scrollTop,height:this.windowUtils.getWindow().innerHeight+2*this.EXTENDED_VIEW_PORT_MARGIN},o)}};t.JQueryUtilsService.$inject=["yjQuery","document","EXTENDED_VIEW_PORT_MARGIN","windowUtils"];t.JQueryUtilsService=__decorate([SeDowngradeService(),__param(0,d.Inject(Qi)),__param(1,d.Inject(f.DOCUMENT)),__param(2,d.Inject(fi)),__metadata("design:paramtypes",[Function,Document,Number,t.WindowUtils])],t.JQueryUtilsService);const ao=new d.InjectionToken("CATALOG_DETAILS_ITEM_DATA");t.AngularJSBootstrapIndicatorService=class AngularJSBootstrapIndicatorService{constructor(){this._smarteditContainerReady=new v.BehaviorSubject(false);this._smarteditReady=new v.BehaviorSubject(false)}setSmarteditContainerReady(){this._smarteditContainerReady.next(true)}setSmarteditReady(){this._smarteditReady.next(true)}onSmarteditContainerReady(){return this._smarteditContainerReady.pipe(b.filter((e=>e)))}onSmarteditReady(){return this._smarteditReady.pipe(b.filter((e=>e)))}};t.AngularJSBootstrapIndicatorService=__decorate([d.Injectable()],t.AngularJSBootstrapIndicatorService);t.AngularJSLazyDependenciesService=class AngularJSLazyDependenciesService{constructor(e){this.upgrade=e}$injector(){return this.upgrade.$injector}$templateCache(){var e;return(e=this.$injector())===null||e===void 0?void 0:e.get("$templateCache")}$rootScope(){return this.$injector().get("$rootScope")}$location(){return this.$injector().get("$location")}};t.AngularJSLazyDependenciesService.$inject=["upgrade"];t.AngularJSLazyDependenciesService=__decorate([d.Injectable(),__metadata("design:paramtypes",[n.UpgradeModule])],t.AngularJSLazyDependenciesService);window.__smartedit__.addDecoratorPayload("Injectable","L10nService",{providedIn:"root"});t.L10nService=class L10nService{constructor(e,t){this.languageService=e;this.languageSwitchSubject=new v.BehaviorSubject(null);this.languageSwitch$=this.languageSwitchSubject.asObservable();this.unRegSwitchLanguageEvent=t.subscribe(s.SWITCH_LANGUAGE_EVENT,(()=>this.resolveLanguage()))}ngOnDestroy(){this.unRegSwitchLanguageEvent();this.languageSwitchSubject.unsubscribe()}resolveLanguage(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.languageService.getResolveLocaleIsoCode();this.languageSwitchSubject.next(e)}))}};t.L10nService.$inject=["languageService","crossFrameEventService"];t.L10nService=__decorate([SeDowngradeService(),d.Injectable({providedIn:"root"}),__metadata("design:paramtypes",[t.LanguageService,t.CrossFrameEventService])],t.L10nService);var ro;t.CMSModesService=ro=class CMSModesService{constructor(e){this.perspectiveService=e}isVersioningPerspectiveActive(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.perspectiveService.getActivePerspectiveKey();return e===ro.VERSIONING_PERSPECTIVE_KEY}))}};t.CMSModesService.BASIC_PERSPECTIVE_KEY="se.cms.perspective.basic";t.CMSModesService.ADVANCED_PERSPECTIVE_KEY="se.cms.perspective.advanced";t.CMSModesService.VERSIONING_PERSPECTIVE_KEY="se.cms.perspective.versioning";t.CMSModesService=ro=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[IPerspectiveService])],t.CMSModesService);var lo;const co=`/cmswebservices/v1/sites/${ye}/cmsitems`;const po=new s.EvictionTag({event:oi});t.CmsitemsRestService=class CmsitemsRestService{constructor(e,t){this.restServiceFactory=e;this.catalogService=t;this.cmsitemsUuidsUri=`/cmswebservices/v1/sites/${ye}/cmsitems/uuids`;this.resource=e.get(co);this.versionedResource=e.get(co+"/:itemUuid");this.uuidsResource=e.get(this.cmsitemsUuidsUri)}getByIdAndVersion(e,t){return this.versionedResource.get({itemUuid:e,versionId:t})}get(e){return this.catalogService.retrieveUriContext().then((t=>{const o={catalogId:e.catalogId||t.CURRENT_CONTEXT_CATALOG,catalogVersion:e.catalogVersion||t.CURRENT_CONTEXT_CATALOG_VERSION};e=r.merge(o,e);return this.restServiceFactory.get(co).get(e)}))}getByIds(e,t){return this.getByIdsNoCache(e,t)}update(e,t){return this.resource.update(e,t)}delete(e){return this.resource.remove({identifier:e})}create(e){return this.catalogService.getCatalogVersionUUid().then((t=>{e.catalogVersion=e.catalogVersion||t;if(e.onlyOneRestrictionMustApply===undefined){e.onlyOneRestrictionMustApply=false}return this.resource.save(e)}))}getByIdsNoCache(e,t){e=Array.from(new Set(e));return this.catalogService.getCatalogVersionUUid().then((o=>{const n={catalogVersion:o,uuids:e,fields:t};return this.uuidsResource.save(n)}))}getById(e){return this.resource.getById(e)}};t.CmsitemsRestService.$inject=["restServiceFactory","catalogService"];__decorate([s.Cached({actions:[Ri],tags:[Mi,po]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String,String]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"getByIdAndVersion",null);__decorate([s.Cached({actions:[Ri],tags:[Mi,po]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"get",null);__decorate([s.Cached({actions:[Ri],tags:[Mi,po]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Array,String]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"getByIds",null);__decorate([s.InvalidateCache(po),__metadata("design:type",Function),__metadata("design:paramtypes",[typeof(lo=typeof T!=="undefined"&&T)==="function"?lo:Object,Object]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"update",null);__decorate([s.InvalidateCache(po),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.CmsitemsRestService.prototype,"delete",null);t.CmsitemsRestService=__decorate([s.OperationContextRegistered(co.replace(/CONTEXT_SITE_ID/,":CONTEXT_SITE_ID"),"CMS"),SeDowngradeService(),__metadata("design:paramtypes",[IRestServiceFactory,ICatalogService])],t.CmsitemsRestService);(function(e){e["PENDING"]="pending";e["IN_PROGRESS"]="in_progress";e["PAUSED"]="paused";e["COMPLETED"]="completed";e["DISABLED"]="disabled";e["ENDED_THROUGH_END_OF_WORKFLOW"]="ended_through_end_of_workflow";e["TERMINATED"]="terminated"})(t.WorkflowActionStatus||(t.WorkflowActionStatus={}));(function(e){e["CANCEL"]="CANCEL_WORKFLOW";e["MAKE_DECISION"]="MAKE_DECISION"})(t.WorkflowOperations||(t.WorkflowOperations={}));(function(e){e["CONTINUED"]="continued";e["RUNNING"]="running";e["PAUSED"]="paused";e["FINISHED"]="finished";e["ABORTED"]="aborted";e["NEW"]="new"})(t.WorkflowStatus||(t.WorkflowStatus={}));const mo="WORKFLOW_CREATED_EVENT";const go="WORKFLOW_FINISHED_EVENT";const uo=new s.EvictionTag({event:mo});const ho=new s.EvictionTag({event:go});const vo=new s.EvictionTag({event:"WORKFLOW_TASKS_MENU_OPENED_EVENT"});const _o={INBOX_POLLING_TIMEOUT:2e4,INBOX_POLLING_PAGESIZE:10,INBOX_POLLING_CURRENTPAGE:0};t.WorkflowTasksPollingService=class WorkflowTasksPollingService{constructor(e,t,o){this.timerService=e;this.restServiceFactory=t;this.crossFrameEventService=o;this.resourceInboxURI="/cmssmarteditwebservices/v1/inbox/workflowtasks";this.subscribers=[];this.syncPollingTimer=null;this.savedHashedTasks=[];this.inboxRESTService=this.restServiceFactory.get(this.resourceInboxURI);this.crossFrameEventService.subscribe(s.EVENTS.AUTHORIZATION_SUCCESS,(()=>this.initPolling()));this.crossFrameEventService.subscribe(s.EVENTS.LOGOUT,(()=>this.stopPolling()));this.crossFrameEventService.subscribe(s.EVENTS.REAUTH_STARTED,(()=>this.stopPolling()));this.initPolling()}stopPolling(){if(this.syncPollingTimer.isActive()){this.syncPollingTimer.stop()}}startPolling(){if(!this.syncPollingTimer.isActive()){this.syncPollingTimer.restart(_o.INBOX_POLLING_TIMEOUT)}}addSubscriber(e,t){this.subscribers.push({subscriber:e,callOnInit:t});return()=>this.unsubscribe(e)}initPolling(){this.syncPollingTimer=this.timerService.createTimer((()=>this.fetchInboxTasks(false)),_o.INBOX_POLLING_TIMEOUT);this.fetchInboxTasks(true);this.startPolling()}unsubscribe(e){const t=this.subscribers.findIndex((t=>t.subscriber===e));if(t>-1){this.subscribers.splice(t,1)}}getNewTasks(e){return e.filter((e=>!this.savedHashedTasks.includes(this.encodeTask(e))))}saveNewHashedTasks(e){e.forEach((e=>this.savedHashedTasks.push(this.encodeTask(e))));const t=this.savedHashedTasks.length-_o.INBOX_POLLING_PAGESIZE;if(t>0){for(let e=0;e<t;e++){this.savedHashedTasks.shift()}}}encodeTask(e){const t=r.cloneDeep(e);if(t.action){delete t.action.startedAgoInMillis}return btoa(JSON.stringify(t))}fetchInboxTasks(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.fetchTaskList();if(!t){this.stopPolling();return}const o=this.getNewTasks(t.tasks);this.saveNewHashedTasks(o);this.subscribers.forEach((n=>{if(!e||e&&!!n.callOnInit){n.subscriber(o,t.pagination)}}))}))}fetchTaskList(){return __awaiter(this,void 0,void 0,(function*(){try{return yield this.inboxRESTService.get({pageSize:_o.INBOX_POLLING_PAGESIZE,currentPage:_o.INBOX_POLLING_CURRENTPAGE})}catch(e){return Promise.reject()}}))}};t.WorkflowTasksPollingService.$inject=["timerService","restServiceFactory","crossFrameEventService"];t.WorkflowTasksPollingService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[t.TimerService,IRestServiceFactory,t.CrossFrameEventService])],t.WorkflowTasksPollingService);(function(e){e["Default"]="Default";e["SwitchPerspective"]="SwitchPerspective"})(t.OpenPageWorkflowMenu||(t.OpenPageWorkflowMenu={}));t.WorkflowService=class WorkflowService{constructor(e,t,o,n,s,a,r,d,p,m,g,u,f){this.restServiceFactory=e;this.crossFrameEventService=t;this.systemEventService=o;this.sharedDataService=n;this.perspectiveService=s;this.catalogService=a;this.experienceService=r;this.workflowTasksPollingService=d;this.pageService=p;this.syncPollingService=m;this.cmsitemsRestService=g;this.translateService=u;this.storageService=f;this.workflowTasksCountSubject=new v.BehaviorSubject(0);this.resourceWorkflowURI=`/cmswebservices/v1/catalogs/${Se}/versions/${Ce}/workflows`;this.resourceWorkflowActionsURI=`/cmswebservices/v1/catalogs/${Se}/versions/${Ce}/workflows/:workflowCode/actions`;this.resourceWorkflowTemplateURI=`/cmswebservices/v1/catalogs/${Se}/versions/${Ce}/workflowtemplates`;this.resourceWorkflowOperationsURI=`/cmswebservices/v1/catalogs/${Se}/versions/${Ce}/workflows/:workflowCode/operations`;this.resourceWorkflowActionCommentsURI=`/cmswebservices/v1/catalogs/${Se}/versions/${Ce}/workflows/:workflowCode/actions/:actionCode/comments`;this.resourceWorkflowEditableItemsURI=`/cmssmarteditwebservices/v1/catalogs/${Se}/versions/${Ce}/workfloweditableitems`;this.resourceWorkflowInboxTasksURI=`/cmssmarteditwebservices/v1/inbox/workflowtasks`;this.workflowRESTService=this.restServiceFactory.get(this.resourceWorkflowURI);this.workflowTemplateRESTService=this.restServiceFactory.get(this.resourceWorkflowTemplateURI);this.workflowActionsRESTService=this.restServiceFactory.get(this.resourceWorkflowActionsURI);this.workflowInboxTasksRESTService=this.restServiceFactory.get(this.resourceWorkflowInboxTasksURI);this.workflowEditableItemsRESTService=this.restServiceFactory.get(this.resourceWorkflowEditableItemsURI);this.crossFrameEventService.subscribe(Ze,(()=>this.openPageWorkflowMenu()));this.crossFrameEventService.subscribe(Ke,(()=>this.openPageWorkflowMenu()));this.workflowTasksPollingService.addSubscriber(((e,t)=>{const o=t.totalCount||0;this.updateWorkflowTasksCount(o)}),true)}getWorkflows(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowRESTService.get(e);return t.workflows}))}getWorkflowTemplates(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowTemplateRESTService.get(e);return t.templates}))}getAllActionsForWorkflowCode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowActionsRESTService.get({workflowCode:e});return t.actions}))}cancelWorflow(e){this.workflowOperationsRESTService=this.restServiceFactory.get(this.resourceWorkflowOperationsURI.replace(":workflowCode",e.workflowCode));return this.workflowOperationsRESTService.save({operation:t.WorkflowOperations.CANCEL})}getWorkflowTemplateByCode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getWorkflowTemplates({});const o=t.find((t=>t.code===e));return o}))}areWorkflowsEnabledOnCurrentCatalogVersion(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getWorkflowTemplates({});return e&&e.length>0}))}getActiveWorkflowForPageUuid(e){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getWorkflows({pageSize:1,currentPage:0,attachment:e,statuses:t.WorkflowStatus.RUNNING+","+t.WorkflowStatus.PAUSED});return o[0]===undefined?null:o[0]}))}isPageInWorkflow(e){return __awaiter(this,void 0,void 0,(function*(){return!!(yield this.getActiveWorkflowForPageUuid(e.uuid))}))}isUserParticipanInActiveAction(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getActiveActionsForWorkflowCode(e);return t.length>0}))}getActiveActionsForWorkflowCode(e){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getAllActionsForWorkflowCode(e);return o.filter((e=>e.isCurrentUserParticipant&&(t.WorkflowActionStatus.IN_PROGRESS===e.status.toLowerCase()||t.WorkflowActionStatus.PAUSED===e.status.toLowerCase())))}))}getCommentsForWorkflowAction(e,t,o){this.workflowActionCommentsRESTService=this.restServiceFactory.get(this.resourceWorkflowActionCommentsURI.replace(":workflowCode",e).replace(":actionCode",t));return this.workflowActionCommentsRESTService.page(o)}getWorkflowInboxTasks(e){return this.workflowInboxTasksRESTService.page(e)}getTotalNumberOfActiveWorkflowTasks(){return this.workflowTasksCountSubject.asObservable()}updateWorkflowTasksCount(e){this.workflowTasksCountSubject.next(e)}getWorkflowEditableItems(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowEditableItemsRESTService.get({itemUids:e});return t.editableItems}))}getResourceWorkflowURI(){return this.resourceWorkflowURI}getResourceWorkflowOperationsURI(){return this.resourceWorkflowOperationsURI}openPageWorkflowMenu(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(ti);if(e===t.OpenPageWorkflowMenu.Default){const e=yield this.perspectiveService.getActivePerspectiveKey();if(e===t.CMSModesService.BASIC_PERSPECTIVE_KEY||e===t.CMSModesService.ADVANCED_PERSPECTIVE_KEY){this.systemEventService.publish(ii,true);this.sharedDataService.remove(ti)}else{yield this.sharedDataService.set(ti,t.OpenPageWorkflowMenu.SwitchPerspective);this.perspectiveService.switchTo(t.CMSModesService.ADVANCED_PERSPECTIVE_KEY)}}else if(e===t.OpenPageWorkflowMenu.SwitchPerspective){this.systemEventService.publish(ii,true);this.sharedDataService.remove(ti)}}))}loadExperienceAndOpenPageWorkflowMenu(e){return __awaiter(this,void 0,void 0,(function*(){if(e){const o=yield this.catalogService.getDefaultSiteForContentCatalog(e.attachments[0].catalogId);const n={siteId:o.uid,catalogId:e.attachments[0].catalogId,catalogVersion:e.attachments[0].catalogVersion,pageId:e.attachments[0].pageUid};if(!!ne.getGatewayTargetFrame()){const e=yield this.experienceService.compareWithCurrentExperience(n);if(e){yield this.sharedDataService.set(ti,t.OpenPageWorkflowMenu.Default);this.openPageWorkflowMenu()}else{this._loadExperience(n)}}else{this._loadExperience(n)}}}))}pageHasUnavailableDependencies(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageSyncStatus();return!!e.unavailableDependencies&&e.unavailableDependencies.length>0}))}fetchPageTranslatedApprovalInfo(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageSyncStatus();const t=e.unavailableDependencies.map((({itemId:e})=>e));const o=yield this.cmsitemsRestService.getByIds(t).then((({response:e})=>e.map((({name:e})=>e)).join(", ")));return this.translateService.instant("se.cms.workflow.approval.info",{itemNames:o})}))}_loadExperience(e){this.storageService.setValueInLocalStorage("seselectedsite",e.siteId,false);this.experienceService.loadExperience(e).then((()=>{this.sharedDataService.set(ti,t.OpenPageWorkflowMenu.Default)}))}getPageSyncStatus(){return __awaiter(this,void 0,void 0,(function*(){const{uuid:e}=yield this.pageService.getCurrentPageInfo();const t=yield this.catalogService.retrieveUriContext();return this.syncPollingService.getSyncStatus(e,t)}))}};t.WorkflowService.$inject=["restServiceFactory","crossFrameEventService","systemEventService","sharedDataService","perspectiveService","catalogService","experienceService","workflowTasksPollingService","pageService","syncPollingService","cmsitemsRestService","translateService","storageService"];__decorate([s.Cached({actions:[Ri],tags:[ji,Gi,vo,ho,uo]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.WorkflowService.prototype,"getWorkflows",null);__decorate([s.Cached({actions:[Ri],tags:[ji]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.WorkflowService.prototype,"getWorkflowTemplates",null);__decorate([s.Cached({actions:[Ri],tags:[ji,vo,ho,uo]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.WorkflowService.prototype,"getAllActionsForWorkflowCode",null);t.WorkflowService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[IRestServiceFactory,t.CrossFrameEventService,t.SystemEventService,s.ISharedDataService,IPerspectiveService,ICatalogService,IExperienceService,t.WorkflowTasksPollingService,IPageService,ISyncPollingService,t.CmsitemsRestService,S.TranslateService,s.IStorageService])],t.WorkflowService);t.SyncPollingService=class SyncPollingService extends ISyncPollingService{constructor(){super()}};t.SyncPollingService=__decorate([SeDowngradeService(ISyncPollingService),qi("getSyncStatus","fetchSyncStatus","changePollingSpeed","registerSyncPollingEvents","performSync"),__metadata("design:paramtypes",[])],t.SyncPollingService);t.PageVersioningService=class PageVersioningService{constructor(e){this.restServiceFactory=e;this.pageVersionsServiceResourceURI=`/cmswebservices/v1/sites/${be}/cmsitems/:pageUuid/versions`;this.pageVersionsRollbackServiceResourceURI=`/cmswebservices/v1/sites/${be}/cmsitems/:pageUuid/versions/:versionId/rollbacks`;this.pageVersionRESTService=this.restServiceFactory.get(this.pageVersionsServiceResourceURI);this.pageVersionsRollbackRESTService=this.restServiceFactory.get(this.pageVersionsRollbackServiceResourceURI)}findPageVersions(e){return this.pageVersionRESTService.page(e)}getPageVersionForId(e,t){return this.pageVersionRESTService.get({pageUuid:e,identifier:t})}getResourceURI(){return this.pageVersionsServiceResourceURI}deletePageVersion(e,t){return this.pageVersionRESTService.remove({pageUuid:e,identifier:t})}rollbackPageVersion(e,t){return this.pageVersionsRollbackRESTService.save({pageUuid:e,versionId:t})}};t.PageVersioningService.$inject=["restServiceFactory"];t.PageVersioningService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[IRestServiceFactory])],t.PageVersioningService);t.PageVersionSelectionService=class PageVersionSelectionService{constructor(e,t,o,n,a,r,d){this.crossFrameEventService=e;this.alertService=t;this.experienceService=o;this.cMSModesService=n;this.pageInfoService=a;this.pageVersioningService=r;this.translateService=d;this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY="se.cms.pageVersionsMenu";this.PAGE_VERSION_UNSELECTED_MSG_KEY="se.cms.versions.unselect.version";this.selectedPageVersionSubject=new v.BehaviorSubject(null);this.unSubEventPerspectiveChanged=this.crossFrameEventService.subscribe(Ke,(()=>this.removePageVersionOnPerspectiveChange()));this.unSubEventPerspectiveRefreshed=this.crossFrameEventService.subscribe(Ze,(()=>this.resetPageVersionContext()));this.unSubEventPageChange=this.crossFrameEventService.subscribe(s.EVENTS.PAGE_CHANGE,((e,t)=>this.initOnPageChange(t)));this.unSubSelectedPageVersion=this.selectedPageVersionSubject.subscribe((e=>this.selectedPageVersion=e))}ngOnDestroy(){this.unSubEventPerspectiveChanged();this.unSubEventPerspectiveRefreshed();this.unSubEventPageChange();this.unSubSelectedPageVersion.unsubscribe()}getSelectedPageVersion(){return this.selectedPageVersion}getSelectedPageVersion$(){return this.selectedPageVersionSubject.asObservable()}hideToolbarContextIfNotNeeded(){if(!this.selectedPageVersion){this.crossFrameEventService.publish(Mt,this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY)}}showToolbarContextIfNeeded(){if(this.selectedPageVersion){this.crossFrameEventService.publish(Nt,this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY)}}selectPageVersion(e){if(!this.isSameVersion(this.selectedPageVersion,e)){this.selectedPageVersionSubject.next(e);this.experienceService.updateExperience({versionId:e.uid});this.showToolbarContextIfNeeded();this.crossFrameEventService.publish(s.EVENTS.PAGE_SELECTED)}}deselectPageVersion(e=true){if(this.selectedPageVersion&&e){const e=this.translateService.instant(this.PAGE_VERSION_UNSELECTED_MSG_KEY);this.alertService.showInfo(e)}this.selectedPageVersionSubject.next(null);this.experienceService.updateExperience({versionId:null});this.crossFrameEventService.publish(Mt,this.PAGE_VERSIONS_TOOLBAR_ITEM_KEY)}updatePageVersionDetails(e){this.selectedPageVersionSubject.next(e)}initOnPageChange(e){return __awaiter(this,void 0,void 0,(function*(){if(e.versionId&&!this.selectedPageVersion){const t=yield this.pageInfoService.getPageUUID();const o=yield this.pageVersioningService.getPageVersionForId(t,String(e.versionId));this.selectedPageVersionSubject.next(o);this.showToolbarContextIfNeeded();this.crossFrameEventService.publish(s.EVENTS.PAGE_SELECTED)}}))}isSameVersion(e,t){return e!==null&&t!==null?this.selectedPageVersion.uid===t.uid:false}removePageVersionOnPerspectiveChange(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.cMSModesService.isVersioningPerspectiveActive();if(this.selectedPageVersion){const t=yield this.pageInfoService.getPageUUID();if(!e||this.selectedPageVersion.itemUUID!==t){this.deselectPageVersion()}}}))}resetPageVersionContext(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();if(!e.versionId&&this.selectedPageVersion){this.selectedPageVersionSubject.next(null);this.hideToolbarContextIfNotNeeded()}else{this.showToolbarContextIfNeeded()}}))}};t.PageVersionSelectionService.$inject=["crossFrameEventService","alertService","experienceService","cMSModesService","pageInfoService","pageVersioningService","translateService"];t.PageVersionSelectionService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[t.CrossFrameEventService,s.IAlertService,IExperienceService,t.CMSModesService,IPageInfoService,t.PageVersioningService,S.TranslateService])],t.PageVersionSelectionService);t.SlotRestrictionsService=class SlotRestrictionsService extends ISlotRestrictionsService{getAllComponentTypesSupportedOnPage(){return null}getSlotRestrictions(e){return null}isSlotEditable(e){return null}isComponentAllowedInSlot(e,t){return null}};t.SlotRestrictionsService=__decorate([SeDowngradeService(ISlotRestrictionsService),qi("getAllComponentTypesSupportedOnPage","getSlotRestrictions","isSlotEditable","isComponentAllowedInSlot")],t.SlotRestrictionsService);t.EditorModalService=class EditorModalService extends IEditorModalService{};t.EditorModalService=__decorate([SeDowngradeService(IEditorModalService),qi("open","openAndRerenderSlot","openGenericEditor")],t.EditorModalService);t.PageContentSlotsService=class PageContentSlotsService{constructor(e,t,o){this.crossFrameEventService=t;this.pageInfoService=o;this.resource=e.get(ni);this.crossFrameEventService.subscribe(s.EVENTS.PAGE_CHANGE,(()=>this.reloadPageContentSlots()))}getPageContentSlots(){return __awaiter(this,void 0,void 0,(function*(){if(!this.pageContentSlots){yield this.reloadPageContentSlots()}return this.pageContentSlots}))}getSlotStatus(e){return __awaiter(this,void 0,void 0,(function*(){yield this.getPageContentSlots();const t=r.first(this.pageContentSlots.filter((t=>t.slotId===e)));return t?t.slotStatus:null}))}isSlotShared(e){return __awaiter(this,void 0,void 0,(function*(){yield this.getPageContentSlots();const t=r.first(this.pageContentSlots.filter((t=>t.slotId===e)));return t&&t.slotShared}))}reloadPageContentSlots(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUID();const t=yield this.resource.get({pageId:e});this.pageContentSlots=r.uniq(t.pageContentSlotList||[])}))}};t.PageContentSlotsService.$inject=["restServiceFactory","crossFrameEventService","pageInfoService"];t.PageContentSlotsService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[IRestServiceFactory,t.CrossFrameEventService,IPageInfoService])],t.PageContentSlotsService);class PageInfoService extends IPageInfoService{getPageUID(){return null}getPageUUID(){return null}getCatalogVersionUUIDFromPage(){return null}}PageInfoService.PATTERN_SMARTEDIT_CATALOG_VERSION_UUID=/smartedit-catalog-version-uuid\-(\S+)/;t.ComponentHandlerService=class ComponentHandlerService{constructor(e){this.yjQuery=e}getOverlay(){return this.yjQuery("#"+it)}isOverlayOn(){return this.getOverlay().length&&this.getOverlay()[0].style.display!=="none"}getComponentUnderSlot(e,t,o,n){const s=this.buildComponentQuery(o,vt);const a=this.buildComponentQuery(e,t,n);const r=s+" "+a;return this.yjQuery(r)}getComponent(e,t,o){return this.yjQuery(this.buildComponentQuery(e,t,o))}getOriginalComponentWithinSlot(e,t,o){return this.getComponentUnderSlot(e,t,o,at)}getOriginalComponent(e,t){return this.getComponent(e,t,at)}getOverlayComponentWithinSlot(e,t,o){return this.getComponentUnderSlot(e,t,o,ht)}getOverlayComponent(e){const t=this.getParentSlotForComponent(e.parent());if(t){return this.getComponentUnderSlot(e.attr(me),e.attr(ge),t,ht)}else{return this.getComponent(e.attr(me),e.attr(ge),ht)}}getComponentInOverlay(e,t){return this.getComponent(e,t,ht)}getParentSlotForComponent(e){const t=this.yjQuery(e).closest("["+ge+"="+vt+"]");return t.attr(me)}getComponentPositionInSlot(e,t){const o=this.getOriginalComponentsWithinSlot(e);return r.findIndex(o,(e=>this.getId(e)===t))}getOriginalComponentsWithinSlot(e){return this.yjQuery(this.buildComponentsInSlotQuery(e))}getSlotOperationRelatedId(e){e=this.yjQuery(e);const t=e.attr(lt);return t&&e.attr(_t)?t:e.attr(me)}getSlotOperationRelatedUuid(e){const t=this.yjQuery(e).attr(lt);return t&&this.yjQuery(e).attr(_t)?t:this.yjQuery(e).attr(ut)}getParent(e){e=this.yjQuery(e);const t=e.hasClass(at)?at:e.hasClass(ht)?ht:null;if(s.stringUtils.isBlank(t)){throw new Error("componentHandlerService.getparent.error.component.from.unknown.layer")}return e.closest("."+t+"["+me+"]"+"["+me+"!='"+e.attr(me)+"']")}getClosestSmartEditComponent(e){return this.yjQuery(e).closest("."+at)}isSmartEditComponent(e){return this.yjQuery(e).hasClass(at)}setId(e,t){return this.yjQuery(e).attr(me,t)}getId(e){return this.yjQuery(e).attr(me)}getUuid(e){return this.yjQuery(e).attr(ut)}getCatalogVersionUuid(e){return this.yjQuery(e).attr(nt)}setType(e,t){return this.yjQuery(e).attr(ge,t)}getType(e){return this.yjQuery(e).attr(ge)}getSlotOperationRelatedType(e){const t=this.yjQuery(e).attr(_t);return t&&this.yjQuery(e).attr(lt)?t:this.yjQuery(e).attr(ge)}getAllComponentsSelector(){return"."+at+"["+ge+"!='ContentSlot']"}getAllSlotsSelector(){return"."+at+"["+ge+"='ContentSlot']"}getParentSlotUuidForComponent(e){return this.yjQuery(e).closest("["+ge+"="+vt+"]").attr(ut)}isExternalComponent(e,t){const o=this.getOriginalComponent(e,t);const n=this.getCatalogVersionUuid(o);return n!==this.getBodyClassAttributeByRegEx(PageInfoService.PATTERN_SMARTEDIT_CATALOG_VERSION_UUID)}getBodyClassAttributeByRegEx(e){try{const t=this.yjQuery("body").attr("class");return e.exec(t)[1]}catch(e){throw{name:"InvalidStorefrontPageError",message:"Error: the page is not a valid storefront page."}}}getFirstSmartEditComponentChildren(e){const t=this.yjQuery(e);const o=t[0];if(!o){return[]}const n=Array.from(o.getElementsByClassName(at)).filter((e=>{let t=e.parentElement;while(t!==o){if(t.classList.contains(at)){return false}t=t.parentElement}return true}));return this.yjQuery(n)}getComponentCloneInOverlay(e){const t=e.attr(pe);return this.yjQuery("."+ht+"["+pe+"='"+t+"']")}getAllSlotUids(){const e=this.yjQuery(this.getAllSlotsSelector());const t=this;const o=Array.prototype.slice.call(e.map((function(){return t.getId(this)})));return o}buildComponentQuery(e,t,o){let n="";n+=o?"."+o:"";n+="["+me+"='"+e+"']";n+="["+ge+"='"+t+"']";return n}buildComponentsInSlotQuery(e){let t="";t+="."+at;t+="["+me+"='"+e+"']";t+="["+ge+"='"+vt+"']";t+=" > ";t+="["+me+"]";return t}};t.ComponentHandlerService.$inject=["yjQuery"];t.ComponentHandlerService=__decorate([SeDowngradeService(),__param(0,d.Inject(Qi)),__metadata("design:paramtypes",[Function])],t.ComponentHandlerService);t.SlotSharedService=class SlotSharedService{constructor(e,t,o,n,s,a,r){this.pageContentSlotsService=e;this.pageInfoService=t;this.translateService=o;this.editorModalService=n;this.componentHandlerService=s;this.catalogService=a;this.sharedDataService=r}isSlotShared(e){return this.pageContentSlotsService.isSlotShared(e)}isGlobalSlot(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=this.componentHandlerService.isExternalComponent(e,t);const[n,s]=yield Promise.all([this.catalogService.isCurrentCatalogMultiCountry(),this.sharedDataService.get(Jt)]);const a=n||false;const r=this.isCurrentPageFromParentCatalog(s);return a&&(o||r&&!o)}))}setSharedSlotEnablementStatus(e){this.disableShareSlotStatus=e}areSharedSlotsDisabled(){return this.disableShareSlotStatus}replaceGlobalSlot(e){return __awaiter(this,void 0,void 0,(function*(){this.validateComponentAttributes(e);const t=yield this.constructCmsItemParameter(e);const o={title:"se.cms.slot.shared.replace.editor.title",structure:{attributes:[{cmsStructureType:"SlotSharedSlotTypeField",qualifier:"isSlotCustom",required:true},{cmsStructureType:"SlotSharedCloneActionField",qualifier:"cloneAction",required:true}]},contentApi:co,saveLabel:"se.cms.slot.shared.replace.editor.save",content:t,initialDirty:true};return this.editorModalService.openGenericEditor(o)}))}replaceSharedSlot(e){return __awaiter(this,void 0,void 0,(function*(){this.validateComponentAttributes(e);const t=yield this.constructCmsItemParameter(e);t.isSlotCustom=true;const o={title:"se.cms.slot.shared.replace.editor.title",structure:{attributes:[{cmsStructureType:"SlotSharedCloneActionField",qualifier:"cloneAction",required:true}]},contentApi:co,saveLabel:"se.cms.slot.shared.replace.editor.save",content:t,initialDirty:true};return this.editorModalService.openGenericEditor(o)}))}constructCmsItemParameter(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.translateService.instant("se.cms.slot.shared.clone");const o=yield this.pageInfoService.getPageUID();const n=yield this.pageInfoService.getCatalogVersionUUIDFromPage();const s=`${o}-${e.smarteditComponentId}-${t}`;const a={name:s,smarteditComponentId:e.smarteditComponentId,contentSlotUuid:e.smarteditComponentUuid,itemtype:e.smarteditComponentType,catalogVersion:n,pageUuid:o,onlyOneRestrictionMustApply:false};return a}))}validateComponentAttributes(e){if(!e){throw new Error("Parameter: componentAttributes needs to be supplied!")}const t=["smarteditComponentId","smarteditComponentUuid","smarteditComponentType"];const o=t.find((t=>!e[t]));if(!!o){throw new Error(`Parameter: componentAttributes.${o} needs to be supplied!`)}}isCurrentPageFromParentCatalog(e){var t,o;const n=((t=e===null||e===void 0?void 0:e.pageContext)===null||t===void 0?void 0:t.catalogVersionUuid)||"";const s=((o=e===null||e===void 0?void 0:e.catalogDescriptor)===null||o===void 0?void 0:o.catalogVersionUuid)||"";const a=s!==n;return a}};t.SlotSharedService.$inject=["pageContentSlotsService","pageInfoService","translateService","editorModalService","componentHandlerService","catalogService","sharedDataService"];t.SlotSharedService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[t.PageContentSlotsService,IPageInfoService,S.TranslateService,IEditorModalService,t.ComponentHandlerService,ICatalogService,s.ISharedDataService])],t.SlotSharedService);t.ComponentMenuService=class ComponentMenuService{constructor(e,t,o){this.catalogService=e;this.experienceService=t;this.storageService=o;this.SELECTED_CATALOG_VERSION_COOKIE_NAME="se_catalogmenu_catalogversion_cookie"}hasMultipleContentCatalogs(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageContext();const t=yield this.getContentCatalogs();const o=t.find((t=>t.catalogId===e.catalogId));return!!o.parents&&o.parents.length>0}))}getContentCatalogs(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageContext();return e?this.catalogService.getContentCatalogsForSite(e.siteId):[]}))}getValidContentCatalogVersions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageContext();const t=yield this.getContentCatalogs();let o=[];const n=t.find((t=>t.catalogId===e.catalogId));o.push(this.getActiveOrCurrentVersionForCatalog(e,n));const s=n.parents.map((t=>this.getActiveOrCurrentVersionForCatalog(e,t)));o=[...s,...o];return o}))}getInitialCatalogVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.storageService.getValueFromLocalStorage(this.SELECTED_CATALOG_VERSION_COOKIE_NAME,false);const o=typeof t==="string"?t:null;const n=e.find((e=>e.id===o));return n?n:e[e.length-1]}))}persistCatalogVersion(e){return this.storageService.setValueInLocalStorage(this.SELECTED_CATALOG_VERSION_COOKIE_NAME,e,false)}getActiveOrCurrentVersionForCatalog(e,t){const o=t.versions.find((o=>{if(e.catalogId===t.catalogId){return e.catalogVersion===o.version}return o.active}));return{isCurrentCatalog:e.catalogVersion===o.version,catalogName:t.name?t.name:t.catalogName,catalogId:t.catalogId,catalogVersionId:o.version,id:o.uuid}}getPageContext(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();return e.pageContext}))}};t.ComponentMenuService.$inject=["catalogService","experienceService","storageService"];t.ComponentMenuService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[ICatalogService,IExperienceService,s.IStorageService])],t.ComponentMenuService);const fo=1024;const yo={ACCEPTED_FILE_TYPES:{VIDEO:["mp4","avi","x-msvideo","wmv","mpg","mpeg","flv"],IMAGE:["jpeg","jpg","gif","bmp","tiff","tif","png","svg"],PDF_DOCUMENT:["pdf"],DEFAULT:["jpeg","jpg","gif","bmp","tiff","tif","png","svg"]},DEFAULT_MAX_UPLOAD_FILE_SIZE:20,I18N_KEYS:{FILE_TYPE_INVALID:"se.upload.file.type.invalid",FILE_SIZE_INVALID:"se.upload.file.size.invalid"}};t.FileValidationService=class FileValidationService extends IFileValidation{constructor(e,t){super();this.fileMimeTypeService=e;this.fileValidatorFactory=t;this.validators=[{subject:"size",message:yo.I18N_KEYS.FILE_SIZE_INVALID,validate:(e,t)=>e<=t*fo*fo}]}validate(e,t,o){return __awaiter(this,void 0,void 0,(function*(){this.fileValidatorFactory.build(this.validators).validate(e,t,o);try{yield this.fileMimeTypeService.isFileMimeTypeValid(e);if(o.length>0){return Promise.reject(o)}}catch(e){o.push({subject:"type",message:yo.I18N_KEYS.FILE_TYPE_INVALID});return Promise.reject(o)}}))}};t.FileValidationService.$inject=["fileMimeTypeService","fileValidatorFactory"];t.FileValidationService=__decorate([d.Injectable(),__metadata("design:paramtypes",[s.FileMimeTypeService,s.FileValidatorFactory])],t.FileValidationService);t.UserTrackingService=class UserTrackingService{constructor(e,t,o){this.windowUtils=e;this.settingService=t;this.logService=o;this.CUSTOMER_KEY="modelt.customer.code";this.PROJECT_KEY="modelt.project.code";this.ENVIRONMENT_KEY="modelt.environment.code";this.TRACKING_URL_KEY="smartedit.click.tracking.server.url";this.DEFAULT_CUSTOMER="localCustomer";this.DEFAULT_PROJECT="localProject";this.DEFAULT_ENVIRONMENT="localEnvironment";this.DEFAULT_TRACKING_URL="https://license.hybris.com/collect";this.isInitialized=false}initConfiguration(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.settingService.getBoolean("smartedit.default.click.tracking.enabled");if(!e){this.isInitialized=false;return}if(this.isEnvInitialized()){const e=yield this.getSiteId();let t=yield this.settingService.get(this.TRACKING_URL_KEY);t=t!==undefined?t:this.DEFAULT_TRACKING_URL;this._paq.push(["setTrackerUrl",t]);this._paq.push(["setSiteId",e]);this.isInitialized=true}else{this.isInitialized=false;this.logService.warn("User tracking is enabled and tracking tool is not initialized.")}}))}trackingUserAction(e,t){if(this.isInitialized){if(gi.has(t)){t=gi.get(t)}this._paq.push(["trackEvent","SmartEdit",e,t])}}isEnvInitialized(){this._paq=this.windowUtils.getWindow()._paq;return this._paq===undefined?false:this._paq.push!==undefined}getSiteId(){return __awaiter(this,void 0,void 0,(function*(){let e=yield this.settingService.get(this.CUSTOMER_KEY);e=e!==undefined?e:this.DEFAULT_CUSTOMER;let t=yield this.settingService.get(this.PROJECT_KEY);t=t!==undefined?t:this.DEFAULT_PROJECT;let o=yield this.settingService.get(this.ENVIRONMENT_KEY);o=o!==undefined?o:this.DEFAULT_ENVIRONMENT;return`${e}-${t}-${o}`}))}};t.UserTrackingService.$inject=["windowUtils","settingService","logService"];t.UserTrackingService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[t.WindowUtils,s.ISettingsService,s.LogService])],t.UserTrackingService);const So=new d.InjectionToken("DROPDOWN_MENU_ITEM_DATA");window.__smartedit__.addDecoratorPayload("Component","DropdownMenuItemDefaultComponent",{selector:"se-dropdown-menu-item-default",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`<a class="se-dropdown-item fd-menu__item" [ngClass]="data.dropdownItem.customCss" (click)="data.dropdownItem.callback(data.selectedItem, data.dropdownItem)"><span *ngIf="data.dropdownItem.icon" [ngClass]="data.dropdownItem.icon"></span> <span>{{ data.dropdownItem.key | translate }}</span></a>`});t.DropdownMenuItemDefaultComponent=class DropdownMenuItemDefaultComponent{constructor(e){this.data=e}};t.DropdownMenuItemDefaultComponent=__decorate([d.Component({selector:"se-dropdown-menu-item-default",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`<a class="se-dropdown-item fd-menu__item" [ngClass]="data.dropdownItem.customCss" (click)="data.dropdownItem.callback(data.selectedItem, data.dropdownItem)"><span *ngIf="data.dropdownItem.icon" [ngClass]="data.dropdownItem.icon"></span> <span>{{ data.dropdownItem.key | translate }}</span></a>`}),__param(0,d.Inject(So)),__metadata("design:paramtypes",[Object])],t.DropdownMenuItemDefaultComponent);let Co=class GenericEditorComponent{constructor(e){this.$attrs=e}$onInit(){this.submit=this.$attrs.hasOwnProperty("submit")?this.submit:null;this.reset=this.$attrs.hasOwnProperty("reset")?this.reset:null;this.isDirty=this.$attrs.hasOwnProperty("isDirty")?this.isDirty:null;this.isValid=this.$attrs.hasOwnProperty("isValid")?this.isValid:null}};Co.$inject=["$attrs"];Co=__decorate([SeComponent({templateUrl:"genericEditorComponentTemplate.html",inputs:["id:=","smarteditComponentId:=","smarteditComponentType:=?","contentApi:=","content:=","uriContext","submit:=?","reset:=?","isDirty:=?","isValid:=?","getApi:&?","customOnSubmit:=?","structureApi","structure","updateCallback","editorStackId"]}),__metadata("design:paramtypes",[Object])],Co);const bo={provide:"GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT",useValue:Ct};const Io={provide:"GENERIC_EDITOR_LOADED_EVENT",useValue:St};t.GenericEditorModule=class GenericEditorModule{};t.GenericEditorModule=__decorate([SeModule({imports:["coretemplates","translationServiceModule","seConstantsModule","resourceLocationsModule","ui.bootstrap"],providers:[bo,Io],declarations:[Co]})],t.GenericEditorModule);const wo={expandedByDefault:false,iconAlignment:"right",iconVisible:true};window.__smartedit__.addDecoratorPayload("Component","CollapsibleContainerComponent",{selector:"se-collapsible-container",template:`<div role="tab" class="collapsible-container__header" [ngClass]="{\n        'collapsible-container__header--icon-right': isIconRight(),\n        'collapsible-container__header--icon-left': isIconLeft()\n    }" [attr.id]="headingId" [attr.aria-selected]="isOpen" (keypress)="handleKeypress($event)"><button type="button" tabindex="0" class="collapsible-container__header__title" (click)="toggle()" [attr.aria-expanded]="isOpen" [attr.aria-controls]="panelId"><ng-content select="se-collapsible-container-header"></ng-content></button> <a class="collapsible-container__header__button btn btn-link" *ngIf="configuration.iconVisible" [ngClass]="{\n            'collapsible-container__header__button--expanded': isOpen\n        }" [title]="isOpen\n            ? 'se.ycollapsible.action.collapse'\n            : ('se.ycollapsible.action.expand' | translate)\n        " [attr.aria-expanded]="isOpen" (click)="toggle()"><span class="sap-icon--navigation-down-arrow collapsible-container__header__icon"></span></a></div><div #container class="collapsible-container__content panel" [ngStyle]="{ 'max-height.px': isOpen ? containerHeight : 0 }" [attr.id]="panelId" [attr.aria-labelledby]="headingId" [attr.aria-hidden]="!isOpen" role="tabpanel"><ng-content select="se-collapsible-container-content"></ng-content></div>`,styles:[`.collapsible-container__content{overflow:hidden;display:block;transition:max-height .4s ease;width:100%;background-color:#fff}.collapsible-container__header{max-width:100%;background-color:#fff;display:flex;align-items:center;min-height:50px;box-shadow:0 1px 1px rgba(0,0,0,.05)}.collapsible-container__header__title{text-align:left;background:0 0;border:0;outline:0;flex:1;display:flex;align-items:center;min-height:50px;text-decoration:none;user-select:none}.collapsible-container__header__title:hover{text-decoration:none}.collapsible-container__header__button{flex:0;transition:all .4s ease;font-size:20px}.collapsible-container__header__button--expanded{transform:rotate(180deg)}.collapsible-container__header--icon-right .collapsible-container__header__title{order:1}.collapsible-container__header--icon-right .collapsible-container__header__button{order:2}.collapsible-container__header--icon-left .collapsible-container__header__title{order:2}.collapsible-container__header--icon-left .collapsible-container__header__button{order:1}:host(.se-collapsible-container--noshadow) .collapsible-container__content.panel{box-shadow:none}`],changeDetection:d.ChangeDetectionStrategy.OnPush});t.CollapsibleContainerComponent=class CollapsibleContainerComponent{constructor(e){this.cdr=e;this.getApi=new d.EventEmitter;this.containerHeight=0;this.headingId=ae.generateIdentifier();this.panelId=ae.generateIdentifier();this.api={isExpanded:()=>this.isOpen}}set _container(e){this.container=e;this.containerHeight=e.nativeElement.scrollHeight;if(!this.mutationObserver&&this.container&&this.container.nativeElement){this.mutationObserver=new MutationObserver((()=>{this.containerHeight=this.container.nativeElement.scrollHeight;if(!this.cdr.destroyed){this.cdr.detectChanges()}}));this.mutationObserver.observe(this.container.nativeElement,{childList:true,subtree:true,attributes:true})}}ngOnDestroy(){this.mutationObserver.disconnect()}ngOnChanges(e){if(e.configuration){this.configure()}}ngOnInit(){this.configure();this.isOpen=this.configuration.expandedByDefault;this.getApi.emit(this.api)}toggle(){this.isOpen=!this.isOpen}handleKeypress(e){if(e.code==="Enter"){this.toggle()}}isIconRight(){return this.configuration.iconAlignment==="right"}isIconLeft(){return this.configuration.iconAlignment==="left"}configure(){this.configuration=Object.assign(Object.assign({},wo),this.configuration||{})}};t.CollapsibleContainerComponent.$inject=["cdr"];__decorate([d.Input(),__metadata("design:type",Object)],t.CollapsibleContainerComponent.prototype,"configuration",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.CollapsibleContainerComponent.prototype,"getApi",void 0);__decorate([d.ViewChild("container",{static:true}),__metadata("design:type",d.ElementRef),__metadata("design:paramtypes",[d.ElementRef])],t.CollapsibleContainerComponent.prototype,"_container",null);t.CollapsibleContainerComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-collapsible-container",template:`<div role="tab" class="collapsible-container__header" [ngClass]="{\n        'collapsible-container__header--icon-right': isIconRight(),\n        'collapsible-container__header--icon-left': isIconLeft()\n    }" [attr.id]="headingId" [attr.aria-selected]="isOpen" (keypress)="handleKeypress($event)"><button type="button" tabindex="0" class="collapsible-container__header__title" (click)="toggle()" [attr.aria-expanded]="isOpen" [attr.aria-controls]="panelId"><ng-content select="se-collapsible-container-header"></ng-content></button> <a class="collapsible-container__header__button btn btn-link" *ngIf="configuration.iconVisible" [ngClass]="{\n            'collapsible-container__header__button--expanded': isOpen\n        }" [title]="isOpen\n            ? 'se.ycollapsible.action.collapse'\n            : ('se.ycollapsible.action.expand' | translate)\n        " [attr.aria-expanded]="isOpen" (click)="toggle()"><span class="sap-icon--navigation-down-arrow collapsible-container__header__icon"></span></a></div><div #container class="collapsible-container__content panel" [ngStyle]="{ 'max-height.px': isOpen ? containerHeight : 0 }" [attr.id]="panelId" [attr.aria-labelledby]="headingId" [attr.aria-hidden]="!isOpen" role="tabpanel"><ng-content select="se-collapsible-container-content"></ng-content></div>`,styles:[`.collapsible-container__content{overflow:hidden;display:block;transition:max-height .4s ease;width:100%;background-color:#fff}.collapsible-container__header{max-width:100%;background-color:#fff;display:flex;align-items:center;min-height:50px;box-shadow:0 1px 1px rgba(0,0,0,.05)}.collapsible-container__header__title{text-align:left;background:0 0;border:0;outline:0;flex:1;display:flex;align-items:center;min-height:50px;text-decoration:none;user-select:none}.collapsible-container__header__title:hover{text-decoration:none}.collapsible-container__header__button{flex:0;transition:all .4s ease;font-size:20px}.collapsible-container__header__button--expanded{transform:rotate(180deg)}.collapsible-container__header--icon-right .collapsible-container__header__title{order:1}.collapsible-container__header--icon-right .collapsible-container__header__button{order:2}.collapsible-container__header--icon-left .collapsible-container__header__title{order:2}.collapsible-container__header--icon-left .collapsible-container__header__button{order:1}:host(.se-collapsible-container--noshadow) .collapsible-container__content.panel{box-shadow:none}`],changeDetection:d.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[d.ChangeDetectorRef])],t.CollapsibleContainerComponent);window.__smartedit__.addDecoratorPayload("Component","CollapsibleContainerContentComponent",{selector:"se-collapsible-container-content",template:` <ng-content></ng-content> `});t.CollapsibleContainerContentComponent=class CollapsibleContainerContentComponent{};t.CollapsibleContainerContentComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-collapsible-container-content",template:` <ng-content></ng-content> `})],t.CollapsibleContainerContentComponent);window.__smartedit__.addDecoratorPayload("Component","CollapsibleContainerHeaderComponent",{selector:"se-collapsible-container-header",template:` <ng-content></ng-content> `});t.CollapsibleContainerHeaderComponent=class CollapsibleContainerHeaderComponent{};t.CollapsibleContainerHeaderComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-collapsible-container-header",template:` <ng-content></ng-content> `})],t.CollapsibleContainerHeaderComponent);t.CollapsibleContainerModule=class CollapsibleContainerModule{};t.CollapsibleContainerModule=__decorate([d.NgModule({imports:[S.TranslateModule.forChild(),f.CommonModule],declarations:[t.CollapsibleContainerComponent,t.CollapsibleContainerContentComponent,t.CollapsibleContainerHeaderComponent],entryComponents:[t.CollapsibleContainerComponent,t.CollapsibleContainerContentComponent,t.CollapsibleContainerHeaderComponent],exports:[t.CollapsibleContainerComponent,t.CollapsibleContainerContentComponent,t.CollapsibleContainerHeaderComponent]})],t.CollapsibleContainerModule);window.__smartedit__.addDecoratorPayload("Component","WaitDialogComponent",{template:`\n        <div class="panel panel-default ySEPanelSpinner">\n            <div class="panel-body">\n                <div class="spinner ySESpinner">\n                    <div class="spinner-container spinner-container1">\n                        <div class="spinner-circle1"></div>\n                        <div class="spinner-circle2"></div>\n                        <div class="spinner-circle3"></div>\n                        <div class="circle4"></div>\n                    </div>\n                    <div class="spinner-container spinner-container2">\n                        <div class="spinner-circle1"></div>\n                        <div class="spinner-circle2"></div>\n                        <div class="spinner-circle3"></div>\n                        <div class="circle4"></div>\n                    </div>\n                    <div class="spinner-container spinner-container3">\n                        <div class="spinner-circle1"></div>\n                        <div class="spinner-circle2"></div>\n                        <div class="spinner-circle3"></div>\n                        <div class="circle4"></div>\n                    </div>\n                </div>\n                <div class="ySESpinnerText">\n                    {{\n                        modalRef.data.customLoadingMessageLocalizedKey || 'se.wait.dialog.message'\n                            | translate\n                    }}\n                </div>\n            </div>\n        </div>\n    `,selector:"wait-dialog"});t.WaitDialogComponent=class WaitDialogComponent{constructor(e){this.modalRef=e}};t.WaitDialogComponent=__decorate([d.Component({template:`\n        <div class="panel panel-default ySEPanelSpinner">\n            <div class="panel-body">\n                <div class="spinner ySESpinner">\n                    <div class="spinner-container spinner-container1">\n                        <div class="spinner-circle1"></div>\n                        <div class="spinner-circle2"></div>\n                        <div class="spinner-circle3"></div>\n                        <div class="circle4"></div>\n                    </div>\n                    <div class="spinner-container spinner-container2">\n                        <div class="spinner-circle1"></div>\n                        <div class="spinner-circle2"></div>\n                        <div class="spinner-circle3"></div>\n                        <div class="circle4"></div>\n                    </div>\n                    <div class="spinner-container spinner-container3">\n                        <div class="spinner-circle1"></div>\n                        <div class="spinner-circle2"></div>\n                        <div class="spinner-circle3"></div>\n                        <div class="circle4"></div>\n                    </div>\n                </div>\n                <div class="ySESpinnerText">\n                    {{\n                        modalRef.data.customLoadingMessageLocalizedKey || 'se.wait.dialog.message'\n                            | translate\n                    }}\n                </div>\n            </div>\n        </div>\n    `,selector:"wait-dialog"}),__metadata("design:paramtypes",[I.ModalRef])],t.WaitDialogComponent);class TabsSelectAdapter{static transform(e,t){return{id:t,label:e.title,value:e,listItemClassName:e.hasErrors&&"sm-tab-error"}}}window.__smartedit__.addDecoratorPayload("Component","TabsComponent",{selector:"se-tabs",template:`<div class="se-tabset-wrapper"><ul class="nav nav-tabs se-tabset" role="tablist" *ngIf="isInitialized"><ng-container *ngIf="tabsList.length !== numTabsDisplayed"><ng-container *ngFor="let tab of (getVisibleTabs() | async); trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><ng-container *ngIf="tabsList && tabsList.length == numTabsDisplayed"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><su-select class="se-tabset__select" *ngIf="tabsList.length > numTabsDisplayed && (getDropdownTabs() | async)" [items]="dropdownTabs" [isKeyboardControlEnabled]="false" [hasCustomTrigger]="true" (onItemSelected)="selectTab($event.value)"><li [ngClass]="{'active': isActiveInMoreTab()}" su-select-custom-trigger><a [ngClass]="{'sm-tab-error': dropDownHasErrors()}" class="dropdown-toggle"><span *ngIf="!isActiveInMoreTab()" class="multi-tabs__more-span">{{ 'se.ytabset.tabs.more' | translate }} </span><span *ngIf="isActiveInMoreTab()" class="multi-tabs__more-span">{{selectedTab.title | translate}} </span><span class="caret"></span></a></li></su-select><ng-template #tabsetLink let-tab><li [ngClass]="{ \n                    'active': tab.id === selectedTab.id,\n                    'se-tabset__tab--disabled': tab.disabled\n                }" [attr.tab-id]="tab.id" class="se-tabset__tab"><a [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link mycustomtabset" (click)="selectTab(tab)" *ngIf="!tab.message">{{tab.title | translate}}</a><se-tooltip [triggers]="['mouseover']" *ngIf="tab.message"><a se-tooltip-trigger [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link" (click)="selectTab(tab)">{{tab.title | translate}} </a><span se-tooltip-body>{{ tab.message }}</span></se-tooltip></li></ng-template></ul><div class="se-tab-set__content-wrapper" *ngIf="selectedTab"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById"><se-tab [hidden]="tab.id !== selectedTab.id" [attr.tab-id]="tab.id" [tab]="tab" [model]="model"></se-tab></ng-container></div></div>`});t.TabsComponent=class TabsComponent{constructor(e){this.userTrackingService=e;this.tabsList=[];this.onTabSelected=new d.EventEmitter;this.tabChangedStream=new v.BehaviorSubject(null)}get isInitialized(){return!!this.tabsList&&this.tabsList.length>1&&!!this.selectedTab}isActiveInMoreTab(){return this.tabsList.findIndex((e=>e.id===this.selectedTab.id))>=this.numTabsDisplayed-1}ngOnChanges(e){const t=e.tabsList&&e.tabsList.currentValue&&!e.tabsList.previousValue||e.tabsList&&e.tabsList.firstChange&&!!e.tabsList.currentValue;const o=e.tabsList&&!!e.tabsList.previousValue&&!!e.tabsList.currentValue;if(this.tabsList){const e=this.tabsList.find((e=>e.active))||this.tabsList[0];if(!this.selectedTab||this.selectedTab&&this.selectedTab.id!==e.id){this.selectedTab=e;this.selectedTab.active=true}}if(t){this.tabsList=this.tabsList.map((e=>Object.assign(Object.assign({},e),{active:false,hasErrors:false})));this.tabChangedStream.next()}if(o){this.tabChangedStream.next()}this.getDropdownTabs().subscribe((e=>{this.dropdownTabs=e}))}selectTab(e){if(e&&e.id!==this.selectedTab.id){this.userTrackingService.trackingUserAction(mi.ADD_COMPONENT,e.title);if(!this.selectedTab.active){this.findSelectedTab()}this.selectedTab.active=false;this.selectedTab=e;this.selectedTab.active=true;this.onTabSelected.emit(this.selectedTab.id)}}dropDownHasErrors(){const e=this.tabsList.slice(this.numTabsDisplayed-1);return e.some((e=>e.hasErrors))}findSelectedTab(){const e=this.tabsList.find((e=>e.active));if(e){this.selectedTab=e}}getDropdownTabs(){return this.tabChangedStream.pipe(b.map((()=>(this.tabsList||[]).slice(this.numTabsDisplayed-1).map(TabsSelectAdapter.transform))),b.distinctUntilChanged(((e,t)=>r.isEqual(e,t))))}getVisibleTabs(){return this.tabChangedStream.pipe(b.map((()=>(this.tabsList||[]).slice(0,this.numTabsDisplayed-1))),b.distinctUntilChanged(((e,t)=>r.isEqual(e,t))))}trackTabById(e){return e}};t.TabsComponent.$inject=["userTrackingService"];__decorate([d.Input(),__metadata("design:type",Object)],t.TabsComponent.prototype,"model",void 0);__decorate([d.Input(),__metadata("design:type",Array)],t.TabsComponent.prototype,"tabsList",void 0);__decorate([d.Input(),__metadata("design:type",Number)],t.TabsComponent.prototype,"numTabsDisplayed",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.TabsComponent.prototype,"onTabSelected",void 0);t.TabsComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-tabs",template:`<div class="se-tabset-wrapper"><ul class="nav nav-tabs se-tabset" role="tablist" *ngIf="isInitialized"><ng-container *ngIf="tabsList.length !== numTabsDisplayed"><ng-container *ngFor="let tab of (getVisibleTabs() | async); trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><ng-container *ngIf="tabsList && tabsList.length == numTabsDisplayed"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById" [ngTemplateOutlet]="tabsetLink" [ngTemplateOutletContext]="{ $implicit: tab }"></ng-container></ng-container><su-select class="se-tabset__select" *ngIf="tabsList.length > numTabsDisplayed && (getDropdownTabs() | async)" [items]="dropdownTabs" [isKeyboardControlEnabled]="false" [hasCustomTrigger]="true" (onItemSelected)="selectTab($event.value)"><li [ngClass]="{'active': isActiveInMoreTab()}" su-select-custom-trigger><a [ngClass]="{'sm-tab-error': dropDownHasErrors()}" class="dropdown-toggle"><span *ngIf="!isActiveInMoreTab()" class="multi-tabs__more-span">{{ 'se.ytabset.tabs.more' | translate }} </span><span *ngIf="isActiveInMoreTab()" class="multi-tabs__more-span">{{selectedTab.title | translate}} </span><span class="caret"></span></a></li></su-select><ng-template #tabsetLink let-tab><li [ngClass]="{ \n                    'active': tab.id === selectedTab.id,\n                    'se-tabset__tab--disabled': tab.disabled\n                }" [attr.tab-id]="tab.id" class="se-tabset__tab"><a [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link mycustomtabset" (click)="selectTab(tab)" *ngIf="!tab.message">{{tab.title | translate}}</a><se-tooltip [triggers]="['mouseover']" *ngIf="tab.message"><a se-tooltip-trigger [ngClass]="{'sm-tab-error': tab.hasErrors}" class="se-tabset__link" (click)="selectTab(tab)">{{tab.title | translate}} </a><span se-tooltip-body>{{ tab.message }}</span></se-tooltip></li></ng-template></ul><div class="se-tab-set__content-wrapper" *ngIf="selectedTab"><ng-container *ngFor="let tab of tabsList; trackBy: trackTabById"><se-tab [hidden]="tab.id !== selectedTab.id" [attr.tab-id]="tab.id" [tab]="tab" [model]="model"></se-tab></ng-container></div></div>`}),__metadata("design:paramtypes",[t.UserTrackingService])],t.TabsComponent);const Eo=new d.InjectionToken("tab-data");window.__smartedit__.addDecoratorPayload("Component","TabComponent",{selector:"se-tab",template:`<ng-container *ngComponentOutlet="tab.component; injector: tabInjector"></ng-container>`});t.TabComponent=class TabComponent{constructor(e){this.injector=e;this.scopeStream=new v.BehaviorSubject(null)}ngOnChanges(e){const t=e.model&&!r.isEqual(e.model.previousValue,e.model.currentValue);const o=e.tab&&!r.isEqual(e.tab.previousValue,e.tab.currentValue);if(o||t){this.scopeStream.next({model:this.model,tabId:this.tab.id,tab:this.tab})}}ngOnInit(){this.tabInjector=d.Injector.create({providers:[{provide:Eo,useValue:{model:this.model,tabId:this.tab.id,tab:this.tab}}],parent:this.injector})}};t.TabComponent.$inject=["injector"];__decorate([d.Input(),__metadata("design:type",Object)],t.TabComponent.prototype,"tab",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.TabComponent.prototype,"model",void 0);t.TabComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-tab",template:`<ng-container *ngComponentOutlet="tab.component; injector: tabInjector"></ng-container>`}),__metadata("design:paramtypes",[d.Injector])],t.TabComponent);t.FundamentalsModule=class FundamentalsModule{};t.FundamentalsModule=__decorate([d.NgModule({imports:[I.ModalModule,I.ButtonModule,E.BrowserAnimationsModule,w.FormsModule,I.PopoverModule,I.MenuModule,I.AlertModule,I.PaginationModule],exports:[I.ModalModule,I.ButtonModule,I.FormModule,I.PopoverModule,I.MenuModule,I.AlertModule,I.PaginationModule]})],t.FundamentalsModule);function $translateStaticFilesLoader(e,t){"ngInject";return o=>e.when(t.get(o.key))}o(938);t.TranslationServiceModule=class TranslationServiceModule{};t.TranslationServiceModule=__decorate([SeModule({imports:["pascalprecht.translate","legacySmarteditCommonsModule"],providers:[$translateStaticFilesLoader],config:["$translateProvider",e=>{"ngInject";e.useStaticFilesLoader({prefix:Re+"/",suffix:""});e.preferredLanguage(Te);e.useSanitizeValueStrategy("escapeParameters")}],initialize:["$translate","browserService","operationContextService","crossFrameEventService","storageService","SWITCH_LANGUAGE_EVENT","OPERATION_CONTEXT",(e,t,o,n,s,a,r)=>{"ngInject";s.getValueFromLocalStorage("SELECTED_LANGUAGE",false).then((e=>e?e.isoCode:t.getBrowserLocale()),(()=>t.getBrowserLocale())).then((t=>{e.use(t)}));o.register(Re,r.TOOLING);n.subscribe(a,((t,o)=>{e.use(o.isoCode)}))}]})],t.TranslationServiceModule);window.__smartedit__.addDecoratorPayload("Component","TooltipComponent",{selector:"se-tooltip",template:`\n        <fd-popover\n            [triggers]="triggers"\n            [placement]="placement"\n            [appendTo]="appendTo"\n            [noArrow]="!isChevronVisible"\n            [additionalClasses]="['se-tooltip-container']"\n            [ngClass]="additionalClasses"\n            class="se-tooltip"\n        >\n            <fd-popover-control>\n                <ng-content select="[se-tooltip-trigger]"></ng-content>\n            </fd-popover-control>\n            <fd-popover-body>\n                <div class="popover se-popover">\n                    <h3 class="se-popover__title" *ngIf="title">{{ title | translate }}</h3>\n\n                    <div class="se-popover__content">\n                        <ng-content select="[se-tooltip-body]"></ng-content>\n                    </div>\n                </div>\n            </fd-popover-body>\n        </fd-popover>\n    `});let To=class TooltipComponent{ngAfterViewInit(){this.popoverIsOpenChangeSubscription=this.popover.isOpenChange.subscribe((e=>{if(e){setTimeout((()=>this.popover.updatePopover()))}}))}ngOnDestroy(){this.popoverIsOpenChangeSubscription.unsubscribe()}};__decorate([d.Input(),__metadata("design:type",Array)],To.prototype,"triggers",void 0);__decorate([d.Input(),__metadata("design:type",String)],To.prototype,"placement",void 0);__decorate([d.Input(),__metadata("design:type",String)],To.prototype,"title",void 0);__decorate([d.Input(),__metadata("design:type",Object)],To.prototype,"appendTo",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],To.prototype,"isChevronVisible",void 0);__decorate([d.Input(),__metadata("design:type",Array)],To.prototype,"additionalClasses",void 0);__decorate([d.ViewChild(I.PopoverComponent,{static:false}),__metadata("design:type",I.PopoverComponent)],To.prototype,"popover",void 0);To=__decorate([SeDowngradeComponent(),d.Component({selector:"se-tooltip",template:`\n        <fd-popover\n            [triggers]="triggers"\n            [placement]="placement"\n            [appendTo]="appendTo"\n            [noArrow]="!isChevronVisible"\n            [additionalClasses]="['se-tooltip-container']"\n            [ngClass]="additionalClasses"\n            class="se-tooltip"\n        >\n            <fd-popover-control>\n                <ng-content select="[se-tooltip-trigger]"></ng-content>\n            </fd-popover-control>\n            <fd-popover-body>\n                <div class="popover se-popover">\n                    <h3 class="se-popover__title" *ngIf="title">{{ title | translate }}</h3>\n\n                    <div class="se-popover__content">\n                        <ng-content select="[se-tooltip-body]"></ng-content>\n                    </div>\n                </div>\n            </fd-popover-body>\n        </fd-popover>\n    `})],To);t.TooltipModule=class TooltipModule{};t.TooltipModule=__decorate([d.NgModule({imports:[f.CommonModule,t.FundamentalsModule,s.TranslationModule.forChild()],declarations:[To],entryComponents:[To],exports:[To]})],t.TooltipModule);t.TabsModule=class TabsModule{};t.TabsModule=__decorate([d.NgModule({imports:[f.CommonModule,t.CompileHtmlModule,s.SelectModule,t.TooltipModule,s.TranslationModule.forChild()],declarations:[t.TabsComponent,t.TabComponent],entryComponents:[t.TabsComponent,t.TabComponent],exports:[t.TabsComponent,t.TabComponent]})],t.TabsModule);const Po=new d.InjectionToken("DATA_TABLE_COMPONENT_DATA");window.__smartedit__.addDecoratorPayload("Component","DataTableComponent",{selector:"se-data-table",styles:[`.sap-icon--sort-descending{float:right}.sap-icon--sort-ascending{float:right}`],template:`<table class="se-paged-list-table fd-table"><thead><tr><th *ngFor="let column of columns" (click)="sortColumn(column)" [ngStyle]="{'width.': columnWidth + '%'}" [ngClass]="'se-paged-list__header-'+column.property" class="se-paged-list__header">{{ column.i18n | translate }} <span class="se-data-table__sort" *ngIf="visibleSortingHeader === column.property" [ngClass]="{ \n                        'sap-icon--sort-descending': headersSortingState[column.property],\n                        'sap-icon--sort-ascending': !headersSortingState[column.property] }"></span></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of items" class="se-paged-list-item"><td *ngFor="let column of columns" [ngClass]="'se-paged-list-item-'+column.property"><se-data-table-renderer [column]="column" [item]="item"></se-data-table-renderer></td></tr></tbody></table>`});t.DataTableComponent=class DataTableComponent{constructor(){this.onSortColumn=new d.EventEmitter;this.headersSortingState={}}ngOnInit(){this._configure()}sortColumn(e){if(e.sortable){this.columnToggleReversed=!this.columnToggleReversed;this.headersSortingState[e.property]=this.columnToggleReversed;this.visibleSortingHeader=e.property;this.currentPage=1;this.internalSortBy=e.property;this.columnSortMode=this.columnToggleReversed?t.SortDirections.Descending:t.SortDirections.Ascending;this.onSortColumn.emit({$columnKey:e,$columnSortMode:this.columnSortMode})}}_configure(){const e=100;this.columnWidth=e/this.columns.length;this.columnToggleReversed=this.sortStatus.reversed;this.columnSortMode=this.sortStatus.reversed?t.SortDirections.Descending:t.SortDirections.Ascending;this.headersSortingState[this.sortStatus.internalSortBy]=this.config.reversed;this.visibleSortingHeader=this.sortStatus.internalSortBy}};__decorate([d.Input(),__metadata("design:type",Array)],t.DataTableComponent.prototype,"columns",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.DataTableComponent.prototype,"config",void 0);__decorate([d.Input(),__metadata("design:type",Array)],t.DataTableComponent.prototype,"items",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.DataTableComponent.prototype,"sortStatus",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.DataTableComponent.prototype,"onSortColumn",void 0);t.DataTableComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-data-table",styles:[`.sap-icon--sort-descending{float:right}.sap-icon--sort-ascending{float:right}`],template:`<table class="se-paged-list-table fd-table"><thead><tr><th *ngFor="let column of columns" (click)="sortColumn(column)" [ngStyle]="{'width.': columnWidth + '%'}" [ngClass]="'se-paged-list__header-'+column.property" class="se-paged-list__header">{{ column.i18n | translate }} <span class="se-data-table__sort" *ngIf="visibleSortingHeader === column.property" [ngClass]="{ \n                        'sap-icon--sort-descending': headersSortingState[column.property],\n                        'sap-icon--sort-ascending': !headersSortingState[column.property] }"></span></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of items" class="se-paged-list-item"><td *ngFor="let column of columns" [ngClass]="'se-paged-list-item-'+column.property"><se-data-table-renderer [column]="column" [item]="item"></se-data-table-renderer></td></tr></tbody></table>`})],t.DataTableComponent);window.__smartedit__.addDecoratorPayload("Component","DataTableRendererComponent",{selector:"se-data-table-renderer",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`\n        <div *ngIf="column.component; else cellText">\n            <ng-container\n                *ngComponentOutlet="column.component; injector: componentInjector"\n            ></ng-container>\n        </div>\n        <ng-template #cellText\n            ><span>{{ item[column.property] }}</span></ng-template\n        >\n    `});let Ao=class DataTableRendererComponent{constructor(e){this.injector=e}ngOnChanges(e){const t=e.column;if(t===null||t===void 0?void 0:t.currentValue.component){this.createInjector()}}createInjector(){const{column:e,item:t}=this;this.componentInjector=d.Injector.create({providers:[{provide:Po,useValue:{column:e,item:t}}],parent:this.injector})}};Ao.$inject=["injector"];__decorate([d.Input(),__metadata("design:type",Object)],Ao.prototype,"column",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Ao.prototype,"item",void 0);Ao=__decorate([SeDowngradeComponent(),d.Component({selector:"se-data-table-renderer",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`\n        <div *ngIf="column.component; else cellText">\n            <ng-container\n                *ngComponentOutlet="column.component; injector: componentInjector"\n            ></ng-container>\n        </div>\n        <ng-template #cellText\n            ><span>{{ item[column.property] }}</span></ng-template\n        >\n    `}),__metadata("design:paramtypes",[d.Injector])],Ao);t.ResizeObserverDirective=class ResizeObserverDirective{constructor(e){this.elementRef=e;this.onResize=new d.EventEmitter}ngOnInit(){this.startWatching()}ngOnDestroy(){this.observer.disconnect()}startWatching(){this.observer=new U["default"]((e=>this.internalOnResize(e)));this.observer.observe(this.elementRef.nativeElement)}internalOnResize(e){this.onResize.emit()}};__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.ResizeObserverDirective.prototype,"onResize",void 0);t.ResizeObserverDirective=__decorate([d.Directive({selector:"[seResizeObserver]"}),__metadata("design:paramtypes",[d.ElementRef])],t.ResizeObserverDirective);t.ResizeObserverModule=class ResizeObserverModule{};t.ResizeObserverModule=__decorate([d.NgModule({declarations:[t.ResizeObserverDirective],exports:[t.ResizeObserverDirective]})],t.ResizeObserverModule);class HasOperationPermissionBaseDirective{constructor(e,t,o){this.systemEventService=e;this.permissionService=t;this.logService=o}ngOnInit(){this.unregisterHandler=this.systemEventService.subscribe(s.EVENTS.PERMISSION_CACHE_CLEANED,this.refreshIsPermissionGranted.bind(this))}ngOnDestroy(){this.unregisterHandler()}ngOnChanges(e){if(e.hasOperationPermission&&e.hasOperationPermission.currentValue){this.permission=e.hasOperationPermission.currentValue;this.refreshIsPermissionGranted()}}set isPermissionGrantedHandler(e){this._isPermissionGrantedHandler=e}refreshIsPermissionGranted(){this.isPermissionGranted(this.permission).then((e=>{this._isPermissionGrantedHandler(e)}))}isPermissionGranted(e){return this.permissionService.isPermitted(this.validateAndPreparePermissions(e)).then((e=>e),(e=>{this.logService.error("Failed to retrieve authorization",e);return false})).then((e=>e))}validateAndPreparePermissions(e){if(typeof e!=="string"&&!Array.isArray(e)){throw new Error("Permission should be string or an array of objects")}return typeof e==="string"?this.toPermissions(e):e}toPermissions(e){return[{names:e.split(",")}]}}let Oo=class HasOperationPermissionDirective extends HasOperationPermissionBaseDirective{constructor(e,t,o,n,s,a){super(o,n,s);this.templateRef=e;this.viewContainerRef=t;this.cdr=a;this.hasView=false;this.isPermissionGrantedHandler=this.getIsPermissionGrantedHandler()}ngOnInit(){super.ngOnInit()}ngOnChanges(e){super.ngOnChanges({hasOperationPermission:new d.SimpleChange(e.seHasOperationPermission.previousValue,e.seHasOperationPermission.currentValue,e.seHasOperationPermission.firstChange)})}ngOnDestroy(){super.ngOnDestroy()}getIsPermissionGrantedHandler(){return e=>{this.updateView(e)}}updateView(e){if(e&&!this.hasView){this.viewContainerRef.createEmbeddedView(this.templateRef);this.hasView=true}else if(!e&&this.hasView){this.viewContainerRef.clear()}this.cdr.markForCheck()}};__decorate([d.Input(),__metadata("design:type",Object)],Oo.prototype,"seHasOperationPermission",void 0);Oo=__decorate([d.Directive({selector:"[seHasOperationPermission]"}),__param(3,d.Inject(IPermissionService)),__metadata("design:paramtypes",[d.TemplateRef,d.ViewContainerRef,t.SystemEventService,IPermissionService,s.LogService,d.ChangeDetectorRef])],Oo);t.HasOperationPermissionDirectiveModule=class HasOperationPermissionDirectiveModule{};t.HasOperationPermissionDirectiveModule=__decorate([d.NgModule({declarations:[Oo],exports:[Oo]})],t.HasOperationPermissionDirectiveModule);t.ClickOutsideDirective=class ClickOutsideDirective{constructor(e,t,o){this.document=e;this.host=t;this.iframeClickDetectionService=o;this.clickOutside=new d.EventEmitter;this.id=`clickOutsideIframeClick${ae.generateIdentifier()}`}onDocumentClick(e){if(e===this.host.nativeElement||this.host.nativeElement.contains(e)||this.ignoreNotExistingTarget(e)){return}this.clickOutside.emit()}ngOnInit(){this.iframeClickDetectionService.registerCallback(this.id,(()=>this.onOutsideClick()))}ngOnDestroy(){this.iframeClickDetectionService.removeCallback(this.id)}ignoreNotExistingTarget(e){return!this.document.contains(e)}onOutsideClick(){this.clickOutside.emit()}};__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.ClickOutsideDirective.prototype,"clickOutside",void 0);__decorate([d.HostListener("document:click",["$event.target"]),__metadata("design:type",Function),__metadata("design:paramtypes",[HTMLElement]),__metadata("design:returntype",void 0)],t.ClickOutsideDirective.prototype,"onDocumentClick",null);t.ClickOutsideDirective=__decorate([d.Directive({selector:"[seClickOutside]"}),__param(0,d.Inject(f.DOCUMENT)),__metadata("design:paramtypes",[Document,d.ElementRef,IIframeClickDetectionService])],t.ClickOutsideDirective);t.ClickOutsideModule=class ClickOutsideModule{};t.ClickOutsideModule=__decorate([d.NgModule({imports:[f.CommonModule],declarations:[t.ClickOutsideDirective],exports:[t.ClickOutsideDirective]})],t.ClickOutsideModule);t.CustomComponentOutletDirective=class CustomComponentOutletDirective{constructor(e,t){this.elementRef=e;this.renderer=t;this.hasView=false}ngOnChanges(){this.updateView(this.componentName)}updateView(e){if(e&&!this.hasView){this.createView()}else if(!e&&this.hasView){this.removeView()}else if(e&&this.hasView){this.removeView();this.createView()}}createView(){const e=window.__smartedit__.getComponentDecoratorPayload(this.componentName);this.component=this.renderer.createElement(e.selector);this.renderer.appendChild(this.elementRef.nativeElement,this.component);this.hasView=true}removeView(){this.renderer.removeChild(this.elementRef.nativeElement,this.component);this.hasView=false}};__decorate([d.Input("seCustomComponentOutlet"),__metadata("design:type",String)],t.CustomComponentOutletDirective.prototype,"componentName",void 0);t.CustomComponentOutletDirective=__decorate([d.Directive({selector:"[seCustomComponentOutlet]"}),__metadata("design:paramtypes",[d.ElementRef,d.Renderer2])],t.CustomComponentOutletDirective);t.CustomComponentOutletDirectiveModule=class CustomComponentOutletDirectiveModule{};t.CustomComponentOutletDirectiveModule=__decorate([d.NgModule({declarations:[t.CustomComponentOutletDirective],exports:[t.CustomComponentOutletDirective]})],t.CustomComponentOutletDirectiveModule);let xo=class DataTableModule{};xo=__decorate([d.NgModule({imports:[f.CommonModule,s.TranslationModule.forChild(),t.CompileHtmlModule],declarations:[t.DataTableComponent,Ao],entryComponents:[t.DataTableComponent,Ao],exports:[t.DataTableComponent,Ao]})],xo);window.__smartedit__.addDecoratorPayload("Component","DropdownMenuComponent",{selector:"se-dropdown-menu",template:`<fd-popover [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="placement || 'bottom-end'" class="se-dropdown-more-menu"><fd-popover-control><div #toggleMenu><div *ngIf="!useProjectedAnchor; else projectedAnchor;" class="sap-icon--overflow se-dropdown-more-menu__toggle"></div><ng-template #projectedAnchor><ng-content></ng-content></ng-template></div></fd-popover-control><fd-popover-body><fd-menu><ul fd-menu-list class="se-dropdown-menu__list" [ngClass]="additionalClasses"><se-dropdown-menu-item *ngFor="let dropdownItem of clonedDropdownItems" [dropdownItem]="dropdownItem" [selectedItem]="selectedItem"></se-dropdown-menu-item></ul></fd-menu></fd-popover-body></fd-popover>`});t.DropdownMenuComponent=class DropdownMenuComponent{constructor(e){this.cd=e;this.useProjectedAnchor=false;this.isOpen=false;this.additionalClasses=[];this.isOpenChange=new d.EventEmitter}clickHandler(e){if(this.toggleMenuElement.nativeElement.contains(e.target)){e.stopPropagation();this.isOpen=!this.isOpen;this.cd.detectChanges();this.emitIsOpenChange();return}if(this.isOpen){this.isOpen=false;this.cd.detectChanges();this.emitIsOpenChange();return}}ngOnChanges(e){const t=e.dropdownItems;if(t){this.clonedDropdownItems=t.currentValue.map((e=>Object.assign(Object.assign({},e),{condition:e.condition||(()=>true)}))).map((e=>this.setDefaultComponentIfNeeded(e)))}}emitIsOpenChange(){this.isOpenChange.emit(this.isOpen)}setDefaultComponentIfNeeded(e){switch(this.validateDropdownItem(e)){case"callback":return Object.assign(Object.assign({},e),{component:t.DropdownMenuItemDefaultComponent});default:return e}}validateDropdownItem(e){const t=["callback","component"];const o=Object.keys(e);const n=o.filter((e=>t.includes(e)));if(n.length!==1){throw new Error('DropdownMenuComponent.validateDropdownItem - Dropdown Item must contain "callback" or "component"')}const s=n[0];return s}};t.DropdownMenuComponent.$inject=["cd"];__decorate([d.Input(),__metadata("design:type",Array)],t.DropdownMenuComponent.prototype,"dropdownItems",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"selectedItem",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.DropdownMenuComponent.prototype,"placement",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"useProjectedAnchor",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"isOpen",void 0);__decorate([d.Input(),__metadata("design:type",Array)],t.DropdownMenuComponent.prototype,"additionalClasses",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.DropdownMenuComponent.prototype,"isOpenChange",void 0);__decorate([d.ViewChild("toggleMenu",{static:true}),__metadata("design:type",d.ElementRef)],t.DropdownMenuComponent.prototype,"toggleMenuElement",void 0);__decorate([d.HostListener("document:click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[MouseEvent]),__metadata("design:returntype",void 0)],t.DropdownMenuComponent.prototype,"clickHandler",null);t.DropdownMenuComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-dropdown-menu",template:`<fd-popover [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="placement || 'bottom-end'" class="se-dropdown-more-menu"><fd-popover-control><div #toggleMenu><div *ngIf="!useProjectedAnchor; else projectedAnchor;" class="sap-icon--overflow se-dropdown-more-menu__toggle"></div><ng-template #projectedAnchor><ng-content></ng-content></ng-template></div></fd-popover-control><fd-popover-body><fd-menu><ul fd-menu-list class="se-dropdown-menu__list" [ngClass]="additionalClasses"><se-dropdown-menu-item *ngFor="let dropdownItem of clonedDropdownItems" [dropdownItem]="dropdownItem" [selectedItem]="selectedItem"></se-dropdown-menu-item></ul></fd-menu></fd-popover-body></fd-popover>`}),__metadata("design:paramtypes",[d.ChangeDetectorRef])],t.DropdownMenuComponent);window.__smartedit__.addDecoratorPayload("Component","DropdownMenuItemComponent",{selector:"se-dropdown-menu-item",template:`<li *ngIf="dropdownItem.condition(selectedItem)" class="se-dropdown-menu__item-wrapper" [ngClass]="dropdownItem.customCss"><ng-container *ngComponentOutlet="dropdownItem.component; injector: dropdownItemInjector"></ng-container></li>`});let Do=class DropdownMenuItemComponent{constructor(e){this.injector=e}ngOnInit(){this.createDropdownItemInjector()}createDropdownItemInjector(){const{selectedItem:e}=this;this.dropdownItemInjector=d.Injector.create({parent:this.injector,providers:[{provide:So,useValue:{dropdownItem:this.dropdownItem,selectedItem:e}}]})}};__decorate([d.Input(),__metadata("design:type",Object)],Do.prototype,"dropdownItem",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Do.prototype,"selectedItem",void 0);Do=__decorate([d.Component({selector:"se-dropdown-menu-item",template:`<li *ngIf="dropdownItem.condition(selectedItem)" class="se-dropdown-menu__item-wrapper" [ngClass]="dropdownItem.customCss"><ng-container *ngComponentOutlet="dropdownItem.component; injector: dropdownItemInjector"></ng-container></li>`}),__metadata("design:paramtypes",[d.Injector])],Do);t.DropdownMenuModule=class DropdownMenuModule{};t.DropdownMenuModule=__decorate([d.NgModule({imports:[f.CommonModule,t.FundamentalsModule,t.CompileHtmlModule,s.TranslationModule.forChild()],declarations:[t.DropdownMenuComponent,Do,t.DropdownMenuItemDefaultComponent],entryComponents:[t.DropdownMenuComponent,t.DropdownMenuItemDefaultComponent],exports:[t.DropdownMenuComponent,Do]})],t.DropdownMenuModule);window.__smartedit__.addDecoratorPayload("Component","DynamicPagedListComponent",{selector:"se-dynamic-paged-list",template:`<div *ngIf="ready" class="se-dynamic-paged-list"><div class="fd-panel__body fd-panel__body--bleed"><se-data-table [columns]="columns" [config]="config" [items]="items" [sortStatus]="sortStatus" (onSortColumn)="orderByColumn($event)"></se-data-table></div><div class="fd-panel__footer"><se-pagination *ngIf="!!items.length" class="se-dynamic-list__pagination" [totalItems]="totalItems" [itemsPerPage]="config.itemsPerPage" [currentPage]="currentPage" (onChange)="onCurrentPageChange($event)"></se-pagination><span class="se-paged-list__page-count-wrapper se-paged-list__page-count-wrapper--footer"><span class="span-page-list__page-count-text">{{'se.pagelist.countsearchresult' | translate}} </span><span class="se-page-list__page-count">({{ totalItems }})</span></span></div></div><se-spinner [isSpinning]="!ready"></se-spinner>`});t.DynamicPagedListComponent=class DynamicPagedListComponent{constructor(e,t,o){this.logService=e;this.restServiceFactory=t;this.cdr=o;this.getApi=new d.EventEmitter;this.onItemsUpdate=new d.EventEmitter;this.api={reloadItems:()=>this.loadItems()}}ngOnInit(){this._validateInput();this.ready=false;this.totalItems=0;this.currentPage=1;this.columnSortMode=this.config.reversed?t.SortDirections.Descending:t.SortDirections.Ascending;this.internalSortBy=r.cloneDeep(this.config.sortBy);this.oldMask=this.mask;this.columns=[];this.sortStatus={internalSortBy:this.internalSortBy,reversed:this.config.reversed,currentPage:this.currentPage};this._buildColumnData();this.loadItems();this.getApi.emit(this.api)}ngOnChanges(e){const t=e.mask;if(!!t&&!t.firstChange&&this.oldMask!==this.mask){this.oldMask=this.mask;this.currentPage=1;this.loadItems()}}orderByColumn(e){this.internalSortBy=e.$columnKey.property;this.columnSortMode=e.$columnSortMode;this.config.reversed=this.columnSortMode===t.SortDirections.Descending;this.sortStatus.internalSortBy=this.internalSortBy;this.sortStatus.reversed=this.config.reversed;if(e.$columnKey.sortable){this.currentPage=1;this.sortStatus.currentPage=1;this.loadItems()}}loadItems(){this.ready=false;const e=Object.assign(Object.assign({},this.config.queryParams||{}),{currentPage:this.currentPage-1,mask:this.mask,pageSize:this.config.itemsPerPage,sort:`${this.internalSortBy}:${this.columnSortMode}`});return this.restServiceFactory.get(this.config.uri).page(e).then((e=>{this.items=e.results;if(this.items.length===0){this.logService.warn("PagedList: No items returned to display")}this.totalItems=e.pagination.totalCount;this.currentPage=parseInt(String(e.pagination.page),10)+1;this.ready=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}this.onItemsUpdate.emit(e);return e}))}onCurrentPageChange(e){if(e===this.currentPage){return}this.currentPage=e;this.loadItems()}_validateInput(){if(!this.config){throw new Error("config object is required")}if(!(this.config.keys instanceof Array)){throw new Error("keys must be an array")}if(this.config.keys.length<1){throw new Error("dynamic paged list requires at least one key")}if(!this.config.uri){throw new Error("dynamic paged list requires a uri to fetch the list of items")}}_buildColumnData(){this.columns=this.config.keys.map((e=>Object.assign({},e)))}};t.DynamicPagedListComponent.$inject=["logService","restServiceFactory","cdr"];__decorate([d.Input(),__metadata("design:type",Object)],t.DynamicPagedListComponent.prototype,"config",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.DynamicPagedListComponent.prototype,"mask",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.DynamicPagedListComponent.prototype,"getApi",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.DynamicPagedListComponent.prototype,"onItemsUpdate",void 0);t.DynamicPagedListComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-dynamic-paged-list",template:`<div *ngIf="ready" class="se-dynamic-paged-list"><div class="fd-panel__body fd-panel__body--bleed"><se-data-table [columns]="columns" [config]="config" [items]="items" [sortStatus]="sortStatus" (onSortColumn)="orderByColumn($event)"></se-data-table></div><div class="fd-panel__footer"><se-pagination *ngIf="!!items.length" class="se-dynamic-list__pagination" [totalItems]="totalItems" [itemsPerPage]="config.itemsPerPage" [currentPage]="currentPage" (onChange)="onCurrentPageChange($event)"></se-pagination><span class="se-paged-list__page-count-wrapper se-paged-list__page-count-wrapper--footer"><span class="span-page-list__page-count-text">{{'se.pagelist.countsearchresult' | translate}} </span><span class="se-page-list__page-count">({{ totalItems }})</span></span></div></div><se-spinner [isSpinning]="!ready"></se-spinner>`}),__metadata("design:paramtypes",[s.LogService,s.RestServiceFactory,d.ChangeDetectorRef])],t.DynamicPagedListComponent);window.__smartedit__.addDecoratorPayload("Component","PaginationComponent",{selector:"se-pagination",template:`<fd-pagination class="se-pagination" [displayTotalItems]="displayTotalItems" [totalItems]="totalItems" [itemsPerPage]="totalItems === 1 ? 1 : itemsPerPage" [currentPage]="currentPage" (pageChangeStart)="onPageChanged($event)" nextLabel="&rsaquo; " previousLabel="&lsaquo; "></fd-pagination>`});t.PaginationComponent=class PaginationComponent{constructor(){this.displayTotalItems=false;this.onChange=new d.EventEmitter}onPageChanged(e){this.currentPage=e;this.onChange.emit(e)}};__decorate([d.Input(),__metadata("design:type",Number)],t.PaginationComponent.prototype,"totalItems",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.PaginationComponent.prototype,"displayTotalItems",void 0);__decorate([d.Input(),__metadata("design:type",Number)],t.PaginationComponent.prototype,"itemsPerPage",void 0);__decorate([d.Input(),__metadata("design:type",Number)],t.PaginationComponent.prototype,"currentPage",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.PaginationComponent.prototype,"onChange",void 0);t.PaginationComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-pagination",template:`<fd-pagination class="se-pagination" [displayTotalItems]="displayTotalItems" [totalItems]="totalItems" [itemsPerPage]="totalItems === 1 ? 1 : itemsPerPage" [currentPage]="currentPage" (pageChangeStart)="onPageChanged($event)" nextLabel="&rsaquo; " previousLabel="&lsaquo; "></fd-pagination>`})],t.PaginationComponent);t.PaginationModule=class PaginationModule{};t.PaginationModule=__decorate([d.NgModule({imports:[t.FundamentalsModule],declarations:[t.PaginationComponent],exports:[t.PaginationComponent]})],t.PaginationModule);window.__smartedit__.addDecoratorPayload("Component","SpinnerComponent",{selector:"se-spinner",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`\n        <div\n            *ngIf="isSpinning"\n            class="se-spinner panel-body"\n            [ngClass]="{ 'se-spinner--fluid': isFluid }"\n        >\n            <div class="spinner">\n                <div class="spinner-container spinner-container1">\n                    <div class="spinner-circle1"></div>\n                    <div class="spinner-circle2"></div>\n                    <div class="spinner-circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container spinner-container2">\n                    <div class="spinner-circle1"></div>\n                    <div class="spinner-circle2"></div>\n                    <div class="spinner-circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container spinner-container3">\n                    <div class="spinner-circle1"></div>\n                    <div class="spinner-circle2"></div>\n                    <div class="spinner-circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n            </div>\n        </div>\n    `});t.SpinnerComponent=class SpinnerComponent{constructor(){this.isFluid=true}};__decorate([d.Input(),__metadata("design:type",Boolean)],t.SpinnerComponent.prototype,"isSpinning",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SpinnerComponent.prototype,"isFluid",void 0);t.SpinnerComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-spinner",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`\n        <div\n            *ngIf="isSpinning"\n            class="se-spinner panel-body"\n            [ngClass]="{ 'se-spinner--fluid': isFluid }"\n        >\n            <div class="spinner">\n                <div class="spinner-container spinner-container1">\n                    <div class="spinner-circle1"></div>\n                    <div class="spinner-circle2"></div>\n                    <div class="spinner-circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container spinner-container2">\n                    <div class="spinner-circle1"></div>\n                    <div class="spinner-circle2"></div>\n                    <div class="spinner-circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n                <div class="spinner-container spinner-container3">\n                    <div class="spinner-circle1"></div>\n                    <div class="spinner-circle2"></div>\n                    <div class="spinner-circle3"></div>\n                    <div class="circle4"></div>\n                </div>\n            </div>\n        </div>\n    `})],t.SpinnerComponent);t.SpinnerModule=class SpinnerModule{};t.SpinnerModule=__decorate([d.NgModule({imports:[f.CommonModule],declarations:[t.SpinnerComponent],entryComponents:[t.SpinnerComponent],exports:[t.SpinnerComponent]})],t.SpinnerModule);t.DynamicPagedListModule=class DynamicPagedListModule{};t.DynamicPagedListModule=__decorate([d.NgModule({imports:[f.CommonModule,t.PaginationModule,xo,s.TranslationModule.forChild(),t.SpinnerModule],declarations:[t.DynamicPagedListComponent],entryComponents:[t.DynamicPagedListComponent],exports:[t.DynamicPagedListComponent]})],t.DynamicPagedListModule);window.__smartedit__.addDecoratorPayload("Component","InfiniteScrollingComponent",{selector:"se-infinite-scrolling",template:`<div #container class="se-infinite-scrolling__container" [ngClass]="dropDownContainerClass" fdInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div class="se-infinite-scrolling__holder" [ngClass]="dropDownClass"><div #content><ng-content></ng-content></div><div class="spinner-container"><se-spinner [isSpinning]="isLoading" [isFluid]="false"></se-spinner></div></div></div>`,styles:[`se-infinite-scrolling.se-infinite-scrolling--narrowed .se-infinite-scrolling__holder{padding:0 20px}se-infinite-scrolling .se-infinite-scrolling__container{overflow-y:auto;max-height:200px}se-infinite-scrolling .se-infinite-scrolling__holder{overflow-y:hidden}`],encapsulation:d.ViewEncapsulation.None});t.InfiniteScrollingComponent=class InfiniteScrollingComponent{constructor(e,t){this.discardablePromiseUtils=e;this.cdr=t;this.distance=80;this.itemsChange=new d.EventEmitter;this.containerId=ae.generateIdentifier();this.initiated=false;this.isLoading=false;this.internalItemsSelected=[]}ngOnInit(){this.init()}ngOnChanges(){this.context=this.context||this;this.init()}ngAfterViewInit(){this.initContentResizeObserver()}ngOnDestroy(){this.discardablePromiseUtils.clear(this.containerId);this.contentResizeObserver.disconnect()}nextPage(){if(this.pagingDisabled){return}this.pagingDisabled=true;this.currentPage=this.currentPage+1;this.mask=this.mask||"";this.isLoading=true;this.internalItemsSelected=this.context.selected||[];this.discardablePromiseUtils.apply(this.containerId,this.fetchPage(this.mask,this.pageSize,this.currentPage,this.internalItemsSelected),(e=>{e.results=e.results||[];e.results.forEach((e=>{e.technicalUniqueId=ae.encode(e)}));const t=r.differenceBy(e.results,this.context.items,"technicalUniqueId");if(t.length>0){this.context.items=[...this.context.items,...t||[]]}this.itemsChange.emit(this.context.items);this.pagingDisabled=this.isPagingDisabled(e);this.tryToLoadNextPage(e);if(this.pagingDisabled){this.isLoading=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}}))}scrollToTop(){if(this.containerElement){this.containerElement.nativeElement.scrollTop=0}}scrollToBottom(){if(this.containerElement){this.containerElement.nativeElement.scrollTop=this.containerElement.nativeElement.scrollHeight}}init(){const e=this.initiated;this.context.items=[];this.currentPage=-1;this.pagingDisabled=false;this.initiated=true;if(e){this.scrollToTop();this.nextPage()}}initContentResizeObserver(){this.contentResizeObserver=new U["default"]((e=>{const{contentRect:t}=e[0];const o=t.height===0;if(!this.pagingDisabled&&this.isLoading&&!o){if(this.shouldLoadNextPage()){this.nextPage()}else{this.isLoading=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}this.contentResizeObserver.disconnect()}}));this.contentResizeObserver.observe(this.contentElement.nativeElement)}shouldLoadNextPage(){const e=this.contentElement.nativeElement.offsetHeight;const t=this.containerElement.nativeElement.offsetHeight;return e<=t}isPagingDisabled(e){return e.pagination===undefined||e.results.length===0||e.pagination&&this.context.items.length===e.pagination.totalCount||e.pagination&&e.pagination.totalPages===e.pagination.page+1}tryToLoadNextPage(e){if(e.pagination===undefined){return}if(this.context.items.length===0&&e.pagination.page<e.pagination.totalPages||!this.pagingDisabled&&e.pagination.count<this.pageSize&&this.containerElement.nativeElement.offsetHeight!==0&&this.shouldLoadNextPage()){this.pagingDisabled=false;this.nextPage()}}};t.InfiniteScrollingComponent.$inject=["discardablePromiseUtils","cdr"];__decorate([d.Input(),__metadata("design:type",Number)],t.InfiniteScrollingComponent.prototype,"pageSize",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.InfiniteScrollingComponent.prototype,"mask",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.InfiniteScrollingComponent.prototype,"dropDownContainerClass",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.InfiniteScrollingComponent.prototype,"dropDownClass",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.InfiniteScrollingComponent.prototype,"distance",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.InfiniteScrollingComponent.prototype,"context",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.InfiniteScrollingComponent.prototype,"fetchPage",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.InfiniteScrollingComponent.prototype,"itemsChange",void 0);__decorate([d.ViewChild("container",{static:false}),__metadata("design:type",d.ElementRef)],t.InfiniteScrollingComponent.prototype,"containerElement",void 0);__decorate([d.ViewChild("content",{static:false}),__metadata("design:type",d.ElementRef)],t.InfiniteScrollingComponent.prototype,"contentElement",void 0);t.InfiniteScrollingComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-infinite-scrolling",template:`<div #container class="se-infinite-scrolling__container" [ngClass]="dropDownContainerClass" fdInfiniteScroll (onScrollAction)="nextPage()" [scrollPercent]="distance" *ngIf="initiated"><div class="se-infinite-scrolling__holder" [ngClass]="dropDownClass"><div #content><ng-content></ng-content></div><div class="spinner-container"><se-spinner [isSpinning]="isLoading" [isFluid]="false"></se-spinner></div></div></div>`,styles:[`se-infinite-scrolling.se-infinite-scrolling--narrowed .se-infinite-scrolling__holder{padding:0 20px}se-infinite-scrolling .se-infinite-scrolling__container{overflow-y:auto;max-height:200px}se-infinite-scrolling .se-infinite-scrolling__holder{overflow-y:hidden}`],encapsulation:d.ViewEncapsulation.None}),__metadata("design:paramtypes",[t.DiscardablePromiseUtils,d.ChangeDetectorRef])],t.InfiniteScrollingComponent);t.InfiniteScrollingModule=class InfiniteScrollingModule{};t.InfiniteScrollingModule=__decorate([d.NgModule({imports:[I.InfiniteScrollModule,t.SpinnerModule,f.CommonModule],declarations:[t.InfiniteScrollingComponent],entryComponents:[t.InfiniteScrollingComponent],exports:[t.InfiniteScrollingComponent]})],t.InfiniteScrollingModule);function getLocalizedFilterFn(e){return t=>{if(typeof t==="string"){return t}else if(t){return t[e]||t[Object.keys(t)[0]]}else{return undefined}}}t.L10nPipe=class L10nPipe{constructor(e){this.l10nService=e}transform(e){return this.l10nService.languageSwitch$.pipe(b.startWith(null),b.pairwise(),b.tap((([e,t])=>{if(e!==t){this.filterFn=getLocalizedFilterFn(t)}})),b.map((()=>this.filterFn(e))))}};t.L10nPipe=__decorate([d.Pipe({name:"seL10n"}),__metadata("design:paramtypes",[t.L10nService])],t.L10nPipe);t.L10nPipeModule=class L10nPipeModule{};t.L10nPipeModule=__decorate([d.NgModule({declarations:[t.L10nPipe],exports:[t.L10nPipe],providers:[t.L10nPipe,se.initialize((e=>e.resolveLanguage()),[t.L10nService])]})],t.L10nPipeModule);class TreeNestedDataSource{constructor(){this._data=new v.BehaviorSubject([])}get(){return this._data.asObservable()}set(e){this._data.next(e)}}class TreeNodeItem{constructor(e){this.position=0;this.nodes=[];this.hasChildren=e.hasChildren;this.name=e.name;this.title=e.title;this.parentUid=e.parentUid;this.position=e.position;this.itemType=e.itemType;this.uid=e.uid;this.uuid=e.uuid;this.level=e.level;this.nodes=[]}setPosition(e){this.position=e;return this}setMouseHovered(e){this.mouseHovered=e;return this}setInitiated(e){this.initiated=e;return this}setLevel(e){this.level=e;return this}addNode(e){this.nodes=[...this.nodes,e.setParent(this)].map(((e,t)=>e.setPosition(t).setLevel(this.level+1)));this.updateHasChildren();return this}addNodes(e){this.nodes=[...this.nodes,...e.map((e=>e.setParent(this)))].map(((e,t)=>e.setPosition(t).setLevel(this.level+1)));this.updateHasChildren();return this}removeAllNodes(){this.nodes=[];this.updateHasChildren();return this}removeNode(e){this.nodes=this.nodes.filter((t=>t.uid!==e.uid)).map(((e,t)=>e.setPosition(t)));this.updateHasChildren();return this}setParent(e){this.parent=e;this.parentUid=e.uid;return this}toggle(){this.isExpanded=!this.isExpanded;return this}collapse(){this.isExpanded=false;return this}expand(){this.isExpanded=true;return this}collapseAll(){this.nodes.forEach((e=>this.collapseRecursively(e)))}expandAll(){this.nodes.forEach((e=>this.expandRecursively(e)))}collapseRecursively(e){e.collapse().nodes.forEach((e=>this.collapseRecursively(e)))}expandRecursively(e){e.expand().nodes.forEach((e=>this.expandRecursively(e)))}updateHasChildren(){this.hasChildren=!!this.nodes.length}}class NavigationNodeItem extends TreeNodeItem{constructor(e){super(e);this.entries=e.entries}}var Ro;(function(e){e["CMSNavigationNode"]="CMSNavigationNode"})(Ro||(Ro={}));let ko=class TreeNodeItemFactory{get(e){switch(e.itemType){case Ro.CMSNavigationNode:return new NavigationNodeItem(e);default:return new TreeNodeItem(e)}}};ko=__decorate([SeDowngradeService()],ko);t.TreeService=class TreeService{constructor(e,t){this.restServiceFactory=e;this.treeNodeItemFactory=t;this.dataSource=new TreeNestedDataSource;this.$onTreeUpdated=new v.BehaviorSubject(false)}onTreeUpdated(){return this.$onTreeUpdated.pipe(b.filter((e=>!!e)))}init(e,t){if(e){this.nodesRestService=this.restServiceFactory.get(e)}this.setRoot(t)}rearrange(e,t,o){const n=t.nodes.filter((t=>t.uid!==e.uid));const s=[...n.slice(0,o),e,...n.slice(o,n.length)];e.parent.removeNode(e);t.removeAllNodes().addNodes(s);this.update()}fetchChildren(e){return __awaiter(this,void 0,void 0,(function*(){const t=e||this.root;if(t.initiated){this.update();return Promise.resolve(t.nodes)}else{const e=yield this.nodesRestService.get({parentUid:t.uid});const o=(hi.getDataFromResponse(e)||[]).map((e=>this.treeNodeItemFactory.get(e)));t.removeAllNodes().addNodes(o).setInitiated(true);this.update();return o}}))}toggle(e){return __awaiter(this,void 0,void 0,(function*(){e.toggle();return this.fetchChildren(e)}))}newChild(e){return __awaiter(this,void 0,void 0,(function*(){const t=e||this.root;const o=yield this.saveNode(t);if(!t.isExpanded){this.toggle(t)}else{const e=t.nodes.find((e=>e.uid===o.uid));if(!e){t.addNode(this.treeNodeItemFactory.get(o));this.update()}}}))}newSibling(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.saveNode(e.parent);e.parent.addNode(this.treeNodeItemFactory.get(t));this.update()}))}removeNode(e){return __awaiter(this,void 0,void 0,(function*(){yield this.nodesRestService.remove({identifier:e.uid});e.parent.removeNode(e);this.update()}))}update(){this.dataSource.set(null);this.dataSource.set(this.root.nodes);this.$onTreeUpdated.next(true)}expandAll(){this.root.expandAll();this.update()}collapseAll(){this.root.collapseAll();this.update()}getNodePositionById(e){return this.getNodeById(e).position}getNodeById(e,t){if(e===this.root.uid){return this.root}const o=t||this.root.nodes;for(const t of o){if(t.uid===e){return t}if(t.hasChildren){t.nodes=t.nodes||[];return this.getNodeById(e,t.nodes)}}return null}saveNode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.nodesRestService.save({parentUid:e.uid,name:(e.name?e.name:e.uid)+e.nodes.length});return t}))}setRoot(e){this.root=this.treeNodeItemFactory.get({uid:e,name:"root",level:0})}};t.TreeService.$inject=["restServiceFactory","treeNodeItemFactory"];t.TreeService=__decorate([d.Injectable(),__metadata("design:paramtypes",[s.RestServiceFactory,ko])],t.TreeService);class TreeDragAndDropEvent{constructor(e,t,o,n,s){this.sourceNode=e;this.destinationNodes=t;this.sourceParentNode=o;this.destinationParentNode=n;this.position=s}}const Mo=new d.InjectionToken("TREE_NODE");let No=class TreeDragAndDropService{constructor(e,t,o){this.confirmationModalService=e;this.alertService=t;this.treeService=o}init(e){this.config=e;this.isDragEnabled=!!e&&(!!e.onDropCallback||!!e.beforeDropCallback||!!e.allowDropCallback)}handleDrop(e){if(!this.config||!e.isPointerOverContainer){return Promise.resolve()}if(!this.allowDrop(e)){return Promise.resolve()}return this.beforeDrop(e).then((t=>{if(t===false){return}this.onDrop(e);this.rearrangeNodes(e)}))}rearrangeNodes(e){this.treeService.rearrange(e.item.data,e.container.data[0].parent,e.currentIndex)}onDrop(e){if(!this.config.onDropCallback){return}const t=new TreeDragAndDropEvent(e.item.data,e.container.data,e.item.data.parent,e.container.data[0].parent,e.currentIndex);return this.config.onDropCallback(t)}allowDrop(e){if(!this.config.allowDropCallback){return true}return this.config.allowDropCallback(new TreeDragAndDropEvent(e.item.data,e.container.data,e.item.data.parent,e.container.data[0].parent,e.currentIndex))}beforeDrop(e){if(!this.config.beforeDropCallback){return Promise.resolve()}const t=new TreeDragAndDropEvent(e.item.data,e.container.data,e.item.data.parent,e.container.data[0].parent,e.currentIndex);return this.config.beforeDropCallback(t).then((e=>{if(typeof e==="object"){if(e.confirmDropI18nKey){const t={description:e.confirmDropI18nKey};return this.confirmationModalService.confirm(t)}if(e.rejectDropI18nKey){this.alertService.showDanger({message:e.rejectDropI18nKey});return false}throw new Error("Unexpected return value for beforeDropCallback does not contain confirmDropI18nKey nor rejectDropI18nKey: "+e)}return e}))}};No.$inject=["confirmationModalService","alertService","treeService"];No=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[IConfirmationModalService,s.IAlertService,t.TreeService])],No);window.__smartedit__.addDecoratorPayload("Component","TreeComponent",{selector:"se-tree",providers:[t.TreeService,No,ko],host:{class:"se-tree"},template:`<div class="categoryTable se-tree"><div class="se-tree__body"><div class="desktopLayout"><ol class="se-tree__nodes"><li *ngIf="(this.treeService.dataSource.get() | async).length === 0" class="se-tree__nodes--nodata">{{ 'se.ytree.no.nodes.to.display' | translate }}</li><li class="se-tree__nodes--item"><se-tree-node [source]="this.treeService.dataSource.get() | async"></se-tree-node></li></ol></div></div></div>`});t.TreeComponent=class TreeComponent{constructor(e,t){this.treeService=e;this.treeDragAndDropService=t;this.onTreeUpdated=new d.EventEmitter}ngOnInit(){this.setNodeActions();this.treeService.init(this.nodeUri,this.rootNodeUid);this.treeDragAndDropService.init(this.dragOptions);this.fetchData(this.treeService.root);this.treeService.onTreeUpdated().subscribe((()=>this.onTreeUpdated.emit(this.treeService.root.nodes)))}fetchData(e){return this.treeService.fetchChildren(e)}hasChildren(e){return e.hasChildren}collapseAll(){this.treeService.collapseAll()}expandAll(){this.treeService.expandAll()}remove(e){this.treeService.removeNode(e)}newSibling(e){this.treeService.newSibling(e)}refresh(e){e.setInitiated(false);return this.treeService.fetchChildren(e)}refreshParent(e){this.refresh(e.parent)}newChild(e){return __awaiter(this,void 0,void 0,(function*(){this.treeService.newChild(e)}))}getNodeById(e,t){return this.treeService.getNodeById(e,t)}get dragEnabled(){return this.treeDragAndDropService.isDragEnabled}setNodeActions(){Object.keys(this.nodeActions).forEach((e=>{this[e]=this.nodeActions[e].bind(this,this.treeService);this.nodeActions[e]=this.nodeActions[e].bind(this,this.treeService)}))}};t.TreeComponent.$inject=["treeService","treeDragAndDropService"];__decorate([d.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"nodeTemplateUrl",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],t.TreeComponent.prototype,"nodeComponent",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"nodeUri",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.TreeComponent.prototype,"nodeActions",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"rootNodeUid",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.TreeComponent.prototype,"dragOptions",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.TreeComponent.prototype,"removeDefaultTemplate",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],t.TreeComponent.prototype,"showAsList",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.TreeComponent.prototype,"onTreeUpdated",void 0);t.TreeComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-tree",providers:[t.TreeService,No,ko],host:{class:"se-tree"},template:`<div class="categoryTable se-tree"><div class="se-tree__body"><div class="desktopLayout"><ol class="se-tree__nodes"><li *ngIf="(this.treeService.dataSource.get() | async).length === 0" class="se-tree__nodes--nodata">{{ 'se.ytree.no.nodes.to.display' | translate }}</li><li class="se-tree__nodes--item"><se-tree-node [source]="this.treeService.dataSource.get() | async"></se-tree-node></li></ol></div></div></div>`}),__metadata("design:paramtypes",[t.TreeService,No])],t.TreeComponent);window.__smartedit__.addDecoratorPayload("Component","TreeNodeComponent",{selector:"se-tree-node",template:`<ol class="se-tree-node__ol angular-ui-tree-nodes" cdkDropList (cdkDropListDropped)="onDrop($event)" [cdkDropListData]="source" [cdkDropListDisabled]="isDisabled"><li *ngFor="let node of source" cdkDrag [cdkDragData]="node" class="angular-ui-tree-node se-tree-node__li"><se-tree-node-renderer [node]="node"></se-tree-node-renderer></li></ol>`});let Fo=class TreeNodeComponent{constructor(e){this.treeDragAndDropService=e}get isDisabled(){return!this.treeDragAndDropService.isDragEnabled}onDrop(e){this.treeDragAndDropService.handleDrop(e)}};__decorate([d.Input(),__metadata("design:type",Array)],Fo.prototype,"source",void 0);Fo=__decorate([d.Component({selector:"se-tree-node",template:`<ol class="se-tree-node__ol angular-ui-tree-nodes" cdkDropList (cdkDropListDropped)="onDrop($event)" [cdkDropListData]="source" [cdkDropListDisabled]="isDisabled"><li *ngFor="let node of source" cdkDrag [cdkDragData]="node" class="angular-ui-tree-node se-tree-node__li"><se-tree-node-renderer [node]="node"></se-tree-node-renderer></li></ol>`}),__metadata("design:paramtypes",[No])],Fo);const zo=20;window.__smartedit__.addDecoratorPayload("Component","TreeNodeRendererComponent",{selector:"se-tree-node-renderer",template:`<div class="tree-node tree-node-content se-tree-node angular-ui-tree-handle" [ngClass]="{\n        'hovered': node.mouseHovered,\n        'se-tree-node--first-level': isRootNodeDescendant,\n        'se-tree-node--selected': !collapsed\n    }" [ngStyle]="{\n        'padding-left': getPaddingLeft(node.level)\n    }" [attr.level]="node.level" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()"><div *ngIf="!showAsList" class="se-tree-node__expander--wrapper col-xs-1 text-center"><a class="se-tree-node__expander btn btn-link btn-sm" *ngIf="node.hasChildren" [attr.disabled]="isDisabled || null" (click)="toggle($event)"><span [ngClass]="{\n                    'sap-icon--slim-arrow-right': collapsed,\n                    'sap-icon--slim-arrow-down': !collapsed\n                }"></span></a></div><div *ngIf="displayDefaultTemplate" class="se-tree-node__name col-xs-5" [attr.title]="node.title | seL10n | async "><span>{{node.name}}</span><h6 *ngIf="node.title">{{node.title | seL10n | async }}</h6></div><div [ngStyle]="{'width': '100%'}" *ngIf="tree.nodeTemplateUrl" [ngInclude]="tree.nodeTemplateUrl" [scope]="{node: node}" [compileHtmlNgController]="legacyController"></div><ng-container *ngIf="tree.nodeComponent"><ng-container *ngComponentOutlet="tree.nodeComponent; injector: nodeComponentInjector"></ng-container></ng-container></div><se-tree-node [source]="node.nodes" *ngIf="node.nodes.length && node.isExpanded"></se-tree-node>`});t.TreeNodeRendererComponent=class TreeNodeRendererComponent{constructor(e,t,o){this.tree=e;this.treeService=t;this.injector=o}ngOnInit(){this.createNodeComponentInjector()}ngOnChanges(e){if(e.node){this.createNodeComponentInjector();this.createNodeLegacyController()}}toggle(e){e.stopPropagation();e.preventDefault();this.tree.isDropDisabled=true;this.treeService.toggle(this.node).then((()=>{this.tree.isDropDisabled=false}))}onMouseOver(){this.node.setMouseHovered(true);this.treeService.update()}onMouseOut(){this.node.setMouseHovered(false);this.treeService.update()}getPaddingLeft(e){return`${(e-1)*zo}px`}get showAsList(){return this.tree.showAsList}get isDisabled(){return this.tree.isDropDisabled}get collapsed(){return!this.node.isExpanded}get displayDefaultTemplate(){return!this.tree.removeDefaultTemplate}get isRootNodeDescendant(){return this.node.parentUid==="root"}createNodeLegacyController(){this.legacyController={value:()=>this.tree,alias:"$ctrl"}}createNodeComponentInjector(){this.nodeComponentInjector=d.Injector.create({providers:[{provide:Mo,useValue:this.node}],parent:this.injector})}};__decorate([d.Input(),__metadata("design:type",Object)],t.TreeNodeRendererComponent.prototype,"node",void 0);t.TreeNodeRendererComponent=__decorate([d.Component({selector:"se-tree-node-renderer",template:`<div class="tree-node tree-node-content se-tree-node angular-ui-tree-handle" [ngClass]="{\n        'hovered': node.mouseHovered,\n        'se-tree-node--first-level': isRootNodeDescendant,\n        'se-tree-node--selected': !collapsed\n    }" [ngStyle]="{\n        'padding-left': getPaddingLeft(node.level)\n    }" [attr.level]="node.level" (mouseover)="onMouseOver()" (mouseout)="onMouseOut()"><div *ngIf="!showAsList" class="se-tree-node__expander--wrapper col-xs-1 text-center"><a class="se-tree-node__expander btn btn-link btn-sm" *ngIf="node.hasChildren" [attr.disabled]="isDisabled || null" (click)="toggle($event)"><span [ngClass]="{\n                    'sap-icon--slim-arrow-right': collapsed,\n                    'sap-icon--slim-arrow-down': !collapsed\n                }"></span></a></div><div *ngIf="displayDefaultTemplate" class="se-tree-node__name col-xs-5" [attr.title]="node.title | seL10n | async "><span>{{node.name}}</span><h6 *ngIf="node.title">{{node.title | seL10n | async }}</h6></div><div [ngStyle]="{'width': '100%'}" *ngIf="tree.nodeTemplateUrl" [ngInclude]="tree.nodeTemplateUrl" [scope]="{node: node}" [compileHtmlNgController]="legacyController"></div><ng-container *ngIf="tree.nodeComponent"><ng-container *ngComponentOutlet="tree.nodeComponent; injector: nodeComponentInjector"></ng-container></ng-container></div><se-tree-node [source]="node.nodes" *ngIf="node.nodes.length && node.isExpanded"></se-tree-node>`}),__param(0,d.Inject(d.forwardRef((()=>t.TreeComponent)))),__metadata("design:paramtypes",[t.TreeComponent,t.TreeService,d.Injector])],t.TreeNodeRendererComponent);t.NgTreeModule=class NgTreeModule{};t.NgTreeModule=__decorate([d.NgModule({imports:[t.CompileHtmlModule,A.DragDropModule,f.CommonModule,t.L10nPipeModule,s.TranslationModule.forChild()],declarations:[t.TreeComponent,t.TreeNodeRendererComponent,Fo],exports:[t.TreeComponent,Fo],entryComponents:[t.TreeComponent,t.TreeNodeRendererComponent]})],t.NgTreeModule);class EditableListNodeItem extends TreeNodeItem{constructor(e){super(e);this.thumbnail=e.thumbnail||{};this.id=e.id;this.code=e.code;this.catalogId=e.catalogId;this.catalogVersion=e.catalogVersion}}window.__smartedit__.addDecoratorPayload("Component","EditableListDefaultItem",{selector:"se-editable-list-default-item",template:`\n        <div>\n            <span>{{ node.uid }}</span>\n            <se-dropdown-menu\n                *ngIf="parent.editable"\n                [dropdownItems]="parent.getDropdownItems()"\n                [selectedItem]="node"\n                class="pull-right se-tree-node__actions--more-menu"\n            ></se-dropdown-menu>\n        </div>\n    `});t.EditableListDefaultItem=class EditableListDefaultItem{constructor(e,t){this.parent=e;this.node=t}};t.EditableListDefaultItem=__decorate([d.Component({selector:"se-editable-list-default-item",template:`\n        <div>\n            <span>{{ node.uid }}</span>\n            <se-dropdown-menu\n                *ngIf="parent.editable"\n                [dropdownItems]="parent.getDropdownItems()"\n                [selectedItem]="node"\n                class="pull-right se-tree-node__actions--more-menu"\n            ></se-dropdown-menu>\n        </div>\n    `}),__param(0,d.Inject(d.forwardRef((()=>t.EditableListComponent)))),__param(1,d.Inject(Mo)),__metadata("design:paramtypes",[t.EditableListComponent,Object])],t.EditableListDefaultItem);window.__smartedit__.addDecoratorPayload("Component","EditableListComponent",{selector:"se-editable-list",template:`<div [ngClass]="{ 'y-editable-list-disabled': !editable, 'se-editable-list-disabled': !editable }"><se-tree (onTreeUpdated)="handleTreeUpdated($event)" [removeDefaultTemplate]="true" [rootNodeUid]="rootId" [nodeTemplateUrl]="itemTemplateUrl" [nodeComponent]="itemComponent" [nodeActions]="actions" [dragOptions]="dragOptions" [showAsList]="true"></se-tree></div>`});t.EditableListComponent=class EditableListComponent{constructor(){this.refreshChange=new d.EventEmitter;this.itemsChange=new d.EventEmitter;this.dragOptions={};this.itemsOld=[]}ngOnInit(){this._enableDragAndDrop=()=>{this.dragOptions.allowDropCallback=e=>e.sourceNode.parentUid===this.rootId};this.actions=this.getTreeActions();this.refreshChange.emit((()=>this.actions.refreshList()));if(!this.itemTemplateUrl&&!this.itemComponent){this.itemComponent=t.EditableListDefaultItem}this.rootId="root"+this.id;if(this.editable===undefined){this.editable=true}if(this.editable===true){this._enableDragAndDrop()}}handleTreeUpdated(e){if(this.hasItemsChanged(this.itemsOld,e)){this.itemsOld=e;this.itemsChange.emit(e);this.actions.performUpdate()}}getDropdownItems(){return[{key:"se.ydropdownmenu.remove",callback:e=>{this.actions.removeItem(e)}},{key:"se.ydropdownmenu.move.up",condition:e=>this.actions.isMoveUpAllowed(e),callback:e=>{this.actions.moveUp(e)}},{key:"se.ydropdownmenu.move.down",condition:e=>this.actions.isMoveDownAllowed(e),callback:e=>{this.actions.moveDown(e)}}]}hasItemsChanged(e,t){const o=e.map((({uid:e})=>e));const n=t.map((({uid:e})=>e));return!r.isEqual(o,n)}getTreeActions(){const e=this.getDropdownItems();return{fetchData:(e,t)=>{const o=this.items.map((e=>new EditableListNodeItem(e)));o.forEach((e=>{if(e.id&&!e.uid){e.uid=e.id}e.setParent(t)}));t.removeAllNodes().addNodes(o);e.update();return Promise.resolve(t)},getDropdownItems:()=>e,removeItem(e,t){t.parent.removeNode(t);e.update()},moveUp(e,t){e.rearrange(t,e.root,t.position-1)},moveDown(e,t){e.rearrange(t,e.root,t.position+1)},isMoveUpAllowed(e,t){return t.position>0},isMoveDownAllowed(e,t){return e.root.nodes.length!==t.position+1},performUpdate:e=>{if(this.onChange){this.onChange()}},refreshList(e){this.fetchData(e.root)}}}};__decorate([d.Input(),__metadata("design:type",Function)],t.EditableListComponent.prototype,"refresh",void 0);__decorate([d.Input(),__metadata("design:type",Array)],t.EditableListComponent.prototype,"items",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.EditableListComponent.prototype,"onChange",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.EditableListComponent.prototype,"itemTemplateUrl",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],t.EditableListComponent.prototype,"itemComponent",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],t.EditableListComponent.prototype,"editable",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.EditableListComponent.prototype,"id",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.EditableListComponent.prototype,"refreshChange",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.EditableListComponent.prototype,"itemsChange",void 0);t.EditableListComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-editable-list",template:`<div [ngClass]="{ 'y-editable-list-disabled': !editable, 'se-editable-list-disabled': !editable }"><se-tree (onTreeUpdated)="handleTreeUpdated($event)" [removeDefaultTemplate]="true" [rootNodeUid]="rootId" [nodeTemplateUrl]="itemTemplateUrl" [nodeComponent]="itemComponent" [nodeActions]="actions" [dragOptions]="dragOptions" [showAsList]="true"></se-tree></div>`})],t.EditableListComponent);t.EditableListModule=class EditableListModule{};t.EditableListModule=__decorate([d.NgModule({imports:[f.CommonModule,t.NgTreeModule,t.DropdownMenuModule],declarations:[t.EditableListComponent,t.EditableListDefaultItem],entryComponents:[t.EditableListComponent,t.EditableListDefaultItem],exports:[t.EditableListComponent,t.EditableListDefaultItem]})],t.EditableListModule);(function(e){e["danger"]="danger";e["info"]="info";e["success"]="success";e["warning"]="warning"})(t.MessageType||(t.MessageType={}));window.__smartedit__.addDecoratorPayload("Component","MessageComponent",{selector:"se-message",template:`\n        <div\n            [attr.message-id]="messageId"\n            class="fd-alert se-y-message"\n            role="alert"\n            [ngClass]="classes"\n        >\n            <div class="y-message-text">\n                <div class="y-message-info-title">\n                    <ng-content select="[se-message-title]"></ng-content>\n                </div>\n                <div class="y-message-info-description">\n                    <ng-content select="[se-message-description]"></ng-content>\n                </div>\n            </div>\n        </div>\n    `});t.MessageComponent=class MessageComponent{ngOnInit(){this.messageId=this.messageId||"y-message-default-id";switch(this.type){case t.MessageType.danger:this.classes="fd-alert--error";break;case t.MessageType.info:this.classes="fd-alert--information";break;case t.MessageType.success:this.classes="fd-alert--success";break;case t.MessageType.warning:this.classes="fd-alert--warning";break;default:this.classes="fd-alert--information"}}};__decorate([d.Input(),__metadata("design:type",String)],t.MessageComponent.prototype,"messageId",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.MessageComponent.prototype,"type",void 0);t.MessageComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-message",template:`\n        <div\n            [attr.message-id]="messageId"\n            class="fd-alert se-y-message"\n            role="alert"\n            [ngClass]="classes"\n        >\n            <div class="y-message-text">\n                <div class="y-message-info-title">\n                    <ng-content select="[se-message-title]"></ng-content>\n                </div>\n                <div class="y-message-info-description">\n                    <ng-content select="[se-message-description]"></ng-content>\n                </div>\n            </div>\n        </div>\n    `})],t.MessageComponent);window.__smartedit__.addDecoratorPayload("Component","EventMessageComponent",{selector:"se-event-message",template:`\n        <div>\n            <se-message [type]="type" *ngIf="show">\n                <ng-container *ngIf="showTitle()" se-message-title>\n                    {{ title | translate }}\n                </ng-container>\n                <ng-container *ngIf="showDescription()" se-message-description>\n                    {{ description | translate }}\n                </ng-container>\n            </se-message>\n        </div>\n    `});t.EventMessageComponent=class EventMessageComponent{constructor(e){this.systemEventService=e;this.show=false}ngOnInit(){this.show=this.showToStart==="true"||this.showToStart===true;this.watchShowEventChange();this.watchHideEventChange()}ngOnDestroy(){this.removeShowEventHandler();this.removeHideEventHandler()}ngOnChanges(e){if(e.showEvent){this.watchShowEventChange()}if(e.hideEvent){this.watchHideEventChange()}}showDescription(){return typeof this.description==="string"&&this.description.length>0}showTitle(){return typeof this.title==="string"&&this.title.length>0}showEventHandler(e,t){if(t.description&&t.description.length){this.description=t.description}if(t.title&&t.title.length){this.title=t.title}this.show=true}removeHideEventHandler(){if(this.unregisterHideEventHandler){this.unregisterHideEventHandler()}}removeShowEventHandler(){if(this.unregisterShowEventHandler){this.unregisterShowEventHandler()}}watchShowEventChange(){this.removeShowEventHandler();this.unregisterShowEventHandler=this.systemEventService.subscribe(this.showEvent,((e,t)=>this.showEventHandler(e,t)))}watchHideEventChange(){this.removeHideEventHandler();this.unregisterHideEventHandler=this.systemEventService.subscribe(this.hideEvent,(()=>this.show=false))}};t.EventMessageComponent.$inject=["systemEventService"];__decorate([d.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"type",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"title",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"description",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"showEvent",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.EventMessageComponent.prototype,"hideEvent",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.EventMessageComponent.prototype,"showToStart",void 0);t.EventMessageComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-event-message",template:`\n        <div>\n            <se-message [type]="type" *ngIf="show">\n                <ng-container *ngIf="showTitle()" se-message-title>\n                    {{ title | translate }}\n                </ng-container>\n                <ng-container *ngIf="showDescription()" se-message-description>\n                    {{ description | translate }}\n                </ng-container>\n            </se-message>\n        </div>\n    `}),__metadata("design:paramtypes",[t.SystemEventService])],t.EventMessageComponent);t.MessageModule=class MessageModule{};t.MessageModule=__decorate([d.NgModule({imports:[f.CommonModule,S.TranslateModule.forChild()],declarations:[t.MessageComponent,t.EventMessageComponent],entryComponents:[t.MessageComponent,t.EventMessageComponent],exports:[t.MessageComponent,t.EventMessageComponent]})],t.MessageModule);window.__smartedit__.addDecoratorPayload("Component","MoreTextComponent",{selector:"se-more-text",template:`\n        <span id="y-more-text-payload" class="se-more-text__payload">{{ text }}</span>\n        <span\n            id="y-more-text-toggle"\n            class="se-more-text__toggle"\n            [ngClass]="{ 'se-more-text__toggle--capitalize': capitalizeLabel }"\n            (click)="showHideMoreText()"\n            *ngIf="isTruncated"\n            >{{ linkLabel }}</span\n        >\n    `,styles:[`.se-more-text__toggle--capitalize{text-transform:capitalize;color:#0a6ed1;cursor:pointer}`],providers:[t.TextTruncateService]});t.MoreTextComponent=class MoreTextComponent{constructor(e,t){this.textTruncateService=e;this.translate=t;this.capitalizeLabel=false;this.isTruncated=false;this.showingMore=false}ngOnInit(){this.limit=this.limit||100;this.moreLabelI18nKey=this.moreLabelI18nKey||"se.moretext.more.link";this.lessLabelI18nKey=this.lessLabelI18nKey||"se.moretext.less.link";this.truncatedText=this.textTruncateService.truncateToNearestWord(this.limit,this.text,this.ellipsis);this.isTruncated=this.truncatedText.isTruncated();this.translateLabels().subscribe((()=>{this.showHideMoreText()}))}showHideMoreText(){if(!this.isTruncated){return}this.text=this.showingMore?this.truncatedText.getUntruncatedText():this.truncatedText.getTruncatedText();this.linkLabel=this.showingMore?this.lessLabel:this.moreLabel;this.showingMore=!this.showingMore}translateLabels(){return v.zip(this.translate.get(this.moreLabelI18nKey),this.translate.get(this.lessLabelI18nKey)).pipe(b.tap((([e,t])=>{this.moreLabel=e;this.lessLabel=t})))}};t.MoreTextComponent.$inject=["textTruncateService","translate"];__decorate([d.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"text",void 0);__decorate([d.Input(),__metadata("design:type",Number)],t.MoreTextComponent.prototype,"limit",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"moreLabelI18nKey",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"lessLabelI18nKey",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.MoreTextComponent.prototype,"ellipsis",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.MoreTextComponent.prototype,"capitalizeLabel",void 0);t.MoreTextComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-more-text",template:`\n        <span id="y-more-text-payload" class="se-more-text__payload">{{ text }}</span>\n        <span\n            id="y-more-text-toggle"\n            class="se-more-text__toggle"\n            [ngClass]="{ 'se-more-text__toggle--capitalize': capitalizeLabel }"\n            (click)="showHideMoreText()"\n            *ngIf="isTruncated"\n            >{{ linkLabel }}</span\n        >\n    `,styles:[`.se-more-text__toggle--capitalize{text-transform:capitalize;color:#0a6ed1;cursor:pointer}`],providers:[t.TextTruncateService]}),__metadata("design:paramtypes",[t.TextTruncateService,S.TranslateService])],t.MoreTextComponent);t.MoreTextModule=class MoreTextModule{};t.MoreTextModule=__decorate([d.NgModule({imports:[f.CommonModule],declarations:[t.MoreTextComponent],entryComponents:[t.MoreTextComponent],exports:[t.MoreTextComponent]})],t.MoreTextModule);const Lo=new d.InjectionToken("POPUP_OVERLAY_DATA");(function(e){e["Hover"]="hover";e["Click"]="click"})(t.PopoverTrigger||(t.PopoverTrigger={}));window.__smartedit__.addDecoratorPayload("Component","PopupOverlayComponent",{selector:"se-popup-overlay",template:`\n        <fd-popover\n            [placement]="getPlacement()"\n            [noArrow]="true"\n            [appendTo]="appendTo"\n            [triggers]="trigger.length && trigger"\n            (isOpenChange)="handleOpenChange($event)"\n            [additionalClasses]="['se-popup-overlay-container']"\n            class="popup-overlay popover-outer"\n            [ngClass]="popupOverlay.additionalClasses"\n        >\n            <fd-popover-control> <ng-content></ng-content> </fd-popover-control>\n\n            <fd-popover-body #popoverBody class="popover-inner popup-overlay__inner">\n                <ng-container *ngIf="isOpen">\n                    <div\n                        *ngIf="popupOverlay.template"\n                        [seCompileHtml]="popupOverlay.template"\n                        [scope]="popupOverlayData"\n                        [compileHtmlNgController]="popupOverlay.legacyController"\n                    ></div>\n                    <div\n                        *ngIf="popupOverlay.templateUrl"\n                        [ngInclude]="popupOverlay.templateUrl"\n                        [scope]="popupOverlayData"\n                        [compileHtmlNgController]="popupOverlay.legacyController"\n                    ></div>\n                    <ng-container *ngIf="popupOverlay.component">\n                        <ng-container\n                            *ngComponentOutlet="\n                                popupOverlay.component;\n                                injector: popupOverlayInjector\n                            "\n                        ></ng-container>\n                    </ng-container>\n                    <ng-content select="[se-popup-overlay-body]"></ng-content>\n                </ng-container>\n            </fd-popover-body>\n        </fd-popover>\n    `,styles:[`.se-popup-overlay-container{z-index:1060!important}`],encapsulation:d.ViewEncapsulation.None});t.PopupOverlayComponent=class PopupOverlayComponent{constructor(e){this.injector=e;this.popupOverlayOnShow=new d.EventEmitter;this.popupOverlayOnHide=new d.EventEmitter;this.trigger=[]}ngOnInit(){this.createInjector();this.setTrigger();this.appendTo=ne.isIframe()?document.getElementById("smarteditoverlay"):document.getElementsByTagName("body")[0]}ngOnChanges(e){if(e.popupOverlayTrigger){this.setTrigger()}if(e.popupOverlayData){this.createInjector()}}handleOpenChange(e){return e?this.handleOpen():this.handleClose()}handleOpen(){this.isOpen=true;this.popupOverlayOnShow.emit()}handleClose(){this.isOpen=false;this.popupOverlayOnHide.emit()}getPlacement(){return`${this.popupOverlay.valign||"bottom"}-${this.getHorizontalAlign()}`}setTrigger(){if(this.popupOverlayTrigger===t.PopoverTrigger.Click){this.trigger=[this.popupOverlayTrigger]}if(this.popupOverlayTrigger===t.PopoverTrigger.Hover){this.trigger=["mouseenter","mouseleave"]}if(!this.popover){return}if(this.popupOverlayTrigger==="true"||this.popupOverlayTrigger===true){this.popover.open()}else{this.popover.close()}}getHorizontalAlign(){if(!this.popupOverlay.halign){return"start"}return this.popupOverlay.halign==="right"?"start":"end"}createInjector(){this.popupOverlayInjector=d.Injector.create({providers:[{provide:Lo,useValue:this.popupOverlayData||{}}],parent:this.injector})}};t.PopupOverlayComponent.$inject=["injector"];__decorate([d.Input(),__metadata("design:type",Object)],t.PopupOverlayComponent.prototype,"popupOverlay",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.PopupOverlayComponent.prototype,"popupOverlayTrigger",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.PopupOverlayComponent.prototype,"popupOverlayData",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.PopupOverlayComponent.prototype,"popupOverlayOnShow",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.PopupOverlayComponent.prototype,"popupOverlayOnHide",void 0);__decorate([d.ViewChild(I.PopoverComponent,{static:false}),__metadata("design:type",I.PopoverComponent)],t.PopupOverlayComponent.prototype,"popover",void 0);t.PopupOverlayComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-popup-overlay",template:`\n        <fd-popover\n            [placement]="getPlacement()"\n            [noArrow]="true"\n            [appendTo]="appendTo"\n            [triggers]="trigger.length && trigger"\n            (isOpenChange)="handleOpenChange($event)"\n            [additionalClasses]="['se-popup-overlay-container']"\n            class="popup-overlay popover-outer"\n            [ngClass]="popupOverlay.additionalClasses"\n        >\n            <fd-popover-control> <ng-content></ng-content> </fd-popover-control>\n\n            <fd-popover-body #popoverBody class="popover-inner popup-overlay__inner">\n                <ng-container *ngIf="isOpen">\n                    <div\n                        *ngIf="popupOverlay.template"\n                        [seCompileHtml]="popupOverlay.template"\n                        [scope]="popupOverlayData"\n                        [compileHtmlNgController]="popupOverlay.legacyController"\n                    ></div>\n                    <div\n                        *ngIf="popupOverlay.templateUrl"\n                        [ngInclude]="popupOverlay.templateUrl"\n                        [scope]="popupOverlayData"\n                        [compileHtmlNgController]="popupOverlay.legacyController"\n                    ></div>\n                    <ng-container *ngIf="popupOverlay.component">\n                        <ng-container\n                            *ngComponentOutlet="\n                                popupOverlay.component;\n                                injector: popupOverlayInjector\n                            "\n                        ></ng-container>\n                    </ng-container>\n                    <ng-content select="[se-popup-overlay-body]"></ng-content>\n                </ng-container>\n            </fd-popover-body>\n        </fd-popover>\n    `,styles:[`.se-popup-overlay-container{z-index:1060!important}`],encapsulation:d.ViewEncapsulation.None}),__metadata("design:paramtypes",[d.Injector])],t.PopupOverlayComponent);t.PopupOverlayModule=class PopupOverlayModule{};t.PopupOverlayModule=__decorate([d.NgModule({imports:[f.CommonModule,I.PopoverModule,t.CompileHtmlModule],declarations:[t.PopupOverlayComponent],entryComponents:[t.PopupOverlayComponent],exports:[t.PopupOverlayComponent]})],t.PopupOverlayModule);const Vo="max-height.px";window.__smartedit__.addDecoratorPayload("Component","PreventVerticalOverflowComponent",{selector:"se-prevent-vertical-overflow",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`\n        <div #container [ngStyle]="containerStyle">\n            <ng-content></ng-content>\n        </div>\n    `});t.PreventVerticalOverflowComponent=class PreventVerticalOverflowComponent{constructor(e,t){this.document=e;this.cdr=t;this.containerStyle={"max-height.px":null,overflow:null}}onWindowResize(){if(this.containerElement){this.onResize()}}ngAfterViewInit(){this.observer=new IntersectionObserver((([e])=>{if(e.isIntersecting){this.onResize()}}),{root:this.document,threshold:0});this.observer.observe(this.containerElement.nativeElement)}ngOnDestroy(){this.observer.unobserve(this.containerElement.nativeElement)}onResize(){const{top:e,height:t}=this.getContainerBoundingClientRect();if(e===0&&t===0){return}this.preventOverflow(e,t)}preventOverflow(e,t){const o=this.preventIfOverflowing(e,t);if(!o&&this.containerStyle[Vo]){this.reset();const{top:e,height:t}=this.getContainerBoundingClientRect();this.preventIfOverflowing(e,t)}}preventIfOverflowing(e,t){if(this.isOverflowing(e,t)){this.prevent(e);return true}return false}isOverflowing(e,t){const o=this.getDocumentHeight();return o<e+t}prevent(e){const t=this.getDocumentHeight();const o=t-e;this.containerStyle[Vo]=o;this.containerStyle.overflow="auto";if(!this.cdr.destroyed){this.cdr.detectChanges()}}reset(){this.containerStyle[Vo]=null;this.containerStyle.overflow=null;if(!this.cdr.destroyed){this.cdr.detectChanges()}}getContainerBoundingClientRect(){return this.containerElement.nativeElement.getBoundingClientRect()}getDocumentHeight(){const{height:e}=this.document.documentElement.getBoundingClientRect();return e}};t.PreventVerticalOverflowComponent.$inject=["document","cdr"];__decorate([d.ViewChild("container",{static:false}),__metadata("design:type",d.ElementRef)],t.PreventVerticalOverflowComponent.prototype,"containerElement",void 0);__decorate([d.HostListener("window:resize"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.PreventVerticalOverflowComponent.prototype,"onWindowResize",null);t.PreventVerticalOverflowComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-prevent-vertical-overflow",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`\n        <div #container [ngStyle]="containerStyle">\n            <ng-content></ng-content>\n        </div>\n    `}),__param(0,d.Inject(f.DOCUMENT)),__metadata("design:paramtypes",[Document,d.ChangeDetectorRef])],t.PreventVerticalOverflowComponent);t.PreventVerticalOverflowModule=class PreventVerticalOverflowModule{};t.PreventVerticalOverflowModule=__decorate([d.NgModule({imports:[f.CommonModule],declarations:[t.PreventVerticalOverflowComponent],entryComponents:[t.PreventVerticalOverflowComponent],exports:[t.PreventVerticalOverflowComponent]})],t.PreventVerticalOverflowModule);window.__smartedit__.addDecoratorPayload("Component","HelpComponent",{selector:"se-help",template:`<se-tooltip [triggers]="['mouseenter', 'mouseleave']" placement="auto" [isChevronVisible]="true" [title]="title" class="se-help"><span se-tooltip-trigger class="sap-icon--sys-help se-y-help-icon"></span><ng-content se-tooltip-body></ng-content></se-tooltip>`});t.HelpComponent=class HelpComponent{};__decorate([d.Input(),__metadata("design:type",String)],t.HelpComponent.prototype,"title",void 0);t.HelpComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-help",template:`<se-tooltip [triggers]="['mouseenter', 'mouseleave']" placement="auto" [isChevronVisible]="true" [title]="title" class="se-help"><span se-tooltip-trigger class="sap-icon--sys-help se-y-help-icon"></span><ng-content se-tooltip-body></ng-content></se-tooltip>`})],t.HelpComponent);t.HelpModule=class HelpModule{};t.HelpModule=__decorate([d.NgModule({imports:[f.CommonModule,t.TooltipModule,t.CompileHtmlModule],declarations:[t.HelpComponent],entryComponents:[t.HelpComponent],exports:[t.HelpComponent]})],t.HelpModule);window.__smartedit__.addDecoratorPayload("Component","ShortcutLinkComponent",{selector:"shortcut-link",template:`<ng-container #container><ng-template #defaultTemplate let-shortcutLink><div class="se-shortcut-link"><a class="se-shortcut-link__item" [ngClass]="{'se-shortcut-link__item--active': shortcutLink.active}" (click)="onClick(shortcutLink)">{{shortcutLink.titleI18nKey | translate}}</a></div></ng-template></ng-container>`});t.ShortcutLinkComponent=class ShortcutLinkComponent{constructor(e,t,o,n,s,a,r){this.router=e;this.location=t;this.resolver=o;this.experienceService=n;this.priorityService=s;this.systemEventService=a;this.userTrackingService=r}ngOnInit(){this.unregFn=this.systemEventService.subscribe(s.EVENTS.EXPERIENCE_UPDATE,(()=>this._createShortcutLink()))}ngOnDestroy(){this.unregFn()}ngAfterViewInit(){this._createShortcutLink()}onClick(e){this.userTrackingService.trackingUserAction(mi.NAVIGATION,e.titleI18nKey);this.location.go(e.fullPath);this.router.navigateByUrl(e.fullPath)}_createShortcutLink(){const e=this.experienceService.getCurrentExperience();e.then((e=>{const t=this._getShortcutLinks(e);const o=this._orderByPriority(t);this._createShortcutLinkDynamicComponents(o)}))}_createShortcutLinkDynamicComponents(e){this.containerEntry.clear();e.forEach((e=>{if(e&&e.titleI18nKey){this.containerEntry.createEmbeddedView(this.defaultTemplate,{$implicit:e})}else if(e&&e.shortcutComponent){const t=this.resolver.resolveComponentFactory(e.shortcutComponent);const o=this.containerEntry.createComponent(t);o.instance.shortcutLink=e}}))}_getShortcutLinks(e){const t=this.location.path();return SeRouteService.routeShortcutConfigs.map((o=>{let n;const s=o.fullPath.replace(":siteId",e.catalogDescriptor.siteId).replace(":catalogId",e.catalogDescriptor.catalogId).replace(":catalogVersion",e.catalogDescriptor.catalogVersion);if(s.startsWith("/")){n=s===t}else{n=`/${s}`===t}const a=Object.assign({},o);a.fullPath=s;a.active=n;return a}))}_orderByPriority(e){e.forEach((e=>e.priority=e.priority||500));return this.priorityService.sort(e)}};t.ShortcutLinkComponent.$inject=["router","location","resolver","experienceService","priorityService","systemEventService","userTrackingService"];__decorate([d.ViewChild("container",{read:d.ViewContainerRef,static:false}),__metadata("design:type",d.ViewContainerRef)],t.ShortcutLinkComponent.prototype,"containerEntry",void 0);__decorate([d.ViewChild("defaultTemplate",{read:d.TemplateRef,static:false}),__metadata("design:type",d.TemplateRef)],t.ShortcutLinkComponent.prototype,"defaultTemplate",void 0);t.ShortcutLinkComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"shortcut-link",template:`<ng-container #container><ng-template #defaultTemplate let-shortcutLink><div class="se-shortcut-link"><a class="se-shortcut-link__item" [ngClass]="{'se-shortcut-link__item--active': shortcutLink.active}" (click)="onClick(shortcutLink)">{{shortcutLink.titleI18nKey | translate}}</a></div></ng-template></ng-container>`}),__metadata("design:paramtypes",[C.Router,f.Location,d.ComponentFactoryResolver,IExperienceService,t.PriorityService,t.SystemEventService,t.UserTrackingService])],t.ShortcutLinkComponent);class SliderPanelZIndexHelper{getHighestZIndex(e){return Math.max(...this.getChildrenNodesFromTreeOrLeaf(e[0]).filter((e=>this.filterBlacklistedNodes(e))).map((e=>this.mapToZIndexIntegers(e))))}filterBlacklistedNodes(e){return!SliderPanelZIndexHelper.BLACKLISTED_NODE_NAMES.has(e.nodeName)}mapToZIndexIntegers(e){return parseInt(a.element(e).css("z-index"),10)||0}getChildrenNodesFromTreeOrLeaf(e){return[e,...r.flatten(Array.from(e.children).map((e=>this.getChildrenNodesFromTreeOrLeaf(e))))]}}SliderPanelZIndexHelper.BLACKLISTED_NODE_NAMES=new Set(["SCRIPT","LINK","BASE"]);class SliderPanelService{constructor(e,t,o,n){this.element=e;this.window=t;this.configuration=o;this.yjQuery=n;this.inlineStyling={container:{},content:{}};this.sliderPanelDefaultConfiguration={slideFrom:"right",overlayDimension:"80%"};this.init()}updateContainerInlineStyling(e){const t=this.parent[0].getBoundingClientRect();const o={left:this.parent.css("border-left-width")?parseInt(this.parent.css("border-left-width").replace("px",""),10):0,top:this.parent.css("border-top-width")?parseInt(this.parent.css("border-top-width").replace("px",""),10):0};this.inlineStyling.container.height=this.parent[0].clientHeight+"px";this.inlineStyling.container.width=this.parent[0].clientWidth+"px";this.inlineStyling.container.left=(this.appendChildTarget.nodeName==="BODY"?Math.round(t.left+this.window.pageXOffset+o.left):0)+"px";this.inlineStyling.container.top=(this.appendChildTarget.nodeName==="BODY"?Math.round(t.top+this.window.pageYOffset+o.top):0)+"px";if(!e){this.inlineStyling.container.zIndex=this.sliderPanelConfiguration.zIndex?this.sliderPanelConfiguration.zIndex.toString():(this.returningHigherZIndex()+1).toString()}}returningHigherZIndex(){return(new SliderPanelZIndexHelper).getHighestZIndex(this.yjQuery("body"))}initializeParentRawElement(){const e=this.sliderPanelConfiguration.cssSelector?document.querySelector(this.sliderPanelConfiguration.cssSelector):null;this.parent=this.yjQuery(e||this.element.parent())}initializePanelConfiguration(){this.sliderPanelConfiguration=r.defaultsDeep(this.configuration,this.sliderPanelDefaultConfiguration)}initializeInlineStyles(){const e=["top","bottom"].indexOf(this.sliderPanelConfiguration.slideFrom)===-1?"width":"height";this.inlineStyling.content[e]=this.sliderPanelConfiguration.overlayDimension}initializeChildTarget(){let e=this.parent;let t=false;let o=0;for(o;e[0].nodeName!=="BODY";e=this.yjQuery(e.parent()),o++){const o=(e[0].getAttribute("class")||"").includes("fd-modal__content");const n=e[0].getAttribute("id")==="y-modal-dialog";if(o||n){t=true;break}}this.appendChildTarget=t?e[0]:document.body}append(){this.yjQuery(this.appendChildTarget).append(this.element[0])}init(){this.initializePanelConfiguration();this.initializeParentRawElement();this.initializeInlineStyles();this.initializeChildTarget();this.append()}}t.SliderPanelServiceFactory=class SliderPanelServiceFactory{constructor(e){this.yjQuery=e}getNewServiceInstance(e,t,o){return new SliderPanelService(e,t,o,this.yjQuery)}};t.SliderPanelServiceFactory.$inject=["yjQuery"];t.SliderPanelServiceFactory=__decorate([SeDowngradeService(),__param(0,d.Inject(Qi)),__metadata("design:paramtypes",[Function])],t.SliderPanelServiceFactory);const Uo={SLIDERPANEL_ANIMATED:"sliderpanel--animated",SLIDERPANEL_SLIDEPREFIX:"sliderpanel--slidefrom"};window.__smartedit__.addDecoratorPayload("Component","SliderPanelComponent",{selector:"se-slider-panel",template:`<div class="se-slider-panel-wrapper" *ngIf="isShown"><div class="se-slider-panel-container slide-in"><div class="se-slider-panel__header" *ngIf="sliderPanelConfiguration.modal"><span class="se-slider-panel__title" *ngIf="sliderPanelConfiguration.modal.title">{{ sliderPanelConfiguration.modal.title | translate }}</span> <button type="button" class="se-slider-panel__close-btn fd-button--light fd-modal__close" aria-label="close" *ngIf="sliderPanelConfiguration.modal.showDismissButton" (click)="sliderPanelDismissAction()"></button></div><div class="se-slider-panel__body"><ng-content></ng-content></div><div class="se-slider-panel__footer" *ngIf="sliderPanelConfiguration.modal && (sliderPanelConfiguration.modal.cancel || sliderPanelConfiguration.modal.save)"><button type="button" class="fd-button--emphasized se-slider-panel__footer-btn se-slider-panel__footer-btn--save" *ngIf="sliderPanelConfiguration.modal.save" (click)="sliderPanelConfiguration.modal.save.onClick()" [disabled]="isSaveDisabled()">{{ sliderPanelConfiguration.modal.save.label | translate }}</button> <button type="button" class="fd-button--light se-slider-panel__footer-btn se-slider-panel__footer-btn--cancel" *ngIf="sliderPanelConfiguration.modal.cancel" (click)="sliderPanelConfiguration.modal.cancel.onClick()">{{ sliderPanelConfiguration.modal.cancel.label | translate }}</button></div></div></div>`,styles:[`.se-slider-panel-wrapper{position:fixed;display:flex;justify-content:center;overflow:hidden;width:100%;top:0;left:0;z-index:1060}.se-slider-panel-container{display:flex;flex-direction:column;transform:translateX(100%);-webkit-transform:translateX(100%);background-color:#fff;border-radius:4px;width:650px}.se-slider-panel__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px}.se-slider-panel__header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-slider-panel__body{padding:20px;overflow-y:auto;max-height:70vh;height:70vh;min-height:500px;flex:1 1 auto}.se-slider-panel__footer{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:flex-end;border-top:1px solid #d9d9d9;height:69px}.se-slider-panel__footer button{text-transform:capitalize;margin-left:12px}.slide-in{animation:slide-in .4s forwards;-webkit-animation:slide-in .4s forwards}@keyframes slide-in{100%{transform:translateX(0)}}@-webkit-keyframes slide-in{100%{-webkit-transform:translateX(0)}}:host-context(.fd-modal-container).sliderpanel--animated{position:fixed;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);align-items:center;display:flex}:host-context(.fd-modal-container).sliderpanel--animated .se-slider-panel-wrapper{top:auto}:host-context(.fd-modal-container).sliderpanel--animated .se-slider-panel-wrapper .se-slider-panel__body{max-height:calc(100vh - 128px);min-height:auto}`]});t.SliderPanelComponent=class SliderPanelComponent{constructor(e,t,o,n,s){this.renderer=e;this.element=t;this.windowUtils=o;this.yjQuery=n;this.sliderPanelServiceFactory=s;this.sliderPanelHideChange=new d.EventEmitter;this.sliderPanelShowChange=new d.EventEmitter;this.isShownChange=new d.EventEmitter;this.inlineStyling={container:{},content:{}}}ngOnInit(){this.isShown=false;this.uniqueId=ae.generateIdentifier();this.sliderPanelService=this.sliderPanelServiceFactory.getNewServiceInstance(this.yjQuery(this.element.nativeElement),this.windowUtils.getWindow(),this.sliderPanelConfiguration);this.sliderPanelConfiguration=this.sliderPanelService.sliderPanelConfiguration;this.slideClassName=Uo.SLIDERPANEL_SLIDEPREFIX+this.sliderPanelConfiguration.slideFrom;this.inlineStyling={container:this.sliderPanelService.inlineStyling.container,content:this.sliderPanelService.inlineStyling.content};setTimeout((()=>{this.sliderPanelShowChange.emit((()=>this.showSlider()));this.sliderPanelHideChange.emit((()=>this.hideSlider()))}));this.sliderPanelDismissAction=this.sliderPanelConfiguration.modal&&this.sliderPanelConfiguration.modal.dismiss&&this.sliderPanelConfiguration.modal.dismiss.onClick?this.sliderPanelConfiguration.modal.dismiss.onClick:this.hideSlider;this.addScreenResizeEventHandler();if(this.sliderPanelConfiguration.displayedByDefault){this.showSlider()}}ngOnDestroy(){this.yjQuery(this.windowUtils.getWindow()).off("resize.doResize")}hideSlider(){return new Promise((e=>{this.renderer.removeClass(this.element.nativeElement,Uo.SLIDERPANEL_ANIMATED);this.isShown=false;this.isShownChange.emit(this.isShown);e()}))}showSlider(){return new Promise((e=>{this.sliderPanelService.updateContainerInlineStyling(false);this.inlineStyling.container=this.sliderPanelService.inlineStyling.container;let t=false;this.yjQuery("se-slider-panel.sliderpanel--animated .se-slider-panel-container").toArray().forEach((e=>{const o=this.yjQuery(e);if(!t){if(o.css("height")===this.inlineStyling.container.height&&o.css("width")===this.inlineStyling.container.width&&o.css("left")===this.inlineStyling.container.left&&o.css("top")===this.inlineStyling.container.top){t=true}}}));this.sliderPanelConfiguration.noGreyedOutOverlay=typeof this.sliderPanelConfiguration.noGreyedOutOverlay==="boolean"?this.sliderPanelConfiguration.noGreyedOutOverlay:t;this.isShown=true;this.isShownChange.emit(this.isShown);this.renderer.addClass(this.element.nativeElement,Uo.SLIDERPANEL_ANIMATED);e()}))}isSaveDisabled(){if(this.sliderPanelConfiguration.modal&&this.sliderPanelConfiguration.modal.save&&this.sliderPanelConfiguration.modal.save.isDisabledFn){return this.sliderPanelConfiguration.modal.save.isDisabledFn()}return false}addScreenResizeEventHandler(){this.yjQuery(this.windowUtils.getWindow()).on("resize.sliderPanelRedraw_"+this.uniqueId,(()=>{if(this.isShown){setTimeout((()=>{this.sliderPanelService.updateContainerInlineStyling(true);this.inlineStyling.container=this.sliderPanelService.inlineStyling.container}),0)}}))}};t.SliderPanelComponent.$inject=["renderer","element","windowUtils","yjQuery","sliderPanelServiceFactory"];__decorate([d.Input(),__metadata("design:type",Object)],t.SliderPanelComponent.prototype,"sliderPanelConfiguration",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SliderPanelComponent.prototype,"sliderPanelHide",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SliderPanelComponent.prototype,"sliderPanelShow",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.SliderPanelComponent.prototype,"sliderPanelHideChange",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.SliderPanelComponent.prototype,"sliderPanelShowChange",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.SliderPanelComponent.prototype,"isShownChange",void 0);__decorate([d.ContentChild(d.TemplateRef,{static:false}),__metadata("design:type",d.TemplateRef)],t.SliderPanelComponent.prototype,"content",void 0);t.SliderPanelComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-slider-panel",template:`<div class="se-slider-panel-wrapper" *ngIf="isShown"><div class="se-slider-panel-container slide-in"><div class="se-slider-panel__header" *ngIf="sliderPanelConfiguration.modal"><span class="se-slider-panel__title" *ngIf="sliderPanelConfiguration.modal.title">{{ sliderPanelConfiguration.modal.title | translate }}</span> <button type="button" class="se-slider-panel__close-btn fd-button--light fd-modal__close" aria-label="close" *ngIf="sliderPanelConfiguration.modal.showDismissButton" (click)="sliderPanelDismissAction()"></button></div><div class="se-slider-panel__body"><ng-content></ng-content></div><div class="se-slider-panel__footer" *ngIf="sliderPanelConfiguration.modal && (sliderPanelConfiguration.modal.cancel || sliderPanelConfiguration.modal.save)"><button type="button" class="fd-button--emphasized se-slider-panel__footer-btn se-slider-panel__footer-btn--save" *ngIf="sliderPanelConfiguration.modal.save" (click)="sliderPanelConfiguration.modal.save.onClick()" [disabled]="isSaveDisabled()">{{ sliderPanelConfiguration.modal.save.label | translate }}</button> <button type="button" class="fd-button--light se-slider-panel__footer-btn se-slider-panel__footer-btn--cancel" *ngIf="sliderPanelConfiguration.modal.cancel" (click)="sliderPanelConfiguration.modal.cancel.onClick()">{{ sliderPanelConfiguration.modal.cancel.label | translate }}</button></div></div></div>`,styles:[`.se-slider-panel-wrapper{position:fixed;display:flex;justify-content:center;overflow:hidden;width:100%;top:0;left:0;z-index:1060}.se-slider-panel-container{display:flex;flex-direction:column;transform:translateX(100%);-webkit-transform:translateX(100%);background-color:#fff;border-radius:4px;width:650px}.se-slider-panel__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px}.se-slider-panel__header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-slider-panel__body{padding:20px;overflow-y:auto;max-height:70vh;height:70vh;min-height:500px;flex:1 1 auto}.se-slider-panel__footer{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:flex-end;border-top:1px solid #d9d9d9;height:69px}.se-slider-panel__footer button{text-transform:capitalize;margin-left:12px}.slide-in{animation:slide-in .4s forwards;-webkit-animation:slide-in .4s forwards}@keyframes slide-in{100%{transform:translateX(0)}}@-webkit-keyframes slide-in{100%{-webkit-transform:translateX(0)}}:host-context(.fd-modal-container).sliderpanel--animated{position:fixed;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);align-items:center;display:flex}:host-context(.fd-modal-container).sliderpanel--animated .se-slider-panel-wrapper{top:auto}:host-context(.fd-modal-container).sliderpanel--animated .se-slider-panel-wrapper .se-slider-panel__body{max-height:calc(100vh - 128px);min-height:auto}`]}),__param(3,d.Inject(Qi)),__metadata("design:paramtypes",[d.Renderer2,d.ElementRef,t.WindowUtils,Function,t.SliderPanelServiceFactory])],t.SliderPanelComponent);t.SliderPanelModule=class SliderPanelModule{};t.SliderPanelModule=__decorate([d.NgModule({imports:[f.CommonModule,s.TranslationModule.forChild(),t.CompileHtmlModule],declarations:[t.SliderPanelComponent],entryComponents:[t.SliderPanelComponent],providers:[t.SliderPanelServiceFactory],exports:[t.SliderPanelComponent]})],t.SliderPanelModule);t.ReversePipe=class ReversePipe{transform(e){if(!e){return undefined}return e.slice().reverse()}};t.ReversePipe=__decorate([d.Pipe({name:"seReverse"})],t.ReversePipe);t.ReversePipeModule=class ReversePipeModule{};t.ReversePipeModule=__decorate([d.NgModule({declarations:[t.ReversePipe],exports:[t.ReversePipe]})],t.ReversePipeModule);t.PropertyPipe=class PropertyPipe{transform(e,t){if(!e){return undefined}if(!t){return[...e]}return e.filter((e=>Object.keys(t).every((o=>e[o]===t[o]))))}};t.PropertyPipe=__decorate([d.Pipe({name:"seProperty"})],t.PropertyPipe);t.PropertyPipeModule=class PropertyPipeModule{};t.PropertyPipeModule=__decorate([d.NgModule({declarations:[t.PropertyPipe],exports:[t.PropertyPipe]})],t.PropertyPipeModule);var jo;t.StartFromPipe=jo=class StartFromPipe{static transform(e,t){return e?e.slice(Number(t)):[]}transform(e,t){return jo.transform(e,t)}};t.StartFromPipe=jo=__decorate([d.Pipe({name:"seStartFrom"})],t.StartFromPipe);t.StartFromPipeModule=class StartFromPipeModule{};t.StartFromPipeModule=__decorate([d.NgModule({declarations:[t.StartFromPipe],exports:[t.StartFromPipe]})],t.StartFromPipeModule);var $o;t.FilterByFieldPipe=$o=class FilterByFieldPipe{static transform(e,t,o,n){const s=n||r.noop;const a=[];if(!t){s(e);return e}const d=t.toLowerCase().split(" ");(e||[]).forEach((e=>{o=o||Object.keys(e);const t=o.map((t=>e[t])).filter((e=>typeof e==="string"||e instanceof String)).map((e=>e.toLowerCase()));const n=d.map((e=>!!t.find((t=>t.indexOf(e)>=0)))).filter((e=>!e));if(n.length===0){a.push(e)}}));s(a);return a}transform(e,t,o,n){return $o.transform(e,t,o,n)}};t.FilterByFieldPipe=$o=__decorate([d.Pipe({name:"seFilterByField"})],t.FilterByFieldPipe);t.FilterByFieldPipeModule=class FilterByFieldPipeModule{};t.FilterByFieldPipeModule=__decorate([d.NgModule({declarations:[t.FilterByFieldPipe],exports:[t.FilterByFieldPipe]})],t.FilterByFieldPipeModule);t.SharedComponentsModule=class SharedComponentsModule{};t.SharedComponentsModule=__decorate([d.NgModule({imports:[s.TranslationModule.forChild(),t.FundamentalsModule,f.CommonModule,w.FormsModule,s.SelectModule,s.LanguageDropdownModule,w.ReactiveFormsModule,t.CollapsibleContainerModule,t.CompileHtmlModule,t.MessageModule,t.NgTreeModule,t.HasOperationPermissionDirectiveModule,t.DropdownMenuModule,t.ResizeObserverModule,t.InfiniteScrollingModule,t.SpinnerModule,t.PopupOverlayModule,t.StartFromPipeModule,t.PaginationModule,t.TooltipModule,t.ReversePipeModule,t.EditableListModule,t.SliderPanelModule,s.LoginDialogModule,s.FundamentalModalTemplateModule,t.DynamicPagedListModule,xo,t.HelpModule,t.TabsModule,t.MoreTextModule,t.PreventVerticalOverflowModule],declarations:[t.WaitDialogComponent,t.ShortcutLinkComponent],entryComponents:[t.WaitDialogComponent,t.ShortcutLinkComponent],exports:[t.WaitDialogComponent,t.ShortcutLinkComponent,s.SelectModule,s.LanguageDropdownModule,t.CompileHtmlModule,t.MessageModule,t.NgTreeModule,t.CollapsibleContainerModule,t.HasOperationPermissionDirectiveModule,t.DropdownMenuModule,t.PopupOverlayModule,t.ResizeObserverModule,t.InfiniteScrollingModule,t.StartFromPipeModule,t.PaginationModule,t.TooltipModule,t.ReversePipeModule,t.EditableListModule,t.SpinnerModule,t.SliderPanelModule,s.LoginDialogModule,s.FundamentalModalTemplateModule,t.DynamicPagedListModule,xo,t.HelpModule,t.TabsModule,t.MoreTextModule,t.PreventVerticalOverflowModule]})],t.SharedComponentsModule);window.__smartedit__.addDecoratorPayload("Component","ActionableSearchItemComponent",{selector:"se-actionable-search-item",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-actionable-search-item]":"true"},template:`<div *ngIf="search" class="se-actionable-search-item"><div class="se-actionable-search-item__name">{{ search }}</div><button type="button" class="fd-button--light se-actionable-search-item__action-btn" (click)="onButtonClick()">{{ getActionText() | translate }}</button></div>`});t.ActionableSearchItemComponent=class ActionableSearchItemComponent{constructor(e){this.systemEventService=e;this.actionButtonClick=new d.EventEmitter;this.defaultEventId="yActionableSearchItem_ACTION_CREATE";this.defaultActionText="se.yationablesearchitem.action.create"}getActionText(){return this.actionText||this.defaultActionText}onButtonClick(){const e=this.eventId||this.defaultEventId;this.systemEventService.publishAsync(e,this.search||"");this.actionButtonClick.emit()}};__decorate([d.Input(),__metadata("design:type",String)],t.ActionableSearchItemComponent.prototype,"search",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.ActionableSearchItemComponent.prototype,"eventId",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.ActionableSearchItemComponent.prototype,"actionText",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.ActionableSearchItemComponent.prototype,"actionButtonClick",void 0);t.ActionableSearchItemComponent=__decorate([d.Component({selector:"se-actionable-search-item",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-actionable-search-item]":"true"},template:`<div *ngIf="search" class="se-actionable-search-item"><div class="se-actionable-search-item__name">{{ search }}</div><button type="button" class="fd-button--light se-actionable-search-item__action-btn" (click)="onButtonClick()">{{ getActionText() | translate }}</button></div>`}),__metadata("design:paramtypes",[t.SystemEventService])],t.ActionableSearchItemComponent);const Bo=new d.InjectionToken("ITEM_COMPONENT_DATA");window.__smartedit__.addDecoratorPayload("Component","DefaultItemPrinterComponent",{selector:"se-default-item-printer",changeDetection:d.ChangeDetectionStrategy.OnPush,styles:[`.se-item-printer-text{vertical-align:middle;position:relative;max-width:100%;font-family:"72";color:#51555a;display:inline-block}`],template:`<span [attr.title]="((data.item.label || data.item.name) | seL10n | async) | translate" class="se-item-printer-text se-nowrap-ellipsis">{{ ((data.item.label || data.item.name) | seL10n | async) | translate }}</span>`});let Go=class DefaultItemPrinterComponent{constructor(e){this.data=e}};Go=__decorate([d.Component({selector:"se-default-item-printer",changeDetection:d.ChangeDetectionStrategy.OnPush,styles:[`.se-item-printer-text{vertical-align:middle;position:relative;max-width:100%;font-family:"72";color:#51555a;display:inline-block}`],template:`<span [attr.title]="((data.item.label || data.item.name) | seL10n | async) | translate" class="se-item-printer-text se-nowrap-ellipsis">{{ ((data.item.label || data.item.name) | seL10n | async) | translate }}</span>`}),__param(0,d.Inject(Bo)),__metadata("design:paramtypes",[Object])],Go);window.__smartedit__.addDecoratorPayload("Component","SearchInputComponent",{selector:"se-select-search-input",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-search-input]":"true"},template:`<div class="search"><input #searchInput type="search" class="search__input" [disabled]="isDisabled" [readOnly]="isReadOnly" [placeholder]="placeholder" [ngModel]="search" (ngModelChange)="onChange($event)" (keyup)="onKeyup($event)"/></div>`});let Ho=class SearchInputComponent{constructor(e,t){this.elementRef=e;this.sharedDataService=t;this.searchKeyup=new d.EventEmitter;this.searchChange=new d.EventEmitter}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.configurations=yield this.sharedDataService.get("configuration");this.initSearchInputFilter()}))}ngOnDestroy(){this.searchTermSubscription.unsubscribe()}get nativeElement(){return this.elementRef.nativeElement}get inputElement(){return this.searchInput.nativeElement}focus(){this.inputElement.focus()}onChange(e){this.isTypeAheadEnabled?this.searchTermSubject.next(e):this.searchChange.emit(e)}onKeyup(e){this.keyUpEvent=e;const t=e.target.value;this.isTypeAheadEnabled?this.searchTermSubject.next(t):this.searchKeyup.emit({event:this.keyUpEvent,value:t})}initSearchInputFilter(){this.searchTermSubject=new v.Subject;this.searchTerm$=this.searchTermSubject.asObservable().pipe(b.filter((e=>this.configurations&&this.configurations.typeAheadMiniSearchTermLength?e.length>0&&e.length>this.configurations.typeAheadMiniSearchTermLength:true)),b.debounceTime(this.configurations&&this.configurations.typeAheadDebounce||500),b.distinctUntilChanged());this.searchTermSubscription=this.searchTerm$.subscribe((e=>{this.searchKeyup.emit({event:this.keyUpEvent,value:e});this.searchChange.emit(e)}))}};__decorate([d.Input(),__metadata("design:type",Boolean)],Ho.prototype,"isDisabled",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],Ho.prototype,"isReadOnly",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],Ho.prototype,"isTypeAheadEnabled",void 0);__decorate([d.Input(),__metadata("design:type",String)],Ho.prototype,"placeholder",void 0);__decorate([d.Input(),__metadata("design:type",String)],Ho.prototype,"search",void 0);__decorate([d.Output(),__metadata("design:type",Object)],Ho.prototype,"searchKeyup",void 0);__decorate([d.Output(),__metadata("design:type",Object)],Ho.prototype,"searchChange",void 0);__decorate([d.ViewChild("searchInput",{static:false}),__metadata("design:type",d.ElementRef)],Ho.prototype,"searchInput",void 0);Ho=__decorate([d.Component({selector:"se-select-search-input",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-search-input]":"true"},template:`<div class="search"><input #searchInput type="search" class="search__input" [disabled]="isDisabled" [readOnly]="isReadOnly" [placeholder]="placeholder" [ngModel]="search" (ngModelChange)="onChange($event)" (keyup)="onKeyup($event)"/></div>`}),__metadata("design:paramtypes",[d.ElementRef,s.ISharedDataService])],Ho);window.__smartedit__.addDecoratorPayload("Component","SelectComponent",{selector:"se-select",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select]":"true"},template:`<fd-select [style.display]="'none'"></fd-select><div [attr.id]="id + '-selector'" class="select-container" [ngClass]="{\n        'has-warning': hasWarning(),\n        'has-error': hasError()\n    }"><ng-container *ngIf="multiSelect; then multi; else singleSelect"></ng-container><ng-template #singleSelect><fd-popover [triggers]="['click']" [(isOpen)]="isOpen" [placement]="'bottom'" (isOpenChange)="onSingleSelectIsOpenChange($event)"><fd-popover-control><div class="selected-container fd-select-custom" [attr.has-selected-option]="!!selected || null"><button fd-button class="fd-select-button-custom toggle-button" [disabled]="isReadOnly"><span *ngIf="!selected; else selectedItem" class="selected-placeholder">{{ placeholder | translate }}</span><ng-template #selectedItem><div class="selected-item"><span *ngIf="controls" class="glyphicon glyphicon-search"></span><se-item-printer *ngIf="selected" [attr.id]="id + '-selected'" [item]="selected" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span *ngIf="controls || showRemoveButton" class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, selected)"></span></div></ng-template></button></div></fd-popover-control><fd-popover-body><fd-menu class="se-select-list-container"><ng-container *ngIf="searchEnabled && isOpen"><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></ng-container><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></fd-menu></fd-popover-body></fd-popover></ng-template><ng-template #multi><div [ngClass]="{'se-multi-select': selected && selected.length > 0}"><div class="selected-container se-selected-list"><ng-container *ngIf="selected && selected.length > 0"><ol class="selected-list" cdkDropList (cdkDropListDropped)="onDrop($event)"><li *ngFor="let item of selected; trackBy: itemTrackBy" cdkDrag class="selected-list__item selected-item"><se-item-printer [item]="item" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, item)"></span></li></ol></ng-container></div></div><fd-popover class="se-multi-select" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="'bottom'"><fd-popover-control><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></fd-popover-control><fd-popover-body><fd-menu class="se-select-list-container"><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></fd-menu></fd-popover-body></fd-popover></ng-template><ng-template #resultsHeader><se-select-results-header [search]="search" [resultsHeaderComponent]="resultsHeaderComponent" [resultsHeaderLabel]="resultsHeaderLabel" [displayResultsHeaderLabel]="showResultsHeaderLabel()" [actionableSearchItem]="actionableSearchItem" (actionButtonClick)="closeAndReset()"></se-select-results-header></ng-template><ng-template #searchInputTemplate><se-select-search-input [isDisabled]="isReadOnly" [isReadOnly]="multiSelect && !searchEnabled" [isTypeAheadEnabled]="!multiSelect" [placeholder]="showPlaceholder() ? (placeholder | translate) : ''" [search]="search" (searchKeyup)="onSearchInputKeyup($event.event, $event.value)" (searchChange)="onSearchInputChange($event)"></se-select-search-input></ng-template><ng-template #selectListTemplate><se-select-list [id]="id" [isPagedDropdown]="isPagedDropdown()" [fetchPage]="fetchStrategy.fetchPage" [search]="search" [items]="items" [selected]="selected" [excludeSelected]="multiSelect" [disableChoiceFn]="disableChoiceFn" [itemComponent]="itemComponent" [selectComponentCtx]="this" (optionClick)="onOptionClick($event)" (infiniteScrollItemsChange)="onInfiniteScrollItemsChange()"></se-select-list></ng-template></div>`});t.SelectComponent=class SelectComponent{constructor(e,t,o){this.l10nService=e;this.logService=t;this.cdr=o;this.modelChange=new d.EventEmitter;this.controls=false;this.multiSelect=false;this.keepModelOnReset=false;this.isReadOnly=false;this.searchEnabled=true;this.resetSearchInput=true;this.showRemoveButton=false;this.getApi=new d.EventEmitter;this.resetChange=new d.EventEmitter;this.isOpen=false;this.items=[];this.search="";this.api={setValidationState:this.setValidationState.bind(this),resetValidationState:this.resetValidationState.bind(this)}}get isSingleCss(){return!this.multiSelect}get isMultiCss(){return this.multiSelect}get isPagedCss(){return this.isPagedDropdown()}clickHandler(e){if(!this.multiSelect){return}if(e.target===this.searchInputCmp.inputElement){e.stopPropagation();if(!this.isOpen){this.onMultiSelectIsOpenChange(true)}}else if(this.isOpen){this.onMultiSelectIsOpenChange(false)}}ngOnInit(){if(!this.placeholder){this.placeholder="se.genericeditor.sedropdown.placeholder"}if(this.fetchStrategy.fetchAll){this.initSearchInputFilter()}this.fetchData();setTimeout((()=>{this.resetChange.emit(this.internalReset.bind(this))}));this.getApi.emit(this.api)}ngOnChanges(e){if(!this.itemComponent){this.itemComponent=Go}this.isValidConfiguration();const t=e.model;const o=t&&t.currentValue!==this.modelChangeOld&&!t.firstChange;if(o){if(this.multiSelect&&this.isModelEmpty()){this.model=[]}this.fetchData()}}ngOnDestroy(){if(this.languageSwitchSubscription){this.languageSwitchSubscription.unsubscribe()}if(this.searchInputChangeSubject){this.searchInputChangeSubject.unsubscribe()}}onSingleSelectIsOpenChange(e){if(e){setTimeout((()=>{if(this.searchInputCmp){this.searchInputCmp.focus()}if(this.fetchStrategy.fetchAll){this.refreshOptions(this.search)}}))}else{this.resetOnClose()}}onSearchInputKeyup(e,t){this.internalKeyup(e,t)}onSearchInputChange(e){this.onSearchChange(e);if(this.searchInputChangeSubject){this.searchInputChangeSubject.next(e)}}onOptionClick(e){let t=false;if(this.multiSelect){const o=[...this.selected||[],e];this.setSelected(o);t=true}else if(!this.isItemSelected(e)){this.setSelected(e);t=true}this.internalOnSelect(e,e.id);if(t){this.internalOnChange()}this.closeAndReset()}onSearchChange(e){this.search=e}onDrop(e){A.moveItemInArray(this.selected,e.previousIndex,e.currentIndex);this.setSelected(this.selected);const t=e.previousIndex!==e.currentIndex;if(t){this.internalOnChange()}}removeSelectedOption(e,t){const o=this.multiSelect?this.selected.filter((e=>e!==t)):undefined;if(this.multiSelect){if(!this.searchInputCmp.isDisabled){this.setSelected(o);this.internalOnRemove(t,t.id)}}else{this.setSelected(o);this.internalOnRemove(t,t.id)}if(this.isOpen){this.closeAndReset()}}closeAndReset(){this.close();this.resetOnClose()}showResultsHeaderLabel(){return this.items.length>0&&!!this.resultsHeaderLabel}onInfiniteScrollItemsChange(){}showPlaceholder(){return this.multiSelect||!this.multiSelect&&!!this.selected}itemTrackBy(e,t){return t.id}setValidationState(e){this.validationState=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}resetValidationState(){this.validationState=undefined;if(!this.cdr.destroyed){this.cdr.detectChanges()}}hasError(){return bt.VALIDATION_ERROR===this.validationState}hasWarning(){return bt.WARNING===this.validationState}fetchEntity(e){return this.fetchStrategy.fetchEntity(e).then((e=>{if(!e){this.logService.debug("fetchEntity was used to fetch the option identified by "+e+" but failed to find a match")}return e}))}updateModelIfNotFoundInItems(e){if(!this.keepModelOnReset){if(this.multiSelect){if(this.isModelEmpty()){this.setSelected([],false);return}const t=this.model.filter((t=>this.getItemByModel(e,t)));const o=r.isEqual(this.model,t);if(!o){this.updateModel(t);this.resolveAndSetSelected(e)}else{this.resolveAndSetSelected(e)}return}if(this.isModelEmpty()){this.setSelected(undefined,false);return}const t=this.getItemByModel(e);if(!t){this.setSelected(undefined)}else{this.resolveAndSetSelected(e)}}}refreshOptions(e){this.internalFetchAll(e).then((e=>{this.items=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}isValidConfiguration(){if(this.resultsHeaderComponent&&this.resultsHeaderLabel){throw new Error(`Only one of "resultsHeaderComponent" or "resultsHeaderLabel" must be specified`)}if(!this.fetchStrategy.fetchAll&&!this.fetchStrategy.fetchPage){throw new Error("Neither fetchAll nor fetchPage have been specified in fetchStrategy")}if(this.fetchStrategy.fetchAll&&this.fetchStrategy.fetchPage){throw new Error("Only one of either fetchAll or fetchPage must be specified in fetchStrategy")}if(this.fetchStrategy.fetchPage&&this.model&&!this.fetchStrategy.fetchEntity&&!this.fetchStrategy.fetchEntities){throw new Error(`fetchPage has been specified in fetchStrategy but neither fetchEntity nor fetchEntities are available to load item identified by ${this.model}`)}if(this.isPagedDropdown()&&!this.keepModelOnReset){this.logService.debug("current Select is paged, so keepModelOnReset flag is ignored (it will always keep the model on reset).")}}internalKeyup(e,t){if(this.keyup){this.keyup(e,t)}}internalOnRemove(e,t){if(this.onRemove){this.onRemove(e,t)}this.internalOnChange()}internalOnChange(){if(this.onChange){this.onChange()}}internalOnSelect(e,t){if(this.onSelect){this.onSelect(e,t)}}internalFetchAll(e=""){return this.fetchStrategy.fetchAll(e).then((e=>{this.fetchAllItems=e;return[...e]}))}internalFetchEntities(){let e;if(!this.multiSelect){e=this.fetchEntity(this.model).then((e=>[e]))}else{if(this.fetchStrategy.fetchEntities){e=this.fetchStrategy.fetchEntities(this.model).then((e=>{if(e.length!==this.model.length){this.logService.debug(`!fetchEntities was used to fetch the options identified by ${JSON.stringify(this.model)} but failed to find all matches`)}return e}))}else{const t=this.model.map((e=>this.fetchEntity(e)));e=Promise.all(t)}}return e.then((e=>{const t=e.filter((e=>e!==null)).map((e=>{delete e.$promise;delete e.$resolved;e.technicalUniqueId=ae.encode(e);return e}));this.updateModelIfNotFoundInItems(t);this.internalOnChange();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}onMultiSelectIsOpenChange(e){this.isOpen=e;if(e){if(this.isPagedDropdown()){if(!this.cdr.destroyed){this.cdr.detectChanges()}return}this.refreshOptions(this.search)}else{this.resetOnClose()}}initSearchInputFilter(){this.searchInputChangeSubject=new v.Subject;this.searchInputChange$=this.searchInputChangeSubject.asObservable();this.languageSwitchSubscription=this.l10nService.languageSwitch$.subscribe((e=>{this.filterFn=getLocalizedFilterFn(e)}));this.searchInputChange$.pipe(b.filter((()=>typeof this.fetchStrategy.fetchAll!=="undefined")),b.tap((e=>{this.items=this.filterItemsBySearch(this.fetchAllItems,e);if(!this.cdr.destroyed){this.cdr.detectChanges()}})),b.debounceTime(500),b.switchMap((e=>this.internalFetchAll(e)))).subscribe((e=>{this.items=this.filterItemsBySearch(e,this.search);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}filterItemsBySearch(e,t){return e.filter((e=>this.filterFn(e.label||e.name).trim().toUpperCase().includes(t.trim().toUpperCase())))}close(){this.isOpen=false}resetOnClose(){if(this.search&&this.resetSearchInput){this.search="";if(!this.cdr.destroyed){this.cdr.detectChanges()}if(this.fetchStrategy.fetchAll){this.refreshOptions(this.search)}}}fetchData(){if(!this.isPagedDropdown()){this.internalFetchAllAndCheckModel()}else if(!this.isModelEmpty()){this.internalFetchEntities()}}internalFetchAllAndCheckModel(){return this.internalFetchAll().then((e=>{this.updateModelIfNotFoundInItems(e);this.internalOnChange();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getItemByModel(e,t=this.model){return e.find((e=>e.id===t))}getItemsByModel(e,t=this.model){return t.map((t=>this.getItemByModel(e,t))).filter((e=>!!e))}mapSelectedToModel(){return this.multiSelect?this.selected.map((e=>e.id)):this.selected.id}setSelected(e,t=true){this.selected=e;if(t){let e;if(this.selected){e=this.mapSelectedToModel()}this.updateModel(e)}}isItemSelected(e){if(!this.selected){return false}return e.id===this.selected.id}internalReset(e=false){this.items.length=0;if(e){this.selected=undefined;this.resetModel();return}if(!this.keepModelOnReset){this.fetchData()}}resetModel(){const e=this.multiSelect?[]:undefined;this.updateModel(e)}updateModel(e){this.model=e;this.modelChangeOld=this.model;this.modelChange.emit(e)}isPagedDropdown(){return!!this.fetchStrategy.fetchPage}isModelEmpty(){if(this.multiSelect){return!this.model||this.model&&this.model.length===0}else{return!this.model}}resolveAndSetSelected(e){const t=this.multiSelect?this.getItemsByModel(e):this.getItemByModel(e);this.setSelected(t,false)}};t.SelectComponent.$inject=["l10nService","logService","cdr"];__decorate([d.HostBinding("class.se-select--single"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],t.SelectComponent.prototype,"isSingleCss",null);__decorate([d.HostBinding("class.se-select--multi"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],t.SelectComponent.prototype,"isMultiCss",null);__decorate([d.HostBinding("class.se-select--paged"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],t.SelectComponent.prototype,"isPagedCss",null);__decorate([d.Input(),d.HostBinding("attr.id"),__metadata("design:type",String)],t.SelectComponent.prototype,"id",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"model",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.SelectComponent.prototype,"modelChange",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"fetchStrategy",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"controls",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"multiSelect",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"keepModelOnReset",void 0);__decorate([d.Input(),d.HostBinding("class.is-disabled"),__metadata("design:type",Object)],t.SelectComponent.prototype,"isReadOnly",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"actionableSearchItem",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],t.SelectComponent.prototype,"resultsHeaderComponent",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.SelectComponent.prototype,"resultsHeaderLabel",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"disableChoiceFn",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.SelectComponent.prototype,"placeholder",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],t.SelectComponent.prototype,"itemComponent",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"searchEnabled",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"resetSearchInput",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"onChange",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"onRemove",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"onSelect",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"keyup",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.SelectComponent.prototype,"showRemoveButton",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.SelectComponent.prototype,"getApi",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.SelectComponent.prototype,"reset",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.SelectComponent.prototype,"resetChange",void 0);__decorate([d.ViewChild(Ho,{static:false}),__metadata("design:type",Ho)],t.SelectComponent.prototype,"searchInputCmp",void 0);__decorate([d.HostListener("document:click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[MouseEvent]),__metadata("design:returntype",void 0)],t.SelectComponent.prototype,"clickHandler",null);t.SelectComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-select",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select]":"true"},template:`<fd-select [style.display]="'none'"></fd-select><div [attr.id]="id + '-selector'" class="select-container" [ngClass]="{\n        'has-warning': hasWarning(),\n        'has-error': hasError()\n    }"><ng-container *ngIf="multiSelect; then multi; else singleSelect"></ng-container><ng-template #singleSelect><fd-popover [triggers]="['click']" [(isOpen)]="isOpen" [placement]="'bottom'" (isOpenChange)="onSingleSelectIsOpenChange($event)"><fd-popover-control><div class="selected-container fd-select-custom" [attr.has-selected-option]="!!selected || null"><button fd-button class="fd-select-button-custom toggle-button" [disabled]="isReadOnly"><span *ngIf="!selected; else selectedItem" class="selected-placeholder">{{ placeholder | translate }}</span><ng-template #selectedItem><div class="selected-item"><span *ngIf="controls" class="glyphicon glyphicon-search"></span><se-item-printer *ngIf="selected" [attr.id]="id + '-selected'" [item]="selected" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span *ngIf="controls || showRemoveButton" class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, selected)"></span></div></ng-template></button></div></fd-popover-control><fd-popover-body><fd-menu class="se-select-list-container"><ng-container *ngIf="searchEnabled && isOpen"><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></ng-container><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></fd-menu></fd-popover-body></fd-popover></ng-template><ng-template #multi><div [ngClass]="{'se-multi-select': selected && selected.length > 0}"><div class="selected-container se-selected-list"><ng-container *ngIf="selected && selected.length > 0"><ol class="selected-list" cdkDropList (cdkDropListDropped)="onDrop($event)"><li *ngFor="let item of selected; trackBy: itemTrackBy" cdkDrag class="selected-list__item selected-item"><se-item-printer [item]="item" [component]="itemComponent" [selectComponentCtx]="this"></se-item-printer><span class="sap-icon--sys-cancel selected-item__remove-button" (click)="removeSelectedOption($event, item)"></span></li></ol></ng-container></div></div><fd-popover class="se-multi-select" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="'bottom'"><fd-popover-control><ng-container *ngTemplateOutlet="searchInputTemplate"></ng-container></fd-popover-control><fd-popover-body><fd-menu class="se-select-list-container"><ng-container *ngTemplateOutlet="resultsHeader"></ng-container><ng-container *ngIf="isOpen"><ng-container *ngTemplateOutlet="selectListTemplate"></ng-container></ng-container></fd-menu></fd-popover-body></fd-popover></ng-template><ng-template #resultsHeader><se-select-results-header [search]="search" [resultsHeaderComponent]="resultsHeaderComponent" [resultsHeaderLabel]="resultsHeaderLabel" [displayResultsHeaderLabel]="showResultsHeaderLabel()" [actionableSearchItem]="actionableSearchItem" (actionButtonClick)="closeAndReset()"></se-select-results-header></ng-template><ng-template #searchInputTemplate><se-select-search-input [isDisabled]="isReadOnly" [isReadOnly]="multiSelect && !searchEnabled" [isTypeAheadEnabled]="!multiSelect" [placeholder]="showPlaceholder() ? (placeholder | translate) : ''" [search]="search" (searchKeyup)="onSearchInputKeyup($event.event, $event.value)" (searchChange)="onSearchInputChange($event)"></se-select-search-input></ng-template><ng-template #selectListTemplate><se-select-list [id]="id" [isPagedDropdown]="isPagedDropdown()" [fetchPage]="fetchStrategy.fetchPage" [search]="search" [items]="items" [selected]="selected" [excludeSelected]="multiSelect" [disableChoiceFn]="disableChoiceFn" [itemComponent]="itemComponent" [selectComponentCtx]="this" (optionClick)="onOptionClick($event)" (infiniteScrollItemsChange)="onInfiniteScrollItemsChange()"></se-select-list></ng-template></div>`}),__metadata("design:paramtypes",[t.L10nService,s.LogService,d.ChangeDetectorRef])],t.SelectComponent);window.__smartedit__.addDecoratorPayload("Component","ItemPrinterComponent",{selector:"se-item-printer",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-item-printer]":"true"},template:`<ng-container *ngComponentOutlet="component; injector: componentInjector"></ng-container>`});let Wo=class ItemPrinterComponent{constructor(e){this.injector=e;this.isSelected=true}ngOnChanges(e){if(e.item){this.itemComponentData=this.createItemComponentData();if(this.component){this.componentInjector=this.createItemComponentInjector()}}}createItemComponentData(){return{item:this.item,selected:this.isSelected,select:this.selectComponentCtx}}createItemComponentInjector(){return d.Injector.create({parent:this.injector,providers:[{provide:Bo,useValue:this.itemComponentData}]})}};__decorate([d.Input(),__metadata("design:type",Object)],Wo.prototype,"item",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],Wo.prototype,"component",void 0);__decorate([d.Input(),__metadata("design:type",t.SelectComponent)],Wo.prototype,"selectComponentCtx",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Wo.prototype,"isSelected",void 0);Wo=__decorate([d.Component({selector:"se-item-printer",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-item-printer]":"true"},template:`<ng-container *ngComponentOutlet="component; injector: componentInjector"></ng-container>`}),__metadata("design:paramtypes",[d.Injector])],Wo);window.__smartedit__.addDecoratorPayload("Component","ResultsHeaderComponent",{selector:"se-select-results-header",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-results-header]":"true"},template:`<div *ngIf="showResultsHeaderItem() || resultsHeaderLabel || actionableSearchItem" class="results-header"><div *ngIf="showResultsHeaderItem()"><ng-container *ngComponentOutlet="resultsHeaderComponent"></ng-container></div><se-actionable-search-item *ngIf="actionableSearchItem" [search]="search" [eventId]="actionableSearchItem.eventId" [actionText]="actionableSearchItem.actionText" (actionButtonClick)="onActionButtonClick()"></se-actionable-search-item><li class="fd-menu__list-header" *ngIf="displayResultsHeaderLabel">{{ resultsHeaderLabel | translate }}</li></div>`});let qo=class ResultsHeaderComponent{constructor(){this.actionButtonClick=new d.EventEmitter}onActionButtonClick(){this.actionButtonClick.emit()}showResultsHeaderItem(){return typeof this.resultsHeaderComponent!=="undefined"}};__decorate([d.Input(),__metadata("design:type",String)],qo.prototype,"search",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],qo.prototype,"resultsHeaderComponent",void 0);__decorate([d.Input(),__metadata("design:type",String)],qo.prototype,"resultsHeaderLabel",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],qo.prototype,"displayResultsHeaderLabel",void 0);__decorate([d.Input(),__metadata("design:type",Object)],qo.prototype,"actionableSearchItem",void 0);__decorate([d.Output(),__metadata("design:type",Object)],qo.prototype,"actionButtonClick",void 0);qo=__decorate([d.Component({selector:"se-select-results-header",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-results-header]":"true"},template:`<div *ngIf="showResultsHeaderItem() || resultsHeaderLabel || actionableSearchItem" class="results-header"><div *ngIf="showResultsHeaderItem()"><ng-container *ngComponentOutlet="resultsHeaderComponent"></ng-container></div><se-actionable-search-item *ngIf="actionableSearchItem" [search]="search" [eventId]="actionableSearchItem.eventId" [actionText]="actionableSearchItem.actionText" (actionButtonClick)="onActionButtonClick()"></se-actionable-search-item><li class="fd-menu__list-header" *ngIf="displayResultsHeaderLabel">{{ resultsHeaderLabel | translate }}</li></div>`})],qo);window.__smartedit__.addDecoratorPayload("Component","SelectListComponent",{selector:"se-select-list",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-list]":"true"},template:`<se-infinite-scrolling *ngIf="isPagedDropdown; else selectList" [pageSize]="infiniteScrollingPageSize" [mask]="search" [fetchPage]="fetchPage" [context]="selectComponentCtx" (itemsChange)="onInfiniteScrollItemsChange()"><ng-container *ngTemplateOutlet="selectList"></ng-container></se-infinite-scrolling><ng-template #selectList><ol [attr.id]="id +'-list'" fd-menu-list suListKeyboardControl [suListKeyboardControlDisabledPredicate]="keyboardControlDisabledPredicate" (suListKeyboardControlEnterKeydown)="onEnterKeydown($event)" [ngClass]="{ 'fd-menu__list--basic': !isPagedDropdown }"><ng-container *ngFor="let item of items; trackBy: itemTrackBy"><li *ngIf="(excludeSelected && !isItemSelected(item)) || !excludeSelected" suListItemKeyboardControl class="se-select-list__item" [ngClass]="{'is-selected': (!excludeSelected && isItemSelected(item)), 'is-disabled': isItemDisabled(item)}"><fd-option (click)="onOptionClick($event, item)" class="menu-option"><se-item-printer [item]="item" [isSelected]="false" [component]="itemComponent" [selectComponentCtx]="selectComponentCtx"></se-item-printer></fd-option></li></ng-container></ol></ng-template>`});let Ko=class SelectListComponent{constructor(){this.isPagedDropdown=false;this.excludeSelected=false;this.optionClick=new d.EventEmitter;this.infiniteScrollItemsChange=new d.EventEmitter;this.infiniteScrollingPageSize=10}keyboardControlDisabledPredicate(e){return e.getElement().classList.contains("is-disabled")}itemTrackBy(e,t){return t.id}isItemSelected(e){const t=Array.isArray(this.selected);if(!this.selected||t&&this.selected.length===0){return false}return t?!!this.selected.find((t=>t.id===e.id)):e.id===this.selected.id}onOptionClick(e,t){if(this.isItemDisabled(t)){e.stopPropagation();return}this.optionClick.emit(t)}onEnterKeydown(e){const t=this.getItems();const o=t[e];this.optionClick.emit(o)}isItemDisabled(e){return this.disableChoiceFn?this.disableChoiceFn(e):false}onInfiniteScrollItemsChange(){this.infiniteScrollItemsChange.emit()}getItems(){if(this.excludeSelected){return this.items.filter((e=>!this.isItemSelected(e)))}else{return this.items}}};__decorate([d.Input(),__metadata("design:type",String)],Ko.prototype,"id",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Ko.prototype,"isPagedDropdown",void 0);__decorate([d.Input(),__metadata("design:type",Function)],Ko.prototype,"fetchPage",void 0);__decorate([d.Input(),__metadata("design:type",String)],Ko.prototype,"search",void 0);__decorate([d.Input(),__metadata("design:type",Array)],Ko.prototype,"items",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Ko.prototype,"selected",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Ko.prototype,"excludeSelected",void 0);__decorate([d.Input(),__metadata("design:type",Function)],Ko.prototype,"disableChoiceFn",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],Ko.prototype,"itemComponent",void 0);__decorate([d.Input(),__metadata("design:type",t.SelectComponent)],Ko.prototype,"selectComponentCtx",void 0);__decorate([d.Output(),__metadata("design:type",Object)],Ko.prototype,"optionClick",void 0);__decorate([d.Output(),__metadata("design:type",Object)],Ko.prototype,"infiniteScrollItemsChange",void 0);Ko=__decorate([d.Component({selector:"se-select-list",changeDetection:d.ChangeDetectionStrategy.OnPush,host:{"[class.se-select-list]":"true"},template:`<se-infinite-scrolling *ngIf="isPagedDropdown; else selectList" [pageSize]="infiniteScrollingPageSize" [mask]="search" [fetchPage]="fetchPage" [context]="selectComponentCtx" (itemsChange)="onInfiniteScrollItemsChange()"><ng-container *ngTemplateOutlet="selectList"></ng-container></se-infinite-scrolling><ng-template #selectList><ol [attr.id]="id +'-list'" fd-menu-list suListKeyboardControl [suListKeyboardControlDisabledPredicate]="keyboardControlDisabledPredicate" (suListKeyboardControlEnterKeydown)="onEnterKeydown($event)" [ngClass]="{ 'fd-menu__list--basic': !isPagedDropdown }"><ng-container *ngFor="let item of items; trackBy: itemTrackBy"><li *ngIf="(excludeSelected && !isItemSelected(item)) || !excludeSelected" suListItemKeyboardControl class="se-select-list__item" [ngClass]="{'is-selected': (!excludeSelected && isItemSelected(item)), 'is-disabled': isItemDisabled(item)}"><fd-option (click)="onOptionClick($event, item)" class="menu-option"><se-item-printer [item]="item" [isSelected]="false" [component]="itemComponent" [selectComponentCtx]="selectComponentCtx"></se-item-printer></fd-option></li></ng-container></ol></ng-template>`})],Ko);t.SelectModule=class SelectModule{};t.SelectModule=__decorate([d.NgModule({imports:[f.CommonModule,w.FormsModule,A.DragDropModule,I.PopoverModule,I.ButtonModule,I.MenuModule,I.SelectModule,I.FormModule,t.InfiniteScrollingModule,t.CompileHtmlModule,t.L10nPipeModule,s.ListKeyboardControlModule,s.TranslationModule.forChild()],declarations:[t.SelectComponent,Go,Wo,t.ActionableSearchItemComponent,Ko,Ho,qo],entryComponents:[t.SelectComponent,Go,Wo,t.ActionableSearchItemComponent,Ko,Ho,qo],exports:[t.SelectComponent]})],t.SelectModule);let Yo=class ContentManager{constructor(){this.onSuccess=new d.EventEmitter;this.onError=new d.EventEmitter;this.submitting=false}set option(e){this._onSave=e.onSave}save(){this.submitting=true;return this._onSave().pipe(b.finalize((()=>this.submitting=false)),b.tap((e=>{this.onSuccess.emit(e)})),b.catchError((e=>{this.onError.emit(e);return v.throwError(e)})))}};__decorate([d.Input("contentManager"),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],Yo.prototype,"option",null);__decorate([d.Output(),__metadata("design:type",Object)],Yo.prototype,"onSuccess",void 0);__decorate([d.Output(),__metadata("design:type",Object)],Yo.prototype,"onError",void 0);Yo=__decorate([d.Directive({selector:"[contentManager]"})],Yo);const createApi=e=>({setSubmitButtonText:t=>{e.submitButtonText=t},setCancelButtonText:t=>{e.cancelButtonText=t},setAlwaysShowSubmit:t=>{e.alwaysShowSubmit=t},setAlwaysShowReset:t=>{e.alwaysShowReset=t},setOnReset:t=>{e.onReset=t},setPreparePayload:t=>{e.preparePayload=t},setUpdateCallback:t=>{e.updateCallback=t},updateContent:t=>{e.form&&e.form.patchComponent(t)},getContent:()=>e.form?ui.copy(e.form.component):undefined,onContentChange(){return},addContentChangeEvent:t=>{e.onChangeEvents.push(t);return()=>{const o=e.onChangeEvents.findIndex((e=>e===t));if(o>-1){e.onChangeEvents.splice(o,1)}}},triggerContentChangeEvents:()=>{e.onChangeEvents.forEach((t=>{t(ui.copy(e.form.component))}))},clearMessages:()=>{e.form.removeValidationMessages()},switchToTabContainingQualifier:t=>{e.targetedQualifier=t},considerFormDirty:()=>{e.initialDirty=true},setInProgress:t=>{e.inProgress=t},isSubmitDisabled:()=>e.isSubmitDisabled(),getLanguages:()=>null,setAlwaysEnableSubmit:t=>{e.alwaysEnableSubmit=t}});const Zo=new d.InjectionToken("GENERIC_EDITOR_WIDGET_DATA");window.__smartedit__.addDecoratorPayload("Component","BooleanComponent",{selector:"se-boolean",template:`<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label" for="{{qualifierId}}-checkbox"><input type="checkbox" id="{{qualifierId}}-checkbox" class="se-boolean__input" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]" (click)="checkboxOnClick($event.target)"/> <span class="fd-toggle__switch" role="presentation"></span></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>`});t.BooleanComponent=class BooleanComponent{constructor(e,t){this.systemEventService=e;this.widget=t}ngOnInit(){this.eventId=`${this.widget.id}${this.widget.qualifier}${Tt}`;this.qualifierId=this.widget.qualifier+ae.generateIdentifier();if(this.widget.model[this.widget.qualifier]===undefined){const e=this.widget.field.defaultValue!==undefined?this.widget.field.defaultValue:false;this.widget.model[this.widget.qualifier]=e;this.widget.editor.pristine[this.widget.qualifier]=e}this.systemEventService.publishAsync(this.eventId,`${this.widget.model[this.widget.qualifier]}`)}checkboxOnClick(e){this.systemEventService.publishAsync(this.eventId,`${e.checked}`)}};t.BooleanComponent=__decorate([d.Component({selector:"se-boolean",template:`<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label" for="{{qualifierId}}-checkbox"><input type="checkbox" id="{{qualifierId}}-checkbox" class="se-boolean__input" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]" (click)="checkboxOnClick($event.target)"/> <span class="fd-toggle__switch" role="presentation"></span></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>`}),__param(1,d.Inject(Zo)),__metadata("design:paramtypes",[t.SystemEventService,Object])],t.BooleanComponent);t.BooleanModule=class BooleanModule{};t.BooleanModule=__decorate([d.NgModule({imports:[f.CommonModule,w.FormsModule,S.TranslateModule.forChild()],declarations:[t.BooleanComponent],entryComponents:[t.BooleanComponent],exports:[t.BooleanComponent]})],t.BooleanModule);const Xo=new d.InjectionToken("resolvedLocaleToMomentLocaleMap");const Qo=new d.InjectionToken("tooltipsMap");let Jo=class DateTimePickerLocalizationService{constructor(e,t,o,n){this.translate=e;this.resolvedLocaleToMomentLocaleMap=t;this.tooltipsMap=o;this.languageService=n}localizeDateTimePicker(e){return __awaiter(this,void 0,void 0,(function*(){yield this.localizeDateTimePickerUI(e);this.localizeDateTimePickerTooltips(e)}))}convertResolvedToMomentLocale(e){const t=this.resolvedLocaleToMomentLocaleMap[e];if(t){return t}else{return e}}getLocalizedTooltips(){const e={};for(const t in this.tooltipsMap){if(this.tooltipsMap.hasOwnProperty(t)){e[t]=this.translate.instant(this.tooltipsMap[t])}}return e}compareTooltips(e,t){for(const o in this.tooltipsMap){if(e[o]!==t[o]){return false}}return true}localizeDateTimePickerUI(e){return this.languageService.getResolveLocale().then((t=>{const o=this.convertResolvedToMomentLocale(t);if(e.locale()!==o){e.locale(o)}}))}localizeDateTimePickerTooltips(e){const t=e.tooltips();const o=this.getLocalizedTooltips();if(!this.compareTooltips(t,o)){e.tooltips(o)}}};Jo.$inject=["translate","resolvedLocaleToMomentLocaleMap","tooltipsMap","languageService"];Jo=__decorate([SeDowngradeService(),__param(1,d.Inject(Xo)),__param(2,d.Inject(Qo)),__metadata("design:paramtypes",[S.TranslateService,Object,Object,t.LanguageService])],Jo);const en={format:At.MOMENT_FORMAT,keepOpen:true,minDate:new Date(0),showClear:true,showClose:true,useCurrent:false,widgetPositioning:{horizontal:"right",vertical:"bottom"}};const tn={in:"id",zh:"zh-cn"};const on={today:"se.datetimepicker.today",clear:"se.datetimepicker.clear",close:"se.datetimepicker.close",selectMonth:"se.datetimepicker.selectmonth",prevMonth:"se.datetimepicker.previousmonth",nextMonth:"se.datetimepicker.nextmonth",selectYear:"se.datetimepicker.selectyear",prevYear:"se.datetimepicker.prevyear",nextYear:"se.datetimepicker.nextyear",selectDecade:"se.datetimepicker.selectdecade",prevDecade:"se.datetimepicker.prevdecade",nextDecade:"se.datetimepicker.nextdecade",prevCentury:"se.datetimepicker.prevcentury",nextCentury:"se.datetimepicker.nextcentury",pickHour:"se.datetimepicker.pickhour",incrementHour:"se.datetimepicker.incrementhour",decrementHour:"se.datetimepicker.decrementhour",pickMinute:"se.datetimepicker.pickminute",incrementMinute:"se.datetimepicker.incrementminute",decrementMinute:"se.datetimepicker.decrementminute",pickSecond:"se.datetimepicker.picksecond",incrementSecond:"se.datetimepicker.incrementsecond",decrementSecond:"se.datetimepicker.decrementsecond",togglePeriod:"se.datetimepicker.toggleperiod",selectTime:"se.datetimepicker.selecttime"};let nn=class DateFormatterDirective{constructor(e,t,o,n){this.ngModel=e;this.element=t;this.renderer=o;this.datePipe=n}ngOnInit(){this.ngModel.valueChanges.subscribe((e=>{const t=this.datePipe.transform(e,this.formatType||At.ANGULAR_FORMAT);if(t!==e){this.renderer.setProperty(this.element.nativeElement,"value",t)}}))}};__decorate([d.Input(),__metadata("design:type",String)],nn.prototype,"formatType",void 0);nn=__decorate([d.Directive({selector:"[ngModel][dateFormatter]",providers:[w.NgModel,f.DatePipe]}),__metadata("design:paramtypes",[w.NgModel,d.ElementRef,d.Renderer2,f.DatePipe])],nn);window.__smartedit__.addDecoratorPayload("Component","DateTimePickerComponent",{selector:"se-date-time-picker",template:`<div #dateTimePicker *ngIf="isEditable" class="input-group se-date-field" id="date-time-picker-{{widget.field.qualifier}}"><input type="text" class="fd-form-control se-date-field--input" [ngClass]="{\n            'is-invalid': widget.field.hasErrors,\n            'is-warning': widget.field.hasWarnings,\n            'se-input--is-disabled': !isEditable\n        }" [placeholder]="placeholderText | translate" [attr.name]="widget.field.qualifier"/> <span class="input-group-addon se-date-field--button" [ngClass]="{ 'se-date-field--button-has-error': widget.field.hasErrors, 'se-date-field--button-has-warning': widget.field.hasWarnings }"><span class="sap-icon--calendar se-date-field--button-icon"></span></span></div><div class="input-group date se-date-field" *ngIf="!isEditable" id="date-time-picker-{{widget.field.qualifier}}"><input type="text" class="fd-form-control se-date-field--input" [ngClass]="{'se-input--is-disabled': !isEditable}" [(ngModel)]="widget.model[this.widget.qualifier]" dateFormatter formatType="short" [disabled]="true"/></div>`});let sn=class DateTimePickerComponent{constructor(e,t,o){this.widget=e;this.yjQuery=t;this.dateTimePickerLocalizationService=o;this.placeholderText="se.componentform.select.date"}ngAfterViewInit(){if(this.isEditable){this.node.datetimepicker(en).on("dp.change",(()=>this.handleDatePickerChange())).on("dp.show",(()=>this.handleDatePickerShow()));if(this.widget.model[this.widget.qualifier]){setTimeout((()=>{this.datetimepicker.date(V["default"](this.widget.model[this.widget.qualifier]))}))}}}handleDatePickerShow(){this.dateTimePickerLocalizationService.localizeDateTimePicker(this.datetimepicker)}handleDatePickerChange(){const e=this.datetimepicker.date();this.widget.model[this.widget.qualifier]=e?vi.formatDateAsUtc(e):undefined}get node(){return this.yjQuery(this.dateTimePickerElement.nativeElement)}get datetimepicker(){return this.node.datetimepicker().data("DateTimePicker")}get isEditable(){return!this.widget.isFieldDisabled()}};__decorate([d.ViewChild("dateTimePicker",{static:false}),__metadata("design:type",d.ElementRef)],sn.prototype,"dateTimePickerElement",void 0);sn=__decorate([d.Component({selector:"se-date-time-picker",template:`<div #dateTimePicker *ngIf="isEditable" class="input-group se-date-field" id="date-time-picker-{{widget.field.qualifier}}"><input type="text" class="fd-form-control se-date-field--input" [ngClass]="{\n            'is-invalid': widget.field.hasErrors,\n            'is-warning': widget.field.hasWarnings,\n            'se-input--is-disabled': !isEditable\n        }" [placeholder]="placeholderText | translate" [attr.name]="widget.field.qualifier"/> <span class="input-group-addon se-date-field--button" [ngClass]="{ 'se-date-field--button-has-error': widget.field.hasErrors, 'se-date-field--button-has-warning': widget.field.hasWarnings }"><span class="sap-icon--calendar se-date-field--button-icon"></span></span></div><div class="input-group date se-date-field" *ngIf="!isEditable" id="date-time-picker-{{widget.field.qualifier}}"><input type="text" class="fd-form-control se-date-field--input" [ngClass]="{'se-input--is-disabled': !isEditable}" [(ngModel)]="widget.model[this.widget.qualifier]" dateFormatter formatType="short" [disabled]="true"/></div>`}),__param(0,d.Inject(Zo)),__param(1,d.Inject(Qi)),__metadata("design:paramtypes",[Object,Function,Jo])],sn);let an=class DateTimePickerModule{};an=__decorate([d.NgModule({imports:[f.CommonModule,w.FormsModule,S.TranslateModule.forChild()],providers:[{provide:Xo,useValue:tn},{provide:Qo,useValue:on},Jo],declarations:[nn,sn],entryComponents:[sn],exports:[nn,sn]})],an);window.__smartedit__.addDecoratorPayload("Component","DropdownItemPrinterComponent",{selector:"se-dropdown-item-printer",template:` <span>{{ data.item.label }}</span> `});let rn=class DropdownItemPrinterComponent{constructor(e){this.data=e}};rn=__decorate([d.Component({selector:"se-dropdown-item-printer",template:` <span>{{ data.item.label }}</span> `}),__param(0,d.Inject(Bo)),__metadata("design:paramtypes",[Object])],rn);window.__smartedit__.addDecoratorPayload("Component","DropdownComponent",{selector:"se-dropdown-wrapper",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [searchEnabled]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"\n        ></se-select>\n    `});let ln=class DropdownComponent{constructor(e){this.data=e;this.itemComponent=rn;const{field:{options:t}}=e;this.fetchStrategy={fetchAll:()=>Promise.resolve(t)}}};ln=__decorate([d.Component({selector:"se-dropdown-wrapper",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [searchEnabled]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"\n        ></se-select>\n    `}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],ln);window.__smartedit__.addDecoratorPayload("Component","EditableDropdownComponent",{selector:"se-editable-dropdown",template:`<se-generic-editor-dropdown [id]="data.id" [field]="data.field" [qualifier]="data.qualifier" [model]="data.model"></se-generic-editor-dropdown>`});let cn=class EditableDropdownComponent{constructor(e){this.data=e}};cn=__decorate([d.Component({selector:"se-editable-dropdown",template:`<se-generic-editor-dropdown [id]="data.id" [field]="data.field" [qualifier]="data.qualifier" [model]="data.model"></se-generic-editor-dropdown>`}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],cn);const dn=new d.InjectionToken(Et);const pn=new d.InjectionToken("DROPDOWN_IMPLEMENTATION_SUFFIX_TOKEN");const mn=new d.InjectionToken(Tt);class IGenericEditorDropdownServiceConstructor{constructor(e){}}function genericEditorDropdownComponentOnInit(){this.field.params=this.field.params||{};this.field.params.catalogId=this.field.params.catalogId||_e;this.field.params.catalogVersion=this.field.params.catalogVersion||fe;const e=this.GenericEditorDropdownService||this.SEDropdownService;this.dropdown=new e({field:this.field,qualifier:this.qualifier,model:this.model,id:this.id,onClickOtherDropdown:this.onClickOtherDropdown.bind(this),getApi:this.getApi});this.dropdown.init()}window.__smartedit__.addDecoratorPayload("Component","GenericEditorDropdownComponent",{selector:"se-generic-editor-dropdown",host:{"[class.se-generic-editor-dropdown]":"true"},template:`<se-select *ngIf="dropdown.initialized" [id]="dropdown.qualifier" (click)="dropdown.onClick()" [placeholder]="field.placeholder" [(model)]="model[qualifier]" [onChange]="dropdown.triggerAction" [fetchStrategy]="dropdown.fetchStrategy" [(reset)]="dropdown.reset" [multiSelect]="dropdown.isMultiDropdown" [controls]="dropdown.isMultiDropdown" [showRemoveButton]="showRemoveButton" [isReadOnly]="!field.editable" [itemComponent]="itemComponent" [resultsHeaderComponent]="resultsHeaderComponent" [actionableSearchItem]="actionableSearchItem" (getApi)="dropdown.setSelectAPI($event)" (resetChange)="onResetChange($event)"></se-select>`});t.GenericEditorDropdownComponent=class GenericEditorDropdownComponent{constructor(e){this.GenericEditorDropdownService=e;this.resetChange=new d.EventEmitter}ngOnInit(){genericEditorDropdownComponentOnInit.call(this)}onClickOtherDropdown(){this.selectComponent.closeAndReset()}onResetChange(e){this.resetChange.emit(e)}};t.GenericEditorDropdownComponent.$inject=["GenericEditorDropdownService"];__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorDropdownComponent.prototype,"id",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"field",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorDropdownComponent.prototype,"qualifier",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"model",void 0);__decorate([d.Input(),__metadata("design:type",Boolean)],t.GenericEditorDropdownComponent.prototype,"showRemoveButton",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],t.GenericEditorDropdownComponent.prototype,"itemComponent",void 0);__decorate([d.Input(),__metadata("design:type",d.Type)],t.GenericEditorDropdownComponent.prototype,"resultsHeaderComponent",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"actionableSearchItem",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorDropdownComponent.prototype,"reset",void 0);__decorate([d.Output(),__metadata("design:type",Object)],t.GenericEditorDropdownComponent.prototype,"resetChange",void 0);__decorate([d.ViewChild(t.SelectComponent,{static:false}),__metadata("design:type",t.SelectComponent)],t.GenericEditorDropdownComponent.prototype,"selectComponent",void 0);t.GenericEditorDropdownComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-generic-editor-dropdown",host:{"[class.se-generic-editor-dropdown]":"true"},template:`<se-select *ngIf="dropdown.initialized" [id]="dropdown.qualifier" (click)="dropdown.onClick()" [placeholder]="field.placeholder" [(model)]="model[qualifier]" [onChange]="dropdown.triggerAction" [fetchStrategy]="dropdown.fetchStrategy" [(reset)]="dropdown.reset" [multiSelect]="dropdown.isMultiDropdown" [controls]="dropdown.isMultiDropdown" [showRemoveButton]="showRemoveButton" [isReadOnly]="!field.editable" [itemComponent]="itemComponent" [resultsHeaderComponent]="resultsHeaderComponent" [actionableSearchItem]="actionableSearchItem" (getApi)="dropdown.setSelectAPI($event)" (resetChange)="onResetChange($event)"></se-select>`}),__metadata("design:paramtypes",[IGenericEditorDropdownServiceConstructor])],t.GenericEditorDropdownComponent);const GenericEditorDropdownServiceFactory=(e,t,o,n,s,a,d,p,m)=>{const g=e.$injector();return class{constructor(e){this.field=e.field;this.qualifier=e.qualifier;this.model=e.model;this.id=e.id;this.onClickOtherDropdown=e.onClickOtherDropdown;this.items=[];this.getApi=e.getApi;this.setYSelectAPI=e=>{this.ySelectAPI=e};this.setSelectAPI=e=>{this.selectAPI=e};this.$api={setResultsHeaderTemplateUrl:e=>{this.resultsHeaderTemplateUrl=e},setResultsHeaderTemplate:e=>{this.resultsHeaderTemplate=e}}}init(){this.initializeAngularJSAPI();this._setPopulatorName();this.isMultiDropdown=this.field.collection?this.field.collection:false;this.triggerAction=this.triggerAction.bind(this);this.eventId=(this.id||"")+o;this.clickEventKey=(this.id||"")+n;if(this.field.dependsOn){a.subscribe(this.eventId,this._respondToChange.bind(this))}a.subscribe(this.clickEventKey,this._respondToOtherClicks.bind(this));const e=this._resolvePopulator();if(!e){throw new Error("se.dropdown.no.populator.found")}({instance:this.populator,isPaged:this.isPaged}=e);this.fetchStrategy={fetchEntity:this.fetchEntity.bind(this)};if(this.isPaged){this.fetchStrategy.fetchPage=this.fetchPage.bind(this)}else{this.fetchStrategy.fetchAll=this.fetchAll.bind(this)}this.initialized=true}initializeAngularJSAPI(){if(typeof this.getApi==="function"){this.getApi({$api:this.$api})}}triggerAction(){const e=this.items.filter((e=>e.id===this.model[this.qualifier]))[0];const t={qualifier:this.qualifier,optionObject:e};this._setValidationState(this.getState(this.field));a.publishAsync(this.eventId,t)}onClick(){a.publishAsync(this.clickEventKey,this.field.qualifier)}fetchAll(e){return this.populator.fetchAll({field:this.field,model:this.model,selection:this.selection,search:e}).then((e=>{this.items=e;return this.items}))}fetchEntity(e){return this.populator.getItem({field:this.field,id:e,model:this.model})}fetchPage(e,o,n,s){return this.populator.fetchPage({field:this.field,model:this.model,selection:this.selection,search:e,pageSize:o,currentPage:n}).then((e=>{const t=hi.getKeyHoldingDataFromResponse(e);e.results=e[t];delete e[t];this.items=[...this.items,...e.results];if(this.isMultiDropdown&&s){return this.limitToNonSelectedItems(e,s)}else{return e}})).catch((e=>{t.error(`Failed to fetch items and paging information. ${e}`)}))}isInclude(e,t){let o=false;t.forEach((t=>{if(t.uid===e.uid){o=true}}));return o}limitToNonSelectedItems(e,t){const o=e.results.length;for(let n=o-1;n>=0;n--){const o=e.results[n];if(this.isInclude(o,t)){e.results.splice(n,1);e.pagination.count--}}return e}getState(e){return e.hasErrors?bt.VALIDATION_ERROR:e.hasWarnings?bt.WARNING:undefined}isPopulatorPaged(e){return e.isPaged&&e.isPaged()}_setPopulatorName(){this.populatorName={options:d.constructor.name,uri:p.constructor.name,propertyType:this.field.propertyType+s,cmsStructureType:this.field.cmsStructureType+s,smarteditComponentType:{withQualifier:this.field.smarteditComponentType+this.field.qualifier+s,withQualifierForDowngradedService:r.camelCase(this.field.smarteditComponentType+this.field.qualifier+s),withoutQualifier:this.field.smarteditComponentType+s}}}_setValidationState(e){const t=this.ySelectAPI||this.selectAPI;if(t){t.setValidationState(e)}}_respondToChange(e,t){if(this.field.dependsOn&&this.field.dependsOn.split(",").indexOf(t.qualifier)>-1){this.selection=t.optionObject;if(this.reset){this.reset()}}}_respondToOtherClicks(e,t){if(this.field.qualifier!==t&&typeof this.onClickOtherDropdown==="function"){this.onClickOtherDropdown(e,t)}}_resolvePopulator(){if(this.field.options&&this.field.uri){throw new Error("se.dropdown.contains.both.uri.and.options")}if(this.field.options){return{instance:this._resolvePopulatorByName(this.populatorName.options),isPaged:false}}if(this.field.uri){return{instance:this._resolvePopulatorByName(this.populatorName.uri),isPaged:this._isFieldPaged(this.field)}}if(this.field.propertyType){const e=this._resolvePopulatorByName(this.populatorName.propertyType);return{instance:e,isPaged:this.isPopulatorPaged(e)}}const e=this._resolvePopulatorByName(this.populatorName.cmsStructureType);if(e){return{instance:e,isPaged:this._isFieldPaged(this.field)}}const t=this._resolvePopulatorByName(this.populatorName.smarteditComponentType.withQualifier);if(t){return{instance:t,isPaged:this.isPopulatorPaged(t)}}const o=this._resolvePopulatorByName(this.populatorName.smarteditComponentType.withQualifierForDowngradedService);if(o){return{instance:o,isPaged:this.isPopulatorPaged(o)}}const n=this._resolvePopulatorByName(this.populatorName.smarteditComponentType.withoutQualifier);if(n){return{instance:n,isPaged:this.isPopulatorPaged(n)}}return undefined}_resolvePopulatorByName(e){if(e===d.constructor.name){return d}if(e===p.constructor.name){return p}if(g.has(e)){return g.get(e)}if(m&&m.length>0){return m.find((t=>t.constructor.name.toUpperCase()===e.toUpperCase()))}return undefined}_isFieldPaged(e){return this.field.paged?this.field.paged:false}}};class DropdownPopulatorInterface{constructor(e,t,o){this.lodash=e;this.languageService=t;this.translateService=o}getItem(e){return null}fetchAll(e){"proxyFunction";return null}fetchPage(e){"proxyFunction";return null}isPaged(){return false}populateAttributes(e,t,o){return this.lodash.map(e,(e=>{if(t&&this.lodash.isEmpty(e.id)){e.id=e[t]}if(o&&this.lodash.isEmpty(e.label)){const t=this.lodash.find(o,(t=>!this.lodash.isEmpty(e[t])));if(t){e.label=e[t]}}return e}))}search(e,t){return this.languageService.getResolveLocale().then((o=>this.lodash.filter(e,(e=>{let n;if(this.lodash.isObject(e.label)){o=e.label[o]?o:Object.keys(e.label)[0];n=e.label[o]}else{n=this.translateService?this.translateService.instant(e.label):e.label}return n&&n.toUpperCase().indexOf(t.toUpperCase())>-1}))))}}t.OptionsDropdownPopulator=class OptionsDropdownPopulator extends DropdownPopulatorInterface{constructor(e,t){super(k,e,t);this.languageService=e;this.translateService=t}fetchAll(e){const t=this.populateAttributes(e.field.options,e.field.idAttribute,e.field.labelAttributes);if(e.search){return this.search(t,e.search)}return Promise.resolve(t)}};t.OptionsDropdownPopulator.$inject=["languageService","translateService"];t.OptionsDropdownPopulator=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[t.LanguageService,S.TranslateService])],t.OptionsDropdownPopulator);const gn=new d.InjectionToken("CustomDropdownPopulatorsToken");const un=new d.InjectionToken("IDropdownPopulatorInterface");t.UriDropdownPopulator=class UriDropdownPopulator extends DropdownPopulatorInterface{constructor(e,t,o){super(k,t,o);this.restServiceFactory=e;this.languageService=t;this.translateService=o}fetchAll(e){let t;if(e.field.dependsOn){t=this._buildQueryParams(e.field.dependsOn,e.model)}return this.restServiceFactory.get(e.field.uri).get(t).then((t=>{const o=hi.getDataFromResponse(t);const n=this.populateAttributes(o,e.field.idAttribute,e.field.labelAttributes);if(e.search){return this.search(n,e.search)}return Promise.resolve(n)}))}fetchPage(e){let t={};if(e.field.dependsOn){t=this._buildQueryParams(e.field.dependsOn,e.model)}t.pageSize=e.pageSize;t.currentPage=e.currentPage;t.mask=e.search;if(e.field.params){this.lodash.extend(t,e.field.params)}return this.restServiceFactory.get(e.field.uri).get(t).then((t=>{const o=hi.getKeyHoldingDataFromResponse(t);t[o]=this.populateAttributes(t[o],e.field.idAttribute,e.field.labelAttributes);return Promise.resolve(t)}))}getItem(e){return this.restServiceFactory.get(e.field.uri).getById(e.id).then((t=>{t=this.populateAttributes([t],e.field.idAttribute,e.field.labelAttributes)[0];return Promise.resolve(t)}))}_buildQueryParams(e,t){const o=e.split(",").reduce(((e,o)=>{e[o]=t[o];return e}),{});return o}};t.UriDropdownPopulator.$inject=["restServiceFactory","languageService","translateService"];t.UriDropdownPopulator=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[s.RestServiceFactory,t.LanguageService,S.TranslateService])],t.UriDropdownPopulator);const dropdownPopulatorInterfaceConstructorFactory=(e,t)=>class extends DropdownPopulatorInterface{constructor(){super(k,e,t)}};t.DropdownPopulatorModule=class DropdownPopulatorModule{};t.DropdownPopulatorModule=__decorate([d.NgModule({providers:[t.OptionsDropdownPopulator,t.UriDropdownPopulator,{provide:un,useFactory:dropdownPopulatorInterfaceConstructorFactory,deps:[t.LanguageService,S.TranslateService]},se.initialize((()=>{Y.downgradeService("DropdownPopulatorInterface",null,un)}))]})],t.DropdownPopulatorModule);t.GenericEditorDropdownModule=class GenericEditorDropdownModule{};t.GenericEditorDropdownModule=__decorate([d.NgModule({imports:[f.CommonModule,t.SelectModule,t.DropdownPopulatorModule],declarations:[t.GenericEditorDropdownComponent],entryComponents:[t.GenericEditorDropdownComponent],exports:[t.GenericEditorDropdownComponent],providers:[{provide:pn,useValue:"DropdownPopulator"},{provide:dn,useValue:Et},{provide:mn,useValue:Tt},{provide:IGenericEditorDropdownServiceConstructor,useFactory:GenericEditorDropdownServiceFactory,deps:[t.AngularJSLazyDependenciesService,s.LogService,dn,mn,pn,t.SystemEventService,t.OptionsDropdownPopulator,t.UriDropdownPopulator,[new d.Optional,gn]]},se.initialize((()=>{Y.downgradeService("SEDropdownService",IGenericEditorDropdownServiceConstructor);Y.downgradeService("DROPDOWN_IMPLEMENTATION_SUFFIX",null,pn);Y.downgradeService("LINKED_DROPDOWN",null,dn);Y.downgradeService("CLICK_DROPDOWN",null,mn)}))]})],t.GenericEditorDropdownModule);let hn=class EditableDropdownModule{};hn=__decorate([d.NgModule({imports:[f.CommonModule,t.GenericEditorDropdownModule],declarations:[cn],entryComponents:[cn],exports:[cn]})],hn);window.__smartedit__.addDecoratorPayload("Component","EmailComponent",{selector:"se-email",template:`<input [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [max]="255" type="email" id="{{widget.field.qualifier}}-shortstring" class="fd-form-control"/>`});let vn=class EmailComponent{constructor(e){this.widget=e}};vn.$inject=["widget"];vn=__decorate([SeDowngradeComponent(),d.Component({selector:"se-email",template:`<input [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [max]="255" type="email" id="{{widget.field.qualifier}}-shortstring" class="fd-form-control"/>`}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],vn);let _n=class EmailModule{};_n=__decorate([d.NgModule({imports:[f.CommonModule,S.TranslateModule.forChild(),w.FormsModule],declarations:[vn],entryComponents:[vn],exports:[vn]})],_n);window.__smartedit__.addDecoratorPayload("Component","EnumItemPrinterComponent",{selector:"se-enum-item-printer",template:` <span id="enum-{{ data.select.id }}">{{ data.item.label }}</span> `});let fn=class EnumItemPrinterComponent{constructor(e){this.data=e}};fn=__decorate([d.Component({selector:"se-enum-item-printer",template:` <span id="enum-{{ data.select.id }}">{{ data.item.label }}</span> `}),__param(0,d.Inject(Bo)),__metadata("design:paramtypes",[Object])],fn);window.__smartedit__.addDecoratorPayload("Component","EnumComponent",{selector:"se-enum",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [isReadOnly]="data.isFieldDisabled()"\n            [resetSearchInput]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"\n            [showRemoveButton]="true"\n        ></se-select>\n    `});let yn=class EnumComponent{constructor(e){this.data=e;this.itemComponent=fn;const{editor:t,field:o,qualifier:n}=e;this.fetchStrategy={fetchAll:e=>__awaiter(this,void 0,void 0,(function*(){yield t.refreshOptions(o,n,e);const s=o.options[n];const a=s.map((e=>Object.assign(Object.assign({},e),{id:e.code})));return a}))}}};yn=__decorate([d.Component({selector:"se-enum",template:`\n        <se-select\n            [id]="data.field.qualifier"\n            class="se-generic-editor-dropdown"\n            [(model)]="data.model[data.qualifier]"\n            [isReadOnly]="data.isFieldDisabled()"\n            [resetSearchInput]="false"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [placeholder]="'se.genericeditor.sedropdown.placeholder'"\n            [showRemoveButton]="true"\n        ></se-select>\n    `}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],yn);const Sn="0.01";window.__smartedit__.addDecoratorPayload("Component","FloatComponent",{selector:"se-float",template:`<input pattern="^[-]?([0-9]*)(.[0-9]{1,5})?$" type="number" id="{{widget.field.qualifier}}-float" class="fd-form-control" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [step]="precision"/>`});let Cn=class FloatComponent{constructor(e){this.widget=e;this.precision=Sn}};Cn.$inject=["widget"];Cn=__decorate([SeDowngradeComponent(),d.Component({selector:"se-float",template:`<input pattern="^[-]?([0-9]*)(.[0-9]{1,5})?$" type="number" id="{{widget.field.qualifier}}-float" class="fd-form-control" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.field.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" [step]="precision"/>`}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],Cn);let bn=class FloatModule{};bn=__decorate([d.NgModule({imports:[f.CommonModule,S.TranslateModule.forChild(),w.FormsModule],declarations:[Cn],entryComponents:[Cn],exports:[Cn]})],bn);window.__smartedit__.addDecoratorPayload("Component","LongStringComponent",{template:`\n        <textarea\n            class="fd-form__control"\n            [ngClass]="{ 'is-invalid': data.field.hasErrors, 'is-warning': data.field.hasWarnings }"\n            [placeholder]="data.field.tooltip || '' | translate"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"\n        ></textarea>\n    `,selector:"se-long-string"});let In=class LongStringComponent{constructor(e){this.data=e}};In=__decorate([d.Component({template:`\n        <textarea\n            class="fd-form__control"\n            [ngClass]="{ 'is-invalid': data.field.hasErrors, 'is-warning': data.field.hasWarnings }"\n            [placeholder]="data.field.tooltip || '' | translate"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"\n        ></textarea>\n    `,selector:"se-long-string"}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],In);window.__smartedit__.addDecoratorPayload("Component","NumberComponent",{selector:"se-number",template:`<input [min]="1" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" id="{{widget.qualifier}}-number" class="fd-form-control" type="number"/>`});t.NumberComponent=class NumberComponent{constructor(e,t){this.systemEventService=e;this.widget=t;const o=`${this.widget.id}${this.widget.field.dependsOnField}${Tt}`;this.unRegClickValueChanged=this.systemEventService.subscribe(o,((e,t)=>this.onClickEvent(t)))}onClickEvent(e){this.widget.field.hideFieldWidget=e!==this.widget.field.dependsOnValue;if(this.widget.field.hideFieldWidget){this.widget.model[this.widget.qualifier]=null}}};t.NumberComponent.$inject=["systemEventService","widget"];t.NumberComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-number",template:`<input [min]="1" [ngClass]="{ 'is-invalid': widget.field.hasErrors, 'is-warning': widget.field.hasWarnings }" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" id="{{widget.qualifier}}-number" class="fd-form-control" type="number"/>`}),__param(1,d.Inject(Zo)),__metadata("design:paramtypes",[t.SystemEventService,Object])],t.NumberComponent);t.NumberModule=class NumberModule{};t.NumberModule=__decorate([d.NgModule({imports:[f.CommonModule,S.TranslateModule.forChild(),w.FormsModule],declarations:[t.NumberComponent],entryComponents:[t.NumberComponent],exports:[t.NumberComponent]})],t.NumberModule);const wn=new d.InjectionToken("resolvedLocaleToCKEDITORLocaleMap");const En=new d.InjectionToken("richTextConfiguration");t.GenericEditorSanitizationService=class GenericEditorSanitizationService{constructor(e){this.domSanitizer=e}isSanitized(e){const t=this.domSanitizer.sanitize(d.SecurityContext.HTML,e).replace(/&#10;/g,"\n").replace(/&#160;/g,"").replace(/<br>/g,"<br />");const o=e.replace(/&#10;/g,"\n").replace(/&#160;/g,"").replace(/<br>/g,"<br />");return t===o}};t.GenericEditorSanitizationService.$inject=["domSanitizer"];t.GenericEditorSanitizationService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[O.DomSanitizer])],t.GenericEditorSanitizationService);t.RichTextFieldLocalizationService=class RichTextFieldLocalizationService{constructor(e,t){this.languageService=e;this.resolvedLocaleToCKEDITORLocaleMap=t}localizeCKEditor(){return this.languageService.getResolveLocale().then((e=>{CKEDITOR.config.language=this.convertResolvedToCKEditorLocale(e)}))}convertResolvedToCKEditorLocale(e){const t=this.resolvedLocaleToCKEDITORLocaleMap[e];if(t){return t}return e}};t.RichTextFieldLocalizationService.$inject=["languageService","resolvedLocaleToCKEDITORLocaleMap"];t.RichTextFieldLocalizationService=__decorate([SeDowngradeService(),__param(1,d.Inject(wn)),__metadata("design:paramtypes",[t.LanguageService,Object])],t.RichTextFieldLocalizationService);t.RichTextLoaderService=class RichTextLoaderService{constructor(){this.loadPromise=new Promise((e=>{this.checkLoadedInterval=setInterval((()=>{if(CKEDITOR.status==="loaded"){e();clearInterval(this.checkLoadedInterval);this.checkLoadedInterval=null}}),100)}))}load(){return this.loadPromise}};t.RichTextLoaderService=__decorate([SeDowngradeService(),__metadata("design:paramtypes",[])],t.RichTextLoaderService);window.__smartedit__.addDecoratorPayload("Component","RichTextFieldComponent",{selector:"se-rich-text-field",template:`<textarea #textarea class="fd-form__control" [ngClass]="{'has-error': widget.field.hasErrors}" name="{{widget.field.qualifier}}-{{widget.qualifier}}" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" (change)="reassignUserCheck()"></textarea><div *ngIf="requiresUserCheck()"><div id="richTextWarningMessage" [hidden]="widget.field.isUserChecked"><span fd-status-label [status]="'warning'" [icon]="'message-warning'">{{'se.editor.richtext.message.warning' | translate}}</span></div><input id="richTextWarningCheckBox" type="checkbox" [(ngModel)]="widget.field.isUserChecked" (click)="checkboxOnClick($event.target)"/> <span [ngClass]="{'warning-check-msg': true, 'not-checked': widget.editor.hasFrontEndValidationErrors && !widget.field.isUserChecked}">{{'se.editor.richtext.check' | translate}}</span></div>`});t.RichTextFieldComponent=class RichTextFieldComponent{constructor(e,t,o,n,s,a){this.widget=e;this.seRichTextLoaderService=t;this.seRichTextConfiguration=o;this.genericEditorSanitizationService=n;this.seRichTextFieldLocalizationService=s;this.settingsService=a}ngAfterViewInit(){return this.settingsService.get("cms.components.allowUnsafeJavaScript").then((e=>this.seRichTextLoaderService.load().then((()=>{this.seRichTextConfiguration.allowedContent=e==="true";this.editorInstance=CKEDITOR.replace(this.textarea.nativeElement,this.seRichTextConfiguration);this.seRichTextFieldLocalizationService.localizeCKEditor();if(this.editorInstance){this.editorInstance.on("change",(()=>this.onChange()));this.editorInstance.on("mode",(()=>this.onMode()));CKEDITOR.on("instanceReady",(e=>this.onInstanceReady(e)))}}))))}ngOnDestroy(){if(this.editorInstance&&CKEDITOR.instances[this.editorInstance.name]){CKEDITOR.instances[this.editorInstance.name].destroy()}}onChange(){setTimeout((()=>{this.widget.model[this.widget.qualifier]=this.editorInstance.getData();this.reassignUserCheck();this.toggleSubmitButton(this.requiresUserCheck()&&!this.widget.field.isUserChecked)}))}onMode(){if(this.editorInstance.mode==="source"){const e=this.editorInstance.editable();e.attachListener(e,"input",(()=>{this.editorInstance.fire("change")}))}}onInstanceReady(e){const t=CKEDITOR.dtd;const o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t.$nonBodyContent),t.$block),t.$listItem),t.$tableContent),{br:1});for(const t of Object.keys(o)){e.editor.dataProcessor.writer.setRules(t,{indent:false,breakBeforeOpen:false,breakAfterOpen:false,breakBeforeClose:false,breakAfterClose:false})}e.editor.dataProcessor.writer.lineBreakChars="";e.editor.dataProcessor.writer.indentationChars=""}requiresUserCheck(){let e=false;for(const t in this.widget.field.requiresUserCheck){if(this.widget.field.requiresUserCheck.hasOwnProperty(t)){e=e||this.widget.field.requiresUserCheck[t]}}return e}reassignUserCheck(){if(this.widget.model&&this.widget.qualifier&&this.widget.model[this.widget.qualifier]){const e=this.genericEditorSanitizationService.isSanitized(this.widget.model[this.widget.qualifier]);this.widget.field.requiresUserCheck=this.widget.field.requiresUserCheck||{};this.widget.field.requiresUserCheck[this.widget.qualifier]=!e}else{this.widget.field.requiresUserCheck=this.widget.field.requiresUserCheck||{};this.widget.field.requiresUserCheck[this.widget.qualifier]=false}}checkboxOnClick(e){this.toggleSubmitButton(!e.checked)}toggleSubmitButton(e){this.widget.editor.api.setInProgress(e)}};t.RichTextFieldComponent.$inject=["widget","seRichTextLoaderService","seRichTextConfiguration","genericEditorSanitizationService","seRichTextFieldLocalizationService","settingsService"];__decorate([d.ViewChild("textarea",{static:false}),__metadata("design:type",d.ElementRef)],t.RichTextFieldComponent.prototype,"textarea",void 0);t.RichTextFieldComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-rich-text-field",template:`<textarea #textarea class="fd-form__control" [ngClass]="{'has-error': widget.field.hasErrors}" name="{{widget.field.qualifier}}-{{widget.qualifier}}" [disabled]="widget.isFieldDisabled()" [(ngModel)]="widget.model[widget.qualifier]" (change)="reassignUserCheck()"></textarea><div *ngIf="requiresUserCheck()"><div id="richTextWarningMessage" [hidden]="widget.field.isUserChecked"><span fd-status-label [status]="'warning'" [icon]="'message-warning'">{{'se.editor.richtext.message.warning' | translate}}</span></div><input id="richTextWarningCheckBox" type="checkbox" [(ngModel)]="widget.field.isUserChecked" (click)="checkboxOnClick($event.target)"/> <span [ngClass]="{'warning-check-msg': true, 'not-checked': widget.editor.hasFrontEndValidationErrors && !widget.field.isUserChecked}">{{'se.editor.richtext.check' | translate}}</span></div>`}),__param(0,d.Inject(Zo)),__param(2,d.Inject(En)),__metadata("design:paramtypes",[Object,t.RichTextLoaderService,Object,t.GenericEditorSanitizationService,t.RichTextFieldLocalizationService,t.SettingsService])],t.RichTextFieldComponent);t.RichTextFieldModule=class RichTextFieldModule{};t.RichTextFieldModule=__decorate([d.NgModule({imports:[f.CommonModule,w.FormsModule,S.TranslateModule.forChild(),I.BadgeLabelModule],providers:[t.GenericEditorSanitizationService,t.RichTextFieldLocalizationService,t.RichTextLoaderService,t.SettingsService,{provide:wn,useValue:{in:"id",es_CO:"es"}},{provide:En,useValue:{toolbar:"full",toolbar_full:[{name:"basicstyles",items:["Bold","Italic","Strike","Underline"]},{name:"paragraph",items:["BulletedList","NumberedList","Blockquote"]},{name:"editing",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"tools",items:["SpellChecker","Maximize"]},"/",{name:"styles",items:["Format","Font","FontSize","TextColor","PasteText","PasteFromWord","RemoveFormat"]},{name:"insert",items:["Image","Table","SpecialChar"]},{name:"forms",items:["Outdent","Indent"]},"/",{name:"clipboard",items:["Undo","Redo"]},{name:"document",items:["PageBreak","Source"]}],disableNativeSpellChecker:false,height:"100px",width:"100%",autoParagraph:false,basicEntities:false,fillEmptyBlocks:false,extraAllowedContent:"div(*)[role]",extraPlugins:"colorbutton, colordialog, font",font_names:"Arial/Arial, Helvetica, sans-serif;Times New Roman/Times New Roman, Times, serif;Verdana",fontSize_sizes:"10/10px;12/12px;14/14px;16/16px;18/18px;20/20px;22/22px;24/24px;36/36px;48/48px;",protectedSource:[/\r|\n|\r\n|\t/g]}}],declarations:[t.RichTextFieldComponent],entryComponents:[t.RichTextFieldComponent],exports:[t.RichTextFieldComponent]})],t.RichTextFieldModule);window.__smartedit__.addDecoratorPayload("Component","ShortStringComponent",{template:`\n        <input\n            type="text"\n            id="{{ data.field.qualifier }}-shortstring"\n            [ngClass]="{\n                'is-invalid': data.field.hasErrors,\n                'is-warning': data.field.hasWarnings\n            }"\n            class="fd-form-control"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"\n        />\n    `,selector:"se-short-string"});t.ShortStringComponent=class ShortStringComponent{constructor(e){this.data=e}};t.ShortStringComponent=__decorate([d.Component({template:`\n        <input\n            type="text"\n            id="{{ data.field.qualifier }}-shortstring"\n            [ngClass]="{\n                'is-invalid': data.field.hasErrors,\n                'is-warning': data.field.hasWarnings\n            }"\n            class="fd-form-control"\n            [attr.name]="data.field.qualifier"\n            [disabled]="data.isFieldDisabled()"\n            [(ngModel)]="data.model[data.qualifier]"\n        />\n    `,selector:"se-short-string"}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],t.ShortStringComponent);window.__smartedit__.addDecoratorPayload("Component","TextComponent",{template:` <p [id]="data.field.qualifier + '-text'">{{ data.model[data.qualifier] }}</p> `,selector:"se-component-text"});let Tn=class TextComponent{constructor(e){this.data=e}};Tn=__decorate([d.Component({template:` <p [id]="data.field.qualifier + '-text'">{{ data.model[data.qualifier] }}</p> `,selector:"se-component-text"}),__param(0,d.Inject(Zo)),__metadata("design:paramtypes",[Object])],Tn);var Pn;const An="0.01";t.EditorFieldMappingService=Pn=class EditorFieldMappingService{constructor(e){this.logService=e;this._editorsFieldMapping=[];this._fieldsTabsMapping=[]}addFieldMapping(e,t,o,n){this._addMapping(e,t,o,n,this._editorsFieldMapping)}getEditorFieldMapping(e,t){let o=this._getMapping(e,t,this._editorsFieldMapping);if(!o){this.logService.warn("editorFieldMappingService - Cannot find suitable field mapping for type ",e.cmsStructureType);o=null}else if(o&&o.template){o.template=this._cleanTemplate(o.template)}return o}addFieldTabMapping(e,t,o,n){this._addMapping(e,t,o,n,this._fieldsTabsMapping)}getFieldTabMapping(e,t){return this._getMapping(e,t,this._fieldsTabsMapping)}_addMapping(e,t,o,n,s){e=this._validateField(e);t=this._validateField(t);o=this._validateField(o);const a={structureTypeMatcher:e,componentTypeMatcher:t,discriminatorMatcher:o,value:n};r.remove(s,(n=>n.structureTypeMatcher===e&&n.componentTypeMatcher===t&&n.discriminatorMatcher===o));s.push(a)}_validateField(e){if(e===null){e=Pn.WILDCARD}else if(typeof e!=="string"&&typeof e!=="function"){throw new Error("editorFieldMappingService: Mapping matcher must be of type string or function.")}return e}_getMapping(e,t,o){let n=null;let s=0;o.forEach((o=>{const a=this._evaluateMapping(o,e,t);if(a>s){n=o.value;s=a}}));return n}_evaluateMapping(e,t,o){let n;let s;let a=Pn.MATCH.NONE;const r=this._evaluateMatcher(e.structureTypeMatcher,t.cmsStructureType,t,o);if(r!==Pn.MATCH.NONE){n=this._evaluateMatcher(e.componentTypeMatcher,t.smarteditComponentType,t,o);if(n!==Pn.MATCH.NONE){s=this._evaluateMatcher(e.discriminatorMatcher,t.qualifier,t,o)}}if(r!==Pn.MATCH.NONE&&n!==Pn.MATCH.NONE&&s!==Pn.MATCH.NONE){a=r+n+s}return a}_evaluateMatcher(e,t,o,n){if(typeof e==="string"){if(e===Pn.WILDCARD){return Pn.MATCH.PARTIAL}else{return this._exactValueMatchPredicate(e,t)?Pn.MATCH.EXACT:Pn.MATCH.NONE}}else{return e(t,o,n)?Pn.MATCH.EXACT:Pn.MATCH.NONE}}_registerDefaultFieldMappings(){if(!this._initialized){this._initialized=true;this.addFieldMapping("Boolean",null,null,{component:t.BooleanComponent});this.addFieldMapping("ShortString",null,null,{component:t.ShortStringComponent,validators:{notBlank:(e,t,o,n)=>!!o?!!o:undefined}});this.addFieldMapping("Text",null,null,{component:Tn});this.addFieldMapping("LongString",null,null,{component:In});this.addFieldMapping("RichText",null,null,{component:t.RichTextFieldComponent});this.addFieldMapping("Number",null,null,{component:t.NumberComponent});this.addFieldMapping("Float",null,null,{component:Cn});this.addFieldMapping("Dropdown",null,null,{component:ln});this.addFieldMapping("EditableDropdown",null,null,{component:cn});this.addFieldMapping("DateTime",null,null,{component:sn});this.addFieldMapping("Enum",null,null,{component:yn});this.addFieldMapping("Email",null,null,{component:vn,validators:{email:(e,t,o,n)=>true}})}}_cleanTemplate(e){const t=e?e.lastIndexOf("/"):-1;if(t!==-1){e=e.substring(t+1)}return e}_exactValueMatchPredicate(e,t){return e===t}};t.EditorFieldMappingService.WILDCARD="*";t.EditorFieldMappingService.MATCH={NONE:0,PARTIAL:1,EXACT:4};t.EditorFieldMappingService=Pn=__decorate([SeDowngradeService(),d.Injectable(),__metadata("design:paramtypes",[s.LogService])],t.EditorFieldMappingService);var On;t.FetchEnumDataHandler=On=class FetchEnumDataHandler{constructor(e){this.restServiceFactory=e;this.restServiceForEnum=this.restServiceFactory.get(It)}static resetForTests(){On.cache={}}findByMask(e,t){return(On.cache[e.cmsStructureEnumType]?Promise.resolve(On.cache[e.cmsStructureEnumType]):Promise.resolve(this.restServiceForEnum.get({enumClass:e.cmsStructureEnumType}))).then((o=>{On.cache[e.cmsStructureEnumType]=o;return On.cache[e.cmsStructureEnumType].enums.filter((e=>s.stringUtils.isBlank(t)||e.label.toUpperCase().indexOf(t.toUpperCase())>-1))}))}getById(e,t){return null}};t.FetchEnumDataHandler.cache={};t.FetchEnumDataHandler=On=__decorate([SeDowngradeService(),d.Injectable(),__metadata("design:paramtypes",[s.RestServiceFactory])],t.FetchEnumDataHandler);const parseValidationMessage=e=>{const t=new RegExp("[a-zA-Z]+: ([|{)([a-zA-Z0-9]+)(]|}).?","g");const o=e.match(t)||[];return o.reduce(((e,t)=>{e.message=e.message.replace(t,"").trim();const o=t.split(":")[0].trim().toLowerCase();const n=t.split(":")[1].match(/[a-zA-Z0-9]+/g)[0];e[o]=n;return e}),{message:e})};t.SeValidationMessageParser=class SeValidationMessageParser{parse(e){return parseValidationMessage(e)}};t.SeValidationMessageParser=__decorate([SeDowngradeService(),d.Injectable()],t.SeValidationMessageParser);t.GenericEditorFactoryService=class GenericEditorFactoryService{constructor(e,o,n,s,a,d,p,m,g){g._registerDefaultFieldMappings();this.genericEditorConstructor=class{constructor(e){this.schema$=new v.BehaviorSubject(null);this.data$=new v.BehaviorSubject(null);this.submitButtonText="se.componentform.actions.submit";this.cancelButtonText="se.componentform.actions.cancel";this.api=createApi(this);this.onSubmit=e=>{if(this.smarteditComponentId){e.identifier=this.smarteditComponentId}if(this.editorCRUDService&&!this.smarteditComponentId){if(this.structure&&this.structure.type){if(!e.type){e.type=this.structure.type}}}return this.preparePayload(e).then((t=>{const o=this.editorCRUDService?this.smarteditComponentId?this.editorCRUDService.update(t):this.editorCRUDService.save(t):Promise.resolve(t);return o.then((function(t){return{payload:e,response:t}}))}))};this.submit$=()=>v.from(this.submit(this.form.component));this.onSuccess=e=>{let t;if(e.response){t=ui.copy(e.response)}else{t=ui.copy(e.payload)}delete t.identifier;if(!this.smarteditComponentId&&e.response){this.smarteditComponentId=e.response.uuid}this.form&&this.form.removeValidationMessages();this.inProgress=false;if(this.updateCallback){this.updateCallback(t,e.response)}};this.onFailure=e=>{this.form.removeValidationMessages();const t=e.error?e.error.errors:[];this.form.displayValidationMessages(t,true);const o=this.form.collectUnrelatedValidationMessages(t);if(o.length>0){a.publishAsync(Ct,{messages:o,sourceGenericEditorId:this.id})}this.inProgress=false};this.isSubmitDisabled=()=>{if(this.inProgress){return true}else if(!this.isDirty()||!this.isValid()){return!this.alwaysEnableSubmit}else{return false}};this._validate(e);this.id=e.id;this.inProgress=false;this.smarteditComponentType=e.smarteditComponentType;this.smarteditComponentId=e.smarteditComponentId;this.editorStackId=e.editorStackId||this.id;this.updateCallback=e.updateCallback;this.structure=e.structure;this.onChangeEvents=[];if(e.structureApi){this.editorStructureService=o.get(e.structureApi)}this.uriContext=e.uriContext;if(e.contentApi){this.editorCRUDService=o.get(e.contentApi)}this.initialContent=r.cloneDeep(e.content);this.initialDirty=false;if(e.customOnSubmit){this.onSubmit=e.customOnSubmit}this._unregisterUnrelatedMessagesEvent=a.subscribe(Ct,this._handleUnrelatedValidationMessages.bind(this));this.element=e.element}get pristine(){return this.form?this.form.pristine:undefined}get nativeForm(){return this.element.querySelector("form")}setForm(e){this.form=e;this.form.group.valueChanges.subscribe((()=>{this.api.triggerContentChangeEvents()}))}_finalize(){this._unregisterUnrelatedMessagesEvent();this.popEditorFromStack()}popEditorFromStack(){if(!this.editorStackId){return}a.publishAsync(t.GenericEditorStackService.EDITOR_POP_FROM_STACK_EVENT,{editorStackId:this.editorStackId})}reset(e){this.form&&this.form.removeValidationMessages();const t=this.editorStructureService?this.editorStructureService.get({smarteditComponentType:this.smarteditComponentType}):Promise.resolve(this.structure);return this._getUriContext().then((e=>Promise.all([this.api.getLanguages()||n.getLanguagesForSite(e[ye]),t.then((e=>this._convertStructureArray(e))),Promise.resolve(e)]))).then((([t,o,n])=>{const s={id:this.id,languages:t,structure:o,uriContext:n,smarteditComponentType:this.smarteditComponentType,targetedQualifier:this.targetedQualifier};this.schema$.next(s);this.data$.next(e?e:this.pristine);return}))}fetch(){if(!this.initialDirty){return this.initialContent?Promise.resolve(this.initialContent):this.smarteditComponentId?this.editorCRUDService.getById(this.smarteditComponentId).then((e=>e||{})):Promise.resolve({})}return Promise.resolve({})}load(){return this.fetch().then((e=>this.reset(e)),(e=>{d.error("GenericEditor.load failed");d.error(e)}))}getComponent(){return this.form&&this.form.component||null}preparePayload(e){return Promise.resolve(this.form.sanitizedPayload(e))}submit(e){this.form.removeValidationMessages();this.hasFrontEndValidationErrors=false;if(!this.form.fieldsAreUserChecked()){this.hasFrontEndValidationErrors=true;return Promise.reject(true)}else if(this.isValid(true)){this.inProgress=true;return this.onSubmit(e)}else{d.warn("GenericEditor.submit() - unable to submit form. Form is unexpectedly invalid.");return Promise.reject({})}}refreshOptions(e,t,o){return new Promise((n=>{const s=this._getRefreshHandleContructorOrToken(e.cmsStructureType);const a=this._getDataHandler(s);let r;let d;if(e.localized){r=this.form.component[e.qualifier][t];d=t}else{r=this.form.component[e.qualifier];d=e.qualifier}e.initiated=e.initiated||[];e.options=e.options||{};if(e.cmsStructureType==="Enum"){e.initiated.push(d)}if(e.initiated.indexOf(d)>-1){if(o.length>2||e.cmsStructureType==="Enum"){return a.findByMask(e,o).then((t=>{e.options[d]=t;n()}))}}else if(r){return a.getById(e,r).then((t=>{e.options[d]=[t];e.initiated.push(d);n()}))}else{e.initiated.push(d)}return n()}))}isDirty(e,t){return this.initialDirty||(this.form?this.form.isDirty(e,t):false)}isValid(e=false){if(e){const t=this.form.collectFrontEndValidationErrors(e,this.nativeForm);this.form.removeFrontEndValidationMessages();this.form.displayValidationMessages(t,e)}return!!this.form&&this.form.group.valid}watchFormErrors(e){this.form.watchErrors(e)}init(){return this.load().then((()=>{if(this.initialDirty){this.form.patchComponent(this.initialContent||{});this.data$.next(this.initialContent||{})}this._pushEditorToStack();a.publishAsync(St,this.id)}))}_validate(e){if(ae.isBlank(e.structureApi)&&!e.structure){throw new Error("genericEditor.configuration.error.no.structure")}else if(!ae.isBlank(e.structureApi)&&e.structure){throw new Error("genericEditor.configuration.error.2.structures")}}_getUriContext(){return Promise.resolve(this.uriContext?this.uriContext:s.get(Jt).then((e=>({[ye]:e.siteDescriptor.uid,[_e]:e.catalogDescriptor.catalogId,[fe]:e.catalogDescriptor.catalogVersion}))))}_convertStructureArray(e){const t=e.structures||e.componentTypes;if(r.isArray(t)){if(t.length>1){throw new Error("init: Invalid structure, multiple structures returned")}e=t[0]}return e}_handleUnrelatedValidationMessages(e,t){if(t.targetGenericEditorId&&t.targetGenericEditorId!==this.id){return}if(t.sourceGenericEditorId&&t.sourceGenericEditorId===this.id){return}this.form.removeValidationMessages();this.form.displayValidationMessages(t.messages,true)}_getDataHandler(e){if(p.injector.get(e,null)){return p.injector.get(e)}if(p.$injector.has(e)){return p.$injector.get(e)}return null}_getRefreshHandleContructorOrToken(e){switch(e){case"Enum":return t.FetchEnumDataHandler;default:return"fetch"+e+"DataHandler"}}_pushEditorToStack(){a.publishAsync(t.GenericEditorStackService.EDITOR_PUSH_TO_STACK_EVENT,{editorId:this.id,editorStackId:this.editorStackId,component:this.form.component,componentType:this.smarteditComponentType})}}}getGenericEditorConstructor(){return this.genericEditorConstructor}};t.GenericEditorFactoryService.$inject=["yjQuery","restServiceFactory","languageService","sharedDataService","systemEventService","logService","upgrade","seValidationMessageParser","editorFieldMappingService"];t.GenericEditorFactoryService=__decorate([SeDowngradeService(),__param(0,d.Inject(Qi)),__metadata("design:paramtypes",[Function,s.RestServiceFactory,t.LanguageService,s.ISharedDataService,t.SystemEventService,s.LogService,n.UpgradeModule,t.SeValidationMessageParser,t.EditorFieldMappingService])],t.GenericEditorFactoryService);const xn=new Set(["id","smarteditComponentId","smarteditComponentType","structureApi","structure","contentApi","content","uriContext","updateCallback","customOnSubmit","editorStackId","modalHeaderTitle"]);window.__smartedit__.addDecoratorPayload("Component","GenericEditorComponent",{selector:"se-generic-editor",template:`<ng-template let-state [formBuilder]="{schema$: editor.schema$, data$: editor.data$}" (stateCreated)="setFormState($event)"><div class="se-generic-editor"><se-generic-editor-breadcrumb></se-generic-editor-breadcrumb><ng-container *ngIf="state; else noSupport"><form novalidate #nativeForm class="no-enter-submit se-generic-editor__form" [contentManager]="{onSave: editor.submit$}" (onSuccess)="editor.onSuccess($event)" (onError)="editor.onFailure($event)"><div class="modal-header se-generic-editor__header" *ngIf="modalHeaderTitle"><h4 class="modal-title">{{modalHeaderTitle| translate}}</h4></div><div class="se-generic-editor__body"><ng-template [formRenderer]="state.group"></ng-template></div><div class="se-generic-editor__footer modal-footer" *ngIf="editor && showCommands()"><button fd-button id="submit" name="submit" options="emphasized" *ngIf="showSubmit()" [seSubmitBtn]="editor.isSubmitDisabled">{{editor.submitButtonText | translate}}</button> <button fd-button id="cancel" type="button" options="light" *ngIf="showCancel()" (click)="_reset()">{{editor.cancelButtonText | translate}}</button></div></form></ng-container><ng-template #noSupport><div class="se-generic-editor__body"><se-message type="info" id="GenericEditor.NoEditingSupportDisclaimer"><ng-container se-message-description>{{ 'se.editor.notification.editing.not.supported' | translate }}</ng-container></se-message></div></ng-template></div></ng-template>`});t.GenericEditorComponent=class GenericEditorComponent{constructor(e,t,o){this.elementRef=e;this.genericEditorFactoryService=t;this.yjQuery=o;this.submit=null;this.reset=null;this.isDirty=null;this.isValid=null;this.getApi=new d.EventEmitter;this.submitChange=new d.EventEmitter;this.resetChange=new d.EventEmitter;this.isValidChange=new d.EventEmitter;this.isDirtyChange=new d.EventEmitter;this.editor=null;this.componentForm=new w.FormGroup({});this.formInitialized$=new v.BehaviorSubject(null);this.formSet$=new v.BehaviorSubject(false);this.isSubmitDisabled=()=>this.editor.isSubmitDisabled()}set nativeForm(e){if(!e){return}this.formInitialized$.next(e.nativeElement)}ngOnChanges(e){const t=!!Object.keys(e).find((e=>xn.has(e)));if(!t){return}if(this.editor){this.editor._finalize()}const o=this.genericEditorFactoryService.getGenericEditorConstructor();this.editor=new o({id:this.id||ae.generateIdentifier(),smarteditComponentType:this.smarteditComponentType,smarteditComponentId:this.smarteditComponentId,editorStackId:this.editorStackId,structureApi:this.structureApi,structure:this.structure,contentApi:this.contentApi,updateCallback:this.updateCallback,content:this.content,uriContext:this.uriContext,customOnSubmit:this.customOnSubmit,element:this.elementRef.nativeElement});this.getApi.emit(this.editor.api);this.editor.init()}ngOnInit(){this.showResetButton=r.isNull(this.reset);this.showSubmitButton=r.isNull(this.submit);setTimeout((()=>{this.submitChange.emit((()=>this.contentManager.save().toPromise().then((e=>e.response))));this.isValidChange.emit((()=>this._isValid()));this.isDirtyChange.emit((()=>this._isDirty()));this.resetChange.emit((()=>this._reset()))}));v.combineLatest(this.formSet$,this.formInitialized$).pipe(b.filter((e=>e.every((e=>!!e)))),b.take(1)).subscribe((([e,t])=>this.editor.watchFormErrors(t)))}ngOnDestroy(){this.editor._finalize()}ngAfterViewInit(){this.yjQuery(this.yjQuery(".no-enter-submit")[0]).bind("keypress",(e=>e.key!=="Enter"))}setFormState(e){this.editor.setForm(e);this.formSet$.next(true)}showCommands(){return this.showCancel()||this.showSubmit()}showCancel(){return this.editor.alwaysShowReset||this.showResetButton===true&&this.editor.isDirty()&&this.editor.isValid()}showSubmit(){return this.editor.alwaysShowSubmit||this.showSubmitButton===true&&this.editor.isDirty()&&this.editor.isValid()}_reset(){return __awaiter(this,void 0,void 0,(function*(){if(this.editor.onReset&&this.editor.onReset()===false){return}return this.editor.reset()}))}_isValid(){return this.editor.isValid()}_isDirty(){return this.editor?this.editor.isDirty():false}};t.GenericEditorComponent.$inject=["elementRef","genericEditorFactoryService","yjQuery"];__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"id",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"smarteditComponentId",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"smarteditComponentType",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"structureApi",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorComponent.prototype,"structure",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"contentApi",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorComponent.prototype,"content",void 0);__decorate([d.Input(),__metadata("design:type",Promise)],t.GenericEditorComponent.prototype,"uriContext",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"submit",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"reset",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"isDirty",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"isValid",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"updateCallback",void 0);__decorate([d.Input(),__metadata("design:type",Function)],t.GenericEditorComponent.prototype,"customOnSubmit",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"editorStackId",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorComponent.prototype,"modalHeaderTitle",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.GenericEditorComponent.prototype,"getApi",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.GenericEditorComponent.prototype,"submitChange",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.GenericEditorComponent.prototype,"resetChange",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.GenericEditorComponent.prototype,"isValidChange",void 0);__decorate([d.Output(),__metadata("design:type",d.EventEmitter)],t.GenericEditorComponent.prototype,"isDirtyChange",void 0);__decorate([d.ViewChild("nativeForm",{static:false,read:d.ElementRef}),__metadata("design:type",d.ElementRef),__metadata("design:paramtypes",[d.ElementRef])],t.GenericEditorComponent.prototype,"nativeForm",null);__decorate([d.ViewChild(Yo,{static:false}),__metadata("design:type",Yo)],t.GenericEditorComponent.prototype,"contentManager",void 0);t.GenericEditorComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"se-generic-editor",template:`<ng-template let-state [formBuilder]="{schema$: editor.schema$, data$: editor.data$}" (stateCreated)="setFormState($event)"><div class="se-generic-editor"><se-generic-editor-breadcrumb></se-generic-editor-breadcrumb><ng-container *ngIf="state; else noSupport"><form novalidate #nativeForm class="no-enter-submit se-generic-editor__form" [contentManager]="{onSave: editor.submit$}" (onSuccess)="editor.onSuccess($event)" (onError)="editor.onFailure($event)"><div class="modal-header se-generic-editor__header" *ngIf="modalHeaderTitle"><h4 class="modal-title">{{modalHeaderTitle| translate}}</h4></div><div class="se-generic-editor__body"><ng-template [formRenderer]="state.group"></ng-template></div><div class="se-generic-editor__footer modal-footer" *ngIf="editor && showCommands()"><button fd-button id="submit" name="submit" options="emphasized" *ngIf="showSubmit()" [seSubmitBtn]="editor.isSubmitDisabled">{{editor.submitButtonText | translate}}</button> <button fd-button id="cancel" type="button" options="light" *ngIf="showCancel()" (click)="_reset()">{{editor.cancelButtonText | translate}}</button></div></form></ng-container><ng-template #noSupport><div class="se-generic-editor__body"><se-message type="info" id="GenericEditor.NoEditingSupportDisclaimer"><ng-container se-message-description>{{ 'se.editor.notification.editing.not.supported' | translate }}</ng-container></se-message></div></ng-template></div></ng-template>`}),__param(2,d.Inject(Qi)),__metadata("design:paramtypes",[d.ElementRef,t.GenericEditorFactoryService,Function])],t.GenericEditorComponent);var Dn;t.GenericEditorTabService=Dn=class GenericEditorTabService{constructor(){this._tabsConfiguration={};this._defaultTabPredicates=[]}configureTab(e,t){this._tabsConfiguration[e]=t}getTabConfiguration(e){const t=this._tabsConfiguration[e];return t?t:null}sortTabs(e){return e.sort(((e,t)=>{const o=this.getTabPriority(e);const n=this.getTabPriority(t);if(n-o!==0){return n-o}else{if(e.id<t.id){return-1}else if(e.id>t.id){return 1}return 0}}))}getComponentTypeDefaultTab(e){let t=null;this._defaultTabPredicates.some((o=>{t=o(e);return t!==null}));return t!==null?t:Dn.DEFAULT_TAB_ID}addComponentTypeDefaultTabPredicate(e){if(!e||typeof e!=="function"){throw new Error("genericEditorTabService - provided predicate must be a function.")}this._defaultTabPredicates.push(e)}getTabPriority(e){const t=e.id;if(!t){throw new Error("genericEditorTabService - Every tab must have an id.")}let o=Dn.MIN_PRIORITY;if(this._tabsConfiguration[t]&&this._tabsConfiguration[t].priority){o=this._tabsConfiguration[t].priority}return o}};t.GenericEditorTabService.MIN_PRIORITY=0;t.GenericEditorTabService.DEFAULT_TAB_ID="default";t.GenericEditorTabService=Dn=__decorate([SeDowngradeService(),d.Injectable()],t.GenericEditorTabService);var Rn;function genericEditorAngularJSTemplateBasedCustomElementClassFactory(e){return class extends AbstractAngularJSBasedCustomElement{constructor(){super(e);this.angularJSBody=`\n            <div\n                class="ySEGenericEditorField ySEGenericEditorField__input-page-name--color"\n                data-ng-include="field.template"\n            ></div>\n        `}internalConnectedCallback(){const e=this.parentElement.closest(`se-generic-editor-field`)||this.parentElement.closest(`generic-editor-field`);if(!e||!e.field){return}this.markAsProcessed();const{editor:t,model:o,field:n,qualifier:s,id:a,editorStackId:r,isFieldDisabled:d,$ctrl:p}=e;while(this.firstChild){this.removeChild(this.firstChild)}this.appendChild(window.smarteditJQuery(this.angularJSBody)[0]);this.scope=this.$rootScope.$new(false);const m=this.scope;m.editor=t;m.model=o;m.field=n;m.qualifier=s;m.id=a;m.editorStackId=r;m.isFieldDisabled=d;m.$ctrl=p;this.$compile(this)(this.scope)}}}t.LegacyGEWidgetToCustomElementConverter=Rn=class LegacyGEWidgetToCustomElementConverter{constructor(e,t){this.upgrade=e;this.windowUtils=t}convert(){if(!this.windowUtils.isIframe()&&!customElements.get(Rn.TEMPLATE_WIDGET_NAME)){const e=genericEditorAngularJSTemplateBasedCustomElementClassFactory(this.upgrade);customElements.define(Rn.TEMPLATE_WIDGET_NAME,e)}}};t.LegacyGEWidgetToCustomElementConverter.TEMPLATE_WIDGET_NAME=`se-template-ge-widget`;t.LegacyGEWidgetToCustomElementConverter=Rn=__decorate([d.Injectable(),__metadata("design:paramtypes",[n.UpgradeModule,t.WindowUtils])],t.LegacyGEWidgetToCustomElementConverter);function isBlankValidator(){return e=>{const t=e.value&&e.value.length>0&&""===r.trim(e.value);return t?{isBlank:{value:e.value}}:null}}window.__smartedit__.addDecoratorPayload("Component","GenericEditorBreadcrumbComponent",{selector:"se-generic-editor-breadcrumb",template:`\n        <div class="se-ge-breadcrumb">\n            <ng-container *ngIf="showBreadcrumb()">\n                <div\n                    *ngFor="let breadcrumbItem of getEditorsStack(); let i = index"\n                    class="se-ge-breadcrumb__item"\n                >\n                    <div class="se-ge-breadcrumb__data">\n                        <span class="se-ge-breadcrumb__title">\n                            {{ getComponentName(breadcrumbItem) | translate }}\n                        </span>\n                        <span class="se-ge-breadcrumb__info">\n                            {{ breadcrumbItem.componentType | translate }}\n                        </span>\n                    </div>\n\n                    <div\n                        class="se-ge-breadcrumb__divider sap-icon--navigation-right-arrow"\n                        *ngIf="i < getEditorsStack().length - 1"\n                    ></div>\n                </div>\n            </ng-container>\n        </div>\n    `});t.GenericEditorBreadcrumbComponent=class GenericEditorBreadcrumbComponent{constructor(e,t){this.genericEditorStackService=e;this.ge=t}getEditorsStack(){if(!this.editorsStack){this.editorsStack=this.genericEditorStackService.getEditorsStack(this.ge.editorStackId)}return this.editorsStack}showBreadcrumb(){return this.getEditorsStack()&&this.getEditorsStack().length>1}getComponentName(e){if(!e.component.name){return"se.breadcrumb.name.empty"}return e.component.name}};t.GenericEditorBreadcrumbComponent=__decorate([d.Component({selector:"se-generic-editor-breadcrumb",template:`\n        <div class="se-ge-breadcrumb">\n            <ng-container *ngIf="showBreadcrumb()">\n                <div\n                    *ngFor="let breadcrumbItem of getEditorsStack(); let i = index"\n                    class="se-ge-breadcrumb__item"\n                >\n                    <div class="se-ge-breadcrumb__data">\n                        <span class="se-ge-breadcrumb__title">\n                            {{ getComponentName(breadcrumbItem) | translate }}\n                        </span>\n                        <span class="se-ge-breadcrumb__info">\n                            {{ breadcrumbItem.componentType | translate }}\n                        </span>\n                    </div>\n\n                    <div\n                        class="se-ge-breadcrumb__divider sap-icon--navigation-right-arrow"\n                        *ngIf="i < getEditorsStack().length - 1"\n                    ></div>\n                </div>\n            </ng-container>\n        </div>\n    `}),__param(1,d.Inject(d.forwardRef((()=>t.GenericEditorComponent)))),__metadata("design:paramtypes",[t.GenericEditorStackService,t.GenericEditorComponent])],t.GenericEditorBreadcrumbComponent);window.__smartedit__.addDecoratorPayload("Component","GenericEditorDynamicFieldComponent",{selector:"se-ge-dynamic-field",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-generic-editor-field\n            [formControl]="form"\n            [field]="field"\n            [model]="component"\n            [qualifier]="qualifier"\n            [id]="id"\n        ></se-generic-editor-field>\n    `});let kn=class GenericEditorDynamicFieldComponent{constructor(e){this.cdr=e}ngAfterViewChecked(){if(!this.cdr.destroyed){this.cdr.detectChanges()}}};__decorate([s.DynamicForm(),__metadata("design:type",s.FormField)],kn.prototype,"form",void 0);__decorate([s.DynamicInput(),__metadata("design:type",Object)],kn.prototype,"component",void 0);__decorate([s.DynamicInput(),__metadata("design:type",Object)],kn.prototype,"field",void 0);__decorate([s.DynamicInput(),__metadata("design:type",String)],kn.prototype,"qualifier",void 0);__decorate([s.DynamicInput(),__metadata("design:type",String)],kn.prototype,"id",void 0);kn=__decorate([d.Component({selector:"se-ge-dynamic-field",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-generic-editor-field\n            [formControl]="form"\n            [field]="field"\n            [model]="component"\n            [qualifier]="qualifier"\n            [id]="id"\n        ></se-generic-editor-field>\n    `}),__metadata("design:paramtypes",[d.ChangeDetectorRef])],kn);window.__smartedit__.addDecoratorPayload("Component","GenericEditorTabComponent",{selector:"se-ge-tab",template:`<div class="se-generic-editor__row ySErow" *ngFor="let field of fields" [ngClass]="'se-generic-editor__row--' + field.qualifier"><label [id]="field.qualifier + '-label'" class="se-control-label" *ngIf="!field.hideFieldWidget && !field.hidePrefixLabel && field.i18nKey" [hidden]="field.hideFieldWidget && field.hidePrefixLabel" [ngClass]="{ required: field.required }">{{ field.i18nKey | lowercase | translate }}</label><se-help class="se-help-tooltip" *ngIf="field.tooltip"><span>{{ field.tooltip | translate }}</span></se-help><div class="ySEGenericEditorFieldStructure" [hidden]="field.hideFieldWidget" [id]="field.qualifier" [attr.data-cms-field-qualifier]="field.qualifier" [attr.data-cms-structure-type]="field.cmsStructureType"><ng-template [formRenderer]="getForm(field.qualifier)"></ng-template></div></div>`});let Mn=class GenericEditorTabComponent{constructor(e,t,o){this.cdr=e;this.ge=t;this.data=o}ngOnInit(){const{model:e,tabId:t}=this.data;this.fields=e.getInput("fieldsMap")[t];const o=e.controls[t];this.forms=o.controls;this._subscription=o.statusChanges.subscribe((()=>{const e=r.values(this.forms).some((e=>{const t=e.getInput("field");return t.messages&&t.messages.length>0}));this.data.tab.hasErrors=e}));Object.keys(this.forms).forEach((e=>{this.forms[e].setInput("id",this.ge.editor.id)}))}ngAfterViewChecked(){if(!this.cdr.destroyed){this.cdr.detectChanges()}}ngOnDestroy(){this._subscription.unsubscribe()}getForm(e){return this.forms[e]}};Mn=__decorate([d.Component({selector:"se-ge-tab",template:`<div class="se-generic-editor__row ySErow" *ngFor="let field of fields" [ngClass]="'se-generic-editor__row--' + field.qualifier"><label [id]="field.qualifier + '-label'" class="se-control-label" *ngIf="!field.hideFieldWidget && !field.hidePrefixLabel && field.i18nKey" [hidden]="field.hideFieldWidget && field.hidePrefixLabel" [ngClass]="{ required: field.required }">{{ field.i18nKey | lowercase | translate }}</label><se-help class="se-help-tooltip" *ngIf="field.tooltip"><span>{{ field.tooltip | translate }}</span></se-help><div class="ySEGenericEditorFieldStructure" [hidden]="field.hideFieldWidget" [id]="field.qualifier" [attr.data-cms-field-qualifier]="field.qualifier" [attr.data-cms-structure-type]="field.cmsStructureType"><ng-template [formRenderer]="getForm(field.qualifier)"></ng-template></div></div>`}),__param(2,d.Inject(Eo)),__metadata("design:paramtypes",[d.ChangeDetectorRef,t.GenericEditorComponent,Object])],Mn);const createValidatorMap=(e,t,o,n,s)=>Object.keys(e||{}).reduce(((a,r)=>Object.assign(Object.assign({},a),{[r]:e[r](t,o,n,s)})),{});class RootSchemaDataMapper{constructor(e,t,o){this.mappers=e;this.tabs=t;this.fieldsMap=o}toValue(){return this.mappers.reduce(((e,t)=>{e[t.id]=t.toValue();return e}),{})}toSchema(){return{type:"group",component:"tabs",schemas:this.mappers.reduce(((e,t)=>{e[t.id]=t.toSchema();return e}),{}),inputs:{tabs:this.tabs,fieldsMap:this.fieldsMap}}}}const Nn="$$internal";class InternalProperty{constructor(){this._map=new Map}watch(e,t){this._map.set(e,t);return()=>{this._map.delete(e)}}trigger(e,t){if(this._map.has(e)){this._map.get(e)(t)}}}const proxifyDataObject=e=>{const t=new InternalProperty;Object.defineProperty(e,Nn,{get:()=>t});return new Proxy(e,{set(e,t,o){e[t]=o;e[Nn].trigger(t,o);return true}})};const Fn=new Set(r.values(bt));const zn={SHORT_STRING:"ShortString",LONG_STRING:"LongString"};class GenericEditorState{constructor(e,t,o,n,s,a,r,d,p){this.id=e;this.group=t;this.component=o;this.proxiedComponent=n;this.pristine=s;this.tabs=a;this.fields=r;this.languages=d;this.parameters=p;this.removeValidationMessages=()=>{this.fields.forEach((e=>{e.messages=undefined;e.hasErrors=false;e.hasWarnings=false}))};this._qualifierFieldMap=this.fields.reduce(((e,t)=>{e.set(t.qualifier,t);return e}),new Map);this._formFields=this._buildFormFieldsArray(this.group)}removeFrontEndValidationMessages(){this.fields.forEach((e=>{if(!Array.isArray(e.messages)){return}const t=(e.messages||[]).filter((e=>e.fromSubmit===undefined?true:e.fromSubmit));e.messages=t.length?t:undefined;e.hasErrors=this._containsValidationMessageType(e.messages,bt.VALIDATION_ERROR);e.hasWarnings=this._containsValidationMessageType(e.messages,bt.WARNING)}))}validationMessageBelongsToCurrentInstance(e){return this._qualifierFieldMap.has(e.subject)}collectUnrelatedValidationMessages(e){return e.filter((e=>this._isValidationMessageType(e.type)&&!this.validationMessageBelongsToCurrentInstance(e)))}watchErrors(e){const t=this._formFields.map((e=>e.statusChanges.pipe(b.startWith(null))));v.combineLatest([...t,this.group.statusChanges.pipe(b.startWith(null))]).pipe(b.distinctUntilChanged(((e,t)=>r.isEqual(e,t))),b.map((()=>this.collectFrontEndValidationErrors(false,e)))).subscribe((e=>{this.removeFrontEndValidationMessages();this.displayValidationMessages(e,false)}))}collectFrontEndValidationErrors(e,t){e=e||false;return this._formFields.reduce(((o,n)=>{const s=n.getInput("field");if((()=>{const e=Array.from(t||[]).find((e=>e.getAttribute("name")===s.qualifier));return!!e&&!e.checkValidity()})()){o.push({type:bt.VALIDATION_ERROR,subject:s.qualifier,message:"se.editor.htmlo.validation.error",fromSubmit:e,isNonPristine:this.isDirty(s.qualifier)})}if(n.getError("required")&&n.touched||n.getError("isBlank")&&n.touched){if(s.localized){const t=n.getInput("id");o.push({type:bt.VALIDATION_ERROR,subject:s.qualifier,message:"se.componentform.required.field",language:t,fromSubmit:e,isNonPristine:this.isDirty(s.qualifier,t)})}else{o.push({type:bt.VALIDATION_ERROR,subject:s.qualifier,message:"se.componentform.required.field",fromSubmit:e,isNonPristine:this.isDirty(s.qualifier)})}}return o}),[])}displayValidationMessages(e,t){e.filter((e=>this._isValidationMessageType(e.type)&&(t||e.isNonPristine))).forEach((e=>{e.type=e.type||bt.VALIDATION_ERROR;const t=this._qualifierFieldMap.get(e.subject);if(!t){return}if(!t.messages){t.messages=[]}const o=r.merge(e,this._getParseValidationMessage(e.message));o.marker=t.localized?o.language:t.qualifier;o.type=e.type;o.uniqId=ae.encode(o);const n=t.messages.find((e=>e.uniqId===o.uniqId));if(!n){t.messages.push(o);if(o.type===bt.VALIDATION_ERROR){t.hasErrors=true}else if(o.type===bt.WARNING){t.hasWarnings=true}}else{r.merge(n,o)}}));r.values(this.group.controls).forEach((e=>{e.updateValueAndValidity({emitEvent:true})}));return Promise.resolve()}isDirty(e,t){this._bcPristine=this._buildComparable(this.fields,this.pristine);const o=this._buildComparable(this.fields,this.component);const n=e?t?this._bcPristine[e][t]:this._bcPristine[e]:this._bcPristine;const s=e?t?o[e][t]:o[e]:o;return!r.isEqual(n,s)}fieldsAreUserChecked(){return this.fields.every((e=>{let t=false;for(const o in e.requiresUserCheck){if(e.requiresUserCheck.hasOwnProperty(o)){t=t||e.requiresUserCheck[o]}}return!t||e.isUserChecked}))}patchComponent(e){this._qualifierFieldMap.forEach((({localized:t,qualifier:o})=>{if(t&&e[o]){e[o]=proxifyDataObject(e[o])}}));Object.assign(this.proxiedComponent,e)}sanitizedPayload(e=this.component){this.fields.filter((e=>e.cmsStructureType===zn.LONG_STRING||e.cmsStructureType===zn.SHORT_STRING||typeof e.customSanitize==="function")).forEach((({qualifier:t,localized:o,customSanitize:n})=>{if(e[t]!==undefined&&t in e){if(n){e[t]=n(e[t],ae.sanitize);return}}}));return e}switchToTabContainingQualifier(e){if(!e){return}this.tabs.forEach((t=>{t.active=!!this.group.get([t.id,e])}))}_getParseValidationMessage(e){return parseValidationMessage(e)}_containsValidationMessageType(e,t){if(!Array.isArray(e)){return false}return e.some((e=>e.type===t&&this.validationMessageBelongsToCurrentInstance(e)))}_isValidationMessageType(e){return Fn.has(e)}_buildComparable(e,t){if(!t){return t}const o={};e.forEach((e=>{let n=t[e.qualifier];if(e.localized){n=n;const t={};r.forEach(n,((o,n)=>{if(!r.isUndefined(o)){t[n]=this._buildFieldComparable(o,e)}}));o[e.qualifier]=t}else{n=t[e.qualifier];o[e.qualifier]=this._buildFieldComparable(n,e)}}));r.forEach(t,((t,n)=>{const s=!e.some((e=>e.qualifier===n));if(s){o[n]=t}}));return r.omitBy(o,r.isUndefined)}_buildFieldComparable(e,t){switch(t.cmsStructureType){case"RichText":return e!==undefined?ae.sanitizeHTML(e):null;case"Boolean":return e!==undefined?e:false;default:return e}}_buildFormFieldsArray(e,t=[]){if(e instanceof s.FormField){t.push(e);return t}if(e instanceof s.FormGrouping){Object.keys(e.controls).forEach((o=>{const n=e.controls[o];this._buildFormFieldsArray(n,t)}));return t}return t}}class FieldSchemaDataMapper{constructor(e,t,o,n){this.id=e;this.structure=t;this.required=o;this.component=n}toValue(){return this.component[this.id]}toSchema(){return{type:"field",component:"field",validators:Object.assign({required:this.required&&this.structure.editable||undefined},createValidatorMap(this.structure.validators,this.id,this.structure,this.required,this.component)),inputs:{id:this.id,field:this.structure,qualifier:this.id,component:this.component}}}}class LocalizedSchemaDataMapper{constructor(e,t,o,n,s){this.id=e;this.mappers=t;this.structure=o;this.languages=n;this.component=s}toValue(){return this.mappers.reduce(((e,t)=>{e[t.id]=t.toValue();return e}),{})}toSchema(){return{type:"group",component:"localized",schemas:this.mappers.reduce(((e,t)=>{e[t.id]=t.toSchema();return e}),{}),inputs:{field:this.structure,languages:this.languages,component:this.component}}}}class TabSchemaDataMapper{constructor(e,t){this.id=e;this.mappers=t}toValue(){return this.mappers.reduce(((e,t)=>{e[t.id]=t.toValue();return e}),{})}toSchema(){return{type:"group",persist:false,schemas:this.mappers.reduce(((e,t)=>{e[t.id]=t.toSchema();return e}),{})}}}const createFieldMapper=(e,t,o,n)=>new FieldSchemaDataMapper(e,t,o,n);const createLocalizedMapper=(e,t,o)=>{if(o[e.qualifier]===undefined){o[e.qualifier]={}}o[e.qualifier]=proxifyDataObject(o[e.qualifier]);const n=t.map((({isocode:t,required:n})=>createFieldMapper(t,e,e.required&&n,o[e.qualifier])));return new LocalizedSchemaDataMapper(e.qualifier,n,e,t,o)};const createTabMapper=(e,t,o,n)=>{const s=t.map((e=>{if(e.localized){return createLocalizedMapper(e,o,n)}return createFieldMapper(e.qualifier,e,e.required,n)}));return new TabSchemaDataMapper(e,s)};const createRootMapper=(e,t,o,n)=>{const s=r.toPairs(e).map((([e,n])=>createTabMapper(e,n,o,t)));return new RootSchemaDataMapper(s,n,e)};let Ln=class GenericEditorStateBuilderService{constructor(e,t,o,n){this.editorFieldMappingService=e;this.genericEditorTabService=t;this.translateService=o;this.schemaCompiler=n}buildState(e,t){const o=this._fieldAdaptor(t);const n=[];const s=o.reduce(((e,o)=>{let s=this.editorFieldMappingService.getFieldTabMapping(o,t.structure);if(!s){s=this.genericEditorTabService.getComponentTypeDefaultTab(t.structure)}if(!e[s]){e[s]=[];n.push({id:s,title:"se.genericeditor.tab."+s+".title",component:Mn})}e[s].push(o);return e}),{});this.genericEditorTabService.sortTabs(n);const a={siteId:t.uriContext[ye],catalogId:t.uriContext[_e],catalogVersion:t.uriContext[fe]};const r=ui.copy(e);const d=proxifyDataObject(r);const p=this._createMapper(s,d,t.languages,n);const m=this.schemaCompiler.compileGroup(p.toValue(),p.toSchema());const g=new GenericEditorState(t.id,m,r,d,ui.copy(e),n,o,t.languages,a);g.switchToTabContainingQualifier(t.targetedQualifier);return g}_createMapper(e,t,o,n){return createRootMapper(e,t,o,n)}_fieldAdaptor(e){const t=e.structure;return t.attributes.map((o=>{const n=this.editorFieldMappingService.getEditorFieldMapping(o,t);const s=Object.assign(o,n);if(s.editable===undefined){s.editable=true}if(!s.postfixText){const e=(t.type?t.type.toLowerCase():"")+"."+o.qualifier.toLowerCase()+".postfix.text";const n=this.translateService.instant(e);s.postfixText=n!==e?n:""}s.smarteditComponentType=e.smarteditComponentType;return s}))}};Ln.$inject=["editorFieldMappingService","genericEditorTabService","translateService","schemaCompiler"];Ln=__decorate([d.Injectable(),__metadata("design:paramtypes",[t.EditorFieldMappingService,t.GenericEditorTabService,S.TranslateService,s.SchemaCompilerService])],Ln);let Vn=class FormBuilderDirective{constructor(e,t,o){this.templateRef=e;this.viewContainer=t;this.stateBuilderService=o;this.stateCreated=new d.EventEmitter}set formBuilder(e){this._dispose();this._subscription=v.combineLatest(e.data$,e.schema$).subscribe(this._onDataStream.bind(this))}ngOnDestroy(){this._dispose()}_onDataStream([e,t]){if(!e||!t){return}this.viewContainer.clear();if(!t.structure){this.viewContainer.createEmbeddedView(this.templateRef,{$implicit:null});return}const o=this.stateBuilderService.buildState(e,t);this.stateCreated.emit(o);this.viewContainer.createEmbeddedView(this.templateRef,{$implicit:o})}_dispose(){this._subscription&&this._subscription.unsubscribe();this.viewContainer.clear()}};__decorate([d.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],Vn.prototype,"formBuilder",null);__decorate([d.Output(),__metadata("design:type",Object)],Vn.prototype,"stateCreated",void 0);Vn=__decorate([d.Directive({selector:"[formBuilder]"}),__metadata("design:paramtypes",[d.TemplateRef,d.ViewContainerRef,Ln])],Vn);var Un;window.__smartedit__.addDecoratorPayload("Component","GenericEditorFieldComponent",{selector:"se-generic-editor-field",providers:[{provide:w.NG_VALUE_ACCESSOR,useExisting:d.forwardRef((()=>Un)),multi:true}],template:`<div [attr.validation-id]="field.qualifier" class="ySEField"><div *ngIf="field.template"><div #widget></div></div><ng-container *ngIf="field.component"><ng-container *ngComponentOutlet="field.component; injector: widgetInjector"></ng-container></ng-container><se-generic-editor-field-messages [field]="field" [qualifier]="qualifier"></se-generic-editor-field-messages><div *ngIf="field.postfix" class="ySEText ySEFieldPostfix">{{ field.postfix | translate }}</div></div>`});t.GenericEditorFieldComponent=Un=class GenericEditorFieldComponent{constructor(e,t,o){this.elementRef=e;this.injector=t;this.ge=o}writeValue(e){this.model[this.qualifier]=e}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}ngOnInit(){this.createInjector();this._unWatch=this.model[Nn].watch(this.qualifier,(e=>{if(this._onChange&&this._onTouched){this._onTouched();this._onChange(e)}}))}ngOnDestroy(){this._unWatch()}ngAfterViewInit(){if(!this.field.template){return}const e=document.createElement("se-template-ge-widget");this.elementRef.nativeElement.editor=this.ge.editor;this.elementRef.nativeElement.model=this.model;this.elementRef.nativeElement.field=this.field;this.elementRef.nativeElement.qualifier=this.qualifier;this.elementRef.nativeElement.id=this.id;this.elementRef.nativeElement.editorStackId=this.ge.editor.editorStackId;this.elementRef.nativeElement.isFieldDisabled=()=>this.isFieldDisabled();this.elementRef.nativeElement.$ctrl=this;this.geWidget.nativeElement.appendChild(e)}isFieldDisabled(){let e=this.field.editable;if(this.field.localized){e=this.field.editable&&this.field.isLanguageEnabledMap[this.qualifier]}return!e}createInjector(){this.widgetInjector=d.Injector.create({parent:this.injector,providers:[{provide:Zo,useValue:{id:this.id,field:this.field,model:this.model,editor:this.ge.editor,qualifier:this.qualifier,isFieldDisabled:()=>this.isFieldDisabled()}}]})}};__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorFieldComponent.prototype,"field",void 0);__decorate([d.Input(),__metadata("design:type",Object)],t.GenericEditorFieldComponent.prototype,"model",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorFieldComponent.prototype,"qualifier",void 0);__decorate([d.Input(),__metadata("design:type",String)],t.GenericEditorFieldComponent.prototype,"id",void 0);__decorate([d.ViewChild("widget",{read:d.ElementRef,static:false}),__metadata("design:type",d.ElementRef)],t.GenericEditorFieldComponent.prototype,"geWidget",void 0);t.GenericEditorFieldComponent=Un=__decorate([SeDowngradeComponent(),d.Component({selector:"se-generic-editor-field",providers:[{provide:w.NG_VALUE_ACCESSOR,useExisting:d.forwardRef((()=>Un)),multi:true}],template:`<div [attr.validation-id]="field.qualifier" class="ySEField"><div *ngIf="field.template"><div #widget></div></div><ng-container *ngIf="field.component"><ng-container *ngComponentOutlet="field.component; injector: widgetInjector"></ng-container></ng-container><se-generic-editor-field-messages [field]="field" [qualifier]="qualifier"></se-generic-editor-field-messages><div *ngIf="field.postfix" class="ySEText ySEFieldPostfix">{{ field.postfix | translate }}</div></div>`}),__param(2,d.Inject(d.forwardRef((()=>t.GenericEditorComponent)))),__metadata("design:paramtypes",[d.ElementRef,d.Injector,t.GenericEditorComponent])],t.GenericEditorFieldComponent);window.__smartedit__.addDecoratorPayload("Component","GenericEditorFieldMessagesComponent",{selector:"se-generic-editor-field-messages",template:`<div *ngIf="errors.length > 0"><span *ngFor="let error of errors" class="se-generic-editor__error se-help-block--has-error help-block fd-form__message fd-form__message--error">{{ error | translate}}</span></div><div *ngIf="warnings.length > 0"><span *ngFor="let warning of warnings" class="se-generic-editor__warning se-help-block--has-warning help-block fd-form__message fd-form__message--warning">{{ warning | translate }}</span></div>`});let jn=class GenericEditorFieldMessagesComponent{constructor(){this.previousMessages=null}ngDoCheck(){if(this.field){const e=JSON.stringify(this.field.messages);if(this.previousMessages!==e){this.previousMessages=e;this.errors=this.getFilteredMessagesByType(bt.VALIDATION_ERROR);this.warnings=this.getFilteredMessagesByType(bt.WARNING)}}}getFilteredMessagesByType(e){return(this.field.messages||[]).filter((t=>t.marker===this.qualifier&&!t.format&&t.type===e)).map((e=>e.message))}};__decorate([d.Input(),__metadata("design:type",Object)],jn.prototype,"field",void 0);__decorate([d.Input(),__metadata("design:type",String)],jn.prototype,"qualifier",void 0);jn=__decorate([d.Component({selector:"se-generic-editor-field-messages",template:`<div *ngIf="errors.length > 0"><span *ngFor="let error of errors" class="se-generic-editor__error se-help-block--has-error help-block fd-form__message fd-form__message--error">{{ error | translate}}</span></div><div *ngIf="warnings.length > 0"><span *ngFor="let warning of warnings" class="se-generic-editor__warning se-help-block--has-warning help-block fd-form__message fd-form__message--warning">{{ warning | translate }}</span></div>`})],jn);window.__smartedit__.addDecoratorPayload("Component","GenericEditorFieldWrapperComponent",{selector:"se-generic-editor-field-wrapper",template:` <ng-template [formRenderer]="form"></ng-template> `});let $n=class GenericEditorFieldWrapperComponent{constructor({model:e,tabId:t,tab:o}){this.form=e.controls[t];this._subscription=this.form.statusChanges.subscribe((e=>{o.hasErrors=e==="INVALID"}))}ngOnDestroy(){this._subscription.unsubscribe()}};$n=__decorate([d.Component({selector:"se-generic-editor-field-wrapper",template:` <ng-template [formRenderer]="form"></ng-template> `}),__param(0,d.Inject(Eo)),__metadata("design:paramtypes",[Object])],$n);window.__smartedit__.addDecoratorPayload("Component","LocalizedElementComponent",{selector:"se-localized-element",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`<se-tabs *ngIf="tabs" class="multi-tabs-editor" [model]="form" [tabsList]="tabs" [numTabsDisplayed]="6"></se-tabs>`});let Bn=class LocalizedElementComponent{constructor(e){this.sessionService=e}onDynamicInputChange(){this._createLocalizedTabs()}ngDoCheck(){if(this.tabs&&this.field.messages!==this._previousMessages){this._previousMessages=this.field.messages;const e=this.field.messages?this.field.messages.filter((e=>e.type===bt.VALIDATION_ERROR)).reduce(((e,t)=>{e[t.language]=true;return e}),{}):{};this.tabs=this.tabs.map((function(t){const o=e[t.id];t.hasErrors=o!==undefined?o:false;return t}))}}_createLocalizedTabs(){return __awaiter(this,void 0,void 0,(function*(){this.field.isLanguageEnabledMap={};const{readableLanguages:e,writeableLanguages:t}=yield this.sessionService.getCurrentUser();const o=new Set(e);const n=new Set(t);this.tabs=this.languages.filter((e=>o.has(e.isocode))).map((({isocode:e,required:t})=>{this.field.isLanguageEnabledMap[e]=n.has(e);const o=`${e.toUpperCase()}${this.field.editable&&this.field.required&&t?"*":""}`;return{title:o,id:e,component:$n}}))}))}};__decorate([s.DynamicForm(),__metadata("design:type",s.FormGrouping)],Bn.prototype,"form",void 0);__decorate([s.DynamicInput(),__metadata("design:type",Object)],Bn.prototype,"field",void 0);__decorate([s.DynamicInput(),__metadata("design:type",Object)],Bn.prototype,"component",void 0);__decorate([s.DynamicInput(),__metadata("design:type",Array)],Bn.prototype,"languages",void 0);Bn=__decorate([d.Component({selector:"se-localized-element",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`<se-tabs *ngIf="tabs" class="multi-tabs-editor" [model]="form" [tabsList]="tabs" [numTabsDisplayed]="6"></se-tabs>`}),__metadata("design:paramtypes",[s.ISessionService])],Bn);window.__smartedit__.addDecoratorPayload("Component","GenericEditorRootTabsComponent",{selector:"se-ge-root-tabs",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-tabs\n            class="se-generic-editor__tabs"\n            [model]="form"\n            [tabsList]="tabs"\n            [numTabsDisplayed]="3"\n        ></se-tabs>\n    `});let Gn=class GenericEditorRootTabsComponent{};__decorate([s.DynamicForm(),__metadata("design:type",s.FormGrouping)],Gn.prototype,"form",void 0);__decorate([s.DynamicInput(),__metadata("design:type",Array)],Gn.prototype,"tabs",void 0);Gn=__decorate([d.Component({selector:"se-ge-root-tabs",styles:[`\n            :host {\n                display: block;\n            }\n        `],template:`\n        <se-tabs\n            class="se-generic-editor__tabs"\n            [model]="form"\n            [tabsList]="tabs"\n            [numTabsDisplayed]="3"\n        ></se-tabs>\n    `})],Gn);let Hn=class SubmitBtnDirective{constructor(e){this.cm=e}get disabled(){return this.cm.submitting||this.isDisabled&&this.isDisabled()}save(e){e.preventDefault();this.cm.save().subscribe()}};__decorate([d.Input("seSubmitBtn"),__metadata("design:type",Function)],Hn.prototype,"isDisabled",void 0);__decorate([d.HostBinding("disabled"),__metadata("design:type",Boolean),__metadata("design:paramtypes",[])],Hn.prototype,"disabled",null);__decorate([d.HostListener("click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Event]),__metadata("design:returntype",void 0)],Hn.prototype,"save",null);Hn=__decorate([d.Directive({selector:"[seSubmitBtn]"}),__metadata("design:paramtypes",[Yo])],Hn);t.GenericEditorWidgetModule=class GenericEditorWidgetModule{};t.GenericEditorWidgetModule=__decorate([d.NgModule({imports:[f.CommonModule,an,t.BooleanModule,s.TranslationModule.forChild(),w.FormsModule,t.RichTextFieldModule,t.SelectModule,bn,t.NumberModule,_n,hn],declarations:[t.ShortStringComponent,In,yn,fn,ln,rn,Tn],entryComponents:[t.ShortStringComponent,In,yn,fn,ln,rn,Tn]})],t.GenericEditorWidgetModule);t.SeGenericEditorModule=class SeGenericEditorModule{};t.SeGenericEditorModule=__decorate([d.NgModule({schemas:[d.CUSTOM_ELEMENTS_SCHEMA],imports:[f.CommonModule,t.YjqueryModule,w.FormsModule,w.ReactiveFormsModule,t.FundamentalsModule,t.SharedComponentsModule,t.GenericEditorWidgetModule,t.SelectModule,t.GenericEditorDropdownModule,s.TranslationModule.forChild(),s.FormBuilderModule.forRoot({validators:{required:()=>w.Validators.required,email:()=>w.Validators.email,notBlank:()=>isBlankValidator()},types:{tabs:Gn,localized:Bn,field:kn}})],providers:[t.GenericEditorFactoryService,t.EditorFieldMappingService,t.FetchEnumDataHandler,t.GenericEditorStackService,t.GenericEditorTabService,t.SeValidationMessageParser,Ln],declarations:[kn,t.GenericEditorComponent,Mn,Bn,t.GenericEditorFieldComponent,jn,$n,t.GenericEditorBreadcrumbComponent,Vn,Yo,Gn,Hn],entryComponents:[t.GenericEditorComponent,Mn,Bn,t.GenericEditorFieldComponent,jn,$n,t.GenericEditorBreadcrumbComponent],exports:[t.GenericEditorComponent,t.GenericEditorWidgetModule,t.GenericEditorDropdownModule]})],t.SeGenericEditorModule);(function(e){e["VIDEO"]="video";e["IMAGE"]="image";e["PDF_DOCUMENT"]="pdf";e["DEFAULT"]=""})(t.GenericEditorMediaType||(t.GenericEditorMediaType={}));window.__smartedit__.addDecoratorPayload("Component","HeaderLanguageDropdownComponent",{selector:"header-language-dropdown",template:`\n        <ul role="menu" class="fd-menu__list se-language-selector">\n            <li *ngIf="selectedLanguage">\n                <a\n                    class="yToolbarActions__dropdown-element fd-menu__item se-language-selector__element--selected"\n                >\n                    {{ selectedLanguage.name }}\n                </a>\n            </li>\n            <ng-container *ngFor="let language of items">\n                <li *ngIf="selectedLanguage.isoCode !== language.value.isoCode">\n                    <a\n                        class="yToolbarActions__dropdown-element fd-menu__item se-language-selector__element"\n                        (click)="onSelectedLanguage(language)"\n                    >\n                        {{ language.value.name }}\n                    </a>\n                </li>\n            </ng-container>\n        </ul>\n    `});t.HeaderLanguageDropdownComponent=class HeaderLanguageDropdownComponent extends s.LanguageDropdown{constructor(e,t){super(e,t);this.languageService=e;this.crossFrameEventService=t;this.languageSortStrategy="none"}};t.HeaderLanguageDropdownComponent.$inject=["languageService","crossFrameEventService"];t.HeaderLanguageDropdownComponent=__decorate([SeDowngradeComponent(),d.Component({selector:"header-language-dropdown",template:`\n        <ul role="menu" class="fd-menu__list se-language-selector">\n            <li *ngIf="selectedLanguage">\n                <a\n                    class="yToolbarActions__dropdown-element fd-menu__item se-language-selector__element--selected"\n                >\n                    {{ selectedLanguage.name }}\n                </a>\n            </li>\n            <ng-container *ngFor="let language of items">\n                <li *ngIf="selectedLanguage.isoCode !== language.value.isoCode">\n                    <a\n                        class="yToolbarActions__dropdown-element fd-menu__item se-language-selector__element"\n                        (click)="onSelectedLanguage(language)"\n                    >\n                        {{ language.value.name }}\n                    </a>\n                </li>\n            </ng-container>\n        </ul>\n    `}),__metadata("design:paramtypes",[t.LanguageService,t.CrossFrameEventService])],t.HeaderLanguageDropdownComponent);window.__smartedit__.addDecoratorPayload("Component","ConfirmDialogComponent",{selector:"se-confirm-dialog",template:`<ng-container *ngIf="config"><se-message *ngIf="config.message" [type]="config.message.type" [messageId]="config.message.id"><ng-container se-message-description><span [translate]="config.message.text"></span></ng-container></se-message><div id="confirmationModalDescription" [ngClass]="{ 'fd-has-margin-top-small' : config.message }" [translate]="config.description" [translateParams]="config.descriptionPlaceholders"></div></ng-container>`});t.ConfirmDialogComponent=class ConfirmDialogComponent{constructor(e){this.modalManager=e}ngOnInit(){this.modalManager.getModalData().pipe(b.take(1)).subscribe((e=>this.config=e))}};t.ConfirmDialogComponent=__decorate([d.Component({selector:"se-confirm-dialog",template:`<ng-container *ngIf="config"><se-message *ngIf="config.message" [type]="config.message.type" [messageId]="config.message.id"><ng-container se-message-description><span [translate]="config.message.text"></span></ng-container></se-message><div id="confirmationModalDescription" [ngClass]="{ 'fd-has-margin-top-small' : config.message }" [translate]="config.description" [translateParams]="config.descriptionPlaceholders"></div></ng-container>`}),__metadata("design:paramtypes",[s.ModalManagerService])],t.ConfirmDialogComponent);t.ConfirmDialogModule=class ConfirmDialogModule{};t.ConfirmDialogModule=__decorate([d.NgModule({imports:[f.CommonModule,s.TranslationModule.forChild(),t.MessageModule],declarations:[t.ConfirmDialogComponent],entryComponents:[t.ConfirmDialogComponent]})],t.ConfirmDialogModule);const Wn=new d.InjectionToken("CLIENT_PAGED_LIST_CELL_COMPONENT_DATA_TOKEN");window.__smartedit__.addDecoratorPayload("Component","ClientPagedListCellComponent",{selector:"se-client-paged-list-cell",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="key.component; else cellText"><ng-container *ngComponentOutlet="key.component; injector: componentInjector"></ng-container></ng-container><ng-template #cellText><span>{{ item[key.property] }}</span></ng-template>`});let qn=class ClientPagedListCellComponent{constructor(e){this.injector=e}ngOnInit(){this.createComponentInjector()}createComponentInjector(){this.componentInjector=d.Injector.create({parent:this.injector,providers:[{provide:Wn,useValue:{item:this.item,key:this.key}}]})}};qn.$inject=["injector"];__decorate([d.Input(),__metadata("design:type",Object)],qn.prototype,"item",void 0);__decorate([d.Input(),__metadata("design:type",Object)],qn.prototype,"key",void 0);qn=__decorate([SeDowngradeComponent(),d.Component({selector:"se-client-paged-list-cell",changeDetection:d.ChangeDetectionStrategy.OnPush,template:`<ng-container *ngIf="key.component; else cellText"><ng-container *ngComponentOutlet="key.component; injector: componentInjector"></ng-container></ng-container><ng-template #cellText><span>{{ item[key.property] }}</span></ng-template>`}),__metadata("design:paramtypes",[d.Injector])],qn);window.__smartedit__.addDecoratorPayload("Component","ClientPagedListComponent",{selector:"se-client-paged-list",changeDetection:d.ChangeDetectionStrategy.OnPush,providers:[t.FilterByFieldPipe,t.StartFromPipe,f.SlicePipe],template:`<div class="fluid-container se-paged-list-result"><p class="se-page-list__page-count" *ngIf="displayCount"><span>({{ totalItems }} {{ 'se.pagelist.countsearchresult' | translate }})</span></p><table class="se-paged-list-table table table-striped table-hover techne-table"><thead><tr><th *ngFor="let key of keys; trackBy: keysTrackBy" (click)="onOrderByColumn(key.property)" [ngStyle]="{ 'width': columnWidth + '%' }" class="se-paged-list__header" [ngClass]="'se-paged-list__header-' + key.property"><ng-container *ngIf="key.i18n">{{ key.i18n | translate }} <span class="header-icon" [hidden]="visibleSortingHeader !== key.property" [ngClass]="{\n                          'sap-icon--navigation-down-arrow': headersSortingState[key.property],\n                          'sap-icon--navigation-up-arrow': !headersSortingState[key.property]\n                      }"></span></ng-container></th><th class="se-paged-list__header"></th><th class="se-paged-list__header" *ngIf="dropdownItems"></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of filteredItems" class="techne-table-xs-right techne-table-xs-left se-paged-list-item"><td *ngFor="let key of keys" [ngClass]="'se-paged-list-item-' + key.property"><se-client-paged-list-cell [item]="item" [key]="key"></se-client-paged-list-cell></td><td><se-tooltip *ngIf="item.icon" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [title]="'se.icon.tooltip.visibility' | translate: { numberOfRestrictions: item.icon.numberOfRestrictions }" [isChevronVisible]="true"><img [src]="item.icon.src" se-tooltip-trigger/></se-tooltip></td><ng-container *ngIf="dropdownItems"><td *seHasOperationPermission="'se.edit.page'" class="paged-list-table__body__td paged-list-table__body__td-menu"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="item" class="pull-right"></se-dropdown-menu></td></ng-container></tr></tbody></table><div class="pagination-container"><se-pagination [totalItems]="totalItems < itemsPerPage ? itemsPerPage : totalItems" [itemsPerPage]="itemsPerPage" (onChange)="onCurrentPageChange($event)" [currentPage]="currentPage" class="pagination-lg"></se-pagination></div></div>`});let Kn=class ClientPagedListComponent{constructor(e,t,o,n){this.cdr=e;this.filterByFieldPipe=t;this.startFromPipe=o;this.slicePipe=n;this.reversed=false;this.displayCount=false;this.totalItems=0;this.currentPage=1;this.headersSortingState={}}ngOnChanges(e){if(e.items||e.query||e.itemFilterKeys||e.itemsPerPage){if(e.query){this.currentPage=1}this.filteredItems=this.filterItems();this.totalItems=e.query&&e.query.currentValue?this.filteredItems.length:this.items.length}if(e.keys){this.columnWidth=100/(this.keys.length||1)}if(e.reversed){this.columnToggleReversed=this.reversed}if(e.sortBy){this.headersSortingState=Object.assign(Object.assign({},this.headersSortingState),{[this.sortBy]:this.columnToggleReversed});this.visibleSortingHeader=this.sortBy;this.items=ui.sortBy(this.items,this.sortBy,this.columnToggleReversed);this.filteredItems=this.filterItems()}}keysTrackBy(e,t){return t.property}onOrderByColumn(e){this.columnToggleReversed=!this.columnToggleReversed;this.headersSortingState[e]=this.columnToggleReversed;this.visibleSortingHeader=e;this.items=ui.sortBy(this.items,e,this.columnToggleReversed);this.filteredItems=this.filterItems();if(!this.cdr.destroyed){this.cdr.detectChanges()}}onCurrentPageChange(e){this.currentPage=e;this.filteredItems=this.filterItems();if(!this.cdr.destroyed){this.cdr.detectChanges()}}filterItems(){const e=this.itemFilterKeys||[];const t=this.filterByFieldPipe.transform(this.items,this.query,e);const o=(this.currentPage-1)*this.itemsPerPage;const n=this.startFromPipe.transform(t,o);const s=this.slicePipe.transform(n,0,this.itemsPerPage);return s}};Kn.$inject=["cdr","filterByFieldPipe","startFromPipe","slicePipe"];__decorate([d.Input(),__metadata("design:type",Array)],Kn.prototype,"items",void 0);__decorate([d.Input(),__metadata("design:type",Array)],Kn.prototype,"itemFilterKeys",void 0);__decorate([d.Input(),__metadata("design:type",Array)],Kn.prototype,"keys",void 0);__decorate([d.Input(),__metadata("design:type",Number)],Kn.prototype,"itemsPerPage",void 0);__decorate([d.Input(),__metadata("design:type",String)],Kn.prototype,"sortBy",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Kn.prototype,"reversed",void 0);__decorate([d.Input(),__metadata("design:type",String)],Kn.prototype,"query",void 0);__decorate([d.Input(),__metadata("design:type",Object)],Kn.prototype,"displayCount",void 0);__decorate([d.Input(),__metadata("design:type",Array)],Kn.prototype,"dropdownItems",void 0);Kn=__decorate([SeDowngradeComponent(),d.Component({selector:"se-client-paged-list",changeDetection:d.ChangeDetectionStrategy.OnPush,providers:[t.FilterByFieldPipe,t.StartFromPipe,f.SlicePipe],template:`<div class="fluid-container se-paged-list-result"><p class="se-page-list__page-count" *ngIf="displayCount"><span>({{ totalItems }} {{ 'se.pagelist.countsearchresult' | translate }})</span></p><table class="se-paged-list-table table table-striped table-hover techne-table"><thead><tr><th *ngFor="let key of keys; trackBy: keysTrackBy" (click)="onOrderByColumn(key.property)" [ngStyle]="{ 'width': columnWidth + '%' }" class="se-paged-list__header" [ngClass]="'se-paged-list__header-' + key.property"><ng-container *ngIf="key.i18n">{{ key.i18n | translate }} <span class="header-icon" [hidden]="visibleSortingHeader !== key.property" [ngClass]="{\n                          'sap-icon--navigation-down-arrow': headersSortingState[key.property],\n                          'sap-icon--navigation-up-arrow': !headersSortingState[key.property]\n                      }"></span></ng-container></th><th class="se-paged-list__header"></th><th class="se-paged-list__header" *ngIf="dropdownItems"></th></tr></thead><tbody class="se-paged-list__table-body"><tr *ngFor="let item of filteredItems" class="techne-table-xs-right techne-table-xs-left se-paged-list-item"><td *ngFor="let key of keys" [ngClass]="'se-paged-list-item-' + key.property"><se-client-paged-list-cell [item]="item" [key]="key"></se-client-paged-list-cell></td><td><se-tooltip *ngIf="item.icon" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [title]="'se.icon.tooltip.visibility' | translate: { numberOfRestrictions: item.icon.numberOfRestrictions }" [isChevronVisible]="true"><img [src]="item.icon.src" se-tooltip-trigger/></se-tooltip></td><ng-container *ngIf="dropdownItems"><td *seHasOperationPermission="'se.edit.page'" class="paged-list-table__body__td paged-list-table__body__td-menu"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="item" class="pull-right"></se-dropdown-menu></td></ng-container></tr></tbody></table><div class="pagination-container"><se-pagination [totalItems]="totalItems < itemsPerPage ? itemsPerPage : totalItems" [itemsPerPage]="itemsPerPage" (onChange)="onCurrentPageChange($event)" [currentPage]="currentPage" class="pagination-lg"></se-pagination></div></div>`}),__metadata("design:paramtypes",[d.ChangeDetectorRef,t.FilterByFieldPipe,t.StartFromPipe,f.SlicePipe])],Kn);t.ClientPagedListModule=class ClientPagedListModule{};t.ClientPagedListModule=__decorate([d.NgModule({imports:[f.CommonModule,t.PaginationModule,t.FundamentalsModule,t.TooltipModule,t.DropdownMenuModule,t.HasOperationPermissionDirectiveModule,t.CompileHtmlModule,t.FilterByFieldPipeModule,t.StartFromPipeModule,s.TranslationModule.forChild()],entryComponents:[Kn],declarations:[Kn,qn],exports:[Kn]})],t.ClientPagedListModule);const Yn=new d.InjectionToken("MEDIA_FILE_SELECTOR_CUSTOM_TOKEN");const Zn=new d.InjectionToken("MEDIA_FILE_SELECTOR_CUSTOM_INJECTOR_TOKEN");const Xn={UPLOAD:"se.media.format.upload",REPLACE:"se.media.format.replace",UNDER_EDIT:"se.media.format.under.edit",REMOVE:"se.media.format.remove"};const Qn=new d.InjectionToken("MEDIA_SELECTOR_I18N_KEY_TOKEN");let Jn=class ExperienceInterceptor{constructor(e,t,o){this.sharedDataService=e;this.stringUtils=t;this.httpUtils=o}intercept(e,t){if(!Ve.test(e.url)){return t.handle(e)}return v.from(this.sharedDataService.get(Jt)).pipe(b.switchMap((o=>{if(!o){return t.handle(e)}const n={};n.CONTEXT_SITE_ID_WITH_COLON=o.siteDescriptor.uid;n.CONTEXT_CATALOG_VERSION_WITH_COLON=o.catalogDescriptor.catalogVersion;n.CONTEXT_CATALOG_WITH_COLON=o.catalogDescriptor.catalogId;n[ye]=o.siteDescriptor.uid;n[fe]=o.catalogDescriptor.catalogVersion;n[_e]=o.catalogDescriptor.catalogId;n[be]=o.pageContext?o.pageContext.siteId:o.siteDescriptor.uid;n[Ce]=o.pageContext?o.pageContext.catalogVersion:o.catalogDescriptor.catalogVersion;n[Se]=o.pageContext?o.pageContext.catalogId:o.catalogDescriptor.catalogId;const s=e.clone({url:this.stringUtils.replaceAll(e.url,n),params:e.params&&typeof e.params==="object"?this.httpUtils.transformHttpParams(e.params,n):e.params});return t.handle(s)})))}};Jn.$inject=["sharedDataService","stringUtils","httpUtils"];Jn=__decorate([d.Injectable(),__metadata("design:paramtypes",[s.ISharedDataService,s.StringUtils,s.HttpUtils])],Jn);t.SmarteditConstantsModule=class SmarteditConstantsModule{};t.SmarteditConstantsModule=__decorate([d.NgModule({providers:[{provide:fi,useValue:ve},{provide:yi,useValue:Wt}]})],t.SmarteditConstantsModule);const es=new d.InjectionToken("gatewayProxiedAnnotationFactoryToKen");const ts=new d.InjectionToken("cachedAnnotationFactoryToken");const is=new d.InjectionToken("cacheConfigAnnotationFactoryToken");const os=new d.InjectionToken("invalidateCacheAnnotationFactoryToken");const ns=new d.InjectionToken("operationContextAnnotationFactoryToken");t.SmarteditCommonsModule=class SmarteditCommonsModule{};t.SmarteditCommonsModule=__decorate([d.NgModule({imports:[t.FundamentalsModule,x.LocationUpgradeModule.config(),t.YjqueryModule,t.SeGenericEditorModule,t.WizardModule,t.SmarteditConstantsModule],providers:[Y.upgradeProvider("$animate",IAnimateService),Y.upgradeProvider("$templateCache",ITemplateCacheService),t.SmarteditBootstrapGateway,t.AngularJSLazyDependenciesService,t.AngularJSBootstrapIndicatorService,t.LanguageServiceGateway,t.LanguageService,{provide:s.LANGUAGE_SERVICE,useClass:t.LanguageService},{provide:ISlotRestrictionsService,useClass:t.SlotRestrictionsService},{provide:IEditorModalService,useClass:t.EditorModalService},{provide:IPageInfoService,useClass:PageInfoService},{provide:IFileValidation,useClass:t.FileValidationService},t.TimerService,t.DiscardablePromiseUtils,se.provideValues({SSO_LOGOUT_ENTRY_POINT:ze,SSO_AUTHENTICATION_ENTRY_POINT:Ne,SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT:Fe,SMARTEDIT_RESOURCE_URI_REGEXP:Ue,SMARTEDIT_ROOT:je,SMARTEDIT_INNER_FILES:Kt,SMARTEDIT_INNER_FILES_POST:Yt,[s.OPERATION_CONTEXT_TOKEN]:De,[s.WHO_AM_I_RESOURCE_URI_TOKEN]:ke,[s.I18N_RESOURCE_URI_TOKEN]:Re}),{provide:g.HTTP_INTERCEPTORS,useClass:Jn,multi:true},{provide:ISyncPollingService,useClass:t.SyncPollingService},{provide:s.IModalService,useClass:s.ModalService},{provide:s.ISettingsService,useClass:t.SettingsService},t.SliderPanelServiceFactory,s.LogService,s.BrowserService,s.FingerPrintingService,s.CacheEngine,s.CacheService,s.CloneableUtils,t.CrossFrameEventService,{provide:s.LoginDialogResourceProvider,useValue:qe},{provide:s.LANGUAGE_SERVICE_CONSTANTS,useValue:{LANGUAGE_RESOURCE_URI:ft,I18N_LANGUAGES_RESOURCE_URI:yt}},{provide:s.EVENT_SERVICE,useFactory:e=>e,deps:[t.CrossFrameEventService]},{provide:t.CrossFrameEventServiceGateway.crossFrameEventServiceGatewayToken,useClass:t.CrossFrameEventServiceGateway},s.OperationContextService,s.BooleanUtils,s.CryptographicUtils,s.FunctionsUtils,s.HttpUtils,NodeUtils,s.PromiseUtils,t.JQueryUtilsService,{provide:s.StringUtils,useClass:StringUtils},StringUtils,s.UrlUtils,{provide:s.WindowUtils,useClass:t.WindowUtils},t.WindowUtils,t.SystemEventService,t.PriorityService,t.TestModeService,{provide:s.TESTMODESERVICE,useFactory:e=>e,deps:[t.TestModeService]},t.GatewayFactory,t.GatewayProxy,t.InterceptorHelper,{provide:es,useFactory:GatewayProxiedAnnotationFactory,deps:[t.GatewayProxy]},{provide:ts,useFactory:s.CachedAnnotationFactory,deps:[s.CacheService]},{provide:is,useFactory:s.CacheConfigAnnotationFactory,deps:[s.LogService]},{provide:os,useFactory:s.InvalidateCacheAnnotationFactory,deps:[s.CacheService]},{provide:ns,useFactory:s.OperationContextAnnotationFactory,deps:[d.Injector,s.OperationContextService,s.OPERATION_CONTEXT_TOKEN]},s.RestServiceFactory,t.PermissionsRestService,t.AuthorizationService,s.FileMimeTypeService,s.FileReaderService,s.FileValidatorFactory,s.ModalService,t.WorkflowService,t.WorkflowTasksPollingService,t.CmsitemsRestService,t.PageVersioningService,t.PageVersionSelectionService,t.CMSModesService,t.PageContentSlotsService,t.ComponentHandlerService,t.SlotSharedService,t.ComponentMenuService,{provide:"seFileValidationServiceConstants",useValue:yo},se.initialize(((e,t,o,n,a)=>{Y.downgradeService("translateService",S.TranslateService);Y.downgradeService("browserService",s.BrowserService);Y.downgradeService("httpBackendService",s.HttpBackendService);Y.downgradeService("operationContextService",s.OperationContextService);Y.downgradeService("retryInterceptor",s.RetryInterceptor);Y.downgradeService("httpErrorInterceptorService",s.HttpErrorInterceptorService);Y.downgradeService("fileMimeTypeService",s.FileMimeTypeService);Y.downgradeService("fileReaderService",s.FileReaderService);Y.downgradeService("fileValidatorFactory",s.FileValidatorFactory);Y.downgradeService("seFileValidationServiceConstants",null,"seFileValidationServiceConstants")}),[es,ts,is,os,ns]),se.bootstrap(((e,t,o,n,a)=>{e.register(s.booleanUtils.areAllTruthy(operationContextInteractivePredicate,s.retriableErrorPredicate),t).register(s.booleanUtils.areAllTruthy(operationContextNonInteractivePredicate,s.retriableErrorPredicate),o).register(s.booleanUtils.areAllTruthy(operationContextCMSPredicate,s.timeoutErrorPredicate,s.updatePredicate),o).register(s.booleanUtils.areAllTruthy(operationContextToolingPredicate,s.timeoutErrorPredicate,s.updatePredicate),n);a.register(ft,De.TOOLING)}),[s.RetryInterceptor,s.DefaultRetryStrategy,s.ExponentialRetryStrategy,s.LinearRetryStrategy,s.OperationContextService,s.LogService])]})],t.SmarteditCommonsModule);function deprecatedSince1811(){a.module("permissionServiceInterfaceModule",["legacySmarteditCommonsModule"]);a.module("FetchDataHandlerInterfaceModule",["genericEditorServicesModule"]);a.module("fetchEnumDataHandlerModule",["genericEditorServicesModule"]);a.module("dateFormatterModule",["dateTimePickerModule"]);a.module("DropdownPopulatorInterface",["dropdownPopulatorModule"]);a.module("optionsDropdownPopulatorModule",["dropdownPopulatorModule"]);a.module("uriDropdownPopulatorModule",["dropdownPopulatorModule"]);a.module("editorFieldMappingServiceModule",["genericEditorServicesModule"]);a.module("genericEditorStackServiceModule",["genericEditorServicesModule"]);a.module("genericEditorTabServiceModule",["genericEditorServicesModule"]);a.module("seValidationMessageParserModule",["genericEditorServicesModule"]);a.module("seGenericEditorFieldMessagesModule",["genericEditorModule"]);a.module("genericEditorTabModule",["genericEditorModule"]);a.module("genericEditorFieldModule",["genericEditorModule"]);a.module("authorizationModule",["legacySmarteditCommonsModule"])}function deprecatedSince1905(){a.module("smarteditCommonsModule",["legacySmarteditCommonsModule"]);a.module("browserServiceModule",["legacySmarteditCommonsModule"]);a.module("loadConfigModule",["legacySmarteditCommonsModule"])}function deprecatedSince2005(){a.module("interceptorHelperModule",["legacySmarteditCommonsModule"]);a.module("yjqueryModule",["legacySmarteditCommonsModule"]);a.module("timerModule",["legacySmarteditCommonsModule"]);a.module("sliderPanelModule",["legacySmarteditCommonsModule"]);a.module("toolbarInterfaceModule",["legacySmarteditCommonsModule"]);a.module("yPaginationModule",["legacySmarteditCommonsModule"]);a.module("paginationFilterModule",["legacySmarteditCommonsModule"]);a.module("genericEditorServicesModule",["legacySmarteditCommonsModule"]);a.module("hasOperationPermissionModule",["legacySmarteditCommonsModule"]);a.module("dragAndDropServiceModule",["legacySmarteditCommonsModule"]);a.module("yDropDownMenuModule",["legacySmarteditCommonsModule"]);a.module("wizardServiceModule",["legacySmarteditCommonsModule"]);a.module("yMessageModule",["legacySmarteditCommonsModule"]);a.module("dynamicPagedListModule",["legacySmarteditCommonsModule"]);a.module("commonsRestServiceModule",[])}function deprecatedSince2105(){a.module("dropdownPopulatorModule",[])}const deprecate=()=>{deprecatedSince1811();deprecatedSince1905();deprecatedSince2005();deprecatedSince2105()};(function(){var e={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,MAP:{91:"COMMAND",8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSEBREAK",20:"CAPSLOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",43:"+",44:"PRINTSCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NUMLOCK",145:"SCROLLLOCK",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},isControl:function(t){var o=t.which;switch(o){case e.COMMAND:case e.SHIFT:case e.CTRL:case e.ALT:return true}if(t.metaKey||t.ctrlKey||t.altKey)return true;return false},isFunctionKey:function(e){e=e.which?e.which:e;return e>=112&&e<=123},isVerticalMovement:function(t){return~[e.UP,e.DOWN].indexOf(t)},isHorizontalMovement:function(t){return~[e.LEFT,e.RIGHT,e.BACKSPACE,e.DELETE].indexOf(t)},toSeparator:function(t){var o={ENTER:"\n",TAB:"\t",SPACE:" "}[t];if(o)return o;return e[t]?undefined:t}};function isNil(e){return angular.isUndefined(e)||e===null}if(angular.element.prototype.querySelectorAll===undefined){angular.element.prototype.querySelectorAll=function(e){return angular.element(this[0].querySelectorAll(e))}}if(angular.element.prototype.closest===undefined){angular.element.prototype.closest=function(e){var t=this[0];var o=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;while(t){if(o.bind(t)(e)){return t}else{t=t.parentElement}}return false}}var t=0;var o=angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:true,sortable:false,placeholder:"",refreshDelay:1e3,closeOnSelect:true,skipFocusser:false,dropdownPosition:"auto",removeSelected:true,resetSearchInput:true,generateId:function(){return t++},appendToBody:false,spinnerEnabled:false,spinnerClass:"glyphicon glyphicon-refresh ui-select-spin",backspaceReset:true}).service("uiSelectMinErr",(function(){var e=angular.$$minErr("ui.select");return function(){var t=e.apply(this,arguments);var o=t.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(o)}})).directive("uisTranscludeAppend",(function(){return{link:function(e,t,o,n,s){s(e,(function(e){t.append(e)}))}}})).filter("highlight",(function(){function escapeRegexp(e){return(""+e).replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(e,t){return t&&e?(""+e).replace(new RegExp(escapeRegexp(t),"gi"),'<span class="ui-select-highlight">$&</span>'):e}})).factory("uisOffset",["$document","$window",function(e,t){return function(o){var n=o[0].getBoundingClientRect();return{width:n.width||o.prop("offsetWidth"),height:n.height||o.prop("offsetHeight"),top:n.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:n.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}}}]);o.directive("uiSelectChoices",["uiSelectConfig","uisRepeatParser","uiSelectMinErr","$compile","$window",function(e,t,o,n,s){return{restrict:"EA",require:"^uiSelect",replace:true,transclude:true,templateUrl:function(t){t.addClass("ui-select-choices");var o=t.parent().attr("theme")||e.theme;return o+"/choices.tpl.html"},compile:function(n,a){if(!a.repeat)throw o("repeat","Expected 'repeat' expression.");var r=a.groupBy;var d=a.groupFilter;if(r){var p=n.querySelectorAll(".ui-select-choices-group");if(p.length!==1)throw o("rows","Expected 1 .ui-select-choices-group but got '{0}'.",p.length);p.attr("ng-repeat",t.getGroupNgRepeatExpression())}var m=t.parse(a.repeat);var g=n.querySelectorAll(".ui-select-choices-row");if(g.length!==1){throw o("rows","Expected 1 .ui-select-choices-row but got '{0}'.",g.length)}g.attr("ng-repeat",m.repeatExpression(r)).attr("ng-if","$select.open");var u=n.querySelectorAll(".ui-select-choices-row-inner");if(u.length!==1){throw o("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",u.length)}u.attr("uis-transclude-append","");var v=s.document.addEventListener?g:u;v.attr("ng-click","$select.select("+m.itemName+",$select.skipFocusser,$event)");return function link(t,o,s,a){a.parseRepeatAttr(s.repeat,r,d);a.disableChoiceExpression=s.uiDisableChoice;a.onHighlightCallback=s.onHighlight;a.minimumInputLength=parseInt(s.minimumInputLength)||0;a.dropdownPosition=s.position?s.position.toLowerCase():e.dropdownPosition;t.$watch("$select.search",(function(e){if(e&&!a.open&&a.multiple)a.activate(false,true);a.activeIndex=a.tagging.isActivated?-1:0;if(!s.minimumInputLength||a.search.length>=s.minimumInputLength){a.refresh(s.refresh)}else{a.items=[]}}));s.$observe("refreshDelay",(function(){var o=t.$eval(s.refreshDelay);a.refreshDelay=o!==undefined?o:e.refreshDelay}));t.$watch("$select.open",(function(e){if(e){n.attr("role","listbox");a.refresh(s.refresh)}else{o.removeAttr("role")}}))}}}}]);o.controller("uiSelectCtrl",["$scope","$element","$timeout","$filter","$$uisDebounce","uisRepeatParser","uiSelectMinErr","uiSelectConfig","$parse","$injector","$window",function(t,o,n,s,a,r,d,p,m,g,u){var v=this;var f="";v.placeholder=p.placeholder;v.searchEnabled=p.searchEnabled;v.sortable=p.sortable;v.refreshDelay=p.refreshDelay;v.paste=p.paste;v.resetSearchInput=p.resetSearchInput;v.refreshing=false;v.spinnerEnabled=p.spinnerEnabled;v.spinnerClass=p.spinnerClass;v.removeSelected=p.removeSelected;v.closeOnSelect=true;v.skipFocusser=false;v.search=f;v.activeIndex=0;v.items=[];v.open=false;v.focus=false;v.disabled=false;v.selected=undefined;v.dropdownPosition="auto";v.focusser=undefined;v.multiple=undefined;v.disableChoiceExpression=undefined;v.tagging={isActivated:false,fct:undefined};v.taggingTokens={isActivated:false,tokens:undefined};v.lockChoiceExpression=undefined;v.clickTriggeredSelect=false;v.$filter=s;v.$element=o;v.$animate=function(){try{return g.get("$animate")}catch(e){return null}}();v.searchInput=o.querySelectorAll("input.ui-select-search");if(v.searchInput.length!==1){throw d("searchInput","Expected 1 input.ui-select-search but got '{0}'.",v.searchInput.length)}v.isEmpty=function(){return isNil(v.selected)||v.selected===""||v.multiple&&v.selected.length===0};function _findIndex(e,t,o){if(e.findIndex){return e.findIndex(t,o)}else{var n=Object(e);var s=n.length>>>0;var a;for(var r=0;r<s;r++){a=n[r];if(t.call(o,a,r,n)){return r}}return-1}}function _resetSearchInput(){if(v.resetSearchInput){v.search=f;if(v.selected&&v.items.length&&!v.multiple){v.activeIndex=_findIndex(v.items,(function(e){return angular.equals(this,e)}),v.selected)}}}function _groupsFilter(e,t){var o,n,s=[];for(o=0;o<t.length;o++){for(n=0;n<e.length;n++){if(e[n].name==[t[o]]){s.push(e[n])}}}return s}v.activate=function(e,s){if(!v.disabled&&!v.open){if(!s)_resetSearchInput();t.$broadcast("uis:activate");v.open=true;v.activeIndex=v.activeIndex>=v.items.length?0:v.activeIndex;if(v.activeIndex===-1&&v.taggingLabel!==false){v.activeIndex=0}var a=o.querySelectorAll(".ui-select-choices-content");var r=o.querySelectorAll(".ui-select-search");if(v.$animate&&v.$animate.on&&v.$animate.enabled(a[0])){var animateHandler=function(t,o){if(o==="start"&&v.items.length===0){v.$animate.off("removeClass",r[0],animateHandler);n((function(){v.focusSearchInput(e)}))}else if(o==="close"){v.$animate.off("enter",a[0],animateHandler);n((function(){v.focusSearchInput(e)}))}};if(v.items.length>0){v.$animate.on("enter",a[0],animateHandler)}else{v.$animate.on("removeClass",r[0],animateHandler)}}else{n((function(){v.focusSearchInput(e);if(!v.tagging.isActivated&&v.items.length>1){_ensureHighlightVisible()}}))}}else if(v.open&&!v.searchEnabled){v.close()}};v.focusSearchInput=function(e){v.search=e||v.search;v.searchInput[0].focus()};v.findGroupByName=function(e){return v.groups&&v.groups.filter((function(t){return t.name===e}))[0]};v.parseRepeatAttr=function(e,o,n){function updateGroups(e){var s=t.$eval(o);v.groups=[];angular.forEach(e,(function(e){var t=angular.isFunction(s)?s(e):e[s];var o=v.findGroupByName(t);if(o){o.items.push(e)}else{v.groups.push({name:t,items:[e]})}}));if(n){var a=t.$eval(n);if(angular.isFunction(a)){v.groups=a(v.groups)}else if(angular.isArray(a)){v.groups=_groupsFilter(v.groups,a)}}v.items=[];v.groups.forEach((function(e){v.items=v.items.concat(e.items)}))}function setPlainItems(e){v.items=e||[]}v.setItemsFn=o?updateGroups:setPlainItems;v.parserResult=r.parse(e);v.isGrouped=!!o;v.itemProperty=v.parserResult.itemName;var s=v.parserResult.source;var createArrayFromObject=function(){var e=s(t);t.$uisSource=Object.keys(e).map((function(t){var o={};o[v.parserResult.keyName]=t;o.value=e[t];return o}))};if(v.parserResult.keyName){createArrayFromObject();v.parserResult.source=m("$uisSource"+v.parserResult.filters);t.$watch(s,(function(e,t){if(e!==t)createArrayFromObject()}),true)}v.refreshItems=function(e){e=e||v.parserResult.source(t);var o=v.selected;if(v.isEmpty()||angular.isArray(o)&&!o.length||!v.multiple||!v.removeSelected){v.setItemsFn(e)}else{if(e!==undefined&&e!==null){var n=e.filter((function(e){return angular.isArray(o)?o.every((function(t){return!angular.equals(e,t)})):!angular.equals(e,o)}));v.setItemsFn(n)}}if(v.dropdownPosition==="auto"||v.dropdownPosition==="up"){t.calculateDropdownPos()}t.$broadcast("uis:refresh")};t.$watchCollection(v.parserResult.source,(function(e){if(e===undefined||e===null){v.items=[]}else{if(!angular.isArray(e)){throw d("items","Expected an array but got '{0}'.",e)}else{v.refreshItems(e);if(angular.isDefined(v.ngModel.$modelValue)){v.ngModel.$modelValue=null}}}}))};var S;v.refresh=function(e){if(e!==undefined){if(S){n.cancel(S)}S=n((function(){if(t.$select.search.length>=t.$select.minimumInputLength){var o=t.$eval(e);if(o&&angular.isFunction(o.then)&&!v.refreshing){v.refreshing=true;o.finally((function(){v.refreshing=false}))}}}),v.refreshDelay)}};v.isActive=function(e){if(!v.open){return false}var t=v.items.indexOf(e[v.itemProperty]);var o=t==v.activeIndex;if(!o||t<0){return false}if(o&&!angular.isUndefined(v.onHighlightCallback)){e.$eval(v.onHighlightCallback)}return o};var _isItemSelected=function(e){return v.selected&&angular.isArray(v.selected)&&v.selected.filter((function(t){return angular.equals(t,e)})).length>0};var C=[];function _updateItemDisabled(e,t){var o=C.indexOf(e);if(t&&o===-1){C.push(e)}if(!t&&o>-1){C.splice(o,1)}}function _isItemDisabled(e){return C.indexOf(e)>-1}v.isDisabled=function(e){if(!v.open)return;var t=e[v.itemProperty];var o=v.items.indexOf(t);var n=false;if(o>=0&&(angular.isDefined(v.disableChoiceExpression)||v.multiple)){if(t.isTag)return false;if(v.multiple){n=_isItemSelected(t)}if(!n&&angular.isDefined(v.disableChoiceExpression)){n=!!e.$eval(v.disableChoiceExpression)}_updateItemDisabled(t,n)}return n};v.select=function(e,o,n){if(isNil(e)||!_isItemDisabled(e)){if(!v.items&&!v.search&&!v.tagging.isActivated)return;if(!e||!_isItemDisabled(e)){v.clickTriggeredSelect=false;if(n&&(n.type==="click"||n.type==="touchend")&&e)v.clickTriggeredSelect=true;if(v.tagging.isActivated&&v.clickTriggeredSelect===false){if(v.taggingLabel===false){if(v.activeIndex<0){if(e===undefined){e=v.tagging.fct!==undefined?v.tagging.fct(v.search):v.search}if(!e||angular.equals(v.items[0],e)){return}}else{e=v.items[v.activeIndex]}}else{if(v.activeIndex===0){if(e===undefined)return;if(v.tagging.fct!==undefined&&typeof e==="string"){e=v.tagging.fct(e);if(!e)return}else if(typeof e==="string"){e=e.replace(v.taggingLabel,"").trim()}}}if(_isItemSelected(e)){v.close(o);return}}_resetSearchInput();t.$broadcast("uis:select",e);if(v.closeOnSelect){v.close(o)}}}};v.close=function(e){if(!v.open)return;if(v.ngModel&&v.ngModel.$setTouched)v.ngModel.$setTouched();v.open=false;_resetSearchInput();t.$broadcast("uis:close",e)};v.setFocus=function(){if(!v.focus)v.focusInput[0].focus()};v.clear=function(e){v.select(null);e.stopPropagation();n((function(){v.focusser[0].focus()}),0,false)};v.toggle=function(e){if(v.open){v.close();e.preventDefault();e.stopPropagation()}else{v.activate()}};v.isLocked=function(){return false};t.$watch((function(){return angular.isDefined(v.lockChoiceExpression)&&v.lockChoiceExpression!==""}),_initaliseLockedChoices);function _initaliseLockedChoices(e){if(!e)return;var t=[];function _updateItemLocked(e,o){var n=t.indexOf(e);if(o&&n===-1){t.push(e)}if(!o&&n>-1){t.splice(n,1)}}function _isItemlocked(e){return t.indexOf(e)>-1}v.isLocked=function(e,t){var o=false,n=v.selected[t];if(n){if(e){o=!!e.$eval(v.lockChoiceExpression);_updateItemLocked(n,o)}else{o=_isItemlocked(n)}}return o}}var b=null;var I=false;v.sizeSearchInput=function(){var e=v.searchInput[0],o=v.$element[0],calculateContainerWidth=function(){return o.clientWidth*!!e.offsetParent},updateIfVisible=function(t){if(t===0){return false}var o=t-e.offsetLeft;if(o<50)o=t;v.searchInput.css("width",o+"px");return true};v.searchInput.css("width","10px");n((function(){if(b===null&&!updateIfVisible(calculateContainerWidth())){b=t.$watch((function(){if(!I){I=true;t.$$postDigest((function(){I=false;if(updateIfVisible(calculateContainerWidth())){b();b=null}}))}}),angular.noop)}}))};function _handleDropDownSelection(t){var o=true;switch(t){case e.DOWN:if(!v.open&&v.multiple)v.activate(false,true);else if(v.activeIndex<v.items.length-1){var n=++v.activeIndex;while(_isItemDisabled(v.items[n])&&n<v.items.length){v.activeIndex=++n}}break;case e.UP:var s=v.search.length===0&&v.tagging.isActivated?-1:0;if(!v.open&&v.multiple)v.activate(false,true);else if(v.activeIndex>s){var a=--v.activeIndex;while(_isItemDisabled(v.items[a])&&a>s){v.activeIndex=--a}}break;case e.TAB:if(!v.multiple||v.open)v.select(v.items[v.activeIndex],true);break;case e.ENTER:if(v.open&&(v.tagging.isActivated||v.activeIndex>=0)){v.select(v.items[v.activeIndex],v.skipFocusser)}else{v.activate(false,true)}break;case e.ESC:v.close();break;default:o=false}return o}v.searchInput.on("keydown",(function(o){var s=o.which;if(~[e.ENTER,e.ESC].indexOf(s)){o.preventDefault();o.stopPropagation()}t.$apply((function(){var t=false;if(v.items.length>0||v.tagging.isActivated){if(!_handleDropDownSelection(s)&&!v.searchEnabled){o.preventDefault();o.stopPropagation()}if(v.taggingTokens.isActivated){for(var a=0;a<v.taggingTokens.tokens.length;a++){if(v.taggingTokens.tokens[a]===e.MAP[o.keyCode]){if(v.search.length>0){t=true}}}if(t){n((function(){v.searchInput.triggerHandler("tagged");var t=v.search.replace(e.MAP[o.keyCode],"").trim();if(v.tagging.fct){t=v.tagging.fct(t)}if(t)v.select(t,true)}))}}}}));if(e.isVerticalMovement(s)&&v.items.length>0){_ensureHighlightVisible()}if(s===e.ENTER||s===e.ESC){o.preventDefault();o.stopPropagation()}}));v.searchInput.on("paste",(function(t){var o;if(window.clipboardData&&window.clipboardData.getData){o=window.clipboardData.getData("Text")}else{o=(t.originalEvent||t).clipboardData.getData("text/plain")}o=v.search+o;if(o&&o.length>0){if(v.taggingTokens.isActivated){var n=[];for(var s=0;s<v.taggingTokens.tokens.length;s++){var a=e.toSeparator(v.taggingTokens.tokens[s])||v.taggingTokens.tokens[s];if(o.indexOf(a)>-1){n=o.split(a);break}}if(n.length===0){n=[o]}var r=v.search;angular.forEach(n,(function(e){var t=v.tagging.fct?v.tagging.fct(e):e;if(t){v.select(t,true)}}));v.search=r||f;t.preventDefault();t.stopPropagation()}else if(v.paste){v.paste(o);v.search=f;t.preventDefault();t.stopPropagation()}}}));v.searchInput.on("tagged",(function(){n((function(){_resetSearchInput()}))}));function _ensureHighlightVisible(){var e=o.querySelectorAll(".ui-select-choices-content");var t=e.querySelectorAll(".ui-select-choices-row");if(t.length<1){throw d("choices","Expected multiple .ui-select-choices-row but got '{0}'.",t.length)}if(v.activeIndex<0){return}var n=t[v.activeIndex];var s=n.offsetTop+n.clientHeight-e[0].scrollTop;var a=e[0].offsetHeight;if(s>a){e[0].scrollTop+=s-a}else if(s<n.clientHeight){if(v.isGrouped&&v.activeIndex===0)e[0].scrollTop=0;else e[0].scrollTop-=n.clientHeight-s}}var w=a((function(){v.sizeSearchInput()}),50);angular.element(u).bind("resize",w);t.$on("$destroy",(function(){v.searchInput.off("keyup keydown tagged blur paste");angular.element(u).off("resize",w)}));t.$watch("$select.activeIndex",(function(e){if(e)o.find("input").attr("aria-activedescendant","ui-select-choices-row-"+v.generatedId+"-"+e)}));t.$watch("$select.open",(function(e){if(!e)o.find("input").removeAttr("aria-activedescendant")}))}]);o.directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","uisOffset","$compile","$parse","$timeout",function(e,t,o,n,s,a,r){return{restrict:"EA",templateUrl:function(e,o){var n=o.theme||t.theme;return n+(angular.isDefined(o.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:true,transclude:true,require:["uiSelect","^ngModel"],scope:true,controller:"uiSelectCtrl",controllerAs:"$select",compile:function(s,d){var p=/{(.*)}\s*{(.*)}/.exec(d.ngClass);if(p){var m="{"+p[1]+", "+p[2]+"}";d.ngClass=m;s.attr("ng-class",m)}if(angular.isDefined(d.multiple))s.append("<ui-select-multiple/>").removeAttr("multiple");else s.append("<ui-select-single/>");if(d.inputId)s.querySelectorAll("input.ui-select-search")[0].id=d.inputId;return function(s,d,p,m,g){var u=m[0];var v=m[1];u.generatedId=t.generateId();u.baseTitle=p.title||"Select box";u.focusserTitle=u.baseTitle+" focus";u.focusserId="focusser-"+u.generatedId;u.closeOnSelect=function(){if(angular.isDefined(p.closeOnSelect)){return a(p.closeOnSelect)()}else{return t.closeOnSelect}}();s.$watch("skipFocusser",(function(){var e=s.$eval(p.skipFocusser);u.skipFocusser=e!==undefined?e:t.skipFocusser}));u.onSelectCallback=a(p.onSelect);u.onRemoveCallback=a(p.onRemove);u.ngModel=v;u.choiceGrouped=function(e){return u.isGrouped&&e&&e.name};if(p.tabindex){p.$observe("tabindex",(function(e){u.focusInput.attr("tabindex",e);d.removeAttr("tabindex")}))}s.$watch((function(){return s.$eval(p.searchEnabled)}),(function(e){u.searchEnabled=e!==undefined?e:t.searchEnabled}));s.$watch("sortable",(function(){var e=s.$eval(p.sortable);u.sortable=e!==undefined?e:t.sortable}));p.$observe("backspaceReset",(function(){var e=s.$eval(p.backspaceReset);u.backspaceReset=e!==undefined?e:true}));p.$observe("limit",(function(){u.limit=angular.isDefined(p.limit)?parseInt(p.limit,10):undefined}));s.$watch("removeSelected",(function(){var e=s.$eval(p.removeSelected);u.removeSelected=e!==undefined?e:t.removeSelected}));p.$observe("disabled",(function(){u.disabled=p.disabled!==undefined?p.disabled:false}));p.$observe("resetSearchInput",(function(){var e=s.$eval(p.resetSearchInput);u.resetSearchInput=e!==undefined?e:true}));p.$observe("paste",(function(){u.paste=s.$eval(p.paste)}));p.$observe("tagging",(function(){if(p.tagging!==undefined){var e=s.$eval(p.tagging);u.tagging={isActivated:true,fct:e!==true?e:undefined}}else{u.tagging={isActivated:false,fct:undefined}}}));p.$observe("taggingLabel",(function(){if(p.tagging!==undefined){if(p.taggingLabel==="false"){u.taggingLabel=false}else{u.taggingLabel=p.taggingLabel!==undefined?p.taggingLabel:"(new)"}}}));p.$observe("taggingTokens",(function(){if(p.tagging!==undefined){var e=p.taggingTokens!==undefined?p.taggingTokens.split("|"):[",","ENTER"];u.taggingTokens={isActivated:true,tokens:e}}}));p.$observe("spinnerEnabled",(function(){var e=s.$eval(p.spinnerEnabled);u.spinnerEnabled=e!==undefined?e:t.spinnerEnabled}));p.$observe("spinnerClass",(function(){var e=p.spinnerClass;u.spinnerClass=e!==undefined?p.spinnerClass:t.spinnerClass}));if(angular.isDefined(p.autofocus)){r((function(){u.setFocus()}))}if(angular.isDefined(p.focusOn)){s.$on(p.focusOn,(function(){r((function(){u.setFocus()}))}))}function onDocumentClick(e){if(!u.open)return;var t=false;if(window.jQuery){t=window.jQuery.contains(d[0],e.target)}else{t=d[0].contains(e.target)}if(!t&&!u.clickTriggeredSelect){var o;if(!u.skipFocusser){var n=["input","button","textarea","select"];var a=angular.element(e.target).controller("uiSelect");o=a&&a!==u;if(!o)o=~n.indexOf(e.target.tagName.toLowerCase())}else{o=true}u.close(o);s.$digest()}u.clickTriggeredSelect=false}e.on("click",onDocumentClick);s.$on("$destroy",(function(){e.off("click",onDocumentClick)}));g(s,(function(e){var t=angular.element("<div>").append(e);var n=t.querySelectorAll(".ui-select-match");n.removeAttr("ui-select-match");n.removeAttr("data-ui-select-match");if(n.length!==1){throw o("transcluded","Expected 1 .ui-select-match but got '{0}'.",n.length)}d.querySelectorAll(".ui-select-match").replaceWith(n);var s=t.querySelectorAll(".ui-select-choices");s.removeAttr("ui-select-choices");s.removeAttr("data-ui-select-choices");if(s.length!==1){throw o("transcluded","Expected 1 .ui-select-choices but got '{0}'.",s.length)}d.querySelectorAll(".ui-select-choices").replaceWith(s);var a=t.querySelectorAll(".ui-select-no-choice");a.removeAttr("ui-select-no-choice");a.removeAttr("data-ui-select-no-choice");if(a.length==1){d.querySelectorAll(".ui-select-no-choice").replaceWith(a)}}));var f=s.$eval(p.appendToBody);if(f!==undefined?f:t.appendToBody){s.$watch("$select.open",(function(e){if(e){positionDropdown()}else{resetDropdown()}}));s.$on("$destroy",(function(){resetDropdown()}))}var S=null,C="";function positionDropdown(){var t=n(d);S=angular.element('<div class="ui-select-placeholder"></div>');S[0].style.width=t.width+"px";S[0].style.height=t.height+"px";d.after(S);C=d[0].style.width;e.find("body").append(d);d[0].style.position="absolute";d[0].style.left=t.left+"px";d[0].style.top=t.top+"px";d[0].style.width=t.width+"px"}function resetDropdown(){if(S===null){return}S.replaceWith(d);S=null;d[0].style.position="";d[0].style.left="";d[0].style.top="";d[0].style.width=C;u.setFocus()}var b=null,I="direction-up";s.$watch("$select.open",(function(){if(u.dropdownPosition==="auto"||u.dropdownPosition==="up"){s.calculateDropdownPos()}}));var setDropdownPosUp=function(e,t){e=e||n(d);t=t||n(b);b[0].style.position="absolute";b[0].style.top=t.height*-1+"px";d.addClass(I)};var setDropdownPosDown=function(e,t){d.removeClass(I);e=e||n(d);t=t||n(b);b[0].style.position="";b[0].style.top=""};var calculateDropdownPosAfterAnimation=function(){r((function(){if(u.dropdownPosition==="up"){setDropdownPosUp()}else{d.removeClass(I);var t=n(d);var o=n(b);var s=e[0].documentElement.scrollTop||e[0].body.scrollTop;if(t.top+t.height+o.height>s+e[0].documentElement.clientHeight){setDropdownPosUp(t,o)}else{setDropdownPosDown(t,o)}}b[0].style.opacity=1}))};var w=false;s.calculateDropdownPos=function(){if(u.open){b=angular.element(d).querySelectorAll(".ui-select-dropdown");if(b.length===0){return}if(u.search===""&&!w){b[0].style.opacity=0;w=true}if(!n(b).height&&u.$animate&&u.$animate.on&&u.$animate.enabled(b)){var e=true;u.$animate.on("enter",b,(function(t,o){if(o==="close"&&e){calculateDropdownPosAfterAnimation();e=false}}))}else{calculateDropdownPosAfterAnimation()}}else{if(b===null||b.length===0){return}b[0].style.opacity=0;b[0].style.position="";b[0].style.top="";d.removeClass(I)}}}}}}]);o.directive("uiSelectMatch",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:true,transclude:true,templateUrl:function(t){t.addClass("ui-select-match");var o=t.parent();var n=getAttribute(o,"theme")||e.theme;var s=angular.isDefined(getAttribute(o,"multiple"));return n+(s?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(t,o,n,s){s.lockChoiceExpression=n.uiLockChoice;n.$observe("placeholder",(function(t){s.placeholder=t!==undefined?t:e.placeholder}));function setAllowClear(e){s.allowClear=angular.isDefined(e)?e===""?true:e.toLowerCase()==="true":false}n.$observe("allowClear",setAllowClear);setAllowClear(n.allowClear);if(s.multiple){s.sizeSearchInput()}}};function getAttribute(e,t){if(e[0].hasAttribute(t))return e.attr(t);if(e[0].hasAttribute("data-"+t))return e.attr("data-"+t);if(e[0].hasAttribute("x-"+t))return e.attr("x-"+t)}}]);o.directive("uiSelectMultiple",["uiSelectMinErr","$timeout",function(t,o){return{restrict:"EA",require:["^uiSelect","^ngModel"],controller:["$scope","$timeout",function(e,t){var o=this,n=e.$select,s;if(angular.isUndefined(n.selected))n.selected=[];e.$evalAsync((function(){s=e.ngModel}));o.activeMatchIndex=-1;o.updateModel=function(){s.$setViewValue(Date.now());o.refreshComponent()};o.refreshComponent=function(){if(n.refreshItems){n.refreshItems()}if(n.sizeSearchInput){n.sizeSearchInput()}};o.removeChoice=function(s){if(n.isLocked(null,s))return false;var a=n.selected[s];var r={};r[n.parserResult.itemName]=a;n.selected.splice(s,1);o.activeMatchIndex=-1;n.sizeSearchInput();t((function(){n.onRemoveCallback(e,{$item:a,$model:n.parserResult.modelMapper(e,r)})}));o.updateModel();return true};o.getPlaceholder=function(){if(n.selected&&n.selected.length)return;return n.placeholder}}],controllerAs:"$selectMultiple",link:function(n,s,a,r){var d=r[0];var p=n.ngModel=r[1];var m=n.$selectMultiple;d.multiple=true;d.focusInput=d.searchInput;p.$isEmpty=function(e){return!e||e.length===0};p.$parsers.unshift((function(){var e={},t,o=[];for(var s=d.selected.length-1;s>=0;s--){e={};e[d.parserResult.itemName]=d.selected[s];t=d.parserResult.modelMapper(n,e);o.unshift(t)}return o}));p.$formatters.unshift((function(e){var t=d.parserResult&&d.parserResult.source(n,{$select:{search:""}}),o={},s;if(!t)return e;var a=[];var checkFnMultiple=function(e,t){if(!e||!e.length)return;for(var r=e.length-1;r>=0;r--){o[d.parserResult.itemName]=e[r];s=d.parserResult.modelMapper(n,o);if(d.parserResult.trackByExp){var p=/(\w*)\./.exec(d.parserResult.trackByExp);var m=/\.([^\s]+)/.exec(d.parserResult.trackByExp);if(p&&p.length>0&&p[1]==d.parserResult.itemName){if(m&&m.length>0&&s[m[1]]==t[m[1]]){a.unshift(e[r]);return true}}}if(angular.equals(s,t)){a.unshift(e[r]);return true}}return false};if(!e)return a;for(var r=e.length-1;r>=0;r--){if(!checkFnMultiple(d.selected,e[r])){if(!checkFnMultiple(t,e[r])){a.unshift(e[r])}}}return a}));n.$watchCollection((function(){return p.$modelValue}),(function(e,t){if(t!=e){if(angular.isDefined(p.$modelValue)){p.$modelValue=null}m.refreshComponent()}}));p.$render=function(){if(!angular.isArray(p.$viewValue)){if(isNil(p.$viewValue)){p.$viewValue=[]}else{throw t("multiarr","Expected model value to be array but got '{0}'",p.$viewValue)}}d.selected=p.$viewValue;m.refreshComponent();n.$evalAsync()};n.$on("uis:select",(function(e,t){if(d.selected.length>=d.limit){return}d.selected.push(t);var s={};s[d.parserResult.itemName]=t;o((function(){d.onSelectCallback(n,{$item:t,$model:d.parserResult.modelMapper(n,s)})}));m.updateModel()}));n.$on("uis:activate",(function(){m.activeMatchIndex=-1}));n.$watch("$select.disabled",(function(e,t){if(t&&!e)d.sizeSearchInput()}));d.searchInput.on("keydown",(function(t){var o=t.which;n.$apply((function(){var n=false;if(e.isHorizontalMovement(o)){n=_handleMatchSelection(o)}if(n&&o!=e.TAB){t.preventDefault();t.stopPropagation()}}))}));function _getCaretPosition(e){if(angular.isNumber(e.selectionStart))return e.selectionStart;else return e.value.length}function _handleMatchSelection(t){var o=_getCaretPosition(d.searchInput[0]),n=d.selected.length,s=0,a=n-1,r=m.activeMatchIndex,p=m.activeMatchIndex+1,g=m.activeMatchIndex-1,u=r;if(o>0||d.search.length&&t==e.RIGHT)return false;d.close();function getNewActiveMatchIndex(){switch(t){case e.LEFT:if(~m.activeMatchIndex)return g;else return a;case e.RIGHT:if(!~m.activeMatchIndex||r===a){d.activate();return false}else return p;case e.BACKSPACE:if(~m.activeMatchIndex){if(m.removeChoice(r)){return g}else{return r}}else{return a}case e.DELETE:if(~m.activeMatchIndex){m.removeChoice(m.activeMatchIndex);return r}else return false}}u=getNewActiveMatchIndex();if(!d.selected.length||u===false)m.activeMatchIndex=-1;else m.activeMatchIndex=Math.min(a,Math.max(s,u));return true}d.searchInput.on("keyup",(function(t){if(!e.isVerticalMovement(t.which)){n.$evalAsync((function(){d.activeIndex=d.taggingLabel===false?-1:0}))}if(d.tagging.isActivated&&d.search.length>0){if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||e.isVerticalMovement(t.which)){return}d.activeIndex=d.taggingLabel===false?-1:0;if(d.taggingLabel===false)return;var o=angular.copy(d.items);var s=angular.copy(d.items);var a;var r;var p=false;var m=-1;var g;var u;if(d.tagging.fct!==undefined){g=d.$filter("filter")(o,{isTag:true});if(g.length>0){u=g[0]}if(o.length>0&&u){p=true;o=o.slice(1,o.length);s=s.slice(1,s.length)}a=d.tagging.fct(d.search);if(s.some((function(e){return angular.equals(e,a)}))||d.selected.some((function(e){return angular.equals(e,a)}))){n.$evalAsync((function(){d.activeIndex=0;d.items=o}));return}if(a)a.isTag=true}else{g=d.$filter("filter")(o,(function(e){return e.match(d.taggingLabel)}));if(g.length>0){u=g[0]}r=o[0];if(r!==undefined&&o.length>0&&u){p=true;o=o.slice(1,o.length);s=s.slice(1,s.length)}a=d.search+" "+d.taggingLabel;if(_findApproxDupe(d.selected,d.search)>-1){return}if(_findCaseInsensitiveDupe(s.concat(d.selected))){if(p){o=s;n.$evalAsync((function(){d.activeIndex=0;d.items=o}))}return}if(_findCaseInsensitiveDupe(s)){if(p){d.items=s.slice(1,s.length)}return}}if(p)m=_findApproxDupe(d.selected,a);if(m>-1){o=o.slice(m+1,o.length-1)}else{o=[];if(a)o.push(a);o=o.concat(s)}n.$evalAsync((function(){d.activeIndex=0;d.items=o;if(d.isGrouped){var e=a?o.slice(1):o;d.setItemsFn(e);if(a){d.items.unshift(a);d.groups.unshift({name:"",items:[a],tagging:true})}}}))}}));function _findCaseInsensitiveDupe(e){if(e===undefined||d.search===undefined){return false}var t=e.filter((function(e){if(d.search.toUpperCase()===undefined||e===undefined){return false}return e.toUpperCase()===d.search.toUpperCase()})).length>0;return t}function _findApproxDupe(e,t){var o=-1;if(angular.isArray(e)){var n=angular.copy(e);for(var s=0;s<n.length;s++){if(d.tagging.fct===undefined){if(n[s]+" "+d.taggingLabel===t){o=s}}else{var a=n[s];if(angular.isObject(a)){a.isTag=true}if(angular.equals(a,t)){o=s}}}}return o}d.searchInput.on("blur",(function(){o((function(){m.activeMatchIndex=-1}))}))}}}]);o.directive("uiSelectNoChoice",["uiSelectConfig",function(e){return{restrict:"EA",require:"^uiSelect",replace:true,transclude:true,templateUrl:function(t){t.addClass("ui-select-no-choice");var o=t.parent().attr("theme")||e.theme;return o+"/no-choice.tpl.html"}}}]);o.directive("uiSelectSingle",["$timeout","$compile",function(t,o){return{restrict:"EA",require:["^uiSelect","^ngModel"],link:function(n,s,a,r){var d=r[0];var p=r[1];p.$parsers.unshift((function(e){if(isNil(e)){return e}var t={},o;t[d.parserResult.itemName]=e;o=d.parserResult.modelMapper(n,t);return o}));p.$formatters.unshift((function(e){if(isNil(e)){return e}var t=d.parserResult&&d.parserResult.source(n,{$select:{search:""}}),o={},s;if(t){var checkFnSingle=function(t){o[d.parserResult.itemName]=t;s=d.parserResult.modelMapper(n,o);return s===e};if(d.selected&&checkFnSingle(d.selected)){return d.selected}for(var a=t.length-1;a>=0;a--){if(checkFnSingle(t[a]))return t[a]}}return e}));n.$watch("$select.selected",(function(e){if(p.$viewValue!==e){p.$setViewValue(e)}}));p.$render=function(){d.selected=p.$viewValue};n.$on("uis:select",(function(e,o){d.selected=o;var s={};s[d.parserResult.itemName]=o;t((function(){d.onSelectCallback(n,{$item:o,$model:isNil(o)?o:d.parserResult.modelMapper(n,s)})}))}));n.$on("uis:close",(function(e,o){t((function(){d.focusser.prop("disabled",false);if(!o)d.focusser[0].focus()}),0,false)}));n.$on("uis:activate",(function(){m.prop("disabled",true)}));var m=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' id='{{ $select.focusserId }}' aria-label='{{ $select.focusserTitle }}' aria-haspopup='true' role='button' />");o(m)(n);d.focusser=m;d.focusInput=m;s.parent().append(m);m.bind("focus",(function(){n.$evalAsync((function(){d.focus=true}))}));m.bind("blur",(function(){n.$evalAsync((function(){d.focus=false}))}));m.bind("keydown",(function(t){if(t.which===e.BACKSPACE&&d.backspaceReset!==false){t.preventDefault();t.stopPropagation();d.select(undefined);n.$apply();return}if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC){return}if(t.which==e.DOWN||t.which==e.UP||t.which==e.ENTER||t.which==e.SPACE){t.preventDefault();t.stopPropagation();d.activate()}n.$digest()}));m.bind("keyup input",(function(t){if(t.which===e.TAB||e.isControl(t)||e.isFunctionKey(t)||t.which===e.ESC||t.which==e.ENTER||t.which===e.BACKSPACE){return}d.activate(m.val());m.val("");n.$digest()}))}}}]);o.directive("uiSelectSort",["$timeout","uiSelectConfig","uiSelectMinErr",function(e,t,o){return{require:["^^uiSelect","^ngModel"],link:function(t,n,s,a){if(t[s.uiSelectSort]===null){throw o("sort","Expected a list to sort")}var r=a[0];var d=a[1];var p=angular.extend({axis:"horizontal"},t.$eval(s.uiSelectSortOptions));var m=p.axis;var g="dragging";var u="dropping";var v="dropping-before";var f="dropping-after";t.$watch((function(){return r.sortable}),(function(e){if(e){n.attr("draggable",true)}else{n.removeAttr("draggable")}}));n.on("dragstart",(function(e){n.addClass(g);(e.dataTransfer||e.originalEvent.dataTransfer).setData("text",t.$index.toString())}));n.on("dragend",(function(){removeClass(g)}));var move=function(e,t){this.splice(t,0,this.splice(e,1)[0])};var removeClass=function(e){angular.forEach(r.$element.querySelectorAll("."+e),(function(t){angular.element(t).removeClass(e)}))};var dragOverHandler=function(e){e.preventDefault();var t=m==="vertical"?e.offsetY||e.layerY||(e.originalEvent?e.originalEvent.offsetY:0):e.offsetX||e.layerX||(e.originalEvent?e.originalEvent.offsetX:0);if(t<this[m==="vertical"?"offsetHeight":"offsetWidth"]/2){removeClass(f);n.addClass(v)}else{removeClass(v);n.addClass(f)}};var S;var dropHandler=function(t){t.preventDefault();var o=parseInt((t.dataTransfer||t.originalEvent.dataTransfer).getData("text"),10);e.cancel(S);S=e((function(){_dropHandler(o)}),20)};var _dropHandler=function(e){var o=t.$eval(s.uiSelectSort);var a=o[e];var r=null;if(n.hasClass(v)){if(e<t.$index){r=t.$index-1}else{r=t.$index}}else{if(e<t.$index){r=t.$index}else{r=t.$index+1}}move.apply(o,[e,r]);d.$setViewValue(Date.now());t.$apply((function(){t.$emit("uiSelectSort:change",{array:o,item:a,from:e,to:r})}));removeClass(u);removeClass(v);removeClass(f);n.off("drop",dropHandler)};n.on("dragenter",(function(){if(n.hasClass(g)){return}n.addClass(u);n.on("dragover",dragOverHandler);n.on("drop",dropHandler)}));n.on("dragleave",(function(e){if(e.target!=n){return}removeClass(u);removeClass(v);removeClass(f);n.off("dragover",dragOverHandler);n.off("drop",dropHandler)}))}}}]);o.factory("$$uisDebounce",["$timeout",function(e){return function(t,o){var n;return function(){var s=this;var a=Array.prototype.slice.call(arguments);if(n){e.cancel(n)}n=e((function(){t.apply(s,a)}),o)}}}]);o.directive("uisOpenClose",["$parse","$timeout",function(e,t){return{restrict:"A",require:"uiSelect",link:function(o,n,s,a){a.onOpenCloseCallback=e(s.uisOpenClose);o.$watch("$select.open",(function(e,n){if(e!==n){t((function(){a.onOpenCloseCallback(o,{isOpen:e})}))}}))}}}]);o.service("uisRepeatParser",["uiSelectMinErr","$parse",function(e,t){var o=this;o.parse=function(o){var n;n=o.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!n){throw e("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",o)}var s=n[5],a="";if(n[3]){s=n[5].replace(/(^\()|(\)$)/g,"");var r=n[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/);if(r&&r[1].trim()){a=r[1];s=s.replace(a,"")}}return{itemName:n[4]||n[2],keyName:n[3],source:t(s),filters:a,trackByExp:n[6],modelMapper:t(n[1]||n[4]||n[2]),repeatExpression:function(e){var t=this.itemName+" in "+(e?"$group.items":"$select.items");if(this.trackByExp){t+=" track by "+this.trackByExp}return t}}};o.getGroupNgRepeatExpression=function(){return"$group in $select.groups track by $group.name"}}])})();angular.module("ui.select").run(["$templateCache",function(e){e.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" ng-show="$select.open && $select.items.length > 0"><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"></div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"></div><div ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}" role="option"><span class="ui-select-choices-row-inner"></span></div></li></ul>');e.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected track by $index"><span class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" type="button" ng-disabled="$select.disabled" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$selectMultiple.activeMatchIndex === $index, \'select-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;</span> <span uis-transclude-append=""></span></span></span></span>');e.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""></span> <i class="caret pull-right" ng-click="$select.toggle($event)"></i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="glyphicon glyphicon-remove" aria-hidden="true"></i></a></span></div>');e.put("bootstrap/no-choice.tpl.html",'<ul class="ui-select-no-choice dropdown-menu" ng-show="$select.items.length == 0"><li ng-transclude=""></li></ul>');e.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"></div><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-click="$select.activate()" ng-model="$select.search" role="combobox" aria-expanded="{{$select.open}}" aria-label="{{$select.baseTitle}}" ng-class="{\'spinner\': $select.refreshing}" ondrop="return false;"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>');e.put("bootstrap/select.tpl.html",'<div class="ui-select-container ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"></div><span ng-show="$select.open && $select.refreshing && $select.spinnerEnabled" class="ui-select-refreshing {{$select.spinnerClass}}"></span> <input type="search" autocomplete="off" tabindex="-1" aria-expanded="true" aria-label="{{ $select.baseTitle }}" aria-owns="ui-select-choices-{{ $select.generatedId }}" class="form-control ui-select-search" ng-class="{ \'ui-select-search-hidden\' : !$select.searchEnabled }" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.open"><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>');e.put("select2/choices.tpl.html",'<ul tabindex="-1" class="ui-select-choices ui-select-choices-content select2-results"><li class="ui-select-choices-group" ng-class="{\'select2-result-with-children\': $select.choiceGrouped($group) }"><div ng-show="$select.choiceGrouped($group)" class="ui-select-choices-group-label select2-result-label" ng-bind="$group.name"></div><ul id="ui-select-choices-{{ $select.generatedId }}" ng-class="{\'select2-result-sub\': $select.choiceGrouped($group), \'select2-result-single\': !$select.choiceGrouped($group) }"><li role="option" ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{\'select2-highlighted\': $select.isActive(this), \'select2-disabled\': $select.isDisabled(this)}"><div class="select2-result-label ui-select-choices-row-inner"></div></li></ul></li></ul>');e.put("select2/match-multiple.tpl.html",'<span class="ui-select-match"><li class="ui-select-match-item select2-search-choice" ng-repeat="$item in $select.selected track by $index" ng-class="{\'select2-search-choice-focus\':$selectMultiple.activeMatchIndex === $index, \'select2-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span uis-transclude-append=""></span> <a href="javascript:;" class="ui-select-match-close select2-search-choice-close" ng-click="$selectMultiple.removeChoice($index)" tabindex="-1"></a></li></span>');e.put("select2/match.tpl.html",'<a class="select2-choice ui-select-match" ng-class="{\'select2-default\': $select.isEmpty()}" ng-click="$select.toggle($event)" aria-label="{{ $select.baseTitle }} select"><span ng-show="$select.isEmpty()" class="select2-chosen">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty()" class="select2-chosen" ng-transclude=""></span> <abbr ng-if="$select.allowClear && !$select.isEmpty()" class="select2-search-choice-close" ng-click="$select.clear($event)"></abbr> <span class="select2-arrow ui-select-toggle"><b></b></span></a>');e.put("select2/no-choice.tpl.html",'<div class="ui-select-no-choice dropdown" ng-show="$select.items.length == 0"><div class="dropdown-content"><div data-selectable="" ng-transclude=""></div></div></div>');e.put("select2/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple select2 select2-container select2-container-multi" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled}"><ul class="select2-choices"><span class="ui-select-match"></span><li class="select2-search-field"><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="select2-input ui-select-search" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-model="$select.search" ng-click="$select.activate()" style="width: 34px;" ondrop="return false;"></li></ul><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open || $select.items.length === 0}"><div class="ui-select-choices"></div></div></div>');e.put("select2/select.tpl.html",'<div class="ui-select-container select2 select2-container" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled, \'select2-container-active\': $select.focus, \'select2-allowclear\': $select.allowClear && !$select.isEmpty()}"><div class="ui-select-match"></div><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="search-container" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled, \'select2-search\':$select.searchEnabled}"><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" ng-class="{\'select2-active\': $select.refreshing}" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" class="ui-select-search select2-input" ng-model="$select.search"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div></div>');e.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices ui-select-dropdown selectize-dropdown" ng-class="{\'single\': !$select.multiple, \'multi\': $select.multiple}"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header" ng-bind="$group.name"></div><div role="option" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""></div></div></div></div></div>');e.put("selectize/match-multiple.tpl.html",'<div class="ui-select-match" data-value="" ng-repeat="$item in $select.selected track by $index" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'active\':$selectMultiple.activeMatchIndex === $index}" ui-select-sort="$select.selected"><span class="ui-select-match-item" ng-class="{\'select-locked\':$select.isLocked(this, $index)}"><span uis-transclude-append=""></span> <span class="remove ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&times;</span></span></div>');e.put("selectize/match.tpl.html",'<div ng-hide="$select.searchEnabled && ($select.open || $select.isEmpty())" class="ui-select-match"><span ng-show="!$select.searchEnabled && ($select.isEmpty() || $select.open)" class="ui-select-placeholder text-muted">{{$select.placeholder}}</span> <span ng-hide="$select.isEmpty() || $select.open" ng-transclude=""></span></div>');e.put("selectize/no-choice.tpl.html",'<div class="ui-select-no-choice selectize-dropdown" ng-show="$select.items.length == 0"><div class="selectize-dropdown-content"><div data-selectable="" ng-transclude=""></div></div></div>');e.put("selectize/select-multiple.tpl.html",'<div class="ui-select-container selectize-control multi plugin-remove_button" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"></div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-model="$select.search" ng-disabled="$select.disabled" aria-expanded="{{$select.open}}" aria-label="{{ $select.baseTitle }}" ondrop="return false;"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>');e.put("selectize/select.tpl.html",'<div class="ui-select-container selectize-control single" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"></div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search ui-select-toggle" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" ng-click="$select.toggle($event)" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.isEmpty() && !$select.open" ng-disabled="$select.disabled" aria-label="{{ $select.baseTitle }}"></div><div class="ui-select-choices"></div><div class="ui-select-no-choice"></div></div>')}]);a.module("resourceLocationsModule",[]).constant("CONTEXT_SITE_ID",ye).constant("CONTEXT_CATALOG",_e).constant("CONTEXT_CATALOG_VERSION",fe).constant("PAGE_CONTEXT_SITE_ID",be).constant("PAGE_CONTEXT_CATALOG",Se).constant("PAGE_CONTEXT_CATALOG_VERSION",Ce).constant("SMARTEDIT_ROOT","smartedit").constant("SMARTEDIT_RESOURCE_URI_REGEXP",Ue).constant("CONFIGURATION_URI",$e).constant("CMSWEBSERVICES_RESOURCE_URI","/cmswebservices").constant("DEFAULT_AUTHENTICATION_ENTRY_POINT",s.DEFAULT_AUTHENTICATION_ENTRY_POINT).constant("DEFAULT_AUTHENTICATION_CLIENT_ID",Me).constant("I18N_RESOURCE_URI","/smarteditwebservices/v1/i18n/translations").constant("I18N_LANGUAGES_RESOURCE_URI",yt).constant("PREVIEW_RESOURCE_URI",Le).constant("LANGUAGE_RESOURCE_URI",ft).constant("PRODUCT_RESOURCE_API",Rt).constant("PRODUCT_LIST_RESOURCE_API",kt).constant("SITES_RESOURCE_URI",Pt).constant("LANDING_PAGE_PATH",s.LANDING_PAGE_PATH).constant("STORE_FRONT_CONTEXT",Dt).constant("CATALOGS_PATH","/cmswebservices/v1/catalogs/").constant("MEDIA_PATH",Xt).constant("ENUM_RESOURCE_URI","/cmswebservices/v1/enums").constant("SYNC_PATH","/cmswebservices/v1/catalogs/:catalog/versions/Staged/synchronizations/versions/Online").constant("MEDIA_RESOURCE_URI",Zt).constant("TYPES_RESOURCE_URI",xt).factory("resourceLocationToRegex",(function(){return ae.resourceLocationToRegex}));let ss=class SeConstantsModule{};ss=__decorate([SeModule({providers:[...se.provideValues({CTX_MENU_DROPDOWN_IS_OPEN:Ae,CLOSE_CTX_MENU:Pe,SHOW_SLOT_MENU:"_SHOW_SLOT_MENU",HIDE_SLOT_MENU:"HIDE_SLOT_MENU"}),{provide:"OVERLAY_ID",useValue:it},{provide:"COMPONENT_CLASS",useValue:"smartEditComponent"},{provide:"OVERLAY_COMPONENT_CLASS",useValue:ht},{provide:"SMARTEDIT_ATTRIBUTE_PREFIX",useValue:"data-smartedit-"},{provide:"ID_ATTRIBUTE",useValue:me},{provide:"UUID_ATTRIBUTE",useValue:ut},{provide:"ELEMENT_UUID_ATTRIBUTE",useValue:pe},{provide:"CATALOG_VERSION_UUID_ATTRIBUTE",useValue:nt},{provide:"TYPE_ATTRIBUTE",useValue:ge},{provide:"CONTAINER_ID_ATTRIBUTE",useValue:"data-smartedit-container-id"},{provide:"CONTAINER_TYPE_ATTRIBUTE",useValue:_t},{provide:"CONTENT_SLOT_TYPE",useValue:vt},{provide:"SMARTEDIT_IFRAME_WRAPPER_ID",useValue:Ht},{provide:"SMARTEDIT_IFRAME_DRAG_AREA",useValue:Bt},{provide:"EVENT_TOGGLE_SMARTEDIT_IFRAME_DRAG_AREA",useValue:"EVENT_TOGGLE_SMARTEDIT_IFRAME_DRAG_AREA"},{provide:"SCROLL_AREA_CLASS",useValue:$t},{provide:"SMARTEDIT_ELEMENT_HOVERED",useValue:jt},{provide:"SMARTEDIT_DRAG_AND_DROP_EVENTS",useValue:Ft},{provide:"DATE_CONSTANTS",useValue:At},{provide:qt,useValue:qt},{provide:Ke,useValue:Ke},{provide:Xe,useValue:Xe},{provide:Qe,useValue:Qe},{provide:Ye,useValue:Ye},{provide:Ze,useValue:Ze},{provide:"ALL_PERSPECTIVE",useValue:Lt},{provide:"NONE_PERSPECTIVE",useValue:zt},{provide:"PERSPECTIVE_SELECTOR_WIDGET_KEY",useValue:et},{provide:"VALIDATION_MESSAGE_TYPES",useValue:{VALIDATION_ERROR:"ValidationError",WARNING:"Warning"}},{provide:"CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS",useValue:dt},{provide:"SMARTEDIT_COMPONENT_PROCESS_STATUS",useValue:"smartEditComponentProcessStatus"},{provide:"CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS",useValue:ct},{provide:"SORT_DIRECTIONS",useValue:{ASC:t.SortDirections.Ascending,DESC:t.SortDirections.Descending}},{provide:ot,useValue:ot},{provide:He,useValue:He},{provide:"SHOW_TOOLBAR_ITEM_CONTEXT",useValue:Nt},{provide:"HIDE_TOOLBAR_ITEM_CONTEXT",useValue:Mt},{provide:"EVENT_NOTIFICATION_CHANGED",useValue:"EVENT_NOTIFICATION_CHANGED"},{provide:"OVERLAY_RERENDERED_EVENT",useValue:pt},{provide:"WHO_AM_I_RESOURCE_URI",useValue:ke},{provide:"EVENTS",useValue:s.EVENTS},{provide:"SELECTED_LANGUAGE",useValue:"SELECTED_LANGUAGE"},{provide:"SWITCH_LANGUAGE_EVENT",useValue:"SWITCH_LANGUAGE_EVENT"},{provide:"EVENT_SMARTEDIT_COMPONENT_UPDATED",useValue:tt},{provide:"OPERATION_CONTEXT",useValue:De},{provide:"SMARTEDIT_INNER_FILES",useValue:"SMARTEDIT_INNER_FILES"},{provide:"SMARTEDIT_INNER_FILES_POST",useValue:"SMARTEDIT_INNER_FILES_POST"}]})],ss);let as=class SmarteditRootModule{};as=__decorate([SeModule({imports:[t.DIBridgeModule,"resourceLocationsModule","yLoDashModule",ss],providers:[s.CloneableUtils,s.LogService,t.ModuleUtils,s.PromiseUtils,StringUtils,s.FunctionsUtils]})],as);const rs=o(939);const ls=o(557);const cs=o(942);const ds=o(944);deprecate();t.LegacySmarteditCommonsModule=class LegacySmarteditCommonsModule{};t.LegacySmarteditCommonsModule=__decorate([SeModule({imports:[as,cs,ds,ls,"resourceLocationsModule","seConstantsModule","yLoDashModule",t.TranslationServiceModule,t.ConfigModule,"ui.select",rs],providers:[t.LanguageServiceGateway]})],t.LegacySmarteditCommonsModule);Object.defineProperty(t,"ALERT_CONFIG_DEFAULTS",{enumerable:true,get:function(){return s.ALERT_CONFIG_DEFAULTS}});Object.defineProperty(t,"ALERT_CONFIG_DEFAULTS_TOKEN",{enumerable:true,get:function(){return s.ALERT_CONFIG_DEFAULTS_TOKEN}});Object.defineProperty(t,"AbstractCachedRestService",{enumerable:true,get:function(){return s.AbstractCachedRestService}});Object.defineProperty(t,"Alert",{enumerable:true,get:function(){return s.Alert}});Object.defineProperty(t,"AlertModule",{enumerable:true,get:function(){return s.AlertModule}});Object.defineProperty(t,"AuthenticationService",{enumerable:true,get:function(){return s.AuthenticationService}});Object.defineProperty(t,"BaseAlertFactory",{enumerable:true,get:function(){return s.AlertFactory}});Object.defineProperty(t,"BaseAlertService",{enumerable:true,get:function(){return s.AlertService}});Object.defineProperty(t,"BrowserService",{enumerable:true,get:function(){return s.BrowserService}});Object.defineProperty(t,"CacheAction",{enumerable:true,get:function(){return s.CacheAction}});Object.defineProperty(t,"CacheConfig",{enumerable:true,get:function(){return s.CacheConfig}});Object.defineProperty(t,"CacheConfigAnnotationFactory",{enumerable:true,get:function(){return s.CacheConfigAnnotationFactory}});Object.defineProperty(t,"CacheService",{enumerable:true,get:function(){return s.CacheService}});Object.defineProperty(t,"Cached",{enumerable:true,get:function(){return s.Cached}});Object.defineProperty(t,"CachedAnnotationFactory",{enumerable:true,get:function(){return s.CachedAnnotationFactory}});Object.defineProperty(t,"CloneableUtils",{enumerable:true,get:function(){return s.CloneableUtils}});Object.defineProperty(t,"CryptographicUtils",{enumerable:true,get:function(){return s.CryptographicUtils}});Object.defineProperty(t,"DEFAULT_AUTHENTICATION_ENTRY_POINT",{enumerable:true,get:function(){return s.DEFAULT_AUTHENTICATION_ENTRY_POINT}});Object.defineProperty(t,"DEFAULT_AUTH_MAP",{enumerable:true,get:function(){return s.DEFAULT_AUTH_MAP}});Object.defineProperty(t,"DEFAULT_CREDENTIALS_MAP",{enumerable:true,get:function(){return s.DEFAULT_CREDENTIALS_MAP}});Object.defineProperty(t,"DEFAULT_LANGUAGE_ISO",{enumerable:true,get:function(){return s.DEFAULT_LANGUAGE_ISO}});Object.defineProperty(t,"EVENTS",{enumerable:true,get:function(){return s.EVENTS}});Object.defineProperty(t,"EVENT_SERVICE",{enumerable:true,get:function(){return s.EVENT_SERVICE}});Object.defineProperty(t,"EvictionTag",{enumerable:true,get:function(){return s.EvictionTag}});Object.defineProperty(t,"FileMimeTypeService",{enumerable:true,get:function(){return s.FileMimeTypeService}});Object.defineProperty(t,"FileReaderService",{enumerable:true,get:function(){return s.FileReaderService}});Object.defineProperty(t,"FileValidatorFactory",{enumerable:true,get:function(){return s.FileValidatorFactory}});Object.defineProperty(t,"FingerPrintingService",{enumerable:true,get:function(){return s.FingerPrintingService}});Object.defineProperty(t,"FunctionsUtils",{enumerable:true,get:function(){return s.FunctionsUtils}});Object.defineProperty(t,"FundamentalModalTemplateModule",{enumerable:true,get:function(){return s.FundamentalModalTemplateModule}});Object.defineProperty(t,"HttpBackendService",{enumerable:true,get:function(){return s.HttpBackendService}});Object.defineProperty(t,"HttpErrorInterceptorService",{enumerable:true,get:function(){return s.HttpErrorInterceptorService}});Object.defineProperty(t,"HttpInterceptorModule",{enumerable:true,get:function(){return s.HttpInterceptorModule}});Object.defineProperty(t,"HttpUtils",{enumerable:true,get:function(){return s.HttpUtils}});Object.defineProperty(t,"I18N_RESOURCE_URI_TOKEN",{enumerable:true,get:function(){return s.I18N_RESOURCE_URI_TOKEN}});Object.defineProperty(t,"I18N_ROOT_RESOURCE_URI",{enumerable:true,get:function(){return s.I18N_ROOT_RESOURCE_URI}});Object.defineProperty(t,"IAlertService",{enumerable:true,get:function(){return s.IAlertService}});Object.defineProperty(t,"IAlertServiceType",{enumerable:true,get:function(){return s.IAlertServiceType}});Object.defineProperty(t,"IAuthenticationManagerService",{enumerable:true,get:function(){return s.IAuthenticationManagerService}});Object.defineProperty(t,"IAuthenticationService",{enumerable:true,get:function(){return s.IAuthenticationService}});Object.defineProperty(t,"IBrowserService",{enumerable:true,get:function(){return s.BrowserService}});Object.defineProperty(t,"IModalService",{enumerable:true,get:function(){return s.IModalService}});Object.defineProperty(t,"ISessionService",{enumerable:true,get:function(){return s.ISessionService}});Object.defineProperty(t,"ISettingsService",{enumerable:true,get:function(){return s.ISettingsService}});Object.defineProperty(t,"ISharedDataService",{enumerable:true,get:function(){return s.ISharedDataService}});Object.defineProperty(t,"IStorageService",{enumerable:true,get:function(){return s.IStorageService}});Object.defineProperty(t,"ITranslationsFetchService",{enumerable:true,get:function(){return s.ITranslationsFetchService}});Object.defineProperty(t,"InvalidateCache",{enumerable:true,get:function(){return s.InvalidateCache}});Object.defineProperty(t,"InvalidateCacheAnnotationFactory",{enumerable:true,get:function(){return s.InvalidateCacheAnnotationFactory}});Object.defineProperty(t,"LANDING_PAGE_PATH",{enumerable:true,get:function(){return s.LANDING_PAGE_PATH}});Object.defineProperty(t,"LogService",{enumerable:true,get:function(){return s.LogService}});Object.defineProperty(t,"ModalButtonAction",{enumerable:true,get:function(){return s.ModalButtonAction}});Object.defineProperty(t,"ModalButtonStyle",{enumerable:true,get:function(){return s.ModalButtonStyle}});Object.defineProperty(t,"ModalConfig",{enumerable:true,get:function(){return s.ModalConfig}});Object.defineProperty(t,"ModalManagerService",{enumerable:true,get:function(){return s.ModalManagerService}});Object.defineProperty(t,"ModalService",{enumerable:true,get:function(){return s.ModalService}});Object.defineProperty(t,"OPERATION_CONTEXT_TOKEN",{enumerable:true,get:function(){return s.OPERATION_CONTEXT_TOKEN}});Object.defineProperty(t,"OperationContextAnnotationFactory",{enumerable:true,get:function(){return s.OperationContextAnnotationFactory}});Object.defineProperty(t,"OperationContextRegistered",{enumerable:true,get:function(){return s.OperationContextRegistered}});Object.defineProperty(t,"OperationContextService",{enumerable:true,get:function(){return s.OperationContextService}});Object.defineProperty(t,"ParentWindowUtils",{enumerable:true,get:function(){return s.WindowUtils}});Object.defineProperty(t,"PermissionErrorInterceptor",{enumerable:true,get:function(){return s.PermissionErrorInterceptor}});Object.defineProperty(t,"PromiseUtils",{enumerable:true,get:function(){return s.PromiseUtils}});Object.defineProperty(t,"ResponseAdapterInterceptor",{enumerable:true,get:function(){return s.ResponseAdapterInterceptor}});Object.defineProperty(t,"RestServiceFactory",{enumerable:true,get:function(){return s.RestServiceFactory}});Object.defineProperty(t,"RetryInterceptor",{enumerable:true,get:function(){return s.RetryInterceptor}});Object.defineProperty(t,"SELECTED_LANGUAGE",{enumerable:true,get:function(){return s.SELECTED_LANGUAGE}});Object.defineProperty(t,"SSOAuthenticationHelper",{enumerable:true,get:function(){return s.SSOAuthenticationHelper}});Object.defineProperty(t,"SWITCH_LANGUAGE_EVENT",{enumerable:true,get:function(){return s.SWITCH_LANGUAGE_EVENT}});Object.defineProperty(t,"SeTranslationModule",{enumerable:true,get:function(){return s.TranslationModule}});Object.defineProperty(t,"TranslationModule",{enumerable:true,get:function(){return s.TranslationModule}});Object.defineProperty(t,"URIBuilder",{enumerable:true,get:function(){return s.URIBuilder}});Object.defineProperty(t,"UnauthorizedErrorInterceptor",{enumerable:true,get:function(){return s.UnauthorizedErrorInterceptor}});Object.defineProperty(t,"UrlUtils",{enumerable:true,get:function(){return s.UrlUtils}});Object.defineProperty(t,"WHO_AM_I_RESOURCE_URI_TOKEN",{enumerable:true,get:function(){return s.WHO_AM_I_RESOURCE_URI_TOKEN}});Object.defineProperty(t,"annotationService",{enumerable:true,get:function(){return s.annotationService}});Object.defineProperty(t,"booleanUtils",{enumerable:true,get:function(){return s.booleanUtils}});Object.defineProperty(t,"commonNgZone",{enumerable:true,get:function(){return s.commonNgZone}});Object.defineProperty(t,"functionsUtils",{enumerable:true,get:function(){return s.functionsUtils}});Object.defineProperty(t,"httpUtils",{enumerable:true,get:function(){return s.httpUtils}});Object.defineProperty(t,"promiseUtils",{enumerable:true,get:function(){return s.promiseUtils}});Object.defineProperty(t,"urlUtils",{enumerable:true,get:function(){return s.urlUtils}});t.$translateStaticFilesLoader=$translateStaticFilesLoader;t.ALL_PERSPECTIVE=Lt;t.ANNOUNCEMENT_DATA=Ci;t.AbstractAngularJSBasedCustomElement=AbstractAngularJSBasedCustomElement;t.AbstractDecorator=AbstractDecorator;t.ApiUtils=ApiUtils;t.CATALOG_DETAILS_COLUMNS=Ot;t.CATALOG_DETAILS_ITEM_DATA=ao;t.CATALOG_VERSION_PERMISSIONS_RESOURCE_URI_CONSTANT=xe;t.CATALOG_VERSION_UUID_ATTRIBUTE=nt;t.CLICK_DROPDOWN=Tt;t.CLICK_DROPDOWN_TOKEN=mn;t.CLIENT_PAGED_LIST_CELL_COMPONENT_DATA_TOKEN=Wn;t.CLOSE_CTX_MENU=Pe;t.CMSITEMS_UPDATE_EVENT=oi;t.CMSWEBSERVICES_PATH=Ve;t.CMS_EVENT_OPEN_PAGE_WORKFLOW_MENU=ii;t.COLLAPSIBLE_DEFAULT_CONFIGURATION=wo;t.COMPONENT_CLASS=at;t.CONFIGURATION_URI=$e;t.CONTAINER_ID_ATTRIBUTE=lt;t.CONTAINER_TYPE_ATTRIBUTE=_t;t.CONTENT_SLOT_TYPE=vt;t.CONTEXTUAL_MENU_ITEM_DATA=ie;t.CONTEXT_CATALOG=_e;t.CONTEXT_CATALOG_VERSION=fe;t.CONTEXT_SITE_ID=ye;t.CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS=ct;t.CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS=dt;t.CSS_CLASSNAMES=Uo;t.CTX_MENU_DROPDOWN_IS_OPEN=Ae;t.CustomDropdownPopulatorsToken=gn;t.CustomHandlingStrategy=CustomHandlingStrategy;t.DATA_TABLE_COMPONENT_DATA=Po;t.DATE_CONSTANTS=At;t.DEFAULT_AUTHENTICATION_CLIENT_ID=Me;t.DEFAULT_GENERIC_EDITOR_FLOAT_PRECISION=An;t.DEFAULT_LANGUAGE=Te;t.DIBridgeUtils=DIBridgeUtils;t.DINameUtils=DINameUtils;t.DOMAIN_TOKEN=re;t.DO_NOT_USE_STORAGE_MANAGER_TOKEN=so;t.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME=Gt;t.DROPDOWN_IMPLEMENTATION_SUFFIX=wt;t.DROPDOWN_IMPLEMENTATION_SUFFIX_TOKEN=pn;t.DROPDOWN_MENU_ITEM_DATA=So;t.DateUtils=DateUtils;t.DropdownPopulatorInterface=DropdownPopulatorInterface;t.ELEMENT_UUID_ATTRIBUTE=pe;t.ENUM_RESOURCE_URI=It;t.EVENT_CONTENT_CATALOG_UPDATE=qt;t.EVENT_NOTIFICATION_CHANGED=Ge;t.EVENT_OPEN_IN_PAGE_TREE=li;t.EVENT_OUTER_FRAME_CLICKED=ot;t.EVENT_OVERALL_REFRESH_TREE_NODE=di;t.EVENT_PAGE_TREE_COMPONENT_SELECTED=ri;t.EVENT_PAGE_TREE_PANEL_SWITCH=si;t.EVENT_PAGE_TREE_SLOT_NEED_UPDATE=pi;t.EVENT_PAGE_TREE_SLOT_SELECTED=ai;t.EVENT_PART_REFRESH_TREE_NODE=ci;t.EVENT_PERSPECTIVE_ADDED=Xe;t.EVENT_PERSPECTIVE_CHANGED=Ke;t.EVENT_PERSPECTIVE_REFRESHED=Ze;t.EVENT_PERSPECTIVE_UNLOADING=Ye;t.EVENT_PERSPECTIVE_UPDATED=Qe;t.EVENT_SMARTEDIT_COMPONENT_UPDATED=tt;t.EVENT_STRICT_PREVIEW_MODE_REQUESTED=Je;t.EXPERIENCE_STORAGE_KEY=Jt;t.EXTENDED_VIEW_PORT_MARGIN=ve;t.EXTENDED_VIEW_PORT_MARGIN_TOKEN=fi;t.EditableListNodeItem=EditableListNodeItem;t.FILE_VALIDATION_CONFIG=yo;t.FrequentlyChangingContentName=Oi;t.GENERIC_EDITOR_LOADED_EVENT=St;t.GENERIC_EDITOR_LOADED_EVENT_CONSTANT=Io;t.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT=Ct;t.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT_CONSTANT=bo;t.GENERIC_EDITOR_WIDGET_DATA=Zo;t.GatewayProxied=qi;t.GatewayProxiedAnnotationFactory=GatewayProxiedAnnotationFactory;t.GenericEditorDropdownServiceFactory=GenericEditorDropdownServiceFactory;t.HEART_BEAT_TIMEOUT_THRESHOLD_MS=Wt;t.HEART_BEAT_TIMEOUT_THRESHOLD_MS_TOKEN=yi;t.HIDE_SLOT_MENU=we;t.HIDE_TOOLBAR_ITEM_CONTEXT=Mt;t.HasOperationPermissionBaseDirective=HasOperationPermissionBaseDirective;t.I18N_LANGUAGES_RESOURCE_URI=yt;t.I18N_RESOURCE_URI=Re;t.IAnimateService=IAnimateService;t.IAnnouncementService=IAnnouncementService;t.ICatalogDetailsService=ICatalogDetailsService;t.ICatalogService=ICatalogService;t.ICatalogVersionPermissionService=ICatalogVersionPermissionService;t.IConfirmationModalService=IConfirmationModalService;t.IContextualMenuService=IContextualMenuService;t.ID_ATTRIBUTE=me;t.IDecoratorService=IDecoratorService;t.IDragAndDropCrossOrigin=IDragAndDropCrossOrigin;t.IDragEventType=oo;t.IDropdownPopulatorInterface=un;t.IEditorModalService=IEditorModalService;t.IExperienceService=IExperienceService;t.IFeatureService=IFeatureService;t.IFileValidation=IFileValidation;t.IGenericEditorDropdownServiceConstructor=IGenericEditorDropdownServiceConstructor;t.IIframeClickDetectionService=IIframeClickDetectionService;t.ILegacyDecoratorToCustomElementConverter=ILegacyDecoratorToCustomElementConverter;t.INotificationMouseLeaveDetectionService=INotificationMouseLeaveDetectionService;t.INotificationService=INotificationService;t.IPageInfoService=IPageInfoService;t.IPageService=IPageService;t.IPageTreeNodeService=IPageTreeNodeService;t.IPageTreeService=IPageTreeService;t.IPermissionService=IPermissionService;t.IPerspectiveService=IPerspectiveService;t.IPositionRegistry=IPositionRegistry;t.IPreviewService=IPreviewService;t.IRenderService=IRenderService;t.IResizeListener=IResizeListener;t.IRestServiceFactory=IRestServiceFactory;t.ISlotRestrictionsService=ISlotRestrictionsService;t.ISmartEditContractChangeListener=ISmartEditContractChangeListener;t.IStorageGateway=IStorageGateway;t.IStorageManager=IStorageManager;t.IStorageManagerFactory=IStorageManagerFactory;t.IStorageManagerGateway=IStorageManagerGateway;t.IStoragePropertiesService=IStoragePropertiesService;t.ISyncPollingService=ISyncPollingService;t.ITEM_COMPONENT_DATA_TOKEN=Bo;t.ITemplateCacheService=ITemplateCacheService;t.IToolbarService=IToolbarService;t.IToolbarServiceFactory=IToolbarServiceFactory;t.IUrlService=IUrlService;t.IWaitDialogService=IWaitDialogService;t.LANGUAGE_RESOURCE_URI=ft;t.LINKED_DROPDOWN=Et;t.LINKED_DROPDOWN_TOKEN=dn;t.MEDIAS_PATH=Qt;t.MEDIA_FILE_SELECTOR_CUSTOM_INJECTOR_TOKEN=Zn;t.MEDIA_FILE_SELECTOR_CUSTOM_TOKEN=Yn;t.MEDIA_FOLDER_PATH=ei;t.MEDIA_PATH=Xt;t.MEDIA_RESOURCE_URI=Zt;t.MEDIA_SELECTOR_I18N_KEY=Xn;t.MEDIA_SELECTOR_I18N_KEY_TOKEN=Qn;t.MUTATION_TYPES=Oe;t.MessageGateway=MessageGateway;t.NG_ROUTE_PREFIX=ue;t.NG_ROUTE_WILDCARD=he;t.NONE_PERSPECTIVE=zt;t.NamespacedStorageManager=NamespacedStorageManager;t.NavigationNodeItem=NavigationNodeItem;t.NodeUtils=NodeUtils;t.OPEN_PAGE_WORKFLOW_MENU=ti;t.OPERATION_CONTEXT=De;t.OVERLAY_COMPONENT_CLASS=ht;t.OVERLAY_DISABLED_EVENT=Ee;t.OVERLAY_ID=it;t.OVERLAY_RERENDERED_EVENT=pt;t.ObjectUtils=ObjectUtils;t.PAGES_CONTENT_SLOT_RESOURCE_URI=ni;t.PAGE_CONTEXT_CATALOG=Se;t.PAGE_CONTEXT_CATALOG_VERSION=Ce;t.PAGE_CONTEXT_SITE_ID=be;t.PERSPECTIVE_SELECTOR_WIDGET_KEY=et;t.POPUP_OVERLAY_DATA=Lo;t.PREVIEW_RESOURCE_URI=Le;t.PREVIOUS_USERNAME_HASH=We;t.PRODUCT_LIST_RESOURCE_API=kt;t.PRODUCT_RESOURCE_API=Rt;t.PageInfoService=PageInfoService;t.REFRESH_CONTEXTUAL_MENU_ITEMS_EVENT=He;t.RESOLVED_LOCALE_TO_CKEDITOR_LOCALE_MAP=wn;t.RICH_TEXT_CONFIGURATION=En;t.RarelyChangingContentName=Di;t.SCROLL_AREA_CLASS=$t;t.SEND_MOUSE_POSITION_THROTTLE=Vt;t.SETTINGS_URI=Be;t.SHOW_SLOT_MENU=Ie;t.SHOW_TOOLBAR_ITEM_CONTEXT=Nt;t.SITES_RESOURCE_URI=Pt;t.SMARTEDITCONTAINER_COMPONENT_NAME=ce;t.SMARTEDITLOADER_COMPONENT_NAME=le;t.SMARTEDIT_ATTRIBUTE_PREFIX=mt;t.SMARTEDIT_COMPONENT_NAME=de;t.SMARTEDIT_COMPONENT_PROCESS_STATUS=gt;t.SMARTEDIT_DRAG_AND_DROP_EVENTS=Ft;t.SMARTEDIT_ELEMENT_HOVERED=jt;t.SMARTEDIT_IFRAME_DRAG_AREA=Bt;t.SMARTEDIT_IFRAME_WRAPPER_ID=Ht;t.SMARTEDIT_INNER_FILES=Kt;t.SMARTEDIT_INNER_FILES_POST=Yt;t.SMARTEDIT_LOGIN_DIALOG_RESOURCES=qe;t.SMARTEDIT_RESOURCE_URI_REGEXP=Ue;t.SMARTEDIT_ROOT=je;t.SSO_AUTHENTICATION_ENTRY_POINT=Ne;t.SSO_LOGOUT_ENTRY_POINT=ze;t.SSO_OAUTH2_AUTHENTICATION_ENTRY_POINT=Fe;t.STORAGE_PROPERTIES_TOKEN=no;t.STORE_FRONT_CONTEXT=Dt;t.ScriptUtils=ScriptUtils;t.SeComponent=SeComponent;t.SeCustomComponent=SeCustomComponent;t.SeDecorator=SeDecorator;t.SeDirective=SeDirective;t.SeDowngradeComponent=SeDowngradeComponent;t.SeDowngradeService=SeDowngradeService;t.SeEntryModule=SeEntryModule;t.SeFilter=SeFilter;t.SeInjectable=SeInjectable;t.SeModule=SeModule;t.SeRouteService=SeRouteService;t.SmarteditErrorHandler=SmarteditErrorHandler;t.StorageManagerFactory=StorageManagerFactory;t.StorageNamespaceConverter=StorageNamespaceConverter;t.StringUtils=StringUtils;t.TAB_DATA=Eo;t.THROTTLE_SCROLLING_DELAY=Ut;t.TOOLBAR_ITEM=Pi;t.TREE_NODE=Mo;t.TYPES_RESOURCE_URI=xt;t.TYPE_ATTRIBUTE=ge;t.Timer=Timer;t.TreeDragAndDropEvent=TreeDragAndDropEvent;t.TreeNestedDataSource=TreeNestedDataSource;t.TreeNodeItem=TreeNodeItem;t.TruncatedText=TruncatedText;t.USER_TRACKING_FUNCTIONALITY=mi;t.USER_TRACKING_KEY_MAP=gi;t.UUID_ATTRIBUTE=ut;t.VALIDATION_MESSAGE_TYPES=bt;t.WHO_AM_I_RESOURCE_URI=ke;t.WIZARD_API=Ii;t.WIZARD_MANAGER=bi;t.WizardService=WizardService;t.YJQUERY_TOKEN=Qi;t.apiUtils=hi;t.authorizationEvictionTag=ki;t.catalogEvictionTag=Fi;t.catalogSyncedEvictionTag=Ni;t.cmsitemsEvictionTag=po;t.cmsitemsUri=co;t.contentCatalogUpdateEvictionTag=Bi;t.dateUtils=vi;t.diBridgeUtils=Y;t.diNameUtils=$;t.frequentlyChangingContent=xi;t.genericEditorDropdownComponentOnInit=genericEditorDropdownComponentOnInit;t.getLocalizedFilterFn=getLocalizedFilterFn;t.instrument=instrument;t.isBlankValidator=isBlankValidator;t.moduleUtils=se;t.nodeUtils=J;t.objectToArray=objectToArray;t.objectUtils=ui;t.operationContextCMSPredicate=operationContextCMSPredicate;t.operationContextInteractivePredicate=operationContextInteractivePredicate;t.operationContextNonInteractivePredicate=operationContextNonInteractivePredicate;t.operationContextToolingPredicate=operationContextToolingPredicate;t.pageChangeEvictionTag=ji;t.pageCreationEvictionTag=zi;t.pageDeletionEvictionTag=Li;t.pageEvictionTag=$i;t.pageRestoredEvictionTag=Ui;t.pageUpdateEvictionTag=Vi;t.parseComponentSelector=parseComponentSelector;t.parseDirectiveBindings=parseDirectiveBindings;t.parseDirectiveName=parseDirectiveName;t.parseValidationMessage=parseValidationMessage;t.perspectiveChangedEvictionTag=Gi;t.rarelyChangingContent=Ri;t.registerCustomComponents=registerCustomComponents;t.scriptUtils=_i;t.seCustomComponents=te;t.servicesToBeDowngraded=X;t.stringUtils=ae;t.userEvictionTag=Mi;t.windowUtils=ne;t.yjQueryServiceFactory=yjQueryServiceFactory}).call(this,o(219))},870:function(e,t){},871:function(e,t){},876:function(e,t){},947:function(e,t,o){},948:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(133);var s=o(0);var a=o(40);var r=o(139);var d=o(93);var p=o(228);var m=o(86);var g=o(182);var u=o(4);var v=o(105);var f=o(42);var S=o(46);var C=o(136);var b=o(20);var I=o(120);(function(){var e=e||window.angular;var t=null;try{t=e.module("personalizationsmarteditContainerTemplates")}catch(e){}t=t||e.module("personalizationsmarteditContainerTemplates",[]);t.run(["$templateCache",function(e){e.put("CombinedViewMenuComponent.html",'<div class="btn-block pe-toolbar-action--include"><div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized se-toolbar-menu-content--pe-combine" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2" translate="personalization.toolbar.combinedview.header.title"></h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.combinedview.header.description"></span></se-help></div><div role="menuitem"><div *ngIf="!isCombinedViewConfigured"><div class="pe-combined-view-panel__wrapper pe-combined-view-panel__wrapper--empty"><img src="static-resources/images/emptyVersions.svg" alt="no Configurationss" class="pe-combined-view-panel--empty-img"> <span class="pe-combined-view-panel--empty-text" translate="personalization.toolbar.combinedview.openconfigure.empty"></span> <a class="fd-link pe-combined-view-panel--empty-link" (click)="combinedViewClick()" translate="personalization.toolbar.combinedview.openconfigure.link" [title]="\'personalization.toolbar.combinedview.openconfigure.link\' | translate"></a></div></div><div *ngIf="isCombinedViewConfigured"><div class="pe-combined-view-panel__wrapper"><div class="pe-combined-view-panel__configure-layout"><button class="pe-combined-view-panel__configure-btn fd-button perso-wrap-ellipsis" (click)="combinedViewClick()" translate="personalization.toolbar.combinedview.openconfigure.button" [title]="\'personalization.toolbar.combinedview.openconfigure.button\' | translate"></button> <button class="pe-combined-view-panel__configure-btn fd-button--light perso-wrap-ellipsis" (click)="clearAllCombinedViewClick()" translate="personalization.toolbar.combinedview.clearall.button" [title]="\'personalization.toolbar.combinedview.clearall.button\' | translate"></button></div><div [ngClass]="combinedView.enabled ? null : \'pe-combined-view-panel--disabled\'"><div class="pe-combined-view-panel__list-layout" *ngFor="let item of selectedItems; index as i" (click)="itemClick(item)" [ngClass]="{\'pe-combined-view-panel-list__item--highlighted\': item.highlighted}"><div class="pe-combined-view-panel-list__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combined-view-panel-list__names-layout"><div class="perso-wrap-ellipsis" [textContent]="item.customization.name" [title]="item.customization.name"></div><div class="perso-wrap-ellipsis perso-tree__primary-data" [textContent]="item.variation.name" [title]="item.variation.name"></div></div><div class="pe-combined-view-panel-list__icon"><se-tooltip *ngIf="!isItemFromCurrentCatalog(item.variation) && combinedView.enabled" [placement]="\'top-end\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [isChevronVisible]="true" [appendTo]="\'body\'"><span class="perso__globe-icon sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body [translate]="item.variation.catalogVersionNameL10N"></div></se-tooltip></div></div></div></div></div></div></div></div>');e.put("SharedFilterDropdownComponent.html",'<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>');e.put("PersonalizationsmarteditContextMenuAddEditActionComponent.html",'<div class="perso-customize-component"><div class="perso-customize-component__title-layout"><div *ngIf="letterIndicatorForElement" class="perso-customize-component__title-layout__letter-block"><span [ngClass]="colorIndicatorForElement">{{letterIndicatorForElement}}</span></div><div class="perso-customize-component__title-layout__cust-name perso-wrap-ellipsis" title="{{selectedCustomization.name}}">{{selectedCustomization.name}}</div><div class="perso-customize-component__title-layout__target-group-name perso-wrap-ellipsis" title="{{selectedVariation.name}}">{{\'> \'+ selectedVariation.name}}</div></div><dl class="perso-customize-component__data-list"><label class="fd-form__label" [translate]="\'personalization.modal.addeditaction.selected.mastercomponent.title\'"></label><dd>{{componentType}}</dd></dl><label class="fd-form__label se-control-label required" [translate]="\'personalization.modal.addeditaction.selected.actions.title\'"></label><fd-inline-help [inlineHelpIconStyle]="{\'margin-left\': \'10px\', \'padding-top\': \'1px\'}" [inlineHelpContentStyle]="{\'box-shadow\': \'0 0 4px 0 #d9d9d9\', \'border\': \'1px solid #d9d9d9\', \'border-radius\': \'4px\', \'color\': \'#32363a\', \'font-size\': \'14px\', \'max-width\': \'200px\', \'white-space\': \'normal\'}" [placement]="\'top-start\'"><span [translate]="\'personalization.modal.addeditaction.selected.actions.help.label\'"></span></fd-inline-help><se-select class="perso-customize-component__select2-container" [placeholder]="\'personalization.modal.addeditaction.dropdown.placeholder\'" [(model)]="actionSelected" [searchEnabled]="false" [showRemoveButton]="false" [fetchStrategy]="actionFetchStrategy"></se-select><div class="perso-customize-component__select-group-label-layout"><div *ngIf="actionSelected == \'use\'"><label class="fd-form__label se-control-label required" [translate]="\'personalization.modal.addeditaction.selected.component.title\'"></label></div><has-multicatalog *ngIf="actionSelected == \'use\'"><div class="perso-customize-component__filter-layout"><label class="fd-form__label perso-customize-component__filter-label" [translate]="\'personalization.commons.filter.label\'"></label><catalog-version-filter-dropdown class="pe-customize-component__catalog-version-filter-dropdown" (onSelectCallback)="catalogVersionFilterChange($event)"></catalog-version-filter-dropdown></div></has-multicatalog></div><se-select class="perso-customize-component__select2-container" *ngIf="actionSelected == \'use\'" [placeholder]="\'personalization.modal.addeditaction.dropdown.componentlist.placeholder\'" [(model)]="idComponentSelected" [onSelect]="componentSelectedEvent" [searchEnabled]="true" [showRemoveButton]="false" [fetchStrategy]="componentsFetchStrategy" [itemComponent]="itemComponent"></se-select><se-select class="perso-customize-component__select2-container" *ngIf="actionSelected == \'create\'" [placeholder]="\'personalization.modal.addeditaction.dropdown.componenttype.placeholder\'" [(model)]="newComponentSelected" [onSelect]="newComponentTypeSelectedEvent" [searchEnabled]="false" [fetchStrategy]="componentTypesFetchStrategy"></se-select></div>');e.put("CustomizeViewComponent.html",'<div class="btn-block pe-toolbar-action--include"><div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized-customizations-panel" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><div class="se-toolbar-menu-content--pe-customized__headers--wrapper"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2"><span translate="personalization.toolbar.pagecustomizations.header.title"></span> ({{pagination.totalCount}})</h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.pagecustomizations.header.description"></span></se-help></div><div class="se-input-group se-component-search"><input type="text" id="customization-search-name" class="se-input-group--input se-component-search--input" [(ngModel)]="nameFilter" [placeholder]="\'personalization.toolbar.pagecustomizations.search.placeholder\' | translate" (ngModelChange)="nameInputKeypress()"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div></div><div role="menuitem"><div id="personalizationsmartedit-right-toolbar-item-template"><div class="pe-customize-panel__filter-label-layout"><div class="pe-customize-panel__filter-layout"><page-filter-dropdown (onSelectCallback)="pageFilterChange($event)" [initialValue]="pageFilter" class="perso-filter__wrapper perso-filter__wrapper--page"></page-filter-dropdown><has-multicatalog class="perso-filter__wrapper perso-filter__wrapper--catalog"><catalog-filter-dropdown (onSelectCallback)="catalogFilterChange($event)" [initialValue]="catalogFilter"></catalog-filter-dropdown></has-multicatalog><status-filter-dropdown (onSelectCallback)="statusFilterChange($event)" [initialValue]="statusFilter" class="perso-filter__wrapper perso-filter__wrapper--status"></status-filter-dropdown></div></div><personalization-infinite-scrolling [dropDownContainerClass]="\'pe-customize-panel__wrapper\'" [fetchPage]="getPage"><customizations-list [customizationsList]="customizationsList" [requestProcessing]="moreCustomizationsRequestProcessing"></customizations-list></personalization-infinite-scrolling></div></div></div></div>');e.put("ManageCustomizationViewMenuComponent.html",'<div class="btn-block pe-toolbar-action--include"><div class="se-toolbar-menu-content se-toolbar-menu-content--pe-customized" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2" translate="personalization.toolbar.library.header.title"></h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.library.header.description"></span></se-help></div><div class="se-toolbar-menu-content--pe-customized__item"><a class="se-toolbar-menu-content--pe-customized__item__link" id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor" translate="personalization.toolbar.library.manager.name" (click)="managerViewClick()"></a></div><div class="se-toolbar-menu-content--pe-customized__item se-toolbar-menu-content--pe-customized__item--last"><a class="se-toolbar-menu-content--pe-customized__item__link" id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor" translate="personalization.toolbar.library.customizationvariationmanagement.name" (click)="createCustomizationClick()"></a></div></div></div>');e.put("SharedToolbarContextComponent.html",'<div *ngIf="visible" class="pe-toolbar-item-context"><span class="sap-icon--slim-arrow-right pe-toolbar-item-context__icon"></span><div class="pe-toolbar-item-context__btn"><div class="pe-toolbar-item-context__btn-txt"><div title="{{title}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{title}}</div><div title="{{subtitle}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{subtitle}}</div></div></div><div class="pe-toolbar-item-context__btn-hyicon" (click)="clear()"><span class="sap-icon--decline"></span></div></div>');e.put("CombinedViewConfigureComponent.html",'<div class="pe-combinedview-config__form"><div class="form-group"><label for="PageFilterDropdownField001" class="fd-form__label" translate="personalization.commons.filter.label"></label><div class="pe-combinedview-config__filter-layout"><page-filter-dropdown id="PageFilterDropdownField001" (onSelectCallback)="pageFilterChange($event)" class="fd-has-margin-right-small"></page-filter-dropdown><has-multicatalog><catalog-filter-dropdown (onSelectCallback)="catalogFilterChange($event)"></catalog-filter-dropdown></has-multicatalog></div><div class="pe-combinedview-config__select-group-layout"><div class="pe-combinedview-config__select-group-label-layout"><label for="CombinedViewSearchField1" class="fd-form__label se-control-label required pe-combinedview-config__label" translate="personalization.modal.combinedview.search.label"></label></div><se-select id="CombinedViewSearchField1" class="fd-form__control" [(model)]="selectedCombinedViewItemId" [placeholder]="\'personalization.modal.combinedview.search.placeholder\'" [fetchStrategy]="combinedViewItemsFetchStrategy" [onSelect]="selectElement" [itemComponent]="combinedViewItemPrinter" [disableChoiceFn]="isItemInSelectDisabled" [(reset)]="resetSelectedItems" [resetSearchInput]="false"></se-select></div></div><div class="form-group"><p *ngIf="selectedCombinedViewItems.length === 0" translate="personalization.toolbar.combinedview.openconfigure.empty"></p><div id="CombinedViewSelectedField1" class="pe-combinedview-config__list-layout" *ngFor="let item of selectedCombinedViewItems; index as i; first as isFirst" [ngClass]="isFirst ? \'pe-combinedview-config__divider\' : \'\'"><div class="pe-combinedview-config__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combinedview-config__names-layout"><div class="perso-wrap-ellipsis pe-combinedview-config__cname" [textContent]="item.customization.name" [title]="item.customization.name"></div><span>></span><div class="perso-wrap-ellipsis pe-combinedview-config__vname" [textContent]="item.variation.name" [title]="item.variation.name"></div></div><div class="pe-combinedview-config__hyicon-globe"><se-tooltip *ngIf="!isItemFromCurrentCatalog(item.variation)" [placement]="\'top-end\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [isChevronVisible]="true" [appendTo]="\'body\'"><span class="perso__globe-icon sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body [translate]="item.variation.catalogVersionNameL10N"></div></se-tooltip></div><div class="pe-combinedview-config__hyicon-remove"><span class="sap-icon--decline" (click)="removeSelectedItem(item)" [title]="\'personalization.modal.combinedview.icon.remove.title\' | translate"></span></div></div></div></div>');e.put("CustomizationsListComponent.html",'<div class="pe-customize-panel-list"><div class="pe-customize-panel-list__header"><span class="pe-customize-panel-list__header--name" translate="personalization.toolbar.pagecustomizations.list.title"></span> <span class="pe-customize-panel-list__header--status" translate="personalization.toolbar.pagecustomizations.list.status"></span></div><div *ngFor="let customization of customizationsList; last as isLast; trackBy: customizationsListTrackBy" [ngClass]="isLast && customization.collapsed && isCustomizationFromCurrentCatalog(customization, isLast) ? \'pe-customize-panel-list__item-last\':\'\'"><div class="pe-customize-panel-list__row-layout" [ngClass]="getSelectedCustomizationClass(customization)"><div class="pe-customize-panel-list__icon-layout pe-customize-panel-list__icon-divider" (click)="customizationRowClick(customization)"><a class="pe-customize-panel-list__btn-link btn btn-link" title="{{(customization.collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\') | translate}}"><span [ngClass]="customization.collapsed ? \'sap-icon--navigation-right-arrow\' : \'sap-icon--navigation-down-arrow\'"></span></a></div><div class="pe-customize-panel-list__row" (click)="customizationRowClick(customization,true)"><div class="pe-customize-panel-list__col-lg"><div class="perso-wrap-ellipsis pe-customize-panel-list__parent-layout perso-tree__primary-data" [textContent]="customization.name" title="{{customization.name}}"></div></div><div class="pe-customize-panel-list__col-md"></div><div class="pe-customize-panel-list__col-md"><div class="perso-tree__status" [ngClass]="getActivityStateForCustomization(customization)" [textContent]="getEnablementTextForCustomization(customization)"></div><div class="perso-tree__dates-layout" *ngIf="isEnabled(customization)" [textContent]="getDatesForCustomization(customization)"></div></div><div class="pe-customize-panel-list__col-sm"><span *ngIf="!isCustomizationFromCurrentCatalog(customization)" class="perso__globe-icon sap-icon--globe"></span></div></div><div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"><div *ngIf="isCustomizationFromCurrentCatalog(customization)" class="y-dropdown-more-menu dropdown open"><button type="button" class="pe-customize-panel-list__btn-link fd-button--light customization-rank-{{customization.rank}}-dropdown-toggle" (click)="customizationSubMenuAction(customization)"><span class="perso__more-icon sap-icon--overflow"></span></button><ul *ngIf="customization.subMenu" class="se-y-dropdown-menu__list fd-menu__list dropdown-menu" role="menu"><li><a class="se-dropdown-item fd-menu__item cutomization-rank-{{customization.rank}}-edit-button" (click)="clearAllSubMenu();editCustomizationAction(customization)" translate="personalization.toolbar.pagecustomizations.customization.options.edit"></a></li></ul></div></div></div><div *ngIf="!customization.collapsed"><div class="pe-customize-panel-list__row-layout" *ngFor="let variation of customization.variations" [ngClass]="getSelectedVariationClass(variation)" (click)="clearAllSubMenu();variationClick(customization, variation)"><div class="pe-customize-panel-list__icon-layout"><div class="pe-customize-panel-list__btn-link btn btn-link"></div></div><div class="pe-customize-panel-list__row"><div class="pe-customize-panel-list__col-lg"><div class="perso-wrap-ellipsis pe-customize-panel-list__child-layout" [textContent]="variation.name" title="{{variation.name}}"></div></div><div class="pe-customize-panel-list__col-md"><div class="pe-customize-panel-list__components-layout"><div [hidden]="variation.numberOfAffectedComponents &lt; 0" class="pe-customize-panel-list__number-layout">{{variation.numberOfAffectedComponents}}</div><div [hidden]="variation.numberOfAffectedComponents >= 0" class="pe-customize-panel-list__number-layout">#</div><div class="perso-wrap-ellipsis" translate="personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label" title="{{\'personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label\' | translate}}"></div></div></div><div class="pe-customize-panel-list__col-md perso-tree__status" [ngClass]="getActivityStateForVariation(customization, variation)" [textContent]="getEnablementTextForVariation(variation)"></div><div class="pe-customize-panel-list__col-sm"><span class="perso__cc-icon sap-icon--tag" [ngClass]="{\'perso__cc-icon--hidden\': !hasCommerceActions(variation)}" [title]="getCommerceCustomizationTooltip(variation)"></span></div></div><div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"></div></div></div></div></div><div class="pe-spinner--outer" [hidden]="!requestProcessing"><div class="spinner-md spinner-light"></div></div>');e.put("CommerceCustomizationViewComponent.html",'<div id="commerceCustomizationBody-002" class="perso-cc-modal"><div class="perso-cc-modal__title-layout"><div class="perso-wrap-ellipsis perso-cc-modal__title-cname" [textContent]="customization.name" title="{{customization.name}}"></div><div class="perso-cc-modal__title-status" [ngClass]="customizationStatus" [textContent]="\' (\' + customizationStatusText + \') \'"></div><span>></span><div class="perso-wrap-ellipsis perso-cc-modal__title-vname" [textContent]="variation.name" title="{{variation.name}}"></div><div class="perso-cc-modal__title-status" [ngClass]="variationStatus" [textContent]="\' (\' + variationStatusText + \')\'"></div></div><div class="form-group perso-cc-modal__content-layout"><label for="commerce-customization-type-1" class="fd-form__label" translate="personalization.modal.commercecustomization.action.type"></label><se-select [id]="commerce-customization-type-1" class="fd-form__control" [fetchStrategy]="customizationTypeFetchStrategy" [searchEnabled]="false" [(model)]="select.typeId" [onChange]="onActionTypeChange"></se-select></div><ng-container><ng-container *ngComponentOutlet="promotionComponent.component; injector: promotionComponent.injector"></ng-container></ng-container><ng-container><ng-container *ngComponentOutlet="searchProfileComponent.component; injector: searchProfileComponent.injector"></ng-container></ng-container><div class="select2-choices"><div class="ui-select-match-item select2-search-choice" *ngFor="let action of getActionsToDisplay()"><span [textContent]="displayAction(action)"></span> <span class="ui-select-match-close select2-search-choice-close sap-icon--decline" (click)="removeSelectedAction(action)"></span></div></div></div>');e.put("ManageCustomizationViewComponent.html",'<div class="pe-customization-modal__tabs"><se-tabs *ngIf="isReady" [tabsList]="tabs" [numTabsDisplayed]="2" (onTabSelected)="onTabSelected($event)"></se-tabs></div>');e.put("ManagerViewComponent.html",'<div id="editConfigurationsBody-001" class="perso-library"><personalization-infinite-scrolling [fetchPage]="getPage"><div #managerScrollZone id="managerScrollZone" class="perso-library__scroll-zone perso__scrollbar--hidden"><div class="perso-library__header"><div class="perso-library__title"><span [textContent]="catalogName"></span> | {{\'personalization.toolbar.pagecustomizations.header.title\' | translate}} ({{pagination.totalCount}})</div><div class="se-input-group"><div class="perso-input-group"><input id="customizationSearchInput" name="customizationSearchInput" type="text" class="se-input-group--input se-component-search--input" [placeholder]="\'personalization.modal.manager.search.placeholder\' | translate" [(ngModel)]="customizationSearch.name" (ngModelChange)="searchInputKeypress()"><span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div></div><status-filter-dropdown (onSelectCallback)="statusFilterChange($event)" [initialValue]="customizationSearch.status" class="perso-library__header-space"></status-filter-dropdown><div class="perso-library__header-space"><button class="fd-button" type="button" (click)="openNewModal()"><span translate="personalization.modal.manager.add.button"></span></button></div></div><div class="y-tree perso-library__y-tree"><div class="y-tree-header"><manager-view-grid-header></manager-view-grid-header></div><manager-view-tree [customizations]="customizations"></manager-view-tree><div class="pe-spinner--outer" [hidden]="!moreCustomizationsRequestProcessing"><div class="spinner-md spinner-light"></div></div></div></div></personalization-infinite-scrolling><personalizationsmartedit-scroll-zone *ngIf="scrollZoneElement != null && elementToScroll" [isTransparent]="true" [scrollZoneVisible]="scrollZoneVisible" [elementToScroll]="elementToScroll"></personalizationsmartedit-scroll-zone><a class="perso-library__back-to-top" translate="personalization.commons.button.title.backtotop" [hidden]="!isReturnToTopButtonVisible()" (click)="scrollZoneReturnToTop()"><span class="sap-icon--back-to-top"></span></a></div>');e.put("ManagerViewTreeComponent.html",'<div cdkDropList [cdkDropListData]="customizations" [id]="treeRoot" [cdkDropListConnectedTo]="dragDroppedTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true"><div *ngFor="let customization of customizations" cdkDrag [cdkDragData]="customization.code" (cdkDragMoved)="dragMoved($event)"><div class="node-item" [attr.data-id]="customization.code" [attr.type]="\'CUSTOMIZATION\'" [attr.id]=" \'node-\' + customization.code"><div class="y-tree-row" [ngClass]="allCustomizationsCollapsed()? \'active-level\' : \'inactive-level\'"><div class="cdk-drag-row-layout desktop-layout hidden-sm hidden-xs customization-rank-{{customization.rank}}-row"><div (click)="customizationCollapseAction(customization)" class="expand-arrow"><a title="{{(customization.collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\') | translate}}"><span [ngClass]="customization.collapsed ? \'sap-icon--navigation-right-arrow\' : \'sap-icon--navigation-down-arrow\'" class="perso__toggle-icon"></span></a></div><div class="y-tree-row__angular-ui-tree-handle"><div class="y-tree__col--lg"><div class="perso-wrap-ellipsis perso-tree__primary-data" title="{{customization.name}}" [textContent]="customization.name"></div></div><div class="y-tree__col--xs" [textContent]="getStatusNotDeleted(customization) || 0"></div><div class="y-tree__col--xs"></div><div class="y-tree__col--md perso-tree__status" [ngClass]="getActivityStateForCustomization(customization)"><span [textContent]="getEnablementTextForCustomization(customization)"></span></div><div class="y-tree__col--sm"><div [hidden]="isNotEnabled(customization)" class="perso-tree__dates-layout"><span [textContent]="getFormattedDate(customization.enabledStartDate)" class="perso-library__status-layout"></span></div></div><div class="y-tree__col--sm"><div [hidden]="isNotEnabled(customization)" class="perso-tree__dates-layout"><span [textContent]="getFormattedDate(customization.enabledEndDate)"></span></div></div></div><fd-popover [isOpen]="customization.subMenu" [closeOnOutsideClick]="true" [triggers]="[]"><fd-popover-control><button type="button" class="fd-button--light" (click)="updateSubMenuAction(customization)"><span class="perso__more-icon sap-icon--overflow"></span></button></fd-popover-control><fd-popover-body><div *ngIf="customization.subMenu" class="toolbar-action--include pe-manager-view-tree-more-list__dropdown"><div class="pe-manager-view-tree-more-list__item" (click)="clearAllCustomizationSubMenuAndEditCustomizationAction(customization)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.customization.options.edit"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="deleteCustomizationAction(customization)"><span class="pe-manager-view-tree-more-list__item-deletion" translate="personalization.modal.manager.customization.options.delete"></span></div></div></fd-popover-body></fd-popover></div></div></div><div *ngIf="!customization.collapsed" cdkDropList [cdkDropListData]="customization.variations" [id]="customization.code" [cdkDropListConnectedTo]="dropTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true"><div *ngFor="let variation of customization.variations" cdkDrag [cdkDragData]="variation.code" (cdkDragMoved)="dragMoved($event)" class="y-tree-row child-row active-level"><div class="node-item" [attr.data-id]="variation.code" [attr.type]="\'VARIATION\'" [attr.id]=" \'node-\' + variation.code"><div *ngIf="statusNotDeleted(variation)" class="cdk-drag-row-layout desktop-layout variation-rank-{{variation.rank}}-row hidden-sm hidden-xs"><div class="y-tree-row__angular-ui-tree-handle"><div class="y-tree__col--xl perso-wrap-ellipsis" title="{{variation.name}}"><div><se-tooltip *ngIf="hasCommerceActions(variation)" [triggers]="[\'mouseenter\',\'mouseleave\']" [placement]="\'auto\'"><span class="perso__cc-icon sap-icon--tag perso__cc-icon-padding" [ngClass]="{\'perso__cc-icon--hidden\': !hasCommerceActions(variation)}" se-tooltip-trigger></span> <span se-tooltip-body [textContent]="getCommerceCustomizationTooltip(variation)"></span></se-tooltip></div><span [textContent]="variation.name"></span></div><div class="y-tree__col--xs" [textContent]="variation.numberOfComponents"></div><div class="y-tree__col--md perso-tree__status" [ngClass]="getActivityStateForVariation(customization,variation)"><span [textContent]="getEnablementTextForVariation(variation)" class="perso-library__status-layout"></span></div><div class="y-tree__col--lg"></div></div><fd-popover [isOpen]="variation.subMenu" [closeOnOutsideClick]="true" [triggers]="[]"><fd-popover-control><button type="button" class="fd-button--light" (click)="updateSubMenuAction(variation)"><span class="perso__more-icon sap-icon--overflow"></span></button></fd-popover-control><fd-popover-body><div *ngIf="variation.subMenu" class="toolbar-action--include pe-manager-view-tree-more-list__dropdown"><div class="pe-manager-view-tree-more-list__item" (click)="clearAllVariationSubMenuAndEditVariationAction(customization, variation)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.variation.options.edit"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="toogleVariationActive(customization,variation)"><span class="pe-manager-view-tree-more-list__item-active" [textContent]="getEnablementActionTextForVariation(variation)"></span></div><div [hidden]="!variation.isCommerceCustomizationEnabled" class="pe-manager-view-tree-more-list__item" (click)="clearAllVariationSubMenuAndmanageCommerceCustomization(customization, variation)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.variation.options.commercecustomization"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="deleteVariationAction(customization, variation, $event)"><span [ngClass]="isDeleteVariationEnabled(customization) ? \'pe-manager-view-tree-more-list__item-deletion\' : \'pe-manager-view-tree-more-list__item-inactive\' " translate="personalization.modal.manager.variation.options.delete"></span></div></div></fd-popover-body></fd-popover></div></div></div></div></div></div>');e.put("CombinedViewItemPrinterComponent.html",'<div [ngClass]="isItemSelected(combinedViewSelectItem) ? \'pe-combinedview-config__ui-select-item--selected\': \'\'" class="pe-combinedview-config__ui-select-choices-layout"><div class="pe-combinedview-config__ui-select-choices-col1"><div [title]="combinedViewSelectItem.customization.name + \' > \' + combinedViewSelectItem.variation.name" [textContent]="combinedViewSelectItem.customization.name + \' > \' + combinedViewSelectItem.variation.name" class="perso-wrap-ellipsis"></div></div></div>');e.put("BasicInfoTabComponent.html",'<div class="pe-customization-modal" *ngIf="(customization$ | async) as customization"><form><div class="fd-form__item"><label for="customization-name" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.name" class="fd-form__label se-control-label required"></label> <input type="text" class="fd-form__control" [placeholder]="\'personalization.modal.customizationvariationmanagement.basicinformationtab.name.placeholder\' | translate" [name]="customization.name + \'_key\'" [ngModel]="customization.name" (ngModelChange)="changeName($event)" required id="customization-name"/></div><div class="fd-form__item"><label for="customization-description" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details" class="se-control-label fd-form__label"></label> <textarea rows="2" class="fd-form__control pe-customization-modal__textarea" [placeholder]="\'personalization.modal.customizationvariationmanagement.basicinformationtab.details.placeholder\' | translate" [name]="customization.description + \'_key\'" [ngModel]="customization.description" (ngModelChange)="changeDescription($event)" id="customization-description"></textarea></div><div class="fd-form__item fd-has-padding-bottom-tiny"><label for="customization-status" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.status" class="se-control-label fd-form__label"></label><div class="fd-form__item fd-form__item--check"><label class="fd-form__label" for="test-checkbox" id="customization-status"><span class="fd-toggle fd-toggle--s fd-form__control"><input type="checkbox" name="status-config-toggle" id="test-checkbox" [ngModel]="customization.statusBoolean" (ngModelChange)="toggleCustomizationStatus($event)"/> <span class="fd-toggle__switch" role="presentation"></span></span></label></div></div><div class="fd-form__item"><div><button *ngIf="!datetimeConfigurationEnabled" class="se-button--text se-button--link fd-link" (click)="toggleDatetimeConfiguration()" type="button" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.showdateconfigdata"></button> <button *ngIf="datetimeConfigurationEnabled" class="se-button--text se-button--link fd-link" (click)="toggleDatetimeConfiguration(true)" type="button" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.hidedateconfigdata"></button></div><div translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.statusfortimeframe.description" class="fd-has-padding-top-tiny"></div></div><div class="fd-form__item"><div *ngIf="datetimeConfigurationEnabled"><div class="row pe-customization-modal__dates-group"><datetime-picker-range [dateFrom]="customization.enabledStartDate" [dateTo]="customization.enabledEndDate" [isEditable]="true" (dateFromChange)="onEnabledStartDateChange($event)" (dateToChange)="onEnabledEndDateChange($event)"></datetime-picker-range></div></div></div></form></div>');e.put("SegmentExpressionAsHtmlComponent.html",'<span *ngFor="let word of expression"><span *ngIf="operators.includes(word)" class="pe-customization-modal__expression-text">&nbsp;{{ segmentActionI18n[word] | translate }}&nbsp;</span><se-tooltip *ngIf="word === emptyGroup" [triggers]="[\'mouseenter\', \'mouseleave\']"><span se-tooltip-trigger class="pe-customization-modal__expression-alert-icon sap-icon--alert"></span> <span se-tooltip-body translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.tooltip"></span></se-tooltip><span *ngIf="!emptyGroupAndOperators.includes(word)">{{ word }}</span></span>');e.put("SegmentNodeComponent.html",'<div cdkDropList [id]="node.uid" [cdkDropListData]="node" [cdkDropListConnectedTo]="connectedDropListsIds" (cdkDropListDropped)="onDragDrop($event)" [cdkDropListSortingDisabled]="false" [cdkDropListEnterPredicate]="canBeDropped" [ngClass]="{\'perso-segments-tree__layout\': isContainer(node), \'perso-segments-tree__empty-container\': isEmptyContainer(node), \'perso-segments-tree__collapsed-container\': collapsed }"><div><div class="perso-segments-tree" [ngClass]="{\'perso-segments-tree__node\': isItem(node), \'perso-segments-tree__container\': isContainer(node)}"><div *ngIf="isContainer(node)"><div class="perso-segments-tree__toggle" (click)="toggle()" title="{{collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}" [ngClass]="collapsed ? \'sap-icon--navigation-right-arrow\' : \'sap-icon--navigation-down-arrow\'"></div><div class="perso-segments-tree__dropdown"><se-select [model]="node.operation.id" (modelChange)="operationChange($event)" [fetchStrategy]="fetchStrategy" [resetSearchInput]="false" [searchEnabled]="false"></se-select></div></div><div *ngIf="isItem(node)" class="perso-segments-tree__node-content">{{ node.selectedSegment.code }}</div><div *ngIf="isContainer(node)" class="perso-segments-tree__angular-ui-tree-handle--empty"></div><div><span class="perso-segments-tree__pull-right"><a *ngIf="isItem(node)" class="perso-segments-tree__actions perso-segments-tree__node-icon" (click)="duplicateItem(node)" title="{{\'personalization.commons.icon.title.duplicate\' | translate}}"><span class="sap-icon--duplicate"></span> </a><a *ngIf="!isTopContainer()" class="perso-segments-tree__actions" (click)="removeItem(node?.uid)"><div *ngIf="isContainer(node)" class="btn btn-link perso-segments-tree__container-btn-icon fd-has-margin-left-tiny" title="{{\'personalization.commons.icon.title.remove\' | translate}}"><span class="sap-icon--decline"></span></div><div *ngIf="isItem(node)" class="perso-segments-tree__node-icon" title="{{\'personalization.commons.icon.title.remove\' | translate}}"><span class="sap-icon--decline"></span></div></a></span><button *ngIf="isContainer(node)" class="fd-button--light perso-segments-tree__btn" (click)="newSubItem(\'container\')"><span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.button"></span></button></div></div><div *ngIf="isEmptyContainer(node) && !collapsed" class="perso-segments-tree__empty-container-node"><div class="perso-segments-tree__empty-container-node-text" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.dropzone"></div></div><ol *ngIf="!collapsed"><li cdkDrag [id]="innerNode.uid" [cdkDragData]="innerNode" (cdkDragStarted)="onDragStarted($event)" (cdkDragMoved)="onDragMoved($event)" (cdkDragReleased)="onDragReleased()" *ngFor="let innerNode of node.nodes"><segment-node [node]="innerNode" [expression]="expression" [connectedDropListsIds]="connectedDropListsIds" (expressionChange)="handleUpdate($event)" (onDrop)="onDragDrop($event)" (onDragStart)="onDragStarted($event)"></segment-node></li></ol></div></div>');e.put("SegmentViewComponent.html",'<label class="fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupexpression"></label><div><div class="form-group"><segment-expression-as-html [segmentExpression]="expression[0]"></segment-expression-as-html></div><div class="form-group"><label class="fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments"></label><se-select [model]="singleSegment.code" (modelChange)="segmentSelectedEvent($event)" [fetchStrategy]="segmentFetchStrategy" [itemComponent]="segmentPrinterComponent" [(reset)]="resetSelect" [placeholder]="\'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder\'"></se-select></div><segment-node *ngFor="let node of expression" [node]="node" [expression]="expression" [connectedDropListsIds]="connectedDropListsIds" (expressionChange)="handleTreeUpdated($event)" (onDrop)="onDropHandler($event)" (onDragStart)="onDragStart($event)"></segment-node></div>');e.put("TargetGroupTabComponent.html",'<div class="pe-customization-modal" *ngIf="customization"><div class="pe-customization-modal__title"><div class="pe-customization-modal__title-header"><div class="pe-customization-modal__title-header-name perso-wrap-ellipsis" [attr.title]="customization.name">{{ customization.name }}</div><div><span class="pe-customization-modal__title-header-badge badge badge-success" [ngClass]="[getActivityStateForCustomization(customization)]">{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.customization.\' + customization.status | lowercase | translate}}</span></div></div><div class="pe-customization-modal__title-subarea"><div *ngIf="isCustomizationEnabled(customization)" class="pe-customization-modal__title-dates"><span *ngIf="!customization.enabledStartDate && customization.enabledEndDate">...</span> <span [ngClass]="{\'perso__datetimepicker--error-text\': !persoDateUtils.isDateValidOrEmpty(customization.enabledStartDate)}">{{ customization.enabledStartDate }}</span> <span *ngIf="customization.enabledStartDate || customization.enabledEndDate">- </span><span [ngClass]="{\'perso__datetimepicker--error-text\':!persoDateUtils.isDateValidOrEmpty(customization.enabledEndDate)}">{{ customization.enabledEndDate }}</span> <span *ngIf="persoDateUtils.isDateInThePast(customization.enabledEndDate)" class="section-help help-inline help-inline--section help-inline--tooltip"><span class="pe-datetime__warning-icon"></span> <span class="pe-help-block--inline help-block-inline help-block-inline--text" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.datetooltip"></span> </span><span *ngIf="customization.enabledStartDate && !customization.enabledEndDate">...</span></div></div></div><div class="pe-customization-modal__y-add-btn"><button class="fd-button" type="button" (click)="showAddVariationPanel()"><span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.addtargetgroup.button"></span></button></div><perso-target-group-variation-list *ngIf="visibleVariations.length > 0" [customization]="customization" [variations]="visibleVariations"></perso-target-group-variation-list><se-slider-panel [sliderPanelConfiguration]="sliderPanelConfiguration" [(sliderPanelHide)]="sliderPanelHide" [(sliderPanelShow)]="sliderPanelShow" class="pe-customization-modal__sliderpanel"><div *ngIf="isVariationLoaded"><div class="pe-customization-modal__sliderpanel__btn-layout"><perso-modal-full-screen-button></perso-modal-full-screen-button></div><form><div class="fd-form-item"><label for="targetgroup-name" class="fd-form__label required" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname"></label> <input type="text" name="variationname_key" id="targetgroup-name" class="fd-form__control" [placeholder]="\'personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname.placeholder\' | translate" [(ngModel)]="edit.name"/></div><div class="fd-form-item pe-customization-modal--check"><input type="checkbox" name="isDefault" id="targetgroup-isDefault-001" class="fd-form__control fd-checkbox" [(ngModel)]="edit.isDefault" (ngModelChange)="showConfirmForDefaultTrigger($event)"/> <label for="targetgroup-isDefault-001" class="fd-form__control fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></label></div><div *ngIf="edit.showExpression"><segment-view [targetGroupState]="edit" (expressionChange)="onSegmentViewExpressionChange($event)"></segment-view></div></form></div></se-slider-panel></div>');e.put("targetGroupTabWrapperTemplate.html",'<perso-target-group-tab [customization]="$ctrl.customization"></perso-target-group-tab>');e.put("ModalFullScreenButtonComponent.html",'<button class="fd-button--light pe-customization-modal__sliderpanel__btn-link" (click)="toggle()"><fd-icon class="icon_padding_end" *ngIf="!isFullscreen" glyph="full-screen"></fd-icon><fd-icon class="icon_padding_end" *ngIf="isFullscreen" glyph="exitfullscreen"></fd-icon>{{(isFullscreen ? \'personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.close\' : \'personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.open\') | translate}}</button>');e.put("TargetGroupVariationListComponent.html",'<ul class="pe-customization-modal__list-group"><li class="pe-customization-modal__list-group__item" *ngFor="let variation of variationsForView"><div class="pe-customization-modal__list-group__item-col1"><a class="pe-customization-modal__list-group__item-link perso-wrap-ellipsis" (click)="editVariation(variation)">{{ variation.name }}</a><span [ngClass]="variation.activityState">{{ variation.enablementText }}</span><div *ngIf="variation.isDefault"><span class="pe-customization-modal__title-label-segments" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span> <span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></span></div><div *ngIf="!variation.isDefault"><div><span class="pe-customization-modal__title-label-segments" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span><segment-expression-as-html [segmentExpression]="variation.triggers"></segment-expression-as-html></div></div></div><div><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="{ variation: variation }" class="pull-right"></se-dropdown-menu></div></li></ul>')}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}t.PersonalizationsmarteditContextService=class PersonalizationsmarteditContextService{constructor(e,t,o,n){this.sharedDataService=e;this.loadConfigManagerService=t;this.personalizationsmarteditContextServiceProxy=o;this.personalizationsmarteditContextUtils=n;const s=n.getContextObject();this.setPersonalization(s.personalization);this.setCustomize(s.customize);this.setCombinedView(s.combinedView);this.setSeData(s.seData);this.customizeFiltersState={}}getPersonalization(){return this.personalization}setPersonalization(e){this.personalization=e;this.personalizationsmarteditContextServiceProxy.setPersonalization(e)}getCustomize(){return this.customize}setCustomize(e){this.customize=e;this.personalizationsmarteditContextServiceProxy.setCustomize(e);window.sessionStorage.setItem("Customize",JSON.stringify(e))}getCombinedView(){return this.combinedView}setCombinedView(e){this.combinedView=e;this.personalizationsmarteditContextServiceProxy.setCombinedView(e);window.sessionStorage.setItem("CombinedView",JSON.stringify(e))}getSeData(){return this.seData}setSeData(e){this.seData=e;this.personalizationsmarteditContextServiceProxy.setSeData(e)}refreshExperienceData(){return this.sharedDataService.get("experience").then((e=>{const t=this.getSeData();t.seExperienceData=e;t.pageId=e.pageId;this.setSeData(t);return Promise.resolve("ok")}))}refreshConfigurationData(){this.loadConfigManagerService.loadAsObject().then((e=>{const t=this.getSeData();t.seConfigurationData=e;this.setSeData(t)}))}applySynchronization(){this.personalizationsmarteditContextServiceProxy.setPersonalization(this.personalization);this.personalizationsmarteditContextServiceProxy.setCustomize(this.customize);this.personalizationsmarteditContextServiceProxy.setCombinedView(this.combinedView);this.personalizationsmarteditContextServiceProxy.setSeData(this.seData);this.refreshExperienceData();this.refreshConfigurationData()}getContexServiceProxy(){return this.personalizationsmarteditContextServiceProxy}getCustomizeFiltersState(){return this.customizeFiltersState}setCustomizeFiltersState(e){this.customizeFiltersState=e}};t.PersonalizationsmarteditContextService.$inject=["sharedDataService","loadConfigManagerService","personalizationsmarteditContextServiceProxy","personalizationsmarteditContextUtils"];t.PersonalizationsmarteditContextService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ISharedDataService,g.LoadConfigManagerService,p.IPersonalizationsmarteditContextServiceProxy,p.PersonalizationsmarteditContextUtils])],t.PersonalizationsmarteditContextService);var w;t.PersonalizationsmarteditContextServiceReverseProxy=w=class PersonalizationsmarteditContextServiceReverseProxy{constructor(e,t,o){this.personalizationsmarteditContextService=e;this.workflowService=t;this.pageInfoService=o}applySynchronization(){this.personalizationsmarteditContextService.applySynchronization()}isCurrentPageActiveWorkflowRunning(){return this.pageInfoService.getPageUUID().then((e=>this.workflowService.getActiveWorkflowForPageUuid(e).then((e=>{if(e==null){return false}return e.status===w.WORKFLOW_RUNNING_STATUS}))))}};t.PersonalizationsmarteditContextServiceReverseProxy.WORKFLOW_RUNNING_STATUS="RUNNING";t.PersonalizationsmarteditContextServiceReverseProxy=w=__decorate([m.GatewayProxied("applySynchronization","isCurrentPageActiveWorkflowRunning"),m.SeDowngradeService(),__metadata("design:paramtypes",[t.PersonalizationsmarteditContextService,m.WorkflowService,m.IPageInfoService])],t.PersonalizationsmarteditContextServiceReverseProxy);t.PersonalizationsmarteditPreviewService=class PersonalizationsmarteditPreviewService{constructor(e){this.experienceService=e}removePersonalizationDataFromPreview(){return this.updatePreviewTicketWithVariations([])}updatePreviewTicketWithVariations(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.experienceService.getCurrentExperience();if(!t){return undefined}if(JSON.stringify(t.variations)===JSON.stringify(e)){return undefined}t.variations=e;yield this.experienceService.setCurrentExperience(t);return this.experienceService.updateExperience()}))}};t.PersonalizationsmarteditPreviewService.$inject=["experienceService"];t.PersonalizationsmarteditPreviewService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IExperienceService])],t.PersonalizationsmarteditPreviewService);t.PersonalizationsmarteditContextServiceProxy=class PersonalizationsmarteditContextServiceProxy extends p.IPersonalizationsmarteditContextServiceProxy{constructor(){super()}};t.PersonalizationsmarteditContextServiceProxy=__decorate([m.GatewayProxied("setPersonalization","setCustomize","setCombinedView","setSeData"),m.SeDowngradeService(p.IPersonalizationsmarteditContextServiceProxy),__metadata("design:paramtypes",[])],t.PersonalizationsmarteditContextServiceProxy);var E;t.PersonalizationsmarteditRestService=E=class PersonalizationsmarteditRestService{constructor(e,t,o,s,a){this.restServiceFactory=e;this.personalizationsmarteditUtils=t;this.httpClient=o;this.yjQuery=s;this.personalizationsmarteditContextService=a;this.actionHeaders=new n.HttpHeaders({"Content-Type":"application/json;charset=utf-8"})}extendRequestParamObjWithCatalogAwarePathVariables(e,t){t=t||{};const o=this.personalizationsmarteditContextService.getSeData().seExperienceData;const n={catalogId:t.catalog||o.catalogDescriptor.catalogId,catalogVersion:t.catalogVersion||o.catalogDescriptor.catalogVersion};e=d.assign(e,n);return e}extendRequestParamObjWithCustomizatonCode(e,t){const o={customizationCode:t};e=d.assign(e,o);return e}extendRequestParamObjWithVariationCode(e,t){const o={variationCode:t};e=d.assign(e,o);return e}getParamsAction(e,t,o,n,s,a){const r=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"oldComponentId",e);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"newComponentId",t);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"slotId",o);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"containerId",n);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"variationId",a);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"customizationId",s);return{params:{entry:r}}}getPathVariablesObjForModifyingActionURI(e,t,o,n){const s=this.personalizationsmarteditContextService.getSeData().seExperienceData;n=n||{};return{customizationCode:e,variationCode:t,actionId:o,catalogId:n.catalog||s.catalogDescriptor.catalogId,catalogVersion:n.catalogVersion||s.catalogDescriptor.catalogVersion}}prepareURI(e,t){return e.replace(/((?:\:)(\w*)(?:\/))/g,((e,o,n)=>t[n]+"/"))}getParamsForCustomizations(e){return{code:e.code,pageId:e.pageId,pageCatalogId:e.pageCatalogId,name:e.name,negatePageId:e.negatePageId,catalogs:e.catalogs,statuses:d.isUndefined(e.statuses)?undefined:e.statuses.join(",")}}getActionsDetails(e){const t=this.restServiceFactory.get(E.ACTIONS_DETAILS);e=this.extendRequestParamObjWithCatalogAwarePathVariables(e);return t.get(e)}getCustomizations(e){e=e||{};let t={};const o=this.restServiceFactory.get(E.CUSTOMIZATIONS);t=this.extendRequestParamObjWithCatalogAwarePathVariables(t,e);t.pageSize=e.currentSize||10;t.currentPage=e.currentPage||0;this.yjQuery.extend(t,this.getParamsForCustomizations(e));return o.get(t)}getComponentsIdsForVariation(e,t,o,n){const s=this.personalizationsmarteditContextService.getSeData().seExperienceData;const a=this.restServiceFactory.get(E.CXCMSC_ACTIONS_FROM_VARIATIONS);const r=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"customization",e);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"variations",t);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"catalog",o||s.catalogDescriptor.catalogId);this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"catalogVersion",n||s.catalogDescriptor.catalogVersion);const d={params:{entry:r}};return a.save(d)}getCxCmsActionsOnPageForCustomization(e,t){const o={type:"CXCMSACTION",catalogs:"ALL",fields:"FULL",pageId:this.personalizationsmarteditContextService.getSeData().pageId,pageCatalogId:this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext.catalogId,customizationCode:e.code||"",currentPage:t||0};return this.getActionsDetails(o)}getSegments(e){const t=this.restServiceFactory.get(E.SEGMENTS);return t.get(e)}getCustomization(e){const t=this.restServiceFactory.get(E.CUSTOMIZATION,"customizationCode");let o=this.extendRequestParamObjWithCustomizatonCode({},e.code);o=this.extendRequestParamObjWithCatalogAwarePathVariables(o,e);return t.get(o)}createCustomization(e){const t=this.restServiceFactory.get(E.CUSTOMIZATION_PACKAGES);return t.save(this.extendRequestParamObjWithCatalogAwarePathVariables(e))}updateCustomization(e){const t=this.restServiceFactory.get(E.CUSTOMIZATION,"customizationCode");e.customizationCode=e.code;return t.update(this.extendRequestParamObjWithCatalogAwarePathVariables(e))}updateCustomizationPackage(e){const t=this.restServiceFactory.get(E.CUSTOMIZATION_PACKAGE,"customizationCode");e.customizationCode=e.code;return t.update(this.extendRequestParamObjWithCatalogAwarePathVariables(e))}deleteCustomization(e){const t=this.restServiceFactory.get(E.CUSTOMIZATION,"customizationCode");const o={customizationCode:e};return t.remove(this.extendRequestParamObjWithCatalogAwarePathVariables(o))}getVariation(e,t){const o=this.restServiceFactory.get(E.VARIATION,"variationCode");let n=this.extendRequestParamObjWithVariationCode({},t);n=this.extendRequestParamObjWithCatalogAwarePathVariables(n);n=this.extendRequestParamObjWithCustomizatonCode(n,e);return o.get(n)}editVariation(e,t){const o=this.restServiceFactory.get(E.VARIATION,"variationCode");t=this.extendRequestParamObjWithCatalogAwarePathVariables(t);t=this.extendRequestParamObjWithCustomizatonCode(t,e);t.variationCode=t.code;return o.update(t)}deleteVariation(e,t){const o=this.restServiceFactory.get(E.VARIATION,"variationCode");let n=this.extendRequestParamObjWithVariationCode({},t);n=this.extendRequestParamObjWithCatalogAwarePathVariables(n);n=this.extendRequestParamObjWithCustomizatonCode(n,e);return o.remove(n)}createVariationForCustomization(e,t){const o=this.restServiceFactory.get(E.VARIATIONS);t=this.extendRequestParamObjWithCatalogAwarePathVariables(t);t=this.extendRequestParamObjWithCustomizatonCode(t,e);return o.save(t)}getVariationsForCustomization(e,t){const o=this.restServiceFactory.get(E.VARIATIONS);let n={};const s=t||{};n=this.extendRequestParamObjWithCatalogAwarePathVariables(n,s);n=this.extendRequestParamObjWithCustomizatonCode(n,e);n.fields=E.VARIATION_FOR_CUSTOMIZATION_DEFAULT_FIELDS;const a=typeof s.includeFullFields==="undefined"?false:s.includeFullFields;if(a){n.fields=E.FULL_FIELDS}return o.get(n)}replaceComponentWithContainer(e,t,o){const n=this.restServiceFactory.get(E.ADD_CONTAINER);const s=this.extendRequestParamObjWithCatalogAwarePathVariables({},o);const a=this.getParamsAction(e,null,t,null,null,null);this.personalizationsmarteditUtils.pushToArrayIfValueExists(a.params.entry,"catalog",s.catalogId);this.personalizationsmarteditUtils.pushToArrayIfValueExists(a.params.entry,"catalogVersion",s.catalogVersion);this.personalizationsmarteditUtils.pushToArrayIfValueExists(a.params.entry,"slotCatalog",o.slotCatalog);this.personalizationsmarteditUtils.pushToArrayIfValueExists(a.params.entry,"oldComponentCatalog",o.oldComponentCatalog);return n.save(a)}getActions(e,t,o){const n=this.restServiceFactory.get(E.ACTIONS);const s=this.getPathVariablesObjForModifyingActionURI(e,t,undefined,o);let a={fields:E.FULL_FIELDS};a=d.assign(a,s);return n.get(a)}createActions(e,t,o,n){const s=this.getPathVariablesObjForModifyingActionURI(e,t,undefined,n);const a=this.prepareURI(E.ACTIONS,s);const r={headers:this.actionHeaders};return this.httpClient.patch(a,o,r).toPromise()}addActionToContainer(e,t,o,n,s,a){const r=this.restServiceFactory.get(E.ACTIONS);const p=this.getPathVariablesObjForModifyingActionURI(n,s,undefined,a);let m={type:"cxCmsActionData",containerId:o,componentId:e,componentCatalog:t};m=d.assign(m,p);return r.save(m)}editAction(e,t,o,n,s,a){return __awaiter(this,void 0,void 0,(function*(){const r=this.restServiceFactory.get(E.ACTION,"actionId");const p=this.getPathVariablesObjForModifyingActionURI(e,t,o,a);let m=yield r.get(p);m=d.assign(m,p);m.componentId=n;m.componentCatalog=s;return r.update(m)}))}deleteAction(e,t,o,n){const s=this.restServiceFactory.get(E.ACTION,"actionId");const a=this.getPathVariablesObjForModifyingActionURI(e,t,o,n);return s.remove(a)}deleteActions(e,t,o,n){const s=this.getPathVariablesObjForModifyingActionURI(e,t,undefined,n);const a=this.prepareURI(E.ACTIONS,s);const r={headers:this.actionHeaders,body:o};return this.httpClient.delete(a,r).toPromise()}getComponents(e){const t=this.personalizationsmarteditContextService.getSeData().seExperienceData;const o=this.restServiceFactory.get(E.CATALOGS);let n={siteId:t.siteDescriptor.uid};n=d.assign(n,e);return o.get(this.extendRequestParamObjWithCatalogAwarePathVariables(n,e))}getComponent(e){const t=this.personalizationsmarteditContextService.getSeData().seExperienceData;const o=this.restServiceFactory.get(E.CATALOG,"itemUuid");const n={itemUuid:e,siteId:t.siteDescriptor.uid};return o.get(n)}getNewComponentTypes(){const e=this.restServiceFactory.get(E.COMPONENT_TYPES);return e.get()}updateCustomizationRank(e,t){const o=this.personalizationsmarteditContextService.getSeData().seExperienceData;const n=this.restServiceFactory.get(E.UPDATE_CUSTOMIZATION_RANK);const s=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"customization",e);this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"increaseValue",t);this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"catalog",o.catalogDescriptor.catalogId);this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"catalogVersion",o.catalogDescriptor.catalogVersion);const a={params:{entry:s}};return n.save(a)}checkVersionConflict(e){const t=this.personalizationsmarteditContextService.getSeData().seExperienceData;const o=this.restServiceFactory.get(E.CHECK_VERSION);const n=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"versionId",e);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"catalog",t.catalogDescriptor.catalogId);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"catalogVersion",t.catalogDescriptor.catalogVersion);const s={params:{entry:n}};return o.save(s)}};t.PersonalizationsmarteditRestService.CUSTOMIZATIONS="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/customizations";t.PersonalizationsmarteditRestService.CUSTOMIZATION=E.CUSTOMIZATIONS+"/:customizationCode";t.PersonalizationsmarteditRestService.CUSTOMIZATION_PACKAGES="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/customizationpackages";t.PersonalizationsmarteditRestService.CUSTOMIZATION_PACKAGE=E.CUSTOMIZATION_PACKAGES+"/:customizationCode";t.PersonalizationsmarteditRestService.ACTIONS_DETAILS="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/actions";t.PersonalizationsmarteditRestService.VARIATIONS=E.CUSTOMIZATION+"/variations";t.PersonalizationsmarteditRestService.VARIATION=E.VARIATIONS+"/:variationCode";t.PersonalizationsmarteditRestService.ACTIONS=E.VARIATION+"/actions";t.PersonalizationsmarteditRestService.ACTION=E.ACTIONS+"/:actionId";t.PersonalizationsmarteditRestService.CXCMSC_ACTIONS_FROM_VARIATIONS="/personalizationwebservices/v1/query/cxcmscomponentsfromvariations";t.PersonalizationsmarteditRestService.SEGMENTS="/personalizationwebservices/v1/segments";t.PersonalizationsmarteditRestService.CATALOGS="/cmswebservices/v1/sites/:siteId/cmsitems";t.PersonalizationsmarteditRestService.CATALOG=E.CATALOGS+"/:itemUuid";t.PersonalizationsmarteditRestService.ADD_CONTAINER="/personalizationwebservices/v1/query/cxReplaceComponentWithContainer";t.PersonalizationsmarteditRestService.COMPONENT_TYPES="/cmswebservices/v1/types?category=COMPONENT";t.PersonalizationsmarteditRestService.UPDATE_CUSTOMIZATION_RANK="/personalizationwebservices/v1/query/cxUpdateCustomizationRank";t.PersonalizationsmarteditRestService.CHECK_VERSION="/personalizationwebservices/v1/query/cxCmsPageVersionCheck";t.PersonalizationsmarteditRestService.VARIATION_FOR_CUSTOMIZATION_DEFAULT_FIELDS="variations(active,actions,enabled,code,name,rank,status,catalog,catalogVersion)";t.PersonalizationsmarteditRestService.FULL_FIELDS="FULL";t.PersonalizationsmarteditRestService=E=__decorate([m.SeDowngradeService(),__param(3,s.Inject(m.YJQUERY_TOKEN)),__metadata("design:paramtypes",[m.RestServiceFactory,p.PersonalizationsmarteditUtils,n.HttpClient,Function,t.PersonalizationsmarteditContextService])],t.PersonalizationsmarteditRestService);t.PersonalizationsmarteditRulesAndPermissionsRegistrationService=class PersonalizationsmarteditRulesAndPermissionsRegistrationService{constructor(e,t,o,n,s){this.personalizationsmarteditContextService=e;this.personalizationsmarteditRestService=t;this.permissionService=o;this.catalogVersionPermissionService=n;this.pageService=s}registerRules(){this.permissionService.registerRule({names:["se.access.personalization"],verify:()=>__awaiter(this,void 0,void 0,(function*(){yield this.catalogVersionPermissionService.hasReadPermissionOnCurrent();yield this.personalizationsmarteditContextService.refreshExperienceData();try{yield this.personalizationsmarteditRestService.getCustomizations(this.getCustomizationFilter());return true}catch(e){if(e.status===403){return false}else{return true}}}))});this.permissionService.registerRule({names:["se.access.personalization.page"],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.pageService.getCurrentPageInfo();return e.typeCode!=="EmailPage"}))});this.permissionService.registerPermission({aliases:["se.personalization.open"],rules:["se.access.personalization"]});this.permissionService.registerPermission({aliases:["se.personalization.page"],rules:["se.access.personalization.page"]})}getCustomizationFilter(){return{currentPage:0,currentSize:1}}};t.PersonalizationsmarteditRulesAndPermissionsRegistrationService.$inject=["personalizationsmarteditContextService","personalizationsmarteditRestService","permissionService","catalogVersionPermissionService","pageService"];t.PersonalizationsmarteditRulesAndPermissionsRegistrationService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.PersonalizationsmarteditContextService,t.PersonalizationsmarteditRestService,m.IPermissionService,m.ICatalogVersionPermissionService,m.IPageService])],t.PersonalizationsmarteditRulesAndPermissionsRegistrationService);t.PersonalizationsmarteditVersionCheckerService=class PersonalizationsmarteditVersionCheckerService{constructor(e,t){this.restService=e;this.pageVersionSelectionService=t}setVersion(e){this.version=e}provideTranlationKey(e){const t="personalization.se.cms.actionitem.page.version.rollback.confirmation";this.version=this.version||this.pageVersionSelectionService.getSelectedPageVersion();if(!!this.version){return this.restService.checkVersionConflict(this.version.uid).then((o=>o.result?e:t),(()=>e))}else{return Promise.resolve(e)}}};t.PersonalizationsmarteditVersionCheckerService.$inject=["restService","pageVersionSelectionService"];t.PersonalizationsmarteditVersionCheckerService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.PersonalizationsmarteditRestService,m.PageVersionSelectionService])],t.PersonalizationsmarteditVersionCheckerService);t.SePersonalizationsmarteditServicesModule=class SePersonalizationsmarteditServicesModule{};t.SePersonalizationsmarteditServicesModule=__decorate([s.NgModule({imports:[u.CommonModule,p.PersonalizationsmarteditCommonsComponentsModule],providers:[{provide:p.IPersonalizationsmarteditContextServiceProxy,useClass:t.PersonalizationsmarteditContextServiceProxy},t.PersonalizationsmarteditContextService,t.PersonalizationsmarteditRestService,t.PersonalizationsmarteditPreviewService,t.PersonalizationsmarteditRulesAndPermissionsRegistrationService,t.PersonalizationsmarteditContextServiceReverseProxy,t.PersonalizationsmarteditVersionCheckerService,m.moduleUtils.bootstrap((e=>{e.registerRules()}),[t.PersonalizationsmarteditRulesAndPermissionsRegistrationService])]})],t.SePersonalizationsmarteditServicesModule);let T=class CombinedViewConfigureService{constructor(){this.catalogFilterSubject=new f.Subject;this.selectedItemsSubject=new f.BehaviorSubject([]);this.selectedItems=[];this.isItemSelected=e=>!!this.selectedItems.find((t=>t.customization.code===e.customization.code&&t.variation.code===e.variation.code));this.selectedItemsSubscription=this.selectedItemsSubject.asObservable().subscribe((e=>{this.selectedItems=e}))}ngOnDestroy(){this.selectedItemsSubscription.unsubscribe()}setCatalogFilter(e){this.catalogFilterSubject.next(e)}getCatalogFilter$(){return this.catalogFilterSubject.asObservable()}setSelectedItems(e){this.selectedItemsSubject.next(e)}};T=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[])],T);window.__smartedit__.addDecoratorPayload("Component","CombinedViewItemPrinterComponent",{selector:"combined-view-item-printer",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<div [ngClass]="isItemSelected(combinedViewSelectItem) ? 'pe-combinedview-config__ui-select-item--selected': ''" class="pe-combinedview-config__ui-select-choices-layout"><div class="pe-combinedview-config__ui-select-choices-col1"><div [title]="combinedViewSelectItem.customization.name + ' > ' + combinedViewSelectItem.variation.name" [textContent]="combinedViewSelectItem.customization.name + ' > ' + combinedViewSelectItem.variation.name" class="perso-wrap-ellipsis"></div></div></div>`});let P=class CombinedViewItemPrinterComponent{constructor(e,t,o,n){this.data=e;this.contextService=t;this.personalizationsmarteditUtils=o;this.combinedViewConfigureService=n;this.isItemFromCurrentCatalog=e=>this.personalizationsmarteditUtils.isItemFromCurrentCatalog(e,this.contextService.getSeData());this.isItemSelected=e=>this.combinedViewConfigureService.isItemSelected(e);({item:this.combinedViewSelectItem,selected:this.isSelected,select:this.select}=e);this.catalogFilterSubscription=this.combinedViewConfigureService.getCatalogFilter$().subscribe((e=>{this.catalogFilter=e}))}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){if(this.catalogFilter!=="current"){yield this.personalizationsmarteditUtils.getAndSetCatalogVersionNameL10N(this.data.item.variation)}}))}ngOnDestroy(){this.catalogFilterSubscription.unsubscribe()}};P=__decorate([s.Component({selector:"combined-view-item-printer",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<div [ngClass]="isItemSelected(combinedViewSelectItem) ? 'pe-combinedview-config__ui-select-item--selected': ''" class="pe-combinedview-config__ui-select-choices-layout"><div class="pe-combinedview-config__ui-select-choices-col1"><div [title]="combinedViewSelectItem.customization.name + ' > ' + combinedViewSelectItem.variation.name" [textContent]="combinedViewSelectItem.customization.name + ' > ' + combinedViewSelectItem.variation.name" class="perso-wrap-ellipsis"></div></div></div>`}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditUtils,T])],P);window.__smartedit__.addDecoratorPayload("Component","CombinedViewConfigureComponent",{selector:"combined-view-configure",template:`<div class="pe-combinedview-config__form"><div class="form-group"><label for="PageFilterDropdownField001" class="fd-form__label" translate="personalization.commons.filter.label"></label><div class="pe-combinedview-config__filter-layout"><page-filter-dropdown id="PageFilterDropdownField001" (onSelectCallback)="pageFilterChange($event)" class="fd-has-margin-right-small"></page-filter-dropdown><has-multicatalog><catalog-filter-dropdown (onSelectCallback)="catalogFilterChange($event)"></catalog-filter-dropdown></has-multicatalog></div><div class="pe-combinedview-config__select-group-layout"><div class="pe-combinedview-config__select-group-label-layout"><label for="CombinedViewSearchField1" class="fd-form__label se-control-label required pe-combinedview-config__label" translate="personalization.modal.combinedview.search.label"></label></div><se-select id="CombinedViewSearchField1" class="fd-form__control" [(model)]="selectedCombinedViewItemId" [placeholder]="'personalization.modal.combinedview.search.placeholder'" [fetchStrategy]="combinedViewItemsFetchStrategy" [onSelect]="selectElement" [itemComponent]="combinedViewItemPrinter" [disableChoiceFn]="isItemInSelectDisabled" [(reset)]="resetSelectedItems" [resetSearchInput]="false"></se-select></div></div><div class="form-group"><p *ngIf="selectedCombinedViewItems.length === 0" translate="personalization.toolbar.combinedview.openconfigure.empty"></p><div id="CombinedViewSelectedField1" class="pe-combinedview-config__list-layout" *ngFor="let item of selectedCombinedViewItems; index as i; first as isFirst" [ngClass]="isFirst ? 'pe-combinedview-config__divider' : ''"><div class="pe-combinedview-config__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combinedview-config__names-layout"><div class="perso-wrap-ellipsis pe-combinedview-config__cname" [textContent]="item.customization.name" [title]="item.customization.name"></div><span>></span><div class="perso-wrap-ellipsis pe-combinedview-config__vname" [textContent]="item.variation.name" [title]="item.variation.name"></div></div><div class="pe-combinedview-config__hyicon-globe"><se-tooltip *ngIf="!isItemFromCurrentCatalog(item.variation)" [placement]="'top-end'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span class="perso__globe-icon sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body [translate]="item.variation.catalogVersionNameL10N"></div></se-tooltip></div><div class="pe-combinedview-config__hyicon-remove"><span class="sap-icon--decline" (click)="removeSelectedItem(item)" [title]="'personalization.modal.combinedview.icon.remove.title' | translate"></span></div></div></div></div>`});let A=class CombinedViewConfigureComponent{constructor(e,t,o,n,s,a,r,d){this.translateService=e;this.contextService=t;this.messageHandler=o;this.personalizationsmarteditUtils=n;this.componentMenuService=s;this.restService=a;this.modalManager=r;this.combinedViewConfigureService=d;this.selectElement=(e,t)=>__awaiter(this,void 0,void 0,(function*(){if(!e){return}this.selectedCombinedViewItems.push(e);const t=yield this.componentMenuService.getValidContentCatalogVersions();const o=t.map((e=>e.id));this.selectedCombinedViewItems.sort(((e,t)=>{const n=e.customization.catalog+"/"+e.customization.catalogVersion;const s=t.customization.catalog+"/"+t.customization.catalogVersion;if(n===s){return e.customization.rank-t.customization.rank}return o.indexOf(s)-o.indexOf(n)}));this.combinedViewConfigureService.setSelectedItems(this.selectedCombinedViewItems);this.reset()}));this.removeSelectedItem=e=>{this.selectedCombinedViewItems.splice(this.selectedCombinedViewItems.indexOf(e),1);this.combinedViewConfigureService.setSelectedItems(this.selectedCombinedViewItems);this.reset()};this.getClassForElement=e=>this.personalizationsmarteditUtils.getClassForElement(e);this.getLetterForElement=e=>this.personalizationsmarteditUtils.getLetterForElement(e);this.isItemInSelectDisabled=e=>!!this.selectedCombinedViewItems.find((t=>t.customization.code===e.customization.code));this.pageFilterChange=e=>{this.customizationPageFilter=e};this.catalogFilterChange=e=>{this.catalogFilter=e;this.combinedViewConfigureService.setCatalogFilter(this.catalogFilter)};this.isItemFromCurrentCatalog=e=>this.personalizationsmarteditUtils.isItemFromCurrentCatalog(e,this.contextService.getSeData());this.constructCombinedViewSelectItem=(e,t)=>({id:e.code+"-"+t.code,label:e.name+" > "+t.name,customization:{code:e.code,name:e.name,rank:e.rank,catalog:e.catalog,catalogVersion:e.catalogVersion},variation:{code:t.code,name:t.name,catalog:t.catalog,catalogVersion:t.catalogVersion}})}ngOnInit(){this.combinedView=this.contextService.getCombinedView();this.selectedCombinedViewItems=[];this.selectedCombinedViewItems=d.cloneDeep(this.combinedView.selectedItems||[]);this.combinedViewConfigureService.setSelectedItems(this.selectedCombinedViewItems);this.selectedCombinedViewItemId=null;this.moreCustomizationsRequestProcessing=false;this.combinedViewItemPrinter=P;this.combinedViewItemsFetchStrategy={fetchPage:(e,t,o)=>__awaiter(this,void 0,void 0,(function*(){return this.customizedVarItemsFetchPage(e,t,o)})),fetchEntity:e=>__awaiter(this,void 0,void 0,(function*(){return this.customizedVarItemsFetchEntity(e)}))};this.modalManager.addButtons([{id:"confirmOk",label:"personalization.modal.combinedview.button.ok",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.Close,callback:()=>f.from(this.onSave()),disabledFn:()=>{const e=this.contextService.getCombinedView();let t=(e.selectedItems||[]).length===0&&this.selectedCombinedViewItems.length===0;t=t||d.isEqual(e.selectedItems,this.selectedCombinedViewItems);return t}},{id:"confirmCancel",label:"personalization.modal.combinedview.button.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.Dismiss,callback:()=>f.from(this.onCancel())}])}reset(){if(this.resetSelectedItems){this.resetSelectedItems(true)}}customizedVarItemsFetchPage(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=this.getCustomizationsCategoryFilter(e,t,o);try{const e=yield this.restService.getCustomizations(n);const t=[];e.customizations.forEach((e=>{e.variations.filter((e=>this.personalizationsmarteditUtils.isItemVisible(e))).forEach((o=>t.push(this.constructCombinedViewSelectItem(e,o))))}));return{pagination:e.pagination,results:t}}catch(e){this.messageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomizations"))}}))}customizedVarItemsFetchEntity(e){return __awaiter(this,void 0,void 0,(function*(){if(!e){return}const[t,o]=e.split("-");const n=yield this.restService.getCustomization({code:t});const s=n.variations.filter((e=>e.code===o))[0];return this.constructCombinedViewSelectItem(n,s)}))}getDefaultStatus(){const e=this.personalizationsmarteditUtils.getStatusesMapping();return e.find((e=>e.code===p.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ALL))}isCombinedViewContextPersRemoved(e){const t=e.selectedItems;return!t.find((t=>t.customization.code===e.customize.selectedCustomization.code&&t.variation.code===e.customize.selectedVariations.code))}getCustomizationsCategoryFilter(e="",t,o){const n={currentSize:t,currentPage:o,name:e,statuses:this.getDefaultStatus().modelStatuses,catalogs:this.catalogFilter,pageId:undefined,pageCatalogId:undefined};if(this.customizationPageFilter===p.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ONLY_THIS_PAGE){n.pageId=this.contextService.getSeData().pageId;n.pageCatalogId=this.contextService.getSeData().seExperienceData.pageContext.catalogId}return n}onCancel(){this.modalManager.close(null);return Promise.resolve()}onSave(){const e=this.contextService.getCombinedView();e.selectedItems=this.selectedCombinedViewItems;if(e.enabled&&e.customize.selectedVariations!==null&&this.isCombinedViewContextPersRemoved(e)){e.customize.selectedCustomization=null;e.customize.selectedVariations=null;e.customize.selectedComponents=null}this.contextService.setCombinedView(e);this.modalManager.close(null);return Promise.resolve()}};A=__decorate([s.Component({selector:"combined-view-configure",template:`<div class="pe-combinedview-config__form"><div class="form-group"><label for="PageFilterDropdownField001" class="fd-form__label" translate="personalization.commons.filter.label"></label><div class="pe-combinedview-config__filter-layout"><page-filter-dropdown id="PageFilterDropdownField001" (onSelectCallback)="pageFilterChange($event)" class="fd-has-margin-right-small"></page-filter-dropdown><has-multicatalog><catalog-filter-dropdown (onSelectCallback)="catalogFilterChange($event)"></catalog-filter-dropdown></has-multicatalog></div><div class="pe-combinedview-config__select-group-layout"><div class="pe-combinedview-config__select-group-label-layout"><label for="CombinedViewSearchField1" class="fd-form__label se-control-label required pe-combinedview-config__label" translate="personalization.modal.combinedview.search.label"></label></div><se-select id="CombinedViewSearchField1" class="fd-form__control" [(model)]="selectedCombinedViewItemId" [placeholder]="'personalization.modal.combinedview.search.placeholder'" [fetchStrategy]="combinedViewItemsFetchStrategy" [onSelect]="selectElement" [itemComponent]="combinedViewItemPrinter" [disableChoiceFn]="isItemInSelectDisabled" [(reset)]="resetSelectedItems" [resetSearchInput]="false"></se-select></div></div><div class="form-group"><p *ngIf="selectedCombinedViewItems.length === 0" translate="personalization.toolbar.combinedview.openconfigure.empty"></p><div id="CombinedViewSelectedField1" class="pe-combinedview-config__list-layout" *ngFor="let item of selectedCombinedViewItems; index as i; first as isFirst" [ngClass]="isFirst ? 'pe-combinedview-config__divider' : ''"><div class="pe-combinedview-config__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combinedview-config__names-layout"><div class="perso-wrap-ellipsis pe-combinedview-config__cname" [textContent]="item.customization.name" [title]="item.customization.name"></div><span>></span><div class="perso-wrap-ellipsis pe-combinedview-config__vname" [textContent]="item.variation.name" [title]="item.variation.name"></div></div><div class="pe-combinedview-config__hyicon-globe"><se-tooltip *ngIf="!isItemFromCurrentCatalog(item.variation)" [placement]="'top-end'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span class="perso__globe-icon sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body [translate]="item.variation.catalogVersionNameL10N"></div></se-tooltip></div><div class="pe-combinedview-config__hyicon-remove"><span class="sap-icon--decline" (click)="removeSelectedItem(item)" [title]="'personalization.modal.combinedview.icon.remove.title' | translate"></span></div></div></div></div>`}),__metadata("design:paramtypes",[v.TranslateService,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditMessageHandler,p.PersonalizationsmarteditUtils,m.ComponentMenuService,t.PersonalizationsmarteditRestService,m.ModalManagerService,T])],A);t.CombinedViewCommonsService=class CombinedViewCommonsService{constructor(e,t,o,n,s,a,r){this.personalizationsmarteditContextUtils=e;this.personalizationsmarteditContextService=t;this.personalizationsmarteditPreviewService=o;this.personalizationsmarteditUtils=n;this.personalizationsmarteditRestService=s;this.modalService=a;this.logService=r}openManagerAction(){return __awaiter(this,void 0,void 0,(function*(){try{yield this.modalService.open({component:A,templateConfig:{title:"personalization.modal.combinedview.title",isDismissButtonVisible:true},config:{focusTrapped:false,backdropClickCloseable:false}}).afterClosed.toPromise();this.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(this.personalizationsmarteditContextService);const e=this.personalizationsmarteditContextService.getCombinedView();e.enabled=e.selectedItems&&e.selectedItems.length>0;this.personalizationsmarteditContextService.setCombinedView(e);this.updatePreview(this.getVariationsForPreviewTicket())}catch(e){this.logService.debug("Combined View Items Select Modal dismissed",e)}}))}updatePreview(e){this.personalizationsmarteditPreviewService.updatePreviewTicketWithVariations(e);this.updateActionsOnSelectedVariations()}getVariationsForPreviewTicket(){const e=[];const t=this.personalizationsmarteditContextService.getCombinedView();(t.selectedItems||[]).forEach((t=>{e.push({customizationCode:t.customization.code,variationCode:t.variation.code,catalog:t.variation.catalog,catalogVersion:t.variation.catalogVersion})}));return e}combinedViewEnabledEvent(e){const t=this.personalizationsmarteditContextService.getCombinedView();t.enabled=e;this.personalizationsmarteditContextService.setCombinedView(t);const o=this.personalizationsmarteditContextService.getCustomize();o.selectedCustomization=null;o.selectedVariations=null;o.selectedComponents=null;this.personalizationsmarteditContextService.setCustomize(o);if(e){this.updatePreview(this.getVariationsForPreviewTicket())}else{this.updatePreview([])}}isItemFromCurrentCatalog(e){return this.personalizationsmarteditUtils.isItemFromCurrentCatalog(e,this.personalizationsmarteditContextService.getSeData())}updateActionsOnSelectedVariations(){return __awaiter(this,void 0,void 0,(function*(){const e=this.personalizationsmarteditContextService.getCombinedView();const t=(e.selectedItems||[]).map((e=>__awaiter(this,void 0,void 0,(function*(){const t=yield this.personalizationsmarteditRestService.getActions(e.customization.code,e.variation.code,e.variation);e.variation.actions=t.actions}))));yield Promise.all(t);this.personalizationsmarteditContextService.setCombinedView(e)}))}};t.CombinedViewCommonsService.$inject=["personalizationsmarteditContextUtils","personalizationsmarteditContextService","personalizationsmarteditPreviewService","personalizationsmarteditUtils","personalizationsmarteditRestService","modalService","logService"];t.CombinedViewCommonsService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[p.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditContextService,t.PersonalizationsmarteditPreviewService,p.PersonalizationsmarteditUtils,t.PersonalizationsmarteditRestService,m.IModalService,m.LogService])],t.CombinedViewCommonsService);window.__smartedit__.addDecoratorPayload("Component","CombinedViewMenuComponent",{selector:"combined-view-menu",template:`<div class="btn-block pe-toolbar-action--include"><div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized se-toolbar-menu-content--pe-combine" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2" translate="personalization.toolbar.combinedview.header.title"></h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.combinedview.header.description"></span></se-help></div><div role="menuitem"><div *ngIf="!isCombinedViewConfigured"><div class="pe-combined-view-panel__wrapper pe-combined-view-panel__wrapper--empty"><img src="static-resources/images/emptyVersions.svg" alt="no Configurationss" class="pe-combined-view-panel--empty-img"> <span class="pe-combined-view-panel--empty-text" translate="personalization.toolbar.combinedview.openconfigure.empty"></span> <a class="fd-link pe-combined-view-panel--empty-link" (click)="combinedViewClick()" translate="personalization.toolbar.combinedview.openconfigure.link" [title]="'personalization.toolbar.combinedview.openconfigure.link' | translate"></a></div></div><div *ngIf="isCombinedViewConfigured"><div class="pe-combined-view-panel__wrapper"><div class="pe-combined-view-panel__configure-layout"><button class="pe-combined-view-panel__configure-btn fd-button perso-wrap-ellipsis" (click)="combinedViewClick()" translate="personalization.toolbar.combinedview.openconfigure.button" [title]="'personalization.toolbar.combinedview.openconfigure.button' | translate"></button> <button class="pe-combined-view-panel__configure-btn fd-button--light perso-wrap-ellipsis" (click)="clearAllCombinedViewClick()" translate="personalization.toolbar.combinedview.clearall.button" [title]="'personalization.toolbar.combinedview.clearall.button' | translate"></button></div><div [ngClass]="combinedView.enabled ? null : 'pe-combined-view-panel--disabled'"><div class="pe-combined-view-panel__list-layout" *ngFor="let item of selectedItems; index as i" (click)="itemClick(item)" [ngClass]="{'pe-combined-view-panel-list__item--highlighted': item.highlighted}"><div class="pe-combined-view-panel-list__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combined-view-panel-list__names-layout"><div class="perso-wrap-ellipsis" [textContent]="item.customization.name" [title]="item.customization.name"></div><div class="perso-wrap-ellipsis perso-tree__primary-data" [textContent]="item.variation.name" [title]="item.variation.name"></div></div><div class="pe-combined-view-panel-list__icon"><se-tooltip *ngIf="!isItemFromCurrentCatalog(item.variation) && combinedView.enabled" [placement]="'top-end'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span class="perso__globe-icon sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body [translate]="item.variation.catalogVersionNameL10N"></div></se-tooltip></div></div></div></div></div></div></div></div>`});t.CombinedViewMenuComponent=class CombinedViewMenuComponent{constructor(e,t,o,n,s,a,r,d,p,m){this.translateService=e;this.contextService=t;this.messageHandler=o;this.restService=n;this.contextUtils=s;this.personalizationsmarteditUtils=a;this.previewService=r;this.combinedViewCommonsService=d;this.crossFrameEventService=p;this.permissionService=m}ngOnInit(){this.combinedView=this.contextService.getCombinedView();this.selectedItems=this.combinedView.selectedItems||[];this.isCombinedViewConfigured=this.selectedItems.length!==0}combinedViewClick(){this.contextUtils.clearCustomizeContextAndReloadPreview(this.previewService,this.contextService);this.combinedViewCommonsService.openManagerAction()}getAndSetComponentsForElement(e,t,o,n){return __awaiter(this,void 0,void 0,(function*(){try{const s=yield this.restService.getComponentsIdsForVariation(e,t,o,n);const a=this.contextService.getCombinedView();a.customize.selectedComponents=s.components;this.contextService.setCombinedView(a)}catch(e){this.messageHandler.sendError(this.translateService.instant("personalization.error.gettingcomponentsforvariation"))}}))}itemClick(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.contextService.getCombinedView();if(!t.enabled){return}this.selectedItems.forEach((e=>{e.highlighted=false}));e.highlighted=true;t.customize.selectedCustomization=e.customization;t.customize.selectedVariations=e.variation;this.contextService.setCombinedView(t);const o=yield this.permissionService.isPermitted([{names:["se.edit.page"]}]);if(o){this.getAndSetComponentsForElement(e.customization.code,e.variation.code,e.customization.catalog,e.customization.catalogVersion)}this.combinedViewCommonsService.updatePreview(this.personalizationsmarteditUtils.getVariationKey(e.customization.code,[e.variation]));this.crossFrameEventService.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.COMBINED_VIEW_TOOLBAR_ITEM_KEY)}))}getClassForElement(e){return this.personalizationsmarteditUtils.getClassForElement(e)}getLetterForElement(e){return this.personalizationsmarteditUtils.getLetterForElement(e)}isItemFromCurrentCatalog(e){return this.combinedViewCommonsService.isItemFromCurrentCatalog(e)}clearAllCombinedViewClick(){this.selectedItems=[];this.combinedView.selectedItems=[];this.combinedView.enabled=false;this.contextService.setCombinedView(this.combinedView);this.combinedViewCommonsService.combinedViewEnabledEvent(this.combinedView.enabled)}};t.CombinedViewMenuComponent=__decorate([s.Component({selector:"combined-view-menu",template:`<div class="btn-block pe-toolbar-action--include"><div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized se-toolbar-menu-content--pe-combine" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2" translate="personalization.toolbar.combinedview.header.title"></h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.combinedview.header.description"></span></se-help></div><div role="menuitem"><div *ngIf="!isCombinedViewConfigured"><div class="pe-combined-view-panel__wrapper pe-combined-view-panel__wrapper--empty"><img src="static-resources/images/emptyVersions.svg" alt="no Configurationss" class="pe-combined-view-panel--empty-img"> <span class="pe-combined-view-panel--empty-text" translate="personalization.toolbar.combinedview.openconfigure.empty"></span> <a class="fd-link pe-combined-view-panel--empty-link" (click)="combinedViewClick()" translate="personalization.toolbar.combinedview.openconfigure.link" [title]="'personalization.toolbar.combinedview.openconfigure.link' | translate"></a></div></div><div *ngIf="isCombinedViewConfigured"><div class="pe-combined-view-panel__wrapper"><div class="pe-combined-view-panel__configure-layout"><button class="pe-combined-view-panel__configure-btn fd-button perso-wrap-ellipsis" (click)="combinedViewClick()" translate="personalization.toolbar.combinedview.openconfigure.button" [title]="'personalization.toolbar.combinedview.openconfigure.button' | translate"></button> <button class="pe-combined-view-panel__configure-btn fd-button--light perso-wrap-ellipsis" (click)="clearAllCombinedViewClick()" translate="personalization.toolbar.combinedview.clearall.button" [title]="'personalization.toolbar.combinedview.clearall.button' | translate"></button></div><div [ngClass]="combinedView.enabled ? null : 'pe-combined-view-panel--disabled'"><div class="pe-combined-view-panel__list-layout" *ngFor="let item of selectedItems; index as i" (click)="itemClick(item)" [ngClass]="{'pe-combined-view-panel-list__item--highlighted': item.highlighted}"><div class="pe-combined-view-panel-list__letter-layout"><div [ngClass]="getClassForElement(i)" [textContent]="getLetterForElement(i)"></div></div><div class="pe-combined-view-panel-list__names-layout"><div class="perso-wrap-ellipsis" [textContent]="item.customization.name" [title]="item.customization.name"></div><div class="perso-wrap-ellipsis perso-tree__primary-data" [textContent]="item.variation.name" [title]="item.variation.name"></div></div><div class="pe-combined-view-panel-list__icon"><se-tooltip *ngIf="!isItemFromCurrentCatalog(item.variation) && combinedView.enabled" [placement]="'top-end'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span class="perso__globe-icon sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body [translate]="item.variation.catalogVersionNameL10N"></div></se-tooltip></div></div></div></div></div></div></div></div>`}),__metadata("design:paramtypes",[v.TranslateService,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditMessageHandler,t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditContextUtils,p.PersonalizationsmarteditUtils,t.PersonalizationsmarteditPreviewService,t.CombinedViewCommonsService,m.CrossFrameEventService,m.IPermissionService])],t.CombinedViewMenuComponent);window.__smartedit__.addDecoratorPayload("Component","CatalogFilterDropdownComponent",{selector:"catalog-filter-dropdown",template:`<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>`});let O=class CatalogFilterDropdownComponent{constructor(){this.fetchStrategy={fetchAll:()=>Promise.resolve(this.items)};this.onChange=this.onChange.bind(this);this.onSelectCallback=new s.EventEmitter}ngOnInit(){this.items=[{id:p.PERSONALIZATION_CATALOG_FILTER.ALL,label:"personalization.filter.catalog.all"},{id:p.PERSONALIZATION_CATALOG_FILTER.CURRENT,label:"personalization.filter.catalog.current"},{id:p.PERSONALIZATION_CATALOG_FILTER.PARENTS,label:"personalization.filter.catalog.parents"}];this.selectedId=this.initialValue||this.items[1].id}onChange(){this.onSelectCallback.emit(this.selectedId)}};__decorate([s.Input(),__metadata("design:type",String)],O.prototype,"initialValue",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],O.prototype,"onSelectCallback",void 0);O=__decorate([s.Component({selector:"catalog-filter-dropdown",template:`<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>`}),__metadata("design:paramtypes",[])],O);window.__smartedit__.addDecoratorPayload("Component","PageFilterDropdownComponent",{selector:"page-filter-dropdown",template:`<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>`});let x=class PageFilterDropdownComponent{constructor(){this.fetchStrategy={fetchAll:()=>Promise.resolve(this.items)};this.onChange=this.onChange.bind(this);this.onSelectCallback=new s.EventEmitter}ngOnInit(){this.items=[{id:p.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ONLY_THIS_PAGE,label:"personalization.filter.page.onlythispage"},{id:p.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ALL,label:"personalization.filter.page.all"}];this.selectedId=this.initialValue||this.items[0].id}onChange(){this.onSelectCallback.emit(this.selectedId)}};__decorate([s.Input(),__metadata("design:type",String)],x.prototype,"initialValue",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],x.prototype,"onSelectCallback",void 0);x=__decorate([s.Component({selector:"page-filter-dropdown",template:`<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>`}),__metadata("design:paramtypes",[])],x);window.__smartedit__.addDecoratorPayload("Component","StatusFilterDropdownComponent",{selector:"status-filter-dropdown",template:`<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>`});let D=class StatusFilterDropdownComponent{constructor(e){this.personalizationsmarteditUtils=e;this.fetchStrategy={fetchAll:()=>Promise.resolve(this.items)};this.onChange=this.onChange.bind(this);this.onSelectCallback=new s.EventEmitter}ngOnInit(){this.items=this.personalizationsmarteditUtils.getStatusesMapping().map((e=>({id:e.code,label:e.text,modelStatuses:e.modelStatuses})));this.selectedId=this.initialValue||this.items[0].id}onChange(){this.onSelectCallback.emit(this.selectedId)}};__decorate([s.Input(),__metadata("design:type",String)],D.prototype,"initialValue",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],D.prototype,"onSelectCallback",void 0);D=__decorate([s.Component({selector:"status-filter-dropdown",template:`<se-select class="perso-filter" (click)="$event.stopPropagation()" [(model)]="selectedId" [onChange]="onChange" [fetchStrategy]="fetchStrategy" [searchEnabled]="false"></se-select>`}),__metadata("design:paramtypes",[p.PersonalizationsmarteditUtils])],D);window.__smartedit__.addDecoratorPayload("Component","CatalogVersionFilterItemPrinterComponent",{selector:"catalog-version-filter-item-printer",template:`\n        <div>\n            <span\n                class="perso__globe-icon sap-icon--globe"\n                *ngIf="data.item.isCurrentCatalog === false"\n            >\n            </span>\n            <span *ngIf="data.item.isCurrentCatalog === false">\n                {{ data.item.catalogName }} - {{ data.item.catalogVersionId }}\n            </span>\n            <span\n                *ngIf="data.item.isCurrentCatalog === true"\n                [translate]="'personalization.filter.catalog.current'"\n            ></span>\n        </div>\n    `});let k=class CatalogVersionFilterItemPrinterComponent{constructor(e){this.data=e}};k=__decorate([s.Component({selector:"catalog-version-filter-item-printer",template:`\n        <div>\n            <span\n                class="perso__globe-icon sap-icon--globe"\n                *ngIf="data.item.isCurrentCatalog === false"\n            >\n            </span>\n            <span *ngIf="data.item.isCurrentCatalog === false">\n                {{ data.item.catalogName }} - {{ data.item.catalogVersionId }}\n            </span>\n            <span\n                *ngIf="data.item.isCurrentCatalog === true"\n                [translate]="'personalization.filter.catalog.current'"\n            ></span>\n        </div>\n    `}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],k);window.__smartedit__.addDecoratorPayload("Component","CatalogVersionFilterDropdownComponent",{selector:"catalog-version-filter-dropdown",template:`\n        <se-select\n            class="perso-filter"\n            (click)="$event.stopPropagation()"\n            [(model)]="selectedId"\n            [onChange]="onChange"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [searchEnabled]="false"\n        ></se-select>\n    `,providers:[m.L10nPipe]});let F=class CatalogVersionFilterDropdownComponent{constructor(e,t,o){this.componentMenuService=e;this.personalizationsmarteditContextService=t;this.l10nPipe=o;this.onSelectCallback=new s.EventEmitter;this.itemComponent=k;this.onChange=this.onChange.bind(this);this.fetchStrategy={fetchAll:()=>Promise.resolve(this.items)}}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.items=yield this.componentMenuService.getValidContentCatalogVersions();const e=this.personalizationsmarteditContextService.getSeData().seExperienceData;this.items.forEach((t=>__awaiter(this,void 0,void 0,(function*(){t.isCurrentCatalog=t.id===e.catalogDescriptor.catalogVersionUuid;t.catalogName=yield this.l10nPipe.transform(t.catalogName).pipe(S.take(1)).toPromise()}))));const t=yield this.componentMenuService.getInitialCatalogVersion(this.items);this.selectedId=this.initialValue||t.id}))}onChange(e){this.onSelectCallback.emit(this.selectedId)}};__decorate([s.Input(),__metadata("design:type",String)],F.prototype,"initialValue",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],F.prototype,"onSelectCallback",void 0);F=__decorate([s.Component({selector:"catalog-version-filter-dropdown",template:`\n        <se-select\n            class="perso-filter"\n            (click)="$event.stopPropagation()"\n            [(model)]="selectedId"\n            [onChange]="onChange"\n            [fetchStrategy]="fetchStrategy"\n            [itemComponent]="itemComponent"\n            [searchEnabled]="false"\n        ></se-select>\n    `,providers:[m.L10nPipe]}),__param(0,s.Inject("componentMenuService")),__param(1,s.Inject(t.PersonalizationsmarteditContextService)),__metadata("design:paramtypes",[m.ComponentMenuService,t.PersonalizationsmarteditContextService,m.L10nPipe])],F);window.__smartedit__.addDecoratorPayload("Component","HasMulticatalogComponent",{selector:"has-multicatalog",template:`\n        <div *ngIf="hasMulticatalog">\n            <ng-content></ng-content>\n        </div>\n    `});let V=class HasMulticatalogComponent{constructor(e){this.personalizationsmarteditContextService=e}ngOnInit(){this.hasMulticatalog=this.getSeExperienceData().siteDescriptor.contentCatalogs.length>1}getSeExperienceData(){return this.personalizationsmarteditContextService.getSeData().seExperienceData}};V=__decorate([s.Component({selector:"has-multicatalog",template:`\n        <div *ngIf="hasMulticatalog">\n            <ng-content></ng-content>\n        </div>\n    `}),__param(0,s.Inject(t.PersonalizationsmarteditContextService)),__metadata("design:paramtypes",[t.PersonalizationsmarteditContextService])],V);let U=class PersonalizationsmarteditSharedComponentsModule{};U=__decorate([s.NgModule({imports:[u.CommonModule,m.TranslationModule.forChild(),m.SelectModule],declarations:[V,F,k,D,x,O],entryComponents:[V,F,k,D,x,O],exports:[V,F,k,D,x,O],providers:[]})],U);let $=class CustomizationDataFactory{constructor(e,t){this.personalizationsmarteditRestService=e;this.personalizationsmarteditUtils=t;this.items=[];this.defaultFilter={};this.defaultDataArrayName="customizations"}getCustomizations(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.personalizationsmarteditRestService.getCustomizations(e);this.personalizationsmarteditUtils.uniqueArray(this.items,t[this.defaultDataArrayName]||[]);this.defaultSuccessCallbackFunction(t)}catch(e){this.defaultErrorCallbackFunction(e)}}))}updateData(e,t,o){e=e||{};this.defaultFilter=e.filter||this.defaultFilter;this.defaultDataArrayName=e.dataArrayName||this.defaultDataArrayName;if(t&&typeof t==="function"){this.defaultSuccessCallbackFunction=t}if(o&&typeof o==="function"){this.defaultErrorCallbackFunction=o}this.getCustomizations(this.defaultFilter)}refreshData(){if(this.defaultFilter==={}){return}const e=d.cloneDeep(this.defaultFilter);e.currentSize=this.items.length;e.currentPage=0;this.resetData();this.getCustomizations(e)}resetData(){this.items.length=0}};$.$inject=["personalizationsmarteditRestService","personalizationsmarteditUtils"];$=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditUtils])],$);let K=class PersonalizationsmarteditDataFactoryModule{};K=__decorate([s.NgModule({imports:[u.CommonModule,t.SePersonalizationsmarteditServicesModule],providers:[$]})],K);t.CombinedViewModule=class CombinedViewModule{};t.CombinedViewModule=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),u.CommonModule,m.SelectModule,m.TooltipModule,m.HelpModule,p.PersonalizationsmarteditCommonsComponentsModule,K,t.SePersonalizationsmarteditServicesModule,U],providers:[t.CombinedViewCommonsService,T],declarations:[A,P,t.CombinedViewMenuComponent],entryComponents:[A,P,t.CombinedViewMenuComponent]})],t.CombinedViewModule);window.__smartedit__.addDecoratorPayload("Component","ContextMenuDeleteActionComponent",{selector:"context-menu-delete-action",template:`<div id="confirmationModalDescription">\n        {{ 'personalization.modal.deleteaction.content' | translate }}\n    </div>`});let Y=class ContextMenuDeleteActionComponent{};Y=__decorate([s.Component({selector:"context-menu-delete-action",template:`<div id="confirmationModalDescription">\n        {{ 'personalization.modal.deleteaction.content' | translate }}\n    </div>`})],Y);window.__smartedit__.addDecoratorPayload("Component","ComponentDropdownItemPrinterComponent",{selector:"component-item-printer",template:`\n        <div class="pe-customize-component__se-select-choices-layout">\n            <div class="pe-customize-component__se-select-choices-col1">\n                <div class="perso-wrap-ellipsis" title="{{ data.item.name }}">\n                    {{ data.item.name }}\n                </div>\n            </div>\n            <div class="pe-customize-component__se-select-choices-col2">\n                <div class="perso-wrap-ellipsis" title="{{ data.item.typeCode }}">\n                    {{ data.item.typeCode }}\n                </div>\n            </div>\n        </div>\n    `});let X=class ComponentDropdownItemPrinterComponent{constructor(e){this.data=e}};X=__decorate([s.Component({selector:"component-item-printer",template:`\n        <div class="pe-customize-component__se-select-choices-layout">\n            <div class="pe-customize-component__se-select-choices-col1">\n                <div class="perso-wrap-ellipsis" title="{{ data.item.name }}">\n                    {{ data.item.name }}\n                </div>\n            </div>\n            <div class="pe-customize-component__se-select-choices-col2">\n                <div class="perso-wrap-ellipsis" title="{{ data.item.typeCode }}">\n                    {{ data.item.typeCode }}\n                </div>\n            </div>\n        </div>\n    `}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],X);window.__smartedit__.addDecoratorPayload("Component","PersonalizationsmarteditContextMenuAddEditActionComponent",{template:`<div class="perso-customize-component"><div class="perso-customize-component__title-layout"><div *ngIf="letterIndicatorForElement" class="perso-customize-component__title-layout__letter-block"><span [ngClass]="colorIndicatorForElement">{{letterIndicatorForElement}}</span></div><div class="perso-customize-component__title-layout__cust-name perso-wrap-ellipsis" title="{{selectedCustomization.name}}">{{selectedCustomization.name}}</div><div class="perso-customize-component__title-layout__target-group-name perso-wrap-ellipsis" title="{{selectedVariation.name}}">{{'> '+ selectedVariation.name}}</div></div><dl class="perso-customize-component__data-list"><label class="fd-form__label" [translate]="'personalization.modal.addeditaction.selected.mastercomponent.title'"></label><dd>{{componentType}}</dd></dl><label class="fd-form__label se-control-label required" [translate]="'personalization.modal.addeditaction.selected.actions.title'"></label><fd-inline-help [inlineHelpIconStyle]="{'margin-left': '10px', 'padding-top': '1px'}" [inlineHelpContentStyle]="{'box-shadow': '0 0 4px 0 #d9d9d9', 'border': '1px solid #d9d9d9', 'border-radius': '4px', 'color': '#32363a', 'font-size': '14px', 'max-width': '200px', 'white-space': 'normal'}" [placement]="'top-start'"><span [translate]="'personalization.modal.addeditaction.selected.actions.help.label'"></span></fd-inline-help><se-select class="perso-customize-component__select2-container" [placeholder]="'personalization.modal.addeditaction.dropdown.placeholder'" [(model)]="actionSelected" [searchEnabled]="false" [showRemoveButton]="false" [fetchStrategy]="actionFetchStrategy"></se-select><div class="perso-customize-component__select-group-label-layout"><div *ngIf="actionSelected == 'use'"><label class="fd-form__label se-control-label required" [translate]="'personalization.modal.addeditaction.selected.component.title'"></label></div><has-multicatalog *ngIf="actionSelected == 'use'"><div class="perso-customize-component__filter-layout"><label class="fd-form__label perso-customize-component__filter-label" [translate]="'personalization.commons.filter.label'"></label><catalog-version-filter-dropdown class="pe-customize-component__catalog-version-filter-dropdown" (onSelectCallback)="catalogVersionFilterChange($event)"></catalog-version-filter-dropdown></div></has-multicatalog></div><se-select class="perso-customize-component__select2-container" *ngIf="actionSelected == 'use'" [placeholder]="'personalization.modal.addeditaction.dropdown.componentlist.placeholder'" [(model)]="idComponentSelected" [onSelect]="componentSelectedEvent" [searchEnabled]="true" [showRemoveButton]="false" [fetchStrategy]="componentsFetchStrategy" [itemComponent]="itemComponent"></se-select><se-select class="perso-customize-component__select2-container" *ngIf="actionSelected == 'create'" [placeholder]="'personalization.modal.addeditaction.dropdown.componenttype.placeholder'" [(model)]="newComponentSelected" [onSelect]="newComponentTypeSelectedEvent" [searchEnabled]="false" [fetchStrategy]="componentTypesFetchStrategy"></se-select></div>`});let J=class PersonalizationsmarteditContextMenuAddEditActionComponent{constructor(e,t,o,n,a,r,d){this.modalManager=e;this.translateService=t;this.personalizationsmarteditRestService=o;this.personalizationsmarteditMessageHandler=n;this.personalizationsmarteditContextService=a;this.slotRestrictionsService=r;this.editorModalService=d;this.actionSelected="";this.idComponentSelected="";this.selectedCustomization={};this.selectedVariation={};this.newComponentSelected="";this.componentSelected={};this.actionCreated=new s.EventEmitter;this.itemComponent=X;this.modalButtons=[{id:"submit",style:m.ModalButtonStyle.Primary,label:"personalization.modal.addeditaction.button.submit",action:m.ModalButtonAction.Close,disabledFn:()=>!Boolean(this.idComponentSelected)||Boolean(this.componentUuid)&&this.componentUuid===this.idComponentSelected,callback:()=>{this.idComponentSelected=undefined;const e=this.componentSelected.catalogVersion.substring(0,this.componentSelected.catalogVersion.indexOf("/"));const t={catalog:this.selectedCustomization.catalog,catalogVersion:this.selectedCustomization.catalogVersion};const o={slotCatalog:this.slotCatalog,oldComponentCatalog:this.componentCatalog};Object.assign(o,t);if(this.editEnabled){this.editAction(this.selectedCustomization.code,this.selectedVariation.code,this.actionId,this.componentSelected.uid,e,t)}else{this.personalizationsmarteditRestService.replaceComponentWithContainer(this.defaultComponentId,this.slotId,o).then((o=>{this.addActionToContainer(this.componentSelected.uid,e,o.sourceId,this.selectedCustomization.code,this.selectedVariation.code,t)}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.replacingcomponent"))}))}return this.actionCreated}},{id:"cancel",label:"personalization.modal.addeditaction.button.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.Dismiss}];this.initNewComponentTypes=()=>this.slotRestrictionsService.getSlotRestrictions(this.slotId).then((e=>this.personalizationsmarteditRestService.getNewComponentTypes().then((t=>{this.newComponentTypes=t.componentTypes.filter((t=>e.indexOf(t.code)>-1)).map((e=>{e.id=e.code;return e}));return this.newComponentTypes}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcomponentstypes"))}))),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingslotrestrictions"))}));this.getAndSetComponentById=e=>{this.personalizationsmarteditRestService.getComponent(e).then((e=>{this.idComponentSelected=e.uuid}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcomponents"))}))};this.getAndSetColorAndLetter=()=>{const e=this.personalizationsmarteditContextService.getCombinedView();if(e.enabled){(e.selectedItems||[]).forEach(((e,t)=>{let o=this.selectedCustomizationCode===e.customization.code;o=o&&this.selectedVariationCode===e.variation.code;const n=t%Object.keys(p.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;if(o){this.letterIndicatorForElement=String.fromCharCode("a".charCodeAt(0)+n).toUpperCase();this.colorIndicatorForElement=p.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING[n].listClass}}))}};this.componentSelectedEvent=e=>{if(!e){return}this.componentSelected=e;this.idComponentSelected=e.uuid};this.newComponentTypeSelectedEvent=e=>{if(!e){return}const t={smarteditComponentType:e.code,catalogVersionUuid:this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext.catalogVersionUuid};this.editorModalService.open(t).then((e=>{this.actionSelected=this.actions.filter((e=>e.id==="use"))[0].id;this.idComponentSelected=e.uuid;this.componentSelected=e}),(()=>{this.newComponentSelected=""}))};this.editAction=(e,t,o,n,s,a)=>{this.personalizationsmarteditRestService.editAction(e,t,o,n,s,a).then((()=>{this.personalizationsmarteditMessageHandler.sendSuccess(this.translateService.instant("personalization.info.updatingaction"));this.actionCreated.emit()}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.updatingaction"));this.actionCreated.emit()}))};this.addActionToContainer=(e,t,o,n,s,a)=>{this.personalizationsmarteditRestService.addActionToContainer(e,t,o,n,s,a).then((()=>{this.personalizationsmarteditMessageHandler.sendSuccess(this.translateService.instant("personalization.info.creatingaction"));this.actionCreated.emit(o)}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.creatingaction"));this.actionCreated.emit()}))};this.catalogVersionFilterChange=e=>{if(!e){return}const t=e.split("/");this.catalogFilter=t[0];this.catalogVersionFilter=t[1]};this.components=[];this.modalManager.addButton(this.modalButtons[0]);this.modalManager.addButton(this.modalButtons[1]);this.actionFetchStrategy={fetchAll:()=>Promise.resolve(this.actions)};this.componentsFetchStrategy={fetchPage:(e,t,o)=>this.componentTypesFetchStrategy.fetchAll().then((t=>{const n=t.map((e=>e.code)).join(",");const s={currentPage:o,mask:e,pageSize:30,sort:"name",catalog:this.catalogFilter,catalogVersion:this.catalogVersionFilter,typeCodes:n};return this.personalizationsmarteditRestService.getComponents(s).then((e=>{const t=e.response.filter((e=>!e.restricted));return Promise.resolve({results:t,pagination:e.pagination})}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcomponents"));return Promise.reject()}))})),fetchEntity:e=>this.personalizationsmarteditRestService.getComponent(e).then((e=>Promise.resolve({id:e.uuid,name:e.name,typeCode:e.typeCode})))};this.componentTypesFetchStrategy={fetchAll:()=>{if(this.newComponentTypes){return Promise.resolve(this.newComponentTypes)}else{return this.initNewComponentTypes()}}}}get modalData(){return this.modalManager.getModalData()}ngOnInit(){this.init()}init(){this.actions=[{id:"create",name:this.translateService.instant("personalization.modal.addeditaction.createnewcomponent")},{id:"use",name:this.translateService.instant("personalization.modal.addeditaction.usecomponent")}];this.modalData.subscribe((e=>{this.colorIndicatorForElement=e.colorIndicatorForElement;this.slotId=e.slotId;this.actionId=e.actionId;this.componentUuid=e.componentUuid;this.defaultComponentId=e.componentId;this.editEnabled=e.editEnabled;this.slotCatalog=e.slotCatalog;this.componentCatalog=e.componentCatalog;this.selectedCustomizationCode=e.selectedCustomizationCode;this.selectedVariationCode=e.selectedVariationCode;this.componentType=e.componentType;this.personalizationsmarteditRestService.getCustomization({code:this.selectedCustomizationCode}).then((e=>{this.selectedCustomization=e;this.selectedVariation=e.variations.filter((e=>e.code===this.selectedVariationCode))[0]}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomization"))}));if(this.editEnabled){this.getAndSetComponentById(this.componentUuid);this.actionSelected=this.actions.filter((e=>e.id==="use"))[0].id}else{this.actionSelected=""}}));this.initNewComponentTypes();this.getAndSetColorAndLetter()}};J=__decorate([s.Component({template:`<div class="perso-customize-component"><div class="perso-customize-component__title-layout"><div *ngIf="letterIndicatorForElement" class="perso-customize-component__title-layout__letter-block"><span [ngClass]="colorIndicatorForElement">{{letterIndicatorForElement}}</span></div><div class="perso-customize-component__title-layout__cust-name perso-wrap-ellipsis" title="{{selectedCustomization.name}}">{{selectedCustomization.name}}</div><div class="perso-customize-component__title-layout__target-group-name perso-wrap-ellipsis" title="{{selectedVariation.name}}">{{'> '+ selectedVariation.name}}</div></div><dl class="perso-customize-component__data-list"><label class="fd-form__label" [translate]="'personalization.modal.addeditaction.selected.mastercomponent.title'"></label><dd>{{componentType}}</dd></dl><label class="fd-form__label se-control-label required" [translate]="'personalization.modal.addeditaction.selected.actions.title'"></label><fd-inline-help [inlineHelpIconStyle]="{'margin-left': '10px', 'padding-top': '1px'}" [inlineHelpContentStyle]="{'box-shadow': '0 0 4px 0 #d9d9d9', 'border': '1px solid #d9d9d9', 'border-radius': '4px', 'color': '#32363a', 'font-size': '14px', 'max-width': '200px', 'white-space': 'normal'}" [placement]="'top-start'"><span [translate]="'personalization.modal.addeditaction.selected.actions.help.label'"></span></fd-inline-help><se-select class="perso-customize-component__select2-container" [placeholder]="'personalization.modal.addeditaction.dropdown.placeholder'" [(model)]="actionSelected" [searchEnabled]="false" [showRemoveButton]="false" [fetchStrategy]="actionFetchStrategy"></se-select><div class="perso-customize-component__select-group-label-layout"><div *ngIf="actionSelected == 'use'"><label class="fd-form__label se-control-label required" [translate]="'personalization.modal.addeditaction.selected.component.title'"></label></div><has-multicatalog *ngIf="actionSelected == 'use'"><div class="perso-customize-component__filter-layout"><label class="fd-form__label perso-customize-component__filter-label" [translate]="'personalization.commons.filter.label'"></label><catalog-version-filter-dropdown class="pe-customize-component__catalog-version-filter-dropdown" (onSelectCallback)="catalogVersionFilterChange($event)"></catalog-version-filter-dropdown></div></has-multicatalog></div><se-select class="perso-customize-component__select2-container" *ngIf="actionSelected == 'use'" [placeholder]="'personalization.modal.addeditaction.dropdown.componentlist.placeholder'" [(model)]="idComponentSelected" [onSelect]="componentSelectedEvent" [searchEnabled]="true" [showRemoveButton]="false" [fetchStrategy]="componentsFetchStrategy" [itemComponent]="itemComponent"></se-select><se-select class="perso-customize-component__select2-container" *ngIf="actionSelected == 'create'" [placeholder]="'personalization.modal.addeditaction.dropdown.componenttype.placeholder'" [(model)]="newComponentSelected" [onSelect]="newComponentTypeSelectedEvent" [searchEnabled]="false" [fetchStrategy]="componentTypesFetchStrategy"></se-select></div>`}),__param(0,s.Inject(m.ModalManagerService)),__param(1,s.Inject(v.TranslateService)),__param(2,s.Inject(t.PersonalizationsmarteditRestService)),__param(3,s.Inject(p.PersonalizationsmarteditMessageHandler)),__param(4,s.Inject(t.PersonalizationsmarteditContextService)),__param(5,s.Inject(m.ISlotRestrictionsService)),__param(6,s.Inject("editorModalService")),__metadata("design:paramtypes",[m.ModalManagerService,v.TranslateService,t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditMessageHandler,t.PersonalizationsmarteditContextService,m.ISlotRestrictionsService,Object])],J);const ee=[{id:"confirmOk",label:"personalization.modal.deleteaction.button.ok",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.Close},{id:"confirmCancel",label:"personalization.modal.deleteaction.button.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.Dismiss}];t.PersonalizationsmarteditContextMenuServiceProxy=class PersonalizationsmarteditContextMenuServiceProxy extends p.IPersonalizationsmarteditContextMenuServiceProxy{constructor(e,t,o,n,s,a,r,d){super();this.modalService=e;this.renderService=t;this.editorModalService=o;this.personalizationsmarteditContextService=n;this.personalizationsmarteditRestService=s;this.personalizationsmarteditMessageHandler=a;this.translateService=r;this.logService=d}openDeleteAction(e){return __awaiter(this,void 0,void 0,(function*(){if(!(yield this.confirmDelete())){return}yield this.deleteContext(e);const t=this.personalizationsmarteditContextService.getCombinedView();if(t.enabled){try{const o=yield this.personalizationsmarteditRestService.getActions(e.selectedCustomizationCode,e.selectedVariationCode,e);if(t.customize.selectedComponents){t.customize.selectedComponents=this.removeItemFromCollection(t.customize.selectedComponents,e.containerSourceId)}t.selectedItems=this.addActionsToVariation(t.selectedItems,e,o.actions);this.personalizationsmarteditContextService.setCombinedView(t)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingactions"))}}else{const t=this.personalizationsmarteditContextService.getCustomize();t.selectedComponents=this.removeItemFromCollection(t.selectedComponents,e.containerSourceId);this.personalizationsmarteditContextService.setCustomize(t)}this.renderService.renderSlots(e.slotsToRefresh)}))}openAddAction(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.modalService.open({component:J,data:e,templateConfig:{title:"personalization.modal.addaction.title",isDismissButtonVisible:true},config:{focusTrapped:false,backdropClickCloseable:false,modalPanelClass:"yPersonalizationContextModal"}}).afterClosed.toPromise();const o=this.personalizationsmarteditContextService.getCombinedView();if(o.enabled){o.customize.selectedComponents.push(t);this.personalizationsmarteditContextService.setCombinedView(o)}else{const e=this.personalizationsmarteditContextService.getCustomize();e.selectedComponents.push(t);this.personalizationsmarteditContextService.setCustomize(e)}this.renderService.renderSlots(e.slotsToRefresh)}))}openEditAction(e){return __awaiter(this,void 0,void 0,(function*(){e.editEnabled=true;yield this.modalService.open({component:J,data:e,templateConfig:{title:"personalization.modal.editaction.title",isDismissButtonVisible:true},config:{focusTrapped:false,backdropClickCloseable:false,modalPanelClass:"yPersonalizationContextModal"}}).afterClosed.toPromise();this.renderService.renderSlots(e.slotsToRefresh)}))}openEditComponentAction(e){this.editorModalService.open(e)}deleteContext(e){return __awaiter(this,void 0,void 0,(function*(){const t={catalog:e.catalog,catalogVersion:e.catalogVersion};try{yield this.personalizationsmarteditRestService.deleteAction(e.selectedCustomizationCode,e.selectedVariationCode,e.actionId,t)}catch(e){this.logService.error("An error occurred while deleting context",e)}}))}removeItemFromCollection(e,t){return e.filter((e=>e!==t))}addActionsToVariation(e,t,o){return e.map((e=>{if(e.customization.code===t.selectedCustomizationCode&&e.variation.code===t.selectedVariationCode){e.variation.actions=o}return e}))}confirmDelete(){return __awaiter(this,void 0,void 0,(function*(){try{yield this.modalService.open({component:Y,config:{modalPanelClass:"yFrontModal modal-md"},templateConfig:{buttons:ee,title:"personalization.modal.deleteaction.title"}}).afterClosed.toPromise();return true}catch(e){return false}}))}};t.PersonalizationsmarteditContextMenuServiceProxy.$inject=["modalService","renderService","editorModalService","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","translateService","logService"];t.PersonalizationsmarteditContextMenuServiceProxy=__decorate([m.GatewayProxied("openDeleteAction","openAddAction","openEditAction","openEditComponentAction"),m.SeDowngradeService(p.IPersonalizationsmarteditContextMenuServiceProxy),__metadata("design:paramtypes",[m.IModalService,m.IRenderService,m.IEditorModalService,t.PersonalizationsmarteditContextService,t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditMessageHandler,v.TranslateService,m.LogService])],t.PersonalizationsmarteditContextMenuServiceProxy);let te=class PersonalizationsmarteditContextMenuModule{};te=__decorate([s.NgModule({imports:[u.CommonModule,m.TranslationModule.forChild(),m.SharedComponentsModule,C.InlineHelpModule,m.SelectModule,m.TooltipModule,U],declarations:[J,X,Y],entryComponents:[J,X,Y],exports:[J,X]})],te);t.CustomizeViewServiceProxy=class CustomizeViewServiceProxy{getSourceContainersInfo(){"proxyFunction";return null}};t.CustomizeViewServiceProxy=__decorate([m.SeDowngradeService(),m.GatewayProxied("getSourceContainersInfo")],t.CustomizeViewServiceProxy);const ie={name:"",enabledStartDate:"",enabledEndDate:"",status:p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,statusBoolean:true,variations:[],catalog:"",catalogVersion:"",code:"",rank:null};const oe={customization:ie,visibleVariations:[]};t.CustomizationViewService=class CustomizationViewService{constructor(e){this.persoUtils=e;this.editVariationActionSubject=new f.BehaviorSubject(undefined);this.stateSubject=new f.BehaviorSubject(oe)}getState$(){return this.stateSubject.asObservable()}getState(){return this.stateSubject.getValue()}setState(e){this.stateSubject.next(e)}addVariation(e){const t=this.selectCustomization();const o=[...t.variations,e];this.setVariations(o)}setVariations(e){const t=this.selectCustomization();t.variations=e.map(((e,t)=>{e.rank=t;return e}));this.setState(this.prepareState(t))}setCustomization(e){this.setState(this.prepareState(e))}getCustomization$(){return this.getState$().pipe(S.map((e=>e.customization)))}editVariationAction(e){this.editVariationActionSubject.next(e)}editVariationAction$(){return this.editVariationActionSubject.asObservable()}selectCustomization(){return this.getState().customization}selectVisibleVariations(){return this.getState().visibleVariations}selectVariationByCode(e){return this.getState().customization.variations.find((t=>t.code===e))}prepareState(e){return{customization:e,visibleVariations:this.persoUtils.getVisibleItems(e.variations)}}};t.CustomizationViewService.$inject=["persoUtils"];t.CustomizationViewService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[p.PersonalizationsmarteditUtils])],t.CustomizationViewService);window.__smartedit__.addDecoratorPayload("Component","BasicInfoTabComponent",{selector:"basic-info-tab",template:`<div class="pe-customization-modal" *ngIf="(customization$ | async) as customization"><form><div class="fd-form__item"><label for="customization-name" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.name" class="fd-form__label se-control-label required"></label> <input type="text" class="fd-form__control" [placeholder]="'personalization.modal.customizationvariationmanagement.basicinformationtab.name.placeholder' | translate" [name]="customization.name + '_key'" [ngModel]="customization.name" (ngModelChange)="changeName($event)" required id="customization-name"/></div><div class="fd-form__item"><label for="customization-description" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details" class="se-control-label fd-form__label"></label> <textarea rows="2" class="fd-form__control pe-customization-modal__textarea" [placeholder]="'personalization.modal.customizationvariationmanagement.basicinformationtab.details.placeholder' | translate" [name]="customization.description + '_key'" [ngModel]="customization.description" (ngModelChange)="changeDescription($event)" id="customization-description"></textarea></div><div class="fd-form__item fd-has-padding-bottom-tiny"><label for="customization-status" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.status" class="se-control-label fd-form__label"></label><div class="fd-form__item fd-form__item--check"><label class="fd-form__label" for="test-checkbox" id="customization-status"><span class="fd-toggle fd-toggle--s fd-form__control"><input type="checkbox" name="status-config-toggle" id="test-checkbox" [ngModel]="customization.statusBoolean" (ngModelChange)="toggleCustomizationStatus($event)"/> <span class="fd-toggle__switch" role="presentation"></span></span></label></div></div><div class="fd-form__item"><div><button *ngIf="!datetimeConfigurationEnabled" class="se-button--text se-button--link fd-link" (click)="toggleDatetimeConfiguration()" type="button" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.showdateconfigdata"></button> <button *ngIf="datetimeConfigurationEnabled" class="se-button--text se-button--link fd-link" (click)="toggleDatetimeConfiguration(true)" type="button" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.hidedateconfigdata"></button></div><div translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.statusfortimeframe.description" class="fd-has-padding-top-tiny"></div></div><div class="fd-form__item"><div *ngIf="datetimeConfigurationEnabled"><div class="row pe-customization-modal__dates-group"><datetime-picker-range [dateFrom]="customization.enabledStartDate" [dateTo]="customization.enabledEndDate" [isEditable]="true" (dateFromChange)="onEnabledStartDateChange($event)" (dateToChange)="onEnabledEndDateChange($event)"></datetime-picker-range></div></div></div></form></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});t.BasicInfoTabComponent=class BasicInfoTabComponent{constructor(e,t){this.customizationViewService=e;this.cdr=t;this.datetimeConfigurationEnabled=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.customization$=this.customizationViewService.getCustomization$();const e=yield this.customizationViewService.getCustomization$().pipe(S.take(1)).toPromise();this.datetimeConfigurationEnabled=!!e.enabledStartDate||!!e.enabledEndDate;this.cdr.detectChanges()}))}changeName(e){const t=this.customizationViewService.selectCustomization();this.customizationViewService.setCustomization(Object.assign(Object.assign({},t),{name:e}))}changeDescription(e){const t=this.customizationViewService.selectCustomization();this.customizationViewService.setCustomization(Object.assign(Object.assign({},t),{description:e}))}toggleDatetimeConfiguration(e=false){this.datetimeConfigurationEnabled=!this.datetimeConfigurationEnabled;if(e){this.resetDatetimeConfiguration()}}toggleCustomizationStatus(e){const t=this.customizationViewService.selectCustomization();this.customizationViewService.setCustomization(Object.assign(Object.assign({},t),{statusBoolean:e,status:e?p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:p.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED}))}onEnabledStartDateChange(e){const t=this.customizationViewService.selectCustomization();this.customizationViewService.setCustomization(Object.assign(Object.assign({},t),{enabledStartDate:e}))}onEnabledEndDateChange(e){const t=this.customizationViewService.selectCustomization();this.customizationViewService.setCustomization(Object.assign(Object.assign({},t),{enabledEndDate:e}))}resetDatetimeConfiguration(){const e=this.customizationViewService.selectCustomization();this.customizationViewService.setCustomization(Object.assign(Object.assign({},e),{enabledStartDate:undefined,enabledEndDate:undefined}))}};t.BasicInfoTabComponent=__decorate([s.Component({selector:"basic-info-tab",template:`<div class="pe-customization-modal" *ngIf="(customization$ | async) as customization"><form><div class="fd-form__item"><label for="customization-name" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.name" class="fd-form__label se-control-label required"></label> <input type="text" class="fd-form__control" [placeholder]="'personalization.modal.customizationvariationmanagement.basicinformationtab.name.placeholder' | translate" [name]="customization.name + '_key'" [ngModel]="customization.name" (ngModelChange)="changeName($event)" required id="customization-name"/></div><div class="fd-form__item"><label for="customization-description" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details" class="se-control-label fd-form__label"></label> <textarea rows="2" class="fd-form__control pe-customization-modal__textarea" [placeholder]="'personalization.modal.customizationvariationmanagement.basicinformationtab.details.placeholder' | translate" [name]="customization.description + '_key'" [ngModel]="customization.description" (ngModelChange)="changeDescription($event)" id="customization-description"></textarea></div><div class="fd-form__item fd-has-padding-bottom-tiny"><label for="customization-status" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.status" class="se-control-label fd-form__label"></label><div class="fd-form__item fd-form__item--check"><label class="fd-form__label" for="test-checkbox" id="customization-status"><span class="fd-toggle fd-toggle--s fd-form__control"><input type="checkbox" name="status-config-toggle" id="test-checkbox" [ngModel]="customization.statusBoolean" (ngModelChange)="toggleCustomizationStatus($event)"/> <span class="fd-toggle__switch" role="presentation"></span></span></label></div></div><div class="fd-form__item"><div><button *ngIf="!datetimeConfigurationEnabled" class="se-button--text se-button--link fd-link" (click)="toggleDatetimeConfiguration()" type="button" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.showdateconfigdata"></button> <button *ngIf="datetimeConfigurationEnabled" class="se-button--text se-button--link fd-link" (click)="toggleDatetimeConfiguration(true)" type="button" translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.hidedateconfigdata"></button></div><div translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.statusfortimeframe.description" class="fd-has-padding-top-tiny"></div></div><div class="fd-form__item"><div *ngIf="datetimeConfigurationEnabled"><div class="row pe-customization-modal__dates-group"><datetime-picker-range [dateFrom]="customization.enabledStartDate" [dateTo]="customization.enabledEndDate" [isEditable]="true" (dateFromChange)="onEnabledStartDateChange($event)" (dateToChange)="onEnabledEndDateChange($event)"></datetime-picker-range></div></div></div></form></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[t.CustomizationViewService,s.ChangeDetectorRef])],t.BasicInfoTabComponent);let ne=class ModalFullScreenButtonService{constructor(e){this.className="sliderPanelParentModal";this.renderer=e.createRenderer(null,null)}toggleClassOnCustomizationModal(e,t,o){const n=this.findModal(e);if(!n){return}if(o){this.renderer.addClass(n,t)}else{this.renderer.removeClass(n,t)}}findModal(e){return e.closest(`.${this.className}`)}};ne.$inject=["rendererFactory"];ne=__decorate([s.Injectable(),__metadata("design:paramtypes",[s.RendererFactory2])],ne);window.__smartedit__.addDecoratorPayload("Component","ModalFullScreenButtonComponent",{selector:"perso-modal-full-screen-button",template:`<button class="fd-button--light pe-customization-modal__sliderpanel__btn-link" (click)="toggle()"><fd-icon class="icon_padding_end" *ngIf="!isFullscreen" glyph="full-screen"></fd-icon><fd-icon class="icon_padding_end" *ngIf="isFullscreen" glyph="exitfullscreen"></fd-icon>{{(isFullscreen ? 'personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.close' : 'personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.open') | translate}}</button>`,changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[ne]});let se=class ModalFullScreenButtonComponent{constructor(e,t){this.element=e;this.modalFullScreenButtonService=t;this.isFullscreen=false}toggle(e){this.isFullscreen=typeof e==="undefined"?!this.isFullscreen:e;this.modalFullScreenButtonService.toggleClassOnCustomizationModal(this.element.nativeElement,"modal-fullscreen",this.isFullscreen)}};se=__decorate([s.Component({selector:"perso-modal-full-screen-button",template:`<button class="fd-button--light pe-customization-modal__sliderpanel__btn-link" (click)="toggle()"><fd-icon class="icon_padding_end" *ngIf="!isFullscreen" glyph="full-screen"></fd-icon><fd-icon class="icon_padding_end" *ngIf="isFullscreen" glyph="exitfullscreen"></fd-icon>{{(isFullscreen ? 'personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.close' : 'personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.open') | translate}}</button>`,changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[ne]}),__metadata("design:paramtypes",[s.ElementRef,ne])],se);let ae=class ModalFullScreenButtonModule{};ae=__decorate([s.NgModule({imports:[C.FundamentalNgxCoreModule,u.CommonModule,m.TranslationModule.forChild()],providers:[ne],declarations:[se],exports:[se]})],ae);window.__smartedit__.addDecoratorPayload("Component","EditVariationItemComponent",{selector:"perso-edit-variation-item",template:`\n        <a\n            (click)="editVariation()"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.edit"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});let re=class EditVariationItemComponent{constructor(e,t){this.customizationViewService=t;({selectedItem:this.selectedItem}=e)}editVariation(){this.customizationViewService.editVariationAction(this.selectedItem.variation)}};re=__decorate([s.Component({selector:"perso-edit-variation-item",template:`\n        <a\n            (click)="editVariation()"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.edit"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,t.CustomizationViewService])],re);t.TriggerService=class TriggerService{constructor(){this.actions=[{id:p.TriggerActionId.AND,name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.and"},{id:p.TriggerActionId.OR,name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.or"},{id:p.TriggerActionId.NOT,name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.not"}];this.supportedTypes=[p.TriggerType.DEFAULT_TRIGGER,p.TriggerType.SEGMENT_TRIGGER,p.TriggerType.EXPRESSION_TRIGGER]}isContainer(e){return this.isElementOfType(e,p.TriggerType.CONTAINER_TYPE)}isEmptyContainer(e){return this.isContainer(e)&&e.nodes.length===0}isNotEmptyContainer(e){return this.isContainer(e)&&e.nodes.length>0}isDropzone(e){return this.isElementOfType(e,p.TriggerType.DROPZONE_TYPE)}isItem(e){return this.isElementOfType(e,p.TriggerType.ITEM_TYPE)}isValidExpression(e){if(!e){return false}if(this.isContainer(e)){return e.nodes&&e.nodes.length>0&&e.nodes.every((e=>this.isValidExpression(e)))}else{return e.selectedSegment!==undefined}}buildTriggers(e,t){let o={};if(this.isDefaultData(e)){o=this.buildDefaultTrigger()}else if(!!(e===null||e===void 0?void 0:e.expression)&&e.expression.length>0){const t=e.expression[0];if(this.isEmptyContainer(t)){o={}}else if(this.isExpressionData(t)){o=this.buildExpressionTrigger(t)}else{o=this.buildSegmentTrigger(t)}}return this.mergeTriggers(t,o)}buildData(e){let t={};let o=this.getBaseData();if(e&&Array.isArray(e)&&e.length>0){t=e.filter((e=>this.isSupportedTrigger(e)))[0]}if(this.isDefaultTrigger(t));else if(this.isExpressionTrigger(t)){o=this.buildExpressionTriggerData(t)}else if(this.isSegmentTrigger(t)){o=this.buildSegmentTriggerData(t)}return o}isDefault(e){const t=(e||[]).filter((e=>this.isDefaultTrigger(e)))[0];return e&&t?true:false}getExpressionAsString(e){let t="";if(e===undefined){return t}const o=this.isNegation(e)?"AND":e.operation.id;t+=this.isNegation(e)?" NOT ":"";t+="(";if(this.isEmptyContainer(e)){t+=" [] "}else{e.nodes.forEach(((e,n)=>{if(this.isEmptyContainer(e)){t+=n>0?" "+o+" ( [] )":"( [] )"}else{t+=n>0?" "+o+" ":"";t+=this.isItem(e)?e.selectedSegment.code:this.getExpressionAsString(e)}}))}t+=")";return t}isElementOfType(e,t){return typeof e!=="undefined"?e.type===t:false}isNegation(e){return this.isContainer(e)&&e.operation.id==="NOT"}isDefaultData(e){return!!(e===null||e===void 0?void 0:e.isDefault)}isExpressionData(e){return e.operation.id===p.TriggerActionId.NOT||e.nodes.some((e=>!this.isItem(e)))}isSupportedTrigger(e){return this.supportedTypes.indexOf(e.type)>=0}isDefaultTrigger(e){return this.isElementOfType(e,p.TriggerType.DEFAULT_TRIGGER)}isSegmentTrigger(e){return this.isElementOfType(e,p.TriggerType.SEGMENT_TRIGGER)}isExpressionTrigger(e){return this.isElementOfType(e,p.TriggerType.EXPRESSION_TRIGGER)}isGroupExpressionData(e){return this.isElementOfType(e,p.TriggerType.GROUP_EXPRESSION)}isSegmentExpressionData(e){return this.isElementOfType(e,p.TriggerType.SEGMENT_EXPRESSION)}isNegationExpressionData(e){return this.isElementOfType(e,p.TriggerType.NEGATION_EXPRESSION)}buildSegmentsForTrigger(e){return e.nodes.filter((e=>this.isItem(e))).map((e=>e.selectedSegment))}buildExpressionForTrigger(e){if(this.isNegation(e)){const t=[];e.nodes.forEach((e=>{t.push(this.buildExpressionForTrigger(e))}));return{type:p.TriggerType.NEGATION_EXPRESSION,element:{type:p.TriggerType.GROUP_EXPRESSION,operator:p.TriggerActionId.AND,elements:t}}}else if(this.isContainer(e)){const t=[];e.nodes.forEach((e=>{t.push(this.buildExpressionForTrigger(e))}));return{type:p.TriggerType.GROUP_EXPRESSION,operator:e.operation.id,elements:t}}else{return{type:p.TriggerType.SEGMENT_EXPRESSION,code:e.selectedSegment.code}}}buildDefaultTrigger(){return{type:p.TriggerType.DEFAULT_TRIGGER}}buildExpressionTrigger(e){return{type:p.TriggerType.EXPRESSION_TRIGGER,expression:this.buildExpressionForTrigger(e)}}buildSegmentTrigger(e){return{type:p.TriggerType.SEGMENT_TRIGGER,groupBy:e.operation.id,segments:this.buildSegmentsForTrigger(e)}}mergeTriggers(e,t){if(typeof e==="undefined"){return[t]}const o=e.findIndex((e=>e.type===t.type));if(o>=0){t.code=e[o].code}const n=e.filter((e=>!this.isSupportedTrigger(e)));n.push(t);return n}buildContainer(e){const t=this.actions.filter((t=>t.id===e))[0];return{type:p.TriggerType.CONTAINER_TYPE,operation:t,nodes:[],uid:m.stringUtils.generateIdentifier()}}buildItem(e){return{type:p.TriggerType.ITEM_TYPE,operation:null,selectedSegment:{code:e},nodes:[],uid:m.stringUtils.generateIdentifier()}}getBaseData(){const e=this.buildContainer(p.TriggerActionId.AND);return[e]}buildExpressionFromTrigger(e){let t;if(this.isGroupExpressionData(e)){t=this.buildContainer(e.operator);t.nodes=e.elements.map((e=>this.buildExpressionFromTrigger(e)))}else if(this.isNegationExpressionData(e)){t=this.buildContainer(p.TriggerActionId.NOT);const o=this.buildExpressionFromTrigger(e.element);if(this.isGroupExpressionData(e.element)&&e.element.operator==="AND"){t.nodes=o.nodes}else{t.nodes.push(o)}}else if(this.isSegmentExpressionData(e)){t=this.buildItem(e.code)}return t}buildSegmentTriggerData(e){const t=this.buildContainer(e.groupBy);e.segments.forEach((e=>{t.nodes.push(this.buildItem(e.code))}));return[t]}buildExpressionTriggerData(e){const t=this.buildExpressionFromTrigger(e.expression);return[t]}};t.TriggerService=__decorate([m.SeDowngradeService()],t.TriggerService);window.__smartedit__.addDecoratorPayload("Component","TargetGroupTabComponent",{selector:"perso-target-group-tab",template:`<div class="pe-customization-modal" *ngIf="customization"><div class="pe-customization-modal__title"><div class="pe-customization-modal__title-header"><div class="pe-customization-modal__title-header-name perso-wrap-ellipsis" [attr.title]="customization.name">{{ customization.name }}</div><div><span class="pe-customization-modal__title-header-badge badge badge-success" [ngClass]="[getActivityStateForCustomization(customization)]">{{'personalization.modal.customizationvariationmanagement.targetgrouptab.customization.' + customization.status | lowercase | translate}}</span></div></div><div class="pe-customization-modal__title-subarea"><div *ngIf="isCustomizationEnabled(customization)" class="pe-customization-modal__title-dates"><span *ngIf="!customization.enabledStartDate && customization.enabledEndDate">...</span> <span [ngClass]="{'perso__datetimepicker--error-text': !persoDateUtils.isDateValidOrEmpty(customization.enabledStartDate)}">{{ customization.enabledStartDate }}</span> <span *ngIf="customization.enabledStartDate || customization.enabledEndDate">- </span><span [ngClass]="{'perso__datetimepicker--error-text':!persoDateUtils.isDateValidOrEmpty(customization.enabledEndDate)}">{{ customization.enabledEndDate }}</span> <span *ngIf="persoDateUtils.isDateInThePast(customization.enabledEndDate)" class="section-help help-inline help-inline--section help-inline--tooltip"><span class="pe-datetime__warning-icon"></span> <span class="pe-help-block--inline help-block-inline help-block-inline--text" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.datetooltip"></span> </span><span *ngIf="customization.enabledStartDate && !customization.enabledEndDate">...</span></div></div></div><div class="pe-customization-modal__y-add-btn"><button class="fd-button" type="button" (click)="showAddVariationPanel()"><span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.addtargetgroup.button"></span></button></div><perso-target-group-variation-list *ngIf="visibleVariations.length > 0" [customization]="customization" [variations]="visibleVariations"></perso-target-group-variation-list><se-slider-panel [sliderPanelConfiguration]="sliderPanelConfiguration" [(sliderPanelHide)]="sliderPanelHide" [(sliderPanelShow)]="sliderPanelShow" class="pe-customization-modal__sliderpanel"><div *ngIf="isVariationLoaded"><div class="pe-customization-modal__sliderpanel__btn-layout"><perso-modal-full-screen-button></perso-modal-full-screen-button></div><form><div class="fd-form-item"><label for="targetgroup-name" class="fd-form__label required" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname"></label> <input type="text" name="variationname_key" id="targetgroup-name" class="fd-form__control" [placeholder]="'personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname.placeholder' | translate" [(ngModel)]="edit.name"/></div><div class="fd-form-item pe-customization-modal--check"><input type="checkbox" name="isDefault" id="targetgroup-isDefault-001" class="fd-form__control fd-checkbox" [(ngModel)]="edit.isDefault" (ngModelChange)="showConfirmForDefaultTrigger($event)"/> <label for="targetgroup-isDefault-001" class="fd-form__control fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></label></div><div *ngIf="edit.showExpression"><segment-view [targetGroupState]="edit" (expressionChange)="onSegmentViewExpressionChange($event)"></segment-view></div></form></div></se-slider-panel></div>`});let le=class TargetGroupTabComponent{constructor(e,t,o,n,s,a,r){this.persoDateUtils=e;this.persoUtils=t;this.persoTriggerService=o;this.confirmationModalService=n;this.customizationViewService=s;this.logService=a;this.cdr=r;this.visibleVariations=[];this.isVariationLoaded=false;this.isFullscreen=false;this.sliderPanelConfiguration={modal:{showDismissButton:true,title:"personalization.modal.customizationvariationmanagement.targetgrouptab.slidingpanel.title",cancel:{label:"personalization.modal.customizationvariationmanagement.targetgrouptab.cancelchanges",onClick:()=>{this.cancelChangesClick()},isDisabledFn:()=>false},dismiss:{onClick:()=>{this.cancelChangesClick()},label:"",isDisabledFn:()=>false},save:{onClick:()=>{},label:"",isDisabledFn:()=>false}},cssSelector:"#y-modal-dialog"};this.edit={code:"",name:"",expression:[],isDefault:false,showExpression:true,selectedVariation:undefined}}ngOnInit(){this.customizationViewStateSubscription=this.customizationViewService.getState$().subscribe((({customization:e,visibleVariations:t})=>{this.customization=e;this.visibleVariations=t;this.cdr.detectChanges()}));this.editVariationSubscription=this.customizationViewService.editVariationAction$().pipe(S.filter((e=>!!e))).subscribe((e=>{setTimeout((()=>{this.showEditVariationPanel(e)}),100)}))}ngOnDestroy(){var e,t;(e=this.editVariationSubscription)===null||e===void 0?void 0:e.unsubscribe();(t=this.customizationViewStateSubscription)===null||t===void 0?void 0:t.unsubscribe()}isCustomizationEnabled(e){return e.status===p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED}getActivityStateForCustomization(e){return this.persoUtils.getActivityStateForCustomization(e)}toggleSliderFullscreen(e){this.modalFullScreenButtonCmp.toggle(e)}onSegmentViewExpressionChange(e){this.edit.expression=e}setVariationRank(e,t,o,n){if(n){o.stopPropagation()}else{let o;if(e.isNew){o=this.customization.variations.findIndex((({tempcode:t})=>t===e.tempcode))}else{o=this.customization.variations.findIndex((({code:t})=>t===e.code))}const n=this.customization.variations[o];const s=this.persoUtils.getValidRank(this.customization.variations,n,t);const a=[...this.customization.variations];if(s>=0&&s<a.length){a.splice(s,0,a.splice(o,1)[0]);this.setVariations(a)}}}showConfirmForDefaultTrigger(e){return __awaiter(this,void 0,void 0,(function*(){if(e&&this.persoTriggerService.isValidExpression(this.edit.expression[0])){try{yield this.confirmationModalService.confirm({description:"personalization.modal.manager.targetgrouptab.defaulttrigger.content"});this.edit.showExpression=false}catch(e){this.edit.isDefault=false}}else{this.edit.showExpression=!e}}))}removeVariation(e){return __awaiter(this,void 0,void 0,(function*(){try{yield this.confirmationModalService.confirm({description:"personalization.modal.manager.targetgrouptab.deletevariation.content"});if(e.isNew){const t=this.customization.variations.filter((t=>t.tempcode!==e.tempcode));this.setVariations(t)}else{e.status=p.PERSONALIZATION_MODEL_STATUS_CODES.DELETED;this.updateVariation(e)}}catch(e){this.logService.log("Remove Variation canceled")}}))}updateVariation(e){const t=this.customization.variations.map((t=>e.isNew&&t.tempcode===e.tempcode||!e.isNew&&t.code===e.code?e:t));this.setVariations(t)}showAddVariationPanel(){this.clearEditedVariationDetails();this.setSliderConfigForAdd();this.sliderPanelShow();this.edit.selectedVariation={triggers:[]};setTimeout((()=>{this.isVariationLoaded=true}),0)}showEditVariationPanel(e){this.setSliderConfigForEditing();this.edit.selectedVariation=e;this.edit.code=e.code;this.edit.name=e.name;this.edit.isDefault=this.persoTriggerService.isDefault(e.triggers);this.edit.showExpression=!this.edit.isDefault;this.isVariationLoaded=true;this.sliderPanelShow()}setSliderConfigForAdd(){this.sliderPanelConfiguration.modal.save.label="personalization.modal.customizationvariationmanagement.targetgrouptab.addvariation";this.sliderPanelConfiguration.modal.save.isDisabledFn=()=>!this.canSaveVariation();this.sliderPanelConfiguration.modal.save.onClick=()=>{this.onAddVariation()}}setSliderConfigForEditing(){this.sliderPanelConfiguration.modal.save.label="personalization.modal.customizationvariationmanagement.targetgrouptab.savechanges";this.sliderPanelConfiguration.modal.save.isDisabledFn=()=>!this.canSaveVariation();this.sliderPanelConfiguration.modal.save.onClick=()=>{this.onSaveEditedVariation()}}canSaveVariation(){const e=this.isSavedVariationValidOrEmpty();const t=this.persoTriggerService.isValidExpression(this.edit.expression[0]);const o=!m.stringUtils.isBlank(this.edit.name);const n=o&&(this.edit.isDefault||t&&e);return n}isSavedVariationValidOrEmpty(){this.edit.expression=this.edit.expression||[{nodes:[]}];return this.persoTriggerService.isValidExpression(this.edit.expression[0])||this.edit.expression.length===0||this.edit.expression[0].nodes.length===0}setVariations(e){this.customizationViewService.setVariations(e)}onAddVariation(){const e=1e4;this.customizationViewService.addVariation({tempcode:"Temp"+(Math.random()*e).toFixed(0),code:this.edit.code,name:this.edit.name,enabled:true,status:p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,triggers:this.persoTriggerService.buildTriggers(this.edit,this.edit.selectedVariation.triggers||[]),rank:this.customization.variations.length,isNew:true,catalog:null,catalogVersion:null});this.clearEditedVariationDetails();this.toggleSliderFullscreen(false);this.sliderPanelHide();this.isVariationLoaded=false}onSaveEditedVariation(){const e=this.persoTriggerService.buildTriggers(this.edit,this.edit.selectedVariation.triggers||[]);const t=this.customization.variations.map((t=>t.code===this.edit.selectedVariation.code?Object.assign(Object.assign({},t),{triggers:e,name:this.edit.name}):t));this.setVariations(t);this.toggleSliderFullscreen(false);this.sliderPanelHide();this.isVariationLoaded=false}cancelChangesClick(){if(this.isVariationSelected()){this.edit.selectedVariation=undefined}else{this.clearEditedVariationDetails()}this.toggleSliderFullscreen(false);this.sliderPanelHide();this.isVariationLoaded=false}isVariationSelected(){return typeof this.edit.selectedVariation!=="undefined"}clearEditedVariationDetails(){this.edit.code="";this.edit.name="";this.edit.expression=[];this.edit.isDefault=false;this.edit.showExpression=true}};__decorate([s.ViewChild(se,{static:false}),__metadata("design:type",se)],le.prototype,"modalFullScreenButtonCmp",void 0);le=__decorate([s.Component({selector:"perso-target-group-tab",template:`<div class="pe-customization-modal" *ngIf="customization"><div class="pe-customization-modal__title"><div class="pe-customization-modal__title-header"><div class="pe-customization-modal__title-header-name perso-wrap-ellipsis" [attr.title]="customization.name">{{ customization.name }}</div><div><span class="pe-customization-modal__title-header-badge badge badge-success" [ngClass]="[getActivityStateForCustomization(customization)]">{{'personalization.modal.customizationvariationmanagement.targetgrouptab.customization.' + customization.status | lowercase | translate}}</span></div></div><div class="pe-customization-modal__title-subarea"><div *ngIf="isCustomizationEnabled(customization)" class="pe-customization-modal__title-dates"><span *ngIf="!customization.enabledStartDate && customization.enabledEndDate">...</span> <span [ngClass]="{'perso__datetimepicker--error-text': !persoDateUtils.isDateValidOrEmpty(customization.enabledStartDate)}">{{ customization.enabledStartDate }}</span> <span *ngIf="customization.enabledStartDate || customization.enabledEndDate">- </span><span [ngClass]="{'perso__datetimepicker--error-text':!persoDateUtils.isDateValidOrEmpty(customization.enabledEndDate)}">{{ customization.enabledEndDate }}</span> <span *ngIf="persoDateUtils.isDateInThePast(customization.enabledEndDate)" class="section-help help-inline help-inline--section help-inline--tooltip"><span class="pe-datetime__warning-icon"></span> <span class="pe-help-block--inline help-block-inline help-block-inline--text" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.datetooltip"></span> </span><span *ngIf="customization.enabledStartDate && !customization.enabledEndDate">...</span></div></div></div><div class="pe-customization-modal__y-add-btn"><button class="fd-button" type="button" (click)="showAddVariationPanel()"><span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.addtargetgroup.button"></span></button></div><perso-target-group-variation-list *ngIf="visibleVariations.length > 0" [customization]="customization" [variations]="visibleVariations"></perso-target-group-variation-list><se-slider-panel [sliderPanelConfiguration]="sliderPanelConfiguration" [(sliderPanelHide)]="sliderPanelHide" [(sliderPanelShow)]="sliderPanelShow" class="pe-customization-modal__sliderpanel"><div *ngIf="isVariationLoaded"><div class="pe-customization-modal__sliderpanel__btn-layout"><perso-modal-full-screen-button></perso-modal-full-screen-button></div><form><div class="fd-form-item"><label for="targetgroup-name" class="fd-form__label required" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname"></label> <input type="text" name="variationname_key" id="targetgroup-name" class="fd-form__control" [placeholder]="'personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname.placeholder' | translate" [(ngModel)]="edit.name"/></div><div class="fd-form-item pe-customization-modal--check"><input type="checkbox" name="isDefault" id="targetgroup-isDefault-001" class="fd-form__control fd-checkbox" [(ngModel)]="edit.isDefault" (ngModelChange)="showConfirmForDefaultTrigger($event)"/> <label for="targetgroup-isDefault-001" class="fd-form__control fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></label></div><div *ngIf="edit.showExpression"><segment-view [targetGroupState]="edit" (expressionChange)="onSegmentViewExpressionChange($event)"></segment-view></div></form></div></se-slider-panel></div>`}),__metadata("design:paramtypes",[p.PersonalizationsmarteditDateUtils,p.PersonalizationsmarteditUtils,t.TriggerService,m.IConfirmationModalService,t.CustomizationViewService,m.LogService,s.ChangeDetectorRef])],le);window.__smartedit__.addDecoratorPayload("Component","ToggleVariationActiveItemComponent",{selector:"perso-toggle-variation-active-item",template:`\n        <a (click)="toggle()" class="se-dropdown-item fd-menu__item" [translate]="label"></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});let ce=class ToggleVariationActiveItemComponent{constructor(e,t){this.targetGroupTabComponent=t;({selectedItem:this.selectedItem}=e)}ngOnInit(){this.label=this.selectedItem.variation.enabled?"personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.disable":"personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.enable"}toggle(){this.toggleVariationActive(this.selectedItem.variation)}toggleVariationActive(e){const t=!e.enabled;const o=t?p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:p.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED;const n=Object.assign(Object.assign({},e),{enabled:t,status:o});this.targetGroupTabComponent.updateVariation(n)}};ce=__decorate([s.Component({selector:"perso-toggle-variation-active-item",template:`\n        <a (click)="toggle()" class="se-dropdown-item fd-menu__item" [translate]="label"></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__param(1,s.Inject(s.forwardRef((()=>le)))),__metadata("design:paramtypes",[Object,le])],ce);window.__smartedit__.addDecoratorPayload("Component","RemoveVariationItemComponent",{selector:"perso-remove-variation-item",template:`\n        <a\n            (click)="remove()"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.remove"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});let de=class RemoveVariationItemComponent{constructor(e,t){this.targetGroupTabComponent=t;({selectedItem:this.selectedItem}=e)}remove(){this.targetGroupTabComponent.removeVariation(this.selectedItem.variation)}};de=__decorate([s.Component({selector:"perso-remove-variation-item",template:`\n        <a\n            (click)="remove()"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.remove"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__param(1,s.Inject(s.forwardRef((()=>le)))),__metadata("design:paramtypes",[Object,le])],de);window.__smartedit__.addDecoratorPayload("Component","MoveVariationUpItemComponent",{selector:"perso-set-variation-rank-up-item",template:`\n        <a\n            (click)="moveUp($event)"\n            [ngClass]="{ 'perso-dropdown-menu__item--disabled disabled': isFirst }"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.moveup"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});let pe=class MoveVariationUpItemComponent{constructor(e,t){this.targetGroupTabComponent=t;this.isFirst=false;({selectedItem:this.selectedItem}=e)}ngOnInit(){this.isFirst=this.selectedItem.variation.rank===0}moveUp(e){if(this.isFirst){e.stopPropagation();return}this.targetGroupTabComponent.setVariationRank(this.selectedItem.variation,-1,e,this.isFirst)}};pe=__decorate([s.Component({selector:"perso-set-variation-rank-up-item",template:`\n        <a\n            (click)="moveUp($event)"\n            [ngClass]="{ 'perso-dropdown-menu__item--disabled disabled': isFirst }"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.moveup"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__param(1,s.Inject(s.forwardRef((()=>le)))),__metadata("design:paramtypes",[Object,le])],pe);window.__smartedit__.addDecoratorPayload("Component","MoveVariationDownItemComponent",{selector:"perso-set-variation-rank-down-item",template:`\n        <a\n            (click)="moveDown($event)"\n            [ngClass]="{ 'perso-dropdown-menu__item--disabled disabled': isLast }"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.movedown"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});let me=class MoveVariationDownItemComponent{constructor(e,t){this.targetGroupTabComponent=t;({selectedItem:this.selectedItem}=e);this.isLast=false}ngOnInit(){this.isLast=this.selectedItem.variation.rank===this.targetGroupTabComponent.visibleVariations.length-1}moveDown(e){if(this.isLast){e.stopPropagation();return}this.targetGroupTabComponent.setVariationRank(this.selectedItem.variation,1,e,this.isLast)}};me=__decorate([s.Component({selector:"perso-set-variation-rank-down-item",template:`\n        <a\n            (click)="moveDown($event)"\n            [ngClass]="{ 'perso-dropdown-menu__item--disabled disabled': isLast }"\n            class="se-dropdown-item fd-menu__item"\n            translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.movedown"\n        ></a>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__param(1,s.Inject(s.forwardRef((()=>le)))),__metadata("design:paramtypes",[Object,le])],me);window.__smartedit__.addDecoratorPayload("Component","TargetGroupVariationListComponent",{selector:"perso-target-group-variation-list",template:`<ul class="pe-customization-modal__list-group"><li class="pe-customization-modal__list-group__item" *ngFor="let variation of variationsForView"><div class="pe-customization-modal__list-group__item-col1"><a class="pe-customization-modal__list-group__item-link perso-wrap-ellipsis" (click)="editVariation(variation)">{{ variation.name }}</a><span [ngClass]="variation.activityState">{{ variation.enablementText }}</span><div *ngIf="variation.isDefault"><span class="pe-customization-modal__title-label-segments" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span> <span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></span></div><div *ngIf="!variation.isDefault"><div><span class="pe-customization-modal__title-label-segments" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span><segment-expression-as-html [segmentExpression]="variation.triggers"></segment-expression-as-html></div></div></div><div><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="{ variation: variation }" class="pull-right"></se-dropdown-menu></div></li></ul>`});let ge=class TargetGroupVariationListComponent{constructor(e,t,o){this.customizationViewService=e;this.triggerService=t;this.persoUtils=o;this.dropdownItems=[{component:re},{component:ce},{component:pe},{component:me},{component:de}];this.variationsForView=[]}ngOnChanges(e){const t=e.variations;if(t){const e=t.currentValue;this.variationsForView=e.map((e=>{const t=this.getEnablementTextForVariation(e);const o=this.getActivityStateForVariation(this.customization,e);const n=this.isDefaultTrigger(e.triggers);return Object.assign(Object.assign({},e),{enablementText:t,activityState:o,isDefault:n})}))}}editVariation(e){this.customizationViewService.editVariationAction(e)}isDefaultTrigger(e){return this.triggerService.isDefault(e)}getActivityStateForVariation(e,t){return this.persoUtils.getActivityStateForVariation(e,t)}getEnablementTextForVariation(e){const t=this.persoUtils.getEnablementTextForVariation(e,"personalization.modal.customizationvariationmanagement.targetgrouptab");return`(${t})`}};__decorate([s.Input(),__metadata("design:type",Array)],ge.prototype,"variations",void 0);__decorate([s.Input(),__metadata("design:type",Object)],ge.prototype,"customization",void 0);ge=__decorate([s.Component({selector:"perso-target-group-variation-list",template:`<ul class="pe-customization-modal__list-group"><li class="pe-customization-modal__list-group__item" *ngFor="let variation of variationsForView"><div class="pe-customization-modal__list-group__item-col1"><a class="pe-customization-modal__list-group__item-link perso-wrap-ellipsis" (click)="editVariation(variation)">{{ variation.name }}</a><span [ngClass]="variation.activityState">{{ variation.enablementText }}</span><div *ngIf="variation.isDefault"><span class="pe-customization-modal__title-label-segments" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span> <span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></span></div><div *ngIf="!variation.isDefault"><div><span class="pe-customization-modal__title-label-segments" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span><segment-expression-as-html [segmentExpression]="variation.triggers"></segment-expression-as-html></div></div></div><div><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="{ variation: variation }" class="pull-right"></se-dropdown-menu></div></li></ul>`}),__metadata("design:paramtypes",[t.CustomizationViewService,t.TriggerService,p.PersonalizationsmarteditUtils])],ge);window.__smartedit__.addDecoratorPayload("Component","ManageCustomizationViewComponent",{selector:"perso-manage-customization-view",template:`<div class="pe-customization-modal__tabs"><se-tabs *ngIf="isReady" [tabsList]="tabs" [numTabsDisplayed]="2" (onTabSelected)="onTabSelected($event)"></se-tabs></div>`,providers:[t.CustomizationViewService]});let ue=class ManageCustomizationViewComponent{constructor(e,o,n,s,a,r,d,m,g,u,v,f,S){this.persoDateUtils=e;this.persoCommerceCustomizationService=o;this.persoMessageHandler=n;this.persoCustomizationViewService=s;this.persoRestService=a;this.confirmationModalService=r;this.systemEventService=d;this.modalManager=m;this.translateService=g;this.logService=u;this.cdr=v;this.renderer=f;this.document=S;this.isReady=false;this.savingCustomizationView=false;this.tabs=[];this.isReady=false;this.isEditMode=false;this.tabs=[{id:p.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_FORM_NAME,title:"personalization.modal.customizationvariationmanagement.basicinformationtab",component:t.BasicInfoTabComponent,hasErrors:false,active:true},{id:p.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_NAME,title:"personalization.modal.customizationvariationmanagement.targetgrouptab",component:le,hasErrors:false,active:false}]}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.modalManager.getModalData().pipe(S.take(1)).toPromise();if(e){({customizationCode:this.customizationCode,variationCode:this.variationCode}=e)}this.initModalButtons();yield this.initCustomization();if(this.customizationCode){this.isEditMode=true;if(this.variationCode){this.persoCustomizationViewService.editVariationAction(this.persoCustomizationViewService.selectVariationByCode(this.variationCode))}}if(this.variationCode){this.tabs[0].active=false;this.tabs[1].active=true;this.modalManager.addButtons(this.modalButtons.targetGroupTabComponent)}else{this.modalManager.addButtons(this.modalButtons.basicInfoTabComponent)}this.isReady=true;this.cdr.detectChanges()}))}onTabSelected(e){this.modalManager.removeAllButtons();if(e===p.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_FORM_NAME){this.modalManager.addButtons([...this.modalButtons.basicInfoTabComponent])}else if(e===p.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_NAME){this.modalManager.addButtons([...this.modalButtons.targetGroupTabComponent])}}initModalButtons(){const e={id:"cancel",label:"se.cms.component.confirmation.modal.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.None,callback:()=>f.from(this.onCancel())};this.modalButtons={basicInfoTabComponent:[{id:p.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT,label:"personalization.modal.customizationvariationmanagement.basicinformationtab.button.next",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.None,callback:()=>f.from(this.selectTargetGroupTab()),disabledFn:()=>{const e=this.isBasicInfoTabValid();this.fixDisabledTabStyles(e);return!e}},e],targetGroupTabComponent:[{id:p.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK,label:"personalization.modal.customizationvariationmanagement.targetgrouptab.button.submit",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.None,callback:()=>this.savingCustomizationView?f.of(null):f.from(this.save()),disabledFn:()=>{const e=this.persoCustomizationViewService.selectVisibleVariations();return e.length===0&&this.savingCustomizationView}},e]}}selectTargetGroupTab(){return new Promise((()=>{this.tabsCmp.selectTab(this.tabs[1])}))}fixDisabledTabStyles(e){const t=this.document.querySelector(`[tab-id="targetgrptab"]`);if(!t){return}if(e){this.renderer.setStyle(t,"pointer-events","unset");this.renderer.setStyle(t,"opacity","unset")}else{this.renderer.setStyle(t,"pointer-events","none");this.renderer.setStyle(t,"opacity",.4)}}isBasicInfoTabValid(){const{name:e}=this.persoCustomizationViewService.selectCustomization();return!!e}initCustomization(){return __awaiter(this,void 0,void 0,(function*(){if(!this.customizationCode){this.initialCustomization=d.cloneDeep(ie);return}const e=yield this.getCustomization();if(e){this.persoCustomizationViewService.setCustomization(e);this.initialCustomization=d.cloneDeep(e)}}))}fetchCustomizationAndSetDates(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.persoRestService.getCustomization({code:this.customizationCode});e.enabledStartDate=this.persoDateUtils.formatDate(e.enabledStartDate,undefined);e.enabledEndDate=this.persoDateUtils.formatDate(e.enabledEndDate,undefined);e.statusBoolean=e.status===p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED;return e}catch(e){this.persoMessageHandler.sendError(this.translateService.instant("personalization.error.gettingsegments"))}}))}getCustomization(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchCustomizationAndSetDates();if(!e){return}const t=yield this.fetchVariations(this.customizationCode);if(!t){return}e.variations=t;return e}))}fetchVariations(e){return __awaiter(this,void 0,void 0,(function*(){try{const t={includeFullFields:true};const o=yield this.persoRestService.getVariationsForCustomization(e,t);o.variations.forEach((e=>{e.commerceCustomizations=this.persoCommerceCustomizationService.getCommerceActionsCountMap(e);e.numberOfCommerceActions=this.persoCommerceCustomizationService.getCommerceActionsCount(e);delete e.actions}));return o.variations}catch(e){this.persoMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcomponents"))}}))}onCancel(){return __awaiter(this,void 0,void 0,(function*(){if(!this.isModalDirty()){this.modalManager.dismiss();return}try{yield this.confirmationModalService.confirm({description:"personalization.modal.customizationvariationmanagement.targetgrouptab.cancelconfirmation"});this.modalManager.dismiss()}catch(e){this.logService.log("Confirmation Modal cancelled")}}))}isModalDirty(){const e=this.persoCustomizationViewService.selectCustomization();return!d.isEqual(this.initialCustomization,e)}save(){return __awaiter(this,void 0,void 0,(function*(){this.savingCustomizationView=true;const e=Object.assign({},this.persoCustomizationViewService.selectCustomization());const t=this.prepareCustomizationPayload(e,this.isEditMode);if(this.isEditMode){try{yield this.persoRestService.updateCustomizationPackage(t);this.systemEventService.publishAsync("CUSTOMIZATIONS_MODIFIED",{});this.persoMessageHandler.sendSuccess(this.translateService.instant("personalization.info.updatingcustomization"));this.modalManager.dismiss()}catch(e){this.savingCustomizationView=false;this.persoMessageHandler.sendError(this.translateService.instant("personalization.error.updatingcustomization"))}}else{try{yield this.persoRestService.createCustomization(t);this.systemEventService.publishAsync("CUSTOMIZATIONS_MODIFIED",{});this.persoMessageHandler.sendSuccess(this.translateService.instant("personalization.info.creatingcustomization"));this.modalManager.dismiss()}catch(e){this.savingCustomizationView=false;this.persoMessageHandler.sendError(this.translateService.instant("personalization.error.creatingcustomization"))}}}))}prepareCustomizationPayload(e,t){e.enabledStartDate=e.enabledStartDate?this.persoDateUtils.formatDate(e.enabledStartDate,p.PERSONALIZATION_DATE_FORMATS.MODEL_DATE_FORMAT):undefined;e.enabledEndDate=e.enabledEndDate?this.persoDateUtils.formatDate(e.enabledEndDate,p.PERSONALIZATION_DATE_FORMATS.MODEL_DATE_FORMAT):undefined;if(!t){delete e.catalog;delete e.code;delete e.rank}return e}};__decorate([s.ViewChild(m.TabsComponent,{static:false}),__metadata("design:type",m.TabsComponent)],ue.prototype,"tabsCmp",void 0);ue=__decorate([s.Component({selector:"perso-manage-customization-view",template:`<div class="pe-customization-modal__tabs"><se-tabs *ngIf="isReady" [tabsList]="tabs" [numTabsDisplayed]="2" (onTabSelected)="onTabSelected($event)"></se-tabs></div>`,providers:[t.CustomizationViewService]}),__param(12,s.Inject(u.DOCUMENT)),__metadata("design:paramtypes",[p.PersonalizationsmarteditDateUtils,p.PersonalizationsmarteditCommerceCustomizationService,p.PersonalizationsmarteditMessageHandler,t.CustomizationViewService,t.PersonalizationsmarteditRestService,m.IConfirmationModalService,m.SystemEventService,m.ModalManagerService,v.TranslateService,m.LogService,s.ChangeDetectorRef,s.Renderer2,Document])],ue);t.ManageCustomizationViewManager=class ManageCustomizationViewManager{constructor(e){this.modalService=e;this.className="sliderPanelParentModal";this.modalTitle="personalization.modal.customizationvariationmanagement.title"}openCreateCustomizationModal(){this.modalService.open({component:ue,config:{modalPanelClass:`lg ${this.className}`,width:"650px",focusTrapped:false,backdropClickCloseable:false},templateConfig:{title:this.modalTitle,isDismissButtonVisible:true}})}openEditCustomizationModal(e,t){this.modalService.open({component:ue,data:{customizationCode:e,variationCode:t},config:{modalPanelClass:`lg ${this.className}`,width:"650px",focusTrapped:false,backdropClickCloseable:false},templateConfig:{title:this.modalTitle,isDismissButtonVisible:true}})}};t.ManageCustomizationViewManager.$inject=["modalService"];t.ManageCustomizationViewManager=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IModalService])],t.ManageCustomizationViewManager);window.__smartedit__.addDecoratorPayload("Component","SegmentExpressionAsHtmlComponent",{selector:"segment-expression-as-html",template:`<span *ngFor="let word of expression"><span *ngIf="operators.includes(word)" class="pe-customization-modal__expression-text">&nbsp;{{ segmentActionI18n[word] | translate }}&nbsp;</span><se-tooltip *ngIf="word === emptyGroup" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger class="pe-customization-modal__expression-alert-icon sap-icon--alert"></span> <span se-tooltip-body translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.tooltip"></span></se-tooltip><span *ngIf="!emptyGroupAndOperators.includes(word)">{{ word }}</span></span>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let he=class SegmentExpressionAsHtmlComponent{constructor(e){this.triggerService=e;this.expression=[];this.segmentActionI18n={[p.TriggerActionId.AND]:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.and",[p.TriggerActionId.OR]:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.or",[p.TriggerActionId.NOT]:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.not"};this.operators=["AND","OR","NOT"];this.emptyGroup="[]";this.emptyGroupAndOperators=this.operators.concat(this.emptyGroup)}ngOnInit(){if(!this.segmentExpression){return}this.update()}ngOnChanges(){this.update()}update(){this.expression=this.isSegmentExpression(this.segmentExpression)?this.buildExpression(this.segmentExpression):this.mapExpressionToString(this.segmentExpression)}buildExpression(e){const t=this.triggerService.buildData(e)[0];return this.mapExpressionToString(t)}mapExpressionToString(e){return this.triggerService.getExpressionAsString(e).split(" ")}isSegmentExpression(e){return typeof e.operation==="undefined"}};__decorate([s.Input(),__metadata("design:type",Object)],he.prototype,"segmentExpression",void 0);he=__decorate([s.Component({selector:"segment-expression-as-html",template:`<span *ngFor="let word of expression"><span *ngIf="operators.includes(word)" class="pe-customization-modal__expression-text">&nbsp;{{ segmentActionI18n[word] | translate }}&nbsp;</span><se-tooltip *ngIf="word === emptyGroup" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger class="pe-customization-modal__expression-alert-icon sap-icon--alert"></span> <span se-tooltip-body translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.tooltip"></span></se-tooltip><span *ngIf="!emptyGroupAndOperators.includes(word)">{{ word }}</span></span>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[t.TriggerService])],he);let ve=class SegmentExpressionAsHtmlModule{};ve=__decorate([s.NgModule({imports:[u.CommonModule,m.TooltipModule,m.TranslationModule.forChild()],declarations:[he],exports:[he]})],ve);let _e=class ActionsDataFactory{constructor(){this.actions=[];this.removedActions=[]}getActions(){return this.actions}getRemovedActions(){return this.removedActions}resetActions(){this.actions.length=0}resetRemovedActions(){this.removedActions.length=0}addAction(e,t){let o=false;this.actions.forEach((n=>{o=o||t(e,n.action)}));if(!o){let o=p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW;let n=-1;this.removedActions.forEach(((o,s)=>{if(t(e,o.action)){n=s}}));if(n>=0){o=p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.OLD;this.removedActions.splice(n,1)}this.actions.push({action:e,status:o})}}isItemInSelectedActions(e,t){return this.actions.find((o=>t(e,o.action)))}};_e=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[])],_e);window.__smartedit__.addDecoratorPayload("Component","CommerceCustomizationViewComponent",{selector:"commerce-customization-view",template:`<div id="commerceCustomizationBody-002" class="perso-cc-modal"><div class="perso-cc-modal__title-layout"><div class="perso-wrap-ellipsis perso-cc-modal__title-cname" [textContent]="customization.name" title="{{customization.name}}"></div><div class="perso-cc-modal__title-status" [ngClass]="customizationStatus" [textContent]="' (' + customizationStatusText + ') '"></div><span>></span><div class="perso-wrap-ellipsis perso-cc-modal__title-vname" [textContent]="variation.name" title="{{variation.name}}"></div><div class="perso-cc-modal__title-status" [ngClass]="variationStatus" [textContent]="' (' + variationStatusText + ')'"></div></div><div class="form-group perso-cc-modal__content-layout"><label for="commerce-customization-type-1" class="fd-form__label" translate="personalization.modal.commercecustomization.action.type"></label><se-select [id]="commerce-customization-type-1" class="fd-form__control" [fetchStrategy]="customizationTypeFetchStrategy" [searchEnabled]="false" [(model)]="select.typeId" [onChange]="onActionTypeChange"></se-select></div><ng-container><ng-container *ngComponentOutlet="promotionComponent.component; injector: promotionComponent.injector"></ng-container></ng-container><ng-container><ng-container *ngComponentOutlet="searchProfileComponent.component; injector: searchProfileComponent.injector"></ng-container></ng-container><div class="select2-choices"><div class="ui-select-match-item select2-search-choice" *ngFor="let action of getActionsToDisplay()"><span [textContent]="displayAction(action)"></span> <span class="ui-select-match-close select2-search-choice-close sap-icon--decline" (click)="removeSelectedAction(action)"></span></div></div></div>`,encapsulation:s.ViewEncapsulation.None});t.CommerceCustomizationViewComponent=class CommerceCustomizationViewComponent{constructor(e,t,o,n,s,a,r,d,p,m,g,u,v){this.injector=e;this.translateService=n;this.actionsDataFactory=s;this.personalizationsmarteditRestService=a;this.personalizationsmarteditMessageHandler=r;this.systemEventService=d;this.personalizationsmarteditCommerceCustomizationService=p;this.personalizationsmarteditContextService=m;this.personalizationsmarteditUtils=g;this.modalManager=u;this.logService=v;this.availableTypes=[];this.select={};this.customizationTypeFetchStrategy={fetchAll:()=>{this.availableTypes=[];this.availableTypes=this.personalizationsmarteditCommerceCustomizationService.getAvailableTypes(this.personalizationsmarteditContextService.getSeData().seConfigurationData);this.availableTypes.forEach((e=>{e.id=e.type;e.label=e.text}));return Promise.resolve(this.availableTypes)}};this.isItemInSelectedActions=(e,t)=>this.actionsDataFactory.isItemInSelectedActions(e,t);this.addAction=(e,t)=>{this.actionsDataFactory.addAction(e,t)};this.availableTypes=this.personalizationsmarteditCommerceCustomizationService.getAvailableTypes(this.personalizationsmarteditContextService.getSeData().seConfigurationData);this.availableTypes.forEach((e=>{e.id=e.type;e.label=e.text}));this.select={typeId:this.availableTypes[0].id,template:this.availableTypes[0].template};this.promotionCode="cxPromotionActionData";this.searchProfilesCode="cxSearchProfileActionData";this.actionsDataFactory.resetActions();this.actionsDataFactory.resetRemovedActions();this.actions=this.actionsDataFactory.getActions();this.removedActions=this.actionsDataFactory.getRemovedActions();this.onActionTypeChange=this.onActionTypeChange.bind(this);if(t){this.initPersonlizationSearchExtensionComponent(t)}if(o){this.initPersonlizationPromotionExtensionComponent(o)}}ngOnInit(){this.modalManager.getModalData().pipe(S.take(1)).subscribe((e=>{this.customization=e.customization;this.variation=e.variation}));this.customizationStatusText=this.personalizationsmarteditUtils.getEnablementTextForCustomization(this.customization,"personalization.modal.commercecustomization");this.variationStatusText=this.personalizationsmarteditUtils.getEnablementTextForVariation(this.variation,"personalization.modal.commercecustomization");this.customizationStatus=this.personalizationsmarteditUtils.getActivityStateForCustomization(this.customization);this.variationStatus=this.personalizationsmarteditUtils.getActivityStateForVariation(this.customization,this.variation);this.modalManager.addButtons([{id:"confirmOk",label:"personalization.modal.commercecustomization.button.submit",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.Close,callback:()=>f.from(this.onSave()),disabledFn:()=>!this.isDirty()},{id:"confirmCancel",label:"personalization.modal.commercecustomization.button.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.Close,callback:()=>f.from(this.onCancel())}]);this.populateActions()}onActionTypeChange(){this.availableTypes.map((e=>{if(e.id===this.select.typeId){this.select.template=e.template}}))}getSeData(){return this.personalizationsmarteditContextService.getSeData()}removeSelectedAction(e){const t=this.actions.indexOf(e);if(t<0){return}const o=this.actions.splice(t,1);if(o[0].status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.OLD||o[0].status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE){o[0].status=p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.DELETE;this.removedActions.push(o[0])}}displayAction(e){const t=e.action;const o=this.getType(t.type);if(o.getName){return o.getName(t)}else{return t.code}}getActionsToDisplay(){return this.actionsDataFactory.getActions()}isDirty(){let e=false;this.actions.forEach((t=>{e=e||t.status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW||t.status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE}));e=e||this.removedActions.length>0;return e}getSelectedTypeCode(){return this.select.typeId}getCustomization(){return this.customization}getViration(){return this.variation}initPersonlizationSearchExtensionComponent({component:e}){this.searchProfileComponent={component:e,injector:s.Injector.create({parent:this.injector,providers:[{provide:p.PERSONLIZATION_SEARCH_EXTENSION_INJECTOR_TOKEN,useValue:{seData:this.getSeData(),actions:this.actions,addAction:(e,t)=>this.addAction(e,t),isActionInSelectDisabled:(e,t)=>this.isItemInSelectedActions(e,t),getSelectedTypeCode:()=>this.getSelectedTypeCode(),getCustomization:()=>this.getCustomization(),getVariation:()=>this.getViration()}}]})}}initPersonlizationPromotionExtensionComponent({component:e}){this.promotionComponent={component:e,injector:s.Injector.create({parent:this.injector,providers:[{provide:p.PERSONLIZATION_PROMOTION_EXTENSION_INJECTOR_TOKEN,useValue:{addAction:(e,t)=>this.addAction(e,t),isActionInSelectDisabled:(e,t)=>this.isItemInSelectedActions(e,t),getSelectedTypeCode:()=>this.getSelectedTypeCode()}}]})}}populateActions(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.personalizationsmarteditRestService.getActions(this.customization.code,this.variation.code,{});const t=e.actions.filter((e=>e.type!=="cxCmsActionData")).map((e=>({code:e.code,action:e,status:p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.OLD})));this.actionsDataFactory.resetActions();this.personalizationsmarteditUtils.uniqueArray(this.actionsDataFactory.actions,t||[])}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingactions"))}}))}getType(e){for(const t of this.availableTypes){if(t.type===e){return t}}return{}}sendRefreshEvent(){this.systemEventService.publishAsync("CUSTOMIZATIONS_MODIFIED",{})}onCancel(){this.modalManager.close(null);return Promise.resolve()}onSave(){const e={actions:this.actions.filter((e=>e.status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW)).map((e=>e.action))};const t=this.removedActions.filter((e=>e.status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.DELETE)).map((e=>e.action.code));const o={actions:this.actions.filter((e=>e.status===p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE)).map((e=>e.action))};const n=e.actions.length>0;const s=t.length>0;const a=o.actions.length>0;(()=>{if(n){return this.createActions(this.customization.code,this.variation.code,e)}else{return Promise.resolve()}})().then((e=>{(()=>{if(s){return this.deleteActions(this.customization.code,this.variation.code,t)}else{return Promise.resolve()}})().then((t=>{if(a){this.updateActions(this.customization.code,this.variation.code,o,e,t)}else{return Promise.resolve()}}))}));this.modalManager.close(null);return Promise.resolve()}getActionTypesForActions(e){return e.map((e=>e.type)).filter(((e,t,o)=>o.indexOf(e)===t)).map((e=>this.availableTypes.filter((t=>t.type===e))[0]))}createActions(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=m.promiseUtils.defer();try{const s=yield this.personalizationsmarteditRestService.createActions(e,t,o,{});this.personalizationsmarteditMessageHandler.sendSuccess(this.translateService.instant("personalization.info.creatingaction"));this.sendRefreshEvent();n.resolve(s)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.creatingaction"));n.reject()}return n.promise}))}deleteActions(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=m.promiseUtils.defer();try{const s=yield this.personalizationsmarteditRestService.deleteActions(e,t,o,{});this.personalizationsmarteditMessageHandler.sendSuccess(this.translateService.instant("personalization.info.removingaction"));this.sendRefreshEvent();n.resolve(s)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.removingaction"));n.resolve()}return n.promise}))}updateActions(e,t,o,n,s){const a=this.getActionTypesForActions(o.actions);a.forEach((a=>{if(a.updateActions){const r=o.actions.filter((e=>this.getType(e.type)===a));a.updateActions(e,t,r,n,s).then((()=>{this.personalizationsmarteditMessageHandler.sendSuccess(this.translateService.instant("personalization.info.updatingactions"));this.sendRefreshEvent()}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.updatingactions"))}))}else{this.logService.debug(this.translateService.instant("personalization.error.noupdatingactions"))}}))}};t.CommerceCustomizationViewComponent=__decorate([s.Component({selector:"commerce-customization-view",template:`<div id="commerceCustomizationBody-002" class="perso-cc-modal"><div class="perso-cc-modal__title-layout"><div class="perso-wrap-ellipsis perso-cc-modal__title-cname" [textContent]="customization.name" title="{{customization.name}}"></div><div class="perso-cc-modal__title-status" [ngClass]="customizationStatus" [textContent]="' (' + customizationStatusText + ') '"></div><span>></span><div class="perso-wrap-ellipsis perso-cc-modal__title-vname" [textContent]="variation.name" title="{{variation.name}}"></div><div class="perso-cc-modal__title-status" [ngClass]="variationStatus" [textContent]="' (' + variationStatusText + ')'"></div></div><div class="form-group perso-cc-modal__content-layout"><label for="commerce-customization-type-1" class="fd-form__label" translate="personalization.modal.commercecustomization.action.type"></label><se-select [id]="commerce-customization-type-1" class="fd-form__control" [fetchStrategy]="customizationTypeFetchStrategy" [searchEnabled]="false" [(model)]="select.typeId" [onChange]="onActionTypeChange"></se-select></div><ng-container><ng-container *ngComponentOutlet="promotionComponent.component; injector: promotionComponent.injector"></ng-container></ng-container><ng-container><ng-container *ngComponentOutlet="searchProfileComponent.component; injector: searchProfileComponent.injector"></ng-container></ng-container><div class="select2-choices"><div class="ui-select-match-item select2-search-choice" *ngFor="let action of getActionsToDisplay()"><span [textContent]="displayAction(action)"></span> <span class="ui-select-match-close select2-search-choice-close sap-icon--decline" (click)="removeSelectedAction(action)"></span></div></div></div>`,encapsulation:s.ViewEncapsulation.None}),__param(1,s.Optional()),__param(1,s.Inject(p.PERSONLIZATION_SEARCH_EXTENSION_TOKEN)),__param(2,s.Inject(p.PERSONLIZATION_PROMOTION_EXTENSION_TOKEN)),__metadata("design:paramtypes",[s.Injector,Object,Object,v.TranslateService,_e,t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditMessageHandler,m.SystemEventService,p.PersonalizationsmarteditCommerceCustomizationService,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditUtils,m.ModalManagerService,m.LogService])],t.CommerceCustomizationViewComponent);t.PersonalizationsmarteditCommerceCustomizationView=class PersonalizationsmarteditCommerceCustomizationView{constructor(e){this.modalService=e;this.openCommerceCustomizationAction=(e,o)=>{this.modalService.open({component:t.CommerceCustomizationViewComponent,data:{customization:e,variation:o},templateConfig:{title:"personalization.modal.commercecustomization.title",isDismissButtonVisible:true},config:{width:"700px",focusTrapped:false,backdropClickCloseable:false}})}}};t.PersonalizationsmarteditCommerceCustomizationView.$inject=["modalService"];t.PersonalizationsmarteditCommerceCustomizationView=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IModalService])],t.PersonalizationsmarteditCommerceCustomizationView);let fe=class PersonalizationsmarteditCommerceCustomizationModule{};fe=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),u.CommonModule,b.FormsModule,m.SelectModule,p.PersonalizationsmarteditCommonsComponentsModule,m.CompileHtmlModule],declarations:[t.CommerceCustomizationViewComponent],entryComponents:[t.CommerceCustomizationViewComponent],providers:[t.PersonalizationsmarteditCommerceCustomizationView,_e]})],fe);let ye=class SegmentDragAndDropService{constructor(e){this.document=e}dragMoved(e){const t=this.document.elementFromPoint(e.pointerPosition.x,e.pointerPosition.y);if(!t){this.currentHoverDropListId=null;return}const o=t.classList.contains("cdk-drop-list")?t:t.closest(".cdk-drop-list");if(!o){this.currentHoverDropListId=null;return}this.currentHoverDropListId=o.id}dragReleased(){this.currentHoverDropListId=null}};ye.$inject=["document"];ye=__decorate([m.SeDowngradeService(),__param(0,s.Inject(u.DOCUMENT)),__metadata("design:paramtypes",[Document])],ye);window.__smartedit__.addDecoratorPayload("Component","SegmentItemPrinterComponent",{selector:"segment-item-printer",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`\n        <div>\n            <div class="perso__item-name">{{ data.item.code }}</div>\n            <div\n                class="perso-wrap-ellipsis perso__wrapper-description"\n                [attr.title]="data.item.description"\n            >\n                {{ data.item.description }}\n            </div>\n        </div>\n    `});let Se=class SegmentItemPrinterComponent{constructor(e){this.data=e}};Se=__decorate([s.Component({selector:"segment-item-printer",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`\n        <div>\n            <div class="perso__item-name">{{ data.item.code }}</div>\n            <div\n                class="perso-wrap-ellipsis perso__wrapper-description"\n                [attr.title]="data.item.description"\n            >\n                {{ data.item.description }}\n            </div>\n        </div>\n    `}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],Se);window.__smartedit__.addDecoratorPayload("Component","SegmentNodeComponent",{selector:"segment-node",template:`<div cdkDropList [id]="node.uid" [cdkDropListData]="node" [cdkDropListConnectedTo]="connectedDropListsIds" (cdkDropListDropped)="onDragDrop($event)" [cdkDropListSortingDisabled]="false" [cdkDropListEnterPredicate]="canBeDropped" [ngClass]="{'perso-segments-tree__layout': isContainer(node), 'perso-segments-tree__empty-container': isEmptyContainer(node), 'perso-segments-tree__collapsed-container': collapsed }"><div><div class="perso-segments-tree" [ngClass]="{'perso-segments-tree__node': isItem(node), 'perso-segments-tree__container': isContainer(node)}"><div *ngIf="isContainer(node)"><div class="perso-segments-tree__toggle" (click)="toggle()" title="{{collapsed ? 'personalization.commons.icon.title.expand' : 'personalization.commons.icon.title.collapse' | translate}}" [ngClass]="collapsed ? 'sap-icon--navigation-right-arrow' : 'sap-icon--navigation-down-arrow'"></div><div class="perso-segments-tree__dropdown"><se-select [model]="node.operation.id" (modelChange)="operationChange($event)" [fetchStrategy]="fetchStrategy" [resetSearchInput]="false" [searchEnabled]="false"></se-select></div></div><div *ngIf="isItem(node)" class="perso-segments-tree__node-content">{{ node.selectedSegment.code }}</div><div *ngIf="isContainer(node)" class="perso-segments-tree__angular-ui-tree-handle--empty"></div><div><span class="perso-segments-tree__pull-right"><a *ngIf="isItem(node)" class="perso-segments-tree__actions perso-segments-tree__node-icon" (click)="duplicateItem(node)" title="{{'personalization.commons.icon.title.duplicate' | translate}}"><span class="sap-icon--duplicate"></span> </a><a *ngIf="!isTopContainer()" class="perso-segments-tree__actions" (click)="removeItem(node?.uid)"><div *ngIf="isContainer(node)" class="btn btn-link perso-segments-tree__container-btn-icon fd-has-margin-left-tiny" title="{{'personalization.commons.icon.title.remove' | translate}}"><span class="sap-icon--decline"></span></div><div *ngIf="isItem(node)" class="perso-segments-tree__node-icon" title="{{'personalization.commons.icon.title.remove' | translate}}"><span class="sap-icon--decline"></span></div></a></span><button *ngIf="isContainer(node)" class="fd-button--light perso-segments-tree__btn" (click)="newSubItem('container')"><span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.button"></span></button></div></div><div *ngIf="isEmptyContainer(node) && !collapsed" class="perso-segments-tree__empty-container-node"><div class="perso-segments-tree__empty-container-node-text" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.dropzone"></div></div><ol *ngIf="!collapsed"><li cdkDrag [id]="innerNode.uid" [cdkDragData]="innerNode" (cdkDragStarted)="onDragStarted($event)" (cdkDragMoved)="onDragMoved($event)" (cdkDragReleased)="onDragReleased()" *ngFor="let innerNode of node.nodes"><segment-node [node]="innerNode" [expression]="expression" [connectedDropListsIds]="connectedDropListsIds" (expressionChange)="handleUpdate($event)" (onDrop)="onDragDrop($event)" (onDragStart)="onDragStarted($event)"></segment-node></li></ol></div></div>`,styles:[`ol{position:relative;margin:0;padding:0;list-style:none}.cdk-drag{list-style-type:none}.cdk-drag-preview{z-index:2000!important}.cdk-drag-placeholder{opacity:0!important}.cdk-drop-list-dragging{border-top:2px dashed rgba(0,0,0,.4);border-right:2px dashed rgba(0,0,0,.4);border-bottom:2px dashed rgba(0,0,0,.4)}`]});let Ce=class SegmentNodeComponent{constructor(e,t,o,n){this.triggerService=e;this.confirmationModalService=t;this.translateService=o;this.dragDropService=n;this.canBeDropped=(e,t)=>{const o=!this.isItem(this.node);if(this.dragDropService.currentHoverDropListId===null){return o}return t.id===this.dragDropService.currentHoverDropListId&&o};this.connectedDropListsIds=[];this.expressionChange=new s.EventEmitter;this.onDrop=new s.EventEmitter;this.onDragStart=new s.EventEmitter;this.collapsed=false;this.elementToDuplicate=null}ngOnInit(){this.fetchStrategy={fetchAll:()=>Promise.resolve(this.triggerService.actions)}}onDragDrop(e){this.onDrop.emit(e)}onDragStarted(e){e.source.element.nativeElement.style.zIndex="2000";this.onDragStart.emit(e)}onDragMoved(e){this.dragDropService.dragMoved(e)}onDragReleased(){this.dragDropService.dragReleased()}newSubItem(e){this.node.nodes.unshift({uid:m.stringUtils.generateIdentifier(),type:e,operation:e===p.TriggerType.ITEM_TYPE?{}:d.cloneDeep(this.triggerService.actions[0]),nodes:[]});this.collapsed=false;this.expressionChange.emit(this.expression)}removeItem(e){return __awaiter(this,void 0,void 0,(function*(){if(this.triggerService.isNotEmptyContainer(this.node)){yield this.confirmationModalService.confirm({description:this.translateService.instant("personalization.modal.customizationvariationmanagement.targetgrouptab.segments.removecontainerconfirmation")});this.removeFromNode(e);this.expressionChange.emit(this.expression)}else{this.removeFromNode(e);this.expressionChange.emit(this.expression)}}))}operationChange(e){this.node.operation=this.triggerService.actions.find((t=>t.id===e));this.expressionChange.emit(this.expression)}toggle(){this.collapsed=!this.collapsed}duplicateItem(e){this.elementToDuplicate=e;this.expression[0].nodes.some(this.findElementAndDuplicate,this);this.expressionChange.emit(this.expression)}handleUpdate(e){this.expressionChange.emit(e)}isContainerWithDropzone(e){return this.isContainer(e)&&e.nodes.length===1}isItem(e){return this.triggerService.isItem(e)}isContainer(e){return this.triggerService.isContainer(e)}isTopContainer(){return d.isEqual(this.expression[0],this.node)}isEmptyContainer(e){return this.isContainer(e)&&e.nodes.length===0}findElementAndDuplicate(e,t,o){if(this.elementToDuplicate===e){o.splice(t,0,d.cloneDeep(Object.assign(Object.assign({},this.elementToDuplicate),{uid:m.stringUtils.generateIdentifier()})));return true}if(this.isContainer(e)){e.nodes.some(this.findElementAndDuplicate,this)}return false}removeFromNode(e){const t=this.findParentByUid(e);t.nodes=t.nodes.filter((t=>t.uid!==e))}findParentByUid(e){let t=null;const findParent=o=>{const n=(o.nodes||[]).find((t=>t.uid===e));if(n){t=o;return}for(let e=0;e<o.nodes.length;e++){if(o.nodes[e].uid){findParent(o.nodes[e])}}};findParent(this.expression[0]);return t}};__decorate([s.Input(),__metadata("design:type",Array)],Ce.prototype,"expression",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Ce.prototype,"node",void 0);__decorate([s.Input(),__metadata("design:type",Array)],Ce.prototype,"connectedDropListsIds",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ce.prototype,"expressionChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ce.prototype,"onDrop",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ce.prototype,"onDragStart",void 0);Ce=__decorate([s.Component({selector:"segment-node",template:`<div cdkDropList [id]="node.uid" [cdkDropListData]="node" [cdkDropListConnectedTo]="connectedDropListsIds" (cdkDropListDropped)="onDragDrop($event)" [cdkDropListSortingDisabled]="false" [cdkDropListEnterPredicate]="canBeDropped" [ngClass]="{'perso-segments-tree__layout': isContainer(node), 'perso-segments-tree__empty-container': isEmptyContainer(node), 'perso-segments-tree__collapsed-container': collapsed }"><div><div class="perso-segments-tree" [ngClass]="{'perso-segments-tree__node': isItem(node), 'perso-segments-tree__container': isContainer(node)}"><div *ngIf="isContainer(node)"><div class="perso-segments-tree__toggle" (click)="toggle()" title="{{collapsed ? 'personalization.commons.icon.title.expand' : 'personalization.commons.icon.title.collapse' | translate}}" [ngClass]="collapsed ? 'sap-icon--navigation-right-arrow' : 'sap-icon--navigation-down-arrow'"></div><div class="perso-segments-tree__dropdown"><se-select [model]="node.operation.id" (modelChange)="operationChange($event)" [fetchStrategy]="fetchStrategy" [resetSearchInput]="false" [searchEnabled]="false"></se-select></div></div><div *ngIf="isItem(node)" class="perso-segments-tree__node-content">{{ node.selectedSegment.code }}</div><div *ngIf="isContainer(node)" class="perso-segments-tree__angular-ui-tree-handle--empty"></div><div><span class="perso-segments-tree__pull-right"><a *ngIf="isItem(node)" class="perso-segments-tree__actions perso-segments-tree__node-icon" (click)="duplicateItem(node)" title="{{'personalization.commons.icon.title.duplicate' | translate}}"><span class="sap-icon--duplicate"></span> </a><a *ngIf="!isTopContainer()" class="perso-segments-tree__actions" (click)="removeItem(node?.uid)"><div *ngIf="isContainer(node)" class="btn btn-link perso-segments-tree__container-btn-icon fd-has-margin-left-tiny" title="{{'personalization.commons.icon.title.remove' | translate}}"><span class="sap-icon--decline"></span></div><div *ngIf="isItem(node)" class="perso-segments-tree__node-icon" title="{{'personalization.commons.icon.title.remove' | translate}}"><span class="sap-icon--decline"></span></div></a></span><button *ngIf="isContainer(node)" class="fd-button--light perso-segments-tree__btn" (click)="newSubItem('container')"><span translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.button"></span></button></div></div><div *ngIf="isEmptyContainer(node) && !collapsed" class="perso-segments-tree__empty-container-node"><div class="perso-segments-tree__empty-container-node-text" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.dropzone"></div></div><ol *ngIf="!collapsed"><li cdkDrag [id]="innerNode.uid" [cdkDragData]="innerNode" (cdkDragStarted)="onDragStarted($event)" (cdkDragMoved)="onDragMoved($event)" (cdkDragReleased)="onDragReleased()" *ngFor="let innerNode of node.nodes"><segment-node [node]="innerNode" [expression]="expression" [connectedDropListsIds]="connectedDropListsIds" (expressionChange)="handleUpdate($event)" (onDrop)="onDragDrop($event)" (onDragStart)="onDragStarted($event)"></segment-node></li></ol></div></div>`,styles:[`ol{position:relative;margin:0;padding:0;list-style:none}.cdk-drag{list-style-type:none}.cdk-drag-preview{z-index:2000!important}.cdk-drag-placeholder{opacity:0!important}.cdk-drop-list-dragging{border-top:2px dashed rgba(0,0,0,.4);border-right:2px dashed rgba(0,0,0,.4);border-bottom:2px dashed rgba(0,0,0,.4)}`]}),__metadata("design:paramtypes",[t.TriggerService,m.IConfirmationModalService,v.TranslateService,ye])],Ce);window.__smartedit__.addDecoratorPayload("Component","SegmentViewComponent",{selector:"segment-view",template:`<label class="fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupexpression"></label><div><div class="form-group"><segment-expression-as-html [segmentExpression]="expression[0]"></segment-expression-as-html></div><div class="form-group"><label class="fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments"></label><se-select [model]="singleSegment.code" (modelChange)="segmentSelectedEvent($event)" [fetchStrategy]="segmentFetchStrategy" [itemComponent]="segmentPrinterComponent" [(reset)]="resetSelect" [placeholder]="'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder'"></se-select></div><segment-node *ngFor="let node of expression" [node]="node" [expression]="expression" [connectedDropListsIds]="connectedDropListsIds" (expressionChange)="handleTreeUpdated($event)" (onDrop)="onDropHandler($event)" (onDragStart)="onDragStart($event)"></segment-node></div>`});let be=class SegmentViewComponent{constructor(e,t,o,n,a,r){this.personalizationsmarteditRestService=e;this.personalizationsmarteditMessageHandler=t;this.triggerService=o;this.personalizationsmarteditUtils=n;this.translateService=a;this.yjQuery=r;this.expressionChange=new s.EventEmitter;this.segments=[];this.singleSegment={code:null};this.triggerLookupMap={};this.actions=this.triggerService.actions;this.segmentPrinterComponent=Se;this.nodeTemplate=Ce;this.connectedDropListsIds=[]}ngOnInit(){this.triggers=this.triggers||(this.targetGroupState.selectedVariation||{}).triggers;this.expression=this.expression||this.targetGroupState.expression;if(this.triggers&&this.triggers.length>0){this.expression=this.triggerService.buildData(this.triggers)}else{this.expression=[{uid:m.stringUtils.generateIdentifier(),type:p.TriggerType.CONTAINER_TYPE,operation:this.actions[0],nodes:[]}]}this.syncExpressionOnTriggerData();this.elementToScroll=this.yjQuery(".se-slider-panel__body");this.segmentFetchStrategy={fetchPage:(e,t,o)=>this.loadSegmentItems(e,t,o),fetchEntity:e=>Promise.resolve(this.segments.find((t=>t.code===e)))};this.getIdsRecursive(this.rootExpression)}get rootExpression(){var e;return((e=this.expression)===null||e===void 0?void 0:e.length)?this.expression[0]:null}segmentSelectedEvent(e){if(!e){this.singleSegment={code:null};return}const t=this.segments.find((t=>t.code===e));this.expression=[Object.assign(Object.assign({},this.rootExpression),{nodes:[{type:p.TriggerType.ITEM_TYPE,operation:null,selectedSegment:t,nodes:[],uid:m.stringUtils.generateIdentifier()}].concat(this.rootExpression.nodes)})];this.getIdsRecursive(this.rootExpression);setTimeout((()=>{this.resetSelect()}));this.syncExpressionOnTriggerData()}handleTreeUpdated(e){this.triggerLookupMap={};this.expression=d.cloneDeep(e);this.getIdsRecursive(this.rootExpression);this.syncExpressionOnTriggerData()}onDropHandler(e){this.scrollZoneVisible=false;if(e.container.id===e.previousContainer.id){const t=this.triggerLookupMap[e.container.id];I.moveItemInArray(t.nodes,e.previousIndex,e.currentIndex)}else{const t=this.triggerLookupMap[e.container.id];t.nodes.splice(e.currentIndex,0,e.item.data);const o=this.triggerLookupMap[e.previousContainer.id];o.nodes.splice(o.nodes.findIndex((t=>t.uid===e.item.data.uid)),1)}this.handleTreeUpdated(this.expression)}onDragStart(){this.scrollZoneVisible=this.isScrollZoneVisible()}loadSegmentItems(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.personalizationsmarteditRestService.getSegments({code:e,pageSize:t,currentPage:o});this.personalizationsmarteditUtils.uniqueArray(this.segments,n.segments||[]);return Object.assign(Object.assign({},n),{results:n.results.map((e=>Object.assign(Object.assign({},e),{id:e.code})))})}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingsegments"))}}))}syncExpressionOnTriggerData(){this.expressionChange.emit(this.expression)}getIdsRecursive(e){this.triggerLookupMap[e.uid]=e;(e.nodes||[]).forEach((e=>{if(!this.triggerService.isItem(e)){this.getIdsRecursive(e)}}));this.connectedDropListsIds=Object.keys(this.triggerLookupMap).reverse()}isScrollZoneVisible(){const e=this.yjQuery(".se-slider-panel__body").get(0);if(e){return e.scrollHeight>e.clientHeight}return false}};__decorate([s.Input(),__metadata("design:type",Object)],be.prototype,"targetGroupState",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],be.prototype,"expressionChange",void 0);be=__decorate([s.Component({selector:"segment-view",template:`<label class="fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupexpression"></label><div><div class="form-group"><segment-expression-as-html [segmentExpression]="expression[0]"></segment-expression-as-html></div><div class="form-group"><label class="fd-form__label" translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments"></label><se-select [model]="singleSegment.code" (modelChange)="segmentSelectedEvent($event)" [fetchStrategy]="segmentFetchStrategy" [itemComponent]="segmentPrinterComponent" [(reset)]="resetSelect" [placeholder]="'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder'"></se-select></div><segment-node *ngFor="let node of expression" [node]="node" [expression]="expression" [connectedDropListsIds]="connectedDropListsIds" (expressionChange)="handleTreeUpdated($event)" (onDrop)="onDropHandler($event)" (onDragStart)="onDragStart($event)"></segment-node></div>`}),__param(5,s.Inject(m.YJQUERY_TOKEN)),__metadata("design:paramtypes",[t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditMessageHandler,t.TriggerService,p.PersonalizationsmarteditUtils,v.TranslateService,Function])],be);let Ie=class PersonalizationsmarteditSegmentViewModule{};Ie=__decorate([s.NgModule({imports:[u.CommonModule,p.PersonalizationsmarteditCommonsComponentsModule,t.SePersonalizationsmarteditServicesModule,fe,ve,p.ScrollZoneModule,m.SelectModule,m.NgTreeModule,m.TranslationModule.forChild(),I.DragDropModule],providers:[ye],declarations:[be,Ce,Se],entryComponents:[be,Ce,Se],exports:[be]})],Ie);t.ManageCustomizationViewModule=class ManageCustomizationViewModule{};t.ManageCustomizationViewModule=__decorate([s.NgModule({imports:[u.CommonModule,b.FormsModule,m.TranslationModule.forChild(),p.DatetimePickerRangeModule,m.TabsModule,m.TooltipModule,m.SliderPanelModule,m.DropdownMenuModule,ve,Ie,ae],providers:[t.ManageCustomizationViewManager,t.CustomizationViewService,t.TriggerService],declarations:[t.BasicInfoTabComponent,le,ge,re,ce,pe,me,de,ue],entryComponents:[t.BasicInfoTabComponent,le,re,ce,pe,me,de,ue],exports:[t.BasicInfoTabComponent,le]})],t.ManageCustomizationViewModule);window.__smartedit__.addDecoratorPayload("Component","CustomizationsListComponent",{selector:"customizations-list",template:`<div class="pe-customize-panel-list"><div class="pe-customize-panel-list__header"><span class="pe-customize-panel-list__header--name" translate="personalization.toolbar.pagecustomizations.list.title"></span> <span class="pe-customize-panel-list__header--status" translate="personalization.toolbar.pagecustomizations.list.status"></span></div><div *ngFor="let customization of customizationsList; last as isLast; trackBy: customizationsListTrackBy" [ngClass]="isLast && customization.collapsed && isCustomizationFromCurrentCatalog(customization, isLast) ? 'pe-customize-panel-list__item-last':''"><div class="pe-customize-panel-list__row-layout" [ngClass]="getSelectedCustomizationClass(customization)"><div class="pe-customize-panel-list__icon-layout pe-customize-panel-list__icon-divider" (click)="customizationRowClick(customization)"><a class="pe-customize-panel-list__btn-link btn btn-link" title="{{(customization.collapsed ? 'personalization.commons.icon.title.expand' : 'personalization.commons.icon.title.collapse') | translate}}"><span [ngClass]="customization.collapsed ? 'sap-icon--navigation-right-arrow' : 'sap-icon--navigation-down-arrow'"></span></a></div><div class="pe-customize-panel-list__row" (click)="customizationRowClick(customization,true)"><div class="pe-customize-panel-list__col-lg"><div class="perso-wrap-ellipsis pe-customize-panel-list__parent-layout perso-tree__primary-data" [textContent]="customization.name" title="{{customization.name}}"></div></div><div class="pe-customize-panel-list__col-md"></div><div class="pe-customize-panel-list__col-md"><div class="perso-tree__status" [ngClass]="getActivityStateForCustomization(customization)" [textContent]="getEnablementTextForCustomization(customization)"></div><div class="perso-tree__dates-layout" *ngIf="isEnabled(customization)" [textContent]="getDatesForCustomization(customization)"></div></div><div class="pe-customize-panel-list__col-sm"><span *ngIf="!isCustomizationFromCurrentCatalog(customization)" class="perso__globe-icon sap-icon--globe"></span></div></div><div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"><div *ngIf="isCustomizationFromCurrentCatalog(customization)" class="y-dropdown-more-menu dropdown open"><button type="button" class="pe-customize-panel-list__btn-link fd-button--light customization-rank-{{customization.rank}}-dropdown-toggle" (click)="customizationSubMenuAction(customization)"><span class="perso__more-icon sap-icon--overflow"></span></button><ul *ngIf="customization.subMenu" class="se-y-dropdown-menu__list fd-menu__list dropdown-menu" role="menu"><li><a class="se-dropdown-item fd-menu__item cutomization-rank-{{customization.rank}}-edit-button" (click)="clearAllSubMenu();editCustomizationAction(customization)" translate="personalization.toolbar.pagecustomizations.customization.options.edit"></a></li></ul></div></div></div><div *ngIf="!customization.collapsed"><div class="pe-customize-panel-list__row-layout" *ngFor="let variation of customization.variations" [ngClass]="getSelectedVariationClass(variation)" (click)="clearAllSubMenu();variationClick(customization, variation)"><div class="pe-customize-panel-list__icon-layout"><div class="pe-customize-panel-list__btn-link btn btn-link"></div></div><div class="pe-customize-panel-list__row"><div class="pe-customize-panel-list__col-lg"><div class="perso-wrap-ellipsis pe-customize-panel-list__child-layout" [textContent]="variation.name" title="{{variation.name}}"></div></div><div class="pe-customize-panel-list__col-md"><div class="pe-customize-panel-list__components-layout"><div [hidden]="variation.numberOfAffectedComponents &lt; 0" class="pe-customize-panel-list__number-layout">{{variation.numberOfAffectedComponents}}</div><div [hidden]="variation.numberOfAffectedComponents >= 0" class="pe-customize-panel-list__number-layout">#</div><div class="perso-wrap-ellipsis" translate="personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label" title="{{'personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label' | translate}}"></div></div></div><div class="pe-customize-panel-list__col-md perso-tree__status" [ngClass]="getActivityStateForVariation(customization, variation)" [textContent]="getEnablementTextForVariation(variation)"></div><div class="pe-customize-panel-list__col-sm"><span class="perso__cc-icon sap-icon--tag" [ngClass]="{'perso__cc-icon--hidden': !hasCommerceActions(variation)}" [title]="getCommerceCustomizationTooltip(variation)"></span></div></div><div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"></div></div></div></div></div><div class="pe-spinner--outer" [hidden]="!requestProcessing"><div class="spinner-md spinner-light"></div></div>`});t.CustomizationsListComponent=class CustomizationsListComponent{constructor(e,t,o,n,s,a,r,d,p,m,g,u,v){this.translateService=e;this.personalizationsmarteditContextService=t;this.personalizationsmarteditRestService=o;this.personalizationsmarteditCommerceCustomizationService=n;this.personalizationsmarteditMessageHandler=s;this.personalizationsmarteditUtils=a;this.personalizationsmarteditDateUtils=r;this.personalizationsmarteditContextUtils=d;this.personalizationsmarteditPreviewService=p;this.personalizationsmarteditManager=m;this.customizeViewServiceProxy=g;this.systemEventService=u;this.crossFrameEventService=v;this.sourceContainersComponentsInfo={};this.customizationsListPreCount=0}ngOnDestroy(){if(this.customizationsModifiedUnsubscribe){this.customizationsModifiedUnsubscribe()}}ngOnInit(){this.sourceContainersComponentsInfo={};this.customizationsModifiedUnsubscribe=this.systemEventService.subscribe("CUSTOMIZATIONS_MODIFIED",(()=>{this.refreshCustomizeContext()}))}ngDoCheck(){if(this.customizationsListPreCount!==this.customizationsList.length){this.updateCustomizationList();this.customizationsListPreCount=this.customizationsList.length}}updateCustomizationList(){this.customizationsList.forEach((e=>{e.collapsed=true;if((this.personalizationsmarteditContextService.getCustomize().selectedCustomization||{}).code===e.code){e.collapsed=false;this.updateCustomizationData(e)}this.personalizationsmarteditUtils.getAndSetCatalogVersionNameL10N(e)}))}editCustomizationAction(e){this.personalizationsmarteditContextUtils.clearCombinedViewContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService);this.personalizationsmarteditManager.openEditCustomizationModal(e.code,"")}customizationRowClick(e,t){this.clearAllSubMenu();e.collapsed=!e.collapsed;if(!e.collapsed){this.updateCustomizationData(e)}if(t){this.customizationClick(e)}this.customizationsList.filter((t=>e.code!==t.code)).forEach((e=>{e.collapsed=true}))}customizationClick(e){const t=this.personalizationsmarteditContextService.getCombinedView();const o=this.personalizationsmarteditContextService.getCustomize().selectedVariations;const n=this.getVisibleVariations(e);const s=this.personalizationsmarteditContextService.getCustomize();s.selectedCustomization=e;s.selectedVariations=n;this.personalizationsmarteditContextService.setCustomize(s);if(n.length>0){const t=this.personalizationsmarteditUtils.getVariationCodes(n).join(",");this.getAndSetComponentsForVariation(e.code,t,e.catalog,e.catalogVersion)}if(d.isObjectLike(o)&&!d.isArray(o)||t.enabled){this.updatePreviewTicket()}this.personalizationsmarteditContextUtils.clearCombinedViewContext(this.personalizationsmarteditContextService);this.crossFrameEventService.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)}getSelectedVariationClass(e){if(d.isEqual(e.code,(this.personalizationsmarteditContextService.getCustomize().selectedVariations||{}).code)){return"selectedVariation"}else{return""}}getSelectedCustomizationClass(e){if(d.isEqual(e.code,(this.personalizationsmarteditContextService.getCustomize().selectedCustomization||{}).code)&&d.isArray(this.personalizationsmarteditContextService.getCustomize().selectedVariations)){return"selectedCustomization"}else{return""}}variationClick(e,t){const o=this.personalizationsmarteditContextService.getCustomize();o.selectedCustomization=e;o.selectedVariations=t;this.personalizationsmarteditContextService.setCustomize(o);this.personalizationsmarteditContextUtils.clearCombinedViewContext(this.personalizationsmarteditContextService);this.getAndSetComponentsForVariation(e.code,t.code,e.catalog,e.catalogVersion);this.updatePreviewTicket(e.code,[t]);this.crossFrameEventService.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)}hasCommerceActions(e){return this.personalizationsmarteditUtils.hasCommerceActions(e)}getCommerceCustomizationTooltip(e){return this.personalizationsmarteditUtils.getCommerceCustomizationTooltip(e,"","")}getActivityStateForCustomization(e){return this.personalizationsmarteditUtils.getActivityStateForCustomization(e)}customizationsListTrackBy(e,t){return e}getActivityStateForVariation(e,t){return this.personalizationsmarteditUtils.getActivityStateForVariation(e,t)}clearAllSubMenu(){for(const e of this.customizationsList){e.subMenu=false}}getEnablementTextForCustomization(e){return this.personalizationsmarteditUtils.getEnablementTextForCustomization(e,"personalization.toolbar.pagecustomizations")}getEnablementTextForVariation(e){return this.personalizationsmarteditUtils.getEnablementTextForVariation(e,"personalization.toolbar.pagecustomizations")}isEnabled(e){return this.personalizationsmarteditUtils.isPersonalizationItemEnabled(e)}getDatesForCustomization(e){let t="";let o="";let n="";if(e.enabledStartDate||e.enabledEndDate){o=this.personalizationsmarteditDateUtils.formatDateWithMessage(e.enabledStartDate);n=this.personalizationsmarteditDateUtils.formatDateWithMessage(e.enabledEndDate);if(!e.enabledStartDate){o=" ..."}if(!e.enabledEndDate){n="... "}t+=" ("+o+" - "+n+") "}return t}customizationSubMenuAction(e){if(!e.subMenu){this.clearAllSubMenu()}e.subMenu=!e.subMenu}isCustomizationFromCurrentCatalog(e){return this.personalizationsmarteditUtils.isItemFromCurrentCatalog(e,this.personalizationsmarteditContextService.getSeData())}statusNotDeleted(e){return this.personalizationsmarteditUtils.isItemVisible(e)}matchActionForVariation(e,t){return e.variationCode===t.code&&e.actionCatalog===t.catalog&&e.actionCatalogVersion===t.catalogVersion}numberOfAffectedComponentsForActions(e){let t=0;e.forEach((e=>{t+=parseInt(this.sourceContainersComponentsInfo[e.containerId],10)||0}));return t}initSourceContainersComponentsInfo(){const e=m.promiseUtils.defer();this.customizeViewServiceProxy.getSourceContainersInfo().then((t=>{this.sourceContainersComponentsInfo=t;e.resolve()}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingnumberofaffectedcomponentsforvariation"));e.reject()}));return e.promise}paginatedGetAndSetNumberOfAffectedComponentsForVariations(e,t){this.personalizationsmarteditRestService.getCxCmsActionsOnPageForCustomization(e,t).then((o=>{e.variations.forEach((e=>{const n=o.actions.filter((t=>this.matchActionForVariation(t,e)));e.numberOfAffectedComponents=t===0?0:e.numberOfAffectedComponents;e.numberOfAffectedComponents+=this.numberOfAffectedComponentsForActions(n)}));const n=t+1;if(n<o.pagination.totalPages){this.paginatedGetAndSetNumberOfAffectedComponentsForVariations(e,n)}}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingnumberofaffectedcomponentsforvariation"))}))}getAndSetNumberOfAffectedComponentsForVariations(e){const t=this.personalizationsmarteditContextService.getCustomize();const o=(t.selectedComponents||[]).every((e=>this.sourceContainersComponentsInfo[e]!==undefined));if(!o||t.selectedComponents===null||d.isEqual(this.sourceContainersComponentsInfo,{})){this.initSourceContainersComponentsInfo().finally((()=>{this.paginatedGetAndSetNumberOfAffectedComponentsForVariations(e,0)}))}else if(o){this.paginatedGetAndSetNumberOfAffectedComponentsForVariations(e,0)}}getNumberOfAffectedComponentsForCorrespondingVariation(e,t){const o=e.filter((e=>e.code===t));return(o[0]||{}).numberOfAffectedComponents}updateCustomizationData(e){this.personalizationsmarteditRestService.getVariationsForCustomization(e.code,e).then((t=>{const o=t.variations?d.cloneDeep(t.variations):[];o.forEach(((t,n)=>{if(!this.statusNotDeleted(t)){o.splice(n,1)}else{t.numberOfAffectedComponents=this.getNumberOfAffectedComponentsForCorrespondingVariation(e.variations,t.code);t.numberOfCommerceActions=this.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCount(t);t.commerceCustomizations=this.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCountMap(t)}}));e.variations=o||[];this.getAndSetNumberOfAffectedComponentsForVariations(e)}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomization"))}))}getVisibleVariations(e){return this.personalizationsmarteditUtils.getVisibleItems(e.variations)}getAndSetComponentsForVariation(e,t,o,n){this.personalizationsmarteditRestService.getComponentsIdsForVariation(e,t,o,n).then((e=>{const t=this.personalizationsmarteditContextService.getCustomize();t.selectedComponents=e.components;this.personalizationsmarteditContextService.setCustomize(t)}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcomponentsforvariation"))}))}updatePreviewTicket(e,t){const o=this.personalizationsmarteditUtils.getVariationKey(e,t);this.personalizationsmarteditPreviewService.updatePreviewTicketWithVariations(o)}refreshCustomizeContext(){const e=d.cloneDeep(this.personalizationsmarteditContextService.getCustomize());if(e.selectedCustomization){this.personalizationsmarteditRestService.getCustomization(e.selectedCustomization).then((t=>{e.selectedCustomization=t;if(e.selectedVariations&&!d.isArray(e.selectedVariations)){t.variations.filter((t=>e.selectedVariations.code===t.code)).forEach((t=>{e.selectedVariations=t;if(!this.personalizationsmarteditUtils.isItemVisible(t)){e.selectedCustomization=null;e.selectedVariations=null;this.personalizationsmarteditPreviewService.removePersonalizationDataFromPreview()}}))}this.personalizationsmarteditContextService.setCustomize(e)}),(()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomization"))}))}}};__decorate([s.Input(),__metadata("design:type",Array)],t.CustomizationsListComponent.prototype,"customizationsList",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],t.CustomizationsListComponent.prototype,"requestProcessing",void 0);t.CustomizationsListComponent=__decorate([s.Component({selector:"customizations-list",template:`<div class="pe-customize-panel-list"><div class="pe-customize-panel-list__header"><span class="pe-customize-panel-list__header--name" translate="personalization.toolbar.pagecustomizations.list.title"></span> <span class="pe-customize-panel-list__header--status" translate="personalization.toolbar.pagecustomizations.list.status"></span></div><div *ngFor="let customization of customizationsList; last as isLast; trackBy: customizationsListTrackBy" [ngClass]="isLast && customization.collapsed && isCustomizationFromCurrentCatalog(customization, isLast) ? 'pe-customize-panel-list__item-last':''"><div class="pe-customize-panel-list__row-layout" [ngClass]="getSelectedCustomizationClass(customization)"><div class="pe-customize-panel-list__icon-layout pe-customize-panel-list__icon-divider" (click)="customizationRowClick(customization)"><a class="pe-customize-panel-list__btn-link btn btn-link" title="{{(customization.collapsed ? 'personalization.commons.icon.title.expand' : 'personalization.commons.icon.title.collapse') | translate}}"><span [ngClass]="customization.collapsed ? 'sap-icon--navigation-right-arrow' : 'sap-icon--navigation-down-arrow'"></span></a></div><div class="pe-customize-panel-list__row" (click)="customizationRowClick(customization,true)"><div class="pe-customize-panel-list__col-lg"><div class="perso-wrap-ellipsis pe-customize-panel-list__parent-layout perso-tree__primary-data" [textContent]="customization.name" title="{{customization.name}}"></div></div><div class="pe-customize-panel-list__col-md"></div><div class="pe-customize-panel-list__col-md"><div class="perso-tree__status" [ngClass]="getActivityStateForCustomization(customization)" [textContent]="getEnablementTextForCustomization(customization)"></div><div class="perso-tree__dates-layout" *ngIf="isEnabled(customization)" [textContent]="getDatesForCustomization(customization)"></div></div><div class="pe-customize-panel-list__col-sm"><span *ngIf="!isCustomizationFromCurrentCatalog(customization)" class="perso__globe-icon sap-icon--globe"></span></div></div><div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"><div *ngIf="isCustomizationFromCurrentCatalog(customization)" class="y-dropdown-more-menu dropdown open"><button type="button" class="pe-customize-panel-list__btn-link fd-button--light customization-rank-{{customization.rank}}-dropdown-toggle" (click)="customizationSubMenuAction(customization)"><span class="perso__more-icon sap-icon--overflow"></span></button><ul *ngIf="customization.subMenu" class="se-y-dropdown-menu__list fd-menu__list dropdown-menu" role="menu"><li><a class="se-dropdown-item fd-menu__item cutomization-rank-{{customization.rank}}-edit-button" (click)="clearAllSubMenu();editCustomizationAction(customization)" translate="personalization.toolbar.pagecustomizations.customization.options.edit"></a></li></ul></div></div></div><div *ngIf="!customization.collapsed"><div class="pe-customize-panel-list__row-layout" *ngFor="let variation of customization.variations" [ngClass]="getSelectedVariationClass(variation)" (click)="clearAllSubMenu();variationClick(customization, variation)"><div class="pe-customize-panel-list__icon-layout"><div class="pe-customize-panel-list__btn-link btn btn-link"></div></div><div class="pe-customize-panel-list__row"><div class="pe-customize-panel-list__col-lg"><div class="perso-wrap-ellipsis pe-customize-panel-list__child-layout" [textContent]="variation.name" title="{{variation.name}}"></div></div><div class="pe-customize-panel-list__col-md"><div class="pe-customize-panel-list__components-layout"><div [hidden]="variation.numberOfAffectedComponents &lt; 0" class="pe-customize-panel-list__number-layout">{{variation.numberOfAffectedComponents}}</div><div [hidden]="variation.numberOfAffectedComponents >= 0" class="pe-customize-panel-list__number-layout">#</div><div class="perso-wrap-ellipsis" translate="personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label" title="{{'personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label' | translate}}"></div></div></div><div class="pe-customize-panel-list__col-md perso-tree__status" [ngClass]="getActivityStateForVariation(customization, variation)" [textContent]="getEnablementTextForVariation(variation)"></div><div class="pe-customize-panel-list__col-sm"><span class="perso__cc-icon sap-icon--tag" [ngClass]="{'perso__cc-icon--hidden': !hasCommerceActions(variation)}" [title]="getCommerceCustomizationTooltip(variation)"></span></div></div><div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"></div></div></div></div></div><div class="pe-spinner--outer" [hidden]="!requestProcessing"><div class="spinner-md spinner-light"></div></div>`}),__metadata("design:paramtypes",[v.TranslateService,t.PersonalizationsmarteditContextService,t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditCommerceCustomizationService,p.PersonalizationsmarteditMessageHandler,p.PersonalizationsmarteditUtils,p.PersonalizationsmarteditDateUtils,p.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditPreviewService,t.ManageCustomizationViewManager,t.CustomizeViewServiceProxy,m.SystemEventService,m.CrossFrameEventService])],t.CustomizationsListComponent);window.__smartedit__.addDecoratorPayload("Component","CustomizeViewComponent",{selector:"customize-view",template:`<div class="btn-block pe-toolbar-action--include"><div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized-customizations-panel" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><div class="se-toolbar-menu-content--pe-customized__headers--wrapper"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2"><span translate="personalization.toolbar.pagecustomizations.header.title"></span> ({{pagination.totalCount}})</h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.pagecustomizations.header.description"></span></se-help></div><div class="se-input-group se-component-search"><input type="text" id="customization-search-name" class="se-input-group--input se-component-search--input" [(ngModel)]="nameFilter" [placeholder]="'personalization.toolbar.pagecustomizations.search.placeholder' | translate" (ngModelChange)="nameInputKeypress()"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div></div><div role="menuitem"><div id="personalizationsmartedit-right-toolbar-item-template"><div class="pe-customize-panel__filter-label-layout"><div class="pe-customize-panel__filter-layout"><page-filter-dropdown (onSelectCallback)="pageFilterChange($event)" [initialValue]="pageFilter" class="perso-filter__wrapper perso-filter__wrapper--page"></page-filter-dropdown><has-multicatalog class="perso-filter__wrapper perso-filter__wrapper--catalog"><catalog-filter-dropdown (onSelectCallback)="catalogFilterChange($event)" [initialValue]="catalogFilter"></catalog-filter-dropdown></has-multicatalog><status-filter-dropdown (onSelectCallback)="statusFilterChange($event)" [initialValue]="statusFilter" class="perso-filter__wrapper perso-filter__wrapper--status"></status-filter-dropdown></div></div><personalization-infinite-scrolling [dropDownContainerClass]="'pe-customize-panel__wrapper'" [fetchPage]="getPage"><customizations-list [customizationsList]="customizationsList" [requestProcessing]="moreCustomizationsRequestProcessing"></customizations-list></personalization-infinite-scrolling></div></div></div></div>`});t.CustomizeViewComponent=class CustomizeViewComponent{constructor(e,t,o,n,s){this.translateService=e;this.customizationDataFactory=t;this.personalizationsmarteditContextService=o;this.personalizationsmarteditMessageHandler=n;this.personalizationsmarteditUtils=s;this.getPage=()=>this.addMoreCustomizationItems()}ngOnInit(){this.personalizationsmarteditContextService.refreshExperienceData();this.moreCustomizationsRequestProcessing=false;this.customizationsList=this.customizationDataFactory.items;this.customizationDataFactory.resetData();this.pagination=new p.PaginationHelper({});this.pagination.reset();this.filters=this.personalizationsmarteditContextService.getCustomizeFiltersState();this.catalogFilter=this.filters.catalogFilter;this.pageFilter=this.filters.pageFilter;this.statusFilter=this.filters.statusFilter;this.nameFilter=this.filters.nameFilter;this.showResetButton=false}ngOnDestroy(){const e=this.personalizationsmarteditContextService.getCustomizeFiltersState();e.catalogFilter=this.catalogFilter;e.pageFilter=this.pageFilter;e.statusFilter=this.statusFilter;e.nameFilter=this.nameFilter;this.personalizationsmarteditContextService.setCustomizeFiltersState(e)}catalogFilterChange(e){this.catalogFilter=e;this.refreshList()}pageFilterChange(e){this.pageFilter=e;this.refreshList()}statusFilterChange(e){this.statusFilter=e;this.refreshList()}nameInputKeypress(){if(this.nameFilter.length>0){this.showResetButton=true}if(this.nameFilter.length>2||this.nameFilter.length===0){this.refreshList()}}resetSearch(e){if(e){e.stopPropagation()}this.nameFilter="";this.showResetButton=false;this.refreshList()}addMoreCustomizationItems(){if(this.pagination.getPage()<this.pagination.getTotalPages()-1&&!this.moreCustomizationsRequestProcessing){this.moreCustomizationsRequestProcessing=true;this.getCustomizations(this.getCustomizationsFilterObject())}}errorCallback(){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomizations"));this.moreCustomizationsRequestProcessing=false}successCallback(e){this.pagination=new p.PaginationHelper(e.pagination);this.moreCustomizationsRequestProcessing=false}getStatus(){if(this.statusFilter===undefined){return this.personalizationsmarteditUtils.getStatusesMapping()[0]}return this.personalizationsmarteditUtils.getStatusesMapping().filter((e=>e.code===this.statusFilter))[0]}getCustomizations(e){const t={filter:e,dataArrayName:"customizations"};this.customizationDataFactory.updateData(t,this.successCallback.bind(this),this.errorCallback.bind(this))}getCustomizationsFilterObject(){const e={currentSize:this.pagination.getCount(),currentPage:this.pagination.getPage()+1,name:this.nameFilter,statuses:this.getStatus().modelStatuses,catalogs:this.catalogFilter};if(this.pageFilter===p.PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER.ONLY_THIS_PAGE){e.pageId=this.personalizationsmarteditContextService.getSeData().pageId;e.pageCatalogId=(this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext||{}).catalogId}return e}refreshList(){if(this.moreCustomizationsRequestProcessing===false){this.moreCustomizationsRequestProcessing=true;this.pagination.reset();this.customizationDataFactory.resetData();this.getCustomizations(this.getCustomizationsFilterObject())}}};__decorate([s.Input(),__metadata("design:type",Boolean)],t.CustomizeViewComponent.prototype,"isMenuOpen",void 0);t.CustomizeViewComponent=__decorate([s.Component({selector:"customize-view",template:`<div class="btn-block pe-toolbar-action--include"><div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized-customizations-panel" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><div class="se-toolbar-menu-content--pe-customized__headers--wrapper"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2"><span translate="personalization.toolbar.pagecustomizations.header.title"></span> ({{pagination.totalCount}})</h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.pagecustomizations.header.description"></span></se-help></div><div class="se-input-group se-component-search"><input type="text" id="customization-search-name" class="se-input-group--input se-component-search--input" [(ngModel)]="nameFilter" [placeholder]="'personalization.toolbar.pagecustomizations.search.placeholder' | translate" (ngModelChange)="nameInputKeypress()"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div></div><div role="menuitem"><div id="personalizationsmartedit-right-toolbar-item-template"><div class="pe-customize-panel__filter-label-layout"><div class="pe-customize-panel__filter-layout"><page-filter-dropdown (onSelectCallback)="pageFilterChange($event)" [initialValue]="pageFilter" class="perso-filter__wrapper perso-filter__wrapper--page"></page-filter-dropdown><has-multicatalog class="perso-filter__wrapper perso-filter__wrapper--catalog"><catalog-filter-dropdown (onSelectCallback)="catalogFilterChange($event)" [initialValue]="catalogFilter"></catalog-filter-dropdown></has-multicatalog><status-filter-dropdown (onSelectCallback)="statusFilterChange($event)" [initialValue]="statusFilter" class="perso-filter__wrapper perso-filter__wrapper--status"></status-filter-dropdown></div></div><personalization-infinite-scrolling [dropDownContainerClass]="'pe-customize-panel__wrapper'" [fetchPage]="getPage"><customizations-list [customizationsList]="customizationsList" [requestProcessing]="moreCustomizationsRequestProcessing"></customizations-list></personalization-infinite-scrolling></div></div></div></div>`}),__metadata("design:paramtypes",[v.TranslateService,$,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditMessageHandler,p.PersonalizationsmarteditUtils])],t.CustomizeViewComponent);t.SePersonalizationsmarteditCustomizeViewModule=class SePersonalizationsmarteditCustomizeViewModule{};t.SePersonalizationsmarteditCustomizeViewModule=__decorate([s.NgModule({imports:[u.CommonModule,b.FormsModule,m.TranslationModule.forChild(),m.SharedComponentsModule,t.SePersonalizationsmarteditServicesModule,K,U,p.PersonalizationsmarteditCommonsComponentsModule],declarations:[t.CustomizationsListComponent,t.CustomizeViewComponent],entryComponents:[t.CustomizationsListComponent,t.CustomizeViewComponent],providers:[t.CustomizeViewServiceProxy],exports:[]})],t.SePersonalizationsmarteditCustomizeViewModule);t.ManagerViewUtilsService=class ManagerViewUtilsService{constructor(e,t,o,n,s,a){this.personalizationsmarteditRestService=e;this.personalizationsmarteditMessageHandler=t;this.personalizationsmarteditCommerceCustomizationService=o;this.waitDialogService=n;this.confirmationModalService=s;this.translateService=a}deleteCustomizationAction(e,t){return __awaiter(this,void 0,void 0,(function*(){yield this.confirmationModalService.confirm({description:"personalization.modal.manager.deletecustomization.content"});try{const o=yield this.personalizationsmarteditRestService.getCustomization(e);yield this.markCustomizationAsDeleted(o,e,t)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.deletingcustomization"))}}))}deleteVariationAction(e,t){return __awaiter(this,void 0,void 0,(function*(){yield this.confirmationModalService.confirm({description:"personalization.modal.manager.deletevariation.content"});try{const o=yield this.personalizationsmarteditRestService.getVariation(e.code,t.code);o.status=p.PERSONALIZATION_MODEL_STATUS_CODES.DELETED;yield this.updateVariationStatus(o,t,e)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.deletingvariation"))}}))}toggleVariationActive(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield this.personalizationsmarteditRestService.getVariation(e.code,t.code);o.enabled=!o.enabled;o.status=o.enabled?p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:p.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED;yield this.updateVariationStatusAndEnablement(o,t,e)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingvariation"))}}))}customizationClickAction(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.personalizationsmarteditRestService.getVariationsForCustomization(e.code,e);e.variations.forEach((e=>{e.actions=this.getActionsForVariation(e.code,t.variations);e.numberOfComponents=this.personalizationsmarteditCommerceCustomizationService.getNonCommerceActionsCount(e);e.commerceCustomizations=this.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCountMap(e);e.numberOfCommerceActions=this.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCount(e)}))}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomization"))}}))}getCustomizations(e){return this.personalizationsmarteditRestService.getCustomizations(e)}updateCustomizationRank(e,t){return this.personalizationsmarteditRestService.updateCustomizationRank(e,t).catch((()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.updatingcustomization"))}))}updateVariationRank(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.personalizationsmarteditRestService.getVariation(e.code,t);n.rank=n.rank+o;return this.personalizationsmarteditRestService.editVariation(e.code,n).catch((()=>{this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.editingvariation"))}))}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingvariation"))}}))}setCustomizationRank(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=o[o.indexOf(e)+t];this.waitDialogService.showWaitModal();try{yield this.updateCustomizationRank(e.code,n.rank-e.rank);e.rank+=t;n.rank-=t;const s=o.indexOf(e);const a=o.splice(s,1);o.splice(s+t,0,a[0]);this.waitDialogService.hideWaitModal()}catch(e){this.waitDialogService.hideWaitModal()}}))}setVariationRank(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=e.variations[e.variations.indexOf(t)+o];this.waitDialogService.showWaitModal();try{yield this.updateVariationRank(e,t.code,o);t.rank+=o;n.rank-=o;const s=e.variations.indexOf(t);const a=e.variations.splice(s,1);e.variations.splice(s+o,0,a[0])}catch(e){console.log("Unexpected error occurred while updating variation rank",e)}finally{this.waitDialogService.hideWaitModal()}}))}getActionsForVariation(e,t){t=t||[];const o=t.filter((t=>e===t.code))[0];return o?o.actions:[]}markCustomizationAsDeleted(e,t,o){return __awaiter(this,void 0,void 0,(function*(){e.status=p.PERSONALIZATION_MODEL_STATUS_CODES.DELETED;try{yield this.personalizationsmarteditRestService.updateCustomization(e);o.splice(o.indexOf(t),1)}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.deletingcustomization"))}}))}updateVariationStatus(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.personalizationsmarteditRestService.editVariation(o.code,e);t.status=n.status}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.deletingvariation"))}}))}updateVariationStatusAndEnablement(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.personalizationsmarteditRestService.editVariation(o.code,e);t.enabled=n.enabled;t.status=n.status}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.editingvariation"))}}))}};t.ManagerViewUtilsService.$inject=["personalizationsmarteditRestService","personalizationsmarteditMessageHandler","personalizationsmarteditCommerceCustomizationService","waitDialogService","confirmationModalService","translateService"];t.ManagerViewUtilsService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.PersonalizationsmarteditRestService,p.PersonalizationsmarteditMessageHandler,p.PersonalizationsmarteditCommerceCustomizationService,m.IWaitDialogService,m.IConfirmationModalService,v.TranslateService])],t.ManagerViewUtilsService);window.__smartedit__.addDecoratorPayload("Component","ManagerViewComponent",{selector:"customizations-list",template:`<div id="editConfigurationsBody-001" class="perso-library"><personalization-infinite-scrolling [fetchPage]="getPage"><div #managerScrollZone id="managerScrollZone" class="perso-library__scroll-zone perso__scrollbar--hidden"><div class="perso-library__header"><div class="perso-library__title"><span [textContent]="catalogName"></span> | {{'personalization.toolbar.pagecustomizations.header.title' | translate}} ({{pagination.totalCount}})</div><div class="se-input-group"><div class="perso-input-group"><input id="customizationSearchInput" name="customizationSearchInput" type="text" class="se-input-group--input se-component-search--input" [placeholder]="'personalization.modal.manager.search.placeholder' | translate" [(ngModel)]="customizationSearch.name" (ngModelChange)="searchInputKeypress()"><span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div></div><status-filter-dropdown (onSelectCallback)="statusFilterChange($event)" [initialValue]="customizationSearch.status" class="perso-library__header-space"></status-filter-dropdown><div class="perso-library__header-space"><button class="fd-button" type="button" (click)="openNewModal()"><span translate="personalization.modal.manager.add.button"></span></button></div></div><div class="y-tree perso-library__y-tree"><div class="y-tree-header"><manager-view-grid-header></manager-view-grid-header></div><manager-view-tree [customizations]="customizations"></manager-view-tree><div class="pe-spinner--outer" [hidden]="!moreCustomizationsRequestProcessing"><div class="spinner-md spinner-light"></div></div></div></div></personalization-infinite-scrolling><personalizationsmartedit-scroll-zone *ngIf="scrollZoneElement != null && elementToScroll" [isTransparent]="true" [scrollZoneVisible]="scrollZoneVisible" [elementToScroll]="elementToScroll"></personalizationsmartedit-scroll-zone><a class="perso-library__back-to-top" translate="personalization.commons.button.title.backtotop" [hidden]="!isReturnToTopButtonVisible()" (click)="scrollZoneReturnToTop()"><span class="sap-icon--back-to-top"></span></a></div>`});t.ManagerViewComponent=class ManagerViewComponent{constructor(e,t,o,n,s,a,r){this.translateService=e;this.managerViewUtilsService=t;this.messageHandler=o;this.contextService=n;this.utils=s;this.manageCustomizationViewManager=a;this.systemEventService=r;this.getPage=()=>this.addMoreItems();const d=this.contextService.getSeData().seExperienceData;const m=d.languageDescriptor.isocode;this.catalogName=`${d.catalogDescriptor.name[m]} - ${d.catalogDescriptor.catalogVersion}`;this.customizations=[];this.showResetButton=false;this.customizationSearch={name:"",status:""};this.moreCustomizationsRequestProcessing=false;this.pagination=new p.PaginationHelper;this.pagination.reset();this.scrollZoneObject={scrollZoneElement:undefined,filteredCustomizationsCount:0}}ngOnDestroy(){if(this.customizationsModifiedUnsubscribe){this.customizationsModifiedUnsubscribe()}}ngOnInit(){this.customizationsModifiedUnsubscribe=this.systemEventService.subscribe("CUSTOMIZATIONS_MODIFIED",(()=>{this.refreshGrid()}))}ngAfterViewInit(){this.scrollZoneObject.scrollZoneElement=this.managerScrollZone.nativeElement}searchInputKeypress(){if(this.customizationSearch.name.length>0){this.showResetButton=true}if(this.customizationSearch.name.length>2||this.customizationSearch.name.length===0){this.refreshGrid()}}resetSearch(e){if(e){e.stopPropagation()}this.customizationSearch.name="";this.showResetButton=false;this.refreshGrid()}statusFilterChange(e){this.customizationSearch.status=e;this.refreshGrid()}addMoreItems(){if(this.pagination.getPage()<this.pagination.getTotalPages()-1&&!this.moreCustomizationsRequestProcessing){this.moreCustomizationsRequestProcessing=true;this.getCustomizations(this.getCustomizationsFilterObject())}}openNewModal(){this.manageCustomizationViewManager.openCreateCustomizationModal()}isSearchGridHeaderHidden(){if(!this.scrollZoneObject.scrollZoneElement){return false}return this.scrollZoneObject.scrollZoneElement.scrollTop>=120}scrollZoneReturnToTop(){setTimeout((()=>{this.scrollZoneObject.scrollZoneElement.scrollTop=0}),500)}isReturnToTopButtonVisible(){if(!this.scrollZoneObject.scrollZoneElement){return false}else{return this.scrollZoneObject.scrollZoneElement.scrollTop>50}}refreshGrid(){this.pagination.reset();this.customizations=[];this.addMoreItems()}getCustomizations(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.managerViewUtilsService.getCustomizations(e);try{this.utils.uniqueArray(this.customizations,t.customizations||[]);this.scrollZoneObject.filteredCustomizationsCount=t.pagination.totalCount;this.pagination=new p.PaginationHelper(t.pagination);this.moreCustomizationsRequestProcessing=false}catch(e){this.messageHandler.sendError(this.translateService.instant("personalization.error.gettingcustomizations"));this.moreCustomizationsRequestProcessing=false}}))}getCustomizationsFilterObject(){return{active:"all",name:this.customizationSearch.name,currentSize:this.pagination.getCount(),currentPage:this.pagination.getPage()+1,statuses:this.getStatus().modelStatuses}}getStatus(){if(this.customizationSearch.status===""){return this.utils.getStatusesMapping()[0]}return this.utils.getStatusesMapping().filter((e=>e.code===this.customizationSearch.status))[0]}};__decorate([s.ViewChild("managerScrollZone",{static:false}),__metadata("design:type",s.ElementRef)],t.ManagerViewComponent.prototype,"managerScrollZone",void 0);t.ManagerViewComponent=__decorate([s.Component({selector:"customizations-list",template:`<div id="editConfigurationsBody-001" class="perso-library"><personalization-infinite-scrolling [fetchPage]="getPage"><div #managerScrollZone id="managerScrollZone" class="perso-library__scroll-zone perso__scrollbar--hidden"><div class="perso-library__header"><div class="perso-library__title"><span [textContent]="catalogName"></span> | {{'personalization.toolbar.pagecustomizations.header.title' | translate}} ({{pagination.totalCount}})</div><div class="se-input-group"><div class="perso-input-group"><input id="customizationSearchInput" name="customizationSearchInput" type="text" class="se-input-group--input se-component-search--input" [placeholder]="'personalization.modal.manager.search.placeholder' | translate" [(ngModel)]="customizationSearch.name" (ngModelChange)="searchInputKeypress()"><span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div></div><status-filter-dropdown (onSelectCallback)="statusFilterChange($event)" [initialValue]="customizationSearch.status" class="perso-library__header-space"></status-filter-dropdown><div class="perso-library__header-space"><button class="fd-button" type="button" (click)="openNewModal()"><span translate="personalization.modal.manager.add.button"></span></button></div></div><div class="y-tree perso-library__y-tree"><div class="y-tree-header"><manager-view-grid-header></manager-view-grid-header></div><manager-view-tree [customizations]="customizations"></manager-view-tree><div class="pe-spinner--outer" [hidden]="!moreCustomizationsRequestProcessing"><div class="spinner-md spinner-light"></div></div></div></div></personalization-infinite-scrolling><personalizationsmartedit-scroll-zone *ngIf="scrollZoneElement != null && elementToScroll" [isTransparent]="true" [scrollZoneVisible]="scrollZoneVisible" [elementToScroll]="elementToScroll"></personalizationsmartedit-scroll-zone><a class="perso-library__back-to-top" translate="personalization.commons.button.title.backtotop" [hidden]="!isReturnToTopButtonVisible()" (click)="scrollZoneReturnToTop()"><span class="sap-icon--back-to-top"></span></a></div>`}),__metadata("design:paramtypes",[v.TranslateService,t.ManagerViewUtilsService,p.PersonalizationsmarteditMessageHandler,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditUtils,t.ManageCustomizationViewManager,m.SystemEventService])],t.ManagerViewComponent);window.__smartedit__.addDecoratorPayload("Component","ManagerViewGridHeader",{selector:"manager-view-grid-header",template:`\n        <div class="tree-head hidden-sm hidden-xs">\n            <div\n                class="tree-head__col--lg perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.customization"\n                title="{{('personalization.modal.manager.grid.header.customization') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--xs"\n                translate="personalization.modal.manager.grid.header.variations"\n                title="{{('personalization.modal.manager.grid.header.variations') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--xs perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.components"\n                title="{{('personalization.modal.manager.grid.header.components') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--md"\n                translate="personalization.modal.manager.grid.header.status"\n                title="{{('personalization.modal.manager.grid.header.status') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--sm perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.startdate"\n                title="{{('personalization.modal.manager.grid.header.startdate') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--sm perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.enddate"\n                title="{{('personalization.modal.manager.grid.header.enddate') | translate}}"\n            ></div>\n        </div>\n    `});let we=class ManagerViewGridHeader{};we=__decorate([s.Component({selector:"manager-view-grid-header",template:`\n        <div class="tree-head hidden-sm hidden-xs">\n            <div\n                class="tree-head__col--lg perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.customization"\n                title="{{('personalization.modal.manager.grid.header.customization') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--xs"\n                translate="personalization.modal.manager.grid.header.variations"\n                title="{{('personalization.modal.manager.grid.header.variations') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--xs perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.components"\n                title="{{('personalization.modal.manager.grid.header.components') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--md"\n                translate="personalization.modal.manager.grid.header.status"\n                title="{{('personalization.modal.manager.grid.header.status') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--sm perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.startdate"\n                title="{{('personalization.modal.manager.grid.header.startdate') | translate}}"\n            ></div>\n            <div\n                class="tree-head__col--sm perso-wrap-ellipsis"\n                translate="personalization.modal.manager.grid.header.enddate"\n                title="{{('personalization.modal.manager.grid.header.enddate') | translate}}"\n            ></div>\n        </div>\n    `})],we);let Ee=class ManagerViewService{constructor(e){this.modalService=e}openManagerAction(){this.modalService.open({templateConfig:{title:"personalization.modal.manager.title",isDismissButtonVisible:true},config:{height:window.innerHeight+"px",width:window.innerWidth+"px",modalPanelClass:"perso-library"},component:t.ManagerViewComponent})}};Ee.$inject=["modalService"];Ee=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IModalService])],Ee);var Te;(function(e){e["customization"]="CUSTOMIZATION";e["variation"]="VARIATION"})(Te||(Te={}));window.__smartedit__.addDecoratorPayload("Component","ManagerViewTreeComponent",{selector:"manager-view-tree",template:`<div cdkDropList [cdkDropListData]="customizations" [id]="treeRoot" [cdkDropListConnectedTo]="dragDroppedTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true"><div *ngFor="let customization of customizations" cdkDrag [cdkDragData]="customization.code" (cdkDragMoved)="dragMoved($event)"><div class="node-item" [attr.data-id]="customization.code" [attr.type]="'CUSTOMIZATION'" [attr.id]=" 'node-' + customization.code"><div class="y-tree-row" [ngClass]="allCustomizationsCollapsed()? 'active-level' : 'inactive-level'"><div class="cdk-drag-row-layout desktop-layout hidden-sm hidden-xs customization-rank-{{customization.rank}}-row"><div (click)="customizationCollapseAction(customization)" class="expand-arrow"><a title="{{(customization.collapsed ? 'personalization.commons.icon.title.expand' : 'personalization.commons.icon.title.collapse') | translate}}"><span [ngClass]="customization.collapsed ? 'sap-icon--navigation-right-arrow' : 'sap-icon--navigation-down-arrow'" class="perso__toggle-icon"></span></a></div><div class="y-tree-row__angular-ui-tree-handle"><div class="y-tree__col--lg"><div class="perso-wrap-ellipsis perso-tree__primary-data" title="{{customization.name}}" [textContent]="customization.name"></div></div><div class="y-tree__col--xs" [textContent]="getStatusNotDeleted(customization) || 0"></div><div class="y-tree__col--xs"></div><div class="y-tree__col--md perso-tree__status" [ngClass]="getActivityStateForCustomization(customization)"><span [textContent]="getEnablementTextForCustomization(customization)"></span></div><div class="y-tree__col--sm"><div [hidden]="isNotEnabled(customization)" class="perso-tree__dates-layout"><span [textContent]="getFormattedDate(customization.enabledStartDate)" class="perso-library__status-layout"></span></div></div><div class="y-tree__col--sm"><div [hidden]="isNotEnabled(customization)" class="perso-tree__dates-layout"><span [textContent]="getFormattedDate(customization.enabledEndDate)"></span></div></div></div><fd-popover [isOpen]="customization.subMenu" [closeOnOutsideClick]="true" [triggers]="[]"><fd-popover-control><button type="button" class="fd-button--light" (click)="updateSubMenuAction(customization)"><span class="perso__more-icon sap-icon--overflow"></span></button></fd-popover-control><fd-popover-body><div *ngIf="customization.subMenu" class="toolbar-action--include pe-manager-view-tree-more-list__dropdown"><div class="pe-manager-view-tree-more-list__item" (click)="clearAllCustomizationSubMenuAndEditCustomizationAction(customization)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.customization.options.edit"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="deleteCustomizationAction(customization)"><span class="pe-manager-view-tree-more-list__item-deletion" translate="personalization.modal.manager.customization.options.delete"></span></div></div></fd-popover-body></fd-popover></div></div></div><div *ngIf="!customization.collapsed" cdkDropList [cdkDropListData]="customization.variations" [id]="customization.code" [cdkDropListConnectedTo]="dropTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true"><div *ngFor="let variation of customization.variations" cdkDrag [cdkDragData]="variation.code" (cdkDragMoved)="dragMoved($event)" class="y-tree-row child-row active-level"><div class="node-item" [attr.data-id]="variation.code" [attr.type]="'VARIATION'" [attr.id]=" 'node-' + variation.code"><div *ngIf="statusNotDeleted(variation)" class="cdk-drag-row-layout desktop-layout variation-rank-{{variation.rank}}-row hidden-sm hidden-xs"><div class="y-tree-row__angular-ui-tree-handle"><div class="y-tree__col--xl perso-wrap-ellipsis" title="{{variation.name}}"><div><se-tooltip *ngIf="hasCommerceActions(variation)" [triggers]="['mouseenter','mouseleave']" [placement]="'auto'"><span class="perso__cc-icon sap-icon--tag perso__cc-icon-padding" [ngClass]="{'perso__cc-icon--hidden': !hasCommerceActions(variation)}" se-tooltip-trigger></span> <span se-tooltip-body [textContent]="getCommerceCustomizationTooltip(variation)"></span></se-tooltip></div><span [textContent]="variation.name"></span></div><div class="y-tree__col--xs" [textContent]="variation.numberOfComponents"></div><div class="y-tree__col--md perso-tree__status" [ngClass]="getActivityStateForVariation(customization,variation)"><span [textContent]="getEnablementTextForVariation(variation)" class="perso-library__status-layout"></span></div><div class="y-tree__col--lg"></div></div><fd-popover [isOpen]="variation.subMenu" [closeOnOutsideClick]="true" [triggers]="[]"><fd-popover-control><button type="button" class="fd-button--light" (click)="updateSubMenuAction(variation)"><span class="perso__more-icon sap-icon--overflow"></span></button></fd-popover-control><fd-popover-body><div *ngIf="variation.subMenu" class="toolbar-action--include pe-manager-view-tree-more-list__dropdown"><div class="pe-manager-view-tree-more-list__item" (click)="clearAllVariationSubMenuAndEditVariationAction(customization, variation)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.variation.options.edit"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="toogleVariationActive(customization,variation)"><span class="pe-manager-view-tree-more-list__item-active" [textContent]="getEnablementActionTextForVariation(variation)"></span></div><div [hidden]="!variation.isCommerceCustomizationEnabled" class="pe-manager-view-tree-more-list__item" (click)="clearAllVariationSubMenuAndmanageCommerceCustomization(customization, variation)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.variation.options.commercecustomization"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="deleteVariationAction(customization, variation, $event)"><span [ngClass]="isDeleteVariationEnabled(customization) ? 'pe-manager-view-tree-more-list__item-deletion' : 'pe-manager-view-tree-more-list__item-inactive' " translate="personalization.modal.manager.variation.options.delete"></span></div></div></fd-popover-body></fd-popover></div></div></div></div></div></div>`,styles:[`.cdk-drag-preview{z-index:2000!important}.cdk-drag-row-layout{display:flex}.pe-manager-view-tree-more-list__item{padding:10px 10px;cursor:pointer}.pe-manager-view-tree-more-list__item:hover{background-color:#edeff0;cursor:pointer}.pe-manager-view-tree-more-list__item-active{color:#32363a;cursor:pointer}.pe-manager-view-tree-more-list__item-inactive{color:#74777a;cursor:not-allowed}.pe-manager-view-tree-more-list__item-deletion{color:#b00;cursor:pointer}.pe-manager-view-tree-more-list__dropdown{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0}.pe-manager-view-tree-more-list__dropdown::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.pe-manager-view-tree-more-list__dropdown::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.pe-manager-view-tree-more-list__dropdown::after,.pe-manager-view-tree-more-list__dropdown::before{right:10px}.pe-manager-view-tree-more-list__dropdown::after,.pe-manager-view-tree-more-list__dropdown::before{display:none}.drop-before{border-top:1px solid #000;z-index:2000!important}.drop-after{border-bottom:1px solid #000;z-index:2000!important}.perso__cc-icon-padding{padding-right:15px}`],encapsulation:s.ViewEncapsulation.None});let Pe=class ManagerViewTreeComponent{constructor(e,t,o,n,s,a,r,d,p){this.document=e;this.managerViewUtilsService=t;this.personalizationsmarteditUtils=o;this.personalizationsmarteditDateUtils=n;this.manageCustomizationViewManager=s;this.personalizationsmarteditCommerceCustomizationView=a;this.personalizationsmarteditCommerceCustomizationService=r;this.personalizationsmarteditContextService=d;this.waitDialogService=p;this.treeRoot="tree-root";this.uncollapsedCustomizations=[];this.customizationsPreCount=0;this.dropTargetIds=[];this.nodeLookup={};this.dropAction=null;this.dragMovedSubject=new f.Subject}ngOnDestroy(){var e;(e=this.dragMovedSubscription)===null||e===void 0?void 0:e.unsubscribe()}ngOnInit(){this.dragMovedSubscription=this.dragMovedSubject.pipe(S.debounceTime(50)).subscribe((e=>{this.performDragMoved(e)}))}ngDoCheck(){if(this.customizationsPreCount!==this.customizations.length){this.updateCustomizations();this.resetCustomizationsDragDrop();this.updateCustomizationsDragDrop(this.customizations,0);this.customizationsPreCount=this.customizations.length}}dragMoved(e){this.dragMovedSubject.next(e)}dragDropped(e){const t=e.item.data;const o=this.dropAction.targetId;const n=e.previousContainer.id;const s=this.getParentNodeId(o,this.customizations,this.treeRoot);if(!this.dropAction.action||this.nodeLookup[t].itemLevel!==this.nodeLookup[o].itemLevel||n!==s){return}const a=this.getDropItem(this.dropAction.itemType,t,s,this.customizations);const r=this.nodeLookup[t];const p=n!==this.treeRoot?this.nodeLookup[n].variations:this.customizations;const m=s!==this.treeRoot?this.nodeLookup[s].variations:this.customizations;const g=p.findIndex((e=>e.code===t));p.splice(g,1);const u=m.findIndex((e=>e.code===this.dropAction.targetId));if(this.dropAction.action==="before"){m.splice(u,0,r)}else{m.splice(u+1,0,r)}m.forEach(((e,t)=>e.rank=t));if(this.dropAction.itemType===Te.customization){this.updateChangedCustomization(a,m)}else if(this.dropAction.itemType===Te.variation){const e=d.cloneDeep(this.nodeLookup[s]);this.updateChangedVariation(e,a,m)}this.clearDragInfo(true)}customizationCollapseAction(e){this.clearAllCustomizationSubMenu();this.clearAllVariationSubMenu();e.collapsed=!e.collapsed;if(e.collapsed===false){this.uncollapsedCustomizations.push(e.code)}else{this.uncollapsedCustomizations.splice(this.uncollapsedCustomizations.indexOf(e.code),1)}this.updateCustomizationVariations(e);this.resetCustomizationsDragDrop();this.updateCustomizationsDragDrop(this.customizations,0)}allCustomizationsCollapsed(){return this.customizations.map((e=>e.collapsed)).reduce(((e,t)=>e&&t),true)}getStatusNotDeleted(e){return e.variations.filter((e=>this.personalizationsmarteditUtils.isItemVisible(e))).length}getActivityStateForCustomization(e){return this.personalizationsmarteditUtils.getActivityStateForCustomization(e)}getEnablementTextForCustomization(e){return this.personalizationsmarteditUtils.getEnablementTextForCustomization(e,"personalization.modal.manager")}getFormattedDate(e){return e?this.personalizationsmarteditDateUtils.formatDate(e,null):""}clearAllCustomizationSubMenuAndEditCustomizationAction(e){this.clearAllCustomizationSubMenu();this.editCustomizationAction(e)}clearAllVariationSubMenuAndEditVariationAction(e,t){this.clearAllVariationSubMenu();this.editVariationAction(e,t)}clearAllVariationSubMenuAndmanageCommerceCustomization(e,t){this.clearAllVariationSubMenu();this.manageCommerceCustomization(e,t)}editCustomizationAction(e){this.manageCustomizationViewManager.openEditCustomizationModal(e.code,null)}isNotEnabled(e){return e.status!==p.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED}deleteCustomizationAction(e){this.managerViewUtilsService.deleteCustomizationAction(e,this.customizations)}updateSubMenuAction(e){if(!e.subMenu){this.clearAllCustomizationSubMenu();this.clearAllVariationSubMenu()}e.subMenu=!e.subMenu}clearAllCustomizationSubMenu(){for(const e of this.customizations){e.subMenu=false}}clearAllVariationSubMenu(){for(const e of this.customizations){for(const t of e.variations){t.subMenu=false}}}hasCommerceActions(e){return this.personalizationsmarteditUtils.hasCommerceActions(e)}getCommerceCustomizationTooltip(e){return this.personalizationsmarteditUtils.getCommerceCustomizationTooltip(e,"","")}getActivityStateForVariation(e,t){return this.personalizationsmarteditUtils.getActivityStateForVariation(e,t)}getEnablementTextForVariation(e){return this.personalizationsmarteditUtils.getEnablementTextForVariation(e,"personalization.modal.manager")}editVariationAction(e,t){this.manageCustomizationViewManager.openEditCustomizationModal(e.code,t.code)}toogleVariationActive(e,t){this.managerViewUtilsService.toggleVariationActive(e,t)}getEnablementActionTextForVariation(e){return this.personalizationsmarteditUtils.getEnablementActionTextForVariation(e,"personalization.modal.manager")}manageCommerceCustomization(e,t){this.personalizationsmarteditCommerceCustomizationView.openCommerceCustomizationAction(e,t)}isDeleteVariationEnabled(e){return this.personalizationsmarteditUtils.getVisibleItems(e.variations).length>1}deleteVariationAction(e,t,o){if(this.isDeleteVariationEnabled(e)){this.clearAllVariationSubMenu();this.managerViewUtilsService.deleteVariationAction(e,t)}else{o.stopPropagation()}}statusNotDeleted(e){return this.personalizationsmarteditUtils.isItemVisible(e)}performDragMoved(e){this.clearAllCustomizationSubMenu();this.clearAllVariationSubMenu();const t=this.document.elementFromPoint(e.pointerPosition.x,e.pointerPosition.y);if(!t){this.clearDragInfo();return}const o=t.classList.contains("node-item")?t:t.closest(".node-item");if(!o){this.clearDragInfo();return}this.dropAction={targetId:o.getAttribute("data-id")};this.dropAction.itemType=o.getAttribute("type");const n=o.getBoundingClientRect();const s=n.height/2;if(e.pointerPosition.y-n.top<s){this.dropAction.action="before"}else if(e.pointerPosition.y-n.top>s){this.dropAction.action="after"}this.showDragInfo()}resetCustomizationsDragDrop(){this.dropTargetIds.length=0;this.nodeLookup={}}updateCustomizationsDragDrop(e,t){e.forEach((e=>{this.dropTargetIds.push(e.code);this.nodeLookup[e.code]=e;this.nodeLookup[e.code].itemLevel=t;if(e.variations){this.updateCustomizationsDragDrop(e.variations,t+1)}}))}getParentNodeId(e,t,o){for(const n of t){if(n.code===e){return o}if(n.variations){const t=this.getParentNodeId(e,n.variations,n.code);if(t){return t}}}return null}updateCustomizations(){this.customizations.forEach((e=>{if(this.uncollapsedCustomizations.includes(e.code)){e.collapsed=false;this.updateCustomizationVariations(e)}else{e.collapsed=true}}))}showDragInfo(){this.clearDragInfo();if(this.dropAction){this.document.getElementById("node-"+this.dropAction.targetId).classList.add("drop-"+this.dropAction.action)}}clearDragInfo(e=false){if(e){this.dropAction=null}this.document.querySelectorAll(".drop-before").forEach((e=>e.classList.remove("drop-before")));this.document.querySelectorAll(".drop-after").forEach((e=>e.classList.remove("drop-after")))}isCommerceCustomizationEnabled(){return this.personalizationsmarteditCommerceCustomizationService.isCommerceCustomizationEnabled(this.personalizationsmarteditContextService.getSeData().seConfigurationData)}updateCustomizationVariations(e){this.managerViewUtilsService.customizationClickAction(e);const t=this.isCommerceCustomizationEnabled();e.variations.forEach((e=>{e.statusNotDeleted=this.statusNotDeleted(e);e.isCommerceCustomizationEnabled=t}))}updateChangedVariation(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=o.filter((e=>e.code===t.code))[0].rank;const s=n-t.rank;if(s!==0){this.waitDialogService.showWaitModal();yield this.updateVariationRank(e,t.code,s);this.waitDialogService.hideWaitModal()}}))}updateChangedCustomization(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=t.filter((t=>t.code===e.code))[0].rank;const n=o-e.rank;if(n!==0){this.waitDialogService.showWaitModal();yield this.updateCustomizationRank(e.code,n);this.waitDialogService.hideWaitModal()}}))}updateCustomizationRank(e,t){return this.managerViewUtilsService.updateCustomizationRank(e,t)}updateVariationRank(e,t,o){return this.managerViewUtilsService.updateVariationRank(e,t,o)}getDropItem(e,t,o,n){if(e===Te.customization){return d.cloneDeep(n.filter((e=>e.code===t))[0])}else if(e===Te.variation){const e=n.filter((e=>e.code===o))[0];return d.cloneDeep(e.variations.filter((e=>e.code===t))[0])}}};__decorate([s.Input(),__metadata("design:type",Array)],Pe.prototype,"customizations",void 0);Pe=__decorate([s.Component({selector:"manager-view-tree",template:`<div cdkDropList [cdkDropListData]="customizations" [id]="treeRoot" [cdkDropListConnectedTo]="dragDroppedTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true"><div *ngFor="let customization of customizations" cdkDrag [cdkDragData]="customization.code" (cdkDragMoved)="dragMoved($event)"><div class="node-item" [attr.data-id]="customization.code" [attr.type]="'CUSTOMIZATION'" [attr.id]=" 'node-' + customization.code"><div class="y-tree-row" [ngClass]="allCustomizationsCollapsed()? 'active-level' : 'inactive-level'"><div class="cdk-drag-row-layout desktop-layout hidden-sm hidden-xs customization-rank-{{customization.rank}}-row"><div (click)="customizationCollapseAction(customization)" class="expand-arrow"><a title="{{(customization.collapsed ? 'personalization.commons.icon.title.expand' : 'personalization.commons.icon.title.collapse') | translate}}"><span [ngClass]="customization.collapsed ? 'sap-icon--navigation-right-arrow' : 'sap-icon--navigation-down-arrow'" class="perso__toggle-icon"></span></a></div><div class="y-tree-row__angular-ui-tree-handle"><div class="y-tree__col--lg"><div class="perso-wrap-ellipsis perso-tree__primary-data" title="{{customization.name}}" [textContent]="customization.name"></div></div><div class="y-tree__col--xs" [textContent]="getStatusNotDeleted(customization) || 0"></div><div class="y-tree__col--xs"></div><div class="y-tree__col--md perso-tree__status" [ngClass]="getActivityStateForCustomization(customization)"><span [textContent]="getEnablementTextForCustomization(customization)"></span></div><div class="y-tree__col--sm"><div [hidden]="isNotEnabled(customization)" class="perso-tree__dates-layout"><span [textContent]="getFormattedDate(customization.enabledStartDate)" class="perso-library__status-layout"></span></div></div><div class="y-tree__col--sm"><div [hidden]="isNotEnabled(customization)" class="perso-tree__dates-layout"><span [textContent]="getFormattedDate(customization.enabledEndDate)"></span></div></div></div><fd-popover [isOpen]="customization.subMenu" [closeOnOutsideClick]="true" [triggers]="[]"><fd-popover-control><button type="button" class="fd-button--light" (click)="updateSubMenuAction(customization)"><span class="perso__more-icon sap-icon--overflow"></span></button></fd-popover-control><fd-popover-body><div *ngIf="customization.subMenu" class="toolbar-action--include pe-manager-view-tree-more-list__dropdown"><div class="pe-manager-view-tree-more-list__item" (click)="clearAllCustomizationSubMenuAndEditCustomizationAction(customization)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.customization.options.edit"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="deleteCustomizationAction(customization)"><span class="pe-manager-view-tree-more-list__item-deletion" translate="personalization.modal.manager.customization.options.delete"></span></div></div></fd-popover-body></fd-popover></div></div></div><div *ngIf="!customization.collapsed" cdkDropList [cdkDropListData]="customization.variations" [id]="customization.code" [cdkDropListConnectedTo]="dropTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true"><div *ngFor="let variation of customization.variations" cdkDrag [cdkDragData]="variation.code" (cdkDragMoved)="dragMoved($event)" class="y-tree-row child-row active-level"><div class="node-item" [attr.data-id]="variation.code" [attr.type]="'VARIATION'" [attr.id]=" 'node-' + variation.code"><div *ngIf="statusNotDeleted(variation)" class="cdk-drag-row-layout desktop-layout variation-rank-{{variation.rank}}-row hidden-sm hidden-xs"><div class="y-tree-row__angular-ui-tree-handle"><div class="y-tree__col--xl perso-wrap-ellipsis" title="{{variation.name}}"><div><se-tooltip *ngIf="hasCommerceActions(variation)" [triggers]="['mouseenter','mouseleave']" [placement]="'auto'"><span class="perso__cc-icon sap-icon--tag perso__cc-icon-padding" [ngClass]="{'perso__cc-icon--hidden': !hasCommerceActions(variation)}" se-tooltip-trigger></span> <span se-tooltip-body [textContent]="getCommerceCustomizationTooltip(variation)"></span></se-tooltip></div><span [textContent]="variation.name"></span></div><div class="y-tree__col--xs" [textContent]="variation.numberOfComponents"></div><div class="y-tree__col--md perso-tree__status" [ngClass]="getActivityStateForVariation(customization,variation)"><span [textContent]="getEnablementTextForVariation(variation)" class="perso-library__status-layout"></span></div><div class="y-tree__col--lg"></div></div><fd-popover [isOpen]="variation.subMenu" [closeOnOutsideClick]="true" [triggers]="[]"><fd-popover-control><button type="button" class="fd-button--light" (click)="updateSubMenuAction(variation)"><span class="perso__more-icon sap-icon--overflow"></span></button></fd-popover-control><fd-popover-body><div *ngIf="variation.subMenu" class="toolbar-action--include pe-manager-view-tree-more-list__dropdown"><div class="pe-manager-view-tree-more-list__item" (click)="clearAllVariationSubMenuAndEditVariationAction(customization, variation)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.variation.options.edit"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="toogleVariationActive(customization,variation)"><span class="pe-manager-view-tree-more-list__item-active" [textContent]="getEnablementActionTextForVariation(variation)"></span></div><div [hidden]="!variation.isCommerceCustomizationEnabled" class="pe-manager-view-tree-more-list__item" (click)="clearAllVariationSubMenuAndmanageCommerceCustomization(customization, variation)"><span class="pe-manager-view-tree-more-list__item-active" translate="personalization.modal.manager.variation.options.commercecustomization"></span></div><div class="pe-manager-view-tree-more-list__item" (click)="deleteVariationAction(customization, variation, $event)"><span [ngClass]="isDeleteVariationEnabled(customization) ? 'pe-manager-view-tree-more-list__item-deletion' : 'pe-manager-view-tree-more-list__item-inactive' " translate="personalization.modal.manager.variation.options.delete"></span></div></div></fd-popover-body></fd-popover></div></div></div></div></div></div>`,styles:[`.cdk-drag-preview{z-index:2000!important}.cdk-drag-row-layout{display:flex}.pe-manager-view-tree-more-list__item{padding:10px 10px;cursor:pointer}.pe-manager-view-tree-more-list__item:hover{background-color:#edeff0;cursor:pointer}.pe-manager-view-tree-more-list__item-active{color:#32363a;cursor:pointer}.pe-manager-view-tree-more-list__item-inactive{color:#74777a;cursor:not-allowed}.pe-manager-view-tree-more-list__item-deletion{color:#b00;cursor:pointer}.pe-manager-view-tree-more-list__dropdown{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0}.pe-manager-view-tree-more-list__dropdown::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.pe-manager-view-tree-more-list__dropdown::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.pe-manager-view-tree-more-list__dropdown::after,.pe-manager-view-tree-more-list__dropdown::before{right:10px}.pe-manager-view-tree-more-list__dropdown::after,.pe-manager-view-tree-more-list__dropdown::before{display:none}.drop-before{border-top:1px solid #000;z-index:2000!important}.drop-after{border-bottom:1px solid #000;z-index:2000!important}.perso__cc-icon-padding{padding-right:15px}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(u.DOCUMENT)),__metadata("design:paramtypes",[Document,t.ManagerViewUtilsService,p.PersonalizationsmarteditUtils,p.PersonalizationsmarteditDateUtils,t.ManageCustomizationViewManager,t.PersonalizationsmarteditCommerceCustomizationView,p.PersonalizationsmarteditCommerceCustomizationService,t.PersonalizationsmarteditContextService,m.IWaitDialogService])],Pe);let Ae=class ManagerViewModule{};Ae=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),u.CommonModule,m.SelectModule,m.TooltipModule,p.ScrollZoneModule,b.FormsModule,I.DragDropModule,C.PopoverModule,p.PersonalizationsmarteditCommonsComponentsModule,U],declarations:[t.ManagerViewComponent,we,Pe],entryComponents:[t.ManagerViewComponent,we,Pe],providers:[t.ManagerViewUtilsService,Ee]})],Ae);window.__smartedit__.addDecoratorPayload("Component","CombinedViewToolbarContextComponent",{selector:"combined-view-toolbar-context",template:`<div *ngIf="visible" class="pe-toolbar-item-context"><span class="sap-icon--slim-arrow-right pe-toolbar-item-context__icon"></span><div class="pe-toolbar-item-context__btn"><div class="pe-toolbar-item-context__btn-txt"><div title="{{title}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{title}}</div><div title="{{subtitle}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{subtitle}}</div></div></div><div class="pe-toolbar-item-context__btn-hyicon" (click)="clear()"><span class="sap-icon--decline"></span></div></div>`});let Oe=class CombinedViewToolbarContextComponent{constructor(e,t,o,n){this.combinedViewCommonsService=e;this.personalizationsmarteditContextService=t;this.personalizationsmarteditContextUtils=o;this.crossFrameEventService=n}ngOnInit(){const e=this.personalizationsmarteditContextService.getCombinedView();this.visible=false;this.selectedCustomization=d.cloneDeep(e.customize.selectedCustomization);if(this.selectedCustomization){this.title=e.customize.selectedCustomization.name;this.subtitle=e.customize.selectedVariations.name;this.visible=true}this.oldSelectedCustomization=e.customize.selectedCustomization;this.oldSelectedCustomizationEnabled=e.enabled}ngDoCheck(){const e=this.personalizationsmarteditContextService.getCombinedView();const t=e.customize.selectedCustomization;if(t&&t!==this.oldSelectedCustomization){this.oldSelectedCustomization=t;this.title=t.name;this.subtitle=e.customize.selectedVariations.name;this.visible=true;this.crossFrameEventService.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.COMBINED_VIEW_TOOLBAR_ITEM_KEY)}else if(!t){this.visible=false;this.crossFrameEventService.publish(m.HIDE_TOOLBAR_ITEM_CONTEXT,p.COMBINED_VIEW_TOOLBAR_ITEM_KEY)}const o=e.enabled;if(o&&o!==this.oldSelectedCustomizationEnabled){this.oldSelectedCustomizationEnabled=o;this.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(this.personalizationsmarteditContextService)}}clear(){this.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(this.personalizationsmarteditContextService);const e=this.personalizationsmarteditContextService.getCombinedView();const t=[];(e.selectedItems||[]).forEach((e=>{t.push({customizationCode:e.customization.code,variationCode:e.variation.code,catalog:e.variation.catalog,catalogVersion:e.variation.catalogVersion})}));this.combinedViewCommonsService.updatePreview(t);this.crossFrameEventService.publish(m.HIDE_TOOLBAR_ITEM_CONTEXT,p.COMBINED_VIEW_TOOLBAR_ITEM_KEY)}};Oe=__decorate([s.Component({selector:"combined-view-toolbar-context",template:`<div *ngIf="visible" class="pe-toolbar-item-context"><span class="sap-icon--slim-arrow-right pe-toolbar-item-context__icon"></span><div class="pe-toolbar-item-context__btn"><div class="pe-toolbar-item-context__btn-txt"><div title="{{title}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{title}}</div><div title="{{subtitle}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{subtitle}}</div></div></div><div class="pe-toolbar-item-context__btn-hyicon" (click)="clear()"><span class="sap-icon--decline"></span></div></div>`}),__metadata("design:paramtypes",[t.CombinedViewCommonsService,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditContextUtils,m.CrossFrameEventService])],Oe);window.__smartedit__.addDecoratorPayload("Component","CustomizeToolbarContextComponent",{selector:"personalizationsmartedit-customize-toolbar-context",template:`<div *ngIf="visible" class="pe-toolbar-item-context"><span class="sap-icon--slim-arrow-right pe-toolbar-item-context__icon"></span><div class="pe-toolbar-item-context__btn"><div class="pe-toolbar-item-context__btn-txt"><div title="{{title}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{title}}</div><div title="{{subtitle}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{subtitle}}</div></div></div><div class="pe-toolbar-item-context__btn-hyicon" (click)="clear()"><span class="sap-icon--decline"></span></div></div>`});let xe=class CustomizeToolbarContextComponent{constructor(e,t,o,n){this.personalizationsmarteditContextService=e;this.personalizationsmarteditContextUtils=t;this.personalizationsmarteditPreviewService=o;this.crossFrameEventService=n}ngOnInit(){this.selectedCustomization=d.cloneDeep(this.personalizationsmarteditContextService.getCustomize().selectedCustomization);this.selectedVariations=d.cloneDeep(this.personalizationsmarteditContextService.getCustomize().selectedVariations);this.visible=false;if(this.selectedCustomization){this.title=this.personalizationsmarteditContextService.getCustomize().selectedCustomization.name;this.visible=true;if(!d.isArray(this.selectedVariations)){this.subtitle=this.selectedVariations.name}}this.oldSelectedCustomization=this.personalizationsmarteditContextService.getCustomize().selectedCustomization;this.oldSelectedVariations=this.personalizationsmarteditContextService.getCustomize().selectedVariations}ngDoCheck(){const e=this.personalizationsmarteditContextService.getCustomize().selectedCustomization;if(e&&e!==this.oldSelectedCustomization){this.oldSelectedCustomization=e;this.title=e.name;this.visible=true;this.crossFrameEventService.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)}else if(!e){this.visible=false;this.crossFrameEventService.publish(m.HIDE_TOOLBAR_ITEM_CONTEXT,p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)}const t=this.personalizationsmarteditContextService.getCustomize().selectedVariations;if(t&&t!==this.oldSelectedVariations){this.oldSelectedVariations=t;if(!d.isArray(t)){this.subtitle=t.name}}}clear(){this.personalizationsmarteditContextUtils.clearCustomizeContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService);this.crossFrameEventService.publish(m.HIDE_TOOLBAR_ITEM_CONTEXT,p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY)}};xe=__decorate([s.Component({selector:"personalizationsmartedit-customize-toolbar-context",template:`<div *ngIf="visible" class="pe-toolbar-item-context"><span class="sap-icon--slim-arrow-right pe-toolbar-item-context__icon"></span><div class="pe-toolbar-item-context__btn"><div class="pe-toolbar-item-context__btn-txt"><div title="{{title}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{title}}</div><div title="{{subtitle}}" class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{subtitle}}</div></div></div><div class="pe-toolbar-item-context__btn-hyicon" (click)="clear()"><span class="sap-icon--decline"></span></div></div>`}),__metadata("design:paramtypes",[t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditPreviewService,m.CrossFrameEventService])],xe);window.__smartedit__.addDecoratorPayload("Component","ManageCustomizationViewMenuComponent",{selector:"manage-customization-view-menu",template:`<div class="btn-block pe-toolbar-action--include"><div class="se-toolbar-menu-content se-toolbar-menu-content--pe-customized" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2" translate="personalization.toolbar.library.header.title"></h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.library.header.description"></span></se-help></div><div class="se-toolbar-menu-content--pe-customized__item"><a class="se-toolbar-menu-content--pe-customized__item__link" id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor" translate="personalization.toolbar.library.manager.name" (click)="managerViewClick()"></a></div><div class="se-toolbar-menu-content--pe-customized__item se-toolbar-menu-content--pe-customized__item--last"><a class="se-toolbar-menu-content--pe-customized__item__link" id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor" translate="personalization.toolbar.library.customizationvariationmanagement.name" (click)="createCustomizationClick()"></a></div></div></div>`,styles:[`\n            .se-toolbar-menu-content--pe-customized__item__link {\n                cursor: pointer;\n            }\n        `],changeDetection:s.ChangeDetectionStrategy.OnPush});let De=class ManageCustomizationViewMenuComponent{constructor(e,t,o,n,s,a){this.personalizationsmarteditContextService=e;this.personalizationsmarteditContextUtils=t;this.personalizationsmarteditPreviewService=o;this.manageCustomizationViewManager=n;this.personalizationsmarteditManagerView=s;this.toolbarItem=a}createCustomizationClick(){this.manageCustomizationViewManager.openCreateCustomizationModal();this.toolbarItem.isOpen=false}managerViewClick(){this.personalizationsmarteditContextUtils.clearCombinedViewCustomizeContext(this.personalizationsmarteditContextService);this.personalizationsmarteditContextUtils.clearCustomizeContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService);this.personalizationsmarteditContextUtils.clearCombinedViewContextAndReloadPreview(this.personalizationsmarteditPreviewService,this.personalizationsmarteditContextService);this.personalizationsmarteditManagerView.openManagerAction();this.toolbarItem.isOpen=false}};De=__decorate([s.Component({selector:"manage-customization-view-menu",template:`<div class="btn-block pe-toolbar-action--include"><div class="se-toolbar-menu-content se-toolbar-menu-content--pe-customized" role="menu"><div class="se-toolbar-menu-content--pe-customized__headers"><h2 class="se-toolbar-menu-content--pe-customized__headers--h2" translate="personalization.toolbar.library.header.title"></h2><se-help class="se-toolbar-menu-content__y-help"><span translate="personalization.toolbar.library.header.description"></span></se-help></div><div class="se-toolbar-menu-content--pe-customized__item"><a class="se-toolbar-menu-content--pe-customized__item__link" id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor" translate="personalization.toolbar.library.manager.name" (click)="managerViewClick()"></a></div><div class="se-toolbar-menu-content--pe-customized__item se-toolbar-menu-content--pe-customized__item--last"><a class="se-toolbar-menu-content--pe-customized__item__link" id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor" translate="personalization.toolbar.library.customizationvariationmanagement.name" (click)="createCustomizationClick()"></a></div></div></div>`,styles:[`\n            .se-toolbar-menu-content--pe-customized__item__link {\n                cursor: pointer;\n            }\n        `],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(5,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditPreviewService,t.ManageCustomizationViewManager,Ee,Object])],De);let Re=class SePersonalizationsmarteditToolbarContextModule{};Re=__decorate([s.NgModule({imports:[u.CommonModule,m.HelpModule,p.PersonalizationsmarteditCommonsComponentsModule,t.SePersonalizationsmarteditServicesModule,m.TranslationModule.forChild(),g.ToolbarModule],declarations:[xe,De,Oe],entryComponents:[xe,De,Oe],providers:[Ee]})],Re);t.PersonalizationsmarteditContainerModule=class PersonalizationsmarteditContainerModule{};t.PersonalizationsmarteditContainerModule=__decorate([m.SeEntryModule("personalizationsmarteditcontainer"),s.NgModule({imports:[m.TranslationModule.forChild(),a.BrowserModule,r.UpgradeModule,p.ScrollZoneModule,t.ManageCustomizationViewModule,t.CombinedViewModule,K,p.PersonalizationsmarteditCommonsComponentsModule,te,U,t.SePersonalizationsmarteditServicesModule,Re,t.SePersonalizationsmarteditCustomizeViewModule,fe,Ae,Ie],providers:[m.diBridgeUtils.upgradeProvider("MODAL_BUTTON_ACTIONS"),m.diBridgeUtils.upgradeProvider("MODAL_BUTTON_STYLES"),m.diBridgeUtils.upgradeProvider("slotRestrictionsService"),m.diBridgeUtils.upgradeProvider("editorModalService"),m.diBridgeUtils.upgradeProvider("componentMenuService"),m.diBridgeUtils.upgradeProvider("languageService"),{provide:n.HTTP_INTERCEPTORS,useClass:p.BaseSiteHeaderInterceptor,multi:true,deps:[m.ISharedDataService]},{provide:p.IPersonalizationsmarteditContextMenuServiceProxy,useClass:t.PersonalizationsmarteditContextMenuServiceProxy},m.moduleUtils.bootstrap(((e,o,n,s,a,r,g,u,v,f,S,C,b)=>{const I="personalizationsmartedit.perspective";const clearAllContextsAndReloadPreview=()=>{f.clearCombinedViewCustomizeContext(u);f.clearCustomizeContextAndReloadPreview(S,u);f.clearCombinedViewContextAndReloadPreview(S,u)};const clearAllContexts=()=>{f.clearCombinedViewCustomizeContext(u);f.clearCustomizeContext(u);f.clearCombinedViewContext(u)};o.subscribe(m.EVENT_PERSPECTIVE_UNLOADING,((e,t)=>{if(t===I){clearAllContextsAndReloadPreview()}}));r.subscribe(m.EVENTS.EXPERIENCE_UPDATE,(()=>{clearAllContexts();u.setCustomizeFiltersState({});return m.promiseUtils.promise}));r.subscribe(m.EVENT_PERSPECTIVE_ADDED,(()=>{S.removePersonalizationDataFromPreview();return m.promiseUtils.promise}));r.subscribe(m.SWITCH_LANGUAGE_EVENT,(()=>{const e=u.getCombinedView();d.forEach(e.selectedItems,(function(e){g.getAndSetCatalogVersionNameL10N(e.variation)}));u.setCombinedView(e);return m.promiseUtils.promise}));a.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY,type:"HYBRID_ACTION",nameI18nKey:"personalization.toolbar.pagecustomizations",priority:4,section:"left",component:t.CustomizeViewComponent,contextComponent:xe,keepAliveOnClose:false,iconClassName:"sap-icon--palette se-toolbar-menu-ddlb--button__icon",permissions:["se.edit.page","se.personalization.page"]});a.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"personalizationsmartedit.container.manager.toolbar",type:"HYBRID_ACTION",nameI18nKey:"personalization.toolbar.library.name",priority:8,section:"left",component:De,keepAliveOnClose:false,iconClassName:"sap-icon--bbyd-active-sales se-toolbar-menu-ddlb--button__icon",permissions:["se.edit.page"]});a.register({key:"personalizationsmartedit.context.service",nameI18nKey:"personalization.context.service.name",descriptionI18nKey:"personalization.context.service.description",enablingCallback:()=>{const e=u.getPersonalization();e.enabled=true;u.setPersonalization(e)},disablingCallback:()=>{const e=u.getPersonalization();e.enabled=false;u.setPersonalization(e)},permissions:["se.edit.page"]});a.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:p.COMBINED_VIEW_TOOLBAR_ITEM_KEY,type:"HYBRID_ACTION",nameI18nKey:"personalization.toolbar.combinedview.name",priority:6,section:"left",component:t.CombinedViewMenuComponent,contextComponent:Oe,keepAliveOnClose:false,iconClassName:"sap-icon--switch-views se-toolbar-menu-ddlb--button__icon",permissions:["se.read.page","se.personalization.page"]});s.register({key:I,nameI18nKey:"personalization.perspective.name",features:["personalizationsmartedit.context.service",p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY,"personalizationsmartedit.container.manager.toolbar",p.COMBINED_VIEW_TOOLBAR_ITEM_KEY,"personalizationsmarteditSharedSlot","personalizationsmarteditComponentLightUp","personalizationsmarteditCombinedViewComponentLightUp","personalizationsmartedit.context.add.action","personalizationsmartedit.context.edit.action","personalizationsmartedit.context.delete.action","personalizationsmartedit.context.info.action","personalizationsmartedit.context.component.edit.action","personalizationsmartedit.context.show.action.list","externalcomponentbutton","se.contextualMenu","se.slotContextualMenu","se.emptySlotFix","se.cms.pageDisplayStatus"],perspectives:[],permissions:["se.personalization.open"]});n.subscribe("smartEditReady",((t,n)=>{o.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.CUSTOMIZE_VIEW_TOOLBAR_ITEM_KEY);o.publish(m.SHOW_TOOLBAR_ITEM_CONTEXT,p.COMBINED_VIEW_TOOLBAR_ITEM_KEY);const a=u.getCustomize().selectedCustomization;const r=u.getCombinedView().customize.selectedCustomization;const d=u.getCombinedView().selectedItems;e.getCurrentExperience().then((e=>{if(!e.variations&&(a||r||d)){clearAllContexts()}}));u.refreshExperienceData().then((()=>{const e=u.getSeData().seExperienceData;const t=s.getActivePerspective()||{key:"",nameI18nKey:"",features:[]};if(t.key===I&&e.pageContext.catalogVersionUuid!==e.catalogDescriptor.catalogVersionUuid){const e={message:"personalization.warning.pagefromparent",timeout:-1};v.sendWarning(e)}})).finally((()=>{u.applySynchronization()}))}))}),[m.IExperienceService,m.CrossFrameEventService,m.SmarteditBootstrapGateway,m.IPerspectiveService,m.IFeatureService,m.SystemEventService,p.PersonalizationsmarteditUtils,t.PersonalizationsmarteditContextService,p.PersonalizationsmarteditMessageHandler,p.PersonalizationsmarteditContextUtils,t.PersonalizationsmarteditPreviewService,p.IPersonalizationsmarteditContextMenuServiceProxy,t.PersonalizationsmarteditContextServiceReverseProxy])]})],t.PersonalizationsmarteditContainerModule);t.defaultCustomization=ie},949:function(e,t,o){},950:function(e,t,o){"use strict";var n=o(0);var s=o(133);var a=o(86);var r=o(182);var d=o(951);(function(){var e=e||window.angular;var t=null;try{t=e.module("merchandisingsmarteditContainerTemplates")}catch(e){}t=t||e.module("merchandisingsmarteditContainerTemplates",[]);t.run(["$templateCache",function(e){}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}var p=function(){function MerchandisingSmartEditContainerModule(e,t){var o=this;this.loadConfigManagerService=e;this.sharedDataService=t;this.loadConfigManagerService.loadAsObject().then((function(e){o.sharedDataService.set("merchandisingUrl",e.merchandisingUrl)}))}MerchandisingSmartEditContainerModule=__decorate([a.SeEntryModule("merchandisingsmarteditContainer"),n.NgModule({imports:[],declarations:[],entryComponents:[],providers:[{provide:s.HTTP_INTERCEPTORS,useClass:d.MerchandisingExperienceInterceptor,multi:true}]}),__metadata("design:paramtypes",[r.LoadConfigManagerService,a.ISharedDataService])],MerchandisingSmartEditContainerModule);return MerchandisingSmartEditContainerModule}()},951:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(0);var s=o(42);var a=o(46);var r=o(86);(function(){var e=e||window.angular;var t=null;try{t=e.module("merchandisingsmarteditCommonTemplates")}catch(e){}t=t||e.module("merchandisingsmarteditCommonTemplates",[]);t.run(["$templateCache",function(e){}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}var d=function(){MerchandisingExperienceInterceptor.$inject=["sharedDataService"];function MerchandisingExperienceInterceptor(e){this.sharedDataService=e}e=MerchandisingExperienceInterceptor;MerchandisingExperienceInterceptor.prototype.intercept=function(t,o){if(e.MERCHCMSWEBSERVICES_PATH.test(t.url)){return s.from(this.sharedDataService.get("experience")).pipe(a.switchMap((function(e){if(e){if(t.url.indexOf(r.CONTEXT_SITE_ID)>-1){var n=t.params;if(n){n=n.delete("catalogId").delete("catalogVersion").delete("mask")}var s=t.clone({url:t.url.replace(r.CONTEXT_SITE_ID,e.catalogDescriptor.siteId),params:n});return o.handle(s)}}return o.handle(t)})))}else{return o.handle(t)}};MerchandisingExperienceInterceptor.prototype.intercept.$inject=["request","next"];var e;MerchandisingExperienceInterceptor.MERCHCMSWEBSERVICES_PATH=/\/merchandisingcmswebservices/;MerchandisingExperienceInterceptor=e=__decorate([n.Injectable(),__metadata("design:paramtypes",[r.ISharedDataService])],MerchandisingExperienceInterceptor);return MerchandisingExperienceInterceptor}();t.MerchandisingExperienceInterceptor=d},952:function(e,t,o){},953:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(954);var s=o(86);var a=o(182);var r=o(133);var d=o(0);var p=o(20);var m=o(40);var g=o(139);function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}t.legacy=class Smarteditloader{};t.legacy=__decorate([s.SeModule({imports:[s.TemplateCacheDecoratorModule,"coretemplates","translationServiceModule"],config:["$logProvider",e=>{"ngInject";e.debugEnabled(false)}],providers:[a.BootstrapService],initialize:["ssoAuthenticationHelper","loadConfigManagerService","bootstrapService",(e,t,o)=>{"ngInject";if(e.isSSODialog()){e.completeDialog()}else{t.loadAsObject().then((e=>{o.bootstrapContainerModules(e).then((e=>{const t=document.querySelector(s.SMARTEDITLOADER_COMPONENT_NAME);t.parentNode.insertBefore(document.createElement(s.SMARTEDITCONTAINER_COMPONENT_NAME),t);n.platformBrowserDynamic().bootstrapModule(a.SmarteditContainerFactory(e),{ngZone:s.commonNgZone}).then((e=>{})).catch((e=>console.log(e)))}))}))}}]})],t.legacy);const u="legacy-loader";window.__smartedit__.addDecoratorPayload("Component","SmarteditloaderComponent",{selector:s.SMARTEDITLOADER_COMPONENT_NAME,template:`<${u}></${u}>`});let v=class SmarteditloaderComponent{constructor(e,t,o){this.elementRef=e;this.upgrade=t}ngAfterViewInit(){this.upgrade.bootstrap(this.elementRef.nativeElement.querySelector(u),[t.legacy.moduleName],{strictDi:false})}};v=__decorate([d.Component({selector:s.SMARTEDITLOADER_COMPONENT_NAME,template:`<${u}></${u}>`}),__metadata("design:paramtypes",[d.ElementRef,g.UpgradeModule,d.Injector])],v);const SmarteditLoaderFactory=e=>{let t=class Smarteditloader{};t=__decorate([d.NgModule({schemas:[d.CUSTOM_ELEMENTS_SCHEMA],imports:[m.BrowserModule,p.FormsModule,p.ReactiveFormsModule,r.HttpClientModule,g.UpgradeModule,s.SmarteditCommonsModule,s.SharedComponentsModule,...e,a.AlertServiceModule,s.HttpInterceptorModule.forRoot(s.UnauthorizedErrorInterceptor,s.RetryInterceptor,s.ResourceNotFoundErrorInterceptor),s.SeTranslationModule.forRoot(a.TranslationsFetchService)],providers:[s.moduleUtils.provideValues({SSO_CLIENT_ID:s.DEFAULT_AUTHENTICATION_CLIENT_ID}),s.SSOAuthenticationHelper,a.ConfigurationExtractorService,{provide:d.ErrorHandler,useClass:s.SmarteditErrorHandler},a.DelegateRestService,s.RestServiceFactory,{provide:s.IAuthenticationService,useClass:s.AuthenticationService},{provide:s.ISessionService,useClass:a.SessionService},{provide:s.ISharedDataService,useClass:a.SharedDataService},{provide:s.IStorageService,useClass:a.StorageService},a.LoadConfigManagerService,s.moduleUtils.initialize((()=>{s.diBridgeUtils.downgradeService("languageService",s.LanguageService);s.diBridgeUtils.downgradeService("httpClient",r.HttpClient);s.diBridgeUtils.downgradeService("restServiceFactory",s.RestServiceFactory);s.diBridgeUtils.downgradeService("ssoAuthenticationHelper",s.SSOAuthenticationHelper);s.diBridgeUtils.downgradeService("authenticationService",s.AuthenticationService,s.IAuthenticationService);s.diBridgeUtils.downgradeService("l10nPipe",s.L10nPipe)}))],declarations:[v],entryComponents:[v],bootstrap:[v]})],t);return t};const setGlobalBasePathURL=()=>__awaiter(void 0,void 0,void 0,(function*(){try{const e=yield window.fetch(s.SETTINGS_URI);const t=yield e.json();if(t["smartedit.globalBasePath"]){s.RestServiceFactory.setGlobalBasePath(String(t["smartedit.globalBasePath"]))}}catch(e){console.log("Failure on loading Settings URL")}return Promise.resolve()}));window.smarteditJQuery(document).ready((()=>{if(!s.nodeUtils.hasLegacyAngularJSBootsrap()){if(!document.querySelector(s.SMARTEDITLOADER_COMPONENT_NAME)){document.body.appendChild(document.createElement(s.SMARTEDITLOADER_COMPONENT_NAME))}const e=[...window.__smartedit__.pushedModules];setGlobalBasePathURL().then((()=>{n.platformBrowserDynamic().bootstrapModule(SmarteditLoaderFactory(e),{ngZone:s.commonNgZone}).catch((e=>console.log(e)))}))}}));t.ng=SmarteditLoaderFactory},955:function(e,t,o){},956:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(120);var s=o(0);var a=o(40);var r=o(136);var d=o(105);var p=o(228);var m=o(4);var g=o(93);var u=o(86);var v=o(42);var f=o(46);(function(){var e=e||window.angular;var t=null;try{t=e.module("personalizationsearchsmarteditContainerTemplates")}catch(e){}t=t||e.module("personalizationsearchsmarteditContainerTemplates",[]);t.run(["$templateCache",function(e){e.put("SearchProfilesSmarteditComponent.html",'<div *ngIf="getSelectedTypeCode() === getSearchProfileCode()" class="form-group"><label for="search-profile-selector-1" class="fd-form__label" translate="personalizationsearchsmartedit.commercecustomization.search.label"></label><personalization-infinite-scrolling [fetchPage]="getPage"><se-select [id]="search-profile-selector-1" class="fd-form__control" [placeholder]="\'personalizationsearchsmartedit.commercecustomization.search.placeholder\'" [searchEnabled]="true" [fetchStrategy]="fetchStrategy" [(model)]="selectedSearchProfile" [onSelect]="searchProfileSelectedEvent"></se-select><div class="pe-spinner--outer" [hidden]="!requestProcessing"><div class="spinner-md spinner-light"></div></div></personalization-infinite-scrolling><div *ngIf="searchProfileActions.length !== 0" class="ps-search-profile__selection"><label class="control-label ps-control-label"><span translate="personalizationsearchsmartedit.commercecustomization.search.selection.label"></span></label><se-help><span translate="personalizationsearchsmartedit.commercecustomization.search.helpmsg"></span></se-help><div cdkDropList [cdkDropListData]="searchProfileActions" [cdkDropListConnectedTo]="dragDroppedTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true" class="ps-search-profile__sel-tree"><div class="ps-search-profile__sel-tbody"><div *ngFor="let searchProfileAction of searchProfileActions" cdkDrag [cdkDragData]="searchProfileAction.searchProfileCode" (cdkDragMoved)="dragMoved($event)" class="ps-search-profile__sel-tree-row"><div class="node-item" [attr.data-id]="searchProfileAction.searchProfileCode" [attr.id]=" \'node-\' + searchProfileAction.searchProfileCode"><div class="ps-search-profile__sel-tree-row-wrapper"><div class="ps-search-profile__sel-profile ps-search-profile-height"><span class="ps-search-profile__sel-profile-code" [textContent]="searchProfileAction.searchProfileCode"></span></div></div></div></div></div></div></div><label class="control-label ps-control-label__cust"><span translate="personalizationsearchsmartedit.commercecustomization.search.label.cust"></span></label></div>')}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}t.SearchProfilesContextService=class SearchProfilesContextService{constructor(){this.searchProfileActionComparer=(e,t)=>e.type===t.type&&e.searchProfileCode===t.searchProfileCode&&e.searchProfileCatalog===t.searchProfileCatalog;this.updateSearchActionContext=e=>{e.forEach((e=>{const t=this.searchProfileActionContext.searchProfilesOrder.filter((t=>this.searchProfileActionComparer(e,t)));if(t.length>0){t[0].code=e.code}}))};this.isDirty=()=>false;this.searchProfileActionContext={customizationCode:undefined,variationCode:undefined,initialOrder:[],searchProfilesOrder:[]}}};t.SearchProfilesContextService=__decorate([u.SeDowngradeService(),__metadata("design:paramtypes",[])],t.SearchProfilesContextService);t.SearchRestService=class SearchRestService{constructor(e,t){this.personalizationsmarteditUtils=e;this.restServiceFactory=t;this.SEARCH_PROFILES="/adaptivesearchwebservices/v1/searchprofiles";this.UPDATE_CUSTOMIZATION_RANK="/personalizationwebservices/v1/query/cxUpdateSearchProfileActionRank";this.GET_INDEX_TYPES_FOR_SITE="/personalizationwebservices/v1/query/cxGetIndexTypesForSite"}initSeData(e){this.seData=e}getSeExperienceData(){return this.seData.seExperienceData}getSearchProfiles(e){const t=this.getSeExperienceData();const o=(t.productCatalogVersions||[]).map((function(e){return e.catalog+":"+e.catalogVersion})).join(",");const n=this.restServiceFactory.get(this.SEARCH_PROFILES);e=Object.assign({catalogVersions:o},e);return n.get(e)}updateSearchProfileActionRank(e){const t=this.getSeExperienceData();const o=this.restServiceFactory.get(this.UPDATE_CUSTOMIZATION_RANK);const n=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"customization",e.customizationCode);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"variation",e.variationCode);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"rankBeforeAction",e.rankBeforeAction);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"rankAfterAction",e.rankAfterAction);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"actions",e.actions);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"catalog",t.catalogDescriptor.catalogId);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"catalogVersion",t.catalogDescriptor.catalogVersion);const s={params:{entry:n}};return o.save(s)}getIndexTypesForCatalogVersion(e){const t=this.getSeExperienceData();const o=this.restServiceFactory.get(this.GET_INDEX_TYPES_FOR_SITE);const n=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"baseSiteId",t.catalogDescriptor.siteId);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"catalog",e.catalog);this.personalizationsmarteditUtils.pushToArrayIfValueExists(n,"catalogVersion",e.catalogVersion);const s={params:{entry:n}};return o.save(s)}};t.SearchRestService.$inject=["personalizationsmarteditUtils","restServiceFactory"];t.SearchRestService=__decorate([u.SeDowngradeService(),__metadata("design:paramtypes",[p.PersonalizationsmarteditUtils,u.IRestServiceFactory])],t.SearchRestService);const S="cxSearchProfileActionData";window.__smartedit__.addDecoratorPayload("Component","SearchProfilesSmarteditComponent",{selector:"search-profiles-smartedit",template:`<div *ngIf="getSelectedTypeCode() === getSearchProfileCode()" class="form-group"><label for="search-profile-selector-1" class="fd-form__label" translate="personalizationsearchsmartedit.commercecustomization.search.label"></label><personalization-infinite-scrolling [fetchPage]="getPage"><se-select [id]="search-profile-selector-1" class="fd-form__control" [placeholder]="'personalizationsearchsmartedit.commercecustomization.search.placeholder'" [searchEnabled]="true" [fetchStrategy]="fetchStrategy" [(model)]="selectedSearchProfile" [onSelect]="searchProfileSelectedEvent"></se-select><div class="pe-spinner--outer" [hidden]="!requestProcessing"><div class="spinner-md spinner-light"></div></div></personalization-infinite-scrolling><div *ngIf="searchProfileActions.length !== 0" class="ps-search-profile__selection"><label class="control-label ps-control-label"><span translate="personalizationsearchsmartedit.commercecustomization.search.selection.label"></span></label><se-help><span translate="personalizationsearchsmartedit.commercecustomization.search.helpmsg"></span></se-help><div cdkDropList [cdkDropListData]="searchProfileActions" [cdkDropListConnectedTo]="dragDroppedTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true" class="ps-search-profile__sel-tree"><div class="ps-search-profile__sel-tbody"><div *ngFor="let searchProfileAction of searchProfileActions" cdkDrag [cdkDragData]="searchProfileAction.searchProfileCode" (cdkDragMoved)="dragMoved($event)" class="ps-search-profile__sel-tree-row"><div class="node-item" [attr.data-id]="searchProfileAction.searchProfileCode" [attr.id]=" 'node-' + searchProfileAction.searchProfileCode"><div class="ps-search-profile__sel-tree-row-wrapper"><div class="ps-search-profile__sel-profile ps-search-profile-height"><span class="ps-search-profile__sel-profile-code" [textContent]="searchProfileAction.searchProfileCode"></span></div></div></div></div></div></div></div><label class="control-label ps-control-label__cust"><span translate="personalizationsearchsmartedit.commercecustomization.search.label.cust"></span></label></div>`,styles:[`.cdk-drag-placeholder{display:none}.cdk-drag-preview{z-index:2000!important}.node-item{z-index:2100!important;cursor:move}.cdk-drag-row-layout{display:flex}.drop-before{border-top:1px solid #000;z-index:2000!important}.drop-after{border-bottom:1px solid #000;z-index:2000!important}.ps-search-profile-height{height:40px}`],encapsulation:s.ViewEncapsulation.None});t.SearchProfilesSmarteditComponent=class SearchProfilesSmarteditComponent{constructor(e,t,o,n,s,a){this.personlizationSearchExtensionInjector=e;this.document=t;this.translateService=o;this.searchRestService=n;this.searchProfilesContextService=s;this.personalizationsmarteditMessageHandler=a;this.selectedSearchProfile=null;this.allSearchProfiles=[];this.availableSearchProfiles=[];this.searchProfileActions=[];this.fetchStrategy={fetchAll:()=>{this.availableSearchProfiles=[];this.allSearchProfiles.forEach((e=>{if(this.isItemInSelectDisabled(e)){this.availableSearchProfiles.push(this.formateSearchProfileItem(e))}}));return Promise.resolve(this.availableSearchProfiles)}};this.actionsPreCount=0;this.draggedItemCss="node-item";this.dropTargetIds=[];this.nodeLookup={};this.dropAction=null;this.dragMovedSubject=new v.Subject;this.getPage=()=>this.addMoreSearchProfilesItems();this.searchProfileSelectedEvent=e=>{this.selectedSearchProfile=e;const t=this.buildAction(e);this.addAction(t,this.searchProfilesContextService.searchProfileActionComparer)};this.seData=e.seData;this.getCustomization=e.getCustomization;this.getVariation=e.getVariation;this.actions=e.actions;this.addAction=e.addAction;this.isActionInSelectDisabled=e.isActionInSelectDisabled;this.getSelectedTypeCode=e.getSelectedTypeCode}ngOnInit(){this.searchRestService.initSeData(this.seData);this.moreSearchProfilestRequestProcessing=false;this.paginationHelper=new p.PaginationHelper({});this.paginationHelper.reset();this.searchProfileFilter={code:"",pageSize:0,currentPage:0};this.searchProfileContext=this.searchProfilesContextService.searchProfileActionContext;this.dragMovedSubscription=this.dragMovedSubject.pipe(f.debounceTime(50)).subscribe((e=>{this.performDragMoved(e)}))}ngDoCheck(){if(this.actionsPreCount!==this.actions.length){const e=this.actions||[];this.searchProfileActions=e.filter((function(e){return e.action.type===S})).map((function(t){return Object.assign(Object.assign({},t.action),{baseIndex:e.indexOf(t)})}));this.searchProfileContext.searchProfilesOrder=this.searchProfileActions;this.resetSearchProfileActionsDragDrop();this.updateSearchProfileActionsDragDrop();this.actionsPreCount=this.actions.length}if(this.customizationPreCode!==this.getCustomization().code){if(this.getCustomization()&&this.getCustomization().code){this.searchProfileContext.customizationCode=this.getCustomization().code}else{this.searchProfileContext.customizationCode=undefined}this.customizationPreCode=this.getCustomization().code}if(this.variationPreCode!==this.getVariation().code){if(this.getVariation()&&this.getVariation().code){this.searchProfileContext.variationCode=this.getVariation().code}else{this.searchProfileContext.variationCode=undefined}this.variationPreCode=this.getVariation().code}}ngOnDestroy(){var e;(e=this.dragMovedSubscription)===null||e===void 0?void 0:e.unsubscribe()}getSearchProfileCode(){return S}dragMoved(e){this.dragMovedSubject.next(e)}dragDropped(e){if(this.checkDragDrop(e.item.data)){const t=e.item.data;const o=this.dropAction.targetId;const n=this.nodeLookup[t];const s=this.nodeLookup[o];if(this.dropAction.action==="before"){this.actions.splice(s.baseIndex,0,this.actions.splice(n.baseIndex,1)[0])}else{this.actions.splice(s.baseIndex+1,0,this.actions.splice(n.baseIndex,1)[0])}this.searchProfileActions.splice(this.searchProfileActions.findIndex((e=>e.searchProfileCode===t)),1);const a=this.searchProfileActions.findIndex((e=>e.searchProfileCode===this.dropAction.targetId));if(this.dropAction.action==="before"){this.searchProfileActions.splice(a,0,n)}else{this.searchProfileActions.splice(a+1,0,n)}this.updateSearchProfileActionsBaseIndex();const r=e.previousIndex<e.currentIndex?e.previousIndex:e.currentIndex;const d=Math.abs(e.currentIndex-e.previousIndex)+1;const p=this.searchProfileActions.slice(r,d);const m=[];p.forEach((e=>{m.push(this.getWrapperActionForAction(e))}));this.setStatusForUpdatedActions(m)}}getWrapperActionForAction(e){const t=[];this.actions.forEach((o=>{if(this.searchProfilesContextService.searchProfileActionComparer(e,o.action)){t.push(o)}}));return t[0]}checkDragDrop(e){return this.dropAction!==null&&this.dropAction.action!==null&&this.dropAction.targetId!==null&&e!==this.dropAction.targetId&&this.checkDragDropIndex(e)}checkDragDropIndex(e){const t=this.searchProfileActions.findIndex((t=>t.searchProfileCode===e));let o=this.searchProfileActions.findIndex((e=>e.searchProfileCode===this.dropAction.targetId));if(this.dropAction.action==="before"){o-=1}else{o+=1}return t!==o}updateSearchProfileActionsBaseIndex(){this.actions.forEach(((e,t)=>{if(e.action.type===S){this.nodeLookup[e.action.searchProfileCode].baseIndex=t}}))}setStatusForUpdatedActions(e){e.forEach((e=>{if(e.status!==p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.NEW){e.status=p.PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES.UPDATE}}))}updateSearchProfileActionsDragDrop(){this.searchProfileActions.forEach((e=>{this.dropTargetIds.push(e.searchProfileCode);this.nodeLookup[e.searchProfileCode]=e}))}resetSearchProfileActionsDragDrop(){this.dropTargetIds.length=0;this.nodeLookup={}}performDragMoved(e){this.dropAction={targetId:null,action:null};const t=this.document.elementFromPoint(e.pointerPosition.x,e.pointerPosition.y);if(!t){this.clearDragInfo();return}const o=t.classList.contains(this.draggedItemCss)?t:t.closest(".node-item");if(!o){this.clearDragInfo();return}this.dropAction={targetId:o.getAttribute("data-id")};const n=o.getBoundingClientRect();const s=n.height/2;if(e.pointerPosition.y-n.top<s){this.dropAction.action="before"}else if(e.pointerPosition.y-n.top>s){this.dropAction.action="after"}this.showDragInfo()}showDragInfo(){this.clearDragInfo();if(this.dropAction){this.document.getElementById("node-"+this.dropAction.targetId).classList.add("drop-"+this.dropAction.action)}}clearDragInfo(e=false){if(e){this.dropAction=null}this.document.querySelectorAll(".drop-before").forEach((e=>e.classList.remove("drop-before")));this.document.querySelectorAll(".drop-after").forEach((e=>e.classList.remove("drop-after")))}addMoreSearchProfilesItems(){return __awaiter(this,void 0,void 0,(function*(){try{if(this.paginationHelper.getPage()<this.paginationHelper.getTotalPages()-1&&!this.moreSearchProfilestRequestProcessing){this.moreSearchProfilestRequestProcessing=true;const e=yield this.getIndexTypes();let t=this.getSearchProfileFilterObject();const o={indexTypes:e.indexTypeIds||[]};t=Object.assign({indexTypes:o.indexTypes},t);const n=yield this.searchRestService.getSearchProfiles(t);this.allSearchProfiles=g.cloneDeep(n.searchProfiles);this.paginationHelper=new p.PaginationHelper(n.pagination);this.moreSearchProfilestRequestProcessing=false}}catch(e){this.moreSearchProfilestRequestProcessing=false;this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalizationsearchsmartedit.commercecustomization.search.error.gettingsearchprofiles"))}}))}getIndexTypes(){const e=u.promiseUtils.defer();const t=[];const o=this.searchRestService.getSeExperienceData();o.productCatalogVersions.forEach((e=>{t.push(this.searchRestService.getIndexTypesForCatalogVersion(e))}));Promise.all(t).then((function successCallback(t){const o={indexTypeIds:[]};t.forEach((e=>{o.indexTypeIds=o.indexTypeIds.concat(e.indexTypeIds.filter((function(e){return o.indexTypeIds.indexOf(e)<0})))}));e.resolve(o)}),(function errorCallback(t){e.reject(t)}));return e.promise}isItemInSelectDisabled(e){const t=this.buildAction(e);return this.isActionInSelectDisabled(t,this.searchProfilesContextService.searchProfileActionComparer)===undefined?true:false}getSearchProfileFilterObject(){return{code:this.searchProfileFilter.code,pageSize:this.paginationHelper.getCount(),currentPage:this.paginationHelper.getPage()+1}}buildAction(e){return{type:S,searchProfileCode:e.code,searchProfileCatalog:e.catalogVersion.split(":")[0]}}formateSearchProfileItem(e){const t=g.cloneDeep(e);t.id=t.code;t.label=t.name;return t}};t.SearchProfilesSmarteditComponent=__decorate([s.Component({selector:"search-profiles-smartedit",template:`<div *ngIf="getSelectedTypeCode() === getSearchProfileCode()" class="form-group"><label for="search-profile-selector-1" class="fd-form__label" translate="personalizationsearchsmartedit.commercecustomization.search.label"></label><personalization-infinite-scrolling [fetchPage]="getPage"><se-select [id]="search-profile-selector-1" class="fd-form__control" [placeholder]="'personalizationsearchsmartedit.commercecustomization.search.placeholder'" [searchEnabled]="true" [fetchStrategy]="fetchStrategy" [(model)]="selectedSearchProfile" [onSelect]="searchProfileSelectedEvent"></se-select><div class="pe-spinner--outer" [hidden]="!requestProcessing"><div class="spinner-md spinner-light"></div></div></personalization-infinite-scrolling><div *ngIf="searchProfileActions.length !== 0" class="ps-search-profile__selection"><label class="control-label ps-control-label"><span translate="personalizationsearchsmartedit.commercecustomization.search.selection.label"></span></label><se-help><span translate="personalizationsearchsmartedit.commercecustomization.search.helpmsg"></span></se-help><div cdkDropList [cdkDropListData]="searchProfileActions" [cdkDropListConnectedTo]="dragDroppedTargetIds" (cdkDropListDropped)="dragDropped($event)" [cdkDropListSortingDisabled]="true" class="ps-search-profile__sel-tree"><div class="ps-search-profile__sel-tbody"><div *ngFor="let searchProfileAction of searchProfileActions" cdkDrag [cdkDragData]="searchProfileAction.searchProfileCode" (cdkDragMoved)="dragMoved($event)" class="ps-search-profile__sel-tree-row"><div class="node-item" [attr.data-id]="searchProfileAction.searchProfileCode" [attr.id]=" 'node-' + searchProfileAction.searchProfileCode"><div class="ps-search-profile__sel-tree-row-wrapper"><div class="ps-search-profile__sel-profile ps-search-profile-height"><span class="ps-search-profile__sel-profile-code" [textContent]="searchProfileAction.searchProfileCode"></span></div></div></div></div></div></div></div><label class="control-label ps-control-label__cust"><span translate="personalizationsearchsmartedit.commercecustomization.search.label.cust"></span></label></div>`,styles:[`.cdk-drag-placeholder{display:none}.cdk-drag-preview{z-index:2000!important}.node-item{z-index:2100!important;cursor:move}.cdk-drag-row-layout{display:flex}.drop-before{border-top:1px solid #000;z-index:2000!important}.drop-after{border-bottom:1px solid #000;z-index:2000!important}.ps-search-profile-height{height:40px}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(p.PERSONLIZATION_SEARCH_EXTENSION_INJECTOR_TOKEN)),__param(1,s.Inject(m.DOCUMENT)),__metadata("design:paramtypes",[Object,Document,d.TranslateService,t.SearchRestService,t.SearchProfilesContextService,p.PersonalizationsmarteditMessageHandler])],t.SearchProfilesSmarteditComponent);t.PersonalizationsearchSmarteditContainerModule=class PersonalizationsearchSmarteditContainerModule{};t.PersonalizationsearchSmarteditContainerModule=__decorate([u.SeEntryModule("personalizationsearchsmarteditContainer"),s.NgModule({imports:[u.TranslationModule.forChild(),u.SelectModule,r.PopoverModule,a.BrowserModule,u.SharedComponentsModule,n.DragDropModule,p.PersonalizationsmarteditCommonsComponentsModule],declarations:[t.SearchProfilesSmarteditComponent],entryComponents:[t.SearchProfilesSmarteditComponent],exports:[],providers:[t.SearchProfilesContextService,t.SearchRestService,{provide:p.PERSONLIZATION_SEARCH_EXTENSION_TOKEN,useValue:{component:t.SearchProfilesSmarteditComponent}},u.moduleUtils.bootstrap(((e,t,o,n,s)=>{s.registerType({type:S,text:"personalizationsearchsmartedit.commercecustomization.action.type.search",confProperty:"personalizationsearch.commercecustomization.search.profile.enabled",getName:t=>e.instant("personalizationsearchsmartedit.commercecustomization.search.display.name")+" - "+t.searchProfileCode,updateActions(e,s,a,r){const d=u.promiseUtils.defer();if(r!==undefined){t.updateSearchActionContext(r.actions)}const p=t.searchProfileActionContext;const m=p.searchProfilesOrder.splice(0,1)[0];const g=p.searchProfilesOrder.map((function(e){return e.code})).join(",");const v={customizationCode:p.customizationCode,variationCode:p.variationCode,rankAfterAction:m.code,actions:g};o.updateSearchProfileActionRank(v).then((function successCallback(){d.resolve()}),(function errorCallback(){n.sendError(this.translateService.instant("personalization.error.updatingcustomization"));d.reject()}));return d.promise}})}),[d.TranslateService,t.SearchProfilesContextService,t.SearchRestService,p.PersonalizationsmarteditMessageHandler,p.PersonalizationsmarteditCommerceCustomizationService])]})],t.PersonalizationsearchSmarteditContainerModule)},957:function(e,t,o){},958:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(0);var s=o(40);var a=o(105);var r=o(228);var d=o(959);var p=o(86);var m=o(93);(function(){var e=e||window.angular;var t=null;try{t=e.module("personalizationpromotionssmarteditContainerTemplates")}catch(e){}t=t||e.module("personalizationpromotionssmarteditContainerTemplates",[]);t.run(["$templateCache",function(e){e.put("PromotionsSmarteditPromotionComponent.html",'<div *ngIf="getSelectedTypeCode() === getPromotionCode()"><label for="promotion-selector-1" class="fd-form__label" translate="personalization.modal.commercecustomization.promotion.label"></label><se-select [id]="promotion-selector-1" class="fd-form__control" [placeholder]="\'personalization.modal.commercecustomization.promotion.search.placeholder\'" [fetchStrategy]="fetchStrategy" [(model)]="selectedPromotion" [onSelect]="promotionSelectedEvent" [searchEnabled]="true"></se-select></div>')}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}const g="cxPromotionActionData";window.__smartedit__.addDecoratorPayload("Component","PromotionsSmarteditPromotionComponent",{selector:"promotions-smartedit-promotion",template:`<div *ngIf="getSelectedTypeCode() === getPromotionCode()"><label for="promotion-selector-1" class="fd-form__label" translate="personalization.modal.commercecustomization.promotion.label"></label><se-select [id]="promotion-selector-1" class="fd-form__control" [placeholder]="'personalization.modal.commercecustomization.promotion.search.placeholder'" [fetchStrategy]="fetchStrategy" [(model)]="selectedPromotion" [onSelect]="promotionSelectedEvent" [searchEnabled]="true"></se-select></div>`});t.PromotionsSmarteditPromotionComponent=class PromotionsSmarteditPromotionComponent{constructor(e,t,o,n,s){this.personlizationPromotionExtensionInjector=e;this.translateService=t;this.experienceService=o;this.promotionssmarteditRestService=n;this.personalizationsmarteditMessageHandler=s;this.selectedPromotion=null;this.allPromotions=[];this.availablePromotions=[];this.fetchStrategy={fetchAll:()=>{this.availablePromotions=[];this.allPromotions.forEach((e=>{const t=this.buildAction(e);if(this.isActionInSelectDisabled(t,this.comparer)===undefined){this.availablePromotions.push(m.cloneDeep(e))}}));return Promise.resolve(this.availablePromotions)}};this.comparer=(e,t)=>e.type===t.type&&e.promotionId===t.promotionId;this.promotionSelectedEvent=e=>{const t=this.buildAction(e);this.addAction(t,this.comparer)};this.addAction=e.addAction;this.isActionInSelectDisabled=e.isActionInSelectDisabled;this.getSelectedTypeCode=e.getSelectedTypeCode}ngOnInit(){this.getAvailablePromotions()}getAvailablePromotions(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.getPromotions();this.allPromotions=e.promotions;this.allPromotions.forEach((e=>{e.id=e.code;e.label=e.code+"("+e.promotionGroup+")"}))}catch(e){this.personalizationsmarteditMessageHandler.sendError(this.translateService.instant("personalization.error.gettingpromotions"))}}))}getPromotionCode(){return g}getPromotions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getCatalogs();const t=yield this.promotionssmarteditRestService.getPromotions(e);return Promise.resolve(t)}))}getCatalogs(){return __awaiter(this,void 0,void 0,(function*(){const e=[];const t=yield this.experienceService.getCurrentExperience();e.push({catalog:t.catalogDescriptor.catalogId,catalogVersion:t.catalogDescriptor.catalogVersion});t.productCatalogVersions.forEach((t=>{e.push({catalog:t.catalog,catalogVersion:t.catalogVersion})}));return Promise.resolve(e)}))}buildAction(e){return{type:"cxPromotionActionData",promotionId:e.code}}};t.PromotionsSmarteditPromotionComponent=__decorate([n.Component({selector:"promotions-smartedit-promotion",template:`<div *ngIf="getSelectedTypeCode() === getPromotionCode()"><label for="promotion-selector-1" class="fd-form__label" translate="personalization.modal.commercecustomization.promotion.label"></label><se-select [id]="promotion-selector-1" class="fd-form__control" [placeholder]="'personalization.modal.commercecustomization.promotion.search.placeholder'" [fetchStrategy]="fetchStrategy" [(model)]="selectedPromotion" [onSelect]="promotionSelectedEvent" [searchEnabled]="true"></se-select></div>`}),__param(0,n.Inject(r.PERSONLIZATION_PROMOTION_EXTENSION_INJECTOR_TOKEN)),__metadata("design:paramtypes",[Object,a.TranslateService,p.IExperienceService,d.PromotionsSmarteditRestService,r.PersonalizationsmarteditMessageHandler])],t.PromotionsSmarteditPromotionComponent);t.PersonalizationPromotionsSmarteditContainer=class PersonalizationPromotionsSmarteditContainer{};t.PersonalizationPromotionsSmarteditContainer=__decorate([p.SeEntryModule("personalizationpromotionssmarteditContainer"),n.NgModule({imports:[p.TranslationModule.forChild(),p.SelectModule,d.PersonalizationPromotionsSmarteditCommonsModule,s.BrowserModule],declarations:[t.PromotionsSmarteditPromotionComponent],entryComponents:[t.PromotionsSmarteditPromotionComponent],providers:[{provide:r.PERSONLIZATION_PROMOTION_EXTENSION_TOKEN,useValue:{component:t.PromotionsSmarteditPromotionComponent}},p.moduleUtils.bootstrap(((e,t)=>{t.registerType({type:g,text:"personalization.modal.commercecustomization.action.type.promotion",confProperty:"personalizationsmartedit.commercecustomization.promotions.enabled",getName:t=>e.instant("personalization.modal.commercecustomization.promotion.display.name")+" - "+t.promotionId})}),[a.TranslateService,r.PersonalizationsmarteditCommerceCustomizationService])]})],t.PersonalizationPromotionsSmarteditContainer);t.PROMOTION_ACTION_TYPE=g},959:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(4);var s=o(0);var a=o(40);var r=o(228);var d=o(86);(function(){var e=e||window.angular;var t=null;try{t=e.module("personalizationpromotionssmarteditCommonTemplates")}catch(e){}t=t||e.module("personalizationpromotionssmarteditCommonTemplates",[]);t.run(["$templateCache",function(e){}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}var p;t.PromotionsSmarteditRestService=p=class PromotionsSmarteditRestService{constructor(e,t){this.restServiceFactory=e;this.smarteditUtils=t}getPromotions(e){const t=this.restServiceFactory.get(p.AVAILABLE_PROMOTIONS);const o=[];e=e||[];e.forEach(((e,t)=>{this.smarteditUtils.pushToArrayIfValueExists(o,"catalog"+t,e.catalog);this.smarteditUtils.pushToArrayIfValueExists(o,"version"+t,e.catalogVersion)}));const n={params:{entry:o}};return t.save(n)}};t.PromotionsSmarteditRestService.AVAILABLE_PROMOTIONS="/personalizationwebservices/v1/query/cxpromotionsforcatalog";t.PromotionsSmarteditRestService=p=__decorate([d.SeDowngradeService(),__metadata("design:paramtypes",[d.IRestServiceFactory,r.PersonalizationsmarteditUtils])],t.PromotionsSmarteditRestService);t.PersonalizationPromotionsSmarteditCommonsModule=class PersonalizationPromotionsSmarteditCommonsModule{};t.PersonalizationPromotionsSmarteditCommonsModule=__decorate([s.NgModule({imports:[n.CommonModule,a.BrowserModule],providers:[t.PromotionsSmarteditRestService]})],t.PersonalizationPromotionsSmarteditCommonsModule)},960:function(e,t,o){},961:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(133);var s=o(0);var a=o(20);var r=o(40);var d=o(139);var p=o(962);var m=o(86);var g=o(46);var u=o(93);var v=o(105);var f=o(4);var S=o(136);var C=o(42);var b=o(182);var I=o(963);var w=o(197);var E=o(56);function _interopNamespace(e){if(e&&e.__esModule)return e;var t=Object.create(null);if(e){Object.keys(e).forEach((function(o){if(o!=="default"){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:true,get:function(){return e[o]}})}}))}t["default"]=e;return Object.freeze(t)}var T=_interopNamespace(u);(function(){var e=e||window.angular;var t=null;try{t=e.module("cmssmarteditContainerTemplates")}catch(e){}t=t||e.module("cmssmarteditContainerTemplates",[]);t.run(["$templateCache",function(e){e.put("ItemManagerComponent.html",'<div><se-generic-editor [id]="editorId" [smarteditComponentId]="itemId" [smarteditComponentType]="componentType" [structureApi]="structureApi" [content]="item" [contentApi]="contentApi" [(isDirty)]="isDirtyInternal" [(submit)]="submit" [uriContext]="uriContext" [reset]="reset"></se-generic-editor></div>');e.put("NavigationManagementPageComponent.html",'<div class="se-navigation-management-page-list-template"><div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell se-toolbar--shortcut" imageRoot="imageRoot" toolbarName="smartEditNavigationToolbar"></se-toolbar></div><div class="se-navigation-editor-wrapper" *ngIf="readOnly !== undefined"><div class="se-navigation-editor-header"><h1 class="se-navigation-editor-header__title" translate="se.cms.navigationmanagement.title"></h1><h4 class="se-navigation-editor-header__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</h4></div><se-navigation-editor-tree [uriContext]="uriContext" [readOnly]="readOnly"></se-navigation-editor-tree></div></div>');e.put("CmsComponentDropdownComponent.html",'<div class="cms-nested-component-template"><div class="cms-nested-component-select"><ng-container *ngIf="forceRecompile"><se-generic-editor-dropdown [field]="field" [qualifier]="qualifier" [model]="model" [id]="id" [itemComponent]="itemComponent" [actionableSearchItem]="actionableSearchItem" [showRemoveButton]="true"></se-generic-editor-dropdown></ng-container></div></div>');e.put("ComponentMenuComponent.html",'<div class="se-component-menu" [ngClass]="{ \'se-component-menu__localized\': hasMultipleContentCatalogs }"><div translate="se.cms.componentmenu.dropdown.header" class="se-component-menu__title"></div><div class="se-component-menu__tip" translate="se.cms.componentmenu.label.draganddrop"></div><se-tabs *ngIf="toolbarItem.isOpen" class="se-component-menu__tabs" [tabsList]="tabsList" [model]="model" [numTabsDisplayed]="2"></se-tabs></div>');e.put("CmsLinkToSelectComponent.html",'<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="qualifier" [model]="optionModel"></se-generic-editor-dropdown>');e.put("InfoPageNameComponent.html",'<div class="se-page-info__name"><se-homepage-icon *ngIf="field.qualifier === \'name\'" [cmsPage]="cmsPage" [uriContext]="uriContext"></se-homepage-icon><div id="{{ field.qualifier }}-homepage" class="se-page-info__name-value fd-form-control" [title]="field.qualifier">{{ model[qualifier] }}</div></div>');e.put("LinkToggleComponent.html",'<div class="se-link-toggle"><div class="se-link-toggle__row"><div class="se-form-control-row se-form-control-row--action"><label class="se-control-label se-link-toggle__label" for="external-link"><input class="fd-form__control se-link-toggle__input" id="external-link" name="linktoggle" type="radio" [(ngModel)]="model.linkToggle.external" (ngModelChange)="clearUrlLink()" [value]="true"/> {{ \'se.editor.linkto.external.label\' | translate}}</label></div><div class="se-form-control-row se-form-control-row--action"><label class="se-control-label se-link-toggle__label" for="internal-link"><input class="fd-form__control se-link-toggle__input" id="internal-link" name="linktoggle" type="radio" [(ngModel)]="model.linkToggle.external" (ngModelChange)="clearUrlLink()" [value]="false"/> {{ \'se.editor.linkto.internal.label\' | translate}}</label></div></div><input class="fd-form-control" id="urlLink" name="urlLink" type="text" [(ngModel)]="model.linkToggle.urlLink" (ngModelChange)="checkUrlLink()" [ngClass]="{ \'has-error\': field.hasErrors }"/></div>');e.put("PageTypeEditorComponent.html",'<div class="se-edit-page-info__basic-tab"><div class="se-edit-page-info__page-type"><label class="se-control-label" translate="se.cms.pageinfo.page.type"></label><div class="form-readonly-text form-readonly-text__tight">{{ model.typeCode }}</div></div><div class="se-edit-page-info__page-template"><label class="se-control-label" translate="se.cms.pageinfo.page.template"></label><div class="form-readonly-text form-readonly-text__tight">{{ model.template }}</div></div></div>');e.put("RestrictionsListComponent.html",'<div class="restrictions-list"><div class="restrictions-list__info"><label translate="se.cms.restrictions.criteria"></label> <span>&nbsp;{{ pageInfo.restrictionsCriteria }}</span></div><div class="restrictions-list__items" *ngFor="let restriction of restrictions"><div class="restrictions-list__item"><div class="restrictions-list__item-name">{{ restriction.name }}</div><div class="restrictions-list__item-type">{{ restriction.type | seL10n | async }}</div><div class="restrictions-list__item-description">{{ restriction.description }}</div></div></div></div>');e.put("SingleActiveCatalogAwareItemSelectorComponent.html",'<div *ngIf="propertyType"><div id="product-catalog"><label class="se-control-label" [ngClass]="{ \'required\': field.required }" *ngIf="catalogs.length === 1">{{ catalogName | seL10n | async }}</label><se-generic-editor-dropdown id="se-catalog-selector-dropdown" *ngIf="catalogs.length > 1" [field]="productCatalogField" [qualifier]="\'productCatalog\'" [model]="model"></se-generic-editor-dropdown></div><div><label class="se-control-label" [translate]="mainDropDownI18nKey"></label><se-generic-editor-dropdown id="se-items-selector-dropdown" [field]="field" [qualifier]="qualifier" [model]="model" [itemComponent]="itemComponent" [(reset)]="reset"></se-generic-editor-dropdown></div></div><div class="product-catalog-item-type-missing" *ngIf="!propertyType" translate="se.cms.catalogawareitem.itemtype.notsupported"></div>');e.put("SlotSharedCloneActionFieldComponent.html",'<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label for="components-in-slot-options" class="se-control-label" [translate]="\'se.cms.slot.shared.replace.editor.componentsinslot\'"></label><div id="components-in-slot-options"><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="clone-all" [(ngModel)]="page.cloneAction" [value]="cloneAction.clone"/> <label for="clone-all" [translate]="\'se.cms.slot.shared.replace.editor.componentsinslot.cloneall\'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="use-existing" [(ngModel)]="page.cloneAction" [value]="cloneAction.useExisting"/> <label for="use-existing" [translate]="\'se.cms.slot.shared.replace.editor.componentsinslot.useexisting\'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="remove-all" [(ngModel)]="page.cloneAction" [value]="cloneAction.remove"/> <label for="remove-all" [translate]="\'se.cms.slot.shared.replace.editor.componentsinslot.removeall\'"></label></div></div></div></div>');e.put("SlotSharedSlotTypeFieldComponent.html",'<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label for="slot-replacement-type-options" class="se-control-label" [translate]="\'se.cms.slot.shared.replace.editor.slotreplacementtype\'"></label><div id="slot-replacement-type-options"><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="slotReplacementType" id="slot-type-custom" [(ngModel)]="page.isSlotCustom" [value]="true"/> <label for="slot-type-custom" [translate]="\'se.cms.slot.shared.replace.editor.slotreplacementtype.nonshared\'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="slotReplacementType" id="slot-type-local" [(ngModel)]="page.isSlotCustom" [value]="false"/> <label for="slot-type-local" [translate]="\'se.cms.slot.shared.replace.editor.slotreplacementtype.local\'"></label></div></div></div></div>');e.put("WorkflowCreateVersionFieldComponent.html",'<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label class="fd-form__label"><input type="checkbox" class="fd-form__control" name="createVersion" [(ngModel)]="model.createVersion"/> {{ \'se.cms.workflow.editor.create.version\' | translate }}</label></div><div class="fd-form__item" *ngIf="model.createVersion"><label class="fd-form__label version-label__title" for="versionLabel" translate="se.cms.workflow.editor.create.version.label"></label> <input type="text" name="versionLabel" class="fd-form__control" [class.has-error]="field.hasErrors" [(ngModel)]="model.versionLabel"/></div></div>');e.put("NavigationEditorTreeComponent.html",'<div class="se-navigation-editor-tree__header" *ngIf="!readOnly"><button class="se-navigation-editor-tree__btn fd-button" (click)="actions.addTopLevelNode()"><span [translate]="\'se.cms.navigationmanagement.add.top.level.node\'" class="se-navigation-editor-tree__btn--text"></span></button></div><div class="se-navigation-editor-tree categoryTable"><div class="tablehead clearfix hidden-xs se-navigation-editor-tree__head"><div [translate]="\'se.ytree.template.header.name\'" class="se-navigation-editor-tree__name col-xs-3"></div><div [translate]="\'se.ytree.template.header.title\'" class="se-navigation-editor-tree__title col-xs-3"></div><div class="col-xs-1 pull-right"></div><div [translate]="\'se.ytree.template.header.entry\'" class="se-navigation-editor-tree__entry col-xs-5 pull-right"></div></div><se-tree [nodeUri]="nodeURI" [rootNodeUid]="rootNodeUid" [nodeComponent]="nodeComponent" [removeDefaultTemplate]="true" [nodeActions]="actions" [dragOptions]="dragOptions"></se-tree></div>');e.put("NavigationNodeComponent.html",'<div class="pull-right dropdown tree-node se-tree-node__actions col-sm-1" [hidden]="isReadOnly"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div><div class="se-tree-node__name col-xs-3" [title]="node.name | seL10n | async"><span>{{ node.name | seL10n | async }}</span></div><div class="pull-right tree-node se-tree-node__entry col-xs-5"><se-tooltip class="se-dropdown-item__delete-page-popover" [triggers]="[\'mouseenter\', \'mouseleave\']" [isChevronVisible]="true" [appendTo]="\'body\'"><span se-tooltip-trigger class="se-tree-node__popover"><span>{{ entryString }} </span></span><span se-tooltip-body>{{ entryString }}</span></se-tooltip></div><div class="se-tree-node__title col-xs-2"><span [hidden]="!node.title">{{ node.title | seL10n | async }}</span></div>');e.put("PageTreeComponent.html",'<div><div class="se-page-tree-node" [ngClass]="component.isExpanded && \'se-page-tree-node-expand\'" [attr.node-smartedit-element-uuid]="!component.isHidden ?                     component.elementUuid :                     \'hidden-component-has-no-uuid\'"><div (click)="onClickComponentNode($event)" class="se-page-tree-component-node--content"><span [ngClass]="component.isExpanded ?                                \'sap-icon--navigation-down-arrow\' :                                \'sap-icon--navigation-right-arrow\'" class="se-page-tree-node--icon se-page-tree-component-node se-page-tree-component-node--icon"></span> <span class="se-page-tree-node--icon se-page-tree-component-node--icon sap-icon--vertical-grip"></span> <span class="se-page-tree-node--icon se-page-tree-component-node--icon sap-icon--background"></span><div class="se-page-tree-component-node--name"><span class="se-page-tree-component-node--name--up">{{component.name}}</span> <span class="se-page-tree-component-node--name--down">{{component.typeCode}}</span></div></div><se-page-tree-component-menu [component]="component" [slotId]="slotId" [slotUuid]="slotUuid" class="se-page-tree-component-node-menu"></se-page-tree-component-menu></div></div>');e.put("PageTreeComponentMenuComponent.html",'<div class="se-page-tree-component-menu"><span [ngClass]="component.isHidden ? \'sap-icon--hide\' : \'sap-icon--show\'" class="se-page-tree-component-menu--icon"></span><se-popup-overlay *ngIf="!!leftButton" [popupOverlay]="itemTemplateOverlayWrapper" [popupOverlayTrigger]="canShowTemplate(leftButton)" [popupOverlayData]="{ item: leftButton }" (popupOverlayOnHide)="onHideItemPopup(false)"><span class="se-page-tree-component-menu--icon" [ngClass]="leftButton.displayIconClass" (click)="triggerMenuItemAction(leftButton, $event)"></span></se-popup-overlay><se-popup-overlay [popupOverlay]="moreMenuPopupConfig" [popupOverlayTrigger]="moreMenuIsOpen"><span *ngIf="items && items.length > 0" (click)="toggleMoreMenu()" class="se-page-tree-component-menu--icon sap-icon--overflow"></span></se-popup-overlay></div>');e.put("PageTreePanel.html",'<div class="se-page-tree"><div class="se-page-tree--header"><span class="se-page-tree--header--icon sap-icon--Chart-Tree-Map"></span> <span class="se-page-tree--header--title">{{ \'se.page.tree.title\' | translate }}</span></div><div *ngFor="let node of slotNodes"><se-page-tree-slot [node]="node" (onSlotExpanded)="onSlotExpanded($event)"></se-page-tree-slot></div></div>');e.put("PageTreeSlot.html",'<div><div class="se-page-tree-node" [ngClass]="node.isExpanded && \'se-page-tree-node-expand\'" [attr.node-smartedit-element-uuid]="node.elementUuid"><span (click)="onClickSlotNode($event)" [ngClass]="node.isExpanded ?                    \'sap-icon--navigation-down-arrow\' :                    \'sap-icon--navigation-right-arrow\'" class="se-page-tree-node--icon"></span> <span class="se-page-tree-slot-node--name" (click)="onClickSlotNode($event)">{{node.componentId}}</span><div class="se-page-tree-slot-node-menu"><span class="se-page-tree-slot-node-menu--icon sap-icon--chain-link"></span> <span class="se-page-tree-slot-node-menu--icon sap-icon--synchronize"></span></div></div><div *ngIf="node.isExpanded && node.componentNodes.length"><div *ngFor="let child of node.componentNodes"><se-page-tree-component [component]="child" [slotId]="node.componentId" [slotUuid]="node.componentUuid" [slotElementUuid]="node.elementUuid" (onComponentExpanded)="onComponentExpanded($event)"></se-page-tree-component></div></div></div>');e.put("DeletePageToolbarItemComponent.html",'<div class="toolbar-action" *ngIf="isReady" [attr.data-item-key]="toolbarItem.key"><button type="button" class="btn toolbar-action--button" [disabled]="isDeletePageDisabled" [ngClass]="{ \'toolbar-action__disabled\' : isDeletePageDisabled }" (click)="deletePage()"><span class="icon-delete se-toolbar-menu-ddlb--button__icon"></span><div class="toolbar-action-button__txt" translate="se.cms.actionitem.page.trash"></div></button><se-tooltip *ngIf="isDeletePageDisabled" [appendTo]="\'body\'" [isChevronVisible]="true" [placement]="\'bottom\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [additionalClasses]="[\'se-tooltip--stretched\']"><div se-tooltip-body><span [translate]="tooltipMessage"></span></div></se-tooltip></div>');e.put("HomepageIconComponent.html",'<se-tooltip *ngIf="isVisible()" [isChevronVisible]="true" [triggers]="[\'mouseenter\', \'mouseleave\']"><span se-tooltip-trigger class="sap-icon--home se-homepage-icon" [ngClass]="getIconClass()"></span> <span se-tooltip-body [translate]="getTooltipMessage()"></span></se-tooltip>');e.put("PageInfoMenuComponent.html",'<div class="toolbar-action" data-item-key="se.cms.pageInfoMenu"><fd-popover [(isOpen)]="toolbarItem.isOpen" (isOpenChange)="onDropdownToggle($event)" [closeOnOutsideClick]="true"><fd-popover-control><button type="button" class="btn toolbar-action--button" [attr.aria-pressed]="toolbarItem.isOpen"><span class="hyicon hyicon-pageinfo se-toolbar-menu-ddlb--button__icon"></span><div class="se-toolbar-page-info-wrapper"><span class="toolbar-action-button__txt" [translate]="toolbarItem.name"></span></div></button></fd-popover-control><fd-popover-body><div class="se-page-info__dropdown-menu toolbar-action--include"><div class="se-page-info-menu" *ngIf="toolbarItem.isOpen"><se-prevent-vertical-overflow><div class="se-page-info-menu__header"><span class="se-page-info-menu__header-title" translate="se.cms.pageinfo.information.title"></span><div *seHasOperationPermission="editPagePermission"><button class="se-page-info__edit-btn fd-button--compact" *ngIf="isReady" translate="se.cms.contextmenu.title.edit" (click)="onEditPageClick()"></button></div></div><div *ngIf="isReady" class="se-page-info-menu__body"><se-generic-editor [smarteditComponentId]="pageInfo.uid" [smarteditComponentType]="pageInfo.typeCode" [structure]="pageStructure" [content]="pageInfo"></se-generic-editor></div></se-prevent-vertical-overflow></div></div></fd-popover-body></fd-popover></div>');e.put("PageListComponent.html",'<div class="se-page-list"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell se-toolbar--shortcut" imageRoot="imageRoot" toolbarName="smartEditPagesToolbar"></se-toolbar><div *ngIf="isReady"><div class="se-page-list__header"><span class="se-page-list__catalog-name" translate="se.cms.pagelist.title"></span><p class="se-page-list__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</p></div><div class="se-page-list__body"><div class="se-page-list__table-header"><span class="se-paged-list__page-count-wrapper"><span class="span-page-list__page-count-text" translate="se.pagelist.countsearchresult"></span> <span>&nbsp;</span> <span class="se-page-list__page-count">({{ count }})</span></span><div class="se-page-list__table-header--right"><div class="fd-form__group se-page-list__search"><div class="se-input-group"><input type="search" class="se-input-group__input-area ySEPage-list-search-input" maxlength="255" name="query" [ngModel]="query" (ngModelChange)="onQueryChange($event)" [placeholder]="\'se.cms.pagelist.searchplaceholder\' | translate"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="query" aria-label="clear" class="se-input-group__addon se-input-group__clear-btn" (click)="reset()"><span class="sap-icon--decline"></span></div></div></div><button class="fd-button se-page-list__add" (click)="openAddPageWizard()" translate="se.cms.addpagewizard.addpage"></button></div></div><div class="se-page-list__table-body"><se-dynamic-paged-list [config]="pageListConfig" [mask]="query" (getApi)="getApi($event);" (onItemsUpdate)="onPageItemsUpdate($event.pagination)"></se-dynamic-paged-list></div></div></div></div>');e.put("PageListLinkComponent.html",'<div><a class="page-list-link-item__link" [href]="getLink()" translate="se.cms.cataloginfo.pagelist" (click)="onClick()"></a></div>');e.put("PagesLinkComponent.html",'<div class="se-page-list__page-link--left" (click)="backToPagelist()"><span class="se-page-list__page-link-icon icon-navigation-left-arrow"></span> <a class="se-page-list__page-link-anchor">{{ \'se.cms.back.to.pagelist\' | translate }}</a></div>');e.put("RestrictionsModalComponent.html",'<div class="se-restrictions-list fd-menu__list fd-menu__list--separated"><div class="se-restriction__item fd-menu__item" *ngFor="let restriction of restrictions"><div class="se-restrictions-list__item-content"><div class="se-restriction__item-name">{{ restriction.name }}</div><div class="se-restriction__item-type-and-id">{{ restriction.type | seL10n | async }}</div><div class="se-restriction__item-description">{{ restriction.description }}</div></div></div></div>');e.put("RestrictionsViewerComponent.html",'<div *ngIf="restrictions?.length > 0; else noRestrictions"><a href="" class="show-restrictions-btn" (click)="showRestrictions($event)">{{restrictions.length}}</a></div><ng-template #noRestrictions><div>-</div></ng-template>');e.put("TrashLinkComponent.html",'<div *ngIf="isNonActiveCatalog" (click)="goToTrash()" class="se-page-list__page-link--right"><a translate="se.cms.pagelist.trashcan.link.text" [translateParams]="trashedPagesTranslationData" class="se-page-list__page-link-anchor"></a> <span class="se-page-list__page-link-icon sap-icon--navigation-right-arrow"></span></div>');e.put("TrashedPageListComponent.html",'<div class="se-page-list"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell ySmartEditTrashPageToolbar" imageRoot="imageRoot" toolbarName="smartEditTrashPageToolbar"></se-toolbar><div class="se-page-list__header"><span class="se-page-list__catalog-name" translate="se.cms.trashedpagelist.title"></span><p class="se-page-list__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</p></div><div class="se-page-list__body"><div class="se-page-list__table-header"><span class="se-paged-list__page-count-wrapper"><span class="span-page-list__page-count-text" translate="se.pagelist.countsearchresult"></span> <span>&nbsp;</span> <span class="se-page-list__page-count">({{ count }})</span></span><div class="fd-form__group se-page-list__search"><div class="se-input-group"><input type="search" class="se-input-group__input-area ySEPage-list-search-input" placeholder="{{ \'se.cms.pagelist.searchplaceholder\' | translate }}" [ngModel]="mask" (ngModelChange)="onMaskChange($event)" name="mask"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="mask" aria-label="clear" class="se-input-group__addon se-input-group__clear-btn" (click)="reset()"><span class="sap-icon--decline"></span></div></div></div></div><div class="se-page-list__table-body"><se-dynamic-paged-list class="se-trashed-pages" [config]="trashedPageListConfig" [mask]="mask" (getApi)="getApi($event);" (onItemsUpdate)="onPageItemsUpdate($event.pagination)"></se-dynamic-paged-list></div></div></div>');e.put("catalogDetailsSyncTemplate.html",'<se-synchronize-catalog [catalog]="$ctrl.catalog" [catalog-version]="$ctrl.catalogVersion" [active-catalog-version]="$ctrl.activeCatalogVersion"></se-synchronize-catalog>');e.put("CmsDropdownItemComponent.html",'<div class="cms-nested-component" *ngIf="item" [attr.data-component-id]="item.uid"><span class="cms-nested-component__item" *ngIf="isSelected" (click)="onClick($event);"><span class="sap-icon--card cms-nested-component__item-icon"></span><div class="cms-nested-component__item-data"><p class="cms-nested-component__item-name" [title]="item.name">{{ item.name }}</p><p class="cms-nested-component__item-type" [title]="item.typeCode">{{ item.typeCode }}</p></div></span><div class="cms-nested-component__result-item" *ngIf="!isSelected"><span class="cms-nested-component__result-name" [title]="item.name">{{ item.name }}</span> <span class="cms-nested-component__result-code" [title]="item.typeCode">{{ item.typeCode }}</span></div></div>');e.put("ComponentItemComponent.html",'<div class="se-component-item" [ngClass]="{ \'se-component-item--disabled\': isComponentDisabled, \'smartEditComponent\': !isComponentDisabled }" [attr.data-smartedit-component-id]="componentInfo.uid" [attr.data-smartedit-component-uuid]="componentInfo.uuid" [attr.data-smartedit-component-type]="componentInfo.typeCode"><se-tooltip *ngIf="isComponentDisabled" class="se-component-item__tooltip" [appendTo]="\'body\'" [placement]="\'bottom\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [additionalClasses]="[\'se-component-item__tooltip--for-disabled\']"><div se-tooltip-trigger class="se-component-item--disabled-overlay"></div><div se-tooltip-body class="se-popover--inner-content" translate="se.cms.component.non.cloneable.tooltip" [translateParams]="{ componentName: componentInfo.name }"></div></se-tooltip><div class="se-component-item--image"><span class="sap-icon--card"></span><div *ngIf="isSharedComponent"><span class="se-component-item--image-shared--background"></span> <span class="glyphicon glyphicon-link se-component-item--image-shared"></span></div></div><div class="se-component-item--details-container"><div class="se-component-item--details" title="{{ componentInfo.name }} - {{ componentInfo.typeCode }}"><div class="se-component-item--details-name">{{ componentInfo.name }}</div><div class="se-component-item--details-type">{{ componentInfo.typeCode }}</div></div><se-tooltip *ngIf="!componentInfo.visible" [appendTo]="\'body\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [additionalClasses]="[\'se-component-item--visibility\']"><span se-tooltip-trigger class="hyicon hyicon-unpowered"></span><div se-tooltip-body translate="se.cms.component.display.off.tooltip"></div></se-tooltip></div></div>');e.put("ComponentSearchComponent.html",'<div class="se-input-group se-component-menu__input-group"><input type="text" class="se-input-group__input-area" name="search-term" [(ngModel)]="searchQuery" (ngModelChange)="onSearchQueryChange($event)" placeholder="{{ placeholderI18nKey | translate }}"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div>');e.put("ComponentTypeComponent.html",'<div class="se-component-item smartEditComponent" [attr.data-smartedit-component-type]="typeInfo.code"><div class="se-component-item--image"><span class="sap-icon--card"></span></div><div class="se-component-item--details-type" [title]="typeInfo.i18nKey | translate">{{ typeInfo.name }}</div></div>');e.put("ComponentTypesTabComponent.html",'<div class="se-component-menu__types-header"><se-component-search (onChange)="onSearchTermChanged($event)" [placeholderI18nKey]="\'se.cms.componentmenu.search.type.placeholder\'" class="se-component-menu__type-search"></se-component-search></div><div class="se-component-menu__result-container"><se-infinite-scrolling class="se-component-menu__infinite-scroll" *ngIf="isMenuOpen() || isTabActive()" [pageSize]="10" [mask]="searchTerm" [fetchPage]="loadComponentTypes" [context]="componentsContext"><div class="se-component-menu__result se-component-menu__result--types"><div class="se-component-menu__item-wrap" *ngFor="let componentType of componentsContext.items"><se-component-type [typeInfo]="componentType"></se-component-type></div></div></se-infinite-scrolling></div>');e.put("ComponentsTabComponent.html",'<div class="se-component-menu__tabs-header"><div class="se-component-menu__tabs-header--upper" *ngIf="hasMultipleContentCatalogs()"><se-select id="se-components-tab-catalog-versions" class="se-component-menu__select" [(model)]="selectedCatalogVersionId" (modelChange)="onCatalogVersionChange()" [fetchStrategy]="catalogVersionsFetchStrategy" [searchEnabled]="false" [itemComponent]="itemComponent"></se-select></div><div class="se-component-menu__tabs-header--lower"><se-component-search (onChange)="onSearchTermChanged($event)" [placeholderI18nKey]="\'se.cms.componentmenu.search.placeholder\'" class="se-component-menu__tabs-search"></se-component-search><fieldset class="fd-form__set"><div class="fd-form__item fd-form__item--check se-component-menu__clone-on-drop"><input type="checkbox" class="fd-form__control se-component-menu__clone-check-box" id="component-clone-checkbox" name="clone-on-drop" [(ngModel)]="cloneOnDrop" (ngModelChange)="onComponentCloneOnDropChange($event)"/> <label class="fd-form__label se-component-menu__clone-label" for="component-clone-checkbox" translate="se.cms.component.clone.on.drop.label"></label></div></fieldset></div></div><div class="se-component-menu__result-container" *ngIf="forceRecompile"><se-infinite-scrolling *ngIf="isActive()" class="se-component-menu__infinite-scroll" [ngClass]="{\'se-component-menu__infinite-scroll--short\': hasMultipleContentCatalogs() }" [pageSize]="10" [mask]="searchTerm" [fetchPage]="loadComponentItems" [context]="componentsContext"><div class="se-component-menu__result" *ngIf="componentsContext.items.length"><se-component-item class="se-component-menu__item-wrap" *ngFor="let item of componentsContext.items; trackBy: trackById" [componentInfo]="item" [cloneOnDrop]="cloneOnDrop"></se-component-item></div></se-infinite-scrolling></div>');e.put("ComponentRestrictionsEditorComponent.html",'<se-restrictions-editor [editable]="isEditable" [getRestrictionTypes]="getRestrictionTypes" [getSupportedRestrictionTypes]="getSupportedRestrictionTypes" [item]="model" [restrictionUuids]="model.restrictions" (onRestrictionsChange)="onRestrictionsChange($event)"></se-restrictions-editor>');e.put("DuplicatePrimaryContentPageLabelComponent.html",'<div><div class="fd-form__item fd-form__item--check"><input class="fd-form__control" type="radio" name="duplicateResolution" id="overwritePrimaryPageOption" [(ngModel)]="conflictResolution" (click)="selectResolution(RESOLUTION_OPTIONS.overwritePage)" [value]="RESOLUTION_OPTIONS.overwritePage"/> <label for="overwritePrimaryPageOption" class="fd-form__label" [translate]="\'se.cms.page.restore.content.duplicate.primaryforvariation.option.overwrite\'"></label></div><div class="fd-form__item fd-form__item--check"><input class="fd-form__control" type="radio" name="duplicateResolution" id="renamePrimaryPageOption" [(ngModel)]="conflictResolution" (click)="selectResolution(RESOLUTION_OPTIONS.renamePageLabel)" [value]="RESOLUTION_OPTIONS.renamePageLabel"/> <label for="renamePrimaryPageOption" class="fd-form__label" [translate]="\'se.cms.page.restore.content.duplicate.primaryforvariation.option.rename\'"></label></div><div class="rename-label-section" *ngIf="conflictResolution === RESOLUTION_OPTIONS.renamePageLabel"><label [translate]="\'se.cms.page.restore.page.label\'"></label> <input type="text" class="form-control" [(ngModel)]="page[\'label\']"/></div></div>');e.put("DuplicatePrimaryNonContentPageComponent.html",'<div><label [translate]="label"></label></div>');e.put("MissingPrimaryContentPageComponent.html",'<div><div><label class="missing-primary-content-page-message__label" [translate]="\'se.cms.page.restore.content.page.noprimaryforvariation.msg\'"></label></div><se-select id="se-page-restore-change-primary-selector-dropdown" [(model)]="cmsPage.label" [fetchStrategy]="fetchStrategy"></se-select></div>');e.put("MuteBooleanComponent.html",'<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label" for="{{widget.qualifier}}-checkbox"><input type="checkbox" id="{{widget.qualifier}}-checkbox" class="se-boolean__input" [placeholder]="(widget.field.tooltip || \'\') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]"/> <span class="fd-toggle__switch" role="presentation"></span></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>');e.put("ThumbnailSelectComponent.html",'<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="qualifier" [model]="model"></se-generic-editor-dropdown>');e.put("clonePageInfoStepTemplate.html",'<se-component-clone-info-form data-ng-if="clonePageWizardCtrl.isPageInfoActive()" [structure]="clonePageWizardCtrl.getPageInfoStructure()" [content]="clonePageWizardCtrl.getPageInfo()" [(submit)]="clonePageWizardCtrl.callbacks.savePageInfo" [(reset)]="clonePageWizardCtrl.callbacks.resetPageInfo" [(is-dirty)]="clonePageWizardCtrl.callbacks.isDirtyPageInfo" [(is-valid)]="clonePageWizardCtrl.callbacks.isValidPageInfo" [page-template]="clonePageWizardCtrl.getPageTemplate()" [page-type-code]="clonePageWizardCtrl.getPageTypeCode()" [uri-context]="clonePageWizardCtrl.uriContext" [target-catalog-version]="clonePageWizardCtrl.getTargetCatalogVersion()"></se-component-clone-info-form>');e.put("clonePageOptionsStepTemplate.html",'<se-event-message class="existing-homepage__ymessage" [show-event]="\'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO\'" [hide-event]="\'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO\'"></se-event-message><se-select-target-catalog-version data-ng-if="clonePageWizardCtrl.isBasePageInfoAvailable()" [page-type-code]="clonePageWizardCtrl.getPageTypeCode()" [page-label]="clonePageWizardCtrl.getPageLabel()" [uri-context]="clonePageWizardCtrl.uriContext" (on-target-catalog-version-selected)="clonePageWizardCtrl.onTargetCatalogVersionSelected($event)"></se-select-target-catalog-version><se-new-page-display-condition [page-type-code]="clonePageWizardCtrl.getPageTypeCode()" [uri-context]="clonePageWizardCtrl.uriContext" [result-fn]="clonePageWizardCtrl.variationResult" [initial-condition-selected-key]="\'page.displaycondition.variation\'" [initial-primary-page-selected-label]="clonePageWizardCtrl.getPageLabel()" [target-catalog-version]="clonePageWizardCtrl.getTargetCatalogVersion()"></se-new-page-display-condition><se-component-clone-option-form (on-selection-change)="clonePageWizardCtrl.triggerUpdateCloneOptionResult($event)"></se-component-clone-option-form>');e.put("clonePageRestrictionsStepTemplate.html",'<span data-ng-if="clonePageWizardCtrl.isRestrictionsActive()" class="se-clone-page-restriction-step"><div data-ng-if="clonePageWizardCtrl.getPageRestrictions().length > 1"><se-page-restrictions-info-message></se-page-restrictions-info-message></div><se-restrictions-editor [editable]="true" [(reset-fn)]="clonePageWizardCtrl.restrictionsEditorFunctionBindings.reset" [(cancel-fn)]="clonePageWizardCtrl.restrictionsEditorFunctionBindings.cancel" [(is-dirty-fn)]="clonePageWizardCtrl.restrictionsEditorFunctionBindings.isDirty" (on-restrictions-change)="clonePageWizardCtrl.restrictionsResult($event)" [get-restriction-types]="clonePageWizardCtrl.getRestrictionTypes" [get-supported-restriction-types]="clonePageWizardCtrl.getSupportedRestrictionTypes" [item]="clonePageWizardCtrl.getBasePageInfo()" [restrictionUuids]="clonePageWizardCtrl.model.restrictions"></se-restrictions-editor></span>');e.put("DisplayConditionsEditorComponent.html",'<div><se-event-message class="existing-homepage__ymessage" [showEvent]="\'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO\'" [hideEvent]="\'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO\'"></se-event-message><se-display-conditions-page-info [pageName]="getPageName()" [pageType]="getPageType()" [isPrimary]="isPagePrimary()"></se-display-conditions-page-info><se-display-conditions-page-variations *ngIf="isPagePrimary()" [variations]="getVariations()"></se-display-conditions-page-variations><se-display-conditions-primary-page *ngIf="!isPagePrimary()" [readOnly]="getIsAssociatedPrimaryReadOnly()" [associatedPrimaryPage]="getAssociatedPrimaryPage()" [pageType]="getPageType()" (onPrimaryPageSelect)="onPrimaryPageSelect($event)"></se-display-conditions-primary-page><div *ngIf="showHomePageWidget()"><div class="se-component-homepage"><label class="se-control-label"><input type="checkbox" id="set-homepage-checkbox" class="fd-form__control se-display-conditions__homepage-input" name="clone-on-drop" [disabled]="disableHomepageCheckbox()" (ngModelChange)="homePageChanged($event)" [ngModel]="page.homepage"/> <span translate="se.cms.display.conditions.homepage.set"></span><se-help *ngIf="disableHomepageCheckbox()"><span translate="se.cms.display.conditions.homepage.disabled"></span></se-help></label></div><div class="se-display-conditions__replace-home-message" *ngIf="showReplaceLabel" translate="se.cms.display.conditions.homepage.replace" [translateParams]="{ currentHomepage: currentHomePageName }"></div></div></div>');e.put("DisplayConditionsPageInfoComponent.html",'<div class="se-edit-page-info__display-conditions"><div class="se-edit-page-info-display-conditions__basic-info"><div><label class="se-control-label" translate="se.cms.pagelist.headerpagename"></label><div class="form-readonly-text form-readonly-text__tight dc-page-name">{{ pageName }}</div></div><div><label class="se-control-label" translate="se.cms.pagelist.headerpagetype"></label><div class="form-readonly-text form-readonly-text__tight dc-page-type">{{ pageType }}</div></div></div><label class="se-control-label"><span translate="se.cms.display.conditions.label"></span><se-help><span [translate]="getPageDisplayConditionDescriptionI18nKey()"></span></se-help></label><p class="form-readonly-text form-readonly-text__tight dc-page-display-condition" [translate]="getPageDisplayConditionI18nKey()"></p></div>');e.put("DisplayConditionsPageVariationsComponent.html",'<div class="form-group dc-page-variations"><label class="se-control-label control-label__margin"><span translate="se.cms.display.conditions.variation.pages.title"></span><se-help *ngIf="variations.length > 0"><span translate="se.cms.display.conditions.variations.description"></span></se-help></label><div *ngIf="variations.length === 0" class="dc-no-variations form-readonly-text form-readonly-text__tight form-readonly-text__inline" translate="se.cms.display.conditions.no.variations"></div><div *ngIf="variations.length > 0"><se-client-paged-list [items]="variations" [keys]="keys" [itemsPerPage]="itemsPerPage" class="dc-page-variations-list"></se-client-paged-list></div></div>');e.put("DisplayConditionsPrimaryPageComponent.html",'<div class="form-group form-group__inline"><label class="se-control-label control-label__margin" translate="se.cms.display.conditions.primary.page.label"></label><div *ngIf="readOnly" class="dc-associated-primary-page form-readonly-text form-readonly-text__tight">{{ associatedPrimaryPage?.name }}</div><div *ngIf="!readOnly"><se-select id="display-conditions-primary-association-selector" [model]="associatedPrimaryPageUid" (modelChange)="associatedPrimaryPageUidOnChange($event)" [fetchStrategy]="fetchStrategy"></se-select><span *ngIf="associatedPrimaryPage?.name" class="se-form-help-message"><span>{{ \'se.cms.page.label.label\' | translate }}: {{ associatedPrimaryPage.label }}</span></span></div></div>');e.put("ClonePageItemComponent.html",'<div *seHasOperationPermission="clonePagePermission"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnClone()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.clone"></span></a></div>');e.put("DeletePageItemComponent.html",'<div *seHasOperationPermission="deletePagePermission"><div class="se-dropdown-item__delete-wrapper"><div class="se-dropdown-item__delete-link-wrapper" [ngClass]="{\'se-dropdown-item__delete-link-wrapper--disabled\': !isDeletePageEnabled}"><a class="se-dropdown-item se-dropdown-item__delete fd-menu__item" [ngClass]="{\'se-dropdown-item--disabled\': !isDeletePageEnabled}" (click)="isDeletePageEnabled && onClickOnDeletePage()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.trash"></span></a></div><se-tooltip *ngIf="!isDeletePageEnabled" class="se-dropdown-item__delete-page-popover" [placement]="\'left\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [isChevronVisible]="true" [appendTo]="\'body\'"><span se-tooltip-trigger class="sap-icon--message-error"></span><div se-tooltip-body class="popover-tooltip"><span [translate]="tooltipMessage"></span></div></se-tooltip></div></div>');e.put("EditPageItemComponent.html",'<div *seHasOperationPermission="editPagePermission"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnEdit()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.edit"></span></a></div>');e.put("PermanentlyDeletePageItemComponent.html",'<div *seHasOperationPermission="permanentlyDeletePagePermission"><div class="se-dropdown-item__delete-wrapper"><div class="se-dropdown-item__delete-link-wrapper" [ngClass]="{\'se-dropdown-item__delete-link-wrapper--disabled\': isDeleteButtonDisabled()}"><a class="se-dropdown-item se-dropdown-item__delete fd-menu__item" [ngClass]="{\'se-dropdown-item--disabled\': isDeleteButtonDisabled()}" (click)="permanentlyDelete()"><span [translate]="\'se.cms.actionitem.page.permanently.delete\'"></span></a></div><se-tooltip class="se-dropdown-item__delete-page-popover" *ngIf="isDeleteButtonDisabled()" [placement]="\'left\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [isChevronVisible]="true" [appendTo]="\'body\'"><span se-tooltip-trigger class="sap-icon--message-error"></span> <span se-tooltip-body [translate]="\'se.cms.actionitem.page.permanently.delete.blocked\'"></span></se-tooltip></div></div>');e.put("RestorePageItemComponent.html",'<div *seHasOperationPermission="restorePagePermission"><a class="se-dropdown-item fd-menu__item" (click)="restorePage()"><span [translate]="\'se.cms.actionitem.page.restore\'"></span></a></div>');e.put("SyncPageItemComponent.html",'<div *seHasOperationPermission="syncPagePermission"><a class="se-dropdown-item fd-menu__item" (click)="sync()" translate="se.cms.actionitem.page.sync"></a></div>');e.put("UpdatePageStatusComponent.html",'<div *ngIf="showButton"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnSync()"><span [translate]="\'se.cms.actionitem.page.sync\'"></span></a></div>');e.put("RestrictionManagementComponent.html",'<div *ngIf="isReady"><div *ngIf="isEditMode"><se-restriction-management-edit [restriction]="config?.restriction" [getSupportedRestrictionTypes]="config?.getSupportedRestrictionTypesFn" [uriContext]="uriContext" [(isDirtyFn)]="isDirtyInternal" [(submitFn)]="submitInternal"></se-restriction-management-edit></div><div *ngIf="!isEditMode"><se-restriction-management-select [existingRestrictions]="config?.existingRestrictions" [fetchRestrictionTypes]="config?.getRestrictionTypesFn" [getSupportedRestrictionTypes]="config?.getSupportedRestrictionTypesFn" [uriContext]="uriContext" [(isDirtyFn)]="isDirtyInternal" [(submitFn)]="submitInternal"></se-restriction-management-select></div></div>');e.put("RestrictionManagementEditComponent.html",'<div *ngIf="ready"><div *ngIf="isTypeSupported"><div class="se-restriction-management-edit__header"><div>{{ restriction.name }}</div><div>{{ restriction.typeCode }}</div></div><div><se-item-manager [item]="restriction" [mode]="itemManagementMode" [structureApi]="structureApi" [contentApi]="contentApi" [uriContext]="uriContext" [componentType]="restriction.itemtype" [(submitFunction)]="submitInternal" [(isDirty)]="isDirtyInternal"></se-item-manager></div></div><div *ngIf="!isTypeSupported"><div class="se-restrictions-list__item-content"><div translate="se.cms.restriction.management.select.type.not.supported.warning"></div><p class="se-restriction__item-name">{{ restriction.name }}</p><div class="se-restriction__item-description">{{ restriction.description }}</div></div></div></div>');e.put("RestrictionManagementSelectComponent.html",'<div><se-message [style.display]="showWarningMessage() ? \'block\' : \'none\'" [type]="\'warning\'"><span se-message-title translate="se.cms.restriction.management.select.type.not.supported.warning"></span></se-message><div class="se-restriction-management-select__select"><label class="se-control-label">{{ \'se.cms.restriction.management.select.type.label\' | translate }}</label><se-select id="restriction-type" [fetchStrategy]="fetchStrategy" [itemComponent]="itemComponent" [placeholder]="\'se.cms.restriction.management.select.type.placeholder\'" [(model)]="selectModel.selectedIds.restrictionType" (modelChange)="selectRestrictionType()" [searchEnabled]="false"></se-select></div><div *ngIf="viewConfig.showRestrictionSelector" class="se-restriction-management-select__restriction-info"><label class="se-control-label" translate="se.cms.restriction.management.select.restriction.label"></label><se-select id="restriction-name" [fetchStrategy]="fetchOptions" [(model)]="selectModel.selectedIds.restriction" (modelChange)="selectRestriction()" [placeholder]="\'se.cms.restriction.management.select.restriction.placeholder\'" [disableChoiceFn]="disableRestrictionChoice" [itemComponent]="itemComponent" [resultsHeaderLabel]="resultsHeaderLabel" [actionableSearchItem]="actionableSearchItem" [(reset)]="reset"></se-select></div><div class="se-restriction-management-select__restriction-editor" *ngIf="viewConfig.showRestrictionEditor"><p class="se-restriction-management-select__new-restriction-message" [translate]="editorHeader"></p><div *ngIf="selectModel.isTypeSupported()"><se-item-manager [item]="selectModel.getRestriction()" [mode]="viewConfig.mode" [structureApi]="viewConfig.structureApi" [contentApi]="viewConfig.contentApi" [uriContext]="uriContext" [componentType]="selectModel.getRestrictionTypeCode()" [(submitFunction)]="submitInternal" [(isDirty)]="isDirtyInternal"></se-item-manager></div><div *ngIf="!selectModel.isTypeSupported()"><p class="se-restriction__item-name">{{ selectModel.getRestriction().name }}</p><div class="se-restriction__item-description">{{ selectModel.getRestriction().description }}</div></div></div></div>');e.put("RestrictionsEditorComponent.html",'<div class="se-restrictions-container"><div class="se-restrictions-container__header" [ngClass]="{ \'se-restrictions-container__header--empty\': restrictions.length === 0 }"><label class="se-restrictions__sub-header" translate="se.cms.restrictions.list.title"></label><div class="se-restrictions-container__header--right"><div *ngIf="restrictions.length > 1"><div *ngIf="editable"><se-select id="criteria-type" [fetchStrategy]="criteriaFetchStrategy" [itemComponent]="itemComponent" [placeholder]="\'se.cms.restrictions.picker.type.placeholder\'" [model]="criteria.id" (modelChange)="matchCriteriaChanged($event)" [searchEnabled]="false"></se-select></div><div *ngIf="!editable">{{ \'se.cms.restrictions.criteria\' | translate }} {{ criteria.label | translate }}</div></div><button *ngIf="!showRestrictionPicker" type="button" class="se-restrictions__add-restriction-btn fd-button--cozy" [disabled]="!editable" (click)="onAddRestriction()"><span translate="se.cms.restrictions.editor.button.add.new"></span></button> <button class="cms-clean-btn se-restriction__clear-all__btn fd-button--light fd-button--compact" *ngIf="showRemoveAllButton()" (click)="removeAllRestrictions()" translate="se.cms.restrictions.list.clear.all"></button></div></div><se-slider-panel [sliderPanelConfiguration]="sliderPanelConfiguration" [(sliderPanelHide)]="sliderPanelHide" [(sliderPanelShow)]="sliderPanelShow" (isShownChange)="onSliderVisibilityChange($event)" class="se-add-restriction-panel"><se-restriction-management *ngIf="isSliderVisible" class="se-se-add-restriction-panel__restriction-management" [config]="restrictionManagement.config" [uriContext]="restrictionManagement.uriContext" [(submitFn)]="restrictionManagement.submitFn" [(isDirtyFn)]="restrictionManagement.isDirtyFn"></se-restriction-management></se-slider-panel><div *ngIf="errors.length > 0"><span class="se-help-block--has-error help-block fd-form__message fd-form__message--error" *ngFor="let error of errors" [translate]="error.message"></span></div><se-restrictions-table *ngIf="isRestrictionsReady" [editable]="editable" [restrictions]="restrictions" [restrictionCriteria]="criteria" [errors]="errors" [customClass]="\'ySERestrictionListLink\'" (onEdit)="onEditRestriction($event)" (onRemove)="onRemoveRestriction($event)"></se-restrictions-table></div>');e.put("RestrictionsTableComponent.html",'<div class="se-restriction-table-wrapper se-restriction-table-left" [ngClass]="customClass"><div class="se-restrictions-list fd-menu__list fd-menu__list--separated" *ngIf="restrictions.length > 0"><div id="restriction-{{ index + 1 }}" *ngFor="let restriction of restrictions; let index = index" class="se-restriction__item fd-menu__item"><div class="se-restrictions-list__item-content"><p class="se-restriction__item-name" [ngClass]="{ \'error-input\': isInError(index) }">{{ restriction.name }}</p><div class="se-restriction__item-type-and-id" [ngClass]="{ \'error-input\': isInError(index) }">{{ restriction.typeCode }}</div><div class="se-restriction__item-description" [ngClass]="{ \'error-input\': isInError(index) }" [title]="restriction.description">{{ restriction.description }}</div><div id="restrictionPartOfWorkflow" *ngIf="restriction.canBeEdited!==undefined && !restriction.canBeEdited" translate="se.cms.restrictions.editor.part.of.workflow"></div></div><div *ngIf="editable"><se-dropdown-menu [dropdownItems]="restriction.actions || defaultActions" [selectedItem]="restriction" [placement]="\'bottom-start\'"></se-dropdown-menu></div></div></div><div *ngIf="restrictions.length === 0" class="se-restrictions-list--empty"><span class="se-restrictions-list--empty__message" translate="se.cms.restrictions.emptylist.message"></span></div></div>');e.put("PageSyncMenuToolbarItemComponent.html",'<ng-container *seHasOperationPermission="\'se.sync.catalog\'"><fd-popover [(isOpen)]="toolbarItem.isOpen" [closeOnOutsideClick]="true"><fd-popover-control><button type="button" class="btn toolbar-action--button" [attr.aria-expanded]="toolbarItem.isOpen"><span class="icon-synchronize se-toolbar-menu-ddlb--button__icon"><span *ngIf="isNotInSync" class="hyicon hyicon-caution se-toolbar-menu-ddlb--button__caution"></span> </span><span class="toolbar-action-button__txt" [ngClass]="{\'se-toolbar-menu-ddlb--button__txt\': isNotInSync }" [translate]="toolbarItem.name"></span></button></fd-popover-control><fd-popover-body><div *ngIf="toolbarItem.isOpen && isReady" class="toolbar-action--include se-sync-menu-content__dropdown"><se-prevent-vertical-overflow><div class="se-sync-menu-content__header"><span class="se-sync-menu-content__header-title" translate="se.cms.synchronization.page.title"></span><se-help *ngIf="!syncPageConditions?.canSyncHomepage && !syncPageConditions?.pageHasNoDepOrNoSyncStatus" class="se-page-sync__y-help"><span>{{ helpText }}</span></se-help></div><se-page-synchronization-panel [cmsPage]="cmsPage" [uriContext]="uriContext"></se-page-synchronization-panel></se-prevent-vertical-overflow></div></fd-popover-body></fd-popover></ng-container>');e.put("PageSynchronizationHeaderComponent.html",'<ng-container *ngIf="ready"><div class="se-sync-panel-header"><span class="se-sync-panel-header__sub-header" [translate]="getSubHeaderText()"></span></div><div *ngIf="isNewPage()" class="se-sync-panel-new-page"><div class="se-sync-panel-new-page__header" translate="se.cms.synchronization.page.new.header"></div><div class="se-sync-panel-new-page__message">{{ headerText }}</div></div><div class="se-sync-panel-header__timestamp" *ngIf="!isNewPage()"><div translate="se.cms.synchronization.panel.lastsync.text"></div><span class="se-sync-panel-header__timestamp-text">{{ syncStatus.lastSyncStatus | date: \'M/d/yy h:mm a\' }}</span></div></ng-container>');e.put("PageSynchronizationPanelComponent.html",'<se-page-synchronization-header class="se-sync-panel__sync-status" [syncStatus]="syncStatus" [pageSyncConditions]="pageSyncConditions"></se-page-synchronization-header><se-synchronization-panel *ngIf="!showFooter" [itemId]="cmsPage.uuid" [showFooter]="false" [getSyncStatus]="getSyncStatus" [performSync]="performSync" (selectedItemsUpdate)="onSelectedItemsUpdate($event)" (syncStatusReady)="onSyncStatusReady($event)" (getApi)="onGetApi($event)"></se-synchronization-panel><se-synchronization-panel *ngIf="showFooter" [itemId]="cmsPage.uuid" [getSyncStatus]="getSyncStatus" [performSync]="performSync" (syncStatusReady)="onSyncStatusReady($event)" (getApi)="onGetApi($event)"></se-synchronization-panel>');e.put("SynchronizeCatalogComponent.html",'<div class="se-synchronize-catalog"><div class="se-synchronize-catalog__sync-info"><div *ngIf="isSyncJobFinished()"><label class="se-synchronize-catalog__sync-info__sync-label" *ngIf="catalogVersion.active"><span translate="se.cms.cataloginfo.lastsyncedfrom"></span>&nbsp; <span>{{ syncJobStatus.source }}</span></label> <label class="se-synchronize-catalog__sync-info__sync-label" *ngIf="!catalogVersion.active" translate="se.cms.cataloginfo.lastsynced"></label> <span class="se-synchronize-catalog__sync-info__last-synched">{{ syncJobStatus.syncEndTime | date: \'M/d/yy h:mm a\' }}</span></div><span class="se-synchronize-catalog__in-progress" *ngIf="isSyncJobInProgress()" translate="se.sync.status.synced.inprogress"></span> <span class="label-error se-synchronize-catalog__sync-failed" *ngIf="isSyncJobFailed()" translate="se.sync.status.synced.syncfailed"></span></div><ng-container *seHasOperationPermission="syncCatalogPermission"><ng-container *ngIf="!catalogVersion.active"><button class="se-synchronize-catalog__sync-btn fd-button--emphasized" [disabled]="!isSyncButtonEnabled()" (click)="syncCatalog()" translate="se.cms.cataloginfo.btn.sync"></button></ng-container></ng-container></div>');e.put("VersionItemContextComponent.html",'<div class="se-version-item-context"><span class="sap-icon--navigation-right-arrow"></span><se-tooltip *ngIf="(pageVersion$ | async) as pageVersion" [triggers]="[\'mouseenter\', \'mouseleave\']" [placement]="\'bottom\'" [isChevronVisible]="true"><div se-tooltip-trigger class="se-version-item-context__info"><div class="se-version-item-context__info-label" [title]="pageVersion.label">{{ pageVersion.label }}</div><div class="se-version-item-context__info-date">{{ pageVersion.creationtime | date: \'M/d/yy h:mm a\' }}</div></div><div se-tooltip-body class="se-version-item-context__description-wrapper"><span class="se-version-item-context__description">{{ pageVersion.description || (EMPTY_DESCRIPTION_MSG_KEY | translate) }}</span></div></se-tooltip><button type="button" (click)="deselectPageVersion()" class="se-version-item-context__remove-btn fd-button--light sap-icon--decline"></button></div>');e.put("VersionsPanelComponent.html",'<div class="se-toolbar-menu-content--wrapper"><div class="se-toolbar-menu-content__header"><div class="se-toolbar-menu-content__header-title" translate="se.cms.actionitem.page.versions"></div><button class="se-versions-panel__manage-btn fd-button fd-button--compact" *ngIf="showManageButton" (click)="switchToVersioningMode()" translate="se.cms.toolbaritem.versioning.manageversions.name"></button></div><div class="se-versions-toolbar-menu-content__body" [ngClass]="{ \'se-versions-toolbar-menu-content__body--narrow\': showManageButton }"><se-versions-search [versionsFoundCount]="versionsFound" [showSearchControls]="pageHasVersions()" (searchTermChange)="onSearchTermChanged($event)"></se-versions-search><div><se-infinite-scrolling class="se-versions-panel__infinite-scroll" *ngIf="pageHasVersionsOrIsLoading()" [pageSize]="10" [mask]="searchTerm" [fetchPage]="fetchPageOfVersions" (itemsChange)="onVersionItemsLoaded($event)"><div *ngFor="let item of versionItems; let isLast = last"><se-version-item [ngClass]="{ \'se-version-item--last\': isLast }" [pageVersion]="item"></se-version-item></div></se-infinite-scrolling><div class="se-versions-panel__empty-list" *ngIf="!pageHasVersionsOrIsLoading()"><img src="static-resources/images/emptyVersions.svg" alt="no versions"/> <span class="se-versions-panel__no-versions-message" translate="se.cms.toolbaritem.versioning.noversionsfound"></span> <a class="se-versions-panel__manage-link fd-link" *ngIf="showManageLink" (click)="switchToVersioningMode()" translate="se.cms.toolbaritem.versioning.manageversionslink.name"></a></div></div></div></div>');e.put("PageApprovalSelectorComponent.html",'<fd-popover *ngIf="showDropdown" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="\'bottom-end\'"><fd-popover-control><button (click)="onClickDropdown()" class="se-page-approval-selector__toggle-btn fd-button--light sap-icon--navigation-down-arrow"></button></fd-popover-control><fd-popover-body><div *ngIf="showApprovalInfo" class="se-page-approval-info">{{ approvalInfo }}</div><fd-menu *ngIf="!showApprovalInfo"><ul fd-menu-list class="se-dropdown-menu__list se-page-approval-selector-list"><se-dropdown-menu-item *ngFor="let dropdownItem of pageApprovalOptions$ | async" [dropdownItem]="dropdownItem"></se-dropdown-menu-item></ul></fd-menu></fd-popover-body></fd-popover>');e.put("PageDisplayStatusComponent.html",'<ng-container *ngIf="showLastSyncTime; else pageStatus"><se-tooltip [triggers]="[\'click\']" [placement]="\'left\'" [isChevronVisible]="true"><ng-container se-tooltip-trigger *ngTemplateOutlet="pageStatus"></ng-container><div se-tooltip-body class="popover-tooltip"><ng-container *ngIf="hasBeenSynchedBefore(); else notPublished"><span [translate]="\'se.cms.page.displaystatus.lastpublished.date\'"></span> <span>&ngsp;{{ lastSynchedDate | date: \'M/d/yy h:mm a\' }}</span></ng-container><ng-template #notPublished><span [translate]="\'se.cms.page.displaystatus.not.published\'"></span></ng-template></div></se-tooltip></ng-container><ng-template #pageStatus><se-page-status [uuid]="page?.uuid" [displayStatus]="page?.displayStatus"></se-page-status></ng-template>');e.put("PageInWorkflowNotificationComponent.html",'<div><span translate="se.cms.workflow.page.in.workflow"></span></div>');e.put("PageWorkflowMenuComponent.html",'<div *ngIf="isReady"><div *ngIf="!pageHasWorkflow && isWorkflowEnabled"><ng-container *seHasOperationPermission="\'se.start.page.workflow\'"><button id="smartEditPerspectiveToolbar_option_se.cms.startWorkflow_btn" class="btn toolbar-action--button" type="button" (click)="startWorkflow()" aria-expanded="false"><span id="smartEditPerspectiveToolbar_option_se.cms.startWorkflow_btn_lbl" class="toolbar-action-button__txt" translate="se.cms.workflow.toolbar.start.workflow"></span></button></ng-container></div><div *seHasOperationPermission="\'se.view.page.workflowMenu\'"><fd-popover *ngIf="pageHasWorkflow" class="toolbar-action" [closeOnOutsideClick]="true" [isOpen]="actionItem.isOpen" (isOpenChange)="onDropdownToggle($event)"><fd-popover-control><button type="button" class="page-tasks-btn toolbar-action--button" [attr.aria-expanded]="actionItem.isOpen"><span class="page-tasks-btn__icon sap-icon--workflow-tasks"></span> <span class="page-tasks-btn__label" translate="se.cms.workflow.toolbar.view.workflow.menu"></span></button></fd-popover-control><fd-popover-body><div *ngIf="actionItem.isOpen" class="toolbar-action--include se-page-workflow-menu"><div class="se-page-workflow-menu__header"><div class="se-page-workflow-menu__header-text" translate="se.cms.workflow.toolbar.view.workflow.menu"></div><div class="se-page-workflow-menu__header-menu"><se-workflow-item-menu [workflowInfo]="workflow"></se-workflow-item-menu></div></div><div class="se-version-toolbar-menu-content__body"><div class="se-page-workflow-menu-tabs"><se-tabs *ngIf="areTabsReady; else spinner" [tabsList]="tabsList" [model]="tabsData" [numTabsDisplayed]="2"></se-tabs><ng-template #spinner><se-spinner [isSpinning]="true"></se-spinner></ng-template></div></div></div></fd-popover-body></fd-popover></div></div>');e.put("WorkflowInboxComponent.html",'<fd-popover class="toolbar-action se-workflow-inbox-container dropdown" [class.open]="actionItem.isOpen" [(isOpen)]="actionItem.isOpen" (isOpenChange)="onDropdownToggle(isOpen)" [closeOnOutsideClick]="true" [triggers]="[\'click\']" [placement]="\'bottom-\' + actionItem.dropdownPosition"><fd-popover-control class="se-workflow-inbox-toggle-control"><button type="button" class="se-workflow-inbox-toggle toolbar-action--button--compact" [attr.aria-pressed]="actionItem.isOpen"><span class="se-toolbar-actions__icon sap-icon--task"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]="{                \'se-toolbar__dropdown--right\': actionItem.dropdownPosition === \'right\',                \'se-toolbar__dropdown--center\': actionItem.dropdownPosition === \'center\',                \'se-toolbar__dropdown--left\': actionItem.dropdownPosition === \'left\'            }" class="toolbar-action--include--compact"><div *ngIf="actionItem.isOpen" class="se-workflow-inbox"><div class="se-workflow-inbox"><div class="se-workflow-inbox-header"><div class="se-workflow-inbox-header__title" [translate]="\'se.cms.workflow.toolbar.inbox\'"></div></div><div class="se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body"><div *ngIf="!tasksNotReady && totalNumberOfTasks === 0" class="se-workflow-inbox-tasks__no-tasks"><img src="static-resources/images/Inbox.svg" alt="empty-inbox"/> <span class="se-workflow-inbox__empty-inbox-message" [translate]="\'se.cms.workflow.toolbar.inbox.emptyinbox.message\'"></span> <span class="se-workflow-inbox__empty-inbox-message-alt" [translate]="\'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt\'"></span></div><se-infinite-scrolling class="se-version-panel__infinite-scroll se-infinite-scrolling--narrowed" [pageSize]="pageSize" [fetchPage]="fetchPageOfInboxTasks" (itemsChange)="onInboxTasksLoaded($event)"><div *ngFor="let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex" class="se-workflow-inbox-task se-cms-dev-workflow-inbox-task"><se-workflow-inbox-task id="workflow-inbox-task-{{i}}" [class.se-workflow-inbox-task-last]="last" [task]="task"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>');e.put("WorkflowInboxBadgeComponent.html",'<ng-container *ngIf="inboxCount$ | async as count"><div *ngIf="count > 0" aria-label="Notifications"><div class="fd-counter fd-counter--notification se-inbox-badge" aria-label="Unread count">{{ stringifyCount(count) }}</div></div></ng-container>');e.put("WorkflowInboxMultipleTasksAnnouncementComponent.html",'<div (click)="onClick($event)" class="se-announcement__message--multi">{{ \'se.cms.workflow.tasks.announcement\' | translate: count }}</div>');e.put("WorkflowInboxSingleTaskAnnouncementComponent.html",'<div (click)="onClick($event)"><div class="se-announcement__title">{{ task.action.name | seL10n | async }}</div><div class="se-announcement__message">{{ task.attachments[0].catalogName | seL10n | async }} | {{ task.attachments[0].pageName }}</div><div class="se-announcement__time-stamp">{{ startedAgo }}</div></div>');e.put("WorkflowInboxTaskComponent.html",'<div class="se-workflow-inbox-task-header"><a href="#" (click)="onClick($event)">{{ taskName | async }}</a></div><div class="se-workflow-inbox-task-desc">{{ taskDescription | async }}</div><div class="se-workflow-inbox-task-body">{{ getTaskCreatedAgo() }}</div>');e.put("WorkflowItemMenuComponent.html",'<se-popup-overlay class="popup-anchor" [ngClass]="{ \'popup-anchor--open\': isMenuOpen }" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><span *ngIf="menuItems.length > 0" (click)="toggleMenu()" class="workflow-item-menu__toggle-btn sap-icon--overflow"></span><div se-popup-overlay-body><div class="workflow-item-menu"><div class="workflow-item-menu__item" *ngFor="let dropdownItem of menuItems"><ng-container class="container" [ngSwitch]="dropdownItem.i18nKey"><div *ngSwitchCase="\'se.cms.actionitem.page.workflow.description\'" class="workflow-description"><div class="se-dropdown-item--label"><div class="workflow-description__label fd-has-type-1 fd-has-margin-bottom-tiny"><div [translate]="dropdownItem.i18nKey"></div><div *seHasOperationPermission="\'se.edit.workflow.workflowMenu\'"><a title="Edit" class="workflow-description__edit-btn sap-icon--edit fd-has-float-right" (click)="editDescription()"></a></div></div><div *ngIf="workflowInfo.description; else noDescription" class="workflow-description__text">{{ workflowInfo.description }}</div><ng-template #noDescription><div translate="se.cms.actionitem.page.workflow.no.description"></div></ng-template></div></div><div *ngSwitchCase="\'se.cms.actionitem.page.workflow.cancel\'" class="workflow-cancel-btn fd-has-color-status-3" [translate]="dropdownItem.i18nKey" (click)="cancelWorkflow()"></div></ng-container></div></div></div></se-popup-overlay>');e.put("SubTypeSelectorComponent.html",'<ul class="se-sub-type__selector fd-menu__list"><li class="cms-sub-type__selector-link fd-menu__item" *ngFor="let subType of subTypes" (click)="select(subType)" [translate]="subType.label"></li></ul>');e.put("PageRestrictionsEditorComponent.html",'<se-page-restrictions-info-message *ngIf="page.restrictions?.length > 1"></se-page-restrictions-info-message><se-restrictions-editor [editable]="isEditable" [getRestrictionTypes]="getRestrictionTypes" [getSupportedRestrictionTypes]="getSupportedRestrictionTypes" [item]="page" [restrictionUuids]="page.restrictions" [removeValidationMessages]="onRemoveValidationMessages" (onRestrictionsChange)="onRestrictionsChange($event)"></se-restrictions-editor>');e.put("PageRestrictionsInfoMessageComponent.html","<se-message [type]=\"'info'\" class=\"se-restrictions-info__message\"><ng-container se-message-title>{{ 'se.cms.restrictions.editor.ymessage.title' | translate }}</ng-container><ng-container se-message-description>{{ 'se.cms.restrictions.editor.ymessage.description' | translate }}</ng-container></se-message>");e.put("CatalogAwareSelectorComponent.html",'<div *ngIf="selectedItemListIsEmpty()"><button type="button" id="catalog-aware-selector-add-item" class="fd-button fd-button--compact se-catalog-aware-selector__add-item-btn" *ngIf="editable" (click)="openItemSelectorPanel()"><span translate="se.cms.catalogaware.newbutton.title" [translateParams]="{ catalogItemType: catalogItemTypeI18nKey | translate }" class="se-catalog-aware-selector__add-item-btn-text"></span></button></div><div *ngIf="!selectedItemListIsEmpty()" class="se-catalog-aware-selector__content"><div class="se-catalog-aware-selector__add-more-btn-wrapper" *ngIf="editable"><button type="button" class="fd-button--light" translate="se.cms.catalogaware.list.addmore" (click)="openItemSelectorPanel()"></button></div><se-editable-list [id]="editableListId" [itemComponent]="nodeComponent" [(items)]="itemList" [onChange]="onListChange" [editable]="editable" [(refresh)]="refreshItemListWidget" class="se-catalog-aware-selector__list"></se-editable-list></div><se-item-selector-panel [itemComponent]="itemComponent" [getCatalogs]="getCatalogs" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="catalogItemTypeI18nKey" (onSaveChanges)="onItemSelectorPanelSaveChanges($event)"></se-item-selector-panel>');e.put("ItemSelectorPanelComponent.html",'<se-slider-panel [sliderPanelConfiguration]="panelConfig" [(sliderPanelHide)]="hidePanel" [(sliderPanelShow)]="showPanel" class="se-item-selector-panel"><div *ngIf="catalogs.length > 0"><div *ngIf="catalogs.length > 1" class="se-item-selector-panel__selector"><label class="se-control-label" translate="se.cms.catalogaware.panel.catalogs.label"></label><se-select id="se-catalog-selector-dropdown" [(model)]="catalogInfo.catalogId" [fetchStrategy]="catalogSelectorFetchStrategy" [onChange]="onCatalogSelectorChange"></se-select><label>{{ catalogInfo.name | seL10n | async }}</label></div><div class="se-item-selector-panel__selector"><label class="se-control-label" translate="se.cms.catalogaware.panel.catalogsversion.label"></label><se-select id="se-catalog-version-selector-dropdown" [(model)]="catalogInfo.catalogVersion" [fetchStrategy]="catalogVersionSelectorFetchStrategy" [onChange]="onCatalogVersionSelectorChange" [searchEnabled]="false" [(reset)]="resetCatalogVersionSelector"></se-select></div><div class="se-item-selector-panel__selector" *ngIf="catalogInfo.catalogVersion"><label class="se-control-label" [translate]="catalogItemTypeI18nKey"></label><se-select id="se-items-selector-dropdown" [multiSelect]="true" [controls]="true" [(model)]="internalItemsSelected" [onChange]="onItemsSelectorChange" [fetchStrategy]="itemsSelectorFetchStrategy" [(reset)]="resetItemsListSelector" [itemComponent]="itemComponent" [isReadOnly]="!isItemSelectorEnabled()"></se-select></div></div></se-slider-panel>');e.put("MultiCategorySelectorComponent.html",'<se-catalog-aware-selector [id]="id" [selectedItemIds]="selectedItemIds" (selectedItemIdsChange)="onSelectedItemIdsChange($event)" [getCatalogs]="getCatalogs" [itemComponent]="categorySelectorItemComponent" [nodeComponent]="categoryNodeComponent" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="\'se.cms.catalogaware.catalogitemtype.category\'" [editable]="editable"></se-catalog-aware-selector>');e.put("MultiProductSelectorComponent.html",'<se-catalog-aware-selector [id]="id" [selectedItemIds]="selectedItemIds" (selectedItemIdsChange)="onSelectedItemIdsChange($event)" [getCatalogs]="getCatalogs" [itemComponent]="productSelectorItemComponent" [nodeComponent]="productNodeComponent" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="\'se.cms.catalogaware.catalogitemtype.product\'" [editable]="editable"></se-catalog-aware-selector>');e.put("MediaComponent.html",'<div class="se-media"><se-media-selector *ngIf="!image" [id]="mediaSelectorId" [isDisabled]="isFieldDisabled" [mediaId]="mediaIdByLang[lang]" [mimeType]="field.allowMediaType" (mediaIdChange)="onMediaIdChange($event)"></se-media-selector><se-media-file-selector *ngIf="canShowFileSelector()" [labelI18nKey]="\'se.upload.image.to.library\'" [acceptedFileTypes]="acceptedFileTypes" [selectionMode]="\'upload\'" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelect($event)"></se-media-file-selector><se-media-upload-form *ngIf="image" class="se-media-upload-form-wrapper" [image]="image" [allowMediaType]="field.allowMediaType" [maxUploadFileSize]="maxUploadFileSize" (onCancel)="resetImage()" (onSelect)="onFileSelect($event)" (onUploadSuccess)="onMediaUploaded($event)"></se-media-upload-form><se-message *ngIf="previewMessage" [type]="\'warning\'"><ng-container se-message-description>{{ \'se.upload.video.cant.preview\' | translate }}</ng-container></se-message><se-media-errors *ngIf="fileErrors.length > 0" [errors]="fileErrors" [maxUploadFileSize]="maxUploadFileSize"></se-media-errors></div>');e.put("MediaActionLabelComponent.html",'<span class="se-media-action-label" [ngClass]="{ \'se-media-action-label--disabled\': state === \'disabled\' }" [translate]="i18nKey"></span>');e.put("MediaAdvancedPropertiesComponent.html",'<se-tooltip [appendTo]="\'body\'" [placement]="\'bottom\'" [isChevronVisible]="true" [triggers]="[\'click\']" class="se-media-advanced-info"><span se-tooltip-trigger class="se-media-advanced-info__trigger"><span class="sap-icon--message-information se-media__action-icon se-media__action-icon--basic" [title]="i18nKeys.INFORMATION | translate"></span><se-media-action-label [i18nKey]="i18nKeys.INFORMATION"></se-media-action-label></span><div se-tooltip-body><div class="se-media-advanced-info-body"><div class="se-media-advanced-info-row advanced-information-description" *ngIf="description"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.DESCRIPTION"></div><div class="se-media-advanced-info-row__description">{{ description }}</div></div><div class="se-media-advanced-info-row advanced-information-code"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.CODE"></div><div class="se-media-advanced-info-row__description">{{ code }}</div></div><div class="se-media-advanced-info-row advanced-information-alt-text" *ngIf="altText"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.ALT_TEXT"></div><div class="se-media-advanced-info-row__description">{{ altText }}</div></div></div></div></se-tooltip>');e.put("MediaContainerComponent.html",'<div *ngIf="hasReadPermissionOnMediaRelatedTypes && advancedMediaContainerManagementEnabled"><se-media-container-selector [eventNameAffix]="selectorEventNameAffix" [isAdvancedCloning]="isAdvancedCloning()" [initialName]="initialMediaContainerName" [name]="getMediaContainerName()" [isEditable]="field.editable" (nameChange)="onMediaContainerNameChange($event)" (onCreate)="onMediaContainerCreate($event)" (onRemove)="onMediaContainerRemove()" (onSelect)="setMediaContainer($event)" (onCreationInProgressChange)="onMediaContainerCreationInProgressChange($event)"></se-media-container-selector></div><div class="se-media-container-field" *ngIf="canShowMediaFormatWithUploadForm()"><div class="se-media-container-field__media-list"><se-media-format class="se-media-container-cell" *ngFor="let format of field.options" [ngClass]="getMediaContainerCellClassName(format.id)" [errorMessages]="field.messages" [isEditable]="field.editable" [isUnderEdit]="isMediaFormatUnderEdit(format.id)" [isFieldDisabled]="isFieldDisabled()" [mediaUuid]="model[lang]?.medias[format.id]" [mediaFormat]="format.id" [mediaLabel]="format.label" [allowMediaType]="field.allowMediaType" (onFileSelect)="onFileSelect($event, format.id)" (onDelete)="removeMediaByFormat(format.id)"></se-media-format></div><se-media-upload-form *ngIf="image" class="se-media-upload-form-wrapper se-media-upload-form-wrapper--spaced" [image]="image.file" [allowMediaType]="field.allowMediaType" [maxUploadFileSize]="maxUploadFileSize" (onCancel)="resetImage()" (onSelect)="onFileSelect($event)" (onUploadSuccess)="onFileUploadSuccess($event, image.format)"></se-media-upload-form><se-media-errors [errors]="fileValidationErrors" [maxUploadFileSize]="maxUploadFileSize"></se-media-errors></div><div *ngIf="!hasReadPermissionOnMediaRelatedTypes"><span translate="se.cms.media.typepermissions.error" [translateParams]="{ containedTypes: field.containedTypes }"></span></div>');e.put("MediaErrorsComponent.html",'<div class="se-media-error field-errors"><div *ngFor="let error of errors">{{ error.message | translate: { sizeLimitationOfFile: maxUploadFileSize } }}</div></div>');e.put("MediaFileSelectorComponent.html",'<div class="se-file-selector" [ngClass]="customClass"><label *ngIf="!disabled" class="se-button se-button--text" [ngClass]="{ \'se-button--disabled\': disabled,                     \'se-file-selector__custombtn\': customComponent,                      \'se-file-selector__btn\': !customComponent }"><ng-container *ngIf="customComponent"><ng-container *ngComponentOutlet="customComponent.component; injector: customComponent.injector"></ng-container></ng-container><span class="sap-icon--share se-media__action-icon" [ngClass]="{        \'sap-icon--share\': isReplaceMode(),        \'sap-icon--upload\': !isReplaceMode()    }"></span> <span class="se-file-selector__label">{{ labelI18nKey | translate }}</span><ng-container *ngIf="!customComponent"><input type="file" class="hide se-file-selector__input" [accept]="buildAcceptedFileTypesList()" (change)="onSelect($event.target.files)"/></ng-container></label></div>');e.put("MediaFormatComponent.html",'<div class="se-media-format" [ngClass]="mediaFormat"><div *ngIf="mediaLabel" class="se-media-format__screen-type" [translate]="mediaFormatI18nKey"></div><se-media-format-uploaded *ngIf="isMediaPreviewEnabled()" [media]="media" [replaceLabelI18nKey]="mediaSelectorI18nKeys.REPLACE" [acceptedFileTypes]="acceptedFileTypes" [isFieldDisabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)" (onDelete)="onRemoveButtonClick()"></se-media-format-uploaded><div class="se-media--absent" *ngIf="isMediaAbsent()"><se-media-file-selector *ngIf="isEditable" [selectionMode]="\'upload\'" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="isFieldDisabled ? \'file-selector-disabled\' : \'\'" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><se-media-file-selector *ngIf="!isEditable" [selectionMode]="\'upload\'" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="!isEditable ? \'file-selector-disabled\' : \'\'" [disabled]="!isEditable" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector></div><div *ngIf="isUnderEdit" class="se-media--edit-wrapper"><se-media-file-selector class="se-media--edit" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="\'file-selector-disabled\'" [disabled]="true" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><span class="se-media-preview--edit" [translate]="mediaSelectorI18nKeys.UNDER_EDIT"></span></div><ng-container *ngIf="!isUnderEdit"><div class="error-input se-media-format__error" *ngFor="let error of getErrors()"><span>{{ error }}</span></div></ng-container></div>');e.put("MediaPreviewComponent.html",'<se-tooltip [appendTo]="\'body\'" [placement]="\'bottom\'" [isChevronVisible]="true" [triggers]="[\'click\']"><span se-tooltip-trigger><div class="sap-icon--search se-media-preview__icon"></div></span><div se-tooltip-body><img class="se-media-preview__image" [src]="imageUrl"/></div></se-tooltip>');e.put("MediaRemoveButtonComponent.html",'<button type="button" class="se-media-action-btn se-media-remove-btn" [disabled]="isDisabled" (click)="clickHandler.emit($event)"><span class="se-media__action-icon se-media__action-icon--delete sap-icon--delete"></span> <span class="se-media-remove-btn-txt" [ngClass]="{ \'se-media-remove-btn-txt--disabled\': isDisabled }" translate="se.media.format.remove"></span></button>');e.put("MediaSelectorComponent.html",'<div class="media-selector"><se-select [id]="id" [(model)]="mediaId" (modelChange)="onMediaIdChange($event)" [fetchStrategy]="fetchStrategy" [isReadOnly]="isDisabled" [itemComponent]="mediaPrinterComponent"></se-select></div>');e.put("MediaUploadFormComponent.html",'<div class="se-media-upload-form"><div class="se-media-upload-form__header"><div class="se-media-upload-form__header-content"><div class="se-media-upload-form__header-title" translate="se.upload.image.to.folder"></div><se-select id="se-media-upload-form__header-folder" class="se-media-upload-form__header-folder" [ngClass]="{ \'is-invalid\': hasError() }" [multiSelect]="false" [controls]="false" [(model)]="folderSelected" (modelChange)="folderSelectedChanged($event)" [fetchStrategy]="folderFetchStrategy" [placeholder]="folderSelected"></se-select><div class="se-media-upload-form__header-actions"><button type="button" class="fd-button--light se-media-upload-btn__cancel fd-button--compact" translate="se.upload.image.cancel" (click)="cancel()"></button> <button type="button" class="fd-button se-media-upload-btn__submit fd-button--compact" translate="se.upload.image.submit" (click)="uploadMedia()"></button></div></div><div class="se-media-upload-form__header-error"><span class="upload-field-error fd-form__message fd-form__message--error" *ngFor="let error of folderErrors">{{ error | translate }}</span></div></div><div class="se-media-upload-form__replace-file"><div class="se-media-upload-form__file-name">{{ image.name }}</div><se-media-file-selector [labelI18nKey]="\'se.upload.image.replace\'" [acceptedFileTypes]="acceptedFileTypes" (onFileSelect)="onFileSelect($event)"></se-media-file-selector></div><form class="se-media-upload-form__file-info"><se-media-upload-field [fieldName]="\'code\'" [fieldValue]="imageParams?.code" [fieldErrors]="getErrorsForFieldByCode(\'code\')" [isRequired]="true" [labelI18nKey]="\'se.uploaded.image.code\'" (fieldValueChange)="onChangeFieldValue($event, \'code\')"></se-media-upload-field><se-media-upload-field [fieldName]="\'description\'" [fieldValue]="imageParams?.description" [fieldErrors]="getErrorsForFieldByCode(\'description\')" [isRequired]="true" [labelI18nKey]="\'se.uploaded.image.description\'" (fieldValueChange)="onChangeFieldValue($event, \'description\')"></se-media-upload-field><se-media-upload-field [fieldName]="\'alt-text\'" [fieldValue]="imageParams?.altText" [fieldErrors]="getErrorsForFieldByCode(\'altText\')" [isRequired]="true" [labelI18nKey]="\'se.uploaded.image.alt.text\'" (fieldValueChange)="onChangeFieldValue($event, \'altText\')"></se-media-upload-field></form><se-spinner [isSpinning]="isUploading"></se-spinner></div>');e.put("BreadcrumbComponent.html",'<div class="se-breadcrumb"><div *ngFor="let node of breadcrumb; index as idx; last as isLast" class="se-breadcrumb__node"><div class="se-breadcrumb__info" [ngClass]="{\'se-breadcrumb__info--last\': isLast}"><span class="se-breadcrumb__info--level">{{ node.formattedLevel | translate: node }}</span> <span class="se-breadcrumb__info--name">{{ node.name }}</span></div><div class="se-breadcrumb__divider" *ngIf="idx < breadcrumb.length - 1"><span class="sap-icon--navigation-right-arrow"></span></div></div></div>');e.put("NavigationNodePickerComponent.html",'<div class="categoryTable"><div class="tablehead clearfix hidden-xs se-navigation-editor-tree__head"><div translate="se.ytree.template.header.name" class="se-navigation-editor-tree__name col-md-offset-1 col-sm-5"></div></div><se-tree [nodeUri]="nodeURI" [rootNodeUid]="rootNodeUid" [nodeComponent]="nodePickerRenderComponent" [removeDefaultTemplate]="removeDefaultTemplate" [nodeActions]="actions"></se-tree></div>');e.put("NavigationNodePickerRenderComponent.html",'<div class="se-tree-node__name col-xs-6" [title]="node.name | seL10n | async"><span>{{ node.name | seL10n | async }}</span></div><div class="col-sm-4 pull-right tree-node se-navigation-picker-renderer" (click)="pick(node)" *ngIf="isEditable()"><a translate="se.cms.navigationcomponent.management.node.selection.select.action" class="btn btn-link se-navigation-picker-renderer__btn"></a></div>');e.put("NavigationNodeSelectorComponent.html",'<div *ngIf="isReady"><div *ngIf="cmsItem[qualifier]" class="se-navigation-mode"><div class="se-navigation__node"><se-breadcrumb class="se-navigation__node-breadcrumb" [nodeUuid]="cmsItem[qualifier]" [uriContext]="uriContext"></se-breadcrumb><div class="se-navigation__node-button"><button class="btn btn-link btn-block se-navigation__button" (click)="remove($event)" [disabled]="!field.editable" translate="se.cms.navigationcomponent.management.node.selection.remove.action"></button></div></div><se-navigation-editor-tree [uriContext]="uriContext" [readOnly]="true" [rootNodeUid]="nodeUid"></se-navigation-editor-tree></div><div *ngIf="!cmsItem[qualifier]"><label translate="se.cms.navigationcomponent.management.node.selection.invite.action"></label><se-navigation-node-picker [uriContext]="uriContext" [editable]="field.editable"></se-navigation-node-picker></div></div>');e.put("NewPageDisplayConditionComponent.html",'<div *ngIf="isReady"><div class="form-group"><label for="page-condition-selector-id" class="se-control-label" translate="se.cms.page.condition.selection.label"></label><se-select id="page-condition-selector-id" [model]="conditionSelected.label" (modelChange)="onConditionChange($event)" [fetchStrategy]="conditionSelectorFetchStrategy" [onChange]="onDataChange" [searchEnabled]="false"></se-select><span class="se-form-help-message"><span [translate]="conditionSelected.description"></span></span></div><div *ngIf="showPrimarySelector()" class="form-group"><label for="page-condition-primary-selector-id" class="se-control-label" translate="se.cms.page.condition.primary.association.label"></label><se-select id="page-condition-primary-selector-id" [model]="primarySelectedModel" (modelChange)="primarySelectedModelOnChange($event)" [fetchStrategy]="primaryPageChoicesFetchStrategy" [onChange]="onDataChange"></se-select><span *ngIf="primarySelected?.label" class="se-form-help-message"><span>{{ \'se.cms.page.label.label\' | translate }}: {{ primarySelected.label }}</span></span></div><div *ngIf="showHomePageWidget()"><div class="fd-form__item"><input type="checkbox" id="set-homepage-checkbox" class="se-component-item--details se-component-homepage__checkbox-input fd-form__control" name="clone-on-drop" (ngModelChange)="onHomePageChange($event)" [ngModel]="homepage"/> <label class="se-control-label se-component-homepage--label fd-form__label" for="set-homepage-checkbox" translate="se.cms.display.conditions.homepage.set"></label></div><label class="se-control-label se-component-homepage--label" for="set-homepage-checkbox" *ngIf="showReplaceLabel">{{ "se.cms.display.conditions.homepage.replace" | translate: { currentHomepage: currentHomePageName } }}</label></div></div>');e.put("SelectPageTemplateComponent.html",'<div class="se-page-type-step-template"><div class="se-add-page__sub-header"><div class="se-add-page__sub-header-title">{{ \'se.cms.addpagewizard.pagetemplate.description\' | translate }}</div><div class="se-input-group se-page-type-step-template-list-search"><input type="text" class="se-input-group__input-area ySEPage-list-search-input" placeholder="{{ \'se.cms.pagewizard.templatestep.searchplaceholder\' | translate }}" [ngModel]="searchString" (ngModelChange)="onSearchChange($event)" name="query"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="searchString" class="se-input-group__addon se-input-group__clear-btn" (click)="clearSearch()"><span class="sap-icon--decline"></span></div></div></div><div class="se-add-page__list fd-menu" *ngIf="pageTemplates.length > 0"><div *ngFor="let template of filteredPageTemplates" [ngClass]="{ \'is-selected\': isSelected(template)}" (click)="templateSelected(template)" class="se-add-page__item se-add-page__item--page-template fd-menu__item"><div class="se-add-page__item-title">{{ template.name }}</div></div></div></div>');e.put("SelectPageTypeComponent.html",'<div><div class="se-add-page__sub-header">{{ \'se.cms.addpagewizard.pagetype.description\' | translate }}</div><div class="se-add-page__list fd-menu" *ngIf="pageTypes.length > 0"><div class="se-add-page__item fd-menu__item" *ngFor="let pageType of pageTypes" [ngClass]="{ \'is-selected\': isSelected(pageType)}" (click)="selectType(pageType)"><div class="se-add-page__item-title">{{ pageType.name | seL10n | async }}</div><div class="se-add-page__item-description">{{ pageType.description | seL10n | async }}</div></div></div></div>');e.put("SelectTargetCatalogVersionComponent.html",'<div class="target-catalog-version-selector-wrapper form-group"><label for="se-catalog-version-selector-dropdown" class="se-control-label" translate="se.cms.clonepagewizard.options.targetcatalogversion.label"></label><se-select *ngIf="!!catalogVersions.length" id="se-catalog-version-selector-dropdown" [(model)]="selectedCatalogVersion" [fetchStrategy]="catalogVersionSelectorFetchStrategy" [onChange]="onSelectionChange" [searchEnabled]="false" (getApi)="setSelectApi($event)"></se-select><div *ngIf="catalogVersionContainsPageWithSameLabel"><span class="help-block" translate="se.cms.clonepagewizard.options.targetcatalogversion.label.exists.message"></span></div></div>');e.put("ComponentCloneInfoComponent.html",'<se-message *ngIf="catalogVersionContainsPageWithSameTypeCode" type="warning"><span se-message-description translate="se.cms.clonepagewizard.pageinfo.targetcatalogversion.pagetype.exists.message" [translateParams]="{ typeCode: pageTypeCode }"></span></se-message><se-generic-editor [id]="genericEditorId" [structure]="structure" [content]="content" [(submit)]="submitInternal" [(reset)]="resetInternal" [(isDirty)]="isDirtyInternal" [(isValid)]="isValidInternal" (getApi)="setGenericEditorApi($event)"></se-generic-editor>');e.put("ComponentCloneOptionFormComponent.html",'<label for="components-cloned-selector-id" class="se-control-label"><span translate="se.cms.clonepagewizard.options.title"></span><se-help><span translate="se.cms.clonepagewizard.options.tooltip"></span></se-help></label><div id="components-cloned-selector-id"><div class="se-form-control-row"><input class="components-cloned-option-id fd-form__control" type="radio" name="componentsclone" id="reference-cloning" [(ngModel)]="componentInSlotOption" (click)="updateComponentInSlotOption(CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING)" [value]="CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING"/> <label for="reference-cloning" translate="se.cms.clonepagewizard.options.existing"></label></div><div class="se-form-control-row"><input class="components-cloned-option-id fd-form__control" type="radio" id="deep-cloning" name="componentsclone" [(ngModel)]="componentInSlotOption" (click)="updateComponentInSlotOption(CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.CLONE)" [value]="CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.CLONE"/> <label for="deep-cloning" translate="se.cms.clonepagewizard.options.copies"></label></div></div>');e.put("VersionItemComponent.html",'<div class="se-version-item" [ngClass]="{ \'se-version-item--selected\': isSelectedVersion() }"><div class="se-version-item__header" [title]="pageVersion.label"><button class="se-version-item__label se-button--text" (click)="selectVersion()">{{ pageVersion.label }}</button><se-version-item-menu *ngIf="isVersionMenuEnabled()" [item]="pageVersion"></se-version-item-menu></div><div class="se-version-item__date">{{ pageVersion.creationtime | date: \'M/d/yy h:mm a\' }}</div><div class="se-version-item__description" *ngIf="pageVersion.description"><se-more-text class="se-version-item__description-text" [text]="pageVersion.description" [limit]="32" [ellipsis]="\'...\'" [capitalizeLabel]="true"></se-more-text></div></div>');e.put("VersionItemMenuComponent.html",'<se-popup-overlay class="se-version-item-menu__popup-anchor" [ngClass]="{ \'se-version-item-menu__popup-anchor--open\': isMenuOpen }" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><div *ngIf="menuItems.length > 0" (click)="onButtonClick($event)" class="sap-icon--overflow se-version-item-menu__toggle"></div><div se-popup-overlay-body class="se-version-item-menu fd-menu"><div class="se-version-item-menu__item fd-menu__list" *ngFor="let item of menuItems" (click)="executeItemCallback(item)"><span class="se-version-item-menu__item-link fd-menu__item">{{ item.i18nKey | translate }}</span></div></div></se-popup-overlay>');e.put("VersionsSearchComponent.html",'<div class="se-versions-panel__search" *ngIf="showSearchControls"><div class="se-input-group"><input type="text" class="se-input-group__input-area" name="search-term" [ngModel]="searchTerm" (ngModelChange)="onChange($event)" [placeholder]="\'se.cms.versions.search.placeholder\' | translate"/> <span class="sap-icon--search se-input-group__addon"></span> <button class="se-input-group__addon se-input-group__clear-btn sap-icon--decline" [style.visibility]="showResetButton ? \'visible\' : \'hidden\'" (click)="resetSearchBox()"></button></div><span class="se-versions-panel__count" [translate]="\'se.cms.versions.search.versions.found\'" [translateParams]="{ versionsFound: versionsFoundCount }"></span></div>');e.put("PageStatusComponent.html",'<div class="se-page-status"><div class="se-page-status__icon" [ngClass]="statusIconCssClass"></div><div class="se-page-status__label">{{ statusLabel | translate }}</div></div>');e.put("WorkflowActionCommentComponent.html",'<ng-container *ngIf="isDecisionComment; then decisionComment; else generalComment"></ng-container><ng-template #decisionComment><div class="se-workflow-action-comment"><div class="fd-tile"><div class="fd-tile__content"><h2 class="fd-tile__title se-workflow-action-comment__header sap-icon--workflow-tasks sap-icon--m" [class.sap-icon--flip-h]="!isIncomingDecision()">{{ actionComment.decisionName }}</h2><p class="fd-has-type-minus-1">{{ actionComment.authorName }} | {{ createdAgo }}</p><p *ngIf="!!actionComment.text"><strong>{{\'se.cms.page.workflow.action.item.comment.header\' | translate}}:</strong><ng-container *ngTemplateOutlet="comment"></ng-container></p></div></div></div></ng-template><ng-template #generalComment><div class="se-workflow-action-comment"><div class="fd-tile"><div class="fd-tile__content"><h2 class="fd-panel__title">{{\'se.cms.page.workflow.action.item.comment.header\' | translate}}</h2><p>{{ createdAgo }}</p><p class="se-workflow-action-comment__author">{{ actionComment.authorName }}</p><ng-container *ngTemplateOutlet="comment"></ng-container></div></div></div></ng-template><ng-template #comment><se-more-text class="se-workflow-action-comment__body" [ellipsis]="\'...\'" [text]="actionComment.text"></se-more-text></ng-template>');e.put("WorkflowActionItemComponent.html",'<div class="se-workflow-action-item" [ngClass]="getWorkflowActionStatusClass()"><se-collapsible-container class="se-catalog-details__collapse se-collapsible-container--noshadow fd-panel" [id]="workflowAction.code" (getApi)="setCollapsibleContainerApi($event)"><se-collapsible-container-header><div class="fd-panel__header"><div class="fd-panel__head"><h1 class="fd-panel__title">{{ workflowAction.name | seL10n | async }}</h1><p class="fd-panel__description">{{ getReadableStatus() | translate }} {{ getActiveSince() }}</p></div></div><div class="fd-panel__body">{{ workflowAction.description | seL10n | async }}<div *ngIf="canShowDecisionButtons()" class="se-workflow-action-item__decision-buttons fd-dropdown"><div class="fd-popover"><div class="fd-popover__control"><div [ngClass]="{ \'fd-button-split\': workflowAction.decisions.length > 1 }"><button class="se-workflow-action-item__decision-button fd-button--compact" [id]="workflowAction.code + \'-decision-button\'" (click)="onMainButtonClick($event, workflowAction.decisions[0])" type="button">{{ workflowAction.decisions[0].name | seL10n | async }}</button><se-popup-overlay [popupOverlay]="{                                        halign: \'right\',                                        valign: \'bottom\'                                    }" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="onMenuHide()"><button *ngIf="workflowAction.decisions.length > 1" [id]="workflowAction.code + \'-decision-split-button\'" class="fd-button--compact menu-button sap-icon--slim-arrow-down" (click)="onSplitButtonClick($event)"></button><div se-popup-overlay-body class="fd-popover__body fd-popover__body--right fd-popover__body--no-arrow se-workflow-action-item__decision-list"><nav class="fd-menu"><ul class="fd-menu__list"><li *ngFor="let decision of workflowAction.decisions"><a class="fd-menu__item se-workflow-action-item__decision" (click)="onMainButtonClick($event, decision)">{{ decision.name | seL10n | async }}</a></li></ul></nav></div></se-popup-overlay></div></div></div></div></div></se-collapsible-container-header><se-collapsible-container-content><div class="se-workflow-action-item__content" *ngIf="canShowComments()"><span *ngIf="!hasComments" class="se-workflow-action-item__comment-list fd-has-font-style-italic fd-has-color-text-4" [translate]="\'se.cms.actionitem.page.workflow.action.no.comments.available\'"></span><se-infinite-scrolling [pageSize]="pageSize" [fetchPage]="fetchPageOfComments" (itemsChange)="onCommentsLoaded($event)"><div *ngFor="let actionComment of workflowActionComments; trackBy: trackByIndex"><se-workflow-action-comment [workflowAction]="workflowAction" [actionComment]="actionComment"></se-workflow-action-comment></div></se-infinite-scrolling></div></se-collapsible-container-content></se-collapsible-container><fd-popover [isOpen]="showApprovalInfo" [closeOnOutsideClick]="false"><fd-popover-body><div class="se-workflow-approval-info">{{ approvalInfo }}</div></fd-popover-body></fd-popover></div>');e.put("CategoryNodeComponent.html",'<div class="se-product-row"><div class="se-category-node" [ngClass]="{          \'se-category-node--no-drag\': !parent.dragEnabled,          \'se-category-node--drag\': parent.dragEnabled        }"><div class="se-product-row__product" [title]="node.name | seL10n | async">{{ node.name | seL10n | async }}</div><div class="se-product-row__product" [title]="node.code">{{ node.code }}</div><div class="se-product-row__catalog" title="{{ node.catalogId }} - {{ node.catalogVersion }}">{{ node.catalogId }} - {{ node.catalogVersion }}</div><div><se-dropdown-menu *ngIf="parent.dragEnabled" [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div></div></div>');e.put("CategorySelectorItemComponent.html",'<div class="se-product-row"><div class="se-category-row-container--item"><div class="se-product-row__product" [title]="item.name | seL10n | async">{{ item.name | seL10n | async }}</div><div class="se-product-row__product" [title]="item.code">{{ item.code }}</div><div class="se-product-row__catalog" title="{{ item.catalogId }} - {{ item.catalogVersion }}">{{ item.catalogId }} - {{ item.catalogVersion }}</div></div></div>');e.put("ProductNodeComponent.html",'<div class="se-product-row"><div class="se-product-node" [ngClass]="{            \'se-product-node--no-drag\' : !parent.dragEnabled,            \'se-product-node--drag\': parent.dragEnabled         }"><img class="se-product-row__img" [src]="node.thumbnail.url || \'/cmssmartedit/images/product_thumbnail_default.png\'" alt="product image"/><div class="se-product-row__product se-nowrap-ellipsis" [title]="node.name | seL10n  | async">{{ node.name | seL10n | async }}</div><div class="se-product-row__product se-nowrap-ellipsis" [title]="node.code">{{ node.code }}</div><div class="se-product-row__catalog se-nowrap-ellipsis" title="{{ node.catalogId }} - {{ node.catalogVersion }}">{{ node.catalogId }} - {{ node.catalogVersion }}</div><se-dropdown-menu *ngIf="parent.dragEnabled" [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div></div>');e.put("ProductSelectorItemComponent.html",'<div class="se-product-row"><div class="se-product-node"><img class="se-product-row__img" [src]="getThumbnailUrl(item.thumbnail?.url)" alt="product image"/><div class="se-product-row__product se-nowrap-ellipsis" [title]="item.name | seL10n | async">{{ item.name | seL10n | async }}</div><div class="se-product-row__product se-nowrap-ellipsis" [title]="item.code">{{ item.code }}</div><div class="se-product-row__catalog"><div class="se-nowrap-ellipsis" title="{{ item.catalogId }} - {{ item.catalogVersion }}">{{ item.catalogId }} - {{ item.catalogVersion }}</div></div></div></div>');e.put("MediaContainerSelectorComponent.html",'<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="field.qualifier" [model]="mediaContainerNameModel" [showRemoveButton]="true" [itemComponent]="itemComponent" [actionableSearchItem]="actionableSearchItem" [(reset)]="reset"></se-generic-editor-dropdown><div *ngIf="isSelected() || creationInProgress"><label [for]="\'media-container-qualifier-\' + id" class="se-control-label required se-media-container-name-label">{{ \'se.cms.media.responsive.name\' | lowercase | translate }}</label> <input type="text" name="media-container-qualifier" [id]="\'media-container-qualifier-\' + id" class="fd-form-control" [ngModel]="name" (ngModelChange)="onNameChange($event)" [readOnly]="isNameReadOnly()" [disabled]="!field.editable"/></div>');e.put("MediaContainerSelectorItemComponent.html",'<div class="media-container-selector-item__row"><img class="media-container-selector-item__img" [ngClass]="{ \'media-container-selector-item__img--selected\': isSelected }" [src]="getThumbnailUrl(item.thumbnailUrl)"/><div class="media-container-selector-item__label">{{ item.qualifier }}</div></div>');e.put("MediaFormatUploadedComponent.html",'<div class="se-media--present"><div class="se-media--present-img-container se-media-preview-container"><div *ngIf="isImage()" class="se-media-preview__image-wrapper"><se-media-preview [imageUrl]="getSafeUrl()"></se-media-preview><img class="se-media-preview__image-thumbnail" [src]="getSafeUrl()"/></div><div *ngIf="isVideo()" class="se-media-preview__image-wrapper"><video class="se-media-preview__image-thumbnail" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-preview__image-wrapper"><iframe class="se-media-preview__image-thumbnail" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div></div><se-media-advanced-properties [code]="media.code" [description]="media.description" [altText]="media.altText"></se-media-advanced-properties><se-media-file-selector [labelI18nKey]="replaceLabelI18nKey" [acceptedFileTypes]="acceptedFileTypes" [customClass]="\'media-format-present-replace\' + (isFieldDisabled ? \' file-selector-disabled\' : \'\')" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><se-media-remove-button [isDisabled]="isFieldDisabled" (clickHandler)="onRemoveButtonClick()"></se-media-remove-button></div>');e.put("MediaPrinterComponent.html",'<div class="se-media-selector" *ngIf="isSelected"><span class="se-media-selector__left-section se-media-preview-container"><div *ngIf="isImage()" class="se-media-selector__left-section se-media-preview-container"><se-media-preview [imageUrl]="getSafeUrl()"></se-media-preview><img class="se-media-preview__image-thumbnail" [alt]="media.code" [src]="getSafeUrl()"/></div><div *ngIf="isVideo()" class="se-media-selector__left-section se-media-preview-container"><video class="se-media-preview__image-thumbnail" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-selector__left-section se-media-preview-container"><iframe class="se-media-preview__image-thumbnail" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div></span><span class="se-media-selector__right-section"><se-media-advanced-properties [code]="media.code" [description]="media.description" [altText]="media.altText"></se-media-advanced-properties><button class="se-media-action-btn replace-image" [disabled]="isDisabled()"><span class="sap-icon--share se-media__action-icon"></span><se-media-action-label [state]="isDisabled() ? \'disabled\' : null" [i18nKey]="\'se.upload.image.replace\'"></se-media-action-label></button><se-media-remove-button [isDisabled]="isDisabled()" (clickHandler)="select.removeSelectedOption($event, media)"></se-media-remove-button></span></div><div class="se-media-selector__search" *ngIf="!isSelected"><div *ngIf="isImage()" class="se-media-selector__search-img-wrapper"><img [src]="getSafeUrl()" class="se-media-selector__search-img" [alt]="media.code"/></div><div *ngIf="isVideo()" class="se-media-selector__search-img-wrapper"><video class="se-media-selector__search-img" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-selector__search-img-wrapper"><iframe class="se-media-selector__search-img" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div><div class="se-media-selector__search-name">{{ media.code }}</div></div>');e.put("MediaUploadFieldComponent.html",'<div class="se-media-upload__file-info-field" [ngClass]="getContainerClassName()"><label class="se-control-label" [ngClass]="{ \'se-media-upload-has-error\': hasError(), required: isRequired }" [translate]="labelI18nKey"></label> <input type="text" [ngClass]="{ \'is-invalid\': hasError() }" class="fd-form__control" [attr.name]="fieldName" [ngModel]="fieldValue" (ngModelChange)="onChangeValue($event)"/> <span class="upload-field-error fd-form__message fd-form__message--error" [ngClass]="getErrorClassName()" *ngFor="let error of fieldErrors">{{ error | translate }}</span></div>')}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}window.__smartedit__.addDecoratorPayload("Component","SubTypeSelectorComponent",{selector:"se-sub-type-selector",template:`<ul class="se-sub-type__selector fd-menu__list"><li class="cms-sub-type__selector-link fd-menu__item" *ngFor="let subType of subTypes" (click)="select(subType)" [translate]="subType.label"></li></ul>`,styles:[`.cms-sub-type__selector-link{display:flex;flex-direction:row;align-items:center;color:#0a6ed1;height:46px}.cms-sub-type__selector-link:hover{color:#085caf}`],changeDetection:s.ChangeDetectionStrategy.OnPush});t.SubTypeSelectorComponent=class SubTypeSelectorComponent{constructor(){this.onSubTypeSelect=new s.EventEmitter}select({id:e}){this.onSubTypeSelect.emit(e)}};__decorate([s.Input(),__metadata("design:type",Array)],t.SubTypeSelectorComponent.prototype,"subTypes",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],t.SubTypeSelectorComponent.prototype,"onSubTypeSelect",void 0);t.SubTypeSelectorComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-sub-type-selector",template:`<ul class="se-sub-type__selector fd-menu__list"><li class="cms-sub-type__selector-link fd-menu__item" *ngFor="let subType of subTypes" (click)="select(subType)" [translate]="subType.label"></li></ul>`,styles:[`.cms-sub-type__selector-link{display:flex;flex-direction:row;align-items:center;color:#0a6ed1;height:46px}.cms-sub-type__selector-link:hover{color:#085caf}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],t.SubTypeSelectorComponent);window.__smartedit__.addDecoratorPayload("Component","SelectComponentTypeModalComponent",{selector:"se-select-component-type-modal",template:`\n        <se-sub-type-selector\n            class="sub-type-selector"\n            [subTypes]="subTypes"\n            (onSubTypeSelect)="closeWithSelectedId($event)"\n        >\n        </se-sub-type-selector>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});t.SelectComponentTypeModalComponent=class SelectComponentTypeModalComponent{constructor(e){this.modalManager=e}ngOnInit(){this.modalManager.getModalData().pipe(g.take(1)).subscribe((({subTypes:e})=>this.subTypes=this.mapSubTypesToIdWithLabel(e)))}closeWithSelectedId(e){this.modalManager.close(e)}mapSubTypesToIdWithLabel(e){return Object.keys(e).map((t=>({id:t,label:e[t]})))}};t.SelectComponentTypeModalComponent=__decorate([s.Component({selector:"se-select-component-type-modal",template:`\n        <se-sub-type-selector\n            class="sub-type-selector"\n            [subTypes]="subTypes"\n            (onSubTypeSelect)="closeWithSelectedId($event)"\n        >\n        </se-sub-type-selector>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.ModalManagerService])],t.SelectComponentTypeModalComponent);const P="ON_EDIT_NESTED_COMPONENT";const A="CREATE_NESTED_COMPONENT_BUTTON_PRESSED_EVENT";window.__smartedit__.addDecoratorPayload("Component","CmsDropdownItemComponent",{selector:"se-cms-dropdown-item",template:`<div class="cms-nested-component" *ngIf="item" [attr.data-component-id]="item.uid"><span class="cms-nested-component__item" *ngIf="isSelected" (click)="onClick($event);"><span class="sap-icon--card cms-nested-component__item-icon"></span><div class="cms-nested-component__item-data"><p class="cms-nested-component__item-name" [title]="item.name">{{ item.name }}</p><p class="cms-nested-component__item-type" [title]="item.typeCode">{{ item.typeCode }}</p></div></span><div class="cms-nested-component__result-item" *ngIf="!isSelected"><span class="cms-nested-component__result-name" [title]="item.name">{{ item.name }}</span> <span class="cms-nested-component__result-code" [title]="item.typeCode">{{ item.typeCode }}</span></div></div>`,styles:[`.cms-nested-component__item{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;color:#0a6ed1}.cms-nested-component__item-icon{display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#0a6ed1;height:28px;flex:0 0 28px;color:#fff;border-radius:4px;margin-right:16px}.cms-nested-component__item-data{width:100%;display:grid;grid-template-columns:auto auto;grid-gap:0 16px}.cms-nested-component__item-name,.cms-nested-component__item-type{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;margin-bottom:0}.cms-nested-component__result-item{display:grid;grid-template-columns:repeat(2,1fr);grid-gap:0 16px}.cms-nested-component__result-code,.cms-nested-component__result-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all}.cms-nested-component__item[draggable=true],.ui-select-match-item[draggable=true]{cursor:move}.y-select-item-printer{width:100%}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});t.CmsDropdownItemComponent=class CmsDropdownItemComponent{constructor(e,t){this.systemEventService=t;({item:this.item,select:{id:this.qualifier},selected:this.isSelected}=e)}onClick(e){e.stopPropagation();if(this.isSelected){this.systemEventService.publishAsync(P,{qualifier:this.qualifier,item:this.item})}}};t.CmsDropdownItemComponent.$inject=["data","systemEventService"];t.CmsDropdownItemComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-cms-dropdown-item",template:`<div class="cms-nested-component" *ngIf="item" [attr.data-component-id]="item.uid"><span class="cms-nested-component__item" *ngIf="isSelected" (click)="onClick($event);"><span class="sap-icon--card cms-nested-component__item-icon"></span><div class="cms-nested-component__item-data"><p class="cms-nested-component__item-name" [title]="item.name">{{ item.name }}</p><p class="cms-nested-component__item-type" [title]="item.typeCode">{{ item.typeCode }}</p></div></span><div class="cms-nested-component__result-item" *ngIf="!isSelected"><span class="cms-nested-component__result-name" [title]="item.name">{{ item.name }}</span> <span class="cms-nested-component__result-code" [title]="item.typeCode">{{ item.typeCode }}</span></div></div>`,styles:[`.cms-nested-component__item{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;color:#0a6ed1}.cms-nested-component__item-icon{display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#0a6ed1;height:28px;flex:0 0 28px;color:#fff;border-radius:4px;margin-right:16px}.cms-nested-component__item-data{width:100%;display:grid;grid-template-columns:auto auto;grid-gap:0 16px}.cms-nested-component__item-name,.cms-nested-component__item-type{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;margin-bottom:0}.cms-nested-component__result-item{display:grid;grid-template-columns:repeat(2,1fr);grid-gap:0 16px}.cms-nested-component__result-code,.cms-nested-component__result-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all}.cms-nested-component__item[draggable=true],.ui-select-match-item[draggable=true]{cursor:move}.y-select-item-printer{width:100%}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object,m.SystemEventService])],t.CmsDropdownItemComponent);let O=class SelectComponentTypeModalService{constructor(e,t){this.logService=e;this.modalService=t}open(e){return __awaiter(this,void 0,void 0,(function*(){return this.modalService.open({component:t.SelectComponentTypeModalComponent,data:{subTypes:e},config:{modalPanelClass:"modal-lg"},templateConfig:{title:"se.cms.nestedcomponenteditor.select.type"}}).afterClosed.toPromise().catch((e=>{this.logService.debug("Select Component Type Modal dismissed",e)}))}))}};O.$inject=["logService","modalService"];O=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.LogService,m.ModalService])],O);let x=class NestedComponentManagementService{constructor(e){this.editorModalService=e}openNestedComponentEditor(e,t){const o=this.prepareComponentAttributes(e);return this.editorModalService.open(o,null,null,null,null,t)}prepareComponentAttributes({componentUuid:e,componentType:t,content:o}){return{smarteditComponentUuid:e,smarteditComponentType:t,content:u.defaultsDeep({},o,{typeCode:t,itemtype:t,visible:true})}}};x.$inject=["editorModalService"];x=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IEditorModalService])],x);let D=class CMSItemDropdownDropdownPopulator extends m.DropdownPopulatorInterface{constructor(e,t,o,n){super(T,t,o);this.genericEditorStackService=e;this.uriDropdownPopulator=n;this.CMS_ITEMS_URI="/cmswebservices/v1/sites/CURRENT_CONTEXT_SITE_ID/cmsitems"}fetchAll(e){return __awaiter(this,void 0,void 0,(function*(){this.preparePayload(e);const t=yield this.uriDropdownPopulator.fetchAll(e);return this.getNonNestedComponents(e.field.editorStackId,t)}))}fetchPage(e){return __awaiter(this,void 0,void 0,(function*(){this.preparePayload(e);const t=yield this.uriDropdownPopulator.fetchPage(e);t.response=this.getNonNestedComponents(e.field.editorStackId,t.response);return t}))}getItem(e){this.preparePayload(e);return this.uriDropdownPopulator.getItem(e)}preparePayload(e){e.field.uri=this.CMS_ITEMS_URI}getNonNestedComponents(e,t){const o=this.genericEditorStackService.getEditorsStack(e).filter((e=>e.component.uuid)).map((e=>e.component.uuid));t=t.filter((e=>!e.uuid||!o.includes(e.uuid)));return t}};D.$inject=["genericEditorStackService","languageService","translateService","uriDropdownPopulator"];D=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.GenericEditorStackService,m.LanguageService,v.TranslateService,m.UriDropdownPopulator])],D);window.__smartedit__.addDecoratorPayload("Component","CmsComponentDropdownComponent",{selector:"se-cms-component-dropdown",template:`<div class="cms-nested-component-template"><div class="cms-nested-component-select"><ng-container *ngIf="forceRecompile"><se-generic-editor-dropdown [field]="field" [qualifier]="qualifier" [model]="model" [id]="id" [itemComponent]="itemComponent" [actionableSearchItem]="actionableSearchItem" [showRemoveButton]="true"></se-generic-editor-dropdown></ng-container></div></div>`,styles:[`se-cms-component-dropdown div.se-actionable-search-item{display:flex;align-items:center;justify-content:space-between;padding:0 0 0 13px}se-cms-component-dropdown se-item-printer{width:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});t.CmsComponentDropdownComponent=class CmsComponentDropdownComponent{constructor(e,t,o,n,s,a,r){this.systemEventService=t;this.genericEditorStackService=o;this.nestedComponentManagementService=n;this.selectComponentTypeModalService=s;this.logService=a;this.cdr=r;({field:this.field,model:this.model,id:this.id,qualifier:this.qualifier}=e);this.editorStackId=e.editor.editorStackId;this.forceRecompile=true}ngOnInit(){this.itemComponent=t.CmsDropdownItemComponent;this.field.params=this.field.params||{};this.field.editorStackId=this.editorStackId;this.field.params.catalogId=p.CONTEXT_CATALOG;this.field.params.catalogVersion=p.CONTEXT_CATALOG_VERSION;this.componentButtonPressedEventId=`${A}_${this.qualifier}`;this.actionableSearchItem=!!this.field.subTypes&&Object.keys(this.field.subTypes).length>0?{eventId:this.componentButtonPressedEventId}:undefined;this.createComponentButtonUnRegFn=this.systemEventService.subscribe(this.componentButtonPressedEventId,((e,t)=>this.onCreateComponentButtonPressed(t)));this.editComponentClickedUnRegFn=this.systemEventService.subscribe(P,((e,t)=>this.onEditComponentClicked(t)))}ngOnDestroy(){this.createComponentButtonUnRegFn();this.editComponentClickedUnRegFn()}onCreateComponentButtonPressed(e){return __awaiter(this,void 0,void 0,(function*(){this.searchQuery=e;if(!this.genericEditorStackService.isTopEditorInStack(this.editorStackId,this.id)){return}if(this.field.subTypes){const e=Object.keys(this.field.subTypes);if(e.length>1){const e=yield this.selectComponentTypeModalService.open(this.field.subTypes);if(!!e){this.createNestedComponent(e)}}else{this.createNestedComponent(e[0])}}}))}onEditComponentClicked(e){if(this.genericEditorStackService.isTopEditorInStack(this.editorStackId,this.id)){if(this.qualifier===e.qualifier){this.editComponent(e.item)}}}createNestedComponent(e){return __awaiter(this,void 0,void 0,(function*(){const t={componentId:null,componentUuid:null,componentType:e,content:{name:this.searchQuery,catalogVersion:this.model.catalogVersion}};yield this.nestedComponentEditorHandler(t)}))}editComponent(e){return __awaiter(this,void 0,void 0,(function*(){const t={componentId:e.uid,componentUuid:e.uuid,componentType:e.typeCode||e.itemtype,content:e};yield this.nestedComponentEditorHandler(t)}))}nestedComponentEditorHandler(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.nestedComponentManagementService.openNestedComponentEditor(e,this.editorStackId);if(this.field.collection){if(!this.model[this.qualifier]){this.model[this.qualifier]=[]}this.model[this.qualifier]=this.model[this.qualifier].filter((e=>e!==t.uuid)).concat(t.uuid)}else{this.forceRecompile=false;setTimeout((()=>{this.forceRecompile=true;this.model[this.qualifier]=t.uuid;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}if(!this.cdr.destroyed){this.cdr.detectChanges()}}catch(t){if(t){this.logService.warn(`Something went wrong when creating or editing Nested component (${e.componentType})`,t)}}}))}};t.CmsComponentDropdownComponent.$inject=["data","systemEventService","genericEditorStackService","nestedComponentManagementService","selectComponentTypeModalService","logService","cdr"];t.CmsComponentDropdownComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-cms-component-dropdown",template:`<div class="cms-nested-component-template"><div class="cms-nested-component-select"><ng-container *ngIf="forceRecompile"><se-generic-editor-dropdown [field]="field" [qualifier]="qualifier" [model]="model" [id]="id" [itemComponent]="itemComponent" [actionableSearchItem]="actionableSearchItem" [showRemoveButton]="true"></se-generic-editor-dropdown></ng-container></div></div>`,styles:[`se-cms-component-dropdown div.se-actionable-search-item{display:flex;align-items:center;justify-content:space-between;padding:0 0 0 13px}se-cms-component-dropdown se-item-printer{width:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,m.SystemEventService,m.GenericEditorStackService,x,O,m.LogService,s.ChangeDetectorRef])],t.CmsComponentDropdownComponent);const k="ySEComponentMenuOpen";const F="RESET_COMPONENT_MENU_EVENT";var V;(function(e){e["information"]="showInfo";e["success"]="showSuccess";e["warning"]="showWarning";e["error"]="showDanger"})(V||(V={}));t.ActionableAlertService=class ActionableAlertService{constructor(e){this.alertService=e}displayActionableAlert(e,t){const o=this.getMethodNameByAlertType(t);return this.alertService[o](e)}getMethodNameByAlertType(e){if(e&&V[e]){return V[e]}return V.information}};t.ActionableAlertService.$inject=["alertService"];t.ActionableAlertService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IAlertService])],t.ActionableAlertService);window.__smartedit__.addDecoratorPayload("Component","PageRestoredAlertComponent",{selector:"se-page-restored-alert-component",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<se-actionable-alert\n        [description]="message"\n        [hyperlinkLabel]="hyperlinkLabel"\n        [hyperlinkDetails]="hyperLinkDetails"\n        (hyperLinkClick)="onClick()"\n    ></se-actionable-alert>`});t.PageRestoredAlertComponent=class PageRestoredAlertComponent{constructor(e,t){this.alertRef=e;this.experienceService=t;this.hyperlinkLabel="se.cms.page.restored.alert.info.hyperlink";this.message="se.cms.page.restored.alert.info.description"}ngOnInit(){const{pageInfo:e}=this.alertRef.data;this.hyperLinkDetails={pageName:e.name}}onClick(){const{catalogVersion:e,pageInfo:t}=this.alertRef.data;this.alertRef.dismiss();this.experienceService.loadExperience({siteId:e.siteId,catalogId:e.catalogId,catalogVersion:e.version,pageId:t.uid})}};t.PageRestoredAlertComponent.$inject=["alertRef","experienceService"];t.PageRestoredAlertComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-restored-alert-component",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<se-actionable-alert\n        [description]="message"\n        [hyperlinkLabel]="hyperlinkLabel"\n        [hyperlinkDetails]="hyperLinkDetails"\n        (hyperLinkClick)="onClick()"\n    ></se-actionable-alert>`}),__metadata("design:paramtypes",[S.AlertRef,m.IExperienceService])],t.PageRestoredAlertComponent);t.PageRestoredAlertService=class PageRestoredAlertService{constructor(e,t){this.catalogService=e;this.actionableAlertService=t}displayPageRestoredSuccessAlert(e){return __awaiter(this,void 0,void 0,(function*(){if(!e){throw new Error("[pageRestoredAlertService] - page info not provided.")}const o=yield this.catalogService.getCatalogVersionByUuid(e.catalogVersion);const n={component:t.PageRestoredAlertComponent,data:{catalogVersion:o,pageInfo:e}};return this.actionableAlertService.displayActionableAlert(n,m.IAlertServiceType.SUCCESS)}))}};t.PageRestoredAlertService.$inject=["catalogService","actionableAlertService"];t.PageRestoredAlertService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ICatalogService,t.ActionableAlertService])],t.PageRestoredAlertService);window.__smartedit__.addDecoratorPayload("Component","ClonePageAlertComponent",{selector:"se-clone-page-alert",template:`\n        <se-actionable-alert\n            [description]="description"\n            [descriptionDetails]="descriptionDetails"\n            [hyperlinkLabel]="hyperlinkLabel"\n            (hyperLinkClick)="onClick()"\n        ></se-actionable-alert>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[m.L10nPipe]});t.ClonePageAlertComponent=class ClonePageAlertComponent{constructor(e,t,o,n){this.alertRef=e;this.experienceService=t;this.cdr=o;this.l10n=n;this.description="se.cms.clonepage.alert.info.description";this.hyperlinkLabel="se.cms.clonepage.alert.info.hyperlink"}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){({clonedPageInfo:this.clonedPageInfo,catalogVersion:this.catalogVersion}=this.alertRef.data);this.description="se.cms.clonepage.alert.info.description";this.descriptionDetails={catalogName:yield this.getTranslatedName(this.catalogVersion.catalogName),catalogVersion:this.catalogVersion.version};this.hyperlinkLabel="se.cms.clonepage.alert.info.hyperlink";if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}onClick(){if(m.stringUtils.isBlank(this.clonedPageInfo.uid)){throw new Error("ClonePageAlertService.displayClonePageAlert - missing required parameter 'uid'")}this.experienceService.loadExperience({siteId:this.catalogVersion.siteId,catalogId:this.catalogVersion.catalogId,catalogVersion:this.catalogVersion.version,pageId:this.clonedPageInfo.uid})}getTranslatedName(e){return this.l10n.transform(e).pipe(g.take(1)).toPromise()}};t.ClonePageAlertComponent.$inject=["alertRef","experienceService","cdr","l10n"];t.ClonePageAlertComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-clone-page-alert",template:`\n        <se-actionable-alert\n            [description]="description"\n            [descriptionDetails]="descriptionDetails"\n            [hyperlinkLabel]="hyperlinkLabel"\n            (hyperLinkClick)="onClick()"\n        ></se-actionable-alert>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[m.L10nPipe]}),__metadata("design:paramtypes",[S.AlertRef,m.IExperienceService,s.ChangeDetectorRef,m.L10nPipe])],t.ClonePageAlertComponent);t.ClonePageAlertService=class ClonePageAlertService{constructor(e,t){this.actionableAlertService=e;this.catalogService=t}displayClonePageAlert(e){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.catalogService.getCatalogVersionByUuid(e.catalogVersion);return this.actionableAlertService.displayActionableAlert({component:t.ClonePageAlertComponent,mousePersist:true,data:{catalogVersion:o,clonedPageInfo:e}})}))}};t.ClonePageAlertService.$inject=["actionableAlertService","catalogService"];t.ClonePageAlertService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.ActionableAlertService,m.ICatalogService])],t.ClonePageAlertService);var U;(function(e){e["HIDDEN"]="se.cms.component.visibility.alert.description.hidden";e["RESTRICTED"]="se.cms.component.visibility.alert.description.restricted"})(U||(U={}));t.ComponentVisibilityAlertService=class ComponentVisibilityAlertService extends p.IComponentVisibilityAlertService{constructor(e,t,o){super();this.sharedDataService=e;this.alertService=t;this.actionableAlertService=o}checkAndAlertOnComponentVisibility(e){return __awaiter(this,void 0,void 0,(function*(){const t=!e.visible||e.restricted;if(!t){return}const o=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);const n=!e.visible?U.HIDDEN:U.RESTRICTED;const s=e.catalogVersion!==o.pageContext.catalogVersionUuid;if(s){this.alertService.showAlert({message:n})}else{const t={component:p.ComponentVisibilityAlertComponent,duration:6e3,data:{component:e,message:n}};this.actionableAlertService.displayActionableAlert(t,m.IAlertServiceType.INFO)}}))}};t.ComponentVisibilityAlertService.$inject=["sharedDataService","alertService","actionableAlertService"];t.ComponentVisibilityAlertService=__decorate([m.SeDowngradeService(p.IComponentVisibilityAlertService),m.GatewayProxied("checkAndAlertOnComponentVisibility"),__metadata("design:paramtypes",[m.ISharedDataService,m.IAlertService,t.ActionableAlertService])],t.ComponentVisibilityAlertService);t.ComponentSharedService=class ComponentSharedService extends p.IComponentSharedService{};t.ComponentSharedService=__decorate([m.SeDowngradeService(p.IComponentSharedService),m.GatewayProxied()],t.ComponentSharedService);const $="cms-link-to-reload-structure";const K="clear_mediaContainer_selected_option";const Y="maxUploadFileSize";const X="se.read.page";const J="se.read.slot";const ee="se.read.component";const te="se.read.current.catalog.version";const ie="se.write.page";const oe="se.write.slot";const ne="se.write.component";const se="se.write.to.current.catalog.version";const ae="se.content.catalog.non.active";const re="se.not.versioning.perspective";const le="se.version.page.selected";const ce="se.current.page.has.active.workflow";const de="se.has.change.type.permissions.on.current.page";const pe="se.has.read.type.permissions.on.current.page";const me="se.has.read.permission.on.version.type";const ge="se.has.create.permission.on.version.type";const ue="se.has.change.permission.on.workflow.type";const he="se.current.user.can.act.on.page.in.workflow";const ve="se.current.user.can.act.on.workflow.current.action";const _e="se.sync.catalog";const fe="se.page.belongs.to.experience";window.__smartedit__.addDecoratorPayload("Component","GenericEditorModalComponent",{selector:"se-generic-editor-modal",template:`\n        <se-message\n            class="se-ge-modal--messages"\n            *ngIf="showDisclaimer"\n            type="info"\n            messageId="VisibilityTab.DisplayComponentOffDisclaimer"\n        >\n            <ng-container se-message-description>\n                {{ 'se.cms.editortabset.visibilitytab.disclaimer' | translate }}\n            </ng-container>\n        </se-message>\n\n        <ng-container *ngIf="data && data.messages">\n            <se-message\n                class="se-ge-modal--messages"\n                *ngFor="let msg of data.messages; let i = index"\n                [type]="msg.type"\n                messageId="generic-editor-model-message-{{ i }}"\n            >\n                <ng-container se-message-description> {{ msg.message }} </ng-container>\n            </se-message>\n        </ng-container>\n\n        <se-generic-editor\n            *ngIf="isSetupCompleted"\n            [id]="genericEditorId"\n            [smarteditComponentId]="data.componentUuid"\n            [smarteditComponentType]="data.componentType"\n            [structure]="structure"\n            [structureApi]="structureApi"\n            [content]="data.content"\n            [contentApi]="contentApi"\n            [(submit)]="controls.submit"\n            [(reset)]="controls.reset"\n            [(isDirty)]="controls.isDirty"\n            [editorStackId]="editorStackId"\n            (getApi)="getApi($event)"\n        >\n        </se-generic-editor>\n    `});t.GenericEditorModalComponent=class GenericEditorModalComponent{constructor(e,t,o,n){this.modalManager=e;this.confirmationModalService=t;this.crossFrameEventService=o;this.systemEventService=n;this.data={};this.controls={};this.genericEditorId=m.stringUtils.generateIdentifier();this.showDisclaimer=false;this.STRUCTURE_API_BASE_URL=`${p.TYPES_RESOURCE_URI}?code=:smarteditComponentType&mode=:structureApiMode`;this.isSetupCompleted=false;this.isReset=false;this.isEscapeInProgress=false}onEscapeDown(){if(this.isEscapeInProgress){return}this.onEscapeClicked()}getApi(e){this.controls.genericEditorAPI=e;if(this.data.targetedQualifier){e.switchToTabContainingQualifier(this.data.targetedQualifier)}if(this.data.initialDirty){e.considerFormDirty()}}onSave(){return this.controls.submit().then((e=>{this.crossFrameEventService.publish(p.CMSITEMS_UPDATE_EVENT);if(this.saveCallback){this.saveCallback(e)}this.removeEventListeners();return e}))}onCancel(){return new Promise(((e,t)=>{if(this.genericEditorIsDirty()&&!this.isReset){this.confirmationModalService.confirm({description:"se.editor.cancel.confirm"}).then((()=>{this.controls.reset().then((()=>{this.markAsReset();this.removeEventListeners();e()}),(()=>{t()}));this.crossFrameEventService.publish("GENERIC_EDITOR_CANCEL",{confirmed:true})}),(()=>{t();this.crossFrameEventService.publish("GENERIC_EDITOR_CANCEL",{confirmed:false})}))}else{this.removeEventListeners();e()}}))}setup(){this.structure=this.data.structure;if(!this.structure){this.structureApi=this.getStructureApiByMode("DEFAULT");if(this.isGenericEditorInReadOnlyMode()){this.structureApi=this.applyReadOnlyModeToStructureApiUrl(this.structureApi)}}else if(this.isGenericEditorInReadOnlyMode()){this.structure=this.makeStructureReadOnly(this.structure)}this.changeStructureEventListener=this.systemEventService.subscribe($,((e,t)=>this.onChangeStructureEvent(e,t)));this.unrelatedValidationErrorsEvent=this.systemEventService.subscribe(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,((e,t)=>this.onUnrelatedErrors(e,t)));this.contentApi=this.data.contentApi||`/cmswebservices/v1/sites/${m.CONTEXT_SITE_ID}/cmsitems`;this.modalManager.setDismissCallback((()=>this.onCancel()));this.modalManager.addButtons([{id:"save",label:this.data.saveLabel||"se.cms.component.confirmation.modal.save",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.Close,callback:()=>C.from(this.onSave()),disabledFn:()=>this.controls.genericEditorAPI&&this.controls.genericEditorAPI.isSubmitDisabled()||this.isGenericEditorInReadOnlyMode()},{id:"cancel",label:this.data.cancelLabel||"se.cms.component.confirmation.modal.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.Dismiss,callback:()=>C.from(this.onCancel())}]);this.isSetupCompleted=true}makeStructureReadOnly(e){e.attributes=e.attributes||[];e.attributes.forEach((function(e){e.editable=false}));return e}isGenericEditorInReadOnlyMode(){return!!this.data.readOnlyMode}getGenericEditorContent(){return this.controls.genericEditorAPI&&this.controls.genericEditorAPI.getContent()}genericEditorIsDirty(){return this.controls.isDirty&&this.controls.isDirty()}onChangeStructureEvent(e,t){if(this.genericEditorId===t.editorId){if(t.structureApiMode){this.structure=null;this.structureApi=this.getStructureApiByMode(t.structureApiMode);if(this.isGenericEditorInReadOnlyMode()){this.structureApi=this.applyReadOnlyModeToStructureApiUrl(this.structureApi)}}else if(t.structure){this.structureApi=null;this.structure=t.structure;if(this.isGenericEditorInReadOnlyMode()){this.structure=this.makeStructureReadOnly(this.structure)}}this.data.content=t.content}}onUnrelatedErrors(e,t){if(t.sourceGenericEditorId===this.data.componentUuid&&this.errorCallback){this.errorCallback(t.messages,this)}}applyReadOnlyModeToStructureApiUrl(e){return`${e}&readOnly=true`}getStructureApiByMode(e){return this.STRUCTURE_API_BASE_URL.replace(/:structureApiMode/gi,e)}removeEventListeners(){this.unrelatedValidationErrorsEvent();this.changeStructureEventListener()}ngOnInit(){this.modalManager.getModalData().subscribe((e=>{this.data=e.data;this.saveCallback=e.saveCallback;this.errorCallback=e.errorCallback;this.editorStackId=e.data.editorStackId;if(!this.isSetupCompleted){this.setup()}}))}markAsReset(){this.isReset=true}onEscapeClicked(){this.isEscapeInProgress=true;this.onCancel().then((()=>this.modalManager.dismiss())).finally((()=>{this.isEscapeInProgress=false}))}};t.GenericEditorModalComponent.$inject=["modalManager","confirmationModalService","crossFrameEventService","systemEventService"];__decorate([s.HostListener("document:keyup.escape"),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],t.GenericEditorModalComponent.prototype,"onEscapeDown",null);t.GenericEditorModalComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-generic-editor-modal",template:`\n        <se-message\n            class="se-ge-modal--messages"\n            *ngIf="showDisclaimer"\n            type="info"\n            messageId="VisibilityTab.DisplayComponentOffDisclaimer"\n        >\n            <ng-container se-message-description>\n                {{ 'se.cms.editortabset.visibilitytab.disclaimer' | translate }}\n            </ng-container>\n        </se-message>\n\n        <ng-container *ngIf="data && data.messages">\n            <se-message\n                class="se-ge-modal--messages"\n                *ngFor="let msg of data.messages; let i = index"\n                [type]="msg.type"\n                messageId="generic-editor-model-message-{{ i }}"\n            >\n                <ng-container se-message-description> {{ msg.message }} </ng-container>\n            </se-message>\n        </ng-container>\n\n        <se-generic-editor\n            *ngIf="isSetupCompleted"\n            [id]="genericEditorId"\n            [smarteditComponentId]="data.componentUuid"\n            [smarteditComponentType]="data.componentType"\n            [structure]="structure"\n            [structureApi]="structureApi"\n            [content]="data.content"\n            [contentApi]="contentApi"\n            [(submit)]="controls.submit"\n            [(reset)]="controls.reset"\n            [(isDirty)]="controls.isDirty"\n            [editorStackId]="editorStackId"\n            (getApi)="getApi($event)"\n        >\n        </se-generic-editor>\n    `}),__metadata("design:paramtypes",[m.ModalManagerService,m.IConfirmationModalService,m.CrossFrameEventService,m.SystemEventService])],t.GenericEditorModalComponent);let ye=class CatalogVersionRestService{constructor(e){this.restServiceFactory=e;this.URI=`/cmswebservices/v1/sites/:${m.CONTEXT_SITE_ID}/catalogs/:${m.CONTEXT_CATALOG}/versions/:${m.CONTEXT_CATALOG_VERSION}/targets?mode=cloneableTo`}getCloneableTargets(e){const t=this.restServiceFactory.get(this.URI);return t.get(e)}};ye.$inject=["restServiceFactory"];ye=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],ye);let Se=class PageRestrictionsRestService{constructor(e){this.restServiceFactory=e;this.contextualPageRestrictionsRestService=this.restServiceFactory.get(p.CONTEXTUAL_PAGES_RESTRICTIONS_RESOURCE_URI);this.pageRestrictionsRestService=this.restServiceFactory.get(p.PAGES_RESTRICTIONS_RESOURCE_URI)}getPagesRestrictionsForPageId(e){return this.contextualPageRestrictionsRestService.get({pageId:e})}getPagesRestrictionsForCatalogVersion(e,t,o){return this.pageRestrictionsRestService.get({siteUID:e,catalogId:t,catalogVersion:o})}};Se.$inject=["restServiceFactory"];Se=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Se);let Ce=class PageTypesRestrictionTypesRestService{constructor(e){this.restServiceFactory=e;this.restService=this.restServiceFactory.get(p.PAGE_TYPES_RESTRICTION_TYPES_URI)}getPageTypesRestrictionTypes(){return this.restService.get()}};Ce.$inject=["restServiceFactory"];Ce=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Ce);let be=class PageContentSlotsComponentsRestService extends p.IPageContentSlotsComponentsRestService{constructor(){super()}};be=__decorate([m.GatewayProxied("clearCache","getSlotsToComponentsMapForPageUid"),m.SeDowngradeService(p.IPageContentSlotsComponentsRestService),__metadata("design:paramtypes",[])],be);let Ie=class PagesFallbacksRestService{constructor(e){this.restServiceFactory=e;this.fallbacksForPageIdResource=e.get(this.getUri())}getFallbacksForPageId(e){return this.fallbacksForPageIdResource.get({pageId:e}).then((e=>e.uids))}getFallbacksForPageIdAndContext(e,t){const o=this.getUri(t[m.CONTEXT_SITE_ID],t[m.CONTEXT_CATALOG],t[m.CONTEXT_CATALOG_VERSION]);const n=this.restServiceFactory.get(o);return n.get({pageId:e}).then((e=>e.uids))}getUri(e=m.PAGE_CONTEXT_SITE_ID,t=m.PAGE_CONTEXT_CATALOG,o=m.PAGE_CONTEXT_CATALOG_VERSION){return`/cmswebservices/v1/sites/${e}/catalogs/${t}/versions/${o}/pages/:pageId/fallbacks`}};Ie.$inject=["restServiceFactory"];Ie=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Ie);let we=class PagesRestService{constructor(e){this.restServiceFactory=e;this.URI=`/cmswebservices/v1/sites/${m.PAGE_CONTEXT_SITE_ID}/catalogs/${m.PAGE_CONTEXT_CATALOG}/versions/${m.PAGE_CONTEXT_CATALOG_VERSION}/pages/:pageUid`}get(e){return this.restServiceFactory.get(this.URI,"pageUid").get({uids:e}).then((e=>e.pages))}getById(e){return this.restServiceFactory.get(this.URI,"pageUid").get({pageUid:e})}update(e,t){const o=new m.URIBuilder(this.URI).replaceParams(t).build();const n=u.assign({pageUid:e},t);return this.restServiceFactory.get(o,"pageUid").update(n)}};we.$inject=["restServiceFactory"];we=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],we);let Ee=class PagesVariationsRestService{constructor(e){this.URI=`/cmswebservices/v1/sites/${m.PAGE_CONTEXT_SITE_ID}/catalogs/${m.PAGE_CONTEXT_CATALOG}/versions/${m.PAGE_CONTEXT_CATALOG_VERSION}/pages/:pageId/variations`;this.resource=e.get(this.URI)}getVariationsForPrimaryPageId(e){return this.resource.get({pageId:e}).then((e=>e.uids))}};Ee.$inject=["restServiceFactory"];Ee=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Ee);let Te=class PageTypeService{constructor(e){this.pageTypeRestService=e.get(p.PAGE_TYPES_URI)}getPageTypes(){this.pageTypesResponse=this.pageTypesResponse||this.pageTypeRestService.get();return this.pageTypesResponse.then((e=>e.pageTypes))}};Te.$inject=["restServiceFactory"];Te=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Te);let Pe=class RestrictionTypesRestService{constructor(e){this.restServiceFactory=e;this.restrictionTypesRestService=this.restServiceFactory.get(p.RESTRICTION_TYPES_URI)}getRestrictionTypes(){return this.restrictionTypesRestService.get()}};Pe.$inject=["restServiceFactory"];Pe=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Pe);class ModeManager{constructor(e){this.modes=e}validateMode(e){if(!this.modes.includes(e)){throw new Error(`ModeManager.validateMode() - mode [${e}] not in list of supported modes: ${this.modes}`)}return true}}let Ae=class StructureModeManagerFactory{createModeManager(e){return new ModeManager(e)}};Ae=__decorate([m.SeDowngradeService()],Ae);let Oe=class StructuresRestService{constructor(e){this.TYPE_PLACEHOLDER=":smarteditComponentType";this.URI=`${m.TYPES_RESOURCE_URI}/`;e.register(this.URI,m.OPERATION_CONTEXT.CMS)}getUriForContext(e,t){const o=t||this.TYPE_PLACEHOLDER;const n=`${m.TYPES_RESOURCE_URI}?code=${o}&mode=${e.toUpperCase()}`;return n}};Oe.$inject=["operationContextService"];Oe=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.OperationContextService])],Oe);let xe=class TypeStructureRestService{constructor(e){this.structureRestService=e.get(m.TYPES_RESOURCE_URI)}getStructureByType(e){return this.structureRestService.getById(e).then((e=>e.attributes))}getStructureByTypeAndMode(e,t,o=false){return this.structureRestService.get({code:e,mode:t}).then((e=>{const t=e.componentTypes[0];return!t||o?t:t.attributes}))}getStructuresByCategory(e){return this.structureRestService.get({category:e}).then((e=>e.componentTypes))}};xe.$inject=["restServiceFactory"];xe=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],xe);t.PageRestrictionsService=class PageRestrictionsService{constructor(e){this.pageRestrictionsRestService=e}getPageRestrictionsCountForPageUID(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageRestrictionsRestService.getPagesRestrictionsForPageId(e);return t.pageRestrictionList.length}))}};t.PageRestrictionsService.$inject=["pageRestrictionsRestService"];t.PageRestrictionsService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[Se])],t.PageRestrictionsService);let De=class DisplayConditionsFacade{constructor(e,t,o){this.pageService=e;this.pageRestrictionsService=t;this.logService=o}getPageInfoForPageUid(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.pageService.getPageById(e);const o=this.pageService.isPagePrimary(e);const[n,s]=yield Promise.all([t,o]);return{pageName:n.name,pageType:n.typeCode,isPrimary:s}}))}getVariationsForPageUid(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageService.getVariationPages(e);if(t.length===0){return[]}const o=yield Promise.all(t.map((e=>this.pageRestrictionsService.getPageRestrictionsCountForPageUID(e.uid))));return t.map(((e,t)=>({pageName:e.name,creationDate:e.creationtime,restrictions:o[t]})))}))}updatePage(e,t){return this.pageService.updatePageById(e,t)}isPagePrimary(e){return this.pageService.isPagePrimary(e)}getPrimaryPageForVariationPage(e){return this.pageService.getPrimaryPage(e).then((e=>({uid:e.uid,name:e.name,label:e.label})))}getPrimaryPagesForPageType(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.pageService.getPaginatedPrimaryPagesForPageType(e,t,o);return{pagination:n.pagination,results:n.response.map((e=>({id:e.uid,label:e.name||e.label})))}}catch(e){this.logService.warn(`[getPrimaryPagesForPageType] - Cannot retrieve list of primary pages. ${e}`)}}))}};De.$inject=["pageService","pageRestrictionsService","logService"];De=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IPageService,t.PageRestrictionsService,m.LogService])],De);t.DisplayConditionsEditorModel=class DisplayConditionsEditorModel{constructor(e){this.displayConditionsFacade=e;this.variations=[]}initModel(e){return __awaiter(this,void 0,void 0,(function*(){this.pageUid=e;const t=yield this.displayConditionsFacade.getPageInfoForPageUid(e);({pageName:this.pageName,pageType:this.pageType,isPrimary:this.isPrimary}=t);if(this.isPrimary){return this.initModelForPrimary(e)}return this.initModelForVariation(e)}))}initModelForPrimary(e){return __awaiter(this,void 0,void 0,(function*(){this.variations=yield this.displayConditionsFacade.getVariationsForPageUid(e)}))}initModelForVariation(e){return __awaiter(this,void 0,void 0,(function*(){this.isAssociatedPrimaryReadOnly=this.pageType!=="ContentPage";const t=yield this.displayConditionsFacade.getPrimaryPageForVariationPage(e);this.associatedPrimaryPage=t;this.originalPrimaryPage=t}))}};t.DisplayConditionsEditorModel.$inject=["displayConditionsFacade"];t.DisplayConditionsEditorModel=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[De])],t.DisplayConditionsEditorModel);const Re="CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO";const ke="CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO";(function(e){e["PENDING"]="PENDING";e["NO_HOMEPAGE"]="NO_HOMEPAGE";e["LOCAL"]="LOCAL";e["OLD"]="OLD";e["PARENT"]="PARENT"})(t.CatalogHomepageDetailsStatus||(t.CatalogHomepageDetailsStatus={}));(function(e){e["OLD"]="old";e["CURRENT"]="current";e["FALLBACK"]="fallback"})(t.HomepageType||(t.HomepageType={}));t.HomepageService=class HomepageService{constructor(e,t){this.catalogService=e;this.systemEventService=t}sendEventHideReplaceParentHomePageInfo(e){this.systemEventService.publish(ke,e)}sendEventShowReplaceParentHomePageInfo(e){this.systemEventService.publish(Re,e)}getHomepageDetailsForContext(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.getContentCatalogVersion(e);const o=t.homepage?t.homepage.current:null;return this.buildHomepageDetailsForContext(o,e)}))}isCurrentHomepage(e,o){return this.isHomepageType(e,o,t.HomepageType.CURRENT)}isOldHomepage(e,o){return this.isHomepageType(e,o,t.HomepageType.OLD)}getHomepageType(e,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.catalogService.getContentCatalogVersion(o);if(!n||!n.homepage){return null}if(n.homepage.current&&n.homepage.current.uid===e.uid&&n.homepage.current.catalogVersionUuid===e.catalogVersion){return t.HomepageType.CURRENT}else if(n.homepage.old&&n.homepage.old.uid===e.uid){return this.compareCatalogVersions(n.homepage.old.catalogVersionUuid,e.catalogVersion,((e,o)=>e.catalogId===o.catalogId?t.HomepageType.OLD:null))}else if(n.homepage.fallback&&n.homepage.fallback.uid===e.uid){return this.compareCatalogVersions(n.homepage.fallback.catalogVersionUuid,e.catalogVersion,((e,o)=>e.uuid===o.uuid?t.HomepageType.FALLBACK:null))}return null}))}hasFallbackHomePage(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.getContentCatalogVersion(e);if(!t||!t.homepage){throw Error(`HomepageService.hasFallbackHomePage - Catalog does not have homepage fallback property`)}return!!t.homepage.fallback}))}canSyncHomepage(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.isOldHomepage(e,t);if(!o){return true}const n=yield this.catalogService.getContentCatalogVersion(t);return this.compareCatalogVersions(n.homepage.current.catalogVersionUuid,e.catalogVersion,((t,o)=>e.uid!==n.homepage.current.uid&&t.catalogId!==o.catalogId))}))}compareCatalogVersions(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const[n,s]=yield Promise.all([this.catalogService.getCatalogVersionByUuid(e),this.catalogService.getCatalogVersionByUuid(t)]);return o(n,s)}))}isHomepageType(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.getHomepageType(e,t);return n===o}))}buildHomepageDetailsForContext(e,o){return __awaiter(this,void 0,void 0,(function*(){if(!e){return{status:t.CatalogHomepageDetailsStatus.NO_HOMEPAGE}}const n=yield this.catalogService.getCatalogVersionByUuid(e.catalogVersionUuid);const s=n.catalogId!==o[p.CONTEXT_CATALOG];const a=yield this.catalogService.getContentCatalogVersion(o);if(s){return{status:t.CatalogHomepageDetailsStatus.PARENT,parentCatalogName:n.catalogName,parentCatalogVersion:n.version,targetCatalogName:a.catalogName,targetCatalogVersion:a.version}}return{status:t.CatalogHomepageDetailsStatus.LOCAL,currentHomepageName:e.name,currentHomepageUid:e.uid,oldHomepageUid:n.homepage?n.homepage.old?n.homepage.old.uid:null:null}}))}};t.HomepageService.$inject=["catalogService","systemEventService"];t.HomepageService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ICatalogService,m.SystemEventService])],t.HomepageService);t.PageDisplayConditionsService=class PageDisplayConditionsService{constructor(e){this.catalogService=e}getNewPageConditions(e,t){return this.getPageDisplayConditionsByPageType(e,t)}fetchDisplayConditionsForPageType(e,t){return this.catalogService.getContentCatalogVersion(t).then((t=>t.pageDisplayConditions.find((t=>t.typecode===e))))}getPageDisplayConditionsByPageType(e,t){return this.fetchDisplayConditionsForPageType(e,t).then((e=>{if(!e||!e.options){return[]}return e.options.map((e=>({label:e.label,description:e.label+".description",isPrimary:e.id==="PRIMARY"})))}))}};t.PageDisplayConditionsService.$inject=["catalogService"];t.PageDisplayConditionsService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ICatalogService])],t.PageDisplayConditionsService);t.GenericEditorModalService=class GenericEditorModalService{constructor(e){this.modalService=e}open(e,o,n,s){const a=s?Object.assign({},s):{};a.modalPanelClass=`modal-lg ${a.modalPanelClass||""}`.trimRight();a.escKeyCloseable=false;a.focusTrapped=false;a.backdropClickCloseable=false;const r=this.modalService.open({component:t.GenericEditorModalComponent,data:{data:e,saveCallback:o,errorCallback:n},config:a,templateConfig:{title:e.title,isDismissButtonVisible:true,titleSuffix:"se.cms.editor.title.suffix"}});return new Promise(((e,t)=>r.afterClosed.subscribe(e,t)))}};t.GenericEditorModalService.$inject=["modalService"];t.GenericEditorModalService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IModalService])],t.GenericEditorModalService);t.EditorModalService=class EditorModalService extends m.IEditorModalService{constructor(e,t,o,n,s,a,r){super();this.genericEditorModalService=e;this.componentService=t;this.renderService=o;this.contextAwareEditableItemService=n;this.cmsitemsRestService=s;this.translateService=a;this.genericEditorStackService=r}openAndRerenderSlot(e,t,o,n,s){return __awaiter(this,void 0,void 0,(function*(){const a={smarteditComponentType:e,smarteditComponentUuid:t};const r=yield this.preloadContent(t,a);const d=this.createComponentData(r,{targetedQualifier:o},s||m.stringUtils.generateIdentifier());return this.markAndOpenGenericEditor(d,n)}))}open(e,t,o,n,s,a,r){return __awaiter(this,void 0,void 0,(function*(){const d=yield this.preloadContent(e.smarteditComponentUuid,e);const p=this.createComponentData(d,{slotId:t,position:o,targetedQualifier:n},a||m.stringUtils.generateIdentifier());return this.markAndOpenGenericEditor(p,s,r)}))}openGenericEditor(e,t,o,n){return this.genericEditorModalService.open(e,t,o,n)}preloadContent(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getContentByUuid(e);if(o!==null&&u.isNil(t.content)){t.content=o}return t}))}markAndOpenGenericEditor(e,t,o){return __awaiter(this,void 0,void 0,(function*(){yield this.markComponentAsShared(e.content,e);return this.genericEditorModalService.open(e,(o=>{if(t){t(o)}if(e.editorStackId){const[t]=this.genericEditorStackService.getEditorsStack(e.editorStackId);const{component:{uuid:o}}=t;this.componentService.getSlotsForComponent(o).then((e=>{this.renderService.renderSlots(e)}))}}),null,o)}))}getContentByUuid(e){return __awaiter(this,void 0,void 0,(function*(){if(!u.isNil(e)){return this.cmsitemsRestService.getById(e)}return null}))}markComponentAsShared(e,t){return __awaiter(this,void 0,void 0,(function*(){if(!(e===null||e===void 0?void 0:e.uid)){return}const o=yield this.contextAwareEditableItemService.isItemEditable(e.uid);t.readOnlyMode=!o;if(t.readOnlyMode&&this.componentIsShared(e)){this.addComponentInfoMessage("se.cms.component.workflow.shared.component",t)}else if(this.componentIsShared(e)&&!t.readOnlyMode){this.addComponentInfoMessage("se.cms.component.shared.component",t)}else if(!this.componentIsShared(e)&&t.readOnlyMode){this.addComponentInfoMessage("se.cms.component.workflow.component",t)}}))}componentIsShared(e){var t;return((t=e.slots)===null||t===void 0?void 0:t.length)>1}addComponentInfoMessage(e,t){t.messages=t.messages||[];t.messages.push({type:"info",message:this.translateService.instant(e)})}prepareContentForCreate(e,t,o,n,s){const a=e?Object.assign({},e):{};a.position=!m.stringUtils.isBlank(a.position)?a.position:s;a.slotId=a.slotId||n;a.typeCode=a.typeCode||t;a.itemtype=a.itemtype||t;a.catalogVersion=a.catalogVersion||o;a.visible=!m.stringUtils.isBlank(a.visible)?a.visible:true;return a}createComponentData(e,t,o){let n;try{n=e.smarteditComponentType.toLowerCase()}catch(e){throw new Error(`editorModalService.createComponentData - invalid component type in componentAttributes. ${e}`)}const s=u.isNil(e.smarteditComponentUuid);let a;if(s){a=this.prepareContentForCreate(e.content,e.smarteditComponentType,e.catalogVersionUuid,t.slotId,t.position)}else{a=e.content}return{componentUuid:e.smarteditComponentUuid,componentType:e.smarteditComponentType,title:`type.${n}.name`,targetedQualifier:t.targetedQualifier,initialDirty:e.initialDirty,content:a,editorStackId:o}}};t.EditorModalService.$inject=["genericEditorModalService","componentService","renderService","contextAwareEditableItemService","cmsitemsRestService","translateService","genericEditorStackService"];t.EditorModalService=__decorate([m.SeDowngradeService(m.IEditorModalService),m.GatewayProxied("open","openAndRerenderSlot","openGenericEditor"),__metadata("design:paramtypes",[t.GenericEditorModalService,p.ComponentService,m.IRenderService,p.IContextAwareEditableItemService,m.CmsitemsRestService,v.TranslateService,m.GenericEditorStackService])],t.EditorModalService);t.EditorEnablerService=class EditorEnablerService extends p.IEditorEnablerService{};t.EditorEnablerService=__decorate([m.SeDowngradeService(p.IEditorEnablerService),m.GatewayProxied("onClickEditButton","isSlotEditableForNonExternalComponent")],t.EditorEnablerService);const Me=["typeCode","template","name","description","label","uid","title","fromName","fromEmail"];const Ne=["creationtime","modifiedtime"];t.ContextAwarePageStructureService=class ContextAwarePageStructureService{constructor(e,t){this.typeStructureRestService=e;this.pageService=t}getPageStructureForNewPage(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getFields(e);if(e==="ContentPage"){this.setLabelEditability(o,t)}this.removeField(o,"creationtime");this.removeField(o,"modifiedtime");this.removeField(o,"displayCondition");this.removeField(o,"restrictions");return{attributes:this.getOrderedFields(o),category:p.StructureTypeCategory.PAGE}}))}getPageStructureForPageEditing(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getFields(e);const n=["uid","creationtime","modifiedtime"];o.filter((e=>n.indexOf(e.qualifier)>=0)).forEach((e=>{e.editable=false}));if(e==="ContentPage"){const e=yield this.pageService.isPagePrimary(t);this.setLabelEditability(o,e);return{attributes:this.getOrderedFields(o),category:p.StructureTypeCategory.PAGE}}return{attributes:this.getOrderedFields(o),category:p.StructureTypeCategory.PAGE}}))}getPageStructureForViewing(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getFields(e);t.forEach((e=>{e.editable=false}));this.removeField(t,"typeCode");this.removeField(t,"template");this.removeField(t,"displayCondition");this.removeField(t,"restrictions");return{attributes:this.getOrderedFields(t),category:p.StructureTypeCategory.PAGE}}))}moveElement(e,t,o){if(t<0||t>=e.length||o<0||o>=e.length){return e}e.splice(o,0,e.splice(t,1)[0]);return e}getOrderedFields(e){let t;for(let o=Me.length-1;o>=0;o--){t=e.findIndex((e=>e.qualifier===Me[o]));this.moveElement(e,t,0)}for(let o=0;o<Ne.length;o++){t=e.findIndex((e=>e.qualifier===Ne[o]));this.moveElement(e,t,e.length-1)}return e}setLabelEditability(e,t){const o=e.findIndex((e=>e.qualifier==="label"));if(o!==-1&&e[o].editable!==false){e[o].editable=t}}getFields(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.typeStructureRestService.getStructureByType(e);t.push({cmsStructureType:"DisplayConditionEditor",i18nKey:"type.abstractpage.displayCondition.name",qualifier:"displayCondition",editable:false},{cmsStructureType:"ShortString",i18nKey:"se.cms.pageinfo.page.type",qualifier:"typeCode",editable:false});return t}))}removeField(e,t){const o=e.findIndex((e=>e.qualifier===t));if(o!==-1){e.splice(o,1)}}};t.ContextAwarePageStructureService.$inject=["typeStructureRestService","pageService"];t.ContextAwarePageStructureService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[xe,m.IPageService])],t.ContextAwarePageStructureService);var Fe;const ze="enableCloneComponentOnDrop";t.CmsDragAndDropService=Fe=class CmsDragAndDropService{constructor(e,t,o,n,s){this.dragAndDropService=e;this.gatewayFactory=t;this.sharedDataService=o;this.systemEventService=n;this.yjQuery=s;this.gateway=this.gatewayFactory.createGateway("cmsDragAndDrop")}register(){this.dragAndDropService.register({id:Fe.CMS_DRAG_AND_DROP_ID,sourceSelector:Fe.SOURCE_SELECTOR,targetSelector:Fe.TARGET_SELECTOR,startCallback:e=>this.onStart(e),stopCallback:()=>this.onStop(),enableScrolling:false})}unregister(){this.dragAndDropService.unregister([Fe.CMS_DRAG_AND_DROP_ID])}apply(){this.dragAndDropService.apply(null)}update(){this.dragAndDropService.update(Fe.CMS_DRAG_AND_DROP_ID)}onStart(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.sharedDataService.get(ze);const o=this.getSelector(e.target).closest(Fe.COMPONENT_SELECTOR);const n={componentId:o.attr(m.ID_ATTRIBUTE),componentUuid:o.attr(m.UUID_ATTRIBUTE),componentType:o.attr(m.TYPE_ATTRIBUTE),slotUuid:null,slotId:null,cloneOnDrop:t};this.gateway.publish(p.DRAG_AND_DROP_EVENTS.DRAG_STARTED,n);this.systemEventService.publishAsync(p.DRAG_AND_DROP_EVENTS.DRAG_STARTED)}))}onStop(){this.gateway.publish(p.DRAG_AND_DROP_EVENTS.DRAG_STOPPED,null)}getSelector(e){return this.yjQuery(e)}};t.CmsDragAndDropService.CMS_DRAG_AND_DROP_ID="se.cms.dragAndDrop";t.CmsDragAndDropService.TARGET_SELECTOR="";t.CmsDragAndDropService.SOURCE_SELECTOR=".smartEditComponent[data-smartedit-component-type!='ContentSlot']";t.CmsDragAndDropService.COMPONENT_SELECTOR=".smartEditComponent";t.CmsDragAndDropService=Fe=__decorate([m.SeDowngradeService(),__param(4,s.Inject(m.YJQUERY_TOKEN)),__metadata("design:paramtypes",[m.DragAndDropService,m.GatewayFactory,m.ISharedDataService,m.SystemEventService,Function])],t.CmsDragAndDropService);const Le="/cmssmarteditwebservices/v1/sites/:siteUID/categories";const Ve=`${Le}/:categoryUID`;const Ue="/cmssmarteditwebservices/v1/productcatalogs/:catalogId/versions/:catalogVersion/categories";t.ProductCategoryService=class ProductCategoryService{constructor(e,t){this.languageService=t;this.productCategoryService=e.get(Ve);this.productCategorySearchService=e.get(Ue)}getCategoryById(e,t){return this.productCategoryService.get({siteUID:e,categoryUID:t})}getCategories(e){this._validateProductCatalogInfo(e);return this.languageService.getResolveLocale().then((t=>this.productCategorySearchService.page({catalogId:e.catalogId,catalogVersion:e.catalogVersion,text:e.mask,pageSize:e.pageSize,currentPage:e.currentPage,langIsoCode:t})))}_validateProductCatalogInfo(e){if(!e.siteUID){throw Error("[productService] - site UID missing.")}if(!e.catalogId){throw Error("[productService] - catalog ID missing.")}if(!e.catalogVersion){throw Error("[productService] - catalog version  missing.")}}};t.ProductCategoryService.$inject=["restServiceFactory","languageService"];t.ProductCategoryService=__decorate([m.SeDowngradeService(),s.Injectable(),__metadata("design:paramtypes",[m.RestServiceFactory,m.LanguageService])],t.ProductCategoryService);t.ContextAwareCatalogService=class ContextAwareCatalogService{constructor(e,t){this.catalogService=e;this.sharedDataService=t}getProductCategorySearchUri(e){return this.getSearchUriByProductCatalogIdAndUriConstant(e,Ue)}getProductCategoryItemUri(){return this.getItemUriByUriConstant(Le)}getProductSearchUri(e){return this.getSearchUriByProductCatalogIdAndUriConstant(e,m.PRODUCT_LIST_RESOURCE_API)}getProductItemUri(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getItemUriByUriConstant(m.PRODUCT_RESOURCE_API);return e.replace("/:productUID","")}))}getContentPageSearchUri(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getContentPageUri();return`${e}?typeCode=ContentPage`}))}getContentPageItemUri(){return this.getContentPageUri()}getSearchUriByProductCatalogIdAndUriConstant(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.catalogService.getActiveProductCatalogVersionByCatalogId(e);return t.replace(/:catalogId/gi,e).replace(/:catalogVersion/gi,o)}))}getItemUriByUriConstant(e){return Promise.resolve(e.replace(/:siteUID/gi,"CURRENT_CONTEXT_SITE_ID"))}getContentPageUri(){return __awaiter(this,void 0,void 0,(function*(){const{catalogDescriptor:{catalogId:e}}=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);const t=yield this.catalogService.getActiveContentCatalogVersionByCatalogId(e);return p.PAGES_LIST_RESOURCE_URI.replace(/CURRENT_CONTEXT_CATALOG/gi,e).replace(/CURRENT_CONTEXT_CATALOG_VERSION/gi,t)}))}};t.ContextAwareCatalogService.$inject=["catalogService","sharedDataService"];t.ContextAwareCatalogService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ICatalogService,m.ISharedDataService])],t.ContextAwareCatalogService);t.RulesAndPermissionsRegistrationService=class RulesAndPermissionsRegistrationService{constructor(e,t,o,n,s,a,r,d,p,m,g){this.attributePermissionsRestService=e;this.catalogService=t;this.catalogVersionPermissionService=o;this.catalogVersionRestService=n;this.cMSModesService=s;this.experienceService=a;this.pageService=r;this.permissionService=d;this.sharedDataService=p;this.typePermissionsRestService=m;this.workflowService=g}register(){this.registerRules();this.registerRulesForTypeCodeFromContext();this.registerRulesForCurrentPage();this.registerRulesForTypeCode();this.registerRulesForTypeAndQualifier();this.registerPermissions()}onSuccess(e){return e.every((e=>e))}onError(){return false}getCurrentPageActiveWorkflow(){return __awaiter(this,void 0,void 0,(function*(){if(!m.windowUtils.getGatewayTargetFrame()){return null}const{uuid:e}=yield this.pageService.getCurrentPageInfo();return this.workflowService.getActiveWorkflowForPageUuid(e)}))}registerRules(){this.permissionService.registerRule({names:[ie,oe,ne,se],verify:e=>{const t=e.map((e=>{if(e.context){return this.catalogVersionPermissionService.hasWritePermission(e.context.catalogId,e.context.catalogVersion)}else{return this.catalogVersionPermissionService.hasWritePermissionOnCurrent()}}));return Promise.all(t).then(this.onSuccess,this.onError)}});this.permissionService.registerRule({names:[he],verify:e=>{const isAvailableForCurrentPrincipal=e=>e===null?true:e.isAvailableForCurrentPrincipal;const t=e.map((e=>{if(e.context){return this.workflowService.getActiveWorkflowForPageUuid(e.context.pageInfo.uuid).then((e=>isAvailableForCurrentPrincipal(e)))}else{return this.getCurrentPageActiveWorkflow().then((e=>isAvailableForCurrentPrincipal(e)),(()=>true))}}));return Promise.all(t).then(this.onSuccess,this.onError)}});this.permissionService.registerRule({names:[ve],verify:e=>{const isUserParticipant=e=>__awaiter(this,void 0,void 0,(function*(){return e===null?true:this.workflowService.isUserParticipanInActiveAction(e.workflowCode)}));const t=e.map((e=>{if(e.context){return this.workflowService.getActiveWorkflowForPageUuid(e.context.pageInfo.uuid).then((e=>isUserParticipant(e)))}else{return this.getCurrentPageActiveWorkflow().then((e=>isUserParticipant(e)),(()=>true))}}));return Promise.all(t).then(this.onSuccess,this.onError)}});this.permissionService.registerRule({names:[_e],verify:e=>{const t=e.map((e=>{if(e.context){return this.catalogVersionPermissionService.hasSyncPermission(e.context.catalogId,e.context.catalogVersion,e.context.targetCatalogVersion)}else{return this.catalogVersionPermissionService.hasSyncPermissionFromCurrentToActiveCatalogVersion()}}));return Promise.all(t).then(this.onSuccess,this.onError)}});this.permissionService.registerRule({names:["se.approval.status.page"],verify:()=>__awaiter(this,void 0,void 0,(function*(){const{approvalStatus:e}=yield this.pageService.getCurrentPageInfo();return e==="APPROVED"}))});this.permissionService.registerRule({names:[X,J,ee,te],verify:()=>this.catalogVersionPermissionService.hasReadPermissionOnCurrent()});this.permissionService.registerRule({names:[fe],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);return e.pageContext&&e.pageContext.catalogVersionUuid===e.catalogDescriptor.catalogVersionUuid}))});this.permissionService.registerRule({names:["se.cloneable.page"],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);if(!e.pageContext){return false}const t={CURRENT_CONTEXT_SITE_ID:e.pageContext.siteId,CURRENT_CONTEXT_CATALOG:e.pageContext.catalogId,CURRENT_CONTEXT_CATALOG_VERSION:e.pageContext.catalogVersion};const o=yield this.pageService.getCurrentPageInfo();const n=yield this.catalogVersionRestService.getCloneableTargets(t);if(e.pageContext.active){return n.versions.length>0&&!o.copyToCatalogsDisabled}return n.versions.length>0}))});this.permissionService.registerRule({names:[ae],verify:()=>this.catalogService.isContentCatalogVersionNonActive()});this.permissionService.registerRule({names:[re],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.cMSModesService.isVersioningPerspectiveActive();return!e}))});this.permissionService.registerRule({names:[le],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();return!!e.versionId}))});this.permissionService.registerRule({names:["se.version.page.not.selected"],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();return!e.versionId}))});this.permissionService.registerRule({names:["se.catalogversion.has.workflows.enabled"],verify:()=>this.workflowService.areWorkflowsEnabledOnCurrentCatalogVersion()});this.permissionService.registerRule({names:[ce],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.getCurrentPageActiveWorkflow();return e!==null}))});this.permissionService.registerRule({names:["se.current.page.has.no.active.workflow"],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.getCurrentPageActiveWorkflow();return e===null}))});this.permissionService.registerRule({names:["se.has.change.permission.on.page.approval.status"],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e="approvalStatus";const t=yield this.pageService.getCurrentPageInfo();const o=yield this.attributePermissionsRestService.hasChangePermissionOnAttributesInType(t.typeCode,[e]);return o[e]}))})}registerRulesForTypeCodeFromContext(){const registerTypePermissionRuleForTypeCodeFromContext=(e,t)=>{this.permissionService.registerRule({names:[e],verify:e=>{const o=e.map((e=>t([e.context.typeCode]).then((t=>t[e.context.typeCode]))));return Promise.all(o).then(this.onSuccess,this.onError)}})};registerTypePermissionRuleForTypeCodeFromContext("se.has.change.permissions.on.type",(e=>this.typePermissionsRestService.hasUpdatePermissionForTypes(e)));registerTypePermissionRuleForTypeCodeFromContext("se.has.create.permissions.on.type",(e=>this.typePermissionsRestService.hasCreatePermissionForTypes(e)));registerTypePermissionRuleForTypeCodeFromContext("se.has.remove.permissions.on.type",(e=>this.typePermissionsRestService.hasDeletePermissionForTypes(e)))}registerRulesForCurrentPage(){const registerTypePermissionRuleOnCurrentPage=(e,t)=>{this.permissionService.registerRule({names:[e],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.pageService.getCurrentPageInfo();const o=yield t([e.typeCode]);return o[e.typeCode]}))})};registerTypePermissionRuleOnCurrentPage(de,(e=>this.typePermissionsRestService.hasUpdatePermissionForTypes(e)));registerTypePermissionRuleOnCurrentPage("se.has.create.type.permissions.on.current.page",(e=>this.typePermissionsRestService.hasCreatePermissionForTypes(e)));registerTypePermissionRuleOnCurrentPage(pe,(e=>this.typePermissionsRestService.hasReadPermissionForTypes(e)))}registerRulesForTypeCode(){const registerTypePermissionRuleForTypeCode=(e,t,o)=>{this.permissionService.registerRule({names:[e],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield o([t]);return e[t]}))})};registerTypePermissionRuleForTypeCode(me,"CMSVersion",(e=>this.typePermissionsRestService.hasReadPermissionForTypes(e)));registerTypePermissionRuleForTypeCode(ge,"CMSVersion",(e=>this.typePermissionsRestService.hasCreatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.remove.permission.on.version.type","CMSVersion",(e=>this.typePermissionsRestService.hasDeletePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.change.permission.on.version.type","CMSVersion",(e=>this.typePermissionsRestService.hasUpdatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.create.permission.on.abstractcomponent.type","AbstractCMSComponent",(e=>this.typePermissionsRestService.hasCreatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.change.permission.on.contentslotforpage.type","ContentSlotForPage",(e=>this.typePermissionsRestService.hasUpdatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.create.permission.on.workflow.type","Workflow",(e=>this.typePermissionsRestService.hasCreatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode(ue,"Workflow",(e=>this.typePermissionsRestService.hasUpdatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.read.permission.on.workflow.type","Workflow",(e=>this.typePermissionsRestService.hasReadPermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.create.permission.on.contentslot.type","ContentSlot",(e=>this.typePermissionsRestService.hasCreatePermissionForTypes(e)));registerTypePermissionRuleForTypeCode("se.has.delete.permission.on.contentslot.type","ContentSlot",(e=>this.typePermissionsRestService.hasDeletePermissionForTypes(e)))}registerRulesForTypeAndQualifier(){const registerAttributePermissionRuleForTypeAndQualifier=(e,t,o,n)=>{this.permissionService.registerRule({names:[e],verify:()=>__awaiter(this,void 0,void 0,(function*(){const e=yield n(t,[o]);return e[o]}))})};registerAttributePermissionRuleForTypeAndQualifier("se.has.change.permission.on.workflow.status","Workflow","status",((e,t)=>this.attributePermissionsRestService.hasChangePermissionOnAttributesInType(e,t)));registerAttributePermissionRuleForTypeAndQualifier("se.has.change.permission.on.workflow.description","Workflow","description",((e,t)=>this.attributePermissionsRestService.hasChangePermissionOnAttributesInType(e,t)))}registerPermissions(){this.permissionService.registerPermission({aliases:["se.add.component"],rules:[oe,ne,fe,de,he,ve,"se.has.create.permission.on.abstractcomponent.type"]});this.permissionService.registerPermission({aliases:[X],rules:[X]});this.permissionService.registerPermission({aliases:["se.edit.page"],rules:[ie,he]});this.permissionService.registerPermission({aliases:[_e],rules:[_e]});this.permissionService.registerPermission({aliases:["se.sync.slot.context.menu","se.sync.slot.indicator"],rules:[_e,fe,he]});this.permissionService.registerPermission({aliases:["se.sync.page"],rules:[fe,he]});this.permissionService.registerPermission({aliases:["se.edit.navigation"],rules:[ne]});this.permissionService.registerPermission({aliases:["se.context.menu.remove.component"],rules:[oe,fe,he,ve]});this.permissionService.registerPermission({aliases:["se.slot.context.menu.shared.icon","se.slot.context.menu.unshared.icon"],rules:["se.read.slot",he,ve]});this.permissionService.registerPermission({aliases:["se.slot.context.menu.visibility"],rules:[fe]});this.permissionService.registerPermission({aliases:["se.clone.page"],rules:["se.cloneable.page","se.has.create.type.permissions.on.current.page"]});this.permissionService.registerPermission({aliases:["se.context.menu.edit.component"],rules:[ne,fe,he]});this.permissionService.registerPermission({aliases:["se.context.menu.drag.and.drop.component"],rules:[oe,ne,fe,he,ve,"se.has.change.permission.on.contentslotforpage.type"]});this.permissionService.registerPermission({aliases:["se.edit.page.link","se.delete.page.menu"],rules:[ie,fe,re,de,he]});this.permissionService.registerPermission({aliases:["se.shared.slot.override.options"],rules:[ie,fe,re,he,"se.has.create.permission.on.contentslot.type"]});this.permissionService.registerPermission({aliases:["se.revert.to.global.or.shared.slot.link"],rules:[ie,fe,re,he,"se.has.delete.permission.on.contentslot.type"]});this.permissionService.registerPermission({aliases:["se.clone.component"],rules:[ne,fe,he,ve]});this.permissionService.registerPermission({aliases:["se.edit.page.type","se.delete.page.type","se.restore.page.type"],rules:["se.has.change.permissions.on.type"]});this.permissionService.registerPermission({aliases:["se.clone.page.type"],rules:["se.has.create.permissions.on.type"]});this.permissionService.registerPermission({aliases:["se.permanently.delete.page.type"],rules:["se.has.remove.permissions.on.type"]});this.permissionService.registerPermission({aliases:["se.version.page"],rules:[ie,fe,ae,me,pe]});this.permissionService.registerPermission({aliases:["se.edit.version.page"],rules:["se.write.to.current.catalog.version","se.has.change.permission.on.version.type",he]});this.permissionService.registerPermission({aliases:["se.create.version.page"],rules:["se.version.page.not.selected",fe,ge,pe]});const e=[le,fe,me,ge,de];this.permissionService.registerPermission({aliases:["se.rollback.version.page"],rules:e});this.permissionService.registerPermission({aliases:["se.rollback.version.page.versions.menu"],rules:e.filter((e=>e!==le))});this.permissionService.registerPermission({aliases:["se.delete.version.page"],rules:["se.has.remove.permission.on.version.type"]});this.permissionService.registerPermission({aliases:["se.start.page.workflow"],rules:["se.has.create.permission.on.workflow.type","se.catalogversion.has.workflows.enabled","se.current.page.has.no.active.workflow"]});this.permissionService.registerPermission({aliases:["se.view.page.workflowMenu"],rules:["se.has.read.permission.on.workflow.type",ce]});this.permissionService.registerPermission({aliases:["se.cancel.page.workflowMenu"],rules:[ue,ce,"se.has.change.permission.on.workflow.status"]});this.permissionService.registerPermission({aliases:["se.edit.workflow.workflowMenu"],rules:[ue,ce,"se.has.change.permission.on.workflow.description"]});this.permissionService.registerPermission({aliases:["se.force.page.approval"],rules:[_e,"se.has.change.permission.on.page.approval.status",fe]});this.permissionService.registerPermission({aliases:["se.show.page.status"],rules:[ae,fe]});this.permissionService.registerPermission({aliases:["se.act.on.page.in.workflow"],rules:[he]})}};t.RulesAndPermissionsRegistrationService.$inject=["attributePermissionsRestService","catalogService","catalogVersionPermissionService","catalogVersionRestService","cMSModesService","experienceService","pageService","permissionService","sharedDataService","typePermissionsRestService","workflowService"];t.RulesAndPermissionsRegistrationService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[p.AttributePermissionsRestService,m.ICatalogService,m.ICatalogVersionPermissionService,ye,m.CMSModesService,m.IExperienceService,m.IPageService,m.IPermissionService,m.ISharedDataService,p.TypePermissionsRestService,m.WorkflowService])],t.RulesAndPermissionsRegistrationService);t.ContextAwareEditableItemService=class ContextAwareEditableItemService extends p.IContextAwareEditableItemService{constructor(e,t){super();this.workflowService=e;this.pageService=t}isItemEditable(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowService.getWorkflowEditableItems([e]);const o=t.find((t=>t.uid===e));if(o.editableInWorkflow){const e=yield this.editableInCurrentPageContext(o.editableInWorkflow);return o.editableByUser&&e}return o.editableByUser}))}editableInCurrentPageContext(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.pageService.getCurrentPageInfo();const o=yield this.workflowService.getActiveWorkflowForPageUuid(t.uid);return o!==null&&o.workflowCode===e}catch(e){return true}}))}};t.ContextAwareEditableItemService.$inject=["workflowService","pageService"];t.ContextAwareEditableItemService=__decorate([m.SeDowngradeService(p.IContextAwareEditableItemService),m.GatewayProxied(),__metadata("design:paramtypes",[m.WorkflowService,m.IPageService])],t.ContextAwareEditableItemService);t.ExperienceGuard=class ExperienceGuard{constructor(e,t){this.catalogAwareRouteResolverHelper=e;this.routing=t}canActivate(e){return this.catalogAwareRouteResolverHelper.experienceFromPathResolve(e.params).catch((()=>{this.routing.go(m.NG_ROUTE_PREFIX);return false}))}};t.ExperienceGuard.$inject=["catalogAwareRouteResolverHelper","routing"];t.ExperienceGuard=__decorate([s.Injectable(),__metadata("design:paramtypes",[b.CatalogAwareRouteResolverHelper,m.SmarteditRoutingService])],t.ExperienceGuard);t.PageRestrictionsCriteriaService=class PageRestrictionsCriteriaService{constructor(){this.ALL={};this.ANY={};this.restrictionCriteriaOptions=[this.ALL,this.ANY];this.setupCriteria(this.ALL,"all",false);this.setupCriteria(this.ANY,"any",true)}getMatchCriteriaLabel(e){if(e){return this.ANY.label}return this.ALL.label}getRestrictionCriteriaOptions(){return this.restrictionCriteriaOptions}getRestrictionCriteriaOptionFromPage(e){if(e&&typeof e.onlyOneRestrictionMustApply==="boolean"){if(e.onlyOneRestrictionMustApply){return this.ANY}}return this.ALL}setupCriteria(e,t,o){Object.defineProperty(e,"id",{writable:false,value:t});Object.defineProperty(e,"label",{writable:false,value:"se.cms.restrictions.criteria."+t});Object.defineProperty(e,"editLabel",{writable:false,value:"se.cms.restrictions.criteria.select."+t});Object.defineProperty(e,"value",{writable:false,value:o})}};t.PageRestrictionsCriteriaService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[])],t.PageRestrictionsCriteriaService);t.PageTypesRestrictionTypesService=class PageTypesRestrictionTypesService{constructor(e){this.pageTypesRestrictionTypesRestService=e}getRestrictionTypeCodesForPageType(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getPageTypesRestrictionTypes();return t.filter((t=>t.pageType===e)).map((e=>e.restrictionType))}))}getPageTypesRestrictionTypes(){if(this.cache){return this.cache}else{this.cache=this.pageTypesRestrictionTypesRestService.getPageTypesRestrictionTypes().then((e=>e.pageTypeRestrictionTypeList))}return this.cache}};t.PageTypesRestrictionTypesService.$inject=["pageTypesRestrictionTypesRestService"];t.PageTypesRestrictionTypesService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[Ce])],t.PageTypesRestrictionTypesService);t.RestrictionTypesService=class RestrictionTypesService{constructor(e,t){this.pageTypesRestrictionTypesService=e;this.restrictionTypesRestService=t}getRestrictionTypesByPageType(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getRestrictionTypes();const o=yield this.pageTypesRestrictionTypesService.getRestrictionTypeCodesForPageType(e);return t.filter((e=>o.indexOf(e.code)>=0))}))}getRestrictionTypeForTypeCode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getRestrictionTypes();return t.find((t=>t.code===e))}))}getRestrictionTypes(){if(this.cache){return this.cache}else{this.cache=this.restrictionTypesRestService.getRestrictionTypes().then((e=>e.restrictionTypes))}return this.cache}};t.RestrictionTypesService.$inject=["pageTypesRestrictionTypesService","restrictionTypesRestService"];t.RestrictionTypesService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.PageTypesRestrictionTypesService,Pe])],t.RestrictionTypesService);const je=[{subject:"name",errorCode:"field.already.exist",structure:{cmsStructureType:"ShortString",collection:false,editable:true,i18nKey:"type.cmsitem.name.name",localized:false,paged:false,qualifier:"name",required:true}},{subject:"label",errorCode:"default.page.label.already.exist",structure:{cmsStructureType:"DuplicatePrimaryContentPage",collection:false,editable:true,i18nKey:"se.cms.page.restore.content.duplicate.primaryforvariation.label",localized:false,paged:false,qualifier:"label",required:true}},{subject:"label",errorCode:"default.page.does.not.exist",structure:{cmsStructureType:"MissingPrimaryContentPage",collection:false,editable:true,i18nKey:"se.cms.page.restore.content.noprimaryforvariation.label",localized:false,paged:false,qualifier:"label",required:true}},{subject:"typeCode",errorCode:"default.page.already.exist",structure:{cmsStructureType:"DuplicatePrimaryNonContentPageMessage",collection:false,editable:true,i18nKey:"type.cmsitem.label.name",localized:false,paged:false,qualifier:"replace",required:true}}];const $e=[{subject:"typeCode",errorCode:"default.page.does.not.exist",messageKey:"se.cms.page.restore.noprimaryforvariation.error"}];t.PageRestoreModalService=class PageRestoreModalService{constructor(e,t,o,n,s,a){this.alertService=e;this.confirmationModalService=t;this.genericEditorModalService=o;this.crossFrameEventService=n;this.pageRestoredAlertService=s;this.translate=a}handleRestoreValidationErrors(e,t){const o=this.getActionableErrors(t);const n=this.getNonActionableError(t);const s=u.difference(t,o,n);if(s.length>0){this.showErrorAlert(s)}else if(n.length>0){this.showConfirmationMessage(n)}else{this.showRestoreEditor(e,o).then((()=>{this.crossFrameEventService.publish(m.EVENT_CONTENT_CATALOG_UPDATE)}))}}showRestoreEditor(e,t){let o=this.getRestoreEditorStructureFields(t);const n={content:e,title:"se.cms.page.restore.page.title",componentId:e.uid,componentUuid:e.uuid,componentType:e.typeCode,structure:this.buildStructure(o)};this.forceErrorsDisplayInEditor(e.componentUuid,t);return this.genericEditorModalService.open(n,(()=>{this.pageRestoredAlertService.displayPageRestoredSuccessAlert(e);this.crossFrameEventService.publish(m.EVENTS.PAGE_RESTORED)}),((t,n)=>{const s=this.getActionableErrors(t);const a=u.difference(t,s);if(a.length>0){this.showErrorAlert(a)}else{o=u.concat(o,this.getRestoreEditorStructureFields(t));n.structure=this.buildStructure(o);this.forceErrorsDisplayInEditor(e.componentUuid,t)}}),{modalPanelClass:"modal-stretched"})}forceErrorsDisplayInEditor(e,t){setTimeout((()=>{this.crossFrameEventService.publish(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,{messages:t,targetGenericEditorId:e})}),0)}buildStructure(e){return{attributes:e,category:"PAGE"}}getRestoreEditorStructureFields(e){return e.reduce(((e,t)=>{const o=je.find((e=>this.isSupportedError(t)&&this.isEqualTo(t,e)));e.push(o.structure);return e}),[])}showConfirmationMessage(e){const t=e.reduce(((e,t)=>{const o=$e.find((e=>this.isSupportedError(t)&&this.isEqualTo(t,e)));return e+this.translate.instant(o.messageKey)+" "}),"");const o={description:t.trim(),showOkButtonOnly:true,title:"se.cms.page.restore.error.confirmationmodal.title"};this.confirmationModalService.confirm(o)}showErrorAlert(e){const t=e.reduce(((e,t)=>e+t.message+" "),"");this.alertService.showDanger(t.trim())}getActionableErrors(e){return e.filter((e=>je.some((t=>this.isSupportedError(e)&&this.isEqualTo(e,t)))))}getNonActionableError(e){return e.filter((e=>$e.some((t=>this.isSupportedError(e)&&this.isEqualTo(e,t)))))}isSupportedError(e){return e.type==="ValidationError"}isEqualTo(e,t){return e.subject===t.subject&&e.errorCode===t.errorCode}};t.PageRestoreModalService.$inject=["alertService","confirmationModalService","genericEditorModalService","crossFrameEventService","pageRestoredAlertService","translate"];t.PageRestoreModalService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IAlertService,m.IConfirmationModalService,t.GenericEditorModalService,m.CrossFrameEventService,t.PageRestoredAlertService,v.TranslateService])],t.PageRestoreModalService);t.PageService=class PageService extends m.IPageService{constructor(e,t,o,n,s,a,r){super();this.pagesRestService=e;this.pagesFallbacksRestService=t;this.pagesVariationsRestService=o;this.pageInfoService=n;this.cmsitemsRestService=s;this.experienceService=a;this.urlService=r}getPageByUuid(e){return this.cmsitemsRestService.getById(e)}getCurrentPageInfo(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUUID();return this.cmsitemsRestService.getById(e)}))}getPageById(e){return this.pagesRestService.getById(e)}getCurrentPageInfoByVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageInfoService.getPageUUID();return this.cmsitemsRestService.getByIdAndVersion(t,e)}))}primaryPageForPageTypeExists(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getPaginatedPrimaryPagesForPageType(e,t,{search:null,pageSize:1,currentPage:0});return o.response.length>0}))}getPaginatedPrimaryPagesForPageType(e,t,o){const n="defaultPage:true,pageStatus:ACTIVE";const s=u.assign({},t||{},o||{},{typeCode:e,itemSearchParams:n});if(s.search){s.mask=s.search;delete s.search}if(!u.isNumber(s.pageSize)){s.pageSize=10}if(!u.isNumber(s.currentPage)){s.currentPage=0}return this.cmsitemsRestService.get(s)}isPagePrimary(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pagesFallbacksRestService.getFallbacksForPageId(e);return t.length===0}))}isPagePrimaryWithContext(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.pagesFallbacksRestService.getFallbacksForPageIdAndContext(e,t);return o.length===0}))}getPrimaryPage(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pagesFallbacksRestService.getFallbacksForPageId(e);return t[0]?this.pagesRestService.getById(t[0]):Promise.resolve(null)}))}getVariationPages(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pagesVariationsRestService.getVariationsForPrimaryPageId(e);return t.length>0?this.pagesRestService.get(t):Promise.resolve([])}))}updatePageById(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.pagesRestService.getById(e);const n=m.objectUtils.copy(o);t=Object.assign(Object.assign({},n),t);return this.pagesRestService.update(e,t)}))}forcePageApprovalStatus(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getCurrentPageInfo();const o=Object.assign({},t);o.approvalStatus=e;o.identifier=t.uuid;return this.cmsitemsRestService.update(o)}))}isPageApproved(e){return __awaiter(this,void 0,void 0,(function*(){let t;if(typeof e==="string"){t=yield this.getPageByUuid(e)}else{t=e}return t.approvalStatus===m.CmsApprovalStatus.APPROVED}))}buildUriContextForCurrentPage(e,t,o){return __awaiter(this,void 0,void 0,(function*(){let n={};if(e&&t&&o){n=this.urlService.buildUriContext(e,t,o)}if(!u.isEmpty(n)){return n}const s=yield this.experienceService.getCurrentExperience();return this.urlService.buildUriContext(s.pageContext.siteId,s.pageContext.catalogId,s.pageContext.catalogVersion)}))}};t.PageService.$inject=["pagesRestService","pagesFallbacksRestService","pagesVariationsRestService","pageInfoService","cmsitemsRestService","experienceService","urlService"];__decorate([m.Cached({actions:[m.rarelyChangingContent],tags:[m.pageEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],t.PageService.prototype,"getPageByUuid",null);__decorate([m.Cached({actions:[m.rarelyChangingContent],tags:[m.pageEvictionTag,m.pageChangeEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",Promise)],t.PageService.prototype,"getCurrentPageInfo",null);t.PageService=__decorate([m.SeDowngradeService(m.IPageService),m.GatewayProxied(),__metadata("design:paramtypes",[we,Ie,Ee,m.IPageInfoService,m.CmsitemsRestService,m.IExperienceService,m.IUrlService])],t.PageService);let Be=class PageFacade{constructor(e,t,o,n,s){this.cmsitemsRestService=e;this.crossFrameEventService=t;this.sharedDataService=o;this.urlService=n;this.catalogService=s}contentPageWithLabelExists(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n={pageSize:10,currentPage:0,typeCode:"ContentPage",itemSearchParams:"label:"+e,catalogId:t,catalogVersion:o};const s=yield this.cmsitemsRestService.get(n);return s&&!u.isEmpty(s.response)}))}retrievePageUriContext(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);if(!e){throw new Error("pageFacade - could not retrieve an experience from sharedDataService")}if(!e.pageContext){return null}return this.urlService.buildUriContext(e.pageContext.siteId,e.pageContext.catalogId,e.pageContext.catalogVersion)}))}createPage(e){return __awaiter(this,void 0,void 0,(function*(){if(!e.catalogVersion){e.catalogVersion=yield this.catalogService.getCatalogVersionUUid()}if(e.onlyOneRestrictionMustApply===undefined){e.onlyOneRestrictionMustApply=false}if(e.restrictions===undefined){e.restrictions=[]}const t=yield this.cmsitemsRestService.create(e);this.crossFrameEventService.publish(m.EVENTS.PAGE_CREATED,e);return t}))}createPageForSite(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.catalogService.getCatalogVersionUUid();e.catalogVersion=e.catalogVersion||o;if(e.onlyOneRestrictionMustApply===undefined){e.onlyOneRestrictionMustApply=false}e=u.cloneDeep(e);e[p.CONTEXT_SITE_ID]=t;const n=yield this.cmsitemsRestService.create(e);this.crossFrameEventService.publish(m.EVENTS.PAGE_CREATED,e);return n}))}};Be.$inject=["cmsitemsRestService","crossFrameEventService","sharedDataService","urlService","catalogService"];Be=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.CmsitemsRestService,m.CrossFrameEventService,m.ISharedDataService,m.IUrlService,m.ICatalogService])],Be);class PageBuilder{constructor(e,t,o,n){this.catalogService=e;this.contextAwarePageStructureService=t;this.restrictionsStepHandler=o;this.uriContext=n;this.model={};this.page={restrictions:[]};this.catalogService.getCatalogVersionUUid(this.uriContext).then((e=>{this.page.catalogVersion=e}))}pageTypeSelected(e){this.model.pageType=e;this.model.pageTemplate=null;return this.updatePageInfoFields()}pageTemplateSelected(e){this.model.pageTemplate=e}getPageTypeCode(){var e;return((e=this.model.pageType)===null||e===void 0?void 0:e.code)||null}getTemplateUuid(){var e;return((e=this.model.pageTemplate)===null||e===void 0?void 0:e.uuid)||""}getPage(){var e,t;this.page.typeCode=this.getPageTypeCode();this.page.itemtype=this.page.typeCode;this.page.type=((e=this.model.pageType)===null||e===void 0?void 0:e.type)||null;this.page.masterTemplate=this.getTemplateUuid()||null;this.page.template=((t=this.model.pageTemplate)===null||t===void 0?void 0:t.uid)||null;return this.page}getPageRestrictions(){return this.page.restrictions}setPageUid(e){this.page.uid=e}setRestrictions(e,t){this.page.onlyOneRestrictionMustApply=e;this.page.restrictions=t}getPageInfoStructure(){return this.model.pageInfoFields}displayConditionSelected(e){const t=e.isPrimary;this.page.defaultPage=t;this.page.homepage=e.homepage;if(t){this.page.label=null;this.restrictionsStepHandler.hideStep()}else{this.page.label=e.primaryPage?e.primaryPage.label:"";this.restrictionsStepHandler.showStep()}return this.updatePageInfoFields()}updatePageInfoFields(){return __awaiter(this,void 0,void 0,(function*(){if(this.page.defaultPage!==undefined){if(this.model.pageType){const e=yield this.contextAwarePageStructureService.getPageStructureForNewPage(this.model.pageType.code,this.page.defaultPage);this.model.pageInfoFields=e}else{this.model.pageInfoFields={}}}}))}}let Ge=class PageBuilderFactory{constructor(e,t){this.catalogService=e;this.contextAwarePageStructureService=t}createPageBuilder(e,t){return new PageBuilder(this.catalogService,this.contextAwarePageStructureService,e,t)}};Ge.$inject=["catalogService","contextAwarePageStructureService"];Ge=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ICatalogService,t.ContextAwarePageStructureService])],Ge);class RestrictionsStepHandler{constructor(e,t,o){this.wizardManager=e;this.restrictionsEditorFunctionBindings=t;this.stepDetails=o}hideStep(){if(this.isStepOnWizard()){this.wizardManager.removeStepById(this.getStepId())}}showStep(){if(!this.isStepOnWizard()){this.wizardManager.addStep(this.stepDetails,this.wizardManager.getStepsCount())}}isStepValid(){return this.restrictionsEditorFunctionBindings.isDirty&&this.restrictionsEditorFunctionBindings.isDirty()}getStepId(){return this.stepDetails.id}goToStep(){this.wizardManager.goToStepWithId(this.getStepId())}isStepOnWizard(){return this.wizardManager.containsStep(this.getStepId())}}t.RestrictionsStepHandlerFactory=class RestrictionsStepHandlerFactory{createRestrictionsStepHandler(e,t,o){return new RestrictionsStepHandler(e,t,o)}};t.RestrictionsStepHandlerFactory=__decorate([m.SeDowngradeService()],t.RestrictionsStepHandlerFactory);t.RestrictionsService=class RestrictionsService{constructor(e,t,o){this.structuresRestService=e;this.typeStructureRestService=t;this.modeManager=o.createModeManager(["add","edit","create"])}getStructureApiUri(e){this.modeManager.validateMode(e);return this.structuresRestService.getUriForContext(e)}getSupportedRestrictionTypeCodes(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.typeStructureRestService.getStructuresByCategory(p.StructureTypeCategory.RESTRICTION);return e.map((e=>e.code))}))}};t.RestrictionsService.$inject=["structuresRestService","typeStructureRestService","structureModeManagerFactory"];t.RestrictionsService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[Oe,xe,Ae])],t.RestrictionsService);window.__smartedit__.addDecoratorPayload("Component","PageTypeStepComponent",{selector:"se-page-type-step",template:`\n        <se-select-page-type\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            (onTypeSelected)="wizardApi.typeSelected($event)"\n        >\n        </se-select-page-type>\n    `});let He=class PageTypeStepComponent{constructor(e){this.wizardApi=e}};He.$inject=["wizardApi"];He=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-type-step",template:`\n        <se-select-page-type\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            (onTypeSelected)="wizardApi.typeSelected($event)"\n        >\n        </se-select-page-type>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],He);window.__smartedit__.addDecoratorPayload("Component","PageTemplateStepComponent",{selector:"se-page-template-step",template:`\n        <se-select-page-template\n            [uriContext]="wizardApi.uriContext"\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            (onTemplateSelected)="wizardApi.templateSelected($event)"\n        >\n        </se-select-page-template>\n    `});let We=class PageTemplateStepComponent{constructor(e){this.wizardApi=e}};We.$inject=["wizardApi"];We=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-template-step",template:`\n        <se-select-page-template\n            [uriContext]="wizardApi.uriContext"\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            (onTemplateSelected)="wizardApi.templateSelected($event)"\n        >\n        </se-select-page-template>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],We);window.__smartedit__.addDecoratorPayload("Component","PageInfoStepComponent",{selector:"se-page-info-step",template:`\n        <span *ngIf="wizardApi.isPageInfoActive()">\n            <se-generic-editor\n                [structure]="wizardApi.getPageInfoStructure()"\n                [content]="wizardApi.getPageInfo()"\n                [(submit)]="wizardApi.callbacks.savePageInfo"\n                [(reset)]="wizardApi.callbacks.resetPageInfo"\n                [(isDirty)]="wizardApi.callbacks.isDirtyPageInfo"\n                [(isValid)]="wizardApi.callbacks.isValidPageInfo"\n            >\n            </se-generic-editor>\n        </span>\n    `});let qe=class PageInfoStepComponent{constructor(e){this.wizardApi=e}};qe.$inject=["wizardApi"];qe=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-info-step",template:`\n        <span *ngIf="wizardApi.isPageInfoActive()">\n            <se-generic-editor\n                [structure]="wizardApi.getPageInfoStructure()"\n                [content]="wizardApi.getPageInfo()"\n                [(submit)]="wizardApi.callbacks.savePageInfo"\n                [(reset)]="wizardApi.callbacks.resetPageInfo"\n                [(isDirty)]="wizardApi.callbacks.isDirtyPageInfo"\n                [(isValid)]="wizardApi.callbacks.isValidPageInfo"\n            >\n            </se-generic-editor>\n        </span>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],qe);window.__smartedit__.addDecoratorPayload("Component","PageDisplayConditionStepComponent",{selector:"se-page-condition-step",template:`\n        <se-event-message\n            class="existing-homepage__ymessage"\n            [showEvent]="'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO'"\n            [hideEvent]="'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO'"\n        >\n        </se-event-message>\n\n        <se-new-page-display-condition\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [uriContext]="wizardApi.uriContext"\n            [resultFn]="wizardApi.variationResult"\n        ></se-new-page-display-condition>\n    `});let Ke=class PageDisplayConditionStepComponent{constructor(e){this.wizardApi=e}};Ke.$inject=["wizardApi"];Ke=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-condition-step",template:`\n        <se-event-message\n            class="existing-homepage__ymessage"\n            [showEvent]="'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO'"\n            [hideEvent]="'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO'"\n        >\n        </se-event-message>\n\n        <se-new-page-display-condition\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [uriContext]="wizardApi.uriContext"\n            [resultFn]="wizardApi.variationResult"\n        ></se-new-page-display-condition>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],Ke);window.__smartedit__.addDecoratorPayload("Component","PageRestrictionsStepComponent",{selector:"se-page-restrictions-step",template:`\n        <span *ngIf="wizardApi.isRestrictionsActive()" class="se-create-page-restriction-step">\n            <div *ngIf="wizardApi.getPageRestrictions().length > 1">\n                <se-page-restrictions-info-message></se-page-restrictions-info-message>\n            </div>\n            <se-restrictions-editor\n                [editable]="true"\n                [(resetFn)]="wizardApi.restrictionsEditorFunctionBindings.reset"\n                [(cancelFn)]="wizardApi.restrictionsEditorFunctionBindings.cancel"\n                [(isDirtyFn)]="wizardApi.restrictionsEditorFunctionBindings.isDirty"\n                (onRestrictionsChange)="wizardApi.restrictionsResult($event)"\n                [getRestrictionTypes]="wizardApi.getRestrictionTypes"\n                [getSupportedRestrictionTypes]="wizardApi.getSupportedRestrictionTypes"\n                [item]="wizardApi.getPageInfo()"\n                [restrictionUuids]="wizardApi.getPageRestrictions()"\n            >\n            </se-restrictions-editor>\n        </span>\n    `});let Ye=class PageRestrictionsStepComponent{constructor(e){this.wizardApi=e}};Ye.$inject=["wizardApi"];Ye=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-restrictions-step",template:`\n        <span *ngIf="wizardApi.isRestrictionsActive()" class="se-create-page-restriction-step">\n            <div *ngIf="wizardApi.getPageRestrictions().length > 1">\n                <se-page-restrictions-info-message></se-page-restrictions-info-message>\n            </div>\n            <se-restrictions-editor\n                [editable]="true"\n                [(resetFn)]="wizardApi.restrictionsEditorFunctionBindings.reset"\n                [(cancelFn)]="wizardApi.restrictionsEditorFunctionBindings.cancel"\n                [(isDirtyFn)]="wizardApi.restrictionsEditorFunctionBindings.isDirty"\n                (onRestrictionsChange)="wizardApi.restrictionsResult($event)"\n                [getRestrictionTypes]="wizardApi.getRestrictionTypes"\n                [getSupportedRestrictionTypes]="wizardApi.getSupportedRestrictionTypes"\n                [item]="wizardApi.getPageInfo()"\n                [restrictionUuids]="wizardApi.getPageRestrictions()"\n            >\n            </se-restrictions-editor>\n        </span>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],Ye);window.__smartedit__.addDecoratorPayload("Component","AddPageWizardComponent",{selector:"se-add-page-wizard",template:""});let Ze=class AddPageWizardComponent{constructor(e,t,o,n,s,a,r,d,p){this.wizardManager=e;this.pageBuilderFactory=t;this.restrictionsStepHandlerFactory=o;this.experienceService=n;this.confirmationModalService=s;this.systemEventService=a;this.restrictionTypesService=r;this.restrictionsService=d;this.pageFacade=p;this.getWizardConfig=()=>({isFormValid:e=>this.isFormValid(e),onNext:()=>this.onNext(),onDone:()=>this.onDone(),onCancel:()=>this.onCancel(),steps:[{id:this.ADD_PAGE_WIZARD_STEPS.PAGE_TYPE,name:"se.cms.addpagewizard.pagetype.tabname",title:"se.cms.addpagewizard.pagetype.title",component:He},{id:this.ADD_PAGE_WIZARD_STEPS.PAGE_TEMPLATE,name:"se.cms.addpagewizard.pagetemplate.tabname",title:"se.cms.addpagewizard.pagetype.title",component:We},{id:this.ADD_PAGE_WIZARD_STEPS.PAGE_DISPLAY_CONDITION,name:"se.cms.addpagewizard.pageconditions.tabname",title:"se.cms.addpagewizard.pagetype.title",component:Ke},{id:this.ADD_PAGE_WIZARD_STEPS.PAGE_INFO,name:"se.cms.addpagewizard.pageinfo.tabname",title:"se.cms.addpagewizard.pagetype.title",component:qe}]});this.getRestrictionTypes=()=>this.restrictionTypesService.getRestrictionTypesByPageType(this.getPageTypeCode());this.getSupportedRestrictionTypes=()=>this.restrictionsService.getSupportedRestrictionTypeCodes();this.variationResult=e=>{this.pageBuilder.displayConditionSelected(e)};const m={};this.uriContext=this.wizardManager.properties.uriContext;this.callbacks={};this.restrictionStepProperties={id:"restrictionsStepId",name:"se.cms.restrictions.editor.tab",title:"se.cms.addpagewizard.pagetype.title",component:Ye};this.restrictionsEditorFunctionBindings=m;this.restrictionsStepHandler=this.restrictionsStepHandlerFactory.createRestrictionsStepHandler(this.wizardManager,m,this.restrictionStepProperties);this.pageBuilder=this.pageBuilderFactory.createPageBuilder(this.restrictionsStepHandler,this.uriContext);this.saveInProgress=false;this.typeChanged=true;this.ADD_PAGE_WIZARD_STEPS={PAGE_TYPE:"pageType",PAGE_TEMPLATE:"pageTemplate",PAGE_DISPLAY_CONDITION:"pageDisplayCondition",PAGE_INFO:"pageInfo",PAGE_RESTRICTIONS:this.restrictionsStepHandler.getStepId()}}typeSelected(e){this.typeChanged=true;this.pageBuilder.pageTypeSelected(e)}templateSelected(e){this.pageBuilder.pageTemplateSelected(e)}getPageTypeCode(){return this.pageBuilder.getPageTypeCode()}restrictionsResult(e){this.pageBuilder.setRestrictions(e.onlyOneRestrictionMustApply,e.restrictionUuids)}isRestrictionsActive(){if(!this.typeChanged||this.wizardManager.getCurrentStepId()===this.ADD_PAGE_WIZARD_STEPS.PAGE_RESTRICTIONS){this.typeChanged=false;return true}return false}getPageInfo(){const e=this.pageBuilder.getPage();e.uriContext=this.uriContext;return e}getPageRestrictions(){return this.pageBuilder.getPageRestrictions()}getPageInfoStructure(){return this.pageBuilder.getPageInfoStructure()}isPageInfoActive(){return this.wizardManager.getCurrentStepId()===this.ADD_PAGE_WIZARD_STEPS.PAGE_INFO}onNext(){return Promise.resolve(true)}onCancel(){return this.confirmationModalService.confirm({description:"se.editor.cancel.confirm"})}isFormValid(e){switch(e){case this.ADD_PAGE_WIZARD_STEPS.PAGE_TYPE:return!!this.pageBuilder.getPageTypeCode();case this.ADD_PAGE_WIZARD_STEPS.PAGE_TEMPLATE:return!!this.pageBuilder.getTemplateUuid();case this.ADD_PAGE_WIZARD_STEPS.PAGE_DISPLAY_CONDITION:return true;case this.ADD_PAGE_WIZARD_STEPS.PAGE_INFO:return!this.saveInProgress&&!!this.callbacks.isDirtyPageInfo&&this.callbacks.isDirtyPageInfo()&&!!this.callbacks.isValidPageInfo&&this.callbacks.isValidPageInfo();case this.ADD_PAGE_WIZARD_STEPS.PAGE_RESTRICTIONS:return!this.saveInProgress&&this.restrictionsStepHandler.isStepValid()}return false}onDone(){return __awaiter(this,void 0,void 0,(function*(){this.saveInProgress=true;const e=yield this.callbacks.savePageInfo();u.defaultsDeep(e,this.pageBuilder.getPage());try{const t=yield this.pageFacade.createPage(e);this.pageBuilder.setPageUid(t.uid);if(t.typeCode==="EmailPage"){this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE,t);return t}yield this.experienceService.loadExperience({siteId:this.uriContext.CURRENT_CONTEXT_SITE_ID,catalogId:this.uriContext.CURRENT_CONTEXT_CATALOG,catalogVersion:this.uriContext.CURRENT_CONTEXT_CATALOG_VERSION,pageId:this.pageBuilder.getPage().uid})}catch(e){this.saveInProgress=false;this.systemEventService.publishAsync(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,{messages:e.error.errors});const t=e.error.errors;if(!t.find((e=>e.subject.indexOf("restrictions")===0))){this.wizardManager.goToStepWithId(this.ADD_PAGE_WIZARD_STEPS.PAGE_INFO)}return Promise.reject()}}))}};Ze.$inject=["wizardManager","pageBuilderFactory","restrictionsStepHandlerFactory","experienceService","confirmationModalService","systemEventService","restrictionTypesService","restrictionsService","pageFacade"];Ze=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-add-page-wizard",template:""}),__param(0,s.Inject(m.WIZARD_MANAGER)),__metadata("design:paramtypes",[m.WizardService,Ge,t.RestrictionsStepHandlerFactory,m.IExperienceService,m.IConfirmationModalService,m.SystemEventService,t.RestrictionTypesService,t.RestrictionsService,Be])],Ze);t.AddPageWizardService=class AddPageWizardService{constructor(e,t){this.modalWizard=e;this.catalogService=t}openAddPageWizard(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.retrieveUriContext();return this.modalWizard.open({component:Ze,properties:{uriContext:e}})}))}};t.AddPageWizardService.$inject=["modalWizard","catalogService"];t.AddPageWizardService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ModalWizard,m.ICatalogService])],t.AddPageWizardService);(function(e){e["TRASH_PAGE"]="TRASH_PAGE"})(t.CMSPageOperation||(t.CMSPageOperation={}));t.ManagePageService=class ManagePageService{constructor(e,t,o,n,s,a,r,d,g,u,v,f,S,C,b,I,w,E){this.logService=e;this.smarteditRoutingService=t;this.alertService=o;this.cmsitemsRestService=n;this.systemEventService=s;this.crossFrameEventService=a;this.pageInfoService=r;this.confirmationModalService=d;this.pagesVariationsRestService=g;this.waitDialogService=u;this.pageRestoreModalService=v;this.pageRestoredAlertService=f;this.homepageService=S;this.workflowService=C;this.catalogService=b;this.restServiceFactory=I;this.sharedDataService=w;this.catalogVersionRestService=E;this.resourcePageOperationsURI=`/cmssmarteditwebservices/v1/sites/${m.PAGE_CONTEXT_SITE_ID}/catalogs/${p.PAGE_CONTEXT_CATALOG}/pages/:pageId/operations`}getSoftDeletedPagesCount(e){return __awaiter(this,void 0,void 0,(function*(){const t={pageSize:10,currentPage:0,typeCode:"AbstractPage",itemSearchParams:"pageStatus:deleted",catalogId:e.CURRENT_CONTEXT_CATALOG,catalogVersion:e.CURRENT_CONTEXT_CATALOG_VERSION,fields:"BASIC"};const o=yield this.cmsitemsRestService.get(t);return o.pagination.totalCount}))}softDeletePage(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=u.cloneDeep(e);const n={catalogId:t.CURRENT_CONTEXT_CATALOG,catalogVersion:t.CURRENT_CONTEXT_CATALOG_VERSION,siteId:t.CURRENT_CONTEXT_SITE_ID};const s=yield this.getConfirmationModalDescription(o,t);const a=yield this.confirmSoftDelete(s,e.name);if(!a){return}try{o.identifier=e.uuid;o.pageStatus=m.CMSPageStatus.DELETED;yield this.cmsitemsRestService.update(o);this.crossFrameEventService.publish(m.EVENTS.PAGE_DELETED);this.alertService.showSuccess({message:"se.cms.actionitem.page.trash.alert.success.description",messagePlaceholders:{pageName:e.name}});this.smarteditRoutingService.go("/ng/pages/:siteId/:catalogId/:catalogVersion".replace(":siteId",n.siteId).replace(":catalogId",n.catalogId).replace(":catalogVersion",n.catalogVersion))}catch(e){this.logService.warn("Something went wrong when soft deleting page",e)}}))}hardDeletePage(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.confirmHardDelete(e.name);if(!t){return}yield this.cmsitemsRestService.delete(e.uuid);this.alertService.showSuccess("se.cms.page.permanently.delete.alert.success");this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE);this.crossFrameEventService.publish(m.EVENTS.PAGE_DELETED)}))}restorePage(e){return __awaiter(this,void 0,void 0,(function*(){const t=u.cloneDeep(e);t.pageStatus=m.CMSPageStatus.ACTIVE;t.identifier=e.uuid;this.waitDialogService.showWaitModal(null);try{const e=yield this.cmsitemsRestService.update(t,{headers:{"Ignore-Interceptor":"NonValidationErrorInterceptor"}});this.waitDialogService.hideWaitModal();this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE,e);this.pageRestoredAlertService.displayPageRestoredSuccessAlert(t);this.crossFrameEventService.publish(m.EVENTS.PAGE_RESTORED)}catch(e){const o=e.error.errors;this.waitDialogService.hideWaitModal();this.pageRestoreModalService.handleRestoreValidationErrors(t,o)}}))}isPageTrashable(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const[o,n]=yield Promise.all([this.hasFallbackHomepageOrIsPrimaryWithoutVariations(e,t),this.workflowService.isPageInWorkflow(e)]);return o&&!n}catch(e){return false}}))}isPageCloneable(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=(yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY)).catalogDescriptor;const n={CURRENT_CONTEXT_SITE_ID:o.siteId,CURRENT_CONTEXT_CATALOG:o.catalogId,CURRENT_CONTEXT_CATALOG_VERSION:o.catalogVersion};const[s,a,r]=yield Promise.all([this.catalogService.getContentCatalogsForSite(o.siteId),this.cmsitemsRestService.getById(e),this.catalogVersionRestService.getCloneableTargets(n)]);const d=s.reduce(((e,t)=>{if(t.parents&&t.parents.length){e=e.concat(t.parents)}return e}),[...s]).reduce(((e,t)=>e.concat(t.versions)),[]).find((e=>e.uuid===t));if(d===null||d===void 0?void 0:d.active){return r.versions.length>0&&!a.copyToCatalogsDisabled}return r.versions.length>0}))}getDisabledTrashTooltipMessage(e,o){return __awaiter(this,void 0,void 0,(function*(){let n="se.cms.tooltip.movetotrash";const s=yield this.workflowService.isPageInWorkflow(e);const a=yield this.homepageService.getHomepageType(e,o);if(a===t.HomepageType.CURRENT){n="se.cms.tooltip.current.homepage.movetotrash"}else if(a===t.HomepageType.OLD){n="se.cms.tooltip.old.homepage.movetotrash"}else if(s){n="se.cms.tooltip.page.in.workflow.movetotrash"}return n}))}trashPageInActiveCatalogVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.retrieveUriContext();const o=yield this.catalogService.getContentCatalogActiveVersion(t);const n=yield this.confirmTrashingPageInActiveCatalogVersion(o);if(!n){return}try{this.pageOperationsRESTService=this.restServiceFactory.get(this.resourcePageOperationsURI.replace(":pageId",e));yield this.pageOperationsRESTService.save({operation:"TRASH_PAGE",sourceCatalogVersion:t.CURRENT_CONTEXT_CATALOG_VERSION,targetCatalogVersion:o});this.alertService.showSuccess({message:"se.cms.sync.page.status.success.alert",messagePlaceholders:{pageId:e,catalogVersion:o}})}catch(e){this.logService.warn("trashPageInActiveCatalogVersion - page could not be trashed",e)}}))}getConfirmationModalDescription(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield this.pageInfoService.getPageUUID();if(!o){this.logService.error("deletePageService::deletePage - pageUUID is undefined");return Promise.reject()}const n=yield this.homepageService.getHomepageType(e,t);if(n!==null||e.homepage){return"se.cms.actionitem.page.trash.confirmation.description.storefront.homepage"}return"se.cms.actionitem.page.trash.confirmation.description.storefront"}catch(e){return"se.cms.actionitem.page.trash.confirmation.description.pagelist"}}))}confirmSoftDelete(e,t){return __awaiter(this,void 0,void 0,(function*(){try{yield this.confirmationModalService.confirm({description:e,descriptionPlaceholders:{pageName:t},title:"se.cms.actionitem.page.trash.confirmation.title"});return true}catch(e){return false}}))}confirmHardDelete(e){return __awaiter(this,void 0,void 0,(function*(){try{yield this.confirmationModalService.confirm({title:"se.cms.actionitem.page.permanently.delete.confirmation.title",description:"se.cms.actionitem.page.permanently.delete.confirmation.description",descriptionPlaceholders:{pageName:e}});return true}catch(e){return false}}))}confirmTrashingPageInActiveCatalogVersion(e){return __awaiter(this,void 0,void 0,(function*(){try{yield this.confirmationModalService.confirm({title:"se.cms.sync.page.status.confirm.title",description:"se.cms.sync.page.status.confirm.description",descriptionPlaceholders:{catalogVersion:e}});return true}catch(e){return false}}))}hasFallbackHomepageOrIsPrimaryWithoutVariations(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.homepageService.getHomepageType(e,t);if(o!==null||e.homepage){return this.homepageService.hasFallbackHomePage(t)}const n=yield this.pagesVariationsRestService.getVariationsForPrimaryPageId(e.uid);return n.length===0}))}};t.ManagePageService.$inject=["logService","smarteditRoutingService","alertService","cmsitemsRestService","systemEventService","crossFrameEventService","pageInfoService","confirmationModalService","pagesVariationsRestService","waitDialogService","pageRestoreModalService","pageRestoredAlertService","homepageService","workflowService","catalogService","restServiceFactory","sharedDataService","catalogVersionRestService"];__decorate([m.Cached({actions:[m.rarelyChangingContent],tags:[m.pageDeletionEvictionTag,m.pageRestoredEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.ManagePageService.prototype,"getSoftDeletedPagesCount",null);t.ManagePageService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.LogService,m.SmarteditRoutingService,m.IAlertService,m.CmsitemsRestService,m.SystemEventService,m.CrossFrameEventService,m.IPageInfoService,m.IConfirmationModalService,Ee,m.IWaitDialogService,t.PageRestoreModalService,t.PageRestoredAlertService,t.HomepageService,m.WorkflowService,m.ICatalogService,m.IRestServiceFactory,m.ISharedDataService,ye])],t.ManagePageService);t.PageTreeComponentMenuService=class PageTreeComponentMenuService{constructor(e,t,o){this.editorEnablerService=e;this.componentMenuConditionAndCallbackService=t;this.permissionService=o;this.originalMenus=[{key:"externalcomponentbutton",i18nKey:"se.cms.contextmenu.title.externalcomponent",displayIconClass:"sap-icon--globe",permissions:[],condition:e=>__awaiter(this,void 0,void 0,(function*(){if(e.isComponentHidden){return Promise.resolve(false)}else{return this.componentMenuConditionAndCallbackService.externalCondition(e)}})),action:{component:p.ExternalComponentButtonComponent}},{key:"se.cms.sharedcomponentbutton",i18nKey:"se.cms.contextmenu.title.shared.component",displayIconClass:"sap-icon--chain-link",permissions:[],condition:e=>__awaiter(this,void 0,void 0,(function*(){if(e.isComponentHidden){return Promise.resolve(false)}else{return this.componentMenuConditionAndCallbackService.sharedCondition(e)}})),action:{component:p.SharedComponentButtonComponent}},{key:"se.cms.edit",i18nKey:"se.cms.contextmenu.title.edit",displayIconClass:"sap-icon--edit",permissions:["se.context.menu.edit.component"],action:{callback:this.editorEnablerService.onClickEditButton},condition:e=>__awaiter(this,void 0,void 0,(function*(){if(e.isComponentHidden){return this.componentMenuConditionAndCallbackService.editConditionForHiddenComponent(e)}else{return this.editorEnablerService.isSlotEditableForNonExternalComponent(e)}}))},{key:"se.cms.remove",i18nKey:"se.cms.contextmenu.title.remove",displayIconClass:"sap-icon--decline",permissions:["se.context.menu.remove.component"],action:{callback:this.componentMenuConditionAndCallbackService.removeCallback},condition:this.componentMenuConditionAndCallbackService.removeCondition},{key:"clonecomponentbutton",i18nKey:"se.cms.contextmenu.title.clone.component",displayIconClass:"sap-icon--duplicate",permissions:["se.clone.component"],action:{callback:this.componentMenuConditionAndCallbackService.cloneCallback},condition:this.componentMenuConditionAndCallbackService.cloneCondition}]}getPageTreeComponentMenus(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.buildMenusByPermission();const o=t.map((t=>__awaiter(this,void 0,void 0,(function*(){if(!t.condition){return t}const o=yield t.condition(e);return o?t:null}))));return Promise.all(o)}))}buildMenusByPermission(){return __awaiter(this,void 0,void 0,(function*(){const e=yield Promise.all(this.originalMenus.map((e=>__awaiter(this,void 0,void 0,(function*(){if(!e.permissions||e.permissions.length===0){return e}const t=yield this.permissionService.isPermitted([{names:e.permissions}]);if(t){return e}return null})))));return e.filter((e=>!!e))}))}};t.PageTreeComponentMenuService.$inject=["editorEnablerService","componentMenuConditionAndCallbackService","permissionService"];t.PageTreeComponentMenuService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[p.IEditorEnablerService,p.IComponentMenuConditionAndCallbackService,m.IPermissionService])],t.PageTreeComponentMenuService);const Xe=20;const Qe=300;t.NodeInfoService=class NodeInfoService{constructor(e,t,o,n,s){this.crossFrameEventService=e;this.cmsitemsRestService=t;this.logService=o;this.slotVisibilityService=n;this.pageTreeNodeService=s;this.treeNodes=[];this.crossFrameEventService.subscribe(m.EVENT_PAGE_TREE_SLOT_NEED_UPDATE,((e,t)=>this.updatePartTreeNodesInfoBySlotUuid(t)))}buildNodesInfo(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageTreeNodeService.getSlotNodes();this.treeNodes=yield Promise.all(e.map((e=>__awaiter(this,void 0,void 0,(function*(){return this.addMoreInfoToOneNode(e)})))));return this.treeNodes}))}updatePartTreeNodesInfo(e){return __awaiter(this,void 0,void 0,(function*(){this.treeNodes=yield Promise.all(this.treeNodes.map((t=>__awaiter(this,void 0,void 0,(function*(){if(Object.keys(e).includes(t.elementUuid)){t.childrenNode=e[t.elementUuid];return this.addMoreInfoToOneNode(t)}else{return t}})))));return this.treeNodes}))}updatePartTreeNodesInfoBySlotUuid(e){return __awaiter(this,void 0,void 0,(function*(){this.treeNodes=yield Promise.all(this.treeNodes.map((t=>__awaiter(this,void 0,void 0,(function*(){if(t.componentUuid===e){return this.addMoreInfoToOneNode(t)}else{return t}})))));return this.treeNodes}))}publishComponentSelected(e,t,o){if(t){this.crossFrameEventService.publish(m.EVENT_PAGE_TREE_SLOT_SELECTED,{elementUuid:o,active:true})}this.crossFrameEventService.publish(m.EVENT_PAGE_TREE_COMPONENT_SELECTED,{elementUuid:e.elementUuid,active:e.isExpanded})}publishSlotSelected(e){this.crossFrameEventService.publish(m.EVENT_PAGE_TREE_SLOT_SELECTED,{elementUuid:e.elementUuid,active:e.isExpanded});this.crossFrameEventService.publish(m.EVENT_PAGE_TREE_COMPONENT_SELECTED,{elementUuid:e.elementUuid,active:e.isExpanded})}addMoreInfoToOneNode(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.slotVisibilityService.getHiddenComponents(e.componentId);const o=e.childrenNode.map((e=>e.componentUuid));const n=yield this.getComponentsDataByUUIDs(o);let s=n.map((t=>this.buildDisplayComponentNode(t,e)));s=s.concat(t.map((e=>this.buildHiddenComponentNode(e))));return Object.assign(Object.assign({},e),{componentNodes:s})}))}getComponentsDataByUUIDs(e){return __awaiter(this,void 0,void 0,(function*(){try{const t=yield this.cmsitemsRestService.getByIds(e,"DEFAULT");return Promise.resolve(t.response?t.response:[t])}catch(e){this.logService.error("SlotInfoService:: getSlotsDataByUUIDs error:",e.message)}}))}buildHiddenComponentNode(e){const t=m.stringUtils.generateIdentifier();return Object.assign({isHidden:true,isExpanded:false,componentNodes:[],elementUuid:t},e)}buildDisplayComponentNode(e,t){const o=t.childrenNode.find((t=>t.componentUuid===e.uuid));const{componentId:n,componentUuid:s,componentTypeFromPage:a,containerId:r,containerType:d,catalogVersionUuid:p,elementUuid:m}=o;return Object.assign({isHidden:false,isExpanded:false,componentId:n,componentUuid:s,componentTypeFromPage:a,containerId:r,containerType:d,catalogVersionUuid:p,elementUuid:m,componentNodes:[]},e)}};t.NodeInfoService.$inject=["crossFrameEventService","cmsitemsRestService","logService","slotVisibilityService","pageTreeNodeService"];t.NodeInfoService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.CrossFrameEventService,m.CmsitemsRestService,m.LogService,p.ISlotVisibilityService,m.IPageTreeNodeService])],t.NodeInfoService);const Je=["layout/landingLayout1Page","layout/landingLayout3Page","layout/landingLayout4Page","layout/landingLayout5Page","layout/landingLayout6Page","layout/landingLayoutPage","account/accountRegisterPage","checkout/checkoutRegisterPage"];t.PageTemplateService=class PageTemplateService{constructor(e){this.pageTemplateRestService=e.get(p.PAGE_TEMPLATES_URI)}getPageTemplatesForType(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=Object.assign({pageTypeCode:t,active:true},e);const n=yield this.pageTemplateRestService.get(o);return{templates:n.templates.filter((e=>!Je.includes(e.frontEndName)))}}))}};t.PageTemplateService.$inject=["restServiceFactory"];t.PageTemplateService=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IRestServiceFactory])],t.PageTemplateService);t.RemoveComponentService=class RemoveComponentService extends p.IRemoveComponentService{};t.RemoveComponentService=__decorate([m.GatewayProxied("removeComponent"),m.SeDowngradeService(p.IRemoveComponentService)],t.RemoveComponentService);t.SlotRestrictionsService=class SlotRestrictionsService extends m.ISlotRestrictionsService{};t.SlotRestrictionsService=__decorate([m.SeDowngradeService(m.ISlotRestrictionsService),m.GatewayProxied("getAllComponentTypesSupportedOnPage","getSlotRestrictions")],t.SlotRestrictionsService);t.SyncPollingService=class SyncPollingService extends m.ISyncPollingService{constructor(e,t,o,n,s,a,r,d){super();this.logService=e;this.pageInfoService=t;this.experienceService=o;this.catalogService=n;this.synchronizationResourceService=s;this.crossFrameEventService=a;this.systemEventService=r;this.timerService=d;this.SYNC_POLLING_THROTTLE=500;this.syncStatus={};this.triggers=new Set;this.syncPollingTimer=null;this.refreshInterval=null;this.syncPageObservableMap=new Map;this.initSyncPolling()}performSync(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.isCurrentPageFromActiveCatalog();if(o){return Promise.reject()}const n=yield this.catalogService.getContentCatalogActiveVersion(t);return this.synchronizationResourceService.getPageSynchronizationPostRestService(t).save({target:n,items:e})}))}getSyncStatus(e,t,o){return __awaiter(this,void 0,void 0,(function*(){if(o){this.clearSyncPageObservableMap()}if(this.syncStatus[e]&&e===this.syncStatus[e].itemId&&!o){return this.syncStatus[e]}let n;try{n=yield this.getPageUUID(e)}catch(o){this.logService.error("syncPollingService::getSyncStatus - failed call to getPageUUID");this.syncPollingTimer.stop();return this.fetchSyncStatus(e,t)}try{const e=yield this.fetchSyncStatus(n,t);const o=this.getSyncPollingTypeFromInterval(this.refreshInterval);this.startSync(o);return e}catch(e){this.logService.error("syncPollingService::getSyncStatus - failed call to fetchSyncStatus");return Promise.reject()}}))}fetchSyncStatus(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield this.getPageUUID(e);if(!o){return{}}const n=yield this.isCurrentPageFromActiveCatalog();if(n){return Promise.reject()}const s=yield this.catalogService.getContentCatalogActiveVersion(t);const a=m.stringUtils.encode(o);const r=this.syncPageObservableMap.get(a);return r?r.toPromise():this.fetchPageSynchronization(s,o,t).toPromise()}catch(e){this.stopSync();this.logService.warn(e)}}))}changePollingSpeed(e,t){if(e===p.DEFAULT_SYNCHRONIZATION_POLLING.SPEED_UP){this.syncStatus={};if(t&&!this.triggers.has(t)){this.triggers.add(t)}this.refreshInterval=p.DEFAULT_SYNCHRONIZATION_POLLING.FAST_POLLING_TIME}else{if(t){this.triggers.delete(t)}if(this.triggers.size===0){this.refreshInterval=p.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_POLLING_TIME}}this.syncPollingTimer.restart(this.refreshInterval)}fetchPageSynchronization(e,t,o){const n=C.from(this.getPageSlotSyncStatus(o,t,e));const s=m.stringUtils.encode(t);this.syncPageObservableMap.set(s,n);return n.pipe(I.share())}getPageSlotSyncStatus(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.synchronizationResourceService.getPageSynchronizationGetRestService(e).get({pageUid:t,target:o});const s=this.syncStatus[n.itemId];if(JSON.stringify(n)!==JSON.stringify(s)){this.crossFrameEventService.publish(p.DEFAULT_SYNCHRONIZATION_POLLING.FAST_FETCH,n);if(!s||n.lastModifiedDate!==s.lastModifiedDate||n.status!==s.status){this.crossFrameEventService.publish(p.CMSITEMS_UPDATE_EVENT);this.crossFrameEventService.publish(m.EVENTS.PAGE_UPDATED,{uuid:t})}}this.syncStatus[n.itemId]=n;this.clearSyncPageObservableMap();return n}))}stopSync(){if(this.syncPollingTimer.isActive()){this.syncPollingTimer.stop()}this.clearSyncStatus()}startSync(e){if(!this.syncPollingTimer.isActive()){this.changePollingSpeed(e||p.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_DOWN)}}initSyncPolling(){this.refreshInterval=p.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_POLLING_TIME;this.triggers.clear();this.syncStatus={};const e=this.changePollingSpeed.bind(this);this.systemEventService.subscribe(p.DEFAULT_SYNCHRONIZATION_POLLING.SPEED_UP,e);this.systemEventService.subscribe(p.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_DOWN,e);this.crossFrameEventService.subscribe(p.DEFAULT_SYNCHRONIZATION_POLLING.FETCH_SYNC_STATUS_ONCE,((e,t)=>{this.fetchSyncStatus(t)}));this.crossFrameEventService.subscribe(m.OVERLAY_RERENDERED_EVENT,u.throttle((()=>{if(this.syncPollingTimer.isActive()){this.fetchSyncStatus()}}),this.SYNC_POLLING_THROTTLE));this.crossFrameEventService.subscribe(m.EVENTS.PAGE_CHANGE,(()=>{this.clearSyncStatus();this.clearSyncPageObservableMap()}));this.crossFrameEventService.subscribe(p.DEFAULT_SYNCHRONIZATION_EVENT.CATALOG_SYNCHRONIZED,(()=>{this.syncStatus={};this.fetchSyncStatus()}));this.syncPollingTimer=this.timerService.createTimer((()=>this.fetchSyncStatus()),this.refreshInterval);if(m.windowUtils.getGatewayTargetFrame()){const e=this.getSyncPollingTypeFromInterval(this.refreshInterval);this.startSync(e)}}clearSyncPageObservableMap(){this.syncPageObservableMap.clear()}clearSyncStatus(){this.syncStatus={}}getPageUUID(e){return!m.stringUtils.isBlank(e)?Promise.resolve(e):this.pageInfoService.getPageUUID()}isCurrentPageFromActiveCatalog(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.experienceService.getCurrentExperience();return e.pageContext?e.pageContext.active:e.catalogDescriptor.active}))}getSyncPollingTypeFromInterval(e){return e===p.DEFAULT_SYNCHRONIZATION_POLLING.FAST_POLLING_TIME?p.DEFAULT_SYNCHRONIZATION_POLLING.SPEED_UP:p.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_DOWN}};t.SyncPollingService.$inject=["logService","pageInfoService","experienceService","catalogService","synchronizationResourceService","crossFrameEventService","systemEventService","timerService"];__decorate([m.InvalidateCache(m.cmsitemsEvictionTag),__metadata("design:type",Function),__metadata("design:paramtypes",[Array,Object]),__metadata("design:returntype",Promise)],t.SyncPollingService.prototype,"performSync",null);t.SyncPollingService=__decorate([m.SeDowngradeService(m.ISyncPollingService),m.GatewayProxied("getSyncStatus","fetchSyncStatus","changePollingSpeed","registerSyncPollingEvents","performSync"),__metadata("design:paramtypes",[m.LogService,m.IPageInfoService,m.IExperienceService,m.ICatalogService,p.SynchronizationResourceService,m.CrossFrameEventService,m.SystemEventService,m.TimerService])],t.SyncPollingService);t.SlotVisibilityService=class SlotVisibilityService extends p.ISlotVisibilityService{};t.SlotVisibilityService=__decorate([m.SeDowngradeService(p.ISlotVisibilityService),m.GatewayProxied("getHiddenComponents")],t.SlotVisibilityService);t.ComponentMenuConditionAndCallbackService=class ComponentMenuConditionAndCallbackService extends p.IComponentMenuConditionAndCallbackService{};t.ComponentMenuConditionAndCallbackService=__decorate([m.SeDowngradeService(p.IComponentMenuConditionAndCallbackService),m.GatewayProxied("externalCondition","removeCondition","removeCallback","cloneCondition","cloneCallback","sharedCondition","editConditionForHiddenComponent")],t.ComponentMenuConditionAndCallbackService);window.__smartedit__.addDecoratorPayload("Component","ComponentItemComponent",{selector:"se-component-item",template:`<div class="se-component-item" [ngClass]="{ 'se-component-item--disabled': isComponentDisabled, 'smartEditComponent': !isComponentDisabled }" [attr.data-smartedit-component-id]="componentInfo.uid" [attr.data-smartedit-component-uuid]="componentInfo.uuid" [attr.data-smartedit-component-type]="componentInfo.typeCode"><se-tooltip *ngIf="isComponentDisabled" class="se-component-item__tooltip" [appendTo]="'body'" [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" [additionalClasses]="['se-component-item__tooltip--for-disabled']"><div se-tooltip-trigger class="se-component-item--disabled-overlay"></div><div se-tooltip-body class="se-popover--inner-content" translate="se.cms.component.non.cloneable.tooltip" [translateParams]="{ componentName: componentInfo.name }"></div></se-tooltip><div class="se-component-item--image"><span class="sap-icon--card"></span><div *ngIf="isSharedComponent"><span class="se-component-item--image-shared--background"></span> <span class="glyphicon glyphicon-link se-component-item--image-shared"></span></div></div><div class="se-component-item--details-container"><div class="se-component-item--details" title="{{ componentInfo.name }} - {{ componentInfo.typeCode }}"><div class="se-component-item--details-name">{{ componentInfo.name }}</div><div class="se-component-item--details-type">{{ componentInfo.typeCode }}</div></div><se-tooltip *ngIf="!componentInfo.visible" [appendTo]="'body'" [triggers]="['mouseenter', 'mouseleave']" [additionalClasses]="['se-component-item--visibility']"><span se-tooltip-trigger class="hyicon hyicon-unpowered"></span><div se-tooltip-body translate="se.cms.component.display.off.tooltip"></div></se-tooltip></div></div>`,styles:[`se-component-item .se-component-item--disabled,se-component-item .se-component-item--disabled:active,se-component-item .se-component-item--disabled:hover{border:2px solid transparent}se-component-item .se-component-item--disabled-overlay{cursor:not-allowed;position:absolute;z-index:1;height:100%;width:100%;left:0;top:0;background:#d9d9d9;border-radius:4px;opacity:.5}se-component-item .se-component-item--details-container{display:flex}se-component-item .se-component-item--details-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;color:#51555a;width:100%}se-component-item .se-component-item--image-shared--background{position:absolute;top:0;left:0;width:0;height:0;border-style:solid;border-width:13px;border-color:#354a5f transparent transparent #354a5f;border-radius:4px 0 0 0}se-component-item .se-component-item--image-shared{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;position:absolute;top:2px;left:2px;transform:rotate(3deg)}se-component-item .se-component-item--visibility,se-component-item .se-component-item--visibility .fd-popover__control,se-component-item .se-component-item--visibility>div{width:100%;height:100%}se-component-item .se-component-item__tooltip{display:block;height:100%;width:100%;position:absolute;left:0;top:0}se-component-item .se-component-item__tooltip--for-disabled,se-component-item .se-component-item__tooltip--for-disabled .fd-popover__control,se-component-item .se-component-item__tooltip--for-disabled>div{width:100%;height:100%}`,`.se-component-item{display:flex;flex-direction:row;align-items:center;position:relative;width:270px;padding:8px;margin:4px 8px 0;border:2px solid transparent;cursor:grab}.se-component-item:active,.se-component-item:hover{border:2px dashed #d9d9d9;border-radius:4px}.se-component-item:active{cursor:grabbing}.se-component-item--details-type{color:#51555a;overflow:hidden;text-overflow:ellipsis}.se-component-item--image{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.4285714286rem;line-height:1.4;font-weight:400;height:36px;width:36px;position:relative;background:#2b78c5;margin-right:8px;color:#fff;border-radius:4px}.se-component-item--details,.se-component-item--details-type{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;width:200px}.se-component-item--details-type{color:#6a6d70}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let et=class ComponentItemComponent{constructor(e,t){this.componentSharedService=e;this.cdr=t}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.isSharedComponent=yield this.componentSharedService.isComponentShared(this.componentInfo);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnChanges(e){if(e.cloneOnDrop){this.isComponentDisabled=this.cloneOnDrop&&!this.componentInfo.cloneable}}};et.$inject=["componentSharedService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],et.prototype,"componentInfo",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],et.prototype,"cloneOnDrop",void 0);et=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-item",template:`<div class="se-component-item" [ngClass]="{ 'se-component-item--disabled': isComponentDisabled, 'smartEditComponent': !isComponentDisabled }" [attr.data-smartedit-component-id]="componentInfo.uid" [attr.data-smartedit-component-uuid]="componentInfo.uuid" [attr.data-smartedit-component-type]="componentInfo.typeCode"><se-tooltip *ngIf="isComponentDisabled" class="se-component-item__tooltip" [appendTo]="'body'" [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" [additionalClasses]="['se-component-item__tooltip--for-disabled']"><div se-tooltip-trigger class="se-component-item--disabled-overlay"></div><div se-tooltip-body class="se-popover--inner-content" translate="se.cms.component.non.cloneable.tooltip" [translateParams]="{ componentName: componentInfo.name }"></div></se-tooltip><div class="se-component-item--image"><span class="sap-icon--card"></span><div *ngIf="isSharedComponent"><span class="se-component-item--image-shared--background"></span> <span class="glyphicon glyphicon-link se-component-item--image-shared"></span></div></div><div class="se-component-item--details-container"><div class="se-component-item--details" title="{{ componentInfo.name }} - {{ componentInfo.typeCode }}"><div class="se-component-item--details-name">{{ componentInfo.name }}</div><div class="se-component-item--details-type">{{ componentInfo.typeCode }}</div></div><se-tooltip *ngIf="!componentInfo.visible" [appendTo]="'body'" [triggers]="['mouseenter', 'mouseleave']" [additionalClasses]="['se-component-item--visibility']"><span se-tooltip-trigger class="hyicon hyicon-unpowered"></span><div se-tooltip-body translate="se.cms.component.display.off.tooltip"></div></se-tooltip></div></div>`,styles:[`se-component-item .se-component-item--disabled,se-component-item .se-component-item--disabled:active,se-component-item .se-component-item--disabled:hover{border:2px solid transparent}se-component-item .se-component-item--disabled-overlay{cursor:not-allowed;position:absolute;z-index:1;height:100%;width:100%;left:0;top:0;background:#d9d9d9;border-radius:4px;opacity:.5}se-component-item .se-component-item--details-container{display:flex}se-component-item .se-component-item--details-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;color:#51555a;width:100%}se-component-item .se-component-item--image-shared--background{position:absolute;top:0;left:0;width:0;height:0;border-style:solid;border-width:13px;border-color:#354a5f transparent transparent #354a5f;border-radius:4px 0 0 0}se-component-item .se-component-item--image-shared{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;position:absolute;top:2px;left:2px;transform:rotate(3deg)}se-component-item .se-component-item--visibility,se-component-item .se-component-item--visibility .fd-popover__control,se-component-item .se-component-item--visibility>div{width:100%;height:100%}se-component-item .se-component-item__tooltip{display:block;height:100%;width:100%;position:absolute;left:0;top:0}se-component-item .se-component-item__tooltip--for-disabled,se-component-item .se-component-item__tooltip--for-disabled .fd-popover__control,se-component-item .se-component-item__tooltip--for-disabled>div{width:100%;height:100%}`,`.se-component-item{display:flex;flex-direction:row;align-items:center;position:relative;width:270px;padding:8px;margin:4px 8px 0;border:2px solid transparent;cursor:grab}.se-component-item:active,.se-component-item:hover{border:2px dashed #d9d9d9;border-radius:4px}.se-component-item:active{cursor:grabbing}.se-component-item--details-type{color:#51555a;overflow:hidden;text-overflow:ellipsis}.se-component-item--image{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.4285714286rem;line-height:1.4;font-weight:400;height:36px;width:36px;position:relative;background:#2b78c5;margin-right:8px;color:#fff;border-radius:4px}.se-component-item--details,.se-component-item--details-type{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;width:200px}.se-component-item--details-type{color:#6a6d70}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[p.IComponentSharedService,s.ChangeDetectorRef])],et);window.__smartedit__.addDecoratorPayload("Component","ComponentTypeComponent",{selector:"se-component-type",template:`<div class="se-component-item smartEditComponent" [attr.data-smartedit-component-type]="typeInfo.code"><div class="se-component-item--image"><span class="sap-icon--card"></span></div><div class="se-component-item--details-type" [title]="typeInfo.i18nKey | translate">{{ typeInfo.name }}</div></div>`,styles:[`.se-component-item{display:flex;flex-direction:row;align-items:center;position:relative;width:270px;padding:8px;margin:4px 8px 0;border:2px solid transparent;cursor:grab}.se-component-item:active,.se-component-item:hover{border:2px dashed #d9d9d9;border-radius:4px}.se-component-item:active{cursor:grabbing}.se-component-item--details-type{color:#51555a;overflow:hidden;text-overflow:ellipsis}.se-component-item--image{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.4285714286rem;line-height:1.4;font-weight:400;height:36px;width:36px;position:relative;background:#2b78c5;margin-right:8px;color:#fff;border-radius:4px}.se-component-item--details,.se-component-item--details-type{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;width:200px}.se-component-item--details-type{color:#6a6d70}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let tt=class ComponentTypeComponent{};__decorate([s.Input(),__metadata("design:type",Object)],tt.prototype,"typeInfo",void 0);tt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-type",template:`<div class="se-component-item smartEditComponent" [attr.data-smartedit-component-type]="typeInfo.code"><div class="se-component-item--image"><span class="sap-icon--card"></span></div><div class="se-component-item--details-type" [title]="typeInfo.i18nKey | translate">{{ typeInfo.name }}</div></div>`,styles:[`.se-component-item{display:flex;flex-direction:row;align-items:center;position:relative;width:270px;padding:8px;margin:4px 8px 0;border:2px solid transparent;cursor:grab}.se-component-item:active,.se-component-item:hover{border:2px dashed #d9d9d9;border-radius:4px}.se-component-item:active{cursor:grabbing}.se-component-item--details-type{color:#51555a;overflow:hidden;text-overflow:ellipsis}.se-component-item--image{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.4285714286rem;line-height:1.4;font-weight:400;height:36px;width:36px;position:relative;background:#2b78c5;margin-right:8px;color:#fff;border-radius:4px}.se-component-item--details,.se-component-item--details-type{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;width:200px}.se-component-item--details-type{color:#6a6d70}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],tt);window.__smartedit__.addDecoratorPayload("Component","ComponentSearchComponent",{selector:"se-component-search",template:`<div class="se-input-group se-component-menu__input-group"><input type="text" class="se-input-group__input-area" name="search-term" [(ngModel)]="searchQuery" (ngModelChange)="onSearchQueryChange($event)" placeholder="{{ placeholderI18nKey | translate }}"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let it=class ComponentSearchComponent{constructor(e){this.systemEventService=e;this.onChange=new s.EventEmitter;this.searchQuery="";this.showResetButton=false;this.searchQuerySubject$=new C.Subject;this.searchQuerySubscription=this.searchQuerySubject$.pipe(g.debounceTime(500),g.distinctUntilChanged()).subscribe((e=>{this.searchQuery=e;this.onChange.emit(this.searchQuery)}))}ngOnInit(){this.resetSearch();this.unRegResetComponentMenuEvent=this.systemEventService.subscribe(F,(()=>this.resetSearch()))}ngOnDestroy(){this.unRegResetComponentMenuEvent();this.searchQuerySubscription.unsubscribe()}onSearchQueryChange(e){this.searchQuerySubject$.next(e);this.showResetButton=!!e.length}resetSearch(e){if(e){e.stopPropagation()}this.searchQuery="";this.showResetButton=false;this.onChange.emit(this.searchQuery)}};it.$inject=["systemEventService"];__decorate([s.Input(),__metadata("design:type",String)],it.prototype,"placeholderI18nKey",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],it.prototype,"onChange",void 0);it=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-search",template:`<div class="se-input-group se-component-menu__input-group"><input type="text" class="se-input-group__input-area" name="search-term" [(ngModel)]="searchQuery" (ngModelChange)="onSearchQueryChange($event)" placeholder="{{ placeholderI18nKey | translate }}"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="showResetButton" class="se-input-group__addon se-input-group__clear-btn" (click)="resetSearch($event)"><span class="sap-icon--decline"></span></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.SystemEventService])],it);window.__smartedit__.addDecoratorPayload("Component","CatalogVersionItemComponent",{selector:"se-catalog-version-item",template:`\n        <div class="se-component-menu__select-local">\n            <span\n                class="hyicon hyicon-globe se-component-menu__select-globe"\n                *ngIf="item.isCurrentCatalog"\n            ></span>\n            <span class="se-component-menu__select-text"\n                >{{ item.catalogName | seL10n | async }} - {{ item.catalogVersionId }}</span\n            >\n        </div>\n    `});let ot=class CatalogVersionItemComponent{constructor(e){this.item=e.item}};ot.$inject=["data"];ot=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-catalog-version-item",template:`\n        <div class="se-component-menu__select-local">\n            <span\n                class="hyicon hyicon-globe se-component-menu__select-globe"\n                *ngIf="item.isCurrentCatalog"\n            ></span>\n            <span class="se-component-menu__select-text"\n                >{{ item.catalogName | seL10n | async }} - {{ item.catalogVersionId }}</span\n            >\n        </div>\n    `}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],ot);window.__smartedit__.addDecoratorPayload("Component","ComponentsTabComponent",{selector:"se-components-tab",template:`<div class="se-component-menu__tabs-header"><div class="se-component-menu__tabs-header--upper" *ngIf="hasMultipleContentCatalogs()"><se-select id="se-components-tab-catalog-versions" class="se-component-menu__select" [(model)]="selectedCatalogVersionId" (modelChange)="onCatalogVersionChange()" [fetchStrategy]="catalogVersionsFetchStrategy" [searchEnabled]="false" [itemComponent]="itemComponent"></se-select></div><div class="se-component-menu__tabs-header--lower"><se-component-search (onChange)="onSearchTermChanged($event)" [placeholderI18nKey]="'se.cms.componentmenu.search.placeholder'" class="se-component-menu__tabs-search"></se-component-search><fieldset class="fd-form__set"><div class="fd-form__item fd-form__item--check se-component-menu__clone-on-drop"><input type="checkbox" class="fd-form__control se-component-menu__clone-check-box" id="component-clone-checkbox" name="clone-on-drop" [(ngModel)]="cloneOnDrop" (ngModelChange)="onComponentCloneOnDropChange($event)"/> <label class="fd-form__label se-component-menu__clone-label" for="component-clone-checkbox" translate="se.cms.component.clone.on.drop.label"></label></div></fieldset></div></div><div class="se-component-menu__result-container" *ngIf="forceRecompile"><se-infinite-scrolling *ngIf="isActive()" class="se-component-menu__infinite-scroll" [ngClass]="{'se-component-menu__infinite-scroll--short': hasMultipleContentCatalogs() }" [pageSize]="10" [mask]="searchTerm" [fetchPage]="loadComponentItems" [context]="componentsContext"><div class="se-component-menu__result" *ngIf="componentsContext.items.length"><se-component-item class="se-component-menu__item-wrap" *ngFor="let item of componentsContext.items; trackBy: trackById" [componentInfo]="item" [cloneOnDrop]="cloneOnDrop"></se-component-item></div></se-infinite-scrolling></div>`,styles:[`se-components-tab .se-component-menu__tabs-header{padding:0 20px 16px;border-bottom:1px solid #d9d9d9}se-components-tab .se-component-menu__tabs-header .fd-form__set{margin:0!important}se-components-tab .se-component-menu__tabs-header--upper{margin-bottom:12px}se-components-tab .se-component-menu__tabs-header--lower{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__tabs-search{width:78%}se-components-tab .se-component-menu__clone-on-drop.fd-form__item{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__clone-check-box.fd-form__control{margin:0 4px 0 16px}se-components-tab .se-component-menu__clone-label.fd-form__label{white-space:nowrap;color:#32363a}se-components-tab .se-component-menu__infinite-scroll .se-infinite-scrolling__container{max-height:300px}se-components-tab .se-component-menu__infinite-scroll--short .se-infinite-scrolling__container{max-height:250px}se-components-tab .se-component-menu__result{display:grid;grid-template-columns:repeat(2,1fr)}`],encapsulation:s.ViewEncapsulation.None});let nt=class ComponentsTabComponent{constructor(e,t,o,n,s){this.tabData=e;this.componentMenuService=t;this.componentService=o;this.sharedDataService=n;this.userTrackingService=s;this.loadComponentItems=(e,t,o)=>__awaiter(this,void 0,void 0,(function*(){if(!this.selectedCatalogVersion){return{results:[]}}const n={catalogId:this.selectedCatalogVersion.catalogId,catalogVersion:this.selectedCatalogVersion.catalogVersionId,mask:e,pageSize:t,page:o};const s=yield this.componentService.loadPagedComponentItemsByCatalogVersion(n);return Object.assign(Object.assign({},s),{results:s.response})}));this.catalogVersions=[];this.catalogVersionsFetchStrategy={fetchAll:()=>this.fetchCatalogVersions()};this.componentsContext={items:[]};this.forceRecompile=true;this.itemComponent=ot;this.selectedCatalogVersionId=null;this.selectedCatalogVersion=null;this.searchTerm=""}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.cloneOnDrop=!!(yield this.sharedDataService.get(ze));yield this.fetchCatalogVersions();if(!this.hasMultipleContentCatalogs()){this.onCatalogVersionChange()}}))}isActive(){return this.tabData.tab.active}hasMultipleContentCatalogs(){return this.tabData.model.componentsTab.hasMultipleContentCatalogs}trackById(e){return e.id}onCatalogVersionChange(){return __awaiter(this,void 0,void 0,(function*(){if(this.selectedCatalogVersionId){this.selectedCatalogVersion=this.catalogVersions.find((e=>e.id===this.selectedCatalogVersionId));yield this.componentMenuService.persistCatalogVersion(this.selectedCatalogVersionId);this.forceRecompile=false;setTimeout((()=>{this.forceRecompile=true}))}}))}onSearchTermChanged(e){this.searchTerm=e}onComponentCloneOnDropChange(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.ADD_COMPONENT,"Clone on Drop");this.sharedDataService.set(ze,this.cloneOnDrop)}fetchCatalogVersions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.componentMenuService.getValidContentCatalogVersions();this.catalogVersions=e;const t=yield this.componentMenuService.getInitialCatalogVersion(this.catalogVersions);this.selectedCatalogVersion=t;this.selectedCatalogVersionId=this.selectedCatalogVersion?this.selectedCatalogVersion.id:undefined;return this.catalogVersions}))}};nt.$inject=["tabData","componentMenuService","componentService","sharedDataService","userTrackingService"];nt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-components-tab",template:`<div class="se-component-menu__tabs-header"><div class="se-component-menu__tabs-header--upper" *ngIf="hasMultipleContentCatalogs()"><se-select id="se-components-tab-catalog-versions" class="se-component-menu__select" [(model)]="selectedCatalogVersionId" (modelChange)="onCatalogVersionChange()" [fetchStrategy]="catalogVersionsFetchStrategy" [searchEnabled]="false" [itemComponent]="itemComponent"></se-select></div><div class="se-component-menu__tabs-header--lower"><se-component-search (onChange)="onSearchTermChanged($event)" [placeholderI18nKey]="'se.cms.componentmenu.search.placeholder'" class="se-component-menu__tabs-search"></se-component-search><fieldset class="fd-form__set"><div class="fd-form__item fd-form__item--check se-component-menu__clone-on-drop"><input type="checkbox" class="fd-form__control se-component-menu__clone-check-box" id="component-clone-checkbox" name="clone-on-drop" [(ngModel)]="cloneOnDrop" (ngModelChange)="onComponentCloneOnDropChange($event)"/> <label class="fd-form__label se-component-menu__clone-label" for="component-clone-checkbox" translate="se.cms.component.clone.on.drop.label"></label></div></fieldset></div></div><div class="se-component-menu__result-container" *ngIf="forceRecompile"><se-infinite-scrolling *ngIf="isActive()" class="se-component-menu__infinite-scroll" [ngClass]="{'se-component-menu__infinite-scroll--short': hasMultipleContentCatalogs() }" [pageSize]="10" [mask]="searchTerm" [fetchPage]="loadComponentItems" [context]="componentsContext"><div class="se-component-menu__result" *ngIf="componentsContext.items.length"><se-component-item class="se-component-menu__item-wrap" *ngFor="let item of componentsContext.items; trackBy: trackById" [componentInfo]="item" [cloneOnDrop]="cloneOnDrop"></se-component-item></div></se-infinite-scrolling></div>`,styles:[`se-components-tab .se-component-menu__tabs-header{padding:0 20px 16px;border-bottom:1px solid #d9d9d9}se-components-tab .se-component-menu__tabs-header .fd-form__set{margin:0!important}se-components-tab .se-component-menu__tabs-header--upper{margin-bottom:12px}se-components-tab .se-component-menu__tabs-header--lower{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__tabs-search{width:78%}se-components-tab .se-component-menu__clone-on-drop.fd-form__item{display:flex;flex-direction:row;align-items:center}se-components-tab .se-component-menu__clone-check-box.fd-form__control{margin:0 4px 0 16px}se-components-tab .se-component-menu__clone-label.fd-form__label{white-space:nowrap;color:#32363a}se-components-tab .se-component-menu__infinite-scroll .se-infinite-scrolling__container{max-height:300px}se-components-tab .se-component-menu__infinite-scroll--short .se-infinite-scrolling__container{max-height:250px}se-components-tab .se-component-menu__result{display:grid;grid-template-columns:repeat(2,1fr)}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.TAB_DATA)),__metadata("design:paramtypes",[Object,m.ComponentMenuService,p.ComponentService,m.ISharedDataService,m.UserTrackingService])],nt);window.__smartedit__.addDecoratorPayload("Component","ComponentTypesTabComponent",{selector:"se-component-types-tab",template:`<div class="se-component-menu__types-header"><se-component-search (onChange)="onSearchTermChanged($event)" [placeholderI18nKey]="'se.cms.componentmenu.search.type.placeholder'" class="se-component-menu__type-search"></se-component-search></div><div class="se-component-menu__result-container"><se-infinite-scrolling class="se-component-menu__infinite-scroll" *ngIf="isMenuOpen() || isTabActive()" [pageSize]="10" [mask]="searchTerm" [fetchPage]="loadComponentTypes" [context]="componentsContext"><div class="se-component-menu__result se-component-menu__result--types"><div class="se-component-menu__item-wrap" *ngFor="let componentType of componentsContext.items"><se-component-type [typeInfo]="componentType"></se-component-type></div></div></se-infinite-scrolling></div>`,styles:[`se-component-types-tab .se-component-menu__type-search{width:100%}se-component-types-tab .se-component-menu__result{display:grid;grid-template-columns:repeat(2,1fr)}se-component-types-tab .se-component-menu__infinite-scroll .se-infinite-scrolling__container{max-height:300px}se-component-types-tab .se-component-menu__types-header{padding:0 20px 16px;border-bottom:1px solid #d9d9d9}se-component-types-tab .se-component-menu__types-header .fd-form__set{margin:0!important}`],encapsulation:s.ViewEncapsulation.None});let at=class ComponentTypesTabComponent{constructor(e,t,o,n,s,a,r){this.tabData=e;this.logService=t;this.componentService=o;this.pageService=n;this.catalogService=s;this.crossFrameEventService=a;this.languageService=r;this.loadComponentTypes=(e,t,o)=>__awaiter(this,void 0,void 0,(function*(){try{const[n]=yield Promise.all([this.languageService.getResolveLocale(),this.loadPageContext()]);const s={pageId:this.pageInfo.uid,catalogId:this.uriContext.CURRENT_CONTEXT_CATALOG,catalogVersion:this.uriContext.CURRENT_CONTEXT_CATALOG_VERSION,langIsoCode:n,mask:e,pageSize:t,currentPage:o};const a=yield this.componentService.getSupportedComponentTypesForCurrentPage(s);return a}catch(e){this.logService.error("ComponentTypesTab - loadComponentTypes - error loading types.",e)}}));this.componentsContext={items:[]};this.pageInfo=null;this.searchTerm="";this.uriContext=null}ngOnInit(){this.unRegisterSwitchLanguageEvent=this.crossFrameEventService.subscribe(m.SWITCH_LANGUAGE_EVENT,(()=>{console.log("switch language called before",this.searchTerm);this.searchTerm=this.searchTerm!==undefined?undefined:"";console.log("switch language called after",this.searchTerm)}))}ngOnDestroy(){var e;(e=this.unRegisterSwitchLanguageEvent)===null||e===void 0?void 0:e.call(this)}onSearchTermChanged(e){this.searchTerm=e}isTabActive(){return this.tabData.tab.active}isMenuOpen(){return this.tabData.model.isOpen}loadPageContext(){return __awaiter(this,void 0,void 0,(function*(){if(this.pageInfo){return}const[e,t]=yield Promise.all([this.pageService.getCurrentPageInfo(),this.catalogService.retrieveUriContext()]);this.pageInfo=e;this.uriContext=t}))}};at.$inject=["tabData","logService","componentService","pageService","catalogService","crossFrameEventService","languageService"];at=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-types-tab",template:`<div class="se-component-menu__types-header"><se-component-search (onChange)="onSearchTermChanged($event)" [placeholderI18nKey]="'se.cms.componentmenu.search.type.placeholder'" class="se-component-menu__type-search"></se-component-search></div><div class="se-component-menu__result-container"><se-infinite-scrolling class="se-component-menu__infinite-scroll" *ngIf="isMenuOpen() || isTabActive()" [pageSize]="10" [mask]="searchTerm" [fetchPage]="loadComponentTypes" [context]="componentsContext"><div class="se-component-menu__result se-component-menu__result--types"><div class="se-component-menu__item-wrap" *ngFor="let componentType of componentsContext.items"><se-component-type [typeInfo]="componentType"></se-component-type></div></div></se-infinite-scrolling></div>`,styles:[`se-component-types-tab .se-component-menu__type-search{width:100%}se-component-types-tab .se-component-menu__result{display:grid;grid-template-columns:repeat(2,1fr)}se-component-types-tab .se-component-menu__infinite-scroll .se-infinite-scrolling__container{max-height:300px}se-component-types-tab .se-component-menu__types-header{padding:0 20px 16px;border-bottom:1px solid #d9d9d9}se-component-types-tab .se-component-menu__types-header .fd-form__set{margin:0!important}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.TAB_DATA)),__metadata("design:paramtypes",[Object,m.LogService,p.ComponentService,m.IPageService,m.ICatalogService,m.CrossFrameEventService,m.LanguageService])],at);const lt={COMPONENT_TYPES_TAB_ID:"componentTypesTab",COMPONENTS_TAB_ID:"componentsTab"};window.__smartedit__.addDecoratorPayload("Component","ComponentMenuComponent",{selector:"se-component-menu",template:`<div class="se-component-menu" [ngClass]="{ 'se-component-menu__localized': hasMultipleContentCatalogs }"><div translate="se.cms.componentmenu.dropdown.header" class="se-component-menu__title"></div><div class="se-component-menu__tip" translate="se.cms.componentmenu.label.draganddrop"></div><se-tabs *ngIf="toolbarItem.isOpen" class="se-component-menu__tabs" [tabsList]="tabsList" [model]="model" [numTabsDisplayed]="2"></se-tabs></div>`,styles:[`se-component-menu .se-component-menu{width:640px;height:485px}se-component-menu .se-component-menu__tabs .se-tabset{margin:0 20px 20px}se-component-menu .se-component-menu__tip{font-size:1rem;line-height:1.4285714286;font-weight:400;margin-bottom:16px;color:#51555a;padding:0 20px}se-component-menu .se-component-menu__title{color:#32363a;font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding:14px 20px 4px}`],encapsulation:s.ViewEncapsulation.None});t.ComponentMenuComponent=class ComponentMenuComponent{constructor(e,t,o){this.toolbarItem=e;this.crossFrameEventService=t;this.componentMenuService=o}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield this.initializeComponentMenu();this.unregisterPageChangeEvent=this.crossFrameEventService.subscribe(m.EVENTS.PAGE_CHANGE,(()=>this.initializeComponentMenu()));this.unregisterOpenComponentEvent=this.crossFrameEventService.subscribe(k,(()=>{this.resetComponentMenu(true)}));this.unregisterOverlapEvent=this.crossFrameEventService.subscribe(m.OVERLAY_DISABLED_EVENT,(()=>this.closeMenu()));this.unregisterDragStartEvent=this.crossFrameEventService.subscribe(m.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_START,(()=>{this.isDragging=true;this.closeMenu()}));this.unregisterDragEndEvent=this.crossFrameEventService.subscribe(m.SMARTEDIT_DRAG_AND_DROP_EVENTS.DRAG_DROP_END,(()=>{this.isDragging=false;this.crossFrameEventService.publish(m.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME.END)}))}))}ngDoCheck(){if(this.isOpenPreviousValue!==this.toolbarItem.isOpen){this.isOpenPreviousValue=this.toolbarItem.isOpen;if(this.toolbarItem.isOpen){this.crossFrameEventService.publish(m.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME.START)}else if(!this.toolbarItem.isOpen&&!this.isDragging){this.crossFrameEventService.publish(m.DRAG_AND_DROP_CROSS_ORIGIN_BEFORE_TIME.END)}}}ngOnDestroy(){this.unregisterPageChangeEvent();this.unregisterOpenComponentEvent();this.unregisterDragStartEvent();this.unregisterOverlapEvent();this.unregisterDragEndEvent()}initializeComponentMenu(){return __awaiter(this,void 0,void 0,(function*(){this.tabsList=null;this.hasMultipleContentCatalogs=yield this.componentMenuService.hasMultipleContentCatalogs();this.tabsList=[{id:lt.COMPONENT_TYPES_TAB_ID,title:"se.cms.compomentmenu.tabs.componenttypes",component:at,hasErrors:false},{id:lt.COMPONENTS_TAB_ID,title:"se.cms.compomentmenu.tabs.customizedcomp",component:nt,hasErrors:false}];this.model={componentsTab:{hasMultipleContentCatalogs:this.hasMultipleContentCatalogs},isOpen:this.toolbarItem.isOpen};this.resetComponentMenu(this.toolbarItem.isOpen)}))}resetComponentMenu(e){if(this.tabsList){if(!this.toolbarItem.isOpen){this.tabsList=this.tabsList.map((e=>Object.assign(Object.assign({},e),{active:e.id===lt.COMPONENT_TYPES_TAB_ID})))}this.model=Object.assign(Object.assign({},this.model),{isOpen:e});this.crossFrameEventService.publish(F)}}closeMenu(){if(this.toolbarItem){this.toolbarItem.isOpen=false}}};t.ComponentMenuComponent.$inject=["toolbarItem","crossFrameEventService","componentMenuService"];t.ComponentMenuComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-menu",template:`<div class="se-component-menu" [ngClass]="{ 'se-component-menu__localized': hasMultipleContentCatalogs }"><div translate="se.cms.componentmenu.dropdown.header" class="se-component-menu__title"></div><div class="se-component-menu__tip" translate="se.cms.componentmenu.label.draganddrop"></div><se-tabs *ngIf="toolbarItem.isOpen" class="se-component-menu__tabs" [tabsList]="tabsList" [model]="model" [numTabsDisplayed]="2"></se-tabs></div>`,styles:[`se-component-menu .se-component-menu{width:640px;height:485px}se-component-menu .se-component-menu__tabs .se-tabset{margin:0 20px 20px}se-component-menu .se-component-menu__tip{font-size:1rem;line-height:1.4285714286;font-weight:400;margin-bottom:16px;color:#51555a;padding:0 20px}se-component-menu .se-component-menu__title{color:#32363a;font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding:14px 20px 4px}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[Object,m.CrossFrameEventService,m.ComponentMenuService])],t.ComponentMenuComponent);t.ComponentMenuModule=class ComponentMenuModule{};t.ComponentMenuModule=__decorate([s.NgModule({imports:[f.CommonModule,m.TooltipModule,m.TranslationModule.forChild(),a.FormsModule,m.SelectModule,m.InfiniteScrollingModule,m.L10nPipeModule,m.TabsModule],providers:[m.ComponentMenuService],declarations:[et,tt,it,ot,nt,at,t.ComponentMenuComponent],entryComponents:[et,tt,it,ot,nt,at,t.ComponentMenuComponent]})],t.ComponentMenuModule);window.__smartedit__.addDecoratorPayload("Component","ComponentRestrictionsEditorComponent",{selector:"se-component-restrictions-editor",template:`<se-restrictions-editor [editable]="isEditable" [getRestrictionTypes]="getRestrictionTypes" [getSupportedRestrictionTypes]="getSupportedRestrictionTypes" [item]="model" [restrictionUuids]="model.restrictions" (onRestrictionsChange)="onRestrictionsChange($event)"></se-restrictions-editor>`,changeDetection:s.ChangeDetectionStrategy.OnPush});t.ComponentRestrictionsEditorComponent=class ComponentRestrictionsEditorComponent{constructor(e,t,o){this.data=e;this.restrictionsService=t;this.restrictionTypesService=o;({editor:this.editor,field:this.field,model:this.model}=e);this.isEditable=!e.isFieldDisabled()}ngOnInit(){this.initGetRestrictionTypes();this.initGetSupportedRestrictionTypes();if(this.model.restrictions===undefined){this.editor.form.pristine.restrictions=[];this.editor.form.pristine.onlyOneRestrictionMustApply=false}}onRestrictionsChange({onlyOneRestrictionMustApply:e,restrictionUuids:t,alwaysEnableSubmit:o}){this.model.onlyOneRestrictionMustApply=e;this.model.restrictions=t;this.editor.api.setAlwaysEnableSubmit(o)}initGetRestrictionTypes(){this.getRestrictionTypes=()=>this.restrictionTypesService.getRestrictionTypes()}initGetSupportedRestrictionTypes(){this.getSupportedRestrictionTypes=()=>this.restrictionsService.getSupportedRestrictionTypeCodes()}};t.ComponentRestrictionsEditorComponent.$inject=["data","restrictionsService","restrictionTypesService"];t.ComponentRestrictionsEditorComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-restrictions-editor",template:`<se-restrictions-editor [editable]="isEditable" [getRestrictionTypes]="getRestrictionTypes" [getSupportedRestrictionTypes]="getSupportedRestrictionTypes" [item]="model" [restrictionUuids]="model.restrictions" (onRestrictionsChange)="onRestrictionsChange($event)"></se-restrictions-editor>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,t.RestrictionsService,t.RestrictionTypesService])],t.ComponentRestrictionsEditorComponent);window.__smartedit__.addDecoratorPayload("Component","ItemManagementComponent",{selector:"se-item-manager",template:`<div><se-generic-editor [id]="editorId" [smarteditComponentId]="itemId" [smarteditComponentType]="componentType" [structureApi]="structureApi" [content]="item" [contentApi]="contentApi" [(isDirty)]="isDirtyInternal" [(submit)]="submit" [uriContext]="uriContext" [reset]="reset"></se-generic-editor></div>`});let ct=class ItemManagementComponent{constructor(){this.supportedModes=["add","edit","create"];this.editorId="se-item-management-editor";this.isDirtyChange=new s.EventEmitter;this.submitFunctionChange=new s.EventEmitter;this.reset=true}ngOnInit(){this.validateMode();this.submitFunctionChange.emit((()=>this.submitInternal()));this.isDirtyChange.emit((()=>this.isDirtyLocal()));if(!this.componentType&&this.item){this.componentType=this.item.typeCode}if(!this.item){this.itemId=null}if(this.item&&this.item.uuid){this.itemId=this.item.uuid}else if(this.item&&this.item.uid){this.itemId=this.item.uid}}ngOnChanges(e){const t=e.item;if(t){this.itemId=null;if(this.item&&this.item.uuid){this.itemId=this.item.uuid}else if(this.item&&this.item.uid){this.itemId=this.item.uid}}}validateMode(){if(!this.supportedModes.includes(this.mode)){throw"ItemManagementComponent.ngOnInit() - Mode not supported: "+this.mode}}submitInternal(){switch(this.mode.toLowerCase()){case"add":return Promise.resolve(this.item);case"edit":return this.submit();case"create":return this.submit().then((e=>e));default:throw`ItemManagementController - The given mode [${this.mode}] has not been implemented for this component`}}isDirtyLocal(){if(this.isDirtyInternal){return this.isDirtyInternal()}return false}};__decorate([s.Input(),__metadata("design:type",Object)],ct.prototype,"item",void 0);__decorate([s.Input(),__metadata("design:type",Object)],ct.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",String)],ct.prototype,"mode",void 0);__decorate([s.Input(),__metadata("design:type",String)],ct.prototype,"contentApi",void 0);__decorate([s.Input(),__metadata("design:type",String)],ct.prototype,"structureApi",void 0);__decorate([s.Input(),__metadata("design:type",String)],ct.prototype,"componentType",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ct.prototype,"isDirty",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ct.prototype,"submitFunction",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],ct.prototype,"isDirtyChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],ct.prototype,"submitFunctionChange",void 0);ct=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-item-manager",template:`<div><se-generic-editor [id]="editorId" [smarteditComponentId]="itemId" [smarteditComponentType]="componentType" [structureApi]="structureApi" [content]="item" [contentApi]="contentApi" [(isDirty)]="isDirtyInternal" [(submit)]="submit" [uriContext]="uriContext" [reset]="reset"></se-generic-editor></div>`}),__metadata("design:paramtypes",[])],ct);class RestrictionManagementSelectModel{constructor(e,t,o,n){this.cmsitemsRestService=e;this.catalogService=t;this.fetchRestrictionTypes=o;this.getSupportedRestrictionTypes=n;this.selectedIds={};this.model={restrictionTypes:[],selectedRestrictionType:null};this.restrictions=[];this.supportedRestrictionTypes=[]}initialize(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchRestrictionTypes();this.model.restrictionTypes=e.map(((e,t)=>Object.assign(Object.assign({},e),{id:t})));if(typeof this.getSupportedRestrictionTypes==="function"){this.supportedRestrictionTypes=yield this.getSupportedRestrictionTypes()}else{this.supportedRestrictionTypes=this.model.restrictionTypes.map((e=>e.code))}}))}getRestrictionsPaged(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n={pageSize:t,currentPage:o,typeCode:this.model.selectedRestrictionType.code,mask:e,itemSearchParams:""};if(o===0){this.restrictions=[]}const s=yield this.cmsitemsRestService.get(n);const a=s.response.map((e=>Object.assign(Object.assign({},e),{id:e.uid})));this.restrictions=this.restrictions.concat(a);return{pagination:s.pagination,results:a}}))}getRestrictionFromBackend(){return Promise.resolve({})}getRestrictionTypes(){return Promise.resolve(this.model.restrictionTypes)}restrictionSelected(){if(this.selectedIds.restriction){this.selectedRestriction=this.restrictions.find((e=>e.id===this.selectedIds.restriction));return true}return false}restrictionTypeSelected(){this.selectedIds.restriction=null;this.model.selectedRestrictionType=(this.model.restrictionTypes||[]).find((e=>e.id===this.selectedIds.restrictionType))||null;if(this.model.selectedRestrictionType){this.selectedRestriction={typeCode:this.model.selectedRestrictionType.code};return true}return false}createRestrictionSelected(e,t){return __awaiter(this,void 0,void 0,(function*(){this.selectedRestriction={itemtype:this.model.selectedRestrictionType.code,name:e};const o=yield this.catalogService.getCatalogVersionUUid(t);this.selectedRestriction.catalogVersion=o}))}getRestrictionTypeCode(){var e;return(e=this.model.selectedRestrictionType)===null||e===void 0?void 0:e.code}getRestriction(){return this.selectedRestriction}isTypeSupported(){if(this.getRestrictionTypeCode()){return this.supportedRestrictionTypes.includes(this.model.selectedRestrictionType.code)}return false}}let dt=class RestrictionManagementSelectModelFactory{constructor(e,t){this.cmsitemsRestService=e;this.catalogService=t}createRestrictionManagementSelectModel(e,t){const o=new RestrictionManagementSelectModel(this.cmsitemsRestService,this.catalogService,e,t);o.initialize();return o}};dt.$inject=["cmsitemsRestService","catalogService"];dt=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.CmsitemsRestService,m.ICatalogService])],dt);let pt=class RestrictionPickerConfigService{constructor(){this.MODE_EDITING="editing";this.MODE_SELECT="select"}getConfigForEditing(e,t){return{mode:this.MODE_EDITING,restriction:e,getSupportedRestrictionTypesFn:t}}getConfigForSelecting(e,t,o){return{mode:this.MODE_SELECT,getRestrictionTypesFn:t,getSupportedRestrictionTypesFn:o,existingRestrictions:e}}isEditingMode(e){return e.mode===this.MODE_EDITING}isSelectMode(e){return e.mode===this.MODE_SELECT}isValidConfig(e){switch(e.mode){case this.MODE_EDITING:return u.isObject(e.restriction);case this.MODE_SELECT:if(e.getSupportedRestrictionTypesFn){return u.isFunction(e.getRestrictionTypesFn)&&u.isFunction(e.getSupportedRestrictionTypesFn)}return u.isFunction(e.getRestrictionTypesFn);default:return false}}};pt=__decorate([m.SeDowngradeService()],pt);window.__smartedit__.addDecoratorPayload("Component","RestrictionManagementComponent",{selector:"se-restriction-management",template:`<div *ngIf="isReady"><div *ngIf="isEditMode"><se-restriction-management-edit [restriction]="config?.restriction" [getSupportedRestrictionTypes]="config?.getSupportedRestrictionTypesFn" [uriContext]="uriContext" [(isDirtyFn)]="isDirtyInternal" [(submitFn)]="submitInternal"></se-restriction-management-edit></div><div *ngIf="!isEditMode"><se-restriction-management-select [existingRestrictions]="config?.existingRestrictions" [fetchRestrictionTypes]="config?.getRestrictionTypesFn" [getSupportedRestrictionTypes]="config?.getSupportedRestrictionTypesFn" [uriContext]="uriContext" [(isDirtyFn)]="isDirtyInternal" [(submitFn)]="submitInternal"></se-restriction-management-select></div></div>`});let mt=class RestrictionManagementComponent{constructor(e){this.restrictionPickerConfigService=e;this.submitFnChange=new s.EventEmitter;this.isDirtyFnChange=new s.EventEmitter;this.isReady=false;this.isEditMode=false}ngOnInit(){setTimeout((()=>{this.submitFnChange.emit((()=>this.submitInternal().then((e=>e))));this.isDirtyFnChange.emit((()=>this.isDirtyInternal&&this.isDirtyInternal()))}))}ngOnChanges(){if(!this.config){return}if(this.restrictionPickerConfigService.isValidConfig(this.config)){this.isReady=true;this.isEditMode=this.restrictionPickerConfigService.isEditingMode(this.config)}else{throw"RestrictionManagementComponent - invalid restrictionPickerConfig"}}};mt.$inject=["restrictionPickerConfigService"];__decorate([s.Input(),__metadata("design:type",Object)],mt.prototype,"config",void 0);__decorate([s.Input(),__metadata("design:type",Object)],mt.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Function)],mt.prototype,"submitFn",void 0);__decorate([s.Input(),__metadata("design:type",Function)],mt.prototype,"isDirtyFn",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],mt.prototype,"submitFnChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],mt.prototype,"isDirtyFnChange",void 0);mt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restriction-management",template:`<div *ngIf="isReady"><div *ngIf="isEditMode"><se-restriction-management-edit [restriction]="config?.restriction" [getSupportedRestrictionTypes]="config?.getSupportedRestrictionTypesFn" [uriContext]="uriContext" [(isDirtyFn)]="isDirtyInternal" [(submitFn)]="submitInternal"></se-restriction-management-edit></div><div *ngIf="!isEditMode"><se-restriction-management-select [existingRestrictions]="config?.existingRestrictions" [fetchRestrictionTypes]="config?.getRestrictionTypesFn" [getSupportedRestrictionTypes]="config?.getSupportedRestrictionTypesFn" [uriContext]="uriContext" [(isDirtyFn)]="isDirtyInternal" [(submitFn)]="submitInternal"></se-restriction-management-select></div></div>`}),__metadata("design:paramtypes",[pt])],mt);window.__smartedit__.addDecoratorPayload("Component","RestrictionManagementEditComponent",{selector:"se-restriction-management-edit",template:`<div *ngIf="ready"><div *ngIf="isTypeSupported"><div class="se-restriction-management-edit__header"><div>{{ restriction.name }}</div><div>{{ restriction.typeCode }}</div></div><div><se-item-manager [item]="restriction" [mode]="itemManagementMode" [structureApi]="structureApi" [contentApi]="contentApi" [uriContext]="uriContext" [componentType]="restriction.itemtype" [(submitFunction)]="submitInternal" [(isDirty)]="isDirtyInternal"></se-item-manager></div></div><div *ngIf="!isTypeSupported"><div class="se-restrictions-list__item-content"><div translate="se.cms.restriction.management.select.type.not.supported.warning"></div><p class="se-restriction__item-name">{{ restriction.name }}</p><div class="se-restriction__item-description">{{ restriction.description }}</div></div></div></div>`,styles:[`.se-restriction-management-edit__header{margin-bottom:16px}`,`#restrictions-label{display:none}.se-restriction__select{text-transform:capitalize;width:100%}.se-restrictions-list__item-content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;cursor:default;flex-grow:1}#userGroups-selector .se-generic-editor-multiple-dropdown__match li[draggable=true]{display:flex;flex-direction:row;align-items:center;justify-content:center;display:inline-flex!important;border:1px solid #d9d9d9;margin:4px 0 4px 8px;padding:4px 8px;border-radius:4px;background-color:var(--fd-token-background-color);color:#51555a;min-height:28px}`]});let gt=class RestrictionManagementEditComponent{constructor(e){this.restrictionsService=e;this.isDirtyFnChange=new s.EventEmitter;this.submitFnChange=new s.EventEmitter;this.ready=false;this.itemManagementMode="edit";this.structureApi=this.restrictionsService.getStructureApiUri(this.itemManagementMode)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=m.cmsitemsUri+"/:identifier";this.restriction=this.restriction||{};this.contentApi=new m.URIBuilder(e).replaceParams(this.uriContext).build();if(typeof this.getSupportedRestrictionTypes!=="undefined"){const e=yield this.getSupportedRestrictionTypes();this.emitActions(e.includes(this.restriction.itemtype))}else{return this.emitActions(true)}}))}emitActions(e){this.isTypeSupported=e;if(e){this.submitFnChange.emit((()=>this.submitInternal().then((e=>Promise.resolve(e)))));this.isDirtyFnChange.emit((()=>this.isDirtyLocal()))}else{this.submitFnChange.emit((()=>Promise.resolve(null)));this.isDirtyFnChange.emit((()=>false))}this.ready=true}isDirtyLocal(){if(this.isDirtyInternal){return this.isDirtyInternal()}return false}};gt.$inject=["restrictionsService"];__decorate([s.Input(),__metadata("design:type",Object)],gt.prototype,"restriction",void 0);__decorate([s.Input(),__metadata("design:type",Function)],gt.prototype,"getSupportedRestrictionTypes",void 0);__decorate([s.Input(),__metadata("design:type",Object)],gt.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Function)],gt.prototype,"isDirtyFn",void 0);__decorate([s.Input(),__metadata("design:type",Function)],gt.prototype,"submitFn",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],gt.prototype,"isDirtyFnChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],gt.prototype,"submitFnChange",void 0);gt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restriction-management-edit",template:`<div *ngIf="ready"><div *ngIf="isTypeSupported"><div class="se-restriction-management-edit__header"><div>{{ restriction.name }}</div><div>{{ restriction.typeCode }}</div></div><div><se-item-manager [item]="restriction" [mode]="itemManagementMode" [structureApi]="structureApi" [contentApi]="contentApi" [uriContext]="uriContext" [componentType]="restriction.itemtype" [(submitFunction)]="submitInternal" [(isDirty)]="isDirtyInternal"></se-item-manager></div></div><div *ngIf="!isTypeSupported"><div class="se-restrictions-list__item-content"><div translate="se.cms.restriction.management.select.type.not.supported.warning"></div><p class="se-restriction__item-name">{{ restriction.name }}</p><div class="se-restriction__item-description">{{ restriction.description }}</div></div></div></div>`,styles:[`.se-restriction-management-edit__header{margin-bottom:16px}`,`#restrictions-label{display:none}.se-restriction__select{text-transform:capitalize;width:100%}.se-restrictions-list__item-content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;cursor:default;flex-grow:1}#userGroups-selector .se-generic-editor-multiple-dropdown__match li[draggable=true]{display:flex;flex-direction:row;align-items:center;justify-content:center;display:inline-flex!important;border:1px solid #d9d9d9;margin:4px 0 4px 8px;padding:4px 8px;border-radius:4px;background-color:var(--fd-token-background-color);color:#51555a;min-height:28px}`]}),__metadata("design:paramtypes",[t.RestrictionsService])],gt);window.__smartedit__.addDecoratorPayload("Component","RestrictionManagementSelectItemComponent",{selector:"se-restriction-management-select-item",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<span class="se-restriction-management-item-name">{{\n        data.item.name | seL10n | async\n    }}</span>`});let ut=class RestrictionManagementSelectItemComponent{constructor(e){this.data=e}};ut=__decorate([s.Component({selector:"se-restriction-management-select-item",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<span class="se-restriction-management-item-name">{{\n        data.item.name | seL10n | async\n    }}</span>`}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],ut);window.__smartedit__.addDecoratorPayload("Component","RestrictionManagementSelectComponent",{selector:"se-restriction-management-select",template:`<div><se-message [style.display]="showWarningMessage() ? 'block' : 'none'" [type]="'warning'"><span se-message-title translate="se.cms.restriction.management.select.type.not.supported.warning"></span></se-message><div class="se-restriction-management-select__select"><label class="se-control-label">{{ 'se.cms.restriction.management.select.type.label' | translate }}</label><se-select id="restriction-type" [fetchStrategy]="fetchStrategy" [itemComponent]="itemComponent" [placeholder]="'se.cms.restriction.management.select.type.placeholder'" [(model)]="selectModel.selectedIds.restrictionType" (modelChange)="selectRestrictionType()" [searchEnabled]="false"></se-select></div><div *ngIf="viewConfig.showRestrictionSelector" class="se-restriction-management-select__restriction-info"><label class="se-control-label" translate="se.cms.restriction.management.select.restriction.label"></label><se-select id="restriction-name" [fetchStrategy]="fetchOptions" [(model)]="selectModel.selectedIds.restriction" (modelChange)="selectRestriction()" [placeholder]="'se.cms.restriction.management.select.restriction.placeholder'" [disableChoiceFn]="disableRestrictionChoice" [itemComponent]="itemComponent" [resultsHeaderLabel]="resultsHeaderLabel" [actionableSearchItem]="actionableSearchItem" [(reset)]="reset"></se-select></div><div class="se-restriction-management-select__restriction-editor" *ngIf="viewConfig.showRestrictionEditor"><p class="se-restriction-management-select__new-restriction-message" [translate]="editorHeader"></p><div *ngIf="selectModel.isTypeSupported()"><se-item-manager [item]="selectModel.getRestriction()" [mode]="viewConfig.mode" [structureApi]="viewConfig.structureApi" [contentApi]="viewConfig.contentApi" [uriContext]="uriContext" [componentType]="selectModel.getRestrictionTypeCode()" [(submitFunction)]="submitInternal" [(isDirty)]="isDirtyInternal"></se-item-manager></div><div *ngIf="!selectModel.isTypeSupported()"><p class="se-restriction__item-name">{{ selectModel.getRestriction().name }}</p><div class="se-restriction__item-description">{{ selectModel.getRestriction().description }}</div></div></div></div>`,styles:[`se-restriction-management-select .se-restriction-management-select__restriction-info,se-restriction-management-select .se-restriction-management-select__select{margin-bottom:16px}se-restriction-management-select .se-restriction-management-select__restriction-editor{border-top:1px solid #d9d9d9;padding-top:16px}se-restriction-management-select .se-restriction-management-select__new-restriction-message{font-weight:700}se-restriction-management-select .fd-menu__list-header{font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding:8px 12px;border-bottom:1px solid #d9d9d9;color:#51555a;list-style:none;padding-left:24px}se-restriction-management-select .se-select-list__item.is-disabled{opacity:.65}se-restriction-management-select .se-select-list__item.is-disabled .fd-menu__item{cursor:not-allowed}se-restriction-management-select div.se-actionable-search-item{display:flex;align-items:center;justify-content:space-between;padding:0 0 0 13px}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let ht=class RestrictionManagementSelectComponent{constructor(e,t,o,n){this.restrictionManagementSelectModelFactory=e;this.restrictionsService=t;this.systemEventService=o;this.cdr=n;this.RESTRICTION_CREATE_BUTTON_PRESSED_EVENT_ID="RESTRICTION_CREATE_BUTTON_PRESSED_EVENT_ID";this.resultsHeaderLabel="se.cms.restrictionmanagement.restrictionresults.header";this.itemComponent=ut;this.editorHeader="";this.isDirtyFnChange=new s.EventEmitter;this.submitFnChange=new s.EventEmitter}ngOnInit(){this.selectModel=this.restrictionManagementSelectModelFactory.createRestrictionManagementSelectModel(this.fetchRestrictionTypes,this.getSupportedRestrictionTypes);const e=m.cmsitemsUri+"/:identifier";this.viewConfig={showRestrictionSelector:false,showRestrictionEditor:false,mode:"add",contentApi:new m.URIBuilder(e).replaceParams(this.uriContext).build()};this.fetchOptions={fetchPage:(e,t,o)=>this.selectModel.getRestrictionsPaged(e,t,o),fetchEntity:()=>this.selectModel.getRestrictionFromBackend()};this.fetchStrategy={fetchAll:()=>this.selectModel.getRestrictionTypes()};this.disableRestrictionChoice=e=>!!this.existingRestrictions.find((t=>e.uid===t.uid));setTimeout((()=>{this.submitFnChange.emit((()=>__awaiter(this,void 0,void 0,(function*(){if(this.selectModel.isTypeSupported()){return this.submitInternal().then((e=>e))}return this.selectModel.getRestriction()}))));this.isDirtyFnChange.emit((()=>{if(this.viewConfig.mode==="add"){return this.viewConfig.showRestrictionEditor}else if(this.isDirtyInternal){return this.isDirtyInternal()}return false}))}));this.createButtonUnsubscribe=this.systemEventService.subscribe(this.RESTRICTION_CREATE_BUTTON_PRESSED_EVENT_ID,((e,t)=>this.createButtonEventHandler(t)))}ngOnDestroy(){if(this.createButtonUnsubscribe){this.createButtonUnsubscribe()}}selectRestrictionType(){if(this.selectModel.restrictionTypeSelected()){if(this.viewConfig.showRestrictionSelector){this.resetSelector()}else{this.viewConfig.showRestrictionSelector=true}this.viewConfig.showRestrictionEditor=false}this.actionableSearchItem=this.selectModel.isTypeSupported()?{eventId:this.RESTRICTION_CREATE_BUTTON_PRESSED_EVENT_ID}:undefined}selectRestriction(){if(this.selectModel.restrictionSelected()){this.setViewConfig("se.cms.restriction.management.select.editor.header.add","add");if(!this.viewConfig.showRestrictionEditor){this.viewConfig.showRestrictionEditor=true}}}createRestriction(e){return __awaiter(this,void 0,void 0,(function*(){yield this.selectModel.createRestrictionSelected(e,this.uriContext);this.setViewConfig("se.cms.restriction.management.select.editor.header.create","create");if(this.viewConfig.showRestrictionEditor){this.resetSelector()}else{this.viewConfig.showRestrictionEditor=true}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}showWarningMessage(){return this.selectModel.getRestriction()&&!this.selectModel.isTypeSupported()}createButtonEventHandler(e){this.createRestriction(e)}resetSelector(){if(typeof this.reset==="function"){this.reset(true)}}setViewConfig(e,t){this.editorHeader=e;this.viewConfig.mode=t;this.viewConfig.structureApi=this.restrictionsService.getStructureApiUri(this.viewConfig.mode)}};ht.$inject=["restrictionManagementSelectModelFactory","restrictionsService","systemEventService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],ht.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Array)],ht.prototype,"existingRestrictions",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ht.prototype,"fetchRestrictionTypes",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ht.prototype,"getSupportedRestrictionTypes",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ht.prototype,"isDirtyFn",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ht.prototype,"submitFn",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],ht.prototype,"isDirtyFnChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],ht.prototype,"submitFnChange",void 0);ht=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restriction-management-select",template:`<div><se-message [style.display]="showWarningMessage() ? 'block' : 'none'" [type]="'warning'"><span se-message-title translate="se.cms.restriction.management.select.type.not.supported.warning"></span></se-message><div class="se-restriction-management-select__select"><label class="se-control-label">{{ 'se.cms.restriction.management.select.type.label' | translate }}</label><se-select id="restriction-type" [fetchStrategy]="fetchStrategy" [itemComponent]="itemComponent" [placeholder]="'se.cms.restriction.management.select.type.placeholder'" [(model)]="selectModel.selectedIds.restrictionType" (modelChange)="selectRestrictionType()" [searchEnabled]="false"></se-select></div><div *ngIf="viewConfig.showRestrictionSelector" class="se-restriction-management-select__restriction-info"><label class="se-control-label" translate="se.cms.restriction.management.select.restriction.label"></label><se-select id="restriction-name" [fetchStrategy]="fetchOptions" [(model)]="selectModel.selectedIds.restriction" (modelChange)="selectRestriction()" [placeholder]="'se.cms.restriction.management.select.restriction.placeholder'" [disableChoiceFn]="disableRestrictionChoice" [itemComponent]="itemComponent" [resultsHeaderLabel]="resultsHeaderLabel" [actionableSearchItem]="actionableSearchItem" [(reset)]="reset"></se-select></div><div class="se-restriction-management-select__restriction-editor" *ngIf="viewConfig.showRestrictionEditor"><p class="se-restriction-management-select__new-restriction-message" [translate]="editorHeader"></p><div *ngIf="selectModel.isTypeSupported()"><se-item-manager [item]="selectModel.getRestriction()" [mode]="viewConfig.mode" [structureApi]="viewConfig.structureApi" [contentApi]="viewConfig.contentApi" [uriContext]="uriContext" [componentType]="selectModel.getRestrictionTypeCode()" [(submitFunction)]="submitInternal" [(isDirty)]="isDirtyInternal"></se-item-manager></div><div *ngIf="!selectModel.isTypeSupported()"><p class="se-restriction__item-name">{{ selectModel.getRestriction().name }}</p><div class="se-restriction__item-description">{{ selectModel.getRestriction().description }}</div></div></div></div>`,styles:[`se-restriction-management-select .se-restriction-management-select__restriction-info,se-restriction-management-select .se-restriction-management-select__select{margin-bottom:16px}se-restriction-management-select .se-restriction-management-select__restriction-editor{border-top:1px solid #d9d9d9;padding-top:16px}se-restriction-management-select .se-restriction-management-select__new-restriction-message{font-weight:700}se-restriction-management-select .fd-menu__list-header{font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding:8px 12px;border-bottom:1px solid #d9d9d9;color:#51555a;list-style:none;padding-left:24px}se-restriction-management-select .se-select-list__item.is-disabled{opacity:.65}se-restriction-management-select .se-select-list__item.is-disabled .fd-menu__item{cursor:not-allowed}se-restriction-management-select div.se-actionable-search-item{display:flex;align-items:center;justify-content:space-between;padding:0 0 0 13px}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[dt,t.RestrictionsService,m.SystemEventService,s.ChangeDetectorRef])],ht);window.__smartedit__.addDecoratorPayload("Component","RestrictionsTableComponent",{selector:"se-restrictions-table",template:`<div class="se-restriction-table-wrapper se-restriction-table-left" [ngClass]="customClass"><div class="se-restrictions-list fd-menu__list fd-menu__list--separated" *ngIf="restrictions.length > 0"><div id="restriction-{{ index + 1 }}" *ngFor="let restriction of restrictions; let index = index" class="se-restriction__item fd-menu__item"><div class="se-restrictions-list__item-content"><p class="se-restriction__item-name" [ngClass]="{ 'error-input': isInError(index) }">{{ restriction.name }}</p><div class="se-restriction__item-type-and-id" [ngClass]="{ 'error-input': isInError(index) }">{{ restriction.typeCode }}</div><div class="se-restriction__item-description" [ngClass]="{ 'error-input': isInError(index) }" [title]="restriction.description">{{ restriction.description }}</div><div id="restrictionPartOfWorkflow" *ngIf="restriction.canBeEdited!==undefined && !restriction.canBeEdited" translate="se.cms.restrictions.editor.part.of.workflow"></div></div><div *ngIf="editable"><se-dropdown-menu [dropdownItems]="restriction.actions || defaultActions" [selectedItem]="restriction" [placement]="'bottom-start'"></se-dropdown-menu></div></div></div><div *ngIf="restrictions.length === 0" class="se-restrictions-list--empty"><span class="se-restrictions-list--empty__message" translate="se.cms.restrictions.emptylist.message"></span></div></div>`,styles:[`.se-restrictions-list .se-restriction__item{display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-top-color:#eeeeef!important;cursor:default}.se-restrictions-list .se-restriction__item:last-child{margin-bottom:42px}.se-restriction__item-name{font-weight:700;color:#32363a;margin:0}.se-restriction__item-type-and-id{color:#51555a;margin-top:0}.se-restriction__item-description{text-overflow:ellipsis;white-space:initial;overflow:hidden;word-break:break-all;color:#6a6d70;width:90%}.se-restrictions-list--empty__message{color:#6a6d70}.error-input.se-restriction__item-description,.error-input.se-restriction__item-name,.error-input.se-restriction__item-type-and-id{color:#b00}`]});let vt=class RestrictionsTableComponent{constructor(e){this.pageRestrictionsCriteriaService=e;this.REMOVE_RESTRICTION_KEY="se.cms.restrictions.item.remove";this.EDIT_RESTRICTION_KEY="se.cms.restrictions.item.edit";this.onEdit=new s.EventEmitter;this.onRemove=new s.EventEmitter;this.errors=[];this.criteriaOptions=[];this.defaultActions=[];this.oldRestrictionsEditability=[]}ngOnInit(){this.oldRestrictionsEditability=this.getRestrictionsEditability(this.restrictions);this.defaultActions=this.getDefaultActions();this.provideActionsForRestrictions();this.criteriaOptions=this.pageRestrictionsCriteriaService.getRestrictionCriteriaOptions();this.resetRestrictionCriteria()}ngOnChanges(){if(this.restrictionsEditabilityChanged(this.restrictions)){this.provideActionsForRestrictions();this.oldRestrictionsEditability=this.getRestrictionsEditability(this.restrictions)}this.resetRestrictionCriteria()}resetRestrictionCriteria(){if(!this.restrictions||this.restrictions.length<2){this.restrictionCriteria=this.criteriaOptions[0]}}removeRestriction(e){const t=this.restrictions.findIndex((t=>t.uuid===e.uuid));this.onRemove.emit(t);this.removeUnnecessaryError(t);this.modifyErrorPositions(t)}editRestriction(e){this.onEdit.emit(e)}isInError(e){var t;return!!((t=this.errors)===null||t===void 0?void 0:t.some((t=>t.position===e)))}getRestrictionsEditability(e){return(e||[]).map((e=>e.canBeEdited))}modifyErrorPositions(e){this.errors=this.errors.map((t=>{if(t.position>=e){t.position=t.position-1}return t}))}removeUnnecessaryError(e){const t=this.errors.findIndex((t=>t.position===e));if(t>-1){this.errors=this.errors.filter(((e,o)=>o!==t))}}getDefaultActions(){return[{key:this.EDIT_RESTRICTION_KEY,callback:e=>this.editRestriction(e)},{key:this.REMOVE_RESTRICTION_KEY,callback:e=>this.removeRestriction(e),customCss:"se-dropdown-item__delete"}]}getRestrictionActions(e){const t=this.getDefaultActions();if(!e.canBeEdited){return t.filter((e=>e.key!==this.EDIT_RESTRICTION_KEY))}return t}provideActionsForRestrictions(){(this.restrictions||[]).forEach((e=>{e.actions=this.getRestrictionActions(e)}))}restrictionsEditabilityChanged(e){const t=this.getRestrictionsEditability(e);return!u.isEqual(t,this.oldRestrictionsEditability)}};vt.$inject=["pageRestrictionsCriteriaService"];__decorate([s.Input(),__metadata("design:type",Array)],vt.prototype,"restrictions",void 0);__decorate([s.Input(),__metadata("design:type",String)],vt.prototype,"customClass",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],vt.prototype,"editable",void 0);__decorate([s.Input(),__metadata("design:type",Object)],vt.prototype,"restrictionCriteria",void 0);__decorate([s.Input(),__metadata("design:type",Array)],vt.prototype,"errors",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],vt.prototype,"onEdit",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],vt.prototype,"onRemove",void 0);vt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restrictions-table",template:`<div class="se-restriction-table-wrapper se-restriction-table-left" [ngClass]="customClass"><div class="se-restrictions-list fd-menu__list fd-menu__list--separated" *ngIf="restrictions.length > 0"><div id="restriction-{{ index + 1 }}" *ngFor="let restriction of restrictions; let index = index" class="se-restriction__item fd-menu__item"><div class="se-restrictions-list__item-content"><p class="se-restriction__item-name" [ngClass]="{ 'error-input': isInError(index) }">{{ restriction.name }}</p><div class="se-restriction__item-type-and-id" [ngClass]="{ 'error-input': isInError(index) }">{{ restriction.typeCode }}</div><div class="se-restriction__item-description" [ngClass]="{ 'error-input': isInError(index) }" [title]="restriction.description">{{ restriction.description }}</div><div id="restrictionPartOfWorkflow" *ngIf="restriction.canBeEdited!==undefined && !restriction.canBeEdited" translate="se.cms.restrictions.editor.part.of.workflow"></div></div><div *ngIf="editable"><se-dropdown-menu [dropdownItems]="restriction.actions || defaultActions" [selectedItem]="restriction" [placement]="'bottom-start'"></se-dropdown-menu></div></div></div><div *ngIf="restrictions.length === 0" class="se-restrictions-list--empty"><span class="se-restrictions-list--empty__message" translate="se.cms.restrictions.emptylist.message"></span></div></div>`,styles:[`.se-restrictions-list .se-restriction__item{display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-top-color:#eeeeef!important;cursor:default}.se-restrictions-list .se-restriction__item:last-child{margin-bottom:42px}.se-restriction__item-name{font-weight:700;color:#32363a;margin:0}.se-restriction__item-type-and-id{color:#51555a;margin-top:0}.se-restriction__item-description{text-overflow:ellipsis;white-space:initial;overflow:hidden;word-break:break-all;color:#6a6d70;width:90%}.se-restrictions-list--empty__message{color:#6a6d70}.error-input.se-restriction__item-description,.error-input.se-restriction__item-name,.error-input.se-restriction__item-type-and-id{color:#b00}`]}),__metadata("design:paramtypes",[t.PageRestrictionsCriteriaService])],vt);window.__smartedit__.addDecoratorPayload("Component","RestrictionEditorCriteriaSelectItemComponent",{selector:"se-restriction-editor-criteria-select-item",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<span [translate]="data.item.editLabel"></span>`});let _t=class RestrictionEditorCriteriaSelectItemComponent{constructor(e){this.data=e}};_t=__decorate([s.Component({selector:"se-restriction-editor-criteria-select-item",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<span [translate]="data.item.editLabel"></span>`}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],_t);const ft="se-item-management-editor";window.__smartedit__.addDecoratorPayload("Component","RestrictionsEditorComponent",{selector:"se-restrictions-editor",template:`<div class="se-restrictions-container"><div class="se-restrictions-container__header" [ngClass]="{ 'se-restrictions-container__header--empty': restrictions.length === 0 }"><label class="se-restrictions__sub-header" translate="se.cms.restrictions.list.title"></label><div class="se-restrictions-container__header--right"><div *ngIf="restrictions.length > 1"><div *ngIf="editable"><se-select id="criteria-type" [fetchStrategy]="criteriaFetchStrategy" [itemComponent]="itemComponent" [placeholder]="'se.cms.restrictions.picker.type.placeholder'" [model]="criteria.id" (modelChange)="matchCriteriaChanged($event)" [searchEnabled]="false"></se-select></div><div *ngIf="!editable">{{ 'se.cms.restrictions.criteria' | translate }} {{ criteria.label | translate }}</div></div><button *ngIf="!showRestrictionPicker" type="button" class="se-restrictions__add-restriction-btn fd-button--cozy" [disabled]="!editable" (click)="onAddRestriction()"><span translate="se.cms.restrictions.editor.button.add.new"></span></button> <button class="cms-clean-btn se-restriction__clear-all__btn fd-button--light fd-button--compact" *ngIf="showRemoveAllButton()" (click)="removeAllRestrictions()" translate="se.cms.restrictions.list.clear.all"></button></div></div><se-slider-panel [sliderPanelConfiguration]="sliderPanelConfiguration" [(sliderPanelHide)]="sliderPanelHide" [(sliderPanelShow)]="sliderPanelShow" (isShownChange)="onSliderVisibilityChange($event)" class="se-add-restriction-panel"><se-restriction-management *ngIf="isSliderVisible" class="se-se-add-restriction-panel__restriction-management" [config]="restrictionManagement.config" [uriContext]="restrictionManagement.uriContext" [(submitFn)]="restrictionManagement.submitFn" [(isDirtyFn)]="restrictionManagement.isDirtyFn"></se-restriction-management></se-slider-panel><div *ngIf="errors.length > 0"><span class="se-help-block--has-error help-block fd-form__message fd-form__message--error" *ngFor="let error of errors" [translate]="error.message"></span></div><se-restrictions-table *ngIf="isRestrictionsReady" [editable]="editable" [restrictions]="restrictions" [restrictionCriteria]="criteria" [errors]="errors" [customClass]="'ySERestrictionListLink'" (onEdit)="onEditRestriction($event)" (onRemove)="onRemoveRestriction($event)"></se-restrictions-table></div>`,styles:[`.se-restrictions-container__header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;padding-bottom:12px}.se-restrictions-container__header--right{display:flex;flex-direction:row;align-items:center}.se-restrictions-container__header--right>div,.se-restrictions-container__header--right>span{margin-left:12px;margin-right:16px;width:115px}.se-restrictions-container__header--empty{border-bottom:none}.se-restrictions__sub-header{font-weight:700;align-self:flex-start;color:#51555a;margin:0}.se-restriction__clear-all__btn{text-transform:capitalize}`]});let yt=class RestrictionsEditorComponent{constructor(e,t,o,n,a,r,d){this.logService=e;this.systemEventService=t;this.restrictionPickerConfigService=o;this.pageRestrictionsCriteriaService=n;this.contextAwareEditableItemService=a;this.cmsitemsRestService=r;this.cdr=d;this.cancelFnChange=new s.EventEmitter;this.isDirtyFnChange=new s.EventEmitter;this.onRestrictionsChange=new s.EventEmitter;this.resetFnChange=new s.EventEmitter;this.errors=[];this.restrictions=[];this.originalRestrictions=[];this.restrictionUuids=[];this.isRestrictionsReady=false;this.restrictionsArrayIsDirty=false;this.showRestrictionPicker=false;this.disableAddButton=false;this.criteriaOptions=[];this.criteria={};this.itemComponent=_t;this.matchCriteriaIsDirty=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.restrictionUuids=this.restrictionUuids||[];const e=yield this.cmsitemsRestService.getByIdsNoCache(this.restrictionUuids,"FULL");const t=2;this.restrictions=e.response?e.response:[e];this.criteriaFetchStrategy={fetchAll:()=>Promise.resolve(this.criteriaOptions)};this.prepareRestrictionsCriteria();yield this.setupResults();this.sliderPanelConfiguration={modal:{showDismissButton:true,title:"",dismiss:{label:"se.cms.restriction.management.panel.button.cancel",onClick:()=>{this.sliderPanelHide()},isDisabledFn:()=>false},save:{onClick:()=>{},label:"",isDisabledFn:()=>false}},cssSelector:"#y-modal-dialog"};this.restrictionManagement={uriContext:this.item.uriContext,submitFn:null,isDirtyFn:null,config:null};this.isDirtyFnChange.emit((()=>this.restrictionsArrayIsDirty||this.matchCriteriaIsDirty&&this.restrictionUuids.length>=t));this.resetFnChange.emit((()=>true));this.cancelFnChange.emit((()=>Promise.resolve(true)));this.initEvents();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){this.clearEvents()}ngOnChanges(e){return __awaiter(this,void 0,void 0,(function*(){if(!e.restrictionUuids){return Promise.resolve()}this.restrictionsArrayIsDirty=!e.restrictionUuids.firstChange&&JSON.stringify(this.originalRestrictions)!==JSON.stringify(this.restrictions);const t=!u.isEqual(e.restrictionUuids.previousValue,e.restrictionUuids.currentValue);if(t){this.indexRestrictions()}return this.applyIsRestrictionEditable()}))}onAddRestriction(){this.setSliderConfigForAddOrCreate();this.restrictionManagement.config=this.restrictionPickerConfigService.getConfigForSelecting([...this.restrictions],this.getRestrictionTypes,this.getSupportedRestrictionTypes);this.sliderPanelShow()}onEditRestriction(e){this.setSliderConfigForEditing();this.restrictionManagement.config=this.restrictionPickerConfigService.getConfigForEditing(Object.assign({},e),this.getSupportedRestrictionTypes);this.sliderPanelShow()}onRemoveRestriction(e){this.restrictions=this.restrictions.filter(((t,o)=>o!==e));this.updateRestrictionsData()}removeAllRestrictions(){this.restrictions=[];if(this.removeValidationMessages){this.removeValidationMessages()}this.updateRestrictionsData()}showRemoveAllButton(){return this.restrictionUuids.length>0&&this.editable}matchCriteriaChanged(e){this.criteria=this.criteriaOptions.find((t=>t.id===e));this.matchCriteriaIsDirty=this.criteria!==this.originalCriteria;this.updateRestrictionsData()}onSliderVisibilityChange(e){this.isSliderVisible=e}setupResults(){return __awaiter(this,void 0,void 0,(function*(){this.indexRestrictions();this.originalRestrictions=this.cloneRestrictions(this.restrictions);this.updateRestrictionsData();yield this.applyIsRestrictionEditable();this.isRestrictionsReady=true}))}updateRestrictionsData(e=false){this.onRestrictionsChange.emit({onlyOneRestrictionMustApply:this.criteria.value,restrictionUuids:this.restrictions.map((e=>e.uuid)),alwaysEnableSubmit:e})}prepareRestrictionsCriteria(){this.criteriaOptions=this.pageRestrictionsCriteriaService.getRestrictionCriteriaOptions();if(!!this.item.onlyOneRestrictionMustApply){this.criteria=this.criteriaOptions[1];this.originalCriteria=this.criteriaOptions[1]}else{this.criteria=this.criteriaOptions[0];this.originalCriteria=this.criteriaOptions[0]}}isRestrictionRelatedError(e){return u.includes(e.subject,"restrictions")}formatRestrictionRelatedError(e){const t=u.clone(e);if(!m.stringUtils.isBlank(t.position)){t.position=parseInt(t.position,10)}if(!m.stringUtils.isBlank(t.subject)){t.subject=t.subject.split(".").pop()}return t}handleUnrelatedValidationErrors(e){this.errors=e.messages.filter((e=>this.isRestrictionRelatedError(e))).map((e=>this.formatRestrictionRelatedError(e)))}propagateErrors(e){var t;return __awaiter(this,void 0,void 0,(function*(){const o=((t=this.restrictionManagement.config)===null||t===void 0?void 0:t.mode)===this.restrictionPickerConfigService.MODE_EDITING&&e===ft;if(!o){return}const n=this.restrictionManagement.config.restriction.restrictionIndex;const s=this.errors.filter((e=>e.position===n));this.clearEvents();yield this.systemEventService.publishAsync(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,{messages:s,targetGenericEditorId:e});this.initEvents()}))}indexRestrictions(){this.restrictions=(this.restrictions||[]).map(((e,t)=>Object.assign(Object.assign({},e),{restrictionIndex:t})))}cloneRestrictions(e){return u.cloneDeep(e)}initEvents(){this.unregisterErrorListener=this.systemEventService.subscribe(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,((e,t)=>this.handleUnrelatedValidationErrors(t)));this.unregisterErrorPropagationEvent=this.systemEventService.subscribe(m.GENERIC_EDITOR_LOADED_EVENT,((e,t)=>this.propagateErrors(t)))}clearEvents(){try{this.unregisterErrorListener();this.unregisterErrorPropagationEvent()}catch(e){}}applyIsRestrictionEditable(){return __awaiter(this,void 0,void 0,(function*(){this.restrictions=yield Promise.all(this.restrictions.map((e=>__awaiter(this,void 0,void 0,(function*(){if(e.uid){e.canBeEdited=yield this.contextAwareEditableItemService.isItemEditable(e.uid);if(!this.cdr.destroyed){this.cdr.detectChanges()}return e}e.canBeEdited=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}return e})))))}))}setSliderConfigForAddOrCreate(){this.sliderPanelConfiguration.modal.title="se.cms.restriction.management.panel.title.add";this.sliderPanelConfiguration.modal.save.label="se.cms.restriction.management.panel.button.add";this.sliderPanelConfiguration.modal.save.isDisabledFn=()=>{if(this.disableAddButton){return true}if(this.restrictionManagement.isDirtyFn){return!this.restrictionManagement.isDirtyFn()}return true};this.sliderPanelConfiguration.modal.save.onClick=()=>__awaiter(this,void 0,void 0,(function*(){try{this.disableAddButton=true;const e=yield this.restrictionManagement.submitFn();this.disableAddButton=false;this.restrictions=this.restrictions.concat(e);this.updateRestrictionsData();this.sliderPanelHide()}catch(e){this.disableAddButton=false;this.logService.warn("RestrictionsEditorComponent.setSliderConfigForAddOrCreate - Failed to create restriction")}}))}setSliderConfigForEditing(){this.sliderPanelConfiguration.modal.title="se.cms.restriction.management.panel.title.edit";this.sliderPanelConfiguration.modal.save.label="se.cms.restriction.management.panel.button.save";this.sliderPanelConfiguration.modal.save.isDisabledFn=()=>{if(this.restrictionManagement.isDirtyFn){return!this.restrictionManagement.isDirtyFn()}return true};this.sliderPanelConfiguration.modal.save.onClick=()=>__awaiter(this,void 0,void 0,(function*(){const e=yield this.restrictionManagement.submitFn();if(this.restrictionManagement.config){const t=this.restrictionManagement.config.restriction;e.restrictionIndex=t.restrictionIndex}const t=e.restrictionIndex;if(t!==-1){this.restrictions=this.restrictions.map(((o,n)=>{if(n===t){return e}return o}))}else{throw new Error("RestrictionsEditorComponent - edited restriction not found in list: "+e)}this.updateRestrictionsData(true);this.sliderPanelHide()}))}};yt.$inject=["logService","systemEventService","restrictionPickerConfigService","pageRestrictionsCriteriaService","contextAwareEditableItemService","cmsitemsRestService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],yt.prototype,"item",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],yt.prototype,"editable",void 0);__decorate([s.Input(),__metadata("design:type",Function)],yt.prototype,"resetFn",void 0);__decorate([s.Input(),__metadata("design:type",Function)],yt.prototype,"cancelFn",void 0);__decorate([s.Input(),__metadata("design:type",Function)],yt.prototype,"isDirtyFn",void 0);__decorate([s.Input(),__metadata("design:type",Function)],yt.prototype,"getRestrictionTypes",void 0);__decorate([s.Input(),__metadata("design:type",Function)],yt.prototype,"getSupportedRestrictionTypes",void 0);__decorate([s.Input(),__metadata("design:type",Function)],yt.prototype,"removeValidationMessages",void 0);__decorate([s.Input(),__metadata("design:type",Array)],yt.prototype,"restrictionUuids",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],yt.prototype,"onRestrictionsChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],yt.prototype,"resetFnChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],yt.prototype,"cancelFnChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],yt.prototype,"isDirtyFnChange",void 0);yt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restrictions-editor",template:`<div class="se-restrictions-container"><div class="se-restrictions-container__header" [ngClass]="{ 'se-restrictions-container__header--empty': restrictions.length === 0 }"><label class="se-restrictions__sub-header" translate="se.cms.restrictions.list.title"></label><div class="se-restrictions-container__header--right"><div *ngIf="restrictions.length > 1"><div *ngIf="editable"><se-select id="criteria-type" [fetchStrategy]="criteriaFetchStrategy" [itemComponent]="itemComponent" [placeholder]="'se.cms.restrictions.picker.type.placeholder'" [model]="criteria.id" (modelChange)="matchCriteriaChanged($event)" [searchEnabled]="false"></se-select></div><div *ngIf="!editable">{{ 'se.cms.restrictions.criteria' | translate }} {{ criteria.label | translate }}</div></div><button *ngIf="!showRestrictionPicker" type="button" class="se-restrictions__add-restriction-btn fd-button--cozy" [disabled]="!editable" (click)="onAddRestriction()"><span translate="se.cms.restrictions.editor.button.add.new"></span></button> <button class="cms-clean-btn se-restriction__clear-all__btn fd-button--light fd-button--compact" *ngIf="showRemoveAllButton()" (click)="removeAllRestrictions()" translate="se.cms.restrictions.list.clear.all"></button></div></div><se-slider-panel [sliderPanelConfiguration]="sliderPanelConfiguration" [(sliderPanelHide)]="sliderPanelHide" [(sliderPanelShow)]="sliderPanelShow" (isShownChange)="onSliderVisibilityChange($event)" class="se-add-restriction-panel"><se-restriction-management *ngIf="isSliderVisible" class="se-se-add-restriction-panel__restriction-management" [config]="restrictionManagement.config" [uriContext]="restrictionManagement.uriContext" [(submitFn)]="restrictionManagement.submitFn" [(isDirtyFn)]="restrictionManagement.isDirtyFn"></se-restriction-management></se-slider-panel><div *ngIf="errors.length > 0"><span class="se-help-block--has-error help-block fd-form__message fd-form__message--error" *ngFor="let error of errors" [translate]="error.message"></span></div><se-restrictions-table *ngIf="isRestrictionsReady" [editable]="editable" [restrictions]="restrictions" [restrictionCriteria]="criteria" [errors]="errors" [customClass]="'ySERestrictionListLink'" (onEdit)="onEditRestriction($event)" (onRemove)="onRemoveRestriction($event)"></se-restrictions-table></div>`,styles:[`.se-restrictions-container__header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;padding-bottom:12px}.se-restrictions-container__header--right{display:flex;flex-direction:row;align-items:center}.se-restrictions-container__header--right>div,.se-restrictions-container__header--right>span{margin-left:12px;margin-right:16px;width:115px}.se-restrictions-container__header--empty{border-bottom:none}.se-restrictions__sub-header{font-weight:700;align-self:flex-start;color:#51555a;margin:0}.se-restriction__clear-all__btn{text-transform:capitalize}`]}),__metadata("design:paramtypes",[m.LogService,m.SystemEventService,pt,t.PageRestrictionsCriteriaService,p.IContextAwareEditableItemService,m.CmsitemsRestService,s.ChangeDetectorRef])],yt);let St=class RestrictionsModule{};St=__decorate([s.NgModule({imports:[f.CommonModule,v.TranslateModule.forChild(),m.SeGenericEditorModule,m.MessageModule,m.SelectModule,m.L10nPipeModule,m.DropdownMenuModule,m.SliderPanelModule],providers:[pt,dt],declarations:[gt,ct,ht,ut,mt,vt,yt,_t],entryComponents:[gt,ct,ht,ut,mt,vt,yt,_t],exports:[yt]})],St);window.__smartedit__.addDecoratorPayload("Component","PageRestrictionsEditorComponent",{selector:"se-page-restrictions-editor",template:`<se-page-restrictions-info-message *ngIf="page.restrictions?.length > 1"></se-page-restrictions-info-message><se-restrictions-editor [editable]="isEditable" [getRestrictionTypes]="getRestrictionTypes" [getSupportedRestrictionTypes]="getSupportedRestrictionTypes" [item]="page" [restrictionUuids]="page.restrictions" [removeValidationMessages]="onRemoveValidationMessages" (onRestrictionsChange)="onRestrictionsChange($event)"></se-restrictions-editor>`});t.PageRestrictionsEditorComponent=class PageRestrictionsEditorComponent{constructor(e,t,o){this.data=e;this.restrictionsService=t;this.restrictionTypesService=o;({editor:this.editor,model:this.page}=e);this.isEditable=!e.isFieldDisabled()}ngOnInit(){this.initGetRestrictionTypes();this.initSupportedRestrictionTypes();this.initOnRemoveValidationMessages()}onRestrictionsChange({onlyOneRestrictionMustApply:e,restrictionUuids:t,alwaysEnableSubmit:o}){this.page.onlyOneRestrictionMustApply=e;this.page.restrictions=t}initGetRestrictionTypes(){this.getRestrictionTypes=()=>this.restrictionTypesService.getRestrictionTypesByPageType(this.page.typeCode)}initSupportedRestrictionTypes(){this.getSupportedRestrictionTypes=()=>this.restrictionsService.getSupportedRestrictionTypeCodes()}initOnRemoveValidationMessages(){this.onRemoveValidationMessages=()=>this.editor.api.clearMessages()}};t.PageRestrictionsEditorComponent.$inject=["data","restrictionsService","restrictionTypesService"];t.PageRestrictionsEditorComponent=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-restrictions-editor",template:`<se-page-restrictions-info-message *ngIf="page.restrictions?.length > 1"></se-page-restrictions-info-message><se-restrictions-editor [editable]="isEditable" [getRestrictionTypes]="getRestrictionTypes" [getSupportedRestrictionTypes]="getSupportedRestrictionTypes" [item]="page" [restrictionUuids]="page.restrictions" [removeValidationMessages]="onRemoveValidationMessages" (onRestrictionsChange)="onRestrictionsChange($event)"></se-restrictions-editor>`}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,t.RestrictionsService,t.RestrictionTypesService])],t.PageRestrictionsEditorComponent);window.__smartedit__.addDecoratorPayload("Component","PageRestrictionsInfoMessageComponent",{selector:"se-page-restrictions-info-message",template:`<se-message [type]="'info'" class="se-restrictions-info__message"><ng-container se-message-title>{{ 'se.cms.restrictions.editor.ymessage.title' | translate }}</ng-container><ng-container se-message-description>{{ 'se.cms.restrictions.editor.ymessage.description' | translate }}</ng-container></se-message>`,styles:[`.se-restrictions-info__message{margin-bottom:10px;display:block}`]});let Ct=class PageRestrictionsInfoMessageComponent{};Ct=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-restrictions-info-message",template:`<se-message [type]="'info'" class="se-restrictions-info__message"><ng-container se-message-title>{{ 'se.cms.restrictions.editor.ymessage.title' | translate }}</ng-container><ng-container se-message-description>{{ 'se.cms.restrictions.editor.ymessage.description' | translate }}</ng-container></se-message>`,styles:[`.se-restrictions-info__message{margin-bottom:10px;display:block}`]})],Ct);t.PageRestrictionsModule=class PageRestrictionsModule{};t.PageRestrictionsModule=__decorate([s.NgModule({imports:[f.CommonModule,m.MessageModule,St,m.TranslationModule.forChild()],declarations:[t.PageRestrictionsEditorComponent,Ct],entryComponents:[t.PageRestrictionsEditorComponent,Ct],exports:[St,Ct]})],t.PageRestrictionsModule);t.CmsComponentsModule=class CmsComponentsModule{};t.CmsComponentsModule=__decorate([s.NgModule({imports:[f.CommonModule,m.TranslationModule.forChild(),t.ComponentMenuModule,t.PageRestrictionsModule,m.GenericEditorDropdownModule],providers:[O,x,{provide:m.CustomDropdownPopulatorsToken,useClass:D,multi:true}],declarations:[t.SubTypeSelectorComponent,t.SelectComponentTypeModalComponent,t.ComponentRestrictionsEditorComponent,t.CmsDropdownItemComponent,t.CmsComponentDropdownComponent],entryComponents:[t.SubTypeSelectorComponent,t.SelectComponentTypeModalComponent,t.ComponentRestrictionsEditorComponent,t.CmsDropdownItemComponent,t.CmsComponentDropdownComponent]})],t.CmsComponentsModule);window.__smartedit__.addDecoratorPayload("Component","ItemSelectorPanelComponent",{selector:"se-item-selector-panel",template:`<se-slider-panel [sliderPanelConfiguration]="panelConfig" [(sliderPanelHide)]="hidePanel" [(sliderPanelShow)]="showPanel" class="se-item-selector-panel"><div *ngIf="catalogs.length > 0"><div *ngIf="catalogs.length > 1" class="se-item-selector-panel__selector"><label class="se-control-label" translate="se.cms.catalogaware.panel.catalogs.label"></label><se-select id="se-catalog-selector-dropdown" [(model)]="catalogInfo.catalogId" [fetchStrategy]="catalogSelectorFetchStrategy" [onChange]="onCatalogSelectorChange"></se-select><label>{{ catalogInfo.name | seL10n | async }}</label></div><div class="se-item-selector-panel__selector"><label class="se-control-label" translate="se.cms.catalogaware.panel.catalogsversion.label"></label><se-select id="se-catalog-version-selector-dropdown" [(model)]="catalogInfo.catalogVersion" [fetchStrategy]="catalogVersionSelectorFetchStrategy" [onChange]="onCatalogVersionSelectorChange" [searchEnabled]="false" [(reset)]="resetCatalogVersionSelector"></se-select></div><div class="se-item-selector-panel__selector" *ngIf="catalogInfo.catalogVersion"><label class="se-control-label" [translate]="catalogItemTypeI18nKey"></label><se-select id="se-items-selector-dropdown" [multiSelect]="true" [controls]="true" [(model)]="internalItemsSelected" [onChange]="onItemsSelectorChange" [fetchStrategy]="itemsSelectorFetchStrategy" [(reset)]="resetItemsListSelector" [itemComponent]="itemComponent" [isReadOnly]="!isItemSelectorEnabled()"></se-select></div></div></se-slider-panel>`,styles:[`.se-item-selector-panel__selector{margin-bottom:25px}`]});let bt=class ItemSelectorPanelComponent{constructor(){this.onSaveChanges=new s.EventEmitter;this.catalogs=[];this.catalogInfo={};this.saveButtonDisabled=true;this.internalItemsSelected=[];this.initOnCatalogSelectorChange();this.initOnCatalogVersionSelectorChange();this.initOnItemsSelectorChange()}ngOnInit(){this.panelConfig={cssSelector:"#y-modal-dialog",noGreyedOutOverlay:true,modal:{title:this.catalogItemTypeI18nKey,showDismissButton:false,cancel:{onClick:()=>this.cancel(),label:"se.cms.catalogaware.panel.button.cancel",isDisabledFn:()=>false},save:{onClick:()=>this.saveChanges(),label:"se.cms.catalogaware.panel.button.add",isDisabledFn:()=>this.isSaveButtonDisabled()}}};return this.initCatalogs()}initAndShowPanel(e){this.catalogInfo={};this.initCatalogs();this.internalItemsSelected=e||[];this.showPanel()}isItemSelectorEnabled(){return this.catalogInfo&&!!this.catalogInfo.catalogId&&!!this.catalogInfo.catalogVersion}initOnCatalogSelectorChange(){this.onCatalogSelectorChange=()=>{if(this.resetCatalogVersionSelector){this.resetCatalogVersionSelector()}}}initOnCatalogVersionSelectorChange(){this.onCatalogVersionSelectorChange=()=>{if(this.catalogInfo.catalogId&&this.catalogInfo.catalogVersion){if(this.resetItemsListSelector){this.resetItemsListSelector()}}}}initOnItemsSelectorChange(){this.onItemsSelectorChange=()=>{if(this.isItemSelectorEnabled()){this.saveButtonDisabled=false}}}initCatalogs(){return __awaiter(this,void 0,void 0,(function*(){this.catalogs=yield this.getCatalogs();if(this.catalogs.length===1){this.catalogInfo.catalogId=this.catalogs[0].id}this.initCatalogSelector();this.initCatalogVersionSelector();this.initItemsSelector()}))}initCatalogSelector(){this.catalogSelectorFetchStrategy={fetchAll:()=>Promise.resolve(this.catalogs)}}initCatalogVersionSelector(){this.catalogVersionSelectorFetchStrategy={fetchAll:()=>{let e=[];if(this.catalogInfo.catalogId){const t=this.catalogs.find((({id:e})=>e===this.catalogInfo.catalogId));e=t.versions.slice(0)}return Promise.resolve(e)}}}initItemsSelector(){this.itemsSelectorFetchStrategy={fetchPage:(e,t,o)=>this.itemsFetchPageAndFilter(e,t,o),fetchEntity:e=>this.itemsFetchStrategy.fetchEntity(e)}}itemsFetchPageAndFilter(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.itemsFetchStrategy.fetchPage(this.catalogInfo,e,t,o);return this.limitToNonSelectedItems(n)}))}limitToNonSelectedItems(e){let t=e.results.length;while(t--){const o=e.results[t];if(this.internalItemsSelected.includes(o.uid)){e.results.splice(t,1);e.pagination.count--}}return e}isSaveButtonDisabled(){return this.saveButtonDisabled}cancel(){this.catalogInfo={};this.hidePanel()}saveChanges(){this.onSaveChanges.emit([...this.internalItemsSelected]);this.hidePanel()}};__decorate([s.Input(),__metadata("design:type",s.Type)],bt.prototype,"itemComponent",void 0);__decorate([s.Input(),__metadata("design:type",Function)],bt.prototype,"getCatalogs",void 0);__decorate([s.Input(),__metadata("design:type",Object)],bt.prototype,"itemsFetchStrategy",void 0);__decorate([s.Input(),__metadata("design:type",String)],bt.prototype,"catalogItemTypeI18nKey",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],bt.prototype,"onSaveChanges",void 0);bt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-item-selector-panel",template:`<se-slider-panel [sliderPanelConfiguration]="panelConfig" [(sliderPanelHide)]="hidePanel" [(sliderPanelShow)]="showPanel" class="se-item-selector-panel"><div *ngIf="catalogs.length > 0"><div *ngIf="catalogs.length > 1" class="se-item-selector-panel__selector"><label class="se-control-label" translate="se.cms.catalogaware.panel.catalogs.label"></label><se-select id="se-catalog-selector-dropdown" [(model)]="catalogInfo.catalogId" [fetchStrategy]="catalogSelectorFetchStrategy" [onChange]="onCatalogSelectorChange"></se-select><label>{{ catalogInfo.name | seL10n | async }}</label></div><div class="se-item-selector-panel__selector"><label class="se-control-label" translate="se.cms.catalogaware.panel.catalogsversion.label"></label><se-select id="se-catalog-version-selector-dropdown" [(model)]="catalogInfo.catalogVersion" [fetchStrategy]="catalogVersionSelectorFetchStrategy" [onChange]="onCatalogVersionSelectorChange" [searchEnabled]="false" [(reset)]="resetCatalogVersionSelector"></se-select></div><div class="se-item-selector-panel__selector" *ngIf="catalogInfo.catalogVersion"><label class="se-control-label" [translate]="catalogItemTypeI18nKey"></label><se-select id="se-items-selector-dropdown" [multiSelect]="true" [controls]="true" [(model)]="internalItemsSelected" [onChange]="onItemsSelectorChange" [fetchStrategy]="itemsSelectorFetchStrategy" [(reset)]="resetItemsListSelector" [itemComponent]="itemComponent" [isReadOnly]="!isItemSelectorEnabled()"></se-select></div></div></se-slider-panel>`,styles:[`.se-item-selector-panel__selector{margin-bottom:25px}`]}),__metadata("design:paramtypes",[])],bt);window.__smartedit__.addDecoratorPayload("Component","CatalogAwareSelectorComponent",{selector:"se-catalog-aware-selector",host:{"[class.se-catalog-aware-selector]":"true"},template:`<div *ngIf="selectedItemListIsEmpty()"><button type="button" id="catalog-aware-selector-add-item" class="fd-button fd-button--compact se-catalog-aware-selector__add-item-btn" *ngIf="editable" (click)="openItemSelectorPanel()"><span translate="se.cms.catalogaware.newbutton.title" [translateParams]="{ catalogItemType: catalogItemTypeI18nKey | translate }" class="se-catalog-aware-selector__add-item-btn-text"></span></button></div><div *ngIf="!selectedItemListIsEmpty()" class="se-catalog-aware-selector__content"><div class="se-catalog-aware-selector__add-more-btn-wrapper" *ngIf="editable"><button type="button" class="fd-button--light" translate="se.cms.catalogaware.list.addmore" (click)="openItemSelectorPanel()"></button></div><se-editable-list [id]="editableListId" [itemComponent]="nodeComponent" [(items)]="itemList" [onChange]="onListChange" [editable]="editable" [(refresh)]="refreshItemListWidget" class="se-catalog-aware-selector__list"></se-editable-list></div><se-item-selector-panel [itemComponent]="itemComponent" [getCatalogs]="getCatalogs" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="catalogItemTypeI18nKey" (onSaveChanges)="onItemSelectorPanelSaveChanges($event)"></se-item-selector-panel>`,styles:[`.se-catalog-aware-selector__add-item-btn{display:flex;flex-direction:row;align-items:center;color:#0a6ed1}.se-catalog-aware-selector__add-more-btn-wrapper{display:flex;justify-content:flex-end;align-items:center}.se-catalog-aware-selector__list .se-tree-node{color:var(--sapList_TextColor);background-color:#fff}.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node,.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node__ol{display:flex;flex-direction:column;align-items:center}.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node .se-tree-node__li,.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node__ol .se-tree-node__li{width:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let It=class CatalogAwareSelectorComponent{constructor(e,t){this.logService=e;this.cdr=t;this.selectedItemIds=[];this.selectedItemIdsChange=new s.EventEmitter;this.itemList=[];this.onListChange=()=>this.selectItemsFromItemList()}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){if(this.editable===undefined){this.editable=true}this.editableListId=`${this.id}_list`;if(this.selectedItemIds.length>0){return this.syncFromSelectedItemsToItemsList(this.selectedItemIds)}}))}selectedItemListIsEmpty(){return this.selectedItemIds.length===0}openItemSelectorPanel(){this.itemSelectorPanel.initAndShowPanel([...this.selectedItemIds]);if(!this.cdr.destroyed){this.cdr.detectChanges()}}onItemSelectorPanelSaveChanges(e){this.selectedItemIdsChange.emit(e);return this.syncFromSelectedItemsToItemsList(e)}selectItemsFromItemList(){const e=this.itemList.map((e=>e.id));this.selectedItemIdsChange.emit(e)}syncFromSelectedItemsToItemsList(e){return __awaiter(this,void 0,void 0,(function*(){const[t,o]=this.selectItemIdsFromItemList(e,this.itemList);const n=new Map;this.itemList.filter((({id:e})=>t.includes(e))).forEach((e=>{n.set(e.id,e)}));if(o.length>0){const e=yield this.fetchItems(o);e.forEach((e=>{n.set(e.id,e)}))}this.itemList.length=0;e.forEach((e=>{const t=n.get(e);if(!t){this.logService.warn(`[${this.constructor.name}] - Cannot find item with key `,e);return}this.itemList.push(t)}));if(this.itemList.length>0){this.updatePosition()}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}updatePosition(){if(!!this.refreshItemListWidget){this.refreshItemListWidget()}}selectItemIdsFromItemList(e,t){const o=[];const n=[];const s=new Set(t.map((({id:e})=>e)));e.forEach((e=>{if(s.has(e)){o.push(e)}else{n.push(e)}}));return[o,n]}fetchItems(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.map((e=>this.itemsFetchStrategy.fetchEntity(e)));return Promise.all(t)}))}};It.$inject=["logService","cdr"];__decorate([s.Input(),s.HostBinding("attr.id"),__metadata("design:type",String)],It.prototype,"id",void 0);__decorate([s.Input(),__metadata("design:type",Array)],It.prototype,"selectedItemIds",void 0);__decorate([s.Input(),__metadata("design:type",Function)],It.prototype,"getCatalogs",void 0);__decorate([s.Input(),__metadata("design:type",Object)],It.prototype,"itemsFetchStrategy",void 0);__decorate([s.Input(),__metadata("design:type",s.Type)],It.prototype,"itemComponent",void 0);__decorate([s.Input(),__metadata("design:type",s.Type)],It.prototype,"nodeComponent",void 0);__decorate([s.Input(),__metadata("design:type",String)],It.prototype,"catalogItemTypeI18nKey",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],It.prototype,"editable",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],It.prototype,"selectedItemIdsChange",void 0);__decorate([s.ViewChild(bt,{static:false}),__metadata("design:type",bt)],It.prototype,"itemSelectorPanel",void 0);It=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-catalog-aware-selector",host:{"[class.se-catalog-aware-selector]":"true"},template:`<div *ngIf="selectedItemListIsEmpty()"><button type="button" id="catalog-aware-selector-add-item" class="fd-button fd-button--compact se-catalog-aware-selector__add-item-btn" *ngIf="editable" (click)="openItemSelectorPanel()"><span translate="se.cms.catalogaware.newbutton.title" [translateParams]="{ catalogItemType: catalogItemTypeI18nKey | translate }" class="se-catalog-aware-selector__add-item-btn-text"></span></button></div><div *ngIf="!selectedItemListIsEmpty()" class="se-catalog-aware-selector__content"><div class="se-catalog-aware-selector__add-more-btn-wrapper" *ngIf="editable"><button type="button" class="fd-button--light" translate="se.cms.catalogaware.list.addmore" (click)="openItemSelectorPanel()"></button></div><se-editable-list [id]="editableListId" [itemComponent]="nodeComponent" [(items)]="itemList" [onChange]="onListChange" [editable]="editable" [(refresh)]="refreshItemListWidget" class="se-catalog-aware-selector__list"></se-editable-list></div><se-item-selector-panel [itemComponent]="itemComponent" [getCatalogs]="getCatalogs" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="catalogItemTypeI18nKey" (onSaveChanges)="onItemSelectorPanelSaveChanges($event)"></se-item-selector-panel>`,styles:[`.se-catalog-aware-selector__add-item-btn{display:flex;flex-direction:row;align-items:center;color:#0a6ed1}.se-catalog-aware-selector__add-more-btn-wrapper{display:flex;justify-content:flex-end;align-items:center}.se-catalog-aware-selector__list .se-tree-node{color:var(--sapList_TextColor);background-color:#fff}.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node,.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node__ol{display:flex;flex-direction:column;align-items:center}.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node .se-tree-node__li,.se-catalog-aware-selector__list .se-tree__nodes--item .se-tree-node__ol .se-tree-node__li{width:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.LogService,s.ChangeDetectorRef])],It);window.__smartedit__.addDecoratorPayload("Component","ProductNodeComponent",{selector:"se-product-node",template:`<div class="se-product-row"><div class="se-product-node" [ngClass]="{\n            'se-product-node--no-drag' : !parent.dragEnabled,\n            'se-product-node--drag': parent.dragEnabled \n        }"><img class="se-product-row__img" [src]="node.thumbnail.url || '/cmssmartedit/images/product_thumbnail_default.png'" alt="product image"/><div class="se-product-row__product se-nowrap-ellipsis" [title]="node.name | seL10n  | async">{{ node.name | seL10n | async }}</div><div class="se-product-row__product se-nowrap-ellipsis" [title]="node.code">{{ node.code }}</div><div class="se-product-row__catalog se-nowrap-ellipsis" title="{{ node.catalogId }} - {{ node.catalogVersion }}">{{ node.catalogId }} - {{ node.catalogVersion }}</div><se-dropdown-menu *ngIf="parent.dragEnabled" [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div></div>`,styles:[`.se-product-node{display:grid;grid-template-columns:1fr 5fr 5fr 7fr;grid-column-gap:12px;width:100%;align-items:center;padding:0 8px}.se-product-node--no-drag{grid-template-columns:1fr 6fr 6fr 7fr;cursor:default}.se-product-node--drag{grid-template-columns:1fr 5fr 5fr 7fr .5fr}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let wt=class ProductNodeComponent{constructor(e,t){this.node=e;this.parent=t;const{getDropdownItems:o}=this.parent.nodeActions;this.dropdownItems=o()}};wt=__decorate([s.Component({selector:"se-product-node",template:`<div class="se-product-row"><div class="se-product-node" [ngClass]="{\n            'se-product-node--no-drag' : !parent.dragEnabled,\n            'se-product-node--drag': parent.dragEnabled \n        }"><img class="se-product-row__img" [src]="node.thumbnail.url || '/cmssmartedit/images/product_thumbnail_default.png'" alt="product image"/><div class="se-product-row__product se-nowrap-ellipsis" [title]="node.name | seL10n  | async">{{ node.name | seL10n | async }}</div><div class="se-product-row__product se-nowrap-ellipsis" [title]="node.code">{{ node.code }}</div><div class="se-product-row__catalog se-nowrap-ellipsis" title="{{ node.catalogId }} - {{ node.catalogVersion }}">{{ node.catalogId }} - {{ node.catalogVersion }}</div><se-dropdown-menu *ngIf="parent.dragEnabled" [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div></div>`,styles:[`.se-product-node{display:grid;grid-template-columns:1fr 5fr 5fr 7fr;grid-column-gap:12px;width:100%;align-items:center;padding:0 8px}.se-product-node--no-drag{grid-template-columns:1fr 6fr 6fr 7fr;cursor:default}.se-product-node--drag{grid-template-columns:1fr 5fr 5fr 7fr .5fr}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.TREE_NODE)),__param(1,s.Inject(s.forwardRef((()=>m.TreeComponent)))),__metadata("design:paramtypes",[Object,m.TreeComponent])],wt);window.__smartedit__.addDecoratorPayload("Component","ProductSelectorItemComponent",{selector:"se-product-selector-item",template:`<div class="se-product-row"><div class="se-product-node"><img class="se-product-row__img" [src]="getThumbnailUrl(item.thumbnail?.url)" alt="product image"/><div class="se-product-row__product se-nowrap-ellipsis" [title]="item.name | seL10n | async">{{ item.name | seL10n | async }}</div><div class="se-product-row__product se-nowrap-ellipsis" [title]="item.code">{{ item.code }}</div><div class="se-product-row__catalog"><div class="se-nowrap-ellipsis" title="{{ item.catalogId }} - {{ item.catalogVersion }}">{{ item.catalogId }} - {{ item.catalogVersion }}</div></div></div></div>`,styles:[`.se-product-node{display:grid;grid-template-columns:1fr 5fr 5fr 7fr;grid-column-gap:12px;width:100%;align-items:center;padding:0 8px}.se-product-node--no-drag{grid-template-columns:1fr 6fr 6fr 7fr;cursor:default}.se-product-node--drag{grid-template-columns:1fr 5fr 5fr 7fr .5fr}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Et=class ProductSelectorItemComponent{constructor(e){this.data=e;this.defaultThumbnail=`${p.IMAGES_URL}/product_thumbnail_default.png`;({item:this.item}=e)}getThumbnailUrl(e){return e||this.defaultThumbnail}};Et=__decorate([s.Component({selector:"se-product-selector-item",template:`<div class="se-product-row"><div class="se-product-node"><img class="se-product-row__img" [src]="getThumbnailUrl(item.thumbnail?.url)" alt="product image"/><div class="se-product-row__product se-nowrap-ellipsis" [title]="item.name | seL10n | async">{{ item.name | seL10n | async }}</div><div class="se-product-row__product se-nowrap-ellipsis" [title]="item.code">{{ item.code }}</div><div class="se-product-row__catalog"><div class="se-nowrap-ellipsis" title="{{ item.catalogId }} - {{ item.catalogVersion }}">{{ item.catalogId }} - {{ item.catalogVersion }}</div></div></div></div>`,styles:[`.se-product-node{display:grid;grid-template-columns:1fr 5fr 5fr 7fr;grid-column-gap:12px;width:100%;align-items:center;padding:0 8px}.se-product-node--no-drag{grid-template-columns:1fr 6fr 6fr 7fr;cursor:default}.se-product-node--drag{grid-template-columns:1fr 5fr 5fr 7fr .5fr}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],Et);let Tt=class CatalogInformationService{constructor(e,t,o,n){this.catalogService=e;this.sharedDataService=t;this.productCategoryService=o;this.productService=n;this.init()}get productsFetchStrategy(){return this._productsFetchStrategy}get categoriesFetchStrategy(){return this._categoriesFetchStrategy}makeGetProductCatalogsInformation(){return()=>this.getProductCatalogsInformation()}getProductCatalogsInformation(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getSiteUid();if(this.cachedSiteUid===e&&this.parsedCatalogs){return this.parsedCatalogs}else{this.cachedSiteUid=e;const t=yield this.catalogService.getProductCatalogsForSite(e);const o=this.catalogsToProductCatalogById(t);this.parsedCatalogs=u.values(o);return this.parsedCatalogs}}))}init(){this._productsFetchStrategy={fetchPage:(e,t,o,n)=>__awaiter(this,void 0,void 0,(function*(){return this.productsFetchPage(e,t,o,n)})),fetchEntity:e=>__awaiter(this,void 0,void 0,(function*(){return this.productsFetchEntity(e)}))};this._categoriesFetchStrategy={fetchPage:(e,t,o,n)=>__awaiter(this,void 0,void 0,(function*(){return this.categoriesFetchPage(e,t,o,n)})),fetchEntity:e=>__awaiter(this,void 0,void 0,(function*(){return this.categoriesFetchEntity(e)}))}}productsFetchPage(e,t,o,n){return __awaiter(this,void 0,void 0,(function*(){const s=yield this.getSiteUid();e.siteUID=s;const{products:a,pagination:r}=yield this.productService.findProducts(e,{mask:t,pageSize:o,currentPage:n});const d=a.map((e=>Object.assign(Object.assign({},e),{id:e.uid})));return{pagination:r,results:d}}))}productsFetchEntity(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getSiteUid();const o=yield this.productService.getProductById(t,e);return Object.assign(Object.assign({},o),{id:o.uid})}))}categoriesFetchPage(e,t,o,n){return __awaiter(this,void 0,void 0,(function*(){const s=yield this.getSiteUid();e.siteUID=s;const{productCategories:a,pagination:r}=yield this.productCategoryService.getCategories({catalogId:e.catalogId,catalogVersion:e.catalogVersion,siteUID:e.siteUID,mask:t,pageSize:o,currentPage:n});const d=a.map((e=>Object.assign(Object.assign({},e),{id:e.uid})));return{pagination:r,results:d}}))}categoriesFetchEntity(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getSiteUid();const o=yield this.productCategoryService.getCategoryById(t,e);o.id=o.uid;return o}))}getSiteUid(){return __awaiter(this,void 0,void 0,(function*(){return this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY).then((({siteDescriptor:{uid:e}})=>e))}))}catalogsToProductCatalogById(e){const t={};e.forEach((e=>{t[e.catalogId]={id:e.catalogId,name:e.name,versions:e.versions.map((({version:e})=>({id:e,label:e})))}}));return t}};Tt.$inject=["catalogService","sharedDataService","productCategoryService","productService"];Tt=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ICatalogService,m.ISharedDataService,t.ProductCategoryService,b.ProductService])],Tt);window.__smartedit__.addDecoratorPayload("Component","MultiProductSelectorComponent",{selector:"se-multi-product-selector",template:`<se-catalog-aware-selector [id]="id" [selectedItemIds]="selectedItemIds" (selectedItemIdsChange)="onSelectedItemIdsChange($event)" [getCatalogs]="getCatalogs" [itemComponent]="productSelectorItemComponent" [nodeComponent]="productNodeComponent" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="'se.cms.catalogaware.catalogitemtype.product'" [editable]="editable"></se-catalog-aware-selector>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let Pt=class MultiProductSelectorComponent{constructor(e,t){this.catalogInformationService=e;({field:{qualifier:this.id},model:this.model,qualifier:this.qualifier,field:{editable:this.editable}}=t);this.productNodeComponent=wt;this.productSelectorItemComponent=Et}ngOnInit(){this.getCatalogs=this.catalogInformationService.makeGetProductCatalogsInformation();this.itemsFetchStrategy=this.catalogInformationService.productsFetchStrategy;if(this.editable===undefined){this.editable=true}this.selectedItemIds=[...this.model[this.qualifier]||[]]}onSelectedItemIdsChange(e){this.selectedItemIds=[...e];this.model[this.qualifier]=this.selectedItemIds}};Pt=__decorate([s.Component({selector:"se-multi-product-selector",template:`<se-catalog-aware-selector [id]="id" [selectedItemIds]="selectedItemIds" (selectedItemIdsChange)="onSelectedItemIdsChange($event)" [getCatalogs]="getCatalogs" [itemComponent]="productSelectorItemComponent" [nodeComponent]="productNodeComponent" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="'se.cms.catalogaware.catalogitemtype.product'" [editable]="editable"></se-catalog-aware-selector>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(1,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Tt,Object])],Pt);window.__smartedit__.addDecoratorPayload("Component","CategoryNodeComponent",{selector:"se-category-node",template:`<div class="se-product-row"><div class="se-category-node" [ngClass]="{\n          'se-category-node--no-drag': !parent.dragEnabled,\n          'se-category-node--drag': parent.dragEnabled\n        }"><div class="se-product-row__product" [title]="node.name | seL10n | async">{{ node.name | seL10n | async }}</div><div class="se-product-row__product" [title]="node.code">{{ node.code }}</div><div class="se-product-row__catalog" title="{{ node.catalogId }} - {{ node.catalogVersion }}">{{ node.catalogId }} - {{ node.catalogVersion }}</div><div><se-dropdown-menu *ngIf="parent.dragEnabled" [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div></div></div>`,styles:[`.se-category-node{padding:0 16px;display:grid;grid-column-gap:12px;align-items:center}.se-category-node--no-drag{grid-template-columns:6fr 6fr 8fr}.se-category-node--drag{grid-template-columns:6fr 6fr 7fr 1fr}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let At=class CategoryNodeComponent{constructor(e,t){this.node=e;this.parent=t;const{getDropdownItems:o}=this.parent.nodeActions;this.dropdownItems=o()}};At=__decorate([s.Component({selector:"se-category-node",template:`<div class="se-product-row"><div class="se-category-node" [ngClass]="{\n          'se-category-node--no-drag': !parent.dragEnabled,\n          'se-category-node--drag': parent.dragEnabled\n        }"><div class="se-product-row__product" [title]="node.name | seL10n | async">{{ node.name | seL10n | async }}</div><div class="se-product-row__product" [title]="node.code">{{ node.code }}</div><div class="se-product-row__catalog" title="{{ node.catalogId }} - {{ node.catalogVersion }}">{{ node.catalogId }} - {{ node.catalogVersion }}</div><div><se-dropdown-menu *ngIf="parent.dragEnabled" [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div></div></div>`,styles:[`.se-category-node{padding:0 16px;display:grid;grid-column-gap:12px;align-items:center}.se-category-node--no-drag{grid-template-columns:6fr 6fr 8fr}.se-category-node--drag{grid-template-columns:6fr 6fr 7fr 1fr}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.TREE_NODE)),__param(1,s.Inject(s.forwardRef((()=>m.TreeComponent)))),__metadata("design:paramtypes",[Object,m.TreeComponent])],At);window.__smartedit__.addDecoratorPayload("Component","CategorySelectorItemComponent",{selector:"se-category-selector-item",template:`<div class="se-product-row"><div class="se-category-row-container--item"><div class="se-product-row__product" [title]="item.name | seL10n | async">{{ item.name | seL10n | async }}</div><div class="se-product-row__product" [title]="item.code">{{ item.code }}</div><div class="se-product-row__catalog" title="{{ item.catalogId }} - {{ item.catalogVersion }}">{{ item.catalogId }} - {{ item.catalogVersion }}</div></div></div>`,styles:[`.se-category-row-container--item{display:grid;grid-template-columns:6fr 6fr 8fr;grid-column-gap:12px;width:100%;padding:0 8px}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Ot=class CategorySelectorItemComponent{constructor(e){this.data=e;({item:this.item}=e)}};Ot=__decorate([s.Component({selector:"se-category-selector-item",template:`<div class="se-product-row"><div class="se-category-row-container--item"><div class="se-product-row__product" [title]="item.name | seL10n | async">{{ item.name | seL10n | async }}</div><div class="se-product-row__product" [title]="item.code">{{ item.code }}</div><div class="se-product-row__catalog" title="{{ item.catalogId }} - {{ item.catalogVersion }}">{{ item.catalogId }} - {{ item.catalogVersion }}</div></div></div>`,styles:[`.se-category-row-container--item{display:grid;grid-template-columns:6fr 6fr 8fr;grid-column-gap:12px;width:100%;padding:0 8px}`,`.se-product-row__catalog,.se-product-row__product{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;text-align:left}.se-product-row__img{padding:2px;width:36px;height:36px;font-size:.35rem}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],Ot);window.__smartedit__.addDecoratorPayload("Component","MultiCategorySelectorComponent",{selector:"se-multi-category-selector",template:`<se-catalog-aware-selector [id]="id" [selectedItemIds]="selectedItemIds" (selectedItemIdsChange)="onSelectedItemIdsChange($event)" [getCatalogs]="getCatalogs" [itemComponent]="categorySelectorItemComponent" [nodeComponent]="categoryNodeComponent" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="'se.cms.catalogaware.catalogitemtype.category'" [editable]="editable"></se-catalog-aware-selector>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let xt=class MultiCategorySelectorComponent{constructor(e,t){this.catalogInformationService=e;({model:this.model,qualifier:this.qualifier,field:{qualifier:this.id,editable:this.editable}}=t);this.categoryNodeComponent=At;this.categorySelectorItemComponent=Ot}ngOnInit(){this.getCatalogs=this.catalogInformationService.makeGetProductCatalogsInformation();this.itemsFetchStrategy=this.catalogInformationService.categoriesFetchStrategy;if(this.editable===undefined){this.editable=true}this.selectedItemIds=[...this.model[this.qualifier]||[]]}onSelectedItemIdsChange(e){this.selectedItemIds=[...e];this.model[this.qualifier]=this.selectedItemIds}};xt=__decorate([s.Component({selector:"se-multi-category-selector",template:`<se-catalog-aware-selector [id]="id" [selectedItemIds]="selectedItemIds" (selectedItemIdsChange)="onSelectedItemIdsChange($event)" [getCatalogs]="getCatalogs" [itemComponent]="categorySelectorItemComponent" [nodeComponent]="categoryNodeComponent" [itemsFetchStrategy]="itemsFetchStrategy" [catalogItemTypeI18nKey]="'se.cms.catalogaware.catalogitemtype.category'" [editable]="editable"></se-catalog-aware-selector>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(1,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Tt,Object])],xt);let Dt=class CatalogModule{};Dt=__decorate([s.NgModule({imports:[f.CommonModule,a.FormsModule,m.DropdownMenuModule,m.SliderPanelModule,m.SelectModule,v.TranslateModule.forChild(),m.L10nPipeModule,m.EditableListModule],providers:[Tt],declarations:[bt,wt,At,Et,Ot,It,Pt,xt],entryComponents:[wt,At,Et,Ot,Pt,xt]})],Dt);const Rt="pageApprovalSelectorClose";window.__smartedit__.addDecoratorPayload("Component","PageApprovalSelectorComponent",{selector:"se-page-approval-selector",template:`<fd-popover *ngIf="showDropdown" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="'bottom-end'"><fd-popover-control><button (click)="onClickDropdown()" class="se-page-approval-selector__toggle-btn fd-button--light sap-icon--navigation-down-arrow"></button></fd-popover-control><fd-popover-body><div *ngIf="showApprovalInfo" class="se-page-approval-info">{{ approvalInfo }}</div><fd-menu *ngIf="!showApprovalInfo"><ul fd-menu-list class="se-dropdown-menu__list se-page-approval-selector-list"><se-dropdown-menu-item *ngFor="let dropdownItem of pageApprovalOptions$ | async" [dropdownItem]="dropdownItem"></se-dropdown-menu-item></ul></fd-menu></fd-popover-body></fd-popover>`,styles:[`.se-page-approval-selector__toggle-btn{color:#0a6ed1}.se-page-approval-selector__toggle-btn::before{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-page-approval-selector__toggle-btn:active,.se-page-approval-selector__toggle-btn:focus{box-shadow:none}.se-page-approval-selector__toggle-btn:active,.se-page-approval-selector__toggle-btn:hover{outline:0;border-color:var(--sapButton_Hover_BorderColor);background-color:#fff}.se-page-approval-selector__icon--draft,.se-page-approval-selector__icon--ready-to-sync{width:12px;height:12px;border-radius:50%;margin-right:10px}.se-page-approval-selector__icon--draft{background-color:#6a6d70}.se-page-approval-selector__icon--ready-to-sync{background-color:#0a6ed1}.se-page-approval-selector-list{margin:0;min-width:190px;border:1px solid transparent;box-shadow:0 2px 8px 0 #d9d9d9;border-radius:4px}.se-page-approval-selector .se-dropdown-item{display:flex;align-items:center}.se-page-approval-selector .se-dropdown-item:hover{background-color:var(--sapBackgroundColor,#f7f7f7)}.se-page-approval-selector .fd-popover-container-custom{box-shadow:var(--sapContent_Shadow0)}.se-page-approval-selector .fd-menu{padding:0}.se-page-approval-info{width:320px;white-space:normal;padding:16px}`],host:{"[class.se-page-approval-selector]":"true"},encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let kt=class PageApprovalSelectorComponent{constructor(e,t,o,n,s,a,r,d,p){this.iframeClickDetectionService=e;this.pageService=t;this.waitDialogService=o;this.workflowService=n;this.crossFrameEventService=s;this.routingService=a;this.logService=r;this.cdr=d;this.userTrackingService=p;this.isOpen=false;this.showApprovalInfo=false;this.showDropdown=true;this.pageApprovalOptionsSubject=new C.BehaviorSubject({CHECK:{status:m.CmsApprovalStatus.CHECK,key:"se.cms.page.approval.check",icon:"se-page-approval-selector__icon--draft",component:m.DropdownMenuItemDefaultComponent,condition:()=>true,callback:(e,t)=>this.selectApprovalStatus(t)},APPROVED:{status:m.CmsApprovalStatus.APPROVED,key:"se.cms.page.approval.approved",icon:"se-page-approval-selector__icon--ready-to-sync",component:m.DropdownMenuItemDefaultComponent,condition:()=>true,callback:(e,t)=>this.selectApprovalStatus(t)}})}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.unRegWfFinishedHandler=this.crossFrameEventService.subscribe(p.WORKFLOW_FINISHED_EVENT,(()=>this.hideComponentIfWorkflowInProgress()));this.unRegPerspectiveChangedHandler=this.crossFrameEventService.subscribe(m.EVENT_PERSPECTIVE_CHANGED,(()=>this.hideComponentIfWorkflowInProgress()));this.iframeClickDetectionService.registerCallback(Rt,(()=>this.closeDropdown()));this.pageApprovalOptions$=this.pageApprovalOptionsSubject.pipe(g.map((e=>Object.values(e).filter((e=>!e.selected)))));yield this.hideComponentIfWorkflowInProgress()}))}ngOnDestroy(){this.unRegWfFinishedHandler();this.unRegPerspectiveChangedHandler();this.iframeClickDetectionService.removeCallback(Rt)}onClickDropdown(){return __awaiter(this,void 0,void 0,(function*(){if(!this.isOpen){const e=yield this.getCurrentPageApprovalStatus();const t=yield this.workflowService.pageHasUnavailableDependencies();if(e!==m.CmsApprovalStatus.APPROVED&&t){this.approvalInfo=yield this.workflowService.fetchPageTranslatedApprovalInfo();this.showApprovalInfo=true}else{this.showApprovalInfo=false}this.selectOption(e)}this.isOpen=!this.isOpen;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}selectApprovalStatus({status:e}){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,"Ready To Sync");this.waitDialogService.showWaitModal(null);try{yield this.pageService.forcePageApprovalStatus(e);this.crossFrameEventService.publish(m.EVENTS.PAGE_UPDATED);this.routingService.reload()}catch(e){this.logService.warn("[PageApprovalSelector] - Can't change page status.",e)}finally{this.waitDialogService.hideWaitModal();this.unselectOptions()}}))}getCurrentPageApprovalStatus(){return __awaiter(this,void 0,void 0,(function*(){const{approvalStatus:e}=yield this.pageService.getCurrentPageInfo();return e}))}hideComponentIfWorkflowInProgress(){return __awaiter(this,void 0,void 0,(function*(){const{uuid:e}=yield this.pageService.getCurrentPageInfo();const t=yield this.workflowService.getActiveWorkflowForPageUuid(e);this.showDropdown=!t;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}selectOption(e){this.unselectOptions();const t=this.getOptions();if(t[e]){t[e].selected=true}this.pageApprovalOptionsSubject.next(t)}unselectOptions(){const e=this.getOptions();Object.keys(e).forEach((t=>{e[t].selected=false}));this.pageApprovalOptionsSubject.next(e)}getOptions(){return Object.assign({},this.pageApprovalOptionsSubject.getValue())}closeDropdown(){this.isOpen=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}};kt.$inject=["iframeClickDetectionService","pageService","waitDialogService","workflowService","crossFrameEventService","routingService","logService","cdr","userTrackingService"];kt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-approval-selector",template:`<fd-popover *ngIf="showDropdown" [triggers]="[]" [closeOnOutsideClick]="false" [isOpen]="isOpen" [placement]="'bottom-end'"><fd-popover-control><button (click)="onClickDropdown()" class="se-page-approval-selector__toggle-btn fd-button--light sap-icon--navigation-down-arrow"></button></fd-popover-control><fd-popover-body><div *ngIf="showApprovalInfo" class="se-page-approval-info">{{ approvalInfo }}</div><fd-menu *ngIf="!showApprovalInfo"><ul fd-menu-list class="se-dropdown-menu__list se-page-approval-selector-list"><se-dropdown-menu-item *ngFor="let dropdownItem of pageApprovalOptions$ | async" [dropdownItem]="dropdownItem"></se-dropdown-menu-item></ul></fd-menu></fd-popover-body></fd-popover>`,styles:[`.se-page-approval-selector__toggle-btn{color:#0a6ed1}.se-page-approval-selector__toggle-btn::before{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-page-approval-selector__toggle-btn:active,.se-page-approval-selector__toggle-btn:focus{box-shadow:none}.se-page-approval-selector__toggle-btn:active,.se-page-approval-selector__toggle-btn:hover{outline:0;border-color:var(--sapButton_Hover_BorderColor);background-color:#fff}.se-page-approval-selector__icon--draft,.se-page-approval-selector__icon--ready-to-sync{width:12px;height:12px;border-radius:50%;margin-right:10px}.se-page-approval-selector__icon--draft{background-color:#6a6d70}.se-page-approval-selector__icon--ready-to-sync{background-color:#0a6ed1}.se-page-approval-selector-list{margin:0;min-width:190px;border:1px solid transparent;box-shadow:0 2px 8px 0 #d9d9d9;border-radius:4px}.se-page-approval-selector .se-dropdown-item{display:flex;align-items:center}.se-page-approval-selector .se-dropdown-item:hover{background-color:var(--sapBackgroundColor,#f7f7f7)}.se-page-approval-selector .fd-popover-container-custom{box-shadow:var(--sapContent_Shadow0)}.se-page-approval-selector .fd-menu{padding:0}.se-page-approval-info{width:320px;white-space:normal;padding:16px}`],host:{"[class.se-page-approval-selector]":"true"},encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.IIframeClickDetectionService,m.IPageService,m.IWaitDialogService,m.WorkflowService,m.CrossFrameEventService,m.SmarteditRoutingService,m.LogService,s.ChangeDetectorRef,m.UserTrackingService])],kt);window.__smartedit__.addDecoratorPayload("Component","PageStatusComponent",{selector:"se-page-status",template:`<div class="se-page-status"><div class="se-page-status__icon" [ngClass]="statusIconCssClass"></div><div class="se-page-status__label">{{ statusLabel | translate }}</div></div>`,styles:[`.se-page-status{display:flex;flex-direction:row;align-items:center}.se-page-status__label{white-space:nowrap}.se-page-status__icon{float:left;margin-left:10px;margin-right:10px}.se-page-status__icon--draft{width:12px;height:12px;border-radius:50%;background-color:#74777a}.se-page-status__icon--in_progress{width:12px;height:12px;border-radius:50%;background-color:#e9730c}.se-page-status__icon--ready_to_sync{width:12px;height:12px;border-radius:50%;background-color:#0a6ed1}.se-page-status__icon--synced{width:12px;height:12px;border-radius:50%;background-color:#0a7e3e}.se-page-status__icon--locked{color:#32363a}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Mt=class PageStatusComponent{constructor(e,t){this.workflowService=e;this.cdr=t;this.LOCALIZATION_PREFIX="se.cms.page.displaystatus."}ngOnChanges(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.uuid;const o=e.displayStatus;let n=false;if(t&&t.currentValue){this.isPageLocked=yield this.isPageLockedToCurrentUser(this.uuid);n=true}if(o&&o.currentValue){const e=this.displayStatus.toLowerCase();this.statusLabel=`${this.LOCALIZATION_PREFIX}${e}`;this.statusIconCssClass=this.getStatusIconCssClass(this.isPageLocked,e)}if(n){if(!this.cdr.destroyed){this.cdr.detectChanges()}}}))}isPageLockedToCurrentUser(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowService.getActiveWorkflowForPageUuid(e);return t&&!t.isAvailableForCurrentPrincipal}))}getStatusIconCssClass(e,t){return e?"icon-locked se-page-status__icon--locked":`se-page-status__icon--${t}`}};__decorate([s.Input(),__metadata("design:type",Object)],Mt.prototype,"uuid",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Mt.prototype,"displayStatus",void 0);Mt=__decorate([s.Component({selector:"se-page-status",template:`<div class="se-page-status"><div class="se-page-status__icon" [ngClass]="statusIconCssClass"></div><div class="se-page-status__label">{{ statusLabel | translate }}</div></div>`,styles:[`.se-page-status{display:flex;flex-direction:row;align-items:center}.se-page-status__label{white-space:nowrap}.se-page-status__icon{float:left;margin-left:10px;margin-right:10px}.se-page-status__icon--draft{width:12px;height:12px;border-radius:50%;background-color:#74777a}.se-page-status__icon--in_progress{width:12px;height:12px;border-radius:50%;background-color:#e9730c}.se-page-status__icon--ready_to_sync{width:12px;height:12px;border-radius:50%;background-color:#0a6ed1}.se-page-status__icon--synced{width:12px;height:12px;border-radius:50%;background-color:#0a7e3e}.se-page-status__icon--locked{color:#32363a}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.WorkflowService,s.ChangeDetectorRef])],Mt);const Nt="CMS_EVENT_OPEN_PAGE_WORKFLOW_MENU";const Ft="WORKFLOW_TASKS_MENU_OPENED_EVENT";const zt="WORKFLOW_DECISION_SELECTED_EVENT";const Lt="CMS_EVENT_OPEN_WORKFLOW_INBOX_DROPDOWN";const Vt="WORKFLOW_ITEM_MENU_OPENED_EVENT";const Ut="WORKFLOW_REFRESH_EVENT";window.__smartedit__.addDecoratorPayload("Component","PageDisplayStatusComponent",{selector:"se-page-display-status",template:`<ng-container *ngIf="showLastSyncTime; else pageStatus"><se-tooltip [triggers]="['click']" [placement]="'left'" [isChevronVisible]="true"><ng-container se-tooltip-trigger *ngTemplateOutlet="pageStatus"></ng-container><div se-tooltip-body class="popover-tooltip"><ng-container *ngIf="hasBeenSynchedBefore(); else notPublished"><span [translate]="'se.cms.page.displaystatus.lastpublished.date'"></span> <span>&ngsp;{{ lastSynchedDate | date: 'M/d/yy h:mm a' }}</span></ng-container><ng-template #notPublished><span [translate]="'se.cms.page.displaystatus.not.published'"></span></ng-template></div></se-tooltip></ng-container><ng-template #pageStatus><se-page-status [uuid]="page?.uuid" [displayStatus]="page?.displayStatus"></se-page-status></ng-template>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let jt=class PageDisplayStatusComponent{constructor(e,t,o,n){this.pageService=e;this.crossFrameEventService=t;this.systemEventService=o;this.cdr=n;this.showLastSyncTime=true}ngOnInit(){var e;return __awaiter(this,void 0,void 0,(function*(){this.unRegPageSyncEvent=this.crossFrameEventService.subscribe(p.DEFAULT_SYNCHRONIZATION_POLLING.FAST_FETCH,((e,t)=>this.updateLastSynchedDate(t)));this.unRegPageUpdatedEvent=this.crossFrameEventService.subscribe(m.EVENTS.PAGE_UPDATED,((e,t)=>this.updatePageInfo((t===null||t===void 0?void 0:t.uuid)||null)));const t=((e=this.cmsPage)===null||e===void 0?void 0:e.uuid)||null;yield this.initPageInfo(t)}))}ngOnDestroy(){this.unRegPageSyncEvent();this.unRegPageUpdatedEvent()}hasBeenSynchedBefore(){return this.lastSynchedDate!==undefined}initPageInfo(e){return __awaiter(this,void 0,void 0,(function*(){this.page=yield e?this.cmsPage:this.pageService.getCurrentPageInfo();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}updateLastSynchedDate(e){if(this.canUpdateLastSynchedDate(e.itemId)){this.lastSynchedDate=e.lastSyncStatus;if(!this.cdr.destroyed){this.cdr.detectChanges()}}}updatePageInfo(e){var t;return __awaiter(this,void 0,void 0,(function*(){if(!this.canUpdatePageInfo(e)){return}const o=(t=this.page)===null||t===void 0?void 0:t.displayStatus;this.page=yield this.pageService.getCurrentPageInfo();if(!!o&&this.page.displayStatus==="DRAFT"){this.systemEventService.publish(Ut)}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}canUpdateLastSynchedDate(e){return this.page&&this.page.uuid===e}canUpdatePageInfo(e){return!e||this.page&&this.page.uuid===e}};jt.$inject=["pageService","crossFrameEventService","systemEventService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],jt.prototype,"cmsPage",void 0);__decorate([s.Input(),__metadata("design:type",Object)],jt.prototype,"showLastSyncTime",void 0);jt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-display-status",template:`<ng-container *ngIf="showLastSyncTime; else pageStatus"><se-tooltip [triggers]="['click']" [placement]="'left'" [isChevronVisible]="true"><ng-container se-tooltip-trigger *ngTemplateOutlet="pageStatus"></ng-container><div se-tooltip-body class="popover-tooltip"><ng-container *ngIf="hasBeenSynchedBefore(); else notPublished"><span [translate]="'se.cms.page.displaystatus.lastpublished.date'"></span> <span>&ngsp;{{ lastSynchedDate | date: 'M/d/yy h:mm a' }}</span></ng-container><ng-template #notPublished><span [translate]="'se.cms.page.displaystatus.not.published'"></span></ng-template></div></se-tooltip></ng-container><ng-template #pageStatus><se-page-status [uuid]="page?.uuid" [displayStatus]="page?.displayStatus"></se-page-status></ng-template>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.IPageService,m.CrossFrameEventService,m.SystemEventService,s.ChangeDetectorRef])],jt);window.__smartedit__.addDecoratorPayload("Component","PageDisplayStatusWrapperComponent",{selector:"se-page-display-status-wrapper",template:`\n        <div class="se-page-status-toolbar-container">\n            <se-page-display-status></se-page-display-status>\n        </div>\n    `,styles:[`\n            .se-page-status-toolbar-container {\n                padding-left: 5px;\n                padding-right: 20px;\n                height: 100%;\n                display: flex;\n                align-items: center;\n                border-left: 1px solid fd-color('neutral', 3);\n            }\n        `],changeDetection:s.ChangeDetectionStrategy.OnPush});let $t=class PageDisplayStatusWrapperComponent{};$t=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-display-status-wrapper",template:`\n        <div class="se-page-status-toolbar-container">\n            <se-page-display-status></se-page-display-status>\n        </div>\n    `,styles:[`\n            .se-page-status-toolbar-container {\n                padding-left: 5px;\n                padding-right: 20px;\n                height: 100%;\n                display: flex;\n                align-items: center;\n                border-left: 1px solid fd-color('neutral', 3);\n            }\n        `],changeDetection:s.ChangeDetectionStrategy.OnPush})],$t);window.__smartedit__.addDecoratorPayload("Component","PageInWorkflowNotificationComponent",{selector:"se-page-in-workflow-notification",template:`<div><span translate="se.cms.workflow.page.in.workflow"></span></div>`});let Bt=class PageInWorkflowNotificationComponent{};Bt=__decorate([m.SeCustomComponent(),s.Component({selector:"se-page-in-workflow-notification",template:`<div><span translate="se.cms.workflow.page.in.workflow"></span></div>`})],Bt);let Gt=class WorkflowFacade{constructor(e,t,o,n,s,a,r){this.alertService=e;this.workflowService=t;this.confirmationModalService=o;this.genericEditorModalService=n;this.pageInfoService=s;this.systemEventService=a;this.l10nPipe=r;this.VERSION_LABEL_QUALIFIER="versionLabel";this.CREATE_VERSION_QUALIFIER="createVersion";this.SYNC_POLLING_SPEED_PREFIX="workflow-";this.startWorkflowStructureAttributes=[{cmsStructureType:"EditableDropdown",qualifier:"templateCode",i18nKey:"se.cms.workflow.editor.template",localized:false,required:true,idAttribute:"code",labelAttributes:["name"]},{cmsStructureType:"LongString",qualifier:"description",i18nKey:"se.cms.workflow.editor.description",required:false},{cmsStructureType:"WorkflowCreateVersionField",qualifier:this.CREATE_VERSION_QUALIFIER,required:false}];this.editWorkflowStructureAttributes=[{cmsStructureType:"LongString",qualifier:"description",i18nKey:"se.cms.workflow.editor.description",required:false}];this.makeDecisionStructureAttributes=[{cmsStructureType:"LongString",qualifier:"comment",i18nKey:"se.cms.workflow.editor.comment",required:false},{cmsStructureType:"WorkflowCreateVersionField",qualifier:this.CREATE_VERSION_QUALIFIER,required:false}]}startWorkflow(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getWorkflowDataForEditor();const t=this.systemEventService.subscribe(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,((e,t)=>this.handleUnrelatedValidationErrors(e,t)));try{return yield this.genericEditorModalService.open(e,(e=>{this.alertService.showSuccess("se.cms.workflow.create.alert.success");this.systemEventService.publish(p.WORKFLOW_CREATED_EVENT);this.updateWorkflowTasksCount();return e}))}finally{t()}}))}cancelWorflow(e){return __awaiter(this,void 0,void 0,(function*(){yield this.confirmationModalService.confirm({title:"se.cms.workflow.cancel.confirmation.title",description:"se.cms.workflow.cancel.confirmation.description"});try{yield this.workflowService.cancelWorflow(e);this.alertService.showSuccess("se.cms.workflow.cancel.alert.success")}finally{this.systemEventService.publish(p.WORKFLOW_FINISHED_EVENT);this.updateWorkflowTasksCount()}}))}editWorkflow(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getWorkflowDataForEditor(e);return this.genericEditorModalService.open(t,(e=>e))}))}updateWorkflowTasksCount(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield typeof e==="undefined"?this.getTotalNumberOfTasks():e;this.workflowService.updateWorkflowTasksCount(t)}))}getAllActionsForWorkflow(e){return this.workflowService.getAllActionsForWorkflowCode(e)}getActiveActionsForWorkflow(e){return this.workflowService.getActiveActionsForWorkflowCode(e)}getCommentsForWorkflowAction(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.workflowService.getCommentsForWorkflowAction(e,t,o);n.results=n.comments;delete n.comments;return n}))}getWorkflowInboxTasks(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.workflowService.getWorkflowInboxTasks(e);t.results=t.tasks;delete t.tasks;return t}))}getTotalNumberOfTasks(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getWorkflowInboxTasks({pageSize:1,currentPage:0});return e.pagination.totalCount}))}makeDecision(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n={title:yield this.l10nPipe.transform(o.name).pipe(g.take(1)).toPromise(),structure:{attributes:this.makeDecisionStructureAttributes},contentApi:this.workflowService.getResourceWorkflowOperationsURI(),saveLabel:"se.cms.workflow.editor.button.submit",content:{operation:m.WorkflowOperations.MAKE_DECISION,workflowCode:e,actionCode:t.code,decisionCode:o.code},initialDirty:true};return this.genericEditorModalService.open(n,(e=>__awaiter(this,void 0,void 0,(function*(){yield this.confirmDecision(e.status,t,o);return e}))),null)}))}confirmDecision(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.pageInfoService.getPageUUID();yield this.systemEventService.publish(p.DEFAULT_SYNCHRONIZATION_POLLING.SPEED_UP,this.SYNC_POLLING_SPEED_PREFIX+n);if(e.toLowerCase()===m.WorkflowStatus.FINISHED){this.alertService.showSuccess("se.cms.workflow.completed.alert.success");this.systemEventService.publishAsync(p.WORKFLOW_FINISHED_EVENT)}else{this.alertService.showSuccess({message:"se.cms.workflow.make.decision.success",messagePlaceholders:{workflowDecisionName:yield this.l10nPipe.transform(o.name).pipe(g.take(1)).toPromise(),workflowActionName:yield this.l10nPipe.transform(t.name).pipe(g.take(1)).toPromise()}})}this.systemEventService.publish(p.DEFAULT_SYNCHRONIZATION_POLLING.SLOW_DOWN,this.SYNC_POLLING_SPEED_PREFIX+n);const s=yield this.getTotalNumberOfTasks();this.updateWorkflowTasksCount(s)}))}getWorkflowDataForEditor(e=null){return __awaiter(this,void 0,void 0,(function*(){const t=e===null;const o={title:null,contentApi:this.workflowService.getResourceWorkflowURI()};return t?this.getComponentDataForStartingWorkflow(o):this.getComponentDataForNonStartingWorkflow(o,e.workflowCode)}))}getComponentDataForStartingWorkflow(e){return __awaiter(this,void 0,void 0,(function*(){const t=this.startWorkflowStructureAttributes.find((e=>e.qualifier==="templateCode"));const o=yield this.workflowService.getWorkflowTemplates({});t.options=o;e.title="se.cms.workflow.editor.start.workflow.title";e.saveLabel="se.cms.workflow.editor.button.start";e.structure={attributes:this.startWorkflowStructureAttributes};const n=yield this.pageInfoService.getPageUUID();e.content={attachments:[n]};return e}))}getComponentDataForNonStartingWorkflow(e,t){e.title="se.cms.workflow.editor.edit.workflow.title";e.saveLabel="se.cms.workflow.editor.button.save";e.structure={attributes:this.editWorkflowStructureAttributes};e.componentUuid=t;e.componentType="workflow";return e}handleUnrelatedValidationErrors(e,t){if(!t.sourceGenericEditorId){return}let o="";const n=[];t.messages.forEach((e=>{if(e.subject===this.VERSION_LABEL_QUALIFIER){e.subject=this.CREATE_VERSION_QUALIFIER;n.push(e)}else{o+=e.message+" "}}));if(o){this.alertService.showDanger(o)}if(n.length>0){this.systemEventService.publishAsync(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,{messages:n})}}};Gt.$inject=["alertService","workflowService","confirmationModalService","genericEditorModalService","pageInfoService","systemEventService","l10nPipe"];Gt=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IAlertService,m.WorkflowService,m.IConfirmationModalService,t.GenericEditorModalService,m.IPageInfoService,m.SystemEventService,m.L10nPipe])],Gt);window.__smartedit__.addDecoratorPayload("Component","PageWorkflowMenuAllTasksTabComponent",{selector:"se-page-workflow-menu-all-tasks-tab",template:`\n        <se-page-workflow-menu-tasks-tab\n            [actions]="actions"\n            [workflow]="workflow"\n            [canMakeDecisions]="false"\n        >\n        </se-page-workflow-menu-tasks-tab>\n    `});let Ht=class PageWorkflowMenuAllTasksTabComponent{constructor(e){({actions:this.actions,workflow:this.workflow}=e.model)}};Ht=__decorate([s.Component({selector:"se-page-workflow-menu-all-tasks-tab",template:`\n        <se-page-workflow-menu-tasks-tab\n            [actions]="actions"\n            [workflow]="workflow"\n            [canMakeDecisions]="false"\n        >\n        </se-page-workflow-menu-tasks-tab>\n    `}),__param(0,s.Inject(m.TAB_DATA)),__metadata("design:paramtypes",[Object])],Ht);window.__smartedit__.addDecoratorPayload("Component","PageWorkflowMenuCurrentTasksTabComponent",{selector:"se-page-workflow-menu-current-tasks-tab",template:`\n        <se-page-workflow-menu-tasks-tab\n            [actions]="currentActions"\n            [workflow]="workflow"\n            [canMakeDecisions]="true"\n        >\n        </se-page-workflow-menu-tasks-tab>\n    `});let Wt=class PageWorkflowMenuCurrentTasksTabComponent{constructor(e){({actions:this.actions,workflow:this.workflow}=e.model)}ngOnInit(){this.currentActions=this.actions.filter((e=>e.status.toLowerCase()===m.WorkflowActionStatus.IN_PROGRESS))}};Wt=__decorate([s.Component({selector:"se-page-workflow-menu-current-tasks-tab",template:`\n        <se-page-workflow-menu-tasks-tab\n            [actions]="currentActions"\n            [workflow]="workflow"\n            [canMakeDecisions]="true"\n        >\n        </se-page-workflow-menu-tasks-tab>\n    `}),__param(0,s.Inject(m.TAB_DATA)),__metadata("design:paramtypes",[Object])],Wt);window.__smartedit__.addDecoratorPayload("Component","PageWorkflowMenuComponent",{selector:"se-page-workflow-menu",template:`<div *ngIf="isReady"><div *ngIf="!pageHasWorkflow && isWorkflowEnabled"><ng-container *seHasOperationPermission="'se.start.page.workflow'"><button id="smartEditPerspectiveToolbar_option_se.cms.startWorkflow_btn" class="btn toolbar-action--button" type="button" (click)="startWorkflow()" aria-expanded="false"><span id="smartEditPerspectiveToolbar_option_se.cms.startWorkflow_btn_lbl" class="toolbar-action-button__txt" translate="se.cms.workflow.toolbar.start.workflow"></span></button></ng-container></div><div *seHasOperationPermission="'se.view.page.workflowMenu'"><fd-popover *ngIf="pageHasWorkflow" class="toolbar-action" [closeOnOutsideClick]="true" [isOpen]="actionItem.isOpen" (isOpenChange)="onDropdownToggle($event)"><fd-popover-control><button type="button" class="page-tasks-btn toolbar-action--button" [attr.aria-expanded]="actionItem.isOpen"><span class="page-tasks-btn__icon sap-icon--workflow-tasks"></span> <span class="page-tasks-btn__label" translate="se.cms.workflow.toolbar.view.workflow.menu"></span></button></fd-popover-control><fd-popover-body><div *ngIf="actionItem.isOpen" class="toolbar-action--include se-page-workflow-menu"><div class="se-page-workflow-menu__header"><div class="se-page-workflow-menu__header-text" translate="se.cms.workflow.toolbar.view.workflow.menu"></div><div class="se-page-workflow-menu__header-menu"><se-workflow-item-menu [workflowInfo]="workflow"></se-workflow-item-menu></div></div><div class="se-version-toolbar-menu-content__body"><div class="se-page-workflow-menu-tabs"><se-tabs *ngIf="areTabsReady; else spinner" [tabsList]="tabsList" [model]="tabsData" [numTabsDisplayed]="2"></se-tabs><ng-template #spinner><se-spinner [isSpinning]="true"></se-spinner></ng-template></div></div></div></fd-popover-body></fd-popover></div></div>`,styles:[`/*!\n * Fundamental Library Styles v0.4.1\n * Copyright (c) 2020 SAP SE or an SAP affiliate company.\n * Licensed under Apache License 2.0 (https://github.com/SAP/fundamental-styles/blob/master/LICENSE)\n *//*!\n.fd-button-split+()\n    .fd-button\n*/.fd-button-split{font-size:.875rem;font-size:var(--sapFontSize,.875rem);line-height:1.42857;color:#32363a;color:var(--sapTextColor,#32363a);font-family:"72","72full",Arial,Helvetica,sans-serif;font-family:var(--sapFontFamily, "72", "72full", Arial, Helvetica, sans-serif);font-weight:400;-webkit-font-smoothing:antialiased;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0;border:0;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;position:relative}.fd-button-split:after,.fd-button-split:before{-webkit-box-sizing:inherit;box-sizing:inherit;font-size:inherit}.fd-button-split :first-child{margin:0;border-top-right-radius:0;border-bottom-right-radius:0}.fd-button-split :nth-child(2){margin:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.fd-button-split[dir=rtl] :first-child,[dir=rtl] .fd-button-split :first-child{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.25rem;border-top-right-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-right-radius:.25rem;border-bottom-right-radius:var(--sapButton_BorderCornerRadius,.25rem)}.fd-button-split[dir=rtl] :nth-child(2),[dir=rtl] .fd-button-split :nth-child(2){border-top-left-radius:.25rem;border-top-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-left-radius:.25rem;border-bottom-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-top-right-radius:0;border-bottom-right-radius:0;border-left-width:.0625rem;border-left-width:var(--sapButton_BorderWidth,.0625rem);border-right-width:0}.fd-button-split [class*="--emphasized"]:first-child{margin-right:1px}.fd-button-split [class*="--emphasized"][dir=rtl]:first-child,[dir=rtl] .fd-button-split [class*="--emphasized"]:first-child{margin-right:0;margin-left:1px}se-page-workflow-menu .toolbar-action .page-tasks-btn[aria-expanded=true]{background-color:rgba(10,110,209,.07)}se-page-workflow-menu .toolbar-action .page-tasks-btn__label{font-size:14px;color:#32363a}se-page-workflow-menu .toolbar-action .page-tasks-btn__icon{color:#0a6ed1;font-size:18px;margin-right:8px}se-page-workflow-menu .se-page-workflow-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;min-width:350px;min-height:130px;right:-126px;left:auto;font-size:14px;font-family:'72',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;line-height:20/14}se-page-workflow-menu .se-page-workflow-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}se-page-workflow-menu .se-page-workflow-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}se-page-workflow-menu .se-page-workflow-menu,se-page-workflow-menu .se-page-workflow-menu::after,se-page-workflow-menu .se-page-workflow-menu::before{left:50%;transform:translate(-50%)}se-page-workflow-menu .se-page-workflow-menu__header{display:flex;justify-content:space-between}se-page-workflow-menu .se-page-workflow-menu__header-text{font-size:16px;padding:20px 0 0 16px}se-page-workflow-menu .se-page-workflow-menu__header-menu{padding:16px 16px 0 0}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset{margin:0}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset__tab{margin-left:16px}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset__link{color:#32363a}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset__link:hover{color:#0a6ed1}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let qt=class PageWorkflowMenuComponent{constructor(e,t,o,n,s,a,r){this.workflowService=e;this.workflowFacade=t;this.systemEventService=o;this.routingService=n;this.pageService=s;this.cdr=a;this.actionItem=r;this.isReady=false;this.isWorkflowEnabled=false;this.areTabsReady=false;this.pageHasWorkflow=false;this.tabsList=[{id:"currentTasksTab",title:"se.cms.page.workflow.tabs.currenttasks",hasErrors:false,component:Wt},{id:"allTasksTab",title:"se.cms.page.workflow.tabs.alltasks",hasErrors:false,component:Ht}];this.tabsData={workflow:null,actions:[]}}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.unRegOpenMenuEvent=this.systemEventService.subscribe(Nt,((e,t)=>this.onDropdownToggle(t)));this.unRegPerspectiveChangedEvent=this.systemEventService.subscribe(m.EVENT_PERSPECTIVE_CHANGED,(()=>this.loadWorkflow()));this.unRegWorkflowFinishedEvent=this.systemEventService.subscribe(p.WORKFLOW_FINISHED_EVENT,(()=>this.loadWorkflow()));this.unRegDecisionSelectedEvent=this.systemEventService.subscribe(zt,(()=>this.closeDropdown()));this.unRegWorkflowRefreshEvent=this.systemEventService.subscribe(Ut,(()=>this.loadWorkflow()));yield this.loadWorkflow();this.isReady=true;this.actionItem.isOpen=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){this.unRegOpenMenuEvent();this.unRegPerspectiveChangedEvent();this.unRegWorkflowFinishedEvent();this.unRegDecisionSelectedEvent();this.unRegWorkflowRefreshEvent()}set workflow(e){this._workflow=e;this.tabsData.workflow=e}get workflow(){return this._workflow}onDropdownToggle(e){return __awaiter(this,void 0,void 0,(function*(){this.actionItem.isOpen=e;if(!e){return}this.systemEventService.publish(Ft);yield this.loadWorkflowAndActions()}))}startWorkflow(){return __awaiter(this,void 0,void 0,(function*(){yield this.workflowFacade.startWorkflow();this.routingService.reload()}))}loadWorkflowAndActions(){return __awaiter(this,void 0,void 0,(function*(){this.areTabsReady=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}yield this.loadWorkflow(false);yield this.loadActions();this.areTabsReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}loadWorkflow(e=true){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageService.getCurrentPageInfo();const o=yield this.workflowService.getActiveWorkflowForPageUuid(t.uuid);this.workflow=o;this.pageHasWorkflow=!!o;this.isWorkflowEnabled=t.displayStatus==="DRAFT";if(e){if(!this.cdr.destroyed){this.cdr.detectChanges()}}}))}loadActions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.workflowFacade.getAllActionsForWorkflow(this.workflow.workflowCode);this.setActions(e)}))}setActions(e){e.sort(((e,t)=>this.actionComparator(e,t)));this.tabsData.actions=e}closeDropdown(){this.actionItem.isOpen=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}actionComparator(e,t){const o=this.getActionPriority(e);const n=this.getActionPriority(t);return o!==n?o-n:e.startedAgoInMillis-t.startedAgoInMillis}getActionPriority(e){switch(e.status.toLowerCase()){case m.WorkflowActionStatus.IN_PROGRESS:return 1;case m.WorkflowActionStatus.PENDING:return 2;case m.WorkflowActionStatus.COMPLETED:return 3;default:return 4}}};qt.$inject=["workflowService","workflowFacade","systemEventService","routingService","pageService","cdr","actionItem"];qt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-workflow-menu",template:`<div *ngIf="isReady"><div *ngIf="!pageHasWorkflow && isWorkflowEnabled"><ng-container *seHasOperationPermission="'se.start.page.workflow'"><button id="smartEditPerspectiveToolbar_option_se.cms.startWorkflow_btn" class="btn toolbar-action--button" type="button" (click)="startWorkflow()" aria-expanded="false"><span id="smartEditPerspectiveToolbar_option_se.cms.startWorkflow_btn_lbl" class="toolbar-action-button__txt" translate="se.cms.workflow.toolbar.start.workflow"></span></button></ng-container></div><div *seHasOperationPermission="'se.view.page.workflowMenu'"><fd-popover *ngIf="pageHasWorkflow" class="toolbar-action" [closeOnOutsideClick]="true" [isOpen]="actionItem.isOpen" (isOpenChange)="onDropdownToggle($event)"><fd-popover-control><button type="button" class="page-tasks-btn toolbar-action--button" [attr.aria-expanded]="actionItem.isOpen"><span class="page-tasks-btn__icon sap-icon--workflow-tasks"></span> <span class="page-tasks-btn__label" translate="se.cms.workflow.toolbar.view.workflow.menu"></span></button></fd-popover-control><fd-popover-body><div *ngIf="actionItem.isOpen" class="toolbar-action--include se-page-workflow-menu"><div class="se-page-workflow-menu__header"><div class="se-page-workflow-menu__header-text" translate="se.cms.workflow.toolbar.view.workflow.menu"></div><div class="se-page-workflow-menu__header-menu"><se-workflow-item-menu [workflowInfo]="workflow"></se-workflow-item-menu></div></div><div class="se-version-toolbar-menu-content__body"><div class="se-page-workflow-menu-tabs"><se-tabs *ngIf="areTabsReady; else spinner" [tabsList]="tabsList" [model]="tabsData" [numTabsDisplayed]="2"></se-tabs><ng-template #spinner><se-spinner [isSpinning]="true"></se-spinner></ng-template></div></div></div></fd-popover-body></fd-popover></div></div>`,styles:[`/*!\n * Fundamental Library Styles v0.4.1\n * Copyright (c) 2020 SAP SE or an SAP affiliate company.\n * Licensed under Apache License 2.0 (https://github.com/SAP/fundamental-styles/blob/master/LICENSE)\n *//*!\n.fd-button-split+()\n    .fd-button\n*/.fd-button-split{font-size:.875rem;font-size:var(--sapFontSize,.875rem);line-height:1.42857;color:#32363a;color:var(--sapTextColor,#32363a);font-family:"72","72full",Arial,Helvetica,sans-serif;font-family:var(--sapFontFamily, "72", "72full", Arial, Helvetica, sans-serif);font-weight:400;-webkit-font-smoothing:antialiased;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0;border:0;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;position:relative}.fd-button-split:after,.fd-button-split:before{-webkit-box-sizing:inherit;box-sizing:inherit;font-size:inherit}.fd-button-split :first-child{margin:0;border-top-right-radius:0;border-bottom-right-radius:0}.fd-button-split :nth-child(2){margin:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.fd-button-split[dir=rtl] :first-child,[dir=rtl] .fd-button-split :first-child{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.25rem;border-top-right-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-right-radius:.25rem;border-bottom-right-radius:var(--sapButton_BorderCornerRadius,.25rem)}.fd-button-split[dir=rtl] :nth-child(2),[dir=rtl] .fd-button-split :nth-child(2){border-top-left-radius:.25rem;border-top-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-left-radius:.25rem;border-bottom-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-top-right-radius:0;border-bottom-right-radius:0;border-left-width:.0625rem;border-left-width:var(--sapButton_BorderWidth,.0625rem);border-right-width:0}.fd-button-split [class*="--emphasized"]:first-child{margin-right:1px}.fd-button-split [class*="--emphasized"][dir=rtl]:first-child,[dir=rtl] .fd-button-split [class*="--emphasized"]:first-child{margin-right:0;margin-left:1px}se-page-workflow-menu .toolbar-action .page-tasks-btn[aria-expanded=true]{background-color:rgba(10,110,209,.07)}se-page-workflow-menu .toolbar-action .page-tasks-btn__label{font-size:14px;color:#32363a}se-page-workflow-menu .toolbar-action .page-tasks-btn__icon{color:#0a6ed1;font-size:18px;margin-right:8px}se-page-workflow-menu .se-page-workflow-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;min-width:350px;min-height:130px;right:-126px;left:auto;font-size:14px;font-family:'72',-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;line-height:20/14}se-page-workflow-menu .se-page-workflow-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}se-page-workflow-menu .se-page-workflow-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}se-page-workflow-menu .se-page-workflow-menu,se-page-workflow-menu .se-page-workflow-menu::after,se-page-workflow-menu .se-page-workflow-menu::before{left:50%;transform:translate(-50%)}se-page-workflow-menu .se-page-workflow-menu__header{display:flex;justify-content:space-between}se-page-workflow-menu .se-page-workflow-menu__header-text{font-size:16px;padding:20px 0 0 16px}se-page-workflow-menu .se-page-workflow-menu__header-menu{padding:16px 16px 0 0}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset{margin:0}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset__tab{margin-left:16px}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset__link{color:#32363a}se-page-workflow-menu .se-page-workflow-menu-tabs .se-tabset__link:hover{color:#0a6ed1}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(6,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[m.WorkflowService,Gt,m.SystemEventService,m.SmarteditRoutingService,m.IPageService,s.ChangeDetectorRef,Object])],qt);window.__smartedit__.addDecoratorPayload("Component","WorkflowInboxMultipleTasksAnnouncementComponent",{selector:"se-workflow-inbox-multiple-tasks-announcement",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<div (click)="onClick($event)" class="se-announcement__message--multi">{{ 'se.cms.workflow.tasks.announcement' | translate: count }}</div>`});let Kt=class WorkflowInboxMultipleTasksAnnouncementComponent{constructor(e,t,o){this.systemEventService=e;this.announcementService=t;this.count={announcementCount:null};({id:this.announcementId,tasks:this.tasks}=o)}ngOnInit(){this.count.announcementCount=String(this.tasks.length)}onClick(e){e.stopPropagation();this.systemEventService.publish(Lt);this.announcementService.closeAnnouncement(this.announcementId)}};Kt=__decorate([s.Component({selector:"se-workflow-inbox-multiple-tasks-announcement",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<div (click)="onClick($event)" class="se-announcement__message--multi">{{ 'se.cms.workflow.tasks.announcement' | translate: count }}</div>`}),__param(2,s.Inject(m.ANNOUNCEMENT_DATA)),__metadata("design:paramtypes",[m.SystemEventService,m.IAnnouncementService,Object])],Kt);window.__smartedit__.addDecoratorPayload("Component","WorkflowInboxSingleTaskAnnouncementComponent",{selector:"se-workflow-inbox-single-task-announcement",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<div (click)="onClick($event)"><div class="se-announcement__title">{{ task.action.name | seL10n | async }}</div><div class="se-announcement__message">{{ task.attachments[0].catalogName | seL10n | async }} | {{ task.attachments[0].pageName }}</div><div class="se-announcement__time-stamp">{{ startedAgo }}</div></div>`});let Yt=class WorkflowInboxSingleTaskAnnouncementComponent{constructor(e,t,o,n){this.workflowService=e;this.cmsTimeService=t;this.announcementService=o;({id:this.announcementId,task:this.task}=n)}ngOnInit(){this.startedAgo=this.getStartedAgo()}onClick(e){e.stopPropagation();this.workflowService.loadExperienceAndOpenPageWorkflowMenu(this.task);this.announcementService.closeAnnouncement(this.announcementId)}getStartedAgo(){if(!!this.task.action.startedAgoInMillis){return this.cmsTimeService.getTimeAgo(this.task.action.startedAgoInMillis)}return null}};Yt=__decorate([s.Component({selector:"se-workflow-inbox-single-task-announcement",changeDetection:s.ChangeDetectionStrategy.OnPush,template:`<div (click)="onClick($event)"><div class="se-announcement__title">{{ task.action.name | seL10n | async }}</div><div class="se-announcement__message">{{ task.attachments[0].catalogName | seL10n | async }} | {{ task.attachments[0].pageName }}</div><div class="se-announcement__time-stamp">{{ startedAgo }}</div></div>`}),__param(3,s.Inject(m.ANNOUNCEMENT_DATA)),__metadata("design:paramtypes",[m.WorkflowService,p.CMSTimeService,m.IAnnouncementService,Object])],Yt);let Zt=class WorkflowInboxAnnouncementService{constructor(e,t){this.workflowTasksPollingService=e;this.announcementService=t;this.unsubscribePollingService=this.workflowTasksPollingService.addSubscriber(((e,t)=>{if(e){this.displayAnnouncement(e)}}),false)}ngOnDestroy(){this.unsubscribePollingService()}displayAnnouncement(e){if(e.length===1){this.showSingleTaskAnnouncement(e[0])}else if(e.length>1){this.showMultipleTasksAnnouncement(e)}}showSingleTaskAnnouncement(e){return __awaiter(this,void 0,void 0,(function*(){yield this.showAnnouncement(Yt,{task:e})}))}showMultipleTasksAnnouncement(e){return __awaiter(this,void 0,void 0,(function*(){yield this.showAnnouncement(Kt,{tasks:e})}))}showAnnouncement(e,t){return this.announcementService.showAnnouncement({component:e,data:t})}};Zt.$inject=["workflowTasksPollingService","announcementService"];Zt=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.WorkflowTasksPollingService,m.IAnnouncementService])],Zt);window.__smartedit__.addDecoratorPayload("Component","WorkflowInboxComponent",{selector:"se-workflow-inbox",template:`<fd-popover class="toolbar-action se-workflow-inbox-container dropdown" [class.open]="actionItem.isOpen" [(isOpen)]="actionItem.isOpen" (isOpenChange)="onDropdownToggle(isOpen)" [closeOnOutsideClick]="true" [triggers]="['click']" [placement]="'bottom-' + actionItem.dropdownPosition"><fd-popover-control class="se-workflow-inbox-toggle-control"><button type="button" class="se-workflow-inbox-toggle toolbar-action--button--compact" [attr.aria-pressed]="actionItem.isOpen"><span class="se-toolbar-actions__icon sap-icon--task"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]="{\n                'se-toolbar__dropdown--right': actionItem.dropdownPosition === 'right',\n                'se-toolbar__dropdown--center': actionItem.dropdownPosition === 'center',\n                'se-toolbar__dropdown--left': actionItem.dropdownPosition === 'left'\n            }" class="toolbar-action--include--compact"><div *ngIf="actionItem.isOpen" class="se-workflow-inbox"><div class="se-workflow-inbox"><div class="se-workflow-inbox-header"><div class="se-workflow-inbox-header__title" [translate]="'se.cms.workflow.toolbar.inbox'"></div></div><div class="se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body"><div *ngIf="!tasksNotReady && totalNumberOfTasks === 0" class="se-workflow-inbox-tasks__no-tasks"><img src="static-resources/images/Inbox.svg" alt="empty-inbox"/> <span class="se-workflow-inbox__empty-inbox-message" [translate]="'se.cms.workflow.toolbar.inbox.emptyinbox.message'"></span> <span class="se-workflow-inbox__empty-inbox-message-alt" [translate]="'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt'"></span></div><se-infinite-scrolling class="se-version-panel__infinite-scroll se-infinite-scrolling--narrowed" [pageSize]="pageSize" [fetchPage]="fetchPageOfInboxTasks" (itemsChange)="onInboxTasksLoaded($event)"><div *ngFor="let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex" class="se-workflow-inbox-task se-cms-dev-workflow-inbox-task"><se-workflow-inbox-task id="workflow-inbox-task-{{i}}" [class.se-workflow-inbox-task-last]="last" [task]="task"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>`,styles:[`.se-workflow-inbox-toggle{outline:0}.se-workflow-inbox-header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a;border-bottom:1px solid #d9d9d9;padding:10px 0 15px 20px;height:46px}.se-workflow-inbox-header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-workflow-inbox-tasks{padding:16px 0 8px;width:280px}.se-workflow-inbox-tasks__no-tasks{display:flex;flex-direction:column;align-items:center}.se-workflow-inbox__empty-inbox-message{color:#51555a;padding:8px 0 4px}.se-workflow-inbox__empty-inbox-message-alt{font-size:13px;color:#6a6d70;padding-bottom:30px}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Xt=class WorkflowInboxComponent{constructor(e,t,o,n,s,a){this.workflowFacade=e;this.systemEventService=t;this.workflowTasksPollingService=o;this.userTrackingService=n;this.actionItem=s;this.cdr=a;this.pageSize=10;this.workflowTasks=[];this.fetchPageOfInboxTasks=(e,t,o)=>this.loadInboxTasks(e,t,o)}ngOnInit(){this.tasksNotReady=true;this.unRegisterOpenDropdownEvent=this.systemEventService.subscribe(Lt,(()=>this.openDropdown()));this.unRegisterWorkflowCreatedEvent=this.systemEventService.subscribe(p.WORKFLOW_CREATED_EVENT,(()=>this.loadInboxTasks("",this.pageSize,0)));this.unRegWorkflowTasksMenuOpenedEvent=this.systemEventService.subscribe(Ft,(()=>this.hideDropdown()));this.workflowTasksPollingService.startPolling()}ngOnDestroy(){this.workflowTasksPollingService.stopPolling();this.unRegisterOpenDropdownEvent();this.unRegisterWorkflowCreatedEvent();this.unRegWorkflowTasksMenuOpenedEvent()}loadInboxTasks(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.workflowFacade.getWorkflowInboxTasks({currentPage:o,mask:e,pageSize:t});this.tasksNotReady=false;this.totalNumberOfTasks=n.pagination.totalCount;this.workflowFacade.updateWorkflowTasksCount(this.totalNumberOfTasks);if(!this.cdr.destroyed){this.cdr.detectChanges()}return n}))}onInboxTasksLoaded(e){this.workflowTasks=e}onDropdownToggle(e){if(e){this.workflowTasksPollingService.stopPolling();return}this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.HEADER_TOOL,"Inbox");this.workflowTasksPollingService.startPolling();this.tasksNotReady=true}trackByIndex(e){return e}openDropdown(){this.actionItem.isOpen=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}hideDropdown(){this.actionItem.isOpen=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}};Xt.$inject=["workflowFacade","systemEventService","workflowTasksPollingService","userTrackingService","actionItem","cdr"];Xt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-workflow-inbox",template:`<fd-popover class="toolbar-action se-workflow-inbox-container dropdown" [class.open]="actionItem.isOpen" [(isOpen)]="actionItem.isOpen" (isOpenChange)="onDropdownToggle(isOpen)" [closeOnOutsideClick]="true" [triggers]="['click']" [placement]="'bottom-' + actionItem.dropdownPosition"><fd-popover-control class="se-workflow-inbox-toggle-control"><button type="button" class="se-workflow-inbox-toggle toolbar-action--button--compact" [attr.aria-pressed]="actionItem.isOpen"><span class="se-toolbar-actions__icon sap-icon--task"></span><se-workflow-inbox-badge></se-workflow-inbox-badge></button></fd-popover-control><fd-popover-body><div [ngClass]="{\n                'se-toolbar__dropdown--right': actionItem.dropdownPosition === 'right',\n                'se-toolbar__dropdown--center': actionItem.dropdownPosition === 'center',\n                'se-toolbar__dropdown--left': actionItem.dropdownPosition === 'left'\n            }" class="toolbar-action--include--compact"><div *ngIf="actionItem.isOpen" class="se-workflow-inbox"><div class="se-workflow-inbox"><div class="se-workflow-inbox-header"><div class="se-workflow-inbox-header__title" [translate]="'se.cms.workflow.toolbar.inbox'"></div></div><div class="se-workflow-inbox-tasks se-cms-dev-workflow-inbox-tasks fd-panel__body"><div *ngIf="!tasksNotReady && totalNumberOfTasks === 0" class="se-workflow-inbox-tasks__no-tasks"><img src="static-resources/images/Inbox.svg" alt="empty-inbox"/> <span class="se-workflow-inbox__empty-inbox-message" [translate]="'se.cms.workflow.toolbar.inbox.emptyinbox.message'"></span> <span class="se-workflow-inbox__empty-inbox-message-alt" [translate]="'se.cms.workflow.toolbar.inbox.emptyinbox.message.alt'"></span></div><se-infinite-scrolling class="se-version-panel__infinite-scroll se-infinite-scrolling--narrowed" [pageSize]="pageSize" [fetchPage]="fetchPageOfInboxTasks" (itemsChange)="onInboxTasksLoaded($event)"><div *ngFor="let task of workflowTasks; let i = index; let last = last; trackBy: trackByIndex" class="se-workflow-inbox-task se-cms-dev-workflow-inbox-task"><se-workflow-inbox-task id="workflow-inbox-task-{{i}}" [class.se-workflow-inbox-task-last]="last" [task]="task"></se-workflow-inbox-task></div></se-infinite-scrolling></div></div></div></div></fd-popover-body></fd-popover>`,styles:[`.se-workflow-inbox-toggle{outline:0}.se-workflow-inbox-header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a;border-bottom:1px solid #d9d9d9;padding:10px 0 15px 20px;height:46px}.se-workflow-inbox-header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-workflow-inbox-tasks{padding:16px 0 8px;width:280px}.se-workflow-inbox-tasks__no-tasks{display:flex;flex-direction:column;align-items:center}.se-workflow-inbox__empty-inbox-message{color:#51555a;padding:8px 0 4px}.se-workflow-inbox__empty-inbox-message-alt{font-size:13px;color:#6a6d70;padding-bottom:30px}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(4,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[Gt,m.SystemEventService,m.WorkflowTasksPollingService,m.UserTrackingService,Object,s.ChangeDetectorRef])],Xt);window.__smartedit__.addDecoratorPayload("Component","PageWorkflowMenuTasksTabComponent",{selector:"se-page-workflow-menu-tasks-tab",template:`\n        <div class="se-page-workflow-tasks-wrapper">\n            <div *ngFor="let action of actions">\n                <div class="se-page-workflow-task fd-panel">\n                    <div>\n                        <se-workflow-action-item\n                            [workflow]="workflow"\n                            [workflowAction]="action"\n                            [canMakeDecisions]="canMakeDecisions"\n                        ></se-workflow-action-item>\n                    </div>\n                </div>\n                <br />\n            </div>\n        </div>\n    `,styles:[`.se-page-workflow-tasks-wrapper{max-height:400px;overflow-y:scroll;padding:15px 15px 0 15px;width:100%}.se-page-workflow-tasks-wrapper .fd-panel{box-shadow:0 0 4px 0 rgba(0,0,0,.15);max-width:320px}`]});let Qt=class PageWorkflowMenuTasksTabComponent{};__decorate([s.Input(),__metadata("design:type",Array)],Qt.prototype,"actions",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Qt.prototype,"workflow",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Qt.prototype,"canMakeDecisions",void 0);Qt=__decorate([s.Component({selector:"se-page-workflow-menu-tasks-tab",template:`\n        <div class="se-page-workflow-tasks-wrapper">\n            <div *ngFor="let action of actions">\n                <div class="se-page-workflow-task fd-panel">\n                    <div>\n                        <se-workflow-action-item\n                            [workflow]="workflow"\n                            [workflowAction]="action"\n                            [canMakeDecisions]="canMakeDecisions"\n                        ></se-workflow-action-item>\n                    </div>\n                </div>\n                <br />\n            </div>\n        </div>\n    `,styles:[`.se-page-workflow-tasks-wrapper{max-height:400px;overflow-y:scroll;padding:15px 15px 0 15px;width:100%}.se-page-workflow-tasks-wrapper .fd-panel{box-shadow:0 0 4px 0 rgba(0,0,0,.15);max-width:320px}`]})],Qt);window.__smartedit__.addDecoratorPayload("Component","WorkflowInboxBadgeComponent",{selector:"se-workflow-inbox-badge",template:`<ng-container *ngIf="inboxCount$ | async as count"><div *ngIf="count > 0" aria-label="Notifications"><div class="fd-counter fd-counter--notification se-inbox-badge" aria-label="Unread count">{{ stringifyCount(count) }}</div></div></ng-container>`,styles:[`.se-inbox-badge{transform:none;top:-2px;left:22px;font-size:10px;border-radius:8px;padding:2px 4px}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Jt=class WorkflowInboxBadgeComponent{constructor(e){this.workflowService=e}ngOnInit(){this.inboxCount$=this.workflowService.getTotalNumberOfActiveWorkflowTasks()}stringifyCount(e){return e<=99?String(e):"99+"}};Jt.$inject=["workflowService"];Jt=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-workflow-inbox-badge",template:`<ng-container *ngIf="inboxCount$ | async as count"><div *ngIf="count > 0" aria-label="Notifications"><div class="fd-counter fd-counter--notification se-inbox-badge" aria-label="Unread count">{{ stringifyCount(count) }}</div></div></ng-container>`,styles:[`.se-inbox-badge{transform:none;top:-2px;left:22px;font-size:10px;border-radius:8px;padding:2px 4px}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.WorkflowService])],Jt);window.__smartedit__.addDecoratorPayload("Component","WorkflowInboxTaskComponent",{selector:"se-workflow-inbox-task",template:`<div class="se-workflow-inbox-task-header"><a href="#" (click)="onClick($event)">{{ taskName | async }}</a></div><div class="se-workflow-inbox-task-desc">{{ taskDescription | async }}</div><div class="se-workflow-inbox-task-body">{{ getTaskCreatedAgo() }}</div>`,styles:[`:host{white-space:normal}:host(.se-workflow-inbox-task-last) .se-workflow-inbox-task-body{border-bottom:none;margin-bottom:0}.se-workflow-inbox-task-header a{font-size:1rem;line-height:1.4285714286;font-weight:400;font-weight:700;text-decoration:none;margin-bottom:4px}.se-workflow-inbox-task-desc{font-size:1rem;line-height:1.4285714286;font-weight:400;color:#32363a}.se-workflow-inbox-task-body{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#74777a;text-transform:lowercase;margin:8px 0 20px;padding-bottom:12px;border-bottom:1px solid #d9d9d9}`],providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush});let ei=class WorkflowInboxTaskComponent{constructor(e,t,o){this.cMSTimeService=e;this.workflowService=t;this.l10nPipe=o}ngOnInit(){this.taskName=this.getTaskName();this.taskDescription=this.getTaskDescription()}getTaskName(){return __awaiter(this,void 0,void 0,(function*(){return this.l10nPipe.transform(this.task.action.name).pipe(g.take(1)).toPromise()}))}getTaskDescription(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.l10nPipe.transform(this.task.attachments[0].catalogName).pipe(g.take(1)).toPromise();return`${e} ${this.task.attachments[0].catalogVersion} | ${this.task.attachments[0].pageName}`}))}getTaskCreatedAgo(){return this.cMSTimeService.getTimeAgo(this.task.action.startedAgoInMillis)}onClick(e){e.preventDefault();this.workflowService.loadExperienceAndOpenPageWorkflowMenu(this.task)}};ei.$inject=["cMSTimeService","workflowService","l10nPipe"];__decorate([s.Input(),__metadata("design:type",Object)],ei.prototype,"task",void 0);ei=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-workflow-inbox-task",template:`<div class="se-workflow-inbox-task-header"><a href="#" (click)="onClick($event)">{{ taskName | async }}</a></div><div class="se-workflow-inbox-task-desc">{{ taskDescription | async }}</div><div class="se-workflow-inbox-task-body">{{ getTaskCreatedAgo() }}</div>`,styles:[`:host{white-space:normal}:host(.se-workflow-inbox-task-last) .se-workflow-inbox-task-body{border-bottom:none;margin-bottom:0}.se-workflow-inbox-task-header a{font-size:1rem;line-height:1.4285714286;font-weight:400;font-weight:700;text-decoration:none;margin-bottom:4px}.se-workflow-inbox-task-desc{font-size:1rem;line-height:1.4285714286;font-weight:400;color:#32363a}.se-workflow-inbox-task-body{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#74777a;text-transform:lowercase;margin:8px 0 20px;padding-bottom:12px;border-bottom:1px solid #d9d9d9}`],providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[p.CMSTimeService,m.WorkflowService,m.L10nPipe])],ei);window.__smartedit__.addDecoratorPayload("Component","WorkflowItemMenuComponent",{selector:"se-workflow-item-menu",template:`<se-popup-overlay class="popup-anchor" [ngClass]="{ 'popup-anchor--open': isMenuOpen }" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><span *ngIf="menuItems.length > 0" (click)="toggleMenu()" class="workflow-item-menu__toggle-btn sap-icon--overflow"></span><div se-popup-overlay-body><div class="workflow-item-menu"><div class="workflow-item-menu__item" *ngFor="let dropdownItem of menuItems"><ng-container class="container" [ngSwitch]="dropdownItem.i18nKey"><div *ngSwitchCase="'se.cms.actionitem.page.workflow.description'" class="workflow-description"><div class="se-dropdown-item--label"><div class="workflow-description__label fd-has-type-1 fd-has-margin-bottom-tiny"><div [translate]="dropdownItem.i18nKey"></div><div *seHasOperationPermission="'se.edit.workflow.workflowMenu'"><a title="Edit" class="workflow-description__edit-btn sap-icon--edit fd-has-float-right" (click)="editDescription()"></a></div></div><div *ngIf="workflowInfo.description; else noDescription" class="workflow-description__text">{{ workflowInfo.description }}</div><ng-template #noDescription><div translate="se.cms.actionitem.page.workflow.no.description"></div></ng-template></div></div><div *ngSwitchCase="'se.cms.actionitem.page.workflow.cancel'" class="workflow-cancel-btn fd-has-color-status-3" [translate]="dropdownItem.i18nKey" (click)="cancelWorkflow()"></div></ng-container></div></div></div></se-popup-overlay>`,styles:[`.popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding-top:5px;width:32px;height:32px;border-radius:4px}.popup-anchor--open{background-color:#eeeeef}.workflow-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.workflow-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.workflow-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.workflow-item-menu::after,.workflow-item-menu::before{right:10px}.workflow-item-menu::after,.workflow-item-menu::before{display:none}.workflow-description{min-width:225px;padding:20px}.workflow-description__label{color:#32363a;display:flex;justify-content:space-between}.workflow-description__label .sap-icon--edit{cursor:pointer}.workflow-description__label .sap-icon--edit:hover{text-decoration:none}.workflow-description__text{word-break:normal;word-spacing:normal;word-wrap:break-word;white-space:normal;color:#51555a}.workflow-cancel-btn{cursor:pointer;padding:12px 20px;border-top:1px solid #fafafa}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let ti=class WorkflowItemMenuComponent{constructor(e,t,o,n,s){this.systemEventService=e;this.workflowFacade=t;this.routingService=o;this.permissionService=n;this.cdr=s;this.isMenuOpen=false;this.popupConfig={halign:"left",valign:"bottom"};this.menuItems=[]}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.unRegWorkflowMenuOpenedEvent=this.systemEventService.subscribe(Vt,((e,t)=>this.onWorkflowItemMenuOpen(t)));this.menuItems=yield this.getPermittedButtons([{i18nKey:"se.cms.actionitem.page.workflow.description",permissions:["se.view.page.workflowMenu"]},{i18nKey:"se.cms.actionitem.page.workflow.cancel",permissions:["se.cancel.page.workflowMenu"]}]);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){this.unRegWorkflowMenuOpenedEvent()}toggleMenu(){this.isMenuOpen=!this.isMenuOpen;if(this.isMenuOpen&&this.workflowInfo){this.systemEventService.publishAsync(Vt,{uid:this.workflowInfo.workflowCode})}}hideMenu(){this.isMenuOpen=false}editDescription(){return __awaiter(this,void 0,void 0,(function*(){this.hideMenu();const e=yield this.workflowFacade.editWorkflow(this.workflowInfo);this.workflowInfo.description=e.description}))}cancelWorkflow(){return __awaiter(this,void 0,void 0,(function*(){this.hideMenu();yield this.workflowFacade.cancelWorflow(this.workflowInfo);this.routingService.reload()}))}onWorkflowItemMenuOpen(e){if(this.workflowInfo.workflowCode!==e.uid){this.hideMenu();if(!this.cdr.destroyed){this.cdr.detectChanges()}}}getPermittedButtons(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.map((e=>Promise.resolve(this.permissionService.isPermitted([{names:e.permissions}]))));const o=yield Promise.all(t);return e.filter(((e,t)=>o[t]))}))}};ti.$inject=["systemEventService","workflowFacade","routingService","permissionService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],ti.prototype,"workflowInfo",void 0);ti=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-workflow-item-menu",template:`<se-popup-overlay class="popup-anchor" [ngClass]="{ 'popup-anchor--open': isMenuOpen }" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><span *ngIf="menuItems.length > 0" (click)="toggleMenu()" class="workflow-item-menu__toggle-btn sap-icon--overflow"></span><div se-popup-overlay-body><div class="workflow-item-menu"><div class="workflow-item-menu__item" *ngFor="let dropdownItem of menuItems"><ng-container class="container" [ngSwitch]="dropdownItem.i18nKey"><div *ngSwitchCase="'se.cms.actionitem.page.workflow.description'" class="workflow-description"><div class="se-dropdown-item--label"><div class="workflow-description__label fd-has-type-1 fd-has-margin-bottom-tiny"><div [translate]="dropdownItem.i18nKey"></div><div *seHasOperationPermission="'se.edit.workflow.workflowMenu'"><a title="Edit" class="workflow-description__edit-btn sap-icon--edit fd-has-float-right" (click)="editDescription()"></a></div></div><div *ngIf="workflowInfo.description; else noDescription" class="workflow-description__text">{{ workflowInfo.description }}</div><ng-template #noDescription><div translate="se.cms.actionitem.page.workflow.no.description"></div></ng-template></div></div><div *ngSwitchCase="'se.cms.actionitem.page.workflow.cancel'" class="workflow-cancel-btn fd-has-color-status-3" [translate]="dropdownItem.i18nKey" (click)="cancelWorkflow()"></div></ng-container></div></div></div></se-popup-overlay>`,styles:[`.popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400;padding-top:5px;width:32px;height:32px;border-radius:4px}.popup-anchor--open{background-color:#eeeeef}.workflow-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.workflow-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.workflow-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.workflow-item-menu::after,.workflow-item-menu::before{right:10px}.workflow-item-menu::after,.workflow-item-menu::before{display:none}.workflow-description{min-width:225px;padding:20px}.workflow-description__label{color:#32363a;display:flex;justify-content:space-between}.workflow-description__label .sap-icon--edit{cursor:pointer}.workflow-description__label .sap-icon--edit:hover{text-decoration:none}.workflow-description__text{word-break:normal;word-spacing:normal;word-wrap:break-word;white-space:normal;color:#51555a}.workflow-cancel-btn{cursor:pointer;padding:12px 20px;border-top:1px solid #fafafa}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.SystemEventService,Gt,m.SmarteditRoutingService,m.IPermissionService,s.ChangeDetectorRef])],ti);window.__smartedit__.addDecoratorPayload("Component","WorkflowActionCommentComponent",{selector:"se-workflow-action-comment",template:`<ng-container *ngIf="isDecisionComment; then decisionComment; else generalComment"></ng-container><ng-template #decisionComment><div class="se-workflow-action-comment"><div class="fd-tile"><div class="fd-tile__content"><h2 class="fd-tile__title se-workflow-action-comment__header sap-icon--workflow-tasks sap-icon--m" [class.sap-icon--flip-h]="!isIncomingDecision()">{{ actionComment.decisionName }}</h2><p class="fd-has-type-minus-1">{{ actionComment.authorName }} | {{ createdAgo }}</p><p *ngIf="!!actionComment.text"><strong>{{'se.cms.page.workflow.action.item.comment.header' | translate}}:</strong><ng-container *ngTemplateOutlet="comment"></ng-container></p></div></div></div></ng-template><ng-template #generalComment><div class="se-workflow-action-comment"><div class="fd-tile"><div class="fd-tile__content"><h2 class="fd-panel__title">{{'se.cms.page.workflow.action.item.comment.header' | translate}}</h2><p>{{ createdAgo }}</p><p class="se-workflow-action-comment__author">{{ actionComment.authorName }}</p><ng-container *ngTemplateOutlet="comment"></ng-container></div></div></div></ng-template><ng-template #comment><se-more-text class="se-workflow-action-comment__body" [ellipsis]="'...'" [text]="actionComment.text"></se-more-text></ng-template>`,styles:[`/*!\n * Fundamental Library Styles v0.4.1\n * Copyright (c) 2020 SAP SE or an SAP affiliate company.\n * Licensed under Apache License 2.0 (https://github.com/SAP/fundamental-styles/blob/master/LICENSE)\n *//*!\n.fd-button-split+()\n    .fd-button\n*/.fd-button-split{font-size:.875rem;font-size:var(--sapFontSize,.875rem);line-height:1.42857;color:#32363a;color:var(--sapTextColor,#32363a);font-family:"72","72full",Arial,Helvetica,sans-serif;font-family:var(--sapFontFamily, "72", "72full", Arial, Helvetica, sans-serif);font-weight:400;-webkit-font-smoothing:antialiased;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0;border:0;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;position:relative}.fd-button-split:after,.fd-button-split:before{-webkit-box-sizing:inherit;box-sizing:inherit;font-size:inherit}.fd-button-split :first-child{margin:0;border-top-right-radius:0;border-bottom-right-radius:0}.fd-button-split :nth-child(2){margin:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.fd-button-split[dir=rtl] :first-child,[dir=rtl] .fd-button-split :first-child{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.25rem;border-top-right-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-right-radius:.25rem;border-bottom-right-radius:var(--sapButton_BorderCornerRadius,.25rem)}.fd-button-split[dir=rtl] :nth-child(2),[dir=rtl] .fd-button-split :nth-child(2){border-top-left-radius:.25rem;border-top-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-left-radius:.25rem;border-bottom-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-top-right-radius:0;border-bottom-right-radius:0;border-left-width:.0625rem;border-left-width:var(--sapButton_BorderWidth,.0625rem);border-right-width:0}.fd-button-split [class*="--emphasized"]:first-child{margin-right:1px}.fd-button-split [class*="--emphasized"][dir=rtl]:first-child,[dir=rtl] .fd-button-split [class*="--emphasized"]:first-child{margin-right:0;margin-left:1px}.se-workflow-action-comment{margin:20px 15px 10px 45px;border-style:solid;border-width:1px;border-color:#eeeeef;border-radius:3px;position:relative}.se-workflow-action-comment::before{height:0;width:0;border-style:solid;border-width:6.5px 8px 6.5px 0;border-bottom-color:transparent;border-right-color:#eeeeef;border-top-color:transparent;content:"";position:absolute;top:14px;left:-9px}.se-workflow-action-comment::after{height:0;width:0;border-style:solid;border-width:6.5px 8px 6.5px 0;border-bottom-color:transparent;border-right-color:#fff;border-top-color:transparent;content:"";position:absolute;top:14px;left:-7px}.se-workflow-action-comment__header{position:relative;font-weight:700;font-size:13px;margin-bottom:3px!important}.se-workflow-action-comment__header:before{position:absolute;top:-8px;left:-56px;font-size:18px;background:#fff;padding:8px}.se-workflow-action-comment__header.sap-icon--flip-h::before{transform:scaleX(-1)}.se-workflow-action-comment__author{margin-bottom:25px}.se-workflow-action-comment__body{overflow-wrap:anywhere}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let ii=class WorkflowActionCommentComponent{constructor(e){this.cMSTimeService=e}ngOnInit(){this.isDecisionComment=!!this.actionComment.decisionName}get createdAgo(){if(!!this.actionComment.createdAgoInMillis){return this.cMSTimeService.getTimeAgo(this.actionComment.createdAgoInMillis)}return null}isIncomingDecision(){return!(this.actionComment.originalActionCode===this.workflowAction.code)}};ii.$inject=["cMSTimeService"];__decorate([s.Input(),__metadata("design:type",Object)],ii.prototype,"actionComment",void 0);__decorate([s.Input(),__metadata("design:type",Object)],ii.prototype,"workflowAction",void 0);ii=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-workflow-action-comment",template:`<ng-container *ngIf="isDecisionComment; then decisionComment; else generalComment"></ng-container><ng-template #decisionComment><div class="se-workflow-action-comment"><div class="fd-tile"><div class="fd-tile__content"><h2 class="fd-tile__title se-workflow-action-comment__header sap-icon--workflow-tasks sap-icon--m" [class.sap-icon--flip-h]="!isIncomingDecision()">{{ actionComment.decisionName }}</h2><p class="fd-has-type-minus-1">{{ actionComment.authorName }} | {{ createdAgo }}</p><p *ngIf="!!actionComment.text"><strong>{{'se.cms.page.workflow.action.item.comment.header' | translate}}:</strong><ng-container *ngTemplateOutlet="comment"></ng-container></p></div></div></div></ng-template><ng-template #generalComment><div class="se-workflow-action-comment"><div class="fd-tile"><div class="fd-tile__content"><h2 class="fd-panel__title">{{'se.cms.page.workflow.action.item.comment.header' | translate}}</h2><p>{{ createdAgo }}</p><p class="se-workflow-action-comment__author">{{ actionComment.authorName }}</p><ng-container *ngTemplateOutlet="comment"></ng-container></div></div></div></ng-template><ng-template #comment><se-more-text class="se-workflow-action-comment__body" [ellipsis]="'...'" [text]="actionComment.text"></se-more-text></ng-template>`,styles:[`/*!\n * Fundamental Library Styles v0.4.1\n * Copyright (c) 2020 SAP SE or an SAP affiliate company.\n * Licensed under Apache License 2.0 (https://github.com/SAP/fundamental-styles/blob/master/LICENSE)\n *//*!\n.fd-button-split+()\n    .fd-button\n*/.fd-button-split{font-size:.875rem;font-size:var(--sapFontSize,.875rem);line-height:1.42857;color:#32363a;color:var(--sapTextColor,#32363a);font-family:"72","72full",Arial,Helvetica,sans-serif;font-family:var(--sapFontFamily, "72", "72full", Arial, Helvetica, sans-serif);font-weight:400;-webkit-font-smoothing:antialiased;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0;border:0;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;position:relative}.fd-button-split:after,.fd-button-split:before{-webkit-box-sizing:inherit;box-sizing:inherit;font-size:inherit}.fd-button-split :first-child{margin:0;border-top-right-radius:0;border-bottom-right-radius:0}.fd-button-split :nth-child(2){margin:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.fd-button-split[dir=rtl] :first-child,[dir=rtl] .fd-button-split :first-child{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.25rem;border-top-right-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-right-radius:.25rem;border-bottom-right-radius:var(--sapButton_BorderCornerRadius,.25rem)}.fd-button-split[dir=rtl] :nth-child(2),[dir=rtl] .fd-button-split :nth-child(2){border-top-left-radius:.25rem;border-top-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-left-radius:.25rem;border-bottom-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-top-right-radius:0;border-bottom-right-radius:0;border-left-width:.0625rem;border-left-width:var(--sapButton_BorderWidth,.0625rem);border-right-width:0}.fd-button-split [class*="--emphasized"]:first-child{margin-right:1px}.fd-button-split [class*="--emphasized"][dir=rtl]:first-child,[dir=rtl] .fd-button-split [class*="--emphasized"]:first-child{margin-right:0;margin-left:1px}.se-workflow-action-comment{margin:20px 15px 10px 45px;border-style:solid;border-width:1px;border-color:#eeeeef;border-radius:3px;position:relative}.se-workflow-action-comment::before{height:0;width:0;border-style:solid;border-width:6.5px 8px 6.5px 0;border-bottom-color:transparent;border-right-color:#eeeeef;border-top-color:transparent;content:"";position:absolute;top:14px;left:-9px}.se-workflow-action-comment::after{height:0;width:0;border-style:solid;border-width:6.5px 8px 6.5px 0;border-bottom-color:transparent;border-right-color:#fff;border-top-color:transparent;content:"";position:absolute;top:14px;left:-7px}.se-workflow-action-comment__header{position:relative;font-weight:700;font-size:13px;margin-bottom:3px!important}.se-workflow-action-comment__header:before{position:absolute;top:-8px;left:-56px;font-size:18px;background:#fff;padding:8px}.se-workflow-action-comment__header.sap-icon--flip-h::before{transform:scaleX(-1)}.se-workflow-action-comment__author{margin-bottom:25px}.se-workflow-action-comment__body{overflow-wrap:anywhere}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[p.CMSTimeService])],ii);const oi="PageApprovalPageApproved";window.__smartedit__.addDecoratorPayload("Component","WorkflowActionItemComponent",{selector:"se-workflow-action-item",template:`<div class="se-workflow-action-item" [ngClass]="getWorkflowActionStatusClass()"><se-collapsible-container class="se-catalog-details__collapse se-collapsible-container--noshadow fd-panel" [id]="workflowAction.code" (getApi)="setCollapsibleContainerApi($event)"><se-collapsible-container-header><div class="fd-panel__header"><div class="fd-panel__head"><h1 class="fd-panel__title">{{ workflowAction.name | seL10n | async }}</h1><p class="fd-panel__description">{{ getReadableStatus() | translate }} {{ getActiveSince() }}</p></div></div><div class="fd-panel__body">{{ workflowAction.description | seL10n | async }}<div *ngIf="canShowDecisionButtons()" class="se-workflow-action-item__decision-buttons fd-dropdown"><div class="fd-popover"><div class="fd-popover__control"><div [ngClass]="{ 'fd-button-split': workflowAction.decisions.length > 1 }"><button class="se-workflow-action-item__decision-button fd-button--compact" [id]="workflowAction.code + '-decision-button'" (click)="onMainButtonClick($event, workflowAction.decisions[0])" type="button">{{ workflowAction.decisions[0].name | seL10n | async }}</button><se-popup-overlay [popupOverlay]="{\n                                        halign: 'right',\n                                        valign: 'bottom'\n                                    }" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="onMenuHide()"><button *ngIf="workflowAction.decisions.length > 1" [id]="workflowAction.code + '-decision-split-button'" class="fd-button--compact menu-button sap-icon--slim-arrow-down" (click)="onSplitButtonClick($event)"></button><div se-popup-overlay-body class="fd-popover__body fd-popover__body--right fd-popover__body--no-arrow se-workflow-action-item__decision-list"><nav class="fd-menu"><ul class="fd-menu__list"><li *ngFor="let decision of workflowAction.decisions"><a class="fd-menu__item se-workflow-action-item__decision" (click)="onMainButtonClick($event, decision)">{{ decision.name | seL10n | async }}</a></li></ul></nav></div></se-popup-overlay></div></div></div></div></div></se-collapsible-container-header><se-collapsible-container-content><div class="se-workflow-action-item__content" *ngIf="canShowComments()"><span *ngIf="!hasComments" class="se-workflow-action-item__comment-list fd-has-font-style-italic fd-has-color-text-4" [translate]="'se.cms.actionitem.page.workflow.action.no.comments.available'"></span><se-infinite-scrolling [pageSize]="pageSize" [fetchPage]="fetchPageOfComments" (itemsChange)="onCommentsLoaded($event)"><div *ngFor="let actionComment of workflowActionComments; trackBy: trackByIndex"><se-workflow-action-comment [workflowAction]="workflowAction" [actionComment]="actionComment"></se-workflow-action-comment></div></se-infinite-scrolling></div></se-collapsible-container-content></se-collapsible-container><fd-popover [isOpen]="showApprovalInfo" [closeOnOutsideClick]="false"><fd-popover-body><div class="se-workflow-approval-info">{{ approvalInfo }}</div></fd-popover-body></fd-popover></div>`,styles:[`/*!\n * Fundamental Library Styles v0.4.1\n * Copyright (c) 2020 SAP SE or an SAP affiliate company.\n * Licensed under Apache License 2.0 (https://github.com/SAP/fundamental-styles/blob/master/LICENSE)\n *//*!\n.fd-button-split+()\n    .fd-button\n*/.fd-button-split{font-size:.875rem;font-size:var(--sapFontSize,.875rem);line-height:1.42857;color:#32363a;color:var(--sapTextColor,#32363a);font-family:"72","72full",Arial,Helvetica,sans-serif;font-family:var(--sapFontFamily, "72", "72full", Arial, Helvetica, sans-serif);font-weight:400;-webkit-font-smoothing:antialiased;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0;border:0;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;position:relative}.fd-button-split:after,.fd-button-split:before{-webkit-box-sizing:inherit;box-sizing:inherit;font-size:inherit}.fd-button-split :first-child{margin:0;border-top-right-radius:0;border-bottom-right-radius:0}.fd-button-split :nth-child(2){margin:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.fd-button-split[dir=rtl] :first-child,[dir=rtl] .fd-button-split :first-child{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.25rem;border-top-right-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-right-radius:.25rem;border-bottom-right-radius:var(--sapButton_BorderCornerRadius,.25rem)}.fd-button-split[dir=rtl] :nth-child(2),[dir=rtl] .fd-button-split :nth-child(2){border-top-left-radius:.25rem;border-top-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-left-radius:.25rem;border-bottom-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-top-right-radius:0;border-bottom-right-radius:0;border-left-width:.0625rem;border-left-width:var(--sapButton_BorderWidth,.0625rem);border-right-width:0}.fd-button-split [class*="--emphasized"]:first-child{margin-right:1px}.fd-button-split [class*="--emphasized"][dir=rtl]:first-child,[dir=rtl] .fd-button-split [class*="--emphasized"]:first-child{margin-right:0;margin-left:1px}se-workflow-action-item .se-workflow-action-item{border-left:6px solid #fff;border-radius:4px 0 0 4px}se-workflow-action-item .se-workflow-action-item--started{border-left:6px solid #e9730c}se-workflow-action-item .se-workflow-action-item--completed{border-left:6px solid #0a7e3e}se-workflow-action-item .se-workflow-action-item__decision-buttons{margin:10px -30px 10px 0;text-align:right}se-workflow-action-item .se-workflow-action-item__decision-buttons .fd-button-split .menu-button{border-left:0;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:4px;border-bottom-right-radius:4px}se-workflow-action-item .se-workflow-action-item__decision-buttons .fd-button-split .menu-button:focus{box-shadow:none}se-workflow-action-item .se-workflow-action-item__content{min-height:30px}se-workflow-action-item .se-workflow-action-item__content-status{float:left;overflow:hidden}se-workflow-action-item .se-workflow-action-item__content se-infinite-scrolling .se-infinite-scrolling__container{max-height:none;overflow-y:auto;position:relative;margin-top:-20px;width:100%}se-workflow-action-item .se-workflow-action-item__content se-infinite-scrolling .se-infinite-scrolling__container::before{content:"";height:100%;border-left:1px solid #eeeeef;position:absolute;left:20px;top:40px;height:calc(100% - 120px)}se-workflow-action-item .se-workflow-action-item__comment-list{margin-left:5%;margin-top:5%;margin-bottom:5%}se-workflow-action-item .se-workflow-action-item__decision-list{min-width:160px;right:-38px;background:#fff}se-workflow-action-item .se-workflow-action-item__decision-list .fd-menu__list{text-align:left}se-workflow-action-item .se-workflow-action-item__decision:hover{text-decoration:none}se-workflow-action-item se-collapsible-container-header .fd-panel__body,se-workflow-action-item se-collapsible-container-header .fd-panel__header{border-bottom:none;padding:10px 16px;display:flex;flex-direction:column;align-items:flex-start;white-space:pre-wrap}se-workflow-action-item se-collapsible-container-header .fd-panel_body{color:#32363a;padding-top:0}se-workflow-action-item se-collapsible-container-header .fd-panel__title{margin-top:0;font-size:13px;font-weight:700}se-workflow-action-item .se-workflow-approval-info{width:320px;white-space:normal;padding:16px}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let ni=class WorkflowActionItemComponent{constructor(e,t,o,n,s,a){this.workflowFacade=e;this.cMSTimeService=t;this.systemEventService=o;this.routingService=n;this.cdr=s;this.workflowService=a;this.isMenuOpen=false;this.hasComments=true;this.pageSize=10;this.showApprovalInfo=false;this.fetchPageOfComments=(e,t,o)=>this.loadCommentsAndSetHasCommentsFlag(e,t,o)}ngOnInit(){this.unRegWorkflowMenuOpenedEvent=this.systemEventService.subscribe(Vt,((e,t)=>this.onOtherMenuOpening(e,t)))}ngOnDestroy(){this.unRegWorkflowMenuOpenedEvent()}onCommentsLoaded(e){this.workflowActionComments=e}setCollapsibleContainerApi(e){this.collapsibleContainerApi=e}getWorkflowActionStatusClass(){switch(this.workflowAction.status.toLowerCase()){case m.WorkflowActionStatus.IN_PROGRESS:return"se-workflow-action-item--started";case m.WorkflowActionStatus.COMPLETED:return"se-workflow-action-item--completed";default:return null}}getReadableStatus(){switch(this.workflowAction.status.toLowerCase()){case m.WorkflowActionStatus.IN_PROGRESS:return"se.cms.actionitem.page.workflow.action.status.started";case m.WorkflowActionStatus.PENDING:return"se.cms.actionitem.page.workflow.action.status.not.started";default:return this.workflowAction.status}}getActiveSince(){if(!!this.workflowAction.startedAgoInMillis){return this.cMSTimeService.getTimeAgo(this.workflowAction.startedAgoInMillis)}return null}canShowDecisionButtons(){return this.canMakeDecisions&&this.workflowAction.isCurrentUserParticipant&&this.workflowAction.decisions.length>0}canShowComments(){const e=this.collapsibleContainerApi&&this.collapsibleContainerApi.isExpanded();return e||this.workflowActionComments&&this.workflowActionComments.length>0}onMainButtonClick(e,t){return __awaiter(this,void 0,void 0,(function*(){e.preventDefault();e.stopPropagation();this.isMenuOpen=false;if(t.code===oi){const e=yield this.workflowService.pageHasUnavailableDependencies();if(e){this.showApprovalInfo=!this.showApprovalInfo;this.approvalInfo=yield this.workflowService.fetchPageTranslatedApprovalInfo();if(!this.cdr.destroyed){this.cdr.detectChanges()}return}}this.makeDecision(t).then((()=>{this.routingService.reload()}))}))}onSplitButtonClick(e){e.preventDefault();e.stopPropagation();this.isMenuOpen=!this.isMenuOpen;if(this.isMenuOpen){this.systemEventService.publishAsync(Vt,{code:this.workflowAction.code})}}onMenuHide(){this.isMenuOpen=false}trackByIndex(e){return e}loadCommentsAndSetHasCommentsFlag(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.loadComments(e,t,o);this.hasComments=n.pagination.totalCount>0;if(!this.cdr.destroyed){this.cdr.detectChanges()}return n}))}loadComments(e,t,o){return this.workflowFacade.getCommentsForWorkflowAction(this.workflow.workflowCode,this.workflowAction.code,{mask:e,pageSize:t,currentPage:o})}makeDecision(e){this.systemEventService.publish(zt);return this.workflowFacade.makeDecision(this.workflow.workflowCode,this.workflowAction,e)}onOtherMenuOpening(e,t){if(this.workflowAction.code!==t.code){this.isMenuOpen=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}}}};ni.$inject=["workflowFacade","cMSTimeService","systemEventService","routingService","cdr","workflowService"];__decorate([s.Input(),__metadata("design:type",Object)],ni.prototype,"workflow",void 0);__decorate([s.Input(),__metadata("design:type",Object)],ni.prototype,"workflowAction",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],ni.prototype,"canMakeDecisions",void 0);ni=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-workflow-action-item",template:`<div class="se-workflow-action-item" [ngClass]="getWorkflowActionStatusClass()"><se-collapsible-container class="se-catalog-details__collapse se-collapsible-container--noshadow fd-panel" [id]="workflowAction.code" (getApi)="setCollapsibleContainerApi($event)"><se-collapsible-container-header><div class="fd-panel__header"><div class="fd-panel__head"><h1 class="fd-panel__title">{{ workflowAction.name | seL10n | async }}</h1><p class="fd-panel__description">{{ getReadableStatus() | translate }} {{ getActiveSince() }}</p></div></div><div class="fd-panel__body">{{ workflowAction.description | seL10n | async }}<div *ngIf="canShowDecisionButtons()" class="se-workflow-action-item__decision-buttons fd-dropdown"><div class="fd-popover"><div class="fd-popover__control"><div [ngClass]="{ 'fd-button-split': workflowAction.decisions.length > 1 }"><button class="se-workflow-action-item__decision-button fd-button--compact" [id]="workflowAction.code + '-decision-button'" (click)="onMainButtonClick($event, workflowAction.decisions[0])" type="button">{{ workflowAction.decisions[0].name | seL10n | async }}</button><se-popup-overlay [popupOverlay]="{\n                                        halign: 'right',\n                                        valign: 'bottom'\n                                    }" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="onMenuHide()"><button *ngIf="workflowAction.decisions.length > 1" [id]="workflowAction.code + '-decision-split-button'" class="fd-button--compact menu-button sap-icon--slim-arrow-down" (click)="onSplitButtonClick($event)"></button><div se-popup-overlay-body class="fd-popover__body fd-popover__body--right fd-popover__body--no-arrow se-workflow-action-item__decision-list"><nav class="fd-menu"><ul class="fd-menu__list"><li *ngFor="let decision of workflowAction.decisions"><a class="fd-menu__item se-workflow-action-item__decision" (click)="onMainButtonClick($event, decision)">{{ decision.name | seL10n | async }}</a></li></ul></nav></div></se-popup-overlay></div></div></div></div></div></se-collapsible-container-header><se-collapsible-container-content><div class="se-workflow-action-item__content" *ngIf="canShowComments()"><span *ngIf="!hasComments" class="se-workflow-action-item__comment-list fd-has-font-style-italic fd-has-color-text-4" [translate]="'se.cms.actionitem.page.workflow.action.no.comments.available'"></span><se-infinite-scrolling [pageSize]="pageSize" [fetchPage]="fetchPageOfComments" (itemsChange)="onCommentsLoaded($event)"><div *ngFor="let actionComment of workflowActionComments; trackBy: trackByIndex"><se-workflow-action-comment [workflowAction]="workflowAction" [actionComment]="actionComment"></se-workflow-action-comment></div></se-infinite-scrolling></div></se-collapsible-container-content></se-collapsible-container><fd-popover [isOpen]="showApprovalInfo" [closeOnOutsideClick]="false"><fd-popover-body><div class="se-workflow-approval-info">{{ approvalInfo }}</div></fd-popover-body></fd-popover></div>`,styles:[`/*!\n * Fundamental Library Styles v0.4.1\n * Copyright (c) 2020 SAP SE or an SAP affiliate company.\n * Licensed under Apache License 2.0 (https://github.com/SAP/fundamental-styles/blob/master/LICENSE)\n *//*!\n.fd-button-split+()\n    .fd-button\n*/.fd-button-split{font-size:.875rem;font-size:var(--sapFontSize,.875rem);line-height:1.42857;color:#32363a;color:var(--sapTextColor,#32363a);font-family:"72","72full",Arial,Helvetica,sans-serif;font-family:var(--sapFontFamily, "72", "72full", Arial, Helvetica, sans-serif);font-weight:400;-webkit-font-smoothing:antialiased;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0;margin:0;border:0;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;position:relative}.fd-button-split:after,.fd-button-split:before{-webkit-box-sizing:inherit;box-sizing:inherit;font-size:inherit}.fd-button-split :first-child{margin:0;border-top-right-radius:0;border-bottom-right-radius:0}.fd-button-split :nth-child(2){margin:0;border-top-left-radius:0;border-bottom-left-radius:0;border-left-width:0}.fd-button-split[dir=rtl] :first-child,[dir=rtl] .fd-button-split :first-child{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.25rem;border-top-right-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-right-radius:.25rem;border-bottom-right-radius:var(--sapButton_BorderCornerRadius,.25rem)}.fd-button-split[dir=rtl] :nth-child(2),[dir=rtl] .fd-button-split :nth-child(2){border-top-left-radius:.25rem;border-top-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-bottom-left-radius:.25rem;border-bottom-left-radius:var(--sapButton_BorderCornerRadius,.25rem);border-top-right-radius:0;border-bottom-right-radius:0;border-left-width:.0625rem;border-left-width:var(--sapButton_BorderWidth,.0625rem);border-right-width:0}.fd-button-split [class*="--emphasized"]:first-child{margin-right:1px}.fd-button-split [class*="--emphasized"][dir=rtl]:first-child,[dir=rtl] .fd-button-split [class*="--emphasized"]:first-child{margin-right:0;margin-left:1px}se-workflow-action-item .se-workflow-action-item{border-left:6px solid #fff;border-radius:4px 0 0 4px}se-workflow-action-item .se-workflow-action-item--started{border-left:6px solid #e9730c}se-workflow-action-item .se-workflow-action-item--completed{border-left:6px solid #0a7e3e}se-workflow-action-item .se-workflow-action-item__decision-buttons{margin:10px -30px 10px 0;text-align:right}se-workflow-action-item .se-workflow-action-item__decision-buttons .fd-button-split .menu-button{border-left:0;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:4px;border-bottom-right-radius:4px}se-workflow-action-item .se-workflow-action-item__decision-buttons .fd-button-split .menu-button:focus{box-shadow:none}se-workflow-action-item .se-workflow-action-item__content{min-height:30px}se-workflow-action-item .se-workflow-action-item__content-status{float:left;overflow:hidden}se-workflow-action-item .se-workflow-action-item__content se-infinite-scrolling .se-infinite-scrolling__container{max-height:none;overflow-y:auto;position:relative;margin-top:-20px;width:100%}se-workflow-action-item .se-workflow-action-item__content se-infinite-scrolling .se-infinite-scrolling__container::before{content:"";height:100%;border-left:1px solid #eeeeef;position:absolute;left:20px;top:40px;height:calc(100% - 120px)}se-workflow-action-item .se-workflow-action-item__comment-list{margin-left:5%;margin-top:5%;margin-bottom:5%}se-workflow-action-item .se-workflow-action-item__decision-list{min-width:160px;right:-38px;background:#fff}se-workflow-action-item .se-workflow-action-item__decision-list .fd-menu__list{text-align:left}se-workflow-action-item .se-workflow-action-item__decision:hover{text-decoration:none}se-workflow-action-item se-collapsible-container-header .fd-panel__body,se-workflow-action-item se-collapsible-container-header .fd-panel__header{border-bottom:none;padding:10px 16px;display:flex;flex-direction:column;align-items:flex-start;white-space:pre-wrap}se-workflow-action-item se-collapsible-container-header .fd-panel_body{color:#32363a;padding-top:0}se-workflow-action-item se-collapsible-container-header .fd-panel__title{margin-top:0;font-size:13px;font-weight:700}se-workflow-action-item .se-workflow-approval-info{width:320px;white-space:normal;padding:16px}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[Gt,p.CMSTimeService,m.SystemEventService,m.SmarteditRoutingService,s.ChangeDetectorRef,m.WorkflowService])],ni);let si=class WorkflowModule{};si=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),f.CommonModule,S.PopoverModule,m.InfiniteScrollingModule,m.MoreTextModule,m.CollapsibleContainerModule,m.PopupOverlayModule,m.TooltipModule,m.DropdownMenuModule,m.HasOperationPermissionDirectiveModule,m.SpinnerModule,m.TabsModule,m.L10nPipeModule,m.FundamentalsModule],declarations:[Yt,Kt,ei,Jt,Xt,ii,ni,jt,$t,Mt,kt,ti,qt,Wt,Ht,Qt,Bt],entryComponents:[Yt,Kt,ei,Jt,Xt,ii,ni,jt,$t,Mt,kt,ti,qt,Wt,Ht,Qt,Bt],exports:[jt],providers:[Zt,Gt,m.moduleUtils.bootstrap(((e,t,o,n,s,a)=>{const r="PAGE_IN_WORKFLOW_NOTIFICATION_ID";e.subscribe(m.EVENTS.PAGE_CHANGE,(()=>{t.getPageUUID().then((e=>{o.getActiveWorkflowForPageUuid(e).then((e=>{if(e!==null&&!e.isAvailableForCurrentPrincipal){n.pushNotification({id:r,componentName:Bt.name})}else{n.removeNotification(r)}}))}))}));s.routeChangeSuccess().subscribe((e=>{const t=s.getCurrentUrlFromEvent(e);if(t!==`/${m.NG_ROUTE_PREFIX}${m.STORE_FRONT_CONTEXT}`){n.removeNotification(r)}}))}),[m.CrossFrameEventService,m.IPageInfoService,m.WorkflowService,m.INotificationService,m.SmarteditRoutingService,Zt])]})],si);var ai;(function(e){e["PENDING"]="PENDING";e["NO_HOMEPAGE"]="NO_HOMEPAGE";e["LOCAL"]="LOCAL";e["OLD"]="OLD";e["PARENT"]="PARENT"})(ai||(ai={}));window.__smartedit__.addDecoratorPayload("Component","NewPageDisplayConditionComponent",{selector:"se-new-page-display-condition",template:`<div *ngIf="isReady"><div class="form-group"><label for="page-condition-selector-id" class="se-control-label" translate="se.cms.page.condition.selection.label"></label><se-select id="page-condition-selector-id" [model]="conditionSelected.label" (modelChange)="onConditionChange($event)" [fetchStrategy]="conditionSelectorFetchStrategy" [onChange]="onDataChange" [searchEnabled]="false"></se-select><span class="se-form-help-message"><span [translate]="conditionSelected.description"></span></span></div><div *ngIf="showPrimarySelector()" class="form-group"><label for="page-condition-primary-selector-id" class="se-control-label" translate="se.cms.page.condition.primary.association.label"></label><se-select id="page-condition-primary-selector-id" [model]="primarySelectedModel" (modelChange)="primarySelectedModelOnChange($event)" [fetchStrategy]="primaryPageChoicesFetchStrategy" [onChange]="onDataChange"></se-select><span *ngIf="primarySelected?.label" class="se-form-help-message"><span>{{ 'se.cms.page.label.label' | translate }}: {{ primarySelected.label }}</span></span></div><div *ngIf="showHomePageWidget()"><div class="fd-form__item"><input type="checkbox" id="set-homepage-checkbox" class="se-component-item--details se-component-homepage__checkbox-input fd-form__control" name="clone-on-drop" (ngModelChange)="onHomePageChange($event)" [ngModel]="homepage"/> <label class="se-control-label se-component-homepage--label fd-form__label" for="set-homepage-checkbox" translate="se.cms.display.conditions.homepage.set"></label></div><label class="se-control-label se-component-homepage--label" for="set-homepage-checkbox" *ngIf="showReplaceLabel">{{ "se.cms.display.conditions.homepage.replace" | translate: { currentHomepage: currentHomePageName } }}</label></div></div>`,styles:[`.se-component-homepage__checkbox-input{margin:0 4px 0 0;outline:0;box-shadow:none}`],changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[m.L10nPipe]});let ri=class NewPageDisplayConditionComponent{constructor(e,t,o,n,s,a,r,d,p){this.urlService=e;this.homepageService=t;this.displayConditionsFacade=o;this.translateService=n;this.pageService=s;this.logService=a;this.pageDisplayConditions=r;this.l10n=d;this.cdr=p;this.conditions=null;this.homepage=false;this.homepageDetails={status:ai.PENDING};this.isReady=false;this.primarySelected=null;this.primarySelectedModel=null;this.showReplaceLabel=false}ngOnInit(){this.onDataChange=()=>this.dataChanged();this.conditionSelected={};this.conditionSelectorFetchStrategy={fetchAll:()=>Promise.resolve((this.conditions||[]).map((e=>({id:e.label,label:e.label}))))};this.initialConditionSelectedKey=this.initialConditionSelectedKey||"page.displaycondition.primary";this.primaryPageChoicesFetchStrategy={fetchEntity:()=>Promise.resolve({id:this.primarySelected.uid,label:this.primarySelected.name||this.primarySelected.label}),fetchPage:(e,t,o)=>this.displayConditionsFacade.getPrimaryPagesForPageType(this.pageTypeCode,this.uriContext,{search:e,pageSize:t,currentPage:o})}}ngOnChanges(e){return __awaiter(this,void 0,void 0,(function*(){const t=!!e.pageTypeCode&&e.pageTypeCode.currentValue!=e.pageTypeCode.previousValue;const o=!!e.targetCatalogVersion&&!u.isEqual(e.targetCatalogVersion.currentValue,e.targetCatalogVersion.previousValue);if(t||o){if(!this.targetCatalogVersion||this.isUriContextEqualToCatalogVersion(this.uriContext,this.targetCatalogVersion)){yield this.getSelectedPrimaryPageAndDisplayCondition()}else{this.getOnlyPrimaryDisplayCondition()}const e=this.targetCatalogVersion===undefined?this.uriContext:this.urlService.buildUriContext(this.targetCatalogVersion.siteId,this.targetCatalogVersion.catalogId,this.targetCatalogVersion.version);const t=yield this.homepageService.getHomepageDetailsForContext(e);this.homepageDetails=t;yield this.updateHomepageUiProperties()}else{yield this.updateHomepageUiProperties()}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}showPrimarySelector(){return!(this.conditionSelected&&this.conditionSelected.isPrimary)}onConditionChange(e){this.conditionSelected=this.conditions.find((t=>t.label===e))}onHomePageChange(e){this.homepage=e;this.dataChanged()}showHomePageWidget(){return this.isPrimaryContentPage()}primarySelectedModelOnChange(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageService.getPageById(e);this.setPrimarySelected(t);this.dataChanged()}))}dataChanged(){if(!this.isPrimaryContentPage()){this.homepage=undefined}this.updateHomepageUiProperties();if(this.resultFn){this.resultFn(this.getResults())}}isPrimaryContentPage(){var e;return((e=this.conditionSelected)===null||e===void 0?void 0:e.isPrimary)&&this.pageTypeCode==="ContentPage"}updateHomepageUiProperties(){return __awaiter(this,void 0,void 0,(function*(){if(this.homepage){switch(this.homepageDetails.status){case ai.NO_HOMEPAGE:this.homepageService.sendEventHideReplaceParentHomePageInfo();this.showReplaceLabel=false;break;case ai.PARENT:const[e,t]=yield this.getTranslatedNames(this.homepageDetails.parentCatalogName,this.homepageDetails.targetCatalogName);this.homepageService.sendEventShowReplaceParentHomePageInfo({description:this.translateService.instant("se.cms.display.conditions.homepage.replace.parent.info.header",{parentCatalogName:e,parentCatalogVersion:this.homepageDetails.parentCatalogVersion,targetCatalogName:t,targetCatalogVersion:this.homepageDetails.targetCatalogVersion})});this.showReplaceLabel=false;break;case ai.LOCAL:this.homepageService.sendEventHideReplaceParentHomePageInfo();this.currentHomePageName=this.homepageDetails.currentHomepageName;this.showReplaceLabel=true;break}}else{this.homepageService.sendEventHideReplaceParentHomePageInfo();this.showReplaceLabel=false}}))}getTranslatedNames(e,t){return Promise.all([this.l10n.transform(e).pipe(g.take(1)).toPromise(),this.l10n.transform(t).pipe(g.take(1)).toPromise()])}getResults(){const e={homepage:this.homepage,isPrimary:this.conditionSelected&&this.conditionSelected.isPrimary,primaryPage:null};if(this.conditionSelected&&!this.conditionSelected.isPrimary){e.primaryPage=this.primarySelected}return e}getSelectedPrimaryPageAndDisplayCondition(){return __awaiter(this,void 0,void 0,(function*(){if(this.pageTypeCode){try{if(this.pageUuid){const e=yield this.pageService.getPageByUuid(this.pageUuid);const t=yield!e.defaultPage?this.pageService.getPrimaryPage(e.uid):e;this.setPrimarySelected(t)}}catch(e){this.logService.error(e)}finally{this.getAllPrimaryDisplayCondition()}}else{this.getAllPrimaryDisplayCondition()}}))}getAllPrimaryDisplayCondition(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.pageDisplayConditions.getNewPageConditions(this.pageTypeCode,this.uriContext);if(!e.length){return}this.conditions=e;this.conditionSelected=this.conditions[0];if(this.conditions.length>1){this.conditionSelected=this.conditions.find((e=>e.label===this.initialConditionSelectedKey))}this.isReady=true}catch(e){this.logService.error(e)}finally{if(this.targetCatalogVersion&&!this.isUriContextEqualToCatalogVersion(this.uriContext,this.targetCatalogVersion)){this.getOnlyPrimaryDisplayCondition()}else{this.dataChanged()}}}))}getOnlyPrimaryDisplayCondition(){this.conditions=[{description:"page.displaycondition.primary.description",isPrimary:true,label:"page.displaycondition.primary"}];this.conditionSelected=this.conditions[0];this.isReady=true;this.dataChanged()}isUriContextEqualToCatalogVersion(e,t){return e&&t&&t.siteId===e.CURRENT_CONTEXT_SITE_ID&&t.catalogId===e.CURRENT_CONTEXT_CATALOG&&t.version===e.CURRENT_CONTEXT_CATALOG_VERSION}setPrimarySelected(e){this.primarySelected=e;this.primarySelectedModel=e.uid}};ri.$inject=["urlService","homepageService","displayConditionsFacade","translateService","pageService","logService","pageDisplayConditions","l10n","cdr"];__decorate([s.Input(),__metadata("design:type",String)],ri.prototype,"pageTypeCode",void 0);__decorate([s.Input(),__metadata("design:type",Object)],ri.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Function)],ri.prototype,"resultFn",void 0);__decorate([s.Input(),__metadata("design:type",String)],ri.prototype,"pageUuid",void 0);__decorate([s.Input(),__metadata("design:type",String)],ri.prototype,"initialConditionSelectedKey",void 0);__decorate([s.Input(),__metadata("design:type",Object)],ri.prototype,"targetCatalogVersion",void 0);ri=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-new-page-display-condition",template:`<div *ngIf="isReady"><div class="form-group"><label for="page-condition-selector-id" class="se-control-label" translate="se.cms.page.condition.selection.label"></label><se-select id="page-condition-selector-id" [model]="conditionSelected.label" (modelChange)="onConditionChange($event)" [fetchStrategy]="conditionSelectorFetchStrategy" [onChange]="onDataChange" [searchEnabled]="false"></se-select><span class="se-form-help-message"><span [translate]="conditionSelected.description"></span></span></div><div *ngIf="showPrimarySelector()" class="form-group"><label for="page-condition-primary-selector-id" class="se-control-label" translate="se.cms.page.condition.primary.association.label"></label><se-select id="page-condition-primary-selector-id" [model]="primarySelectedModel" (modelChange)="primarySelectedModelOnChange($event)" [fetchStrategy]="primaryPageChoicesFetchStrategy" [onChange]="onDataChange"></se-select><span *ngIf="primarySelected?.label" class="se-form-help-message"><span>{{ 'se.cms.page.label.label' | translate }}: {{ primarySelected.label }}</span></span></div><div *ngIf="showHomePageWidget()"><div class="fd-form__item"><input type="checkbox" id="set-homepage-checkbox" class="se-component-item--details se-component-homepage__checkbox-input fd-form__control" name="clone-on-drop" (ngModelChange)="onHomePageChange($event)" [ngModel]="homepage"/> <label class="se-control-label se-component-homepage--label fd-form__label" for="set-homepage-checkbox" translate="se.cms.display.conditions.homepage.set"></label></div><label class="se-control-label se-component-homepage--label" for="set-homepage-checkbox" *ngIf="showReplaceLabel">{{ "se.cms.display.conditions.homepage.replace" | translate: { currentHomepage: currentHomePageName } }}</label></div></div>`,styles:[`.se-component-homepage__checkbox-input{margin:0 4px 0 0;outline:0;box-shadow:none}`],changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[m.L10nPipe]}),__metadata("design:paramtypes",[m.IUrlService,t.HomepageService,De,v.TranslateService,m.IPageService,m.LogService,t.PageDisplayConditionsService,m.L10nPipe,s.ChangeDetectorRef])],ri);window.__smartedit__.addDecoratorPayload("Component","SelectPageTemplateComponent",{selector:"se-select-page-template",template:`<div class="se-page-type-step-template"><div class="se-add-page__sub-header"><div class="se-add-page__sub-header-title">{{ 'se.cms.addpagewizard.pagetemplate.description' | translate }}</div><div class="se-input-group se-page-type-step-template-list-search"><input type="text" class="se-input-group__input-area ySEPage-list-search-input" placeholder="{{ 'se.cms.pagewizard.templatestep.searchplaceholder' | translate }}" [ngModel]="searchString" (ngModelChange)="onSearchChange($event)" name="query"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="searchString" class="se-input-group__addon se-input-group__clear-btn" (click)="clearSearch()"><span class="sap-icon--decline"></span></div></div></div><div class="se-add-page__list fd-menu" *ngIf="pageTemplates.length > 0"><div *ngFor="let template of filteredPageTemplates" [ngClass]="{ 'is-selected': isSelected(template)}" (click)="templateSelected(template)" class="se-add-page__item se-add-page__item--page-template fd-menu__item"><div class="se-add-page__item-title">{{ template.name }}</div></div></div></div>`,styles:[`.se-add-page__sub-header{padding-bottom:16px;color:#51555a}.se-add-page__sub-header-title{margin-bottom:8px}.se-add-page__list.fd-menu{border-top:1px solid #d9d9d9;padding:0}.se-add-page__item{cursor:pointer}.se-add-page__item--page-template{height:48px;display:flex;flex-direction:row;align-items:center}.se-add-page__item-title{font-weight:700}.se-add-page__item-description{white-space:normal}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let li=class SelectPageTemplateComponent{constructor(e,t){this.pageTemplateService=e;this.cdr=t;this.searchString="";this.onTemplateSelected=new s.EventEmitter;this.cache={};this.pageTemplates=[]}ngOnChanges(e){var t;return __awaiter(this,void 0,void 0,(function*(){if((t=e.pageTypeCode)===null||t===void 0?void 0:t.currentValue){yield this.onInputUpdated();this.setDefaultFilteredPageTemplates();if(!this.cdr.destroyed){this.cdr.detectChanges()}}}))}templateSelected(e){this.selectedTemplate=e;this.onTemplateSelected.emit(e)}isSelected(e){var t;return e.uid===((t=this.selectedTemplate)===null||t===void 0?void 0:t.uid)}clearSearch(){this.searchString="";this.setDefaultFilteredPageTemplates()}onSearchChange(e){this.searchString=e;this.filterByQuery(this.searchString)}onInputUpdated(){return __awaiter(this,void 0,void 0,(function*(){this.clearSearch();this.selectedTemplate=null;return this.setPageTemplates()}))}setPageTemplates(){return __awaiter(this,void 0,void 0,(function*(){if(this.cache[this.pageTypeCode]){this.pageTemplates=this.cache[this.pageTypeCode];return}this.pageTemplates=[];const e=yield this.pageTemplateService.getPageTemplatesForType(this.uriContext,this.pageTypeCode);this.cache[this.pageTypeCode]=e.templates;this.pageTemplates=this.cache[this.pageTypeCode]}))}filterByQuery(e){if(!e){this.setDefaultFilteredPageTemplates();return}this.filteredPageTemplates=this.pageTemplates.filter((t=>{const o=e.split(" ");return o.every((e=>t.name.toLowerCase().includes(e.toLowerCase())))}))}setDefaultFilteredPageTemplates(){this.filteredPageTemplates=[...this.pageTemplates]}};li.$inject=["pageTemplateService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],li.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",String)],li.prototype,"pageTypeCode",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],li.prototype,"onTemplateSelected",void 0);li=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-select-page-template",template:`<div class="se-page-type-step-template"><div class="se-add-page__sub-header"><div class="se-add-page__sub-header-title">{{ 'se.cms.addpagewizard.pagetemplate.description' | translate }}</div><div class="se-input-group se-page-type-step-template-list-search"><input type="text" class="se-input-group__input-area ySEPage-list-search-input" placeholder="{{ 'se.cms.pagewizard.templatestep.searchplaceholder' | translate }}" [ngModel]="searchString" (ngModelChange)="onSearchChange($event)" name="query"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="searchString" class="se-input-group__addon se-input-group__clear-btn" (click)="clearSearch()"><span class="sap-icon--decline"></span></div></div></div><div class="se-add-page__list fd-menu" *ngIf="pageTemplates.length > 0"><div *ngFor="let template of filteredPageTemplates" [ngClass]="{ 'is-selected': isSelected(template)}" (click)="templateSelected(template)" class="se-add-page__item se-add-page__item--page-template fd-menu__item"><div class="se-add-page__item-title">{{ template.name }}</div></div></div></div>`,styles:[`.se-add-page__sub-header{padding-bottom:16px;color:#51555a}.se-add-page__sub-header-title{margin-bottom:8px}.se-add-page__list.fd-menu{border-top:1px solid #d9d9d9;padding:0}.se-add-page__item{cursor:pointer}.se-add-page__item--page-template{height:48px;display:flex;flex-direction:row;align-items:center}.se-add-page__item-title{font-weight:700}.se-add-page__item-description{white-space:normal}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[t.PageTemplateService,s.ChangeDetectorRef])],li);window.__smartedit__.addDecoratorPayload("Component","SelectPageTypeComponent",{selector:"se-select-page-type",template:`<div><div class="se-add-page__sub-header">{{ 'se.cms.addpagewizard.pagetype.description' | translate }}</div><div class="se-add-page__list fd-menu" *ngIf="pageTypes.length > 0"><div class="se-add-page__item fd-menu__item" *ngFor="let pageType of pageTypes" [ngClass]="{ 'is-selected': isSelected(pageType)}" (click)="selectType(pageType)"><div class="se-add-page__item-title">{{ pageType.name | seL10n | async }}</div><div class="se-add-page__item-description">{{ pageType.description | seL10n | async }}</div></div></div></div>`,styles:[`.se-add-page__sub-header{padding-bottom:16px;color:#51555a}.se-add-page__sub-header-title{margin-bottom:8px}.se-add-page__list.fd-menu{border-top:1px solid #d9d9d9;padding:0}.se-add-page__item{cursor:pointer}.se-add-page__item--page-template{height:48px;display:flex;flex-direction:row;align-items:center}.se-add-page__item-title{font-weight:700}.se-add-page__item-description{white-space:normal}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let ci=class SelectPageTypeComponent{constructor(e,t,o){this.pageTypeService=e;this.typePermissionsRestService=t;this.cdr=o;this.onTypeSelected=new s.EventEmitter;this.pageTypes=[]}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield this.loadPageTypes();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}selectType(e){this.onTypeSelected.emit(e)}isSelected(e){return e.code===this.pageTypeCode}loadPageTypes(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageTypeService.getPageTypes();const t=e.map((e=>e.code));const o=yield this.typePermissionsRestService.hasCreatePermissionForTypes(t);this.pageTypes=e.filter((e=>o[e.code]))}))}};ci.$inject=["pageTypeService","typePermissionsRestService","cdr"];__decorate([s.Input(),__metadata("design:type",String)],ci.prototype,"pageTypeCode",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],ci.prototype,"onTypeSelected",void 0);ci=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-select-page-type",template:`<div><div class="se-add-page__sub-header">{{ 'se.cms.addpagewizard.pagetype.description' | translate }}</div><div class="se-add-page__list fd-menu" *ngIf="pageTypes.length > 0"><div class="se-add-page__item fd-menu__item" *ngFor="let pageType of pageTypes" [ngClass]="{ 'is-selected': isSelected(pageType)}" (click)="selectType(pageType)"><div class="se-add-page__item-title">{{ pageType.name | seL10n | async }}</div><div class="se-add-page__item-description">{{ pageType.description | seL10n | async }}</div></div></div></div>`,styles:[`.se-add-page__sub-header{padding-bottom:16px;color:#51555a}.se-add-page__sub-header-title{margin-bottom:8px}.se-add-page__list.fd-menu{border-top:1px solid #d9d9d9;padding:0}.se-add-page__item{cursor:pointer}.se-add-page__item--page-template{height:48px;display:flex;flex-direction:row;align-items:center}.se-add-page__item-title{font-weight:700}.se-add-page__item-description{white-space:normal}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[Te,p.TypePermissionsRestService,s.ChangeDetectorRef])],ci);window.__smartedit__.addDecoratorPayload("Component","SelectTargetCatalogVersionComponent",{selector:"se-select-target-catalog-version",template:`<div class="target-catalog-version-selector-wrapper form-group"><label for="se-catalog-version-selector-dropdown" class="se-control-label" translate="se.cms.clonepagewizard.options.targetcatalogversion.label"></label><se-select *ngIf="!!catalogVersions.length" id="se-catalog-version-selector-dropdown" [(model)]="selectedCatalogVersion" [fetchStrategy]="catalogVersionSelectorFetchStrategy" [onChange]="onSelectionChange" [searchEnabled]="false" (getApi)="setSelectApi($event)"></se-select><div *ngIf="catalogVersionContainsPageWithSameLabel"><span class="help-block" translate="se.cms.clonepagewizard.options.targetcatalogversion.label.exists.message"></span></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let di=class SelectTargetCatalogVersionComponent{constructor(e,t,o,n,a){this.pageFacade=e;this.catalogVersionRestService=t;this.catalogService=o;this.pageService=n;this.cdr=a;this.catalogVersions=[];this.selectedCatalogVersion=null;this.catalogVersionContainsPageWithSameLabel=false;this.onTargetCatalogVersionSelected=new s.EventEmitter}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.catalogVersionSelectorFetchStrategy={fetchAll:()=>Promise.resolve((this.catalogVersions||[]).map((e=>({id:e.uuid,label:e.name}))))};this.onSelectionChange=()=>this.selectionChangeHandler();yield this.setupCatalogVersions();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}setSelectApi(e){this.selectApi=e}setupCatalogVersions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogVersionRestService.getCloneableTargets(this.uriContext);const t=e.versions;if(!u.isEmpty(t)){const e=yield this.catalogService.getCatalogVersionUUid(this.uriContext);const o=t.find((t=>t.uuid===e));if(o){this.selectedCatalogVersion=o.uuid}else{this.selectedCatalogVersion=t[0].uuid}this.catalogVersions=t}}))}selectionChangeHandler(){return __awaiter(this,void 0,void 0,(function*(){if(!this.selectedCatalogVersion){return}const e=yield this.catalogService.getCatalogVersionByUuid(this.selectedCatalogVersion);this.onTargetCatalogVersionSelected.emit(e);if(this.pageTypeCode==="ContentPage"){this.catalogVersionContainsPageWithSameLabel=yield this.determineContentPageWithLabelExists(e)}if(!this.cdr.destroyed){this.cdr.detectChanges()}this.updateSelectValidationState()}))}determineContentPageWithLabelExists(e){return this.pageFacade.contentPageWithLabelExists(this.pageLabel,e.catalogId,e.version)}updateSelectValidationState(){if(!this.selectApi){return}if(this.catalogVersionContainsPageWithSameLabel){this.selectApi.setValidationState(m.VALIDATION_MESSAGE_TYPES.WARNING)}else{this.selectApi.resetValidationState()}}};di.$inject=["pageFacade","catalogVersionRestService","catalogService","pageService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],di.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",String)],di.prototype,"pageTypeCode",void 0);__decorate([s.Input(),__metadata("design:type",String)],di.prototype,"pageLabel",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],di.prototype,"onTargetCatalogVersionSelected",void 0);di=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-select-target-catalog-version",template:`<div class="target-catalog-version-selector-wrapper form-group"><label for="se-catalog-version-selector-dropdown" class="se-control-label" translate="se.cms.clonepagewizard.options.targetcatalogversion.label"></label><se-select *ngIf="!!catalogVersions.length" id="se-catalog-version-selector-dropdown" [(model)]="selectedCatalogVersion" [fetchStrategy]="catalogVersionSelectorFetchStrategy" [onChange]="onSelectionChange" [searchEnabled]="false" (getApi)="setSelectApi($event)"></se-select><div *ngIf="catalogVersionContainsPageWithSameLabel"><span class="help-block" translate="se.cms.clonepagewizard.options.targetcatalogversion.label.exists.message"></span></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[Be,ye,m.ICatalogService,m.IPageService,s.ChangeDetectorRef])],di);class ClonePageBuilder{constructor(e,t,o,n,s,a,r,d){this.restrictionsStepHandler=e;this.basePageUUID=t;this.uriContext=o;this.contextAwarePageStructureService=n;this.typeStructureRestService=s;this.cmsitemsRestService=a;this.catalogService=r;this.pageInfoService=d;this.basePage={};this.pageData={};this.pageInfoStructure={};this.basePageInfoAvailable=false;this.componentCloneOption=""}getPageTypeCode(){return this.pageData.typeCode}getPageTemplate(){return this.pageData.template}getPageLabel(){return this.pageData.label}getBasePageUuid(){return this.basePage.uuid}getPageInfo(){return this.pageData}getBasePageInfo(){return this.basePage}getPageProperties(){return{type:this.pageData.type,typeCode:this.pageData.typeCode,template:this.pageData.template,onlyOneRestrictionMustApply:this.pageData.onlyOneRestrictionMustApply,catalogVersion:this.pageData.catalogVersion}}getPageInfoStructure(){return this.pageInfoStructure}getPageRestrictions(){return this.pageData.restrictions||[]}getComponentCloneOption(){return this.componentCloneOption}displayConditionSelected(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.isPrimary;this.pageData.defaultPage=t;this.pageData.homepage=e.homepage;if(t){this.pageData.label=this.basePage.label;if(this.pageData.restrictions){delete this.pageData.restrictions}this.restrictionsStepHandler.hideStep()}else{this.pageData.label=e.primaryPage?e.primaryPage.label:"";this.restrictionsStepHandler.showStep()}this.pageData.uid="";yield this.updatePageInfoFields()}))}onTargetCatalogVersionSelected(e){this.targetCatalogVersion=e;this.pageData.catalogVersion=e.uuid}componentCloneOptionSelected(e){this.componentCloneOption=e}restrictionsSelected(e,t){this.pageData.onlyOneRestrictionMustApply=e;this.pageData.restrictions=t}getTargetCatalogVersion(){return this.targetCatalogVersion}isBasePageInfoAvailable(){return this.basePageInfoAvailable}init(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getPageUUID(this.basePageUUID);const t=yield this.catalogService.getCatalogVersionUUid(this.uriContext);const o=yield this.cmsitemsRestService.getById(e);this.basePage=u.cloneDeep(o);this.pageData=u.cloneDeep(this.basePage);this.pageData.catalogVersion=t;this.pageData.pageUuid=this.basePage.uuid;delete this.pageData.uuid;this.basePageInfoAvailable=true;this.pageData.template=this.basePage.masterTemplateId;const n=yield this.typeStructureRestService.getStructureByTypeAndMode(this.pageData.typeCode,"DEFAULT",true);this.pageData.type=n.type}))}getPageUUID(e){return __awaiter(this,void 0,void 0,(function*(){return!m.stringUtils.isBlank(e)?e:this.pageInfoService.getPageUUID()}))}updatePageInfoFields(){return __awaiter(this,void 0,void 0,(function*(){if(typeof this.pageData.defaultPage==="undefined"){return}if(this.pageData.typeCode){const e=yield this.contextAwarePageStructureService.getPageStructureForNewPage(this.pageData.typeCode,this.pageData.defaultPage);this.pageInfoStructure=e}else{this.pageInfoStructure={}}}))}}let pi=class ClonePageBuilderFactory{constructor(e,t,o,n,s,a){this.contextAwarePageStructureService=e;this.typeStructureRestService=t;this.cmsitemsRestService=o;this.catalogService=n;this.pageInfoService=s;this.pageService=a}createClonePageBuilder(e,t,o){return new ClonePageBuilder(e,t,o,this.contextAwarePageStructureService,this.typeStructureRestService,this.cmsitemsRestService,this.catalogService,this.pageInfoService)}};pi.$inject=["contextAwarePageStructureService","typeStructureRestService","cmsitemsRestService","catalogService","pageInfoService","pageService"];pi=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.ContextAwarePageStructureService,xe,m.CmsitemsRestService,m.ICatalogService,m.IPageInfoService,m.IPageService])],pi);window.__smartedit__.addDecoratorPayload("Component","ClonePageOptionsStepComponent",{selector:"se-clone-page-options-step",template:`\n        <se-event-message\n            class="existing-homepage__ymessage"\n            [showEvent]="'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO'"\n            [hideEvent]="'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO'"\n        >\n        </se-event-message>\n\n        <se-select-target-catalog-version\n            *ngIf="wizardApi.isBasePageInfoAvailable()"\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [pageLabel]="wizardApi.getPageLabel()"\n            [uriContext]="wizardApi.uriContext"\n            (onTargetCatalogVersionSelected)="wizardApi.onTargetCatalogVersionSelected($event)"\n        >\n        </se-select-target-catalog-version>\n        <se-new-page-display-condition\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [uriContext]="wizardApi.uriContext"\n            [resultFn]="wizardApi.variationResult"\n            [initialConditionSelectedKey]="'page.displaycondition.variation'"\n            [pageUuid]="wizardApi.getBasePageUuid()"\n            [targetCatalogVersion]="wizardApi.getTargetCatalogVersion()"\n        >\n        </se-new-page-display-condition>\n\n        <se-component-clone-option-form\n            (onSelectionChange)="wizardApi.triggerUpdateCloneOptionResult($event)"\n        ></se-component-clone-option-form>\n    `});let mi=class ClonePageOptionsStepComponent{constructor(e){this.wizardApi=e}};mi.$inject=["wizardApi"];mi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-clone-page-options-step",template:`\n        <se-event-message\n            class="existing-homepage__ymessage"\n            [showEvent]="'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO'"\n            [hideEvent]="'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO'"\n        >\n        </se-event-message>\n\n        <se-select-target-catalog-version\n            *ngIf="wizardApi.isBasePageInfoAvailable()"\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [pageLabel]="wizardApi.getPageLabel()"\n            [uriContext]="wizardApi.uriContext"\n            (onTargetCatalogVersionSelected)="wizardApi.onTargetCatalogVersionSelected($event)"\n        >\n        </se-select-target-catalog-version>\n        <se-new-page-display-condition\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [uriContext]="wizardApi.uriContext"\n            [resultFn]="wizardApi.variationResult"\n            [initialConditionSelectedKey]="'page.displaycondition.variation'"\n            [pageUuid]="wizardApi.getBasePageUuid()"\n            [targetCatalogVersion]="wizardApi.getTargetCatalogVersion()"\n        >\n        </se-new-page-display-condition>\n\n        <se-component-clone-option-form\n            (onSelectionChange)="wizardApi.triggerUpdateCloneOptionResult($event)"\n        ></se-component-clone-option-form>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],mi);window.__smartedit__.addDecoratorPayload("Component","ClonePageRestrictionsStepComponent",{selector:"se-clone-page-options-step",template:`\n        <span *ngIf="wizardApi.isRestrictionsActive()" class="se-clone-page-restriction-step">\n            <div *ngIf="wizardApi.getPageRestrictions().length > 1">\n                <se-page-restrictions-info-message></se-page-restrictions-info-message>\n            </div>\n\n            <se-restrictions-editor\n                [editable]="true"\n                [(resetFn)]="wizardApi.restrictionsEditorFunctionBindings.reset"\n                [(cancelFn)]="wizardApi.restrictionsEditorFunctionBindings.cancel"\n                [(isDirtyFn)]="wizardApi.restrictionsEditorFunctionBindings.isDirty"\n                (onRestrictionsChange)="wizardApi.restrictionsResult($event)"\n                [getRestrictionTypes]="wizardApi.getRestrictionTypes"\n                [getSupportedRestrictionTypes]="wizardApi.getSupportedRestrictionTypes"\n                [item]="wizardApi.getBasePageInfo()"\n                [restrictionUuids]="wizardApi.getPageRestrictions()"\n            >\n            </se-restrictions-editor>\n        </span>\n    `});let gi=class ClonePageRestrictionsStepComponent{constructor(e){this.wizardApi=e}};gi.$inject=["wizardApi"];gi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-clone-page-options-step",template:`\n        <span *ngIf="wizardApi.isRestrictionsActive()" class="se-clone-page-restriction-step">\n            <div *ngIf="wizardApi.getPageRestrictions().length > 1">\n                <se-page-restrictions-info-message></se-page-restrictions-info-message>\n            </div>\n\n            <se-restrictions-editor\n                [editable]="true"\n                [(resetFn)]="wizardApi.restrictionsEditorFunctionBindings.reset"\n                [(cancelFn)]="wizardApi.restrictionsEditorFunctionBindings.cancel"\n                [(isDirtyFn)]="wizardApi.restrictionsEditorFunctionBindings.isDirty"\n                (onRestrictionsChange)="wizardApi.restrictionsResult($event)"\n                [getRestrictionTypes]="wizardApi.getRestrictionTypes"\n                [getSupportedRestrictionTypes]="wizardApi.getSupportedRestrictionTypes"\n                [item]="wizardApi.getBasePageInfo()"\n                [restrictionUuids]="wizardApi.getPageRestrictions()"\n            >\n            </se-restrictions-editor>\n        </span>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],gi);window.__smartedit__.addDecoratorPayload("Component","ClonePageInfoStepComponent",{selector:"se-clone-page-info-step",template:`\n        <se-component-clone-info-form\n            *ngIf="wizardApi.isPageInfoActive()"\n            [structure]="wizardApi.getPageInfoStructure()"\n            [content]="wizardApi.getPageInfo()"\n            [(submit)]="wizardApi.callbacks.savePageInfo"\n            [(reset)]="wizardApi.callbacks.resetPageInfo"\n            [(isDirty)]="wizardApi.callbacks.isDirtyPageInfo"\n            [(isValid)]="wizardApi.callbacks.isValidPageInfo"\n            [pageTemplate]="wizardApi.getPageTemplate()"\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [uriContext]="wizardApi.uriContext"\n            [targetCatalogVersion]="wizardApi.getTargetCatalogVersion()"\n        >\n        </se-component-clone-info-form>\n    `});let ui=class ClonePageInfoStepComponent{constructor(e){this.wizardApi=e}};ui.$inject=["wizardApi"];ui=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-clone-page-info-step",template:`\n        <se-component-clone-info-form\n            *ngIf="wizardApi.isPageInfoActive()"\n            [structure]="wizardApi.getPageInfoStructure()"\n            [content]="wizardApi.getPageInfo()"\n            [(submit)]="wizardApi.callbacks.savePageInfo"\n            [(reset)]="wizardApi.callbacks.resetPageInfo"\n            [(isDirty)]="wizardApi.callbacks.isDirtyPageInfo"\n            [(isValid)]="wizardApi.callbacks.isValidPageInfo"\n            [pageTemplate]="wizardApi.getPageTemplate()"\n            [pageTypeCode]="wizardApi.getPageTypeCode()"\n            [uriContext]="wizardApi.uriContext"\n            [targetCatalogVersion]="wizardApi.getTargetCatalogVersion()"\n        >\n        </se-component-clone-info-form>\n    `}),__param(0,s.Inject(m.WIZARD_API)),__metadata("design:paramtypes",[Object])],ui);window.__smartedit__.addDecoratorPayload("Component","ClonePageWizardComponent",{selector:"se-clone-page-wizard",template:""});let hi=class ClonePageWizardComponent{constructor(e,t,o,n,s,a,r,d,p,m,g,u,v){this.wizardManager=e;this.clonePageBuilderFactory=t;this.restrictionsStepHandlerFactory=o;this.experienceService=n;this.confirmationModalService=s;this.systemEventService=a;this.restrictionTypesService=r;this.restrictionsService=d;this.sharedDataService=p;this.clonePageAlertService=m;this.alertService=g;this.pageFacade=u;this.syncPollingService=v;this.getWizardConfig=()=>({isFormValid:e=>this.isFormValid(e),onNext:()=>this.onNext(),onDone:()=>this.onDone(),onCancel:()=>this.onCancel(),steps:[{id:this.CLONE_PAGE_WIZARD_STEPS.PAGE_CLONE_OPTIONS,name:"se.cms.clonepagewizard.pagecloneoptions.tabname",title:"se.cms.clonepagewizard.pageclone.title",component:mi},{id:this.CLONE_PAGE_WIZARD_STEPS.PAGE_INFO,name:"se.cms.clonepagewizard.pageinfo.tabname",title:"se.cms.clonepagewizard.pageclone.title",component:ui}]});this.getRestrictionTypes=()=>this.restrictionTypesService.getRestrictionTypesByPageType(this.getPageTypeCode());this.getSupportedRestrictionTypes=()=>this.restrictionsService.getSupportedRestrictionTypeCodes();this.variationResult=e=>{this.infoChanged=true;this.pageBuilder.displayConditionSelected(e)};this.basePageUUID=this.wizardManager.properties.basePageUUID;this.callbacks={};this.uriContext=this.wizardManager.properties.uriContext;this.restrictionStepProperties={id:"restrictionsStepId",name:"se.cms.restrictions.editor.tab",title:"se.cms.clonepagewizard.pageclone.title",component:gi};const f={};this.restrictionsEditorFunctionBindings=f;this.cloneInProgress=false;this.infoChanged=true;this.typeChanged=true;this.restrictionsStepHandler=this.restrictionsStepHandlerFactory.createRestrictionsStepHandler(this.wizardManager,this.restrictionsEditorFunctionBindings,this.restrictionStepProperties);this.pageBuilder=this.clonePageBuilderFactory.createClonePageBuilder(this.restrictionsStepHandler,this.basePageUUID,this.uriContext);this.pageBuilder.init();this.CLONE_PAGE_WIZARD_STEPS={PAGE_CLONE_OPTIONS:"cloneOptions",PAGE_INFO:"pageInfo",PAGE_RESTRICTIONS:this.restrictionStepProperties.id}}getPageTypeCode(){return this.pageBuilder.getPageTypeCode()}getPageLabel(){return this.pageBuilder.getPageLabel()}getBasePageUuid(){return this.pageBuilder.getBasePageUuid()}getPageTemplate(){return this.pageBuilder.getPageTemplate()}getPageInfo(){const e=this.pageBuilder.getPageInfo();e.uriContext=this.uriContext;return e}getBasePageInfo(){const e=this.pageBuilder.getBasePageInfo();e.uriContext=this.uriContext;return e}getPageRestrictions(){return this.pageBuilder.getPageRestrictions()}onTargetCatalogVersionSelected(e){this.pageBuilder.onTargetCatalogVersionSelected(e)}triggerUpdateCloneOptionResult(e){this.pageBuilder.componentCloneOptionSelected(e)}getPageInfoStructure(){return this.pageBuilder.getPageInfoStructure()}restrictionsResult(e){this.pageBuilder.restrictionsSelected(e.onlyOneRestrictionMustApply,e.restrictionUuids)}isRestrictionsActive(){if(!this.typeChanged||this.wizardManager.getCurrentStepId()===this.CLONE_PAGE_WIZARD_STEPS.PAGE_RESTRICTIONS){this.typeChanged=false;return true}return false}isPageInfoActive(){if(!this.infoChanged||this.wizardManager.getCurrentStepId()===this.CLONE_PAGE_WIZARD_STEPS.PAGE_INFO){this.infoChanged=false;return true}return false}getTargetCatalogVersion(){return this.pageBuilder.getTargetCatalogVersion()}isBasePageInfoAvailable(){return this.pageBuilder.isBasePageInfoAvailable()}onCancel(){return this.confirmationModalService.confirm({description:"se.editor.cancel.confirm"})}isFormValid(e){switch(e){case this.CLONE_PAGE_WIZARD_STEPS.PAGE_CLONE_OPTIONS:return this.isBasePageInfoAvailable();case this.CLONE_PAGE_WIZARD_STEPS.PAGE_INFO:return!this.cloneInProgress&&!!this.callbacks.isValidPageInfo&&this.callbacks.isValidPageInfo();case this.CLONE_PAGE_WIZARD_STEPS.PAGE_RESTRICTIONS:return!this.cloneInProgress&&this.pageBuilder.getPageRestrictions().length>0}return false}onNext(){return true}onDone(){return __awaiter(this,void 0,void 0,(function*(){this.cloneInProgress=true;try{const e=yield this.callbacks.savePageInfo();const t=this.preparePagePayload(e);if(this.pageBuilder.getTargetCatalogVersion()){t.siteId=this.pageBuilder.getTargetCatalogVersion().siteId;t.catalogId=this.pageBuilder.getTargetCatalogVersion().catalogId;t.version=this.pageBuilder.getTargetCatalogVersion().version}const o=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);yield this.createPage(t,o)}catch(e){this.cloneInProgress=false;return Promise.reject()}}))}createPage(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield this.pageFacade.createPageForSite(e,e.siteId);this.syncPollingService.getSyncStatus(e.pageUuid,this.uriContext,true);if(t.catalogDescriptor.catalogVersionUuid===o.catalogVersion){this.experienceService.loadExperience({siteId:e.siteId,catalogId:e.catalogId,catalogVersion:e.version,pageId:o.uid})}else{this.clonePageAlertService.displayClonePageAlert(o)}return this.alertService.showSuccess({message:"se.cms.clonepage.alert.success"})}catch(e){this.cloneInProgress=false;this.systemEventService.publishAsync(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,{messages:e.error.errors});const t=e.error.errors;if(!t.find((e=>e.subject.indexOf("restrictions")===0))){this.wizardManager.goToStepWithId(this.CLONE_PAGE_WIZARD_STEPS.PAGE_INFO)}return Promise.reject()}}))}preparePagePayload(e){const t=u.cloneDeep(e);u.merge(t,this.pageBuilder.getPageProperties());t.cloneComponents=this.pageBuilder.getComponentCloneOption()==="clone";t.itemtype=e.typeCode;if(t.linkComponents&&t.linkComponents.length>0){t.linkComponents=[]}if(this.isRestrictionsActive()){t.restrictions=this.pageBuilder.getPageRestrictions()}return t}};hi.$inject=["wizardManager","clonePageBuilderFactory","restrictionsStepHandlerFactory","experienceService","confirmationModalService","systemEventService","restrictionTypesService","restrictionsService","sharedDataService","clonePageAlertService","alertService","pageFacade","syncPollingService"];hi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-clone-page-wizard",template:""}),__param(0,s.Inject(m.WIZARD_MANAGER)),__metadata("design:paramtypes",[m.WizardService,pi,t.RestrictionsStepHandlerFactory,m.IExperienceService,m.IConfirmationModalService,m.SystemEventService,t.RestrictionTypesService,t.RestrictionsService,m.ISharedDataService,t.ClonePageAlertService,m.IAlertService,Be,m.ISyncPollingService])],hi);let vi=class ClonePageWizardService{constructor(e,t,o){this.modalWizard=e;this.catalogService=t;this.pageFacade=o}openClonePageWizard(e){return __awaiter(this,void 0,void 0,(function*(){const t=e?yield this.catalogService.retrieveUriContext():yield this.pageFacade.retrievePageUriContext();return this.modalWizard.open({component:hi,properties:{uriContext:t,basePageUUID:e?e.uuid:undefined}})}))}};vi.$inject=["modalWizard","catalogService","pageFacade"];vi=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.ModalWizard,m.ICatalogService,Be])],vi);window.__smartedit__.addDecoratorPayload("Component","ComponentCloneInfoFormComponent",{selector:"se-component-clone-info-form",template:`<se-message *ngIf="catalogVersionContainsPageWithSameTypeCode" type="warning"><span se-message-description translate="se.cms.clonepagewizard.pageinfo.targetcatalogversion.pagetype.exists.message" [translateParams]="{ typeCode: pageTypeCode }"></span></se-message><se-generic-editor [id]="genericEditorId" [structure]="structure" [content]="content" [(submit)]="submitInternal" [(reset)]="resetInternal" [(isDirty)]="isDirtyInternal" [(isValid)]="isValidInternal" (getApi)="setGenericEditorApi($event)"></se-generic-editor>`});let _i=class ComponentCloneInfoFormComponent{constructor(e,t,o,n,a){this.translateService=e;this.languageService=t;this.pageFacade=o;this.pageService=n;this.systemEventService=a;this.genericEditorId="COMPONENT_CLONE_INFO_FORM_GENERIC_ID";this.isDirtyChange=new s.EventEmitter;this.isValidChange=new s.EventEmitter;this.submitChange=new s.EventEmitter;this.resetChange=new s.EventEmitter}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.pageLabel=null;this.catalogVersionContainsPageWithSameTypeCode=false;if(this.pageTypeCode!=="ContentPage"&&this.targetCatalogVersion&&!this.isUriContextEqualToCatalogVersion(this.uriContext,this.targetCatalogVersion)){const e={[m.PAGE_CONTEXT_SITE_ID]:this.targetCatalogVersion.siteId,[p.PAGE_CONTEXT_CATALOG]:this.targetCatalogVersion.catalogId,[p.PAGE_CONTEXT_CATALOG_VERSION]:this.targetCatalogVersion.version};const t=yield this.pageService.primaryPageForPageTypeExists(this.pageTypeCode,e);this.catalogVersionContainsPageWithSameTypeCode=t}setTimeout((()=>{this.isDirtyChange.emit((()=>this.isDirtyInternal&&this.isDirtyInternal()));this.isValidChange.emit((()=>this.isValidInternal&&this.isValidInternal()));this.submitChange.emit((()=>this.submitInternal&&this.submitInternal()));this.resetChange.emit((()=>this.resetInternal&&this.resetInternal()))}));this.genericEditorLoadEventUnsubscribe=this.systemEventService.subscribe(m.GENERIC_EDITOR_LOADED_EVENT,((e,t)=>this.handleWarningMessage(t)))}))}ngOnDestroy(){if(this.genericEditorLoadEventUnsubscribe){this.genericEditorLoadEventUnsubscribe()}}setGenericEditorApi(e){this.pageInfoEditorApi=e;if(this.targetCatalogVersion&&!this.isUriContextEqualToCatalogVersion(this.uriContext,this.targetCatalogVersion)){this.pageInfoEditorApi.getLanguages=()=>this.languageService.getLanguagesForSite(this.targetCatalogVersion.siteId)}}isUriContextEqualToCatalogVersion(e,t){return e&&t&&t.siteId===e.CURRENT_CONTEXT_SITE_ID&&t.catalogId===e.CURRENT_CONTEXT_CATALOG&&t.version===e.CURRENT_CONTEXT_CATALOG_VERSION}handleWarningMessage(e){return __awaiter(this,void 0,void 0,(function*(){if(e!==this.genericEditorId){return}if(this.pageTypeCode==="ContentPage"&&this.targetCatalogVersion&&this.pageInfoEditorApi&&!this.isUriContextEqualToCatalogVersion(this.uriContext,this.targetCatalogVersion)){const e=this.pageInfoEditorApi.getContent();if(e&&e.label!==this.pageLabel){this.pageLabel=e.label;yield this.toggleWarningMessage()}}}))}toggleWarningMessage(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageFacade.contentPageWithLabelExists(this.pageLabel,this.targetCatalogVersion.catalogId,this.targetCatalogVersion.version);if(e){this.systemEventService.publishAsync(m.GENERIC_EDITOR_UNRELATED_VALIDATION_MESSAGES_EVENT,{messages:[{subject:"label",message:this.translateService.instant("se.cms.clonepagewizard.pageinfo.targetcatalogversion.label.exists.message"),type:"Warning"}]})}else{this.pageInfoEditorApi.clearMessages()}}))}};_i.$inject=["translateService","languageService","pageFacade","pageService","systemEventService"];__decorate([s.Input(),__metadata("design:type",Object)],_i.prototype,"content",void 0);__decorate([s.Input(),__metadata("design:type",String)],_i.prototype,"pageTemplate",void 0);__decorate([s.Input(),__metadata("design:type",String)],_i.prototype,"pageTypeCode",void 0);__decorate([s.Input(),__metadata("design:type",Object)],_i.prototype,"structure",void 0);__decorate([s.Input(),__metadata("design:type",Object)],_i.prototype,"targetCatalogVersion",void 0);__decorate([s.Input(),__metadata("design:type",Object)],_i.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Function)],_i.prototype,"submit",void 0);__decorate([s.Input(),__metadata("design:type",Function)],_i.prototype,"reset",void 0);__decorate([s.Input(),__metadata("design:type",Function)],_i.prototype,"isDirty",void 0);__decorate([s.Input(),__metadata("design:type",Function)],_i.prototype,"isValid",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],_i.prototype,"isDirtyChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],_i.prototype,"isValidChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],_i.prototype,"submitChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],_i.prototype,"resetChange",void 0);_i=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-clone-info-form",template:`<se-message *ngIf="catalogVersionContainsPageWithSameTypeCode" type="warning"><span se-message-description translate="se.cms.clonepagewizard.pageinfo.targetcatalogversion.pagetype.exists.message" [translateParams]="{ typeCode: pageTypeCode }"></span></se-message><se-generic-editor [id]="genericEditorId" [structure]="structure" [content]="content" [(submit)]="submitInternal" [(reset)]="resetInternal" [(isDirty)]="isDirtyInternal" [(isValid)]="isValidInternal" (getApi)="setGenericEditorApi($event)"></se-generic-editor>`}),__metadata("design:paramtypes",[v.TranslateService,m.LanguageService,Be,m.IPageService,m.SystemEventService])],_i);window.__smartedit__.addDecoratorPayload("Component","ComponentCloneOptionFormComponent",{selector:"se-component-clone-option-form",template:`<label for="components-cloned-selector-id" class="se-control-label"><span translate="se.cms.clonepagewizard.options.title"></span><se-help><span translate="se.cms.clonepagewizard.options.tooltip"></span></se-help></label><div id="components-cloned-selector-id"><div class="se-form-control-row"><input class="components-cloned-option-id fd-form__control" type="radio" name="componentsclone" id="reference-cloning" [(ngModel)]="componentInSlotOption" (click)="updateComponentInSlotOption(CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING)" [value]="CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING"/> <label for="reference-cloning" translate="se.cms.clonepagewizard.options.existing"></label></div><div class="se-form-control-row"><input class="components-cloned-option-id fd-form__control" type="radio" id="deep-cloning" name="componentsclone" [(ngModel)]="componentInSlotOption" (click)="updateComponentInSlotOption(CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.CLONE)" [value]="CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.CLONE"/> <label for="deep-cloning" translate="se.cms.clonepagewizard.options.copies"></label></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let fi=class ComponentCloneOptionFormComponent{constructor(){this.CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION={REFERENCE_EXISTING:"reference",CLONE:"clone"};this.onSelectionChange=new s.EventEmitter}ngOnInit(){this.componentInSlotOption=this.CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING;this.onSelectionChange.emit(this.componentInSlotOption)}updateComponentInSlotOption(e){this.onSelectionChange.emit(e)}};__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],fi.prototype,"onSelectionChange",void 0);fi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-component-clone-option-form",template:`<label for="components-cloned-selector-id" class="se-control-label"><span translate="se.cms.clonepagewizard.options.title"></span><se-help><span translate="se.cms.clonepagewizard.options.tooltip"></span></se-help></label><div id="components-cloned-selector-id"><div class="se-form-control-row"><input class="components-cloned-option-id fd-form__control" type="radio" name="componentsclone" id="reference-cloning" [(ngModel)]="componentInSlotOption" (click)="updateComponentInSlotOption(CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING)" [value]="CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.REFERENCE_EXISTING"/> <label for="reference-cloning" translate="se.cms.clonepagewizard.options.existing"></label></div><div class="se-form-control-row"><input class="components-cloned-option-id fd-form__control" type="radio" id="deep-cloning" name="componentsclone" [(ngModel)]="componentInSlotOption" (click)="updateComponentInSlotOption(CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.CLONE)" [value]="CLONE_COMPONENTS_IN_CONTENT_SLOTS_OPTION.CLONE"/> <label for="deep-cloning" translate="se.cms.clonepagewizard.options.copies"></label></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[])],fi);window.__smartedit__.addDecoratorPayload("Component","DeletePageToolbarItemComponent",{selector:"se-delete-page-toolbar-item",template:`<div class="toolbar-action" *ngIf="isReady" [attr.data-item-key]="toolbarItem.key"><button type="button" class="btn toolbar-action--button" [disabled]="isDeletePageDisabled" [ngClass]="{ 'toolbar-action__disabled' : isDeletePageDisabled }" (click)="deletePage()"><span class="icon-delete se-toolbar-menu-ddlb--button__icon"></span><div class="toolbar-action-button__txt" translate="se.cms.actionitem.page.trash"></div></button><se-tooltip *ngIf="isDeletePageDisabled" [appendTo]="'body'" [isChevronVisible]="true" [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" [additionalClasses]="['se-tooltip--stretched']"><div se-tooltip-body><span [translate]="tooltipMessage"></span></div></se-tooltip></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let yi=class DeletePageToolbarItemComponent{constructor(e,t,o,n,s,a,r,d){this.pageService=e;this.pageFacade=t;this.managePageService=o;this.systemEventService=n;this.crossFrameEventService=s;this.cdr=a;this.userTrackingService=r;this.toolbarItem=d}ngOnInit(){this.unRegPageChange=this.crossFrameEventService.subscribe(m.EVENTS.PAGE_CHANGE,(()=>this.updateToolbar()));return this.updateToolbar()}ngOnDestroy(){this.unRegPageChange()}get isDeletePageDisabled(){return!this.isDeletePageEnabled}deletePage(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,"Delete Page");const e=yield this.pageService.getCurrentPageInfo();yield this.managePageService.softDeletePage(e,this.uriContext);this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE)}))}updateToolbar(){return __awaiter(this,void 0,void 0,(function*(){this.markAsNotReady();if(!this.cdr.destroyed){this.cdr.detectChanges()}const e=yield this.pageFacade.retrievePageUriContext();if(!e){return}this.uriContext=e;this.pageInfo=yield this.pageService.getCurrentPageInfo();this.isDeletePageEnabled=yield this.managePageService.isPageTrashable(this.pageInfo,this.uriContext);this.tooltipMessage=yield this.resolveTooltipMessage(this.isDeletePageEnabled,this.pageInfo,this.uriContext);this.markAsReady();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}markAsNotReady(){this.isReady=false;this.isDeletePageEnabled=false;this.tooltipMessage=null}markAsReady(){this.isReady=true}resolveTooltipMessage(e,t,o){return __awaiter(this,void 0,void 0,(function*(){return yield e?null:this.managePageService.getDisabledTrashTooltipMessage(t,o)}))}};yi.$inject=["pageService","pageFacade","managePageService","systemEventService","crossFrameEventService","cdr","userTrackingService","toolbarItem"];yi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-delete-page-toolbar-item",template:`<div class="toolbar-action" *ngIf="isReady" [attr.data-item-key]="toolbarItem.key"><button type="button" class="btn toolbar-action--button" [disabled]="isDeletePageDisabled" [ngClass]="{ 'toolbar-action__disabled' : isDeletePageDisabled }" (click)="deletePage()"><span class="icon-delete se-toolbar-menu-ddlb--button__icon"></span><div class="toolbar-action-button__txt" translate="se.cms.actionitem.page.trash"></div></button><se-tooltip *ngIf="isDeletePageDisabled" [appendTo]="'body'" [isChevronVisible]="true" [placement]="'bottom'" [triggers]="['mouseenter', 'mouseleave']" [additionalClasses]="['se-tooltip--stretched']"><div se-tooltip-body><span [translate]="tooltipMessage"></span></div></se-tooltip></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(7,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[m.IPageService,Be,t.ManagePageService,m.SystemEventService,m.CrossFrameEventService,s.ChangeDetectorRef,m.UserTrackingService,Object])],yi);var Si;(function(e){e["PENDING"]="PENDING";e["NO_HOMEPAGE"]="NO_HOMEPAGE";e["LOCAL"]="LOCAL";e["OLD"]="OLD";e["PARENT"]="PARENT"})(Si||(Si={}));window.__smartedit__.addDecoratorPayload("Component","DisplayConditionsEditorComponent",{selector:"se-display-conditions-editor",template:`<div><se-event-message class="existing-homepage__ymessage" [showEvent]="'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO'" [hideEvent]="'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO'"></se-event-message><se-display-conditions-page-info [pageName]="getPageName()" [pageType]="getPageType()" [isPrimary]="isPagePrimary()"></se-display-conditions-page-info><se-display-conditions-page-variations *ngIf="isPagePrimary()" [variations]="getVariations()"></se-display-conditions-page-variations><se-display-conditions-primary-page *ngIf="!isPagePrimary()" [readOnly]="getIsAssociatedPrimaryReadOnly()" [associatedPrimaryPage]="getAssociatedPrimaryPage()" [pageType]="getPageType()" (onPrimaryPageSelect)="onPrimaryPageSelect($event)"></se-display-conditions-primary-page><div *ngIf="showHomePageWidget()"><div class="se-component-homepage"><label class="se-control-label"><input type="checkbox" id="set-homepage-checkbox" class="fd-form__control se-display-conditions__homepage-input" name="clone-on-drop" [disabled]="disableHomepageCheckbox()" (ngModelChange)="homePageChanged($event)" [ngModel]="page.homepage"/> <span translate="se.cms.display.conditions.homepage.set"></span><se-help *ngIf="disableHomepageCheckbox()"><span translate="se.cms.display.conditions.homepage.disabled"></span></se-help></label></div><div class="se-display-conditions__replace-home-message" *ngIf="showReplaceLabel" translate="se.cms.display.conditions.homepage.replace" [translateParams]="{ currentHomepage: currentHomePageName }"></div></div></div>`,styles:[`.se-display-conditions__homepage-input{margin:0 4px 0 0}.se-display-conditions__replace-home-message{padding-top:8px}`],changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[m.L10nPipe]});let Ci=class DisplayConditionsEditorComponent{constructor(e,t,o,n,s,a,r,d,p){this.data=e;this.route=t;this.displayConditionsEditorModel=o;this.homepageService=n;this.pageService=s;this.logService=a;this.l10n=r;this.translateService=d;this.cdr=p;({model:this.page}=this.data);this.hasFallback=false;this.isPrimaryPage=false;this.showReplaceLabel=false;this.homepageDetails={status:Si.PENDING}}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield this.displayConditionsEditorModel.initModel(this.page.uid);const e=this.getRouteParams();try{const t=yield this.pageService.buildUriContextForCurrentPage(e.siteId,e.catalogId,e.catalogVersion);const[o,n,s]=yield Promise.all([this.pageService.isPagePrimaryWithContext(this.page.uid,t),this.homepageService.hasFallbackHomePage(t),this.homepageService.getHomepageDetailsForContext(t)]);this.isPrimaryPage=o;this.hasFallback=n;this.homepageDetails=s;if(!this.cdr.destroyed){this.cdr.detectChanges()}}catch(e){this.logService.error("DisplayConditionsEditorComponent::ngOnInit - unable to retrieve uriContext")}}))}disableHomepageCheckbox(){if(this.hasFallback){return false}if(this.homepageDetails.status===Si.LOCAL){if(this.homepageDetails.currentHomepageUid===this.page.uid){return true}if(this.homepageDetails.oldHomepageUid===this.page.uid){return false}return false}return true}homePageChanged(e){return __awaiter(this,void 0,void 0,(function*(){this.page.homepage=e;if(this.page.homepage){switch(this.homepageDetails.status){case Si.NO_HOMEPAGE:this.homepageService.sendEventHideReplaceParentHomePageInfo();this.showReplaceLabel=false;break;case Si.PARENT:const[e,t]=yield this.getTranslatedNames(this.homepageDetails.parentCatalogName,this.homepageDetails.targetCatalogName);this.homepageService.sendEventShowReplaceParentHomePageInfo({description:this.translateService.instant("se.cms.display.conditions.homepage.replace.parent.info.header",{parentCatalogName:e,parentCatalogVersion:this.homepageDetails.parentCatalogVersion,targetCatalogName:t,targetCatalogVersion:this.homepageDetails.targetCatalogVersion})});this.showReplaceLabel=false;break;case Si.LOCAL:this.homepageService.sendEventHideReplaceParentHomePageInfo();this.currentHomePageName=this.homepageDetails.currentHomepageName;this.showReplaceLabel=this.page.uid!==this.homepageDetails.currentHomepageUid;break}}else{this.homepageService.sendEventHideReplaceParentHomePageInfo();this.showReplaceLabel=false}}))}showHomePageWidget(){return this.homepageDetails.status!==Si.PENDING&&this.page.typeCode==="ContentPage"&&this.isPrimaryPage}getPageName(){return this.displayConditionsEditorModel.pageName}getPageType(){return this.displayConditionsEditorModel.pageType}isPagePrimary(){return this.displayConditionsEditorModel.isPrimary}getVariations(){return this.displayConditionsEditorModel.variations}getAssociatedPrimaryPage(){return this.displayConditionsEditorModel.associatedPrimaryPage}getIsAssociatedPrimaryReadOnly(){return this.displayConditionsEditorModel.isAssociatedPrimaryReadOnly}onPrimaryPageSelect(e){this.page.label=e.label}getRouteParams(){let e=this.route.firstChild?this.route.firstChild:this.route;while(!!e.firstChild){e=e.firstChild}return e.snapshot.params}getTranslatedNames(e,t){return Promise.all([this.l10n.transform(e).pipe(g.take(1)).toPromise(),this.l10n.transform(t).pipe(g.take(1)).toPromise()])}};Ci.$inject=["data","route","displayConditionsEditorModel","homepageService","pageService","logService","l10n","translateService","cdr"];Ci=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-display-conditions-editor",template:`<div><se-event-message class="existing-homepage__ymessage" [showEvent]="'CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO'" [hideEvent]="'CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO'"></se-event-message><se-display-conditions-page-info [pageName]="getPageName()" [pageType]="getPageType()" [isPrimary]="isPagePrimary()"></se-display-conditions-page-info><se-display-conditions-page-variations *ngIf="isPagePrimary()" [variations]="getVariations()"></se-display-conditions-page-variations><se-display-conditions-primary-page *ngIf="!isPagePrimary()" [readOnly]="getIsAssociatedPrimaryReadOnly()" [associatedPrimaryPage]="getAssociatedPrimaryPage()" [pageType]="getPageType()" (onPrimaryPageSelect)="onPrimaryPageSelect($event)"></se-display-conditions-primary-page><div *ngIf="showHomePageWidget()"><div class="se-component-homepage"><label class="se-control-label"><input type="checkbox" id="set-homepage-checkbox" class="fd-form__control se-display-conditions__homepage-input" name="clone-on-drop" [disabled]="disableHomepageCheckbox()" (ngModelChange)="homePageChanged($event)" [ngModel]="page.homepage"/> <span translate="se.cms.display.conditions.homepage.set"></span><se-help *ngIf="disableHomepageCheckbox()"><span translate="se.cms.display.conditions.homepage.disabled"></span></se-help></label></div><div class="se-display-conditions__replace-home-message" *ngIf="showReplaceLabel" translate="se.cms.display.conditions.homepage.replace" [translateParams]="{ currentHomepage: currentHomePageName }"></div></div></div>`,styles:[`.se-display-conditions__homepage-input{margin:0 4px 0 0}.se-display-conditions__replace-home-message{padding-top:8px}`],changeDetection:s.ChangeDetectionStrategy.OnPush,providers:[m.L10nPipe]}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,w.ActivatedRoute,t.DisplayConditionsEditorModel,t.HomepageService,m.IPageService,m.LogService,m.L10nPipe,v.TranslateService,s.ChangeDetectorRef])],Ci);window.__smartedit__.addDecoratorPayload("Component","DisplayConditionsPageInfoComponent",{selector:"se-display-conditions-page-info",template:`<div class="se-edit-page-info__display-conditions"><div class="se-edit-page-info-display-conditions__basic-info"><div><label class="se-control-label" translate="se.cms.pagelist.headerpagename"></label><div class="form-readonly-text form-readonly-text__tight dc-page-name">{{ pageName }}</div></div><div><label class="se-control-label" translate="se.cms.pagelist.headerpagetype"></label><div class="form-readonly-text form-readonly-text__tight dc-page-type">{{ pageType }}</div></div></div><label class="se-control-label"><span translate="se.cms.display.conditions.label"></span><se-help><span [translate]="getPageDisplayConditionDescriptionI18nKey()"></span></se-help></label><p class="form-readonly-text form-readonly-text__tight dc-page-display-condition" [translate]="getPageDisplayConditionI18nKey()"></p></div>`,styles:[`.se-edit-page-info__display-conditions{margin-bottom:16px}.se-edit-page-info-display-conditions__basic-info{display:grid;grid-template-columns:repeat(2,1fr);margin-bottom:16px}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let bi=class DisplayConditionsPageInfoComponent{getPageDisplayConditionI18nKey(){return this.isPrimary?"se.cms.display.conditions.primary.id":"se.cms.display.conditions.variation.id"}getPageDisplayConditionDescriptionI18nKey(){return this.isPrimary?"se.cms.display.conditions.primary.description":"se.cms.display.conditions.variation.description"}};__decorate([s.Input(),__metadata("design:type",Boolean)],bi.prototype,"isPrimary",void 0);__decorate([s.Input(),__metadata("design:type",String)],bi.prototype,"pageName",void 0);__decorate([s.Input(),__metadata("design:type",String)],bi.prototype,"pageType",void 0);bi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-display-conditions-page-info",template:`<div class="se-edit-page-info__display-conditions"><div class="se-edit-page-info-display-conditions__basic-info"><div><label class="se-control-label" translate="se.cms.pagelist.headerpagename"></label><div class="form-readonly-text form-readonly-text__tight dc-page-name">{{ pageName }}</div></div><div><label class="se-control-label" translate="se.cms.pagelist.headerpagetype"></label><div class="form-readonly-text form-readonly-text__tight dc-page-type">{{ pageType }}</div></div></div><label class="se-control-label"><span translate="se.cms.display.conditions.label"></span><se-help><span [translate]="getPageDisplayConditionDescriptionI18nKey()"></span></se-help></label><p class="form-readonly-text form-readonly-text__tight dc-page-display-condition" [translate]="getPageDisplayConditionI18nKey()"></p></div>`,styles:[`.se-edit-page-info__display-conditions{margin-bottom:16px}.se-edit-page-info-display-conditions__basic-info{display:grid;grid-template-columns:repeat(2,1fr);margin-bottom:16px}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],bi);window.__smartedit__.addDecoratorPayload("Component","CreationDateRendererComponent",{selector:"se-creation-date-renderer",template:`<span>{{ item.creationDate | date: 'short' }}</span>`});let Ii=class CreationDateRendererComponent{constructor(e){this.cellData=e;this.item=this.cellData.item}};Ii.$inject=["cellData"];Ii=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-creation-date-renderer",template:`<span>{{ item.creationDate | date: 'short' }}</span>`}),__param(0,s.Inject(m.CLIENT_PAGED_LIST_CELL_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],Ii);window.__smartedit__.addDecoratorPayload("Component","DisplayConditionsPageVariationsComponent",{selector:"se-display-conditions-page-variations",template:`<div class="form-group dc-page-variations"><label class="se-control-label control-label__margin"><span translate="se.cms.display.conditions.variation.pages.title"></span><se-help *ngIf="variations.length > 0"><span translate="se.cms.display.conditions.variations.description"></span></se-help></label><div *ngIf="variations.length === 0" class="dc-no-variations form-readonly-text form-readonly-text__tight form-readonly-text__inline" translate="se.cms.display.conditions.no.variations"></div><div *ngIf="variations.length > 0"><se-client-paged-list [items]="variations" [keys]="keys" [itemsPerPage]="itemsPerPage" class="dc-page-variations-list"></se-client-paged-list></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let wi=class DisplayConditionsPageVariationsComponent{constructor(){this.itemsPerPage=3;this.keys=[{property:"pageName",i18n:"se.cms.display.conditions.header.page.name"},{property:"creationDate",i18n:"se.cms.display.conditions.header.creation.date",component:Ii},{property:"restrictions",i18n:"se.cms.display.conditions.header.restrictions"}]}};__decorate([s.Input(),__metadata("design:type",Array)],wi.prototype,"variations",void 0);wi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-display-conditions-page-variations",template:`<div class="form-group dc-page-variations"><label class="se-control-label control-label__margin"><span translate="se.cms.display.conditions.variation.pages.title"></span><se-help *ngIf="variations.length > 0"><span translate="se.cms.display.conditions.variations.description"></span></se-help></label><div *ngIf="variations.length === 0" class="dc-no-variations form-readonly-text form-readonly-text__tight form-readonly-text__inline" translate="se.cms.display.conditions.no.variations"></div><div *ngIf="variations.length > 0"><se-client-paged-list [items]="variations" [keys]="keys" [itemsPerPage]="itemsPerPage" class="dc-page-variations-list"></se-client-paged-list></div></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[])],wi);window.__smartedit__.addDecoratorPayload("Component","DisplayConditionsPrimaryPageComponent",{selector:"se-display-conditions-primary-page",template:`<div class="form-group form-group__inline"><label class="se-control-label control-label__margin" translate="se.cms.display.conditions.primary.page.label"></label><div *ngIf="readOnly" class="dc-associated-primary-page form-readonly-text form-readonly-text__tight">{{ associatedPrimaryPage?.name }}</div><div *ngIf="!readOnly"><se-select id="display-conditions-primary-association-selector" [model]="associatedPrimaryPageUid" (modelChange)="associatedPrimaryPageUidOnChange($event)" [fetchStrategy]="fetchStrategy"></se-select><span *ngIf="associatedPrimaryPage?.name" class="se-form-help-message"><span>{{ 'se.cms.page.label.label' | translate }}: {{ associatedPrimaryPage.label }}</span></span></div></div>`});let Ei=class DisplayConditionsPrimaryPageComponent{constructor(e,t){this.pageService=e;this.displayConditionsFacade=t;this.associatedPrimaryPageUid=null;this.onPrimaryPageSelect=new s.EventEmitter;this.fetchStrategy={fetchEntity:()=>Promise.resolve({id:this.associatedPrimaryPage.uid,label:this.associatedPrimaryPage.name}),fetchPage:(e,t,o)=>this.displayConditionsFacade.getPrimaryPagesForPageType(this.pageType,null,{search:e,pageSize:t,currentPage:o})}}ngOnChanges(e){const t=e.associatedPrimaryPage;if(t&&!!t.currentValue){this.setAssociatedPrimaryPageSelected(t.currentValue)}}associatedPrimaryPageUidOnChange(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageService.getPageById(e);this.setAssociatedPrimaryPageSelected(t);this.onPrimaryPageSelect.emit(this.associatedPrimaryPage)}))}setAssociatedPrimaryPageSelected(e){this.associatedPrimaryPage=e;this.associatedPrimaryPageUid=e.uid}};Ei.$inject=["pageService","displayConditionsFacade"];__decorate([s.Input(),__metadata("design:type",Boolean)],Ei.prototype,"readOnly",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Ei.prototype,"associatedPrimaryPage",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ei.prototype,"pageType",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ei.prototype,"onPrimaryPageSelect",void 0);Ei=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-display-conditions-primary-page",template:`<div class="form-group form-group__inline"><label class="se-control-label control-label__margin" translate="se.cms.display.conditions.primary.page.label"></label><div *ngIf="readOnly" class="dc-associated-primary-page form-readonly-text form-readonly-text__tight">{{ associatedPrimaryPage?.name }}</div><div *ngIf="!readOnly"><se-select id="display-conditions-primary-association-selector" [model]="associatedPrimaryPageUid" (modelChange)="associatedPrimaryPageUidOnChange($event)" [fetchStrategy]="fetchStrategy"></se-select><span *ngIf="associatedPrimaryPage?.name" class="se-form-help-message"><span>{{ 'se.cms.page.label.label' | translate }}: {{ associatedPrimaryPage.label }}</span></span></div></div>`}),__metadata("design:paramtypes",[m.IPageService,De])],Ei);window.__smartedit__.addDecoratorPayload("Component","HomepageIconComponent",{selector:"se-homepage-icon",template:`<se-tooltip *ngIf="isVisible()" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger class="sap-icon--home se-homepage-icon" [ngClass]="getIconClass()"></span> <span se-tooltip-body [translate]="getTooltipMessage()"></span></se-tooltip>`,styles:[`.se-homepage-icon{margin-right:4px}.se-homepage-icon--current{color:#0a6ed1}.se-homepage-icon--old{color:#32363a}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Ti=class HomepageIconComponent{constructor(e,t){this.homepageService=e;this.cdr=t}ngOnChanges(){return __awaiter(this,void 0,void 0,(function*(){if(!this.cmsPage&&!this.uriContext){return}this.type=yield this.homepageService.getHomepageType(this.cmsPage,this.uriContext);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}isVisible(){return!!this.type}getIconClass(){return{"se-homepage-icon--current":this.type===t.HomepageType.CURRENT,"se-homepage-icon--old":this.type===t.HomepageType.OLD}}getTooltipMessage(){const e=this.getHomepageState(this.type);return`se.cms.homepage.tooltip.message.${e}`}getHomepageState(e){return t.HomepageType.CURRENT===e?"current":"previous"}};Ti.$inject=["homepageService","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],Ti.prototype,"cmsPage",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Ti.prototype,"uriContext",void 0);Ti=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-homepage-icon",template:`<se-tooltip *ngIf="isVisible()" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><span se-tooltip-trigger class="sap-icon--home se-homepage-icon" [ngClass]="getIconClass()"></span> <span se-tooltip-body [translate]="getTooltipMessage()"></span></se-tooltip>`,styles:[`.se-homepage-icon{margin-right:4px}.se-homepage-icon--current{color:#0a6ed1}.se-homepage-icon--old{color:#32363a}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[t.HomepageService,s.ChangeDetectorRef])],Ti);let Pi=class PageEditorModalConfigService{constructor(e,t,o,n,s){this.cmsitemsRestService=e;this.pageService=t;this.contextAwarePageStructureService=o;this.contextAwareEditableItemService=n;this.translateService=s}create(e){return __awaiter(this,void 0,void 0,(function*(){const t={title:"se.cms.pageeditormodal.editpagetab.title",componentUuid:e.uuid,componentType:e.typeCode};const[o,n]=yield Promise.all([this.cmsitemsRestService.getById(e.uuid),this.pageService.isPagePrimary(e.uid)]);t.content=o;t.content.template=o.masterTemplateId;const s=yield this.contextAwarePageStructureService.getPageStructureForPageEditing(t.content.typeCode,t.content.uid);t.structure=s;if(n){t.structure.attributes=this.filterPrimaryPageAttributes(t.structure.attributes)}if(!!e.uid){yield this.ensureReadOnlyMode(e,t)}return t}))}filterPrimaryPageAttributes(e){return e.filter((e=>this.isPrimaryPageAttribute(e)))}isPrimaryPageAttribute(e){return e.qualifier!=="restrictions"&&e.qualifier!=="onlyOneRestrictionMustApply"}ensureReadOnlyMode(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.contextAwareEditableItemService.isItemEditable(e.uid);t.readOnlyMode=!o;if(t.readOnlyMode){t.messages=[{type:"info",message:this.translateService.instant("se.cms.pageeditormodal.page.readonly.message")}]}return t}))}};Pi.$inject=["cmsitemsRestService","pageService","contextAwarePageStructureService","contextAwareEditableItemService","translateService"];Pi=__decorate([s.Injectable(),__metadata("design:paramtypes",[m.CmsitemsRestService,m.IPageService,t.ContextAwarePageStructureService,p.IContextAwareEditableItemService,v.TranslateService])],Pi);let Ai=class PageEditorModalService{constructor(e,t,o,n,s){this.genericEditorModalService=e;this.crossFrameEventService=t;this.systemEventService=o;this.pageEditorModalConfigService=n;this.logService=s}open(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageEditorModalConfigService.create(e);try{const o=yield this.genericEditorModalService.open(t,(()=>{this.crossFrameEventService.publish(p.DEFAULT_SYNCHRONIZATION_POLLING.FETCH_SYNC_STATUS_ONCE,e.uuid)}));this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE,o)}catch(e){this.logService.debug("Page Editor Modal dismissed",e)}}))}};Ai.$inject=["genericEditorModalService","crossFrameEventService","systemEventService","pageEditorModalConfigService","logService"];Ai=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.GenericEditorModalService,m.CrossFrameEventService,m.SystemEventService,Pi,m.LogService])],Ai);let Oi=class PageInfoMenuService{constructor(e,t,o,n,s,a,r){this.displayConditionsFacade=e;this.logService=t;this.pageEditorModalService=o;this.pageService=n;this.pageVersionSelectionService=s;this.translateService=a;this.typeStructureRestService=r;this.ALL_RESTRICTIONS_CRITERIA_LABEL="se.cms.restrictions.criteria.all";this.ANY_RESTRICTIONS_CRITERIA_LABEL="se.cms.restrictions.criteria.any";this.isPageEditorOpened=false}openPageEditor(e){if(u.isNil(e)){this.logService.warn(`[${this.constructor.name}] - Cannot open page editor. Provided page is empty.`);return}if(!this.isPageEditorOpened){this.isPageEditorOpened=true;this.pageEditorModalService.open(e).finally((()=>{this.isPageEditorOpened=false}))}}getCurrentPageInfo(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.pageService.getCurrentPageInfoByVersion(this.getCurrentPageVersionId());const t=yield this.getPrimaryPageName(e);e.template=e.masterTemplateId;const o=u.cloneDeep(e);o.content=e;o.primaryPage=t;o.localizedType=e.typeCode;o.displayCondition=this.getPageDisplayCondition(e);o.restrictionsCriteria=this.getPageRestrictionsCriteria(e);return o}catch(e){this.logService.warn(`[${this.constructor.name}] - Cannot retrieve page info. Please try again later.`)}}))}getPageStructureForViewing(e,t){return __awaiter(this,void 0,void 0,(function*(){try{const o=yield this.typeStructureRestService.getStructureByType(e);const n=o.map((e=>Object.assign(Object.assign({},e),{editable:false})));this.removeFieldFromStructure(n,"uid");this.removeFieldFromStructure(n,"restrictions");const s=[];const a=this.removeFieldFromStructure(n,"name");a.cmsStructureType="InfoPageName";this.addFieldToStructure(s,a);this.addFieldToStructure(s,this.buildField("displayCondition"));const r=this.structureContainsItemByFieldQualifier(n,"description");if(r){const e=this.removeFieldFromStructure(n,"description");e.cmsStructureType="InfoPageName";this.addFieldToStructure(s,e)}const d=this.structureContainsItemByFieldQualifier(n,"title");if(d){const e=this.removeFieldFromStructure(n,"title");e.cmsStructureType="InfoPageName";this.addFieldToStructure(s,e)}const p=this.structureContainsItemByFieldQualifier(n,"label");if(p){const e=this.removeFieldFromStructure(n,"label");e.cmsStructureType="InfoPageName";this.addFieldToStructure(s,e)}this.addFieldToStructure(s,this.buildField("localizedType"));this.addFieldToStructure(s,this.buildField("template"));if(!t){this.addFieldToStructure(s,this.buildField("primaryPage"));this.addFieldToStructure(s,this.buildField("restrictions","RestrictionsList"))}this.addFieldToStructure(s,this.removeFieldFromStructure(n,"creationtime"));this.addFieldToStructure(s,this.removeFieldFromStructure(n,"modifiedtime"));return{attributes:u.concat(s,n),category:"PAGE"}}catch(e){this.logService.warn(`[${this.constructor.name}] - Cannot retrieve page info structure. Please try again later.`)}}))}addFieldToStructure(e,t){if(t){e.push(t)}}buildField(e,t="ShortString"){return{cmsStructureType:t,qualifier:e,i18nKey:"se.cms.pageinfo.page."+e.toLocaleLowerCase(),editable:false}}structureContainsItemByFieldQualifier(e,t){return!!e.find((e=>e.qualifier===t))}removeFieldFromStructure(e,t){const o=u.remove(e,(e=>e.qualifier===t));return o[0]}getPrimaryPageName(e){return __awaiter(this,void 0,void 0,(function*(){if(this.isVariationPage(e)){const{name:t}=yield this.displayConditionsFacade.getPrimaryPageForVariationPage(e.uid);return t||null}return null}))}isVariationPage(e){return!e.defaultPage}getPageDisplayCondition(e){const t=this.isVariationPage(e)?"page.displaycondition.variation":"page.displaycondition.primary";return this.translateService.instant(t)}getPageRestrictionsCriteria(e){if(this.isVariationPage(e)&&e.onlyOneRestrictionMustApply!==undefined){const t=e.onlyOneRestrictionMustApply?this.ANY_RESTRICTIONS_CRITERIA_LABEL:this.ALL_RESTRICTIONS_CRITERIA_LABEL;return this.translateService.instant(t)}return null}getCurrentPageVersionId(){const e=this.pageVersionSelectionService.getSelectedPageVersion();return e?e.uid:null}};Oi.$inject=["displayConditionsFacade","logService","pageEditorModalService","pageService","pageVersionSelectionService","translateService","typeStructureRestService"];Oi=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[De,m.LogService,Ai,m.IPageService,m.PageVersionSelectionService,v.TranslateService,xe])],Oi);window.__smartedit__.addDecoratorPayload("Component","PageInfoMenuComponent",{selector:"se-page-info-menu",template:`<div class="toolbar-action" data-item-key="se.cms.pageInfoMenu"><fd-popover [(isOpen)]="toolbarItem.isOpen" (isOpenChange)="onDropdownToggle($event)" [closeOnOutsideClick]="true"><fd-popover-control><button type="button" class="btn toolbar-action--button" [attr.aria-pressed]="toolbarItem.isOpen"><span class="hyicon hyicon-pageinfo se-toolbar-menu-ddlb--button__icon"></span><div class="se-toolbar-page-info-wrapper"><span class="toolbar-action-button__txt" [translate]="toolbarItem.name"></span></div></button></fd-popover-control><fd-popover-body><div class="se-page-info__dropdown-menu toolbar-action--include"><div class="se-page-info-menu" *ngIf="toolbarItem.isOpen"><se-prevent-vertical-overflow><div class="se-page-info-menu__header"><span class="se-page-info-menu__header-title" translate="se.cms.pageinfo.information.title"></span><div *seHasOperationPermission="editPagePermission"><button class="se-page-info__edit-btn fd-button--compact" *ngIf="isReady" translate="se.cms.contextmenu.title.edit" (click)="onEditPageClick()"></button></div></div><div *ngIf="isReady" class="se-page-info-menu__body"><se-generic-editor [smarteditComponentId]="pageInfo.uid" [smarteditComponentType]="pageInfo.typeCode" [structure]="pageStructure" [content]="pageInfo"></se-generic-editor></div></se-prevent-vertical-overflow></div></div></fd-popover-body></fd-popover></div>`,styles:[`.se-page-info-menu__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px}.se-page-info-menu__header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-page-info-menu__body{width:100%;height:400px;overflow-y:auto}.se-page-info-menu__body--title{text-transform:capitalize}.se-page-info__dropdown-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%}.se-page-info__dropdown-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-page-info__dropdown-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-page-info__dropdown-menu::after,.se-page-info__dropdown-menu::before{left:14px}.se-page-info__dropdown-menu input{color:#32363a!important}.se-page-info-menu se-ge-tab{display:grid;grid-template-columns:repeat(1,1fr);grid-gap:0 16px;width:368px}.se-page-info-menu__body .fd-form-control[type=email]:disabled .fd-popover-custom,.se-page-info-menu__body .fd-form-control[type=text]:disabled .fd-popover-custom,.se-page-info-menu__body .se-select.is-disabled .fd-popover-custom,.se-tabset-wrapper .fd-form-control[type=email]:disabled .fd-popover-custom,.se-tabset-wrapper .fd-form-control[type=text]:disabled .fd-popover-custom,.se-tabset-wrapper .se-select.is-disabled .fd-popover-custom{opacity:1}.se-page-info-menu__body .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button,.se-page-info-menu__body .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button,.se-page-info-menu__body .se-select.is-disabled .fd-popover-custom .toggle-button,.se-tabset-wrapper .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button,.se-tabset-wrapper .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button,.se-tabset-wrapper .se-select.is-disabled .fd-popover-custom .toggle-button{border:none;opacity:1;color:#32363a;padding:0;line-height:1rem}.se-page-info-menu__body .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button::after,.se-page-info-menu__body .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button::after,.se-page-info-menu__body .se-select.is-disabled .fd-popover-custom .toggle-button::after,.se-tabset-wrapper .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button::after,.se-tabset-wrapper .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button::after,.se-tabset-wrapper .se-select.is-disabled .fd-popover-custom .toggle-button::after{display:none}`],encapsulation:s.ViewEncapsulation.None});let xi=class PageInfoMenuComponent{constructor(e,t,o,n,s,a){this.toolbarItem=e;this.pageInfoMenuService=t;this.pageService=o;this.catalogService=n;this.systemEventService=s;this.userTrackingService=a;this.cmsPage=null;this.uriContext=null;this.isReady=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.unRegContentCatalogUpdate=this.systemEventService.subscribe(m.EVENT_CONTENT_CATALOG_UPDATE,(()=>this.setPageData()));yield this.setPageData()}))}ngOnDestroy(){this.unRegContentCatalogUpdate()}onEditPageClick(){this.pageInfoMenuService.openPageEditor(this.pageInfo.content);this.closeMenu()}setPageData(){return __awaiter(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.pageService.getCurrentPageInfo(),this.catalogService.retrieveUriContext()]);this.cmsPage=e;this.uriContext=t;this.editPagePermission=[{names:["se.edit.page.type"],context:{typeCode:e.typeCode}},{names:["se.edit.page.link"]}]}))}onDropdownToggle(e){return __awaiter(this,void 0,void 0,(function*(){if(!e){return}this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,"Info");const t=yield this.pageInfoMenuService.getCurrentPageInfo();this.pageInfo=t;const o=yield this.pageInfoMenuService.getPageStructureForViewing(t.typeCode,t.defaultPage);this.pageStructure=o;this.isReady=true}))}closeMenu(){this.toolbarItem.isOpen=false}};xi.$inject=["toolbarItem","pageInfoMenuService","pageService","catalogService","systemEventService","userTrackingService"];xi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-info-menu",template:`<div class="toolbar-action" data-item-key="se.cms.pageInfoMenu"><fd-popover [(isOpen)]="toolbarItem.isOpen" (isOpenChange)="onDropdownToggle($event)" [closeOnOutsideClick]="true"><fd-popover-control><button type="button" class="btn toolbar-action--button" [attr.aria-pressed]="toolbarItem.isOpen"><span class="hyicon hyicon-pageinfo se-toolbar-menu-ddlb--button__icon"></span><div class="se-toolbar-page-info-wrapper"><span class="toolbar-action-button__txt" [translate]="toolbarItem.name"></span></div></button></fd-popover-control><fd-popover-body><div class="se-page-info__dropdown-menu toolbar-action--include"><div class="se-page-info-menu" *ngIf="toolbarItem.isOpen"><se-prevent-vertical-overflow><div class="se-page-info-menu__header"><span class="se-page-info-menu__header-title" translate="se.cms.pageinfo.information.title"></span><div *seHasOperationPermission="editPagePermission"><button class="se-page-info__edit-btn fd-button--compact" *ngIf="isReady" translate="se.cms.contextmenu.title.edit" (click)="onEditPageClick()"></button></div></div><div *ngIf="isReady" class="se-page-info-menu__body"><se-generic-editor [smarteditComponentId]="pageInfo.uid" [smarteditComponentType]="pageInfo.typeCode" [structure]="pageStructure" [content]="pageInfo"></se-generic-editor></div></se-prevent-vertical-overflow></div></div></fd-popover-body></fd-popover></div>`,styles:[`.se-page-info-menu__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px}.se-page-info-menu__header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-page-info-menu__body{width:100%;height:400px;overflow-y:auto}.se-page-info-menu__body--title{text-transform:capitalize}.se-page-info__dropdown-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%}.se-page-info__dropdown-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-page-info__dropdown-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-page-info__dropdown-menu::after,.se-page-info__dropdown-menu::before{left:14px}.se-page-info__dropdown-menu input{color:#32363a!important}.se-page-info-menu se-ge-tab{display:grid;grid-template-columns:repeat(1,1fr);grid-gap:0 16px;width:368px}.se-page-info-menu__body .fd-form-control[type=email]:disabled .fd-popover-custom,.se-page-info-menu__body .fd-form-control[type=text]:disabled .fd-popover-custom,.se-page-info-menu__body .se-select.is-disabled .fd-popover-custom,.se-tabset-wrapper .fd-form-control[type=email]:disabled .fd-popover-custom,.se-tabset-wrapper .fd-form-control[type=text]:disabled .fd-popover-custom,.se-tabset-wrapper .se-select.is-disabled .fd-popover-custom{opacity:1}.se-page-info-menu__body .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button,.se-page-info-menu__body .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button,.se-page-info-menu__body .se-select.is-disabled .fd-popover-custom .toggle-button,.se-tabset-wrapper .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button,.se-tabset-wrapper .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button,.se-tabset-wrapper .se-select.is-disabled .fd-popover-custom .toggle-button{border:none;opacity:1;color:#32363a;padding:0;line-height:1rem}.se-page-info-menu__body .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button::after,.se-page-info-menu__body .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button::after,.se-page-info-menu__body .se-select.is-disabled .fd-popover-custom .toggle-button::after,.se-tabset-wrapper .fd-form-control[type=email]:disabled .fd-popover-custom .toggle-button::after,.se-tabset-wrapper .fd-form-control[type=text]:disabled .fd-popover-custom .toggle-button::after,.se-tabset-wrapper .se-select.is-disabled .fd-popover-custom .toggle-button::after{display:none}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[Object,Oi,m.IPageService,m.ICatalogService,m.SystemEventService,m.UserTrackingService])],xi);window.__smartedit__.addDecoratorPayload("Component","RestorePageItemComponent",{selector:"se-restore-page-item",template:`<div *seHasOperationPermission="restorePagePermission"><a class="se-dropdown-item fd-menu__item" (click)="restorePage()"><span [translate]="'se.cms.actionitem.page.restore'"></span></a></div>`});let Di=class RestorePageItemComponent{constructor(e,t,o){this.managePageService=e;this.userTrackingService=t;this.dropdownMenuData=o}ngOnInit(){this.pageInfo=this.dropdownMenuData.selectedItem;this.restorePagePermission=[{names:["se.restore.page.type"],context:{typeCode:this.pageInfo.typeCode}}]}restorePage(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Restore");this.managePageService.restorePage(this.pageInfo)}};Di.$inject=["managePageService","userTrackingService","dropdownMenuData"];Di=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restore-page-item",template:`<div *seHasOperationPermission="restorePagePermission"><a class="se-dropdown-item fd-menu__item" (click)="restorePage()"><span [translate]="'se.cms.actionitem.page.restore'"></span></a></div>`}),__param(2,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[t.ManagePageService,m.UserTrackingService,Object])],Di);window.__smartedit__.addDecoratorPayload("Component","UpdatePageStatusComponent",{selector:"se-update-page-status",template:`<div *ngIf="showButton"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnSync()"><span [translate]="'se.cms.actionitem.page.sync'"></span></a></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let Ri=class UpdatePageStatusComponent{constructor(e,t,o,n,s,a,r){this.cdr=e;this.managePageService=t;this.cmsitemsRestService=o;this.catalogService=n;this.crossFrameEventService=s;this.userTrackingService=a;this.dropdownMenuData=r;this.showButton=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.pageInfo=this.dropdownMenuData.selectedItem;yield this.setButtonVisibility()}))}onClickOnSync(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Sync");yield this.managePageService.trashPageInActiveCatalogVersion(this.pageInfo.uid);this.crossFrameEventService.publish(m.CMSITEMS_UPDATE_EVENT);this.crossFrameEventService.publish(p.EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV)}))}setButtonVisibility(){return __awaiter(this,void 0,void 0,(function*(){this.showButton=yield this.doesPageExistInActiveCatalogVersion();if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}doesPageExistInActiveCatalogVersion(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.retrieveUriContext();const t=yield this.catalogService.getContentCatalogActiveVersion(e);const o=yield this.cmsitemsRestService.get({pageSize:1,currentPage:0,typeCode:"AbstractPage",fields:"BASIC",itemSearchParams:`uid:${this.pageInfo.uid}`,catalogId:e.CONTEXT_CATALOG,catalogVersion:t});return o.pagination.totalCount===1}))}};Ri.$inject=["cdr","managePageService","cmsitemsRestService","catalogService","crossFrameEventService","userTrackingService","dropdownMenuData"];Ri=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-update-page-status",template:`<div *ngIf="showButton"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnSync()"><span [translate]="'se.cms.actionitem.page.sync'"></span></a></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(6,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[s.ChangeDetectorRef,t.ManagePageService,m.CmsitemsRestService,m.ICatalogService,m.CrossFrameEventService,m.UserTrackingService,Object])],Ri);window.__smartedit__.addDecoratorPayload("Component","PermanentlyDeletePageItemComponent",{selector:"se-permanently-delete-page-item",template:`<div *seHasOperationPermission="permanentlyDeletePagePermission"><div class="se-dropdown-item__delete-wrapper"><div class="se-dropdown-item__delete-link-wrapper" [ngClass]="{'se-dropdown-item__delete-link-wrapper--disabled': isDeleteButtonDisabled()}"><a class="se-dropdown-item se-dropdown-item__delete fd-menu__item" [ngClass]="{'se-dropdown-item--disabled': isDeleteButtonDisabled()}" (click)="permanentlyDelete()"><span [translate]="'se.cms.actionitem.page.permanently.delete'"></span></a></div><se-tooltip class="se-dropdown-item__delete-page-popover" *ngIf="isDeleteButtonDisabled()" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span se-tooltip-trigger class="sap-icon--message-error"></span> <span se-tooltip-body [translate]="'se.cms.actionitem.page.permanently.delete.blocked'"></span></se-tooltip></div></div>`,styles:[`.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`]});let ki=class PermanentlyDeletePageItemComponent{constructor(e,t,o,n,s,a){this.managePageService=e;this.cmsitemsRestService=t;this.catalogService=o;this.crossFrameEventService=n;this.userTrackingService=s;this.dropdownMenuData=a;this.isDeletable=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.pageInfo=this.dropdownMenuData.selectedItem;this.permanentlyDeletePagePermission=[{names:["se.permanently.delete.page.type"],context:{typeCode:this.pageInfo.typeCode}}];this.unregPageSyncStatusUpdate=this.crossFrameEventService.subscribe(p.EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV,this.fetchPageDeletableConditions.bind(this));yield this.fetchPageDeletableConditions()}))}ngOnDestroy(){this.unregPageSyncStatusUpdate()}permanentlyDelete(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Permanently Delete");if(this.isDeletable){this.managePageService.hardDeletePage(this.pageInfo)}}isDeleteButtonDisabled(){return!this.isDeletable}fetchPageDeletableConditions(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.retrieveUriContext();const t=yield this.catalogService.getContentCatalogActiveVersion(e);const o=yield this.cmsitemsRestService.get({pageSize:1,currentPage:0,typeCode:"AbstractPage",fields:"BASIC",itemSearchParams:`uid:${this.pageInfo.uid}`,catalogId:e.CURRENT_CONTEXT_CATALOG,catalogVersion:t});this.isDeletable=o.pagination.totalCount===0||o.response[0].pageStatus===m.CMSPageStatus.DELETED}))}};ki.$inject=["managePageService","cmsitemsRestService","catalogService","crossFrameEventService","userTrackingService","dropdownMenuData"];ki=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-permanently-delete-page-item",template:`<div *seHasOperationPermission="permanentlyDeletePagePermission"><div class="se-dropdown-item__delete-wrapper"><div class="se-dropdown-item__delete-link-wrapper" [ngClass]="{'se-dropdown-item__delete-link-wrapper--disabled': isDeleteButtonDisabled()}"><a class="se-dropdown-item se-dropdown-item__delete fd-menu__item" [ngClass]="{'se-dropdown-item--disabled': isDeleteButtonDisabled()}" (click)="permanentlyDelete()"><span [translate]="'se.cms.actionitem.page.permanently.delete'"></span></a></div><se-tooltip class="se-dropdown-item__delete-page-popover" *ngIf="isDeleteButtonDisabled()" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span se-tooltip-trigger class="sap-icon--message-error"></span> <span se-tooltip-body [translate]="'se.cms.actionitem.page.permanently.delete.blocked'"></span></se-tooltip></div></div>`,styles:[`.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`]}),__param(5,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[t.ManagePageService,m.CmsitemsRestService,m.ICatalogService,m.CrossFrameEventService,m.UserTrackingService,Object])],ki);window.__smartedit__.addDecoratorPayload("Component","EditPageItemComponent",{selector:"se-edit-page-item",template:`<div *seHasOperationPermission="editPagePermission"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnEdit()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.edit"></span></a></div>`});let Mi=class EditPageItemComponent{constructor(e,t,o){this.dropdownMenuData=e;this.pageInfoMenuService=t;this.userTrackingService=o}ngOnInit(){this.pageInfo=this.dropdownMenuData.selectedItem;this.editPagePermission=[{names:["se.edit.page.type"],context:{typeCode:this.pageInfo.typeCode}},{names:["se.act.on.page.in.workflow"],context:{pageInfo:this.pageInfo}}]}onClickOnEdit(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Edit");return this.pageInfoMenuService.openPageEditor(this.pageInfo)}};Mi.$inject=["dropdownMenuData","pageInfoMenuService","userTrackingService"];Mi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-edit-page-item",template:`<div *seHasOperationPermission="editPagePermission"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnEdit()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.edit"></span></a></div>`}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,Oi,m.UserTrackingService])],Mi);window.__smartedit__.addDecoratorPayload("Component","ClonePageItemComponent",{selector:"se-clone-page-item",template:`<div *seHasOperationPermission="clonePagePermission"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnClone()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.clone"></span></a></div>`});let Ni=class ClonePageItemComponent{constructor(e,t,o){this.dropdownMenuData=e;this.clonePageWizardService=t;this.userTrackingService=o}ngOnInit(){this.pageInfo=this.dropdownMenuData.selectedItem;this.clonePagePermission=[{names:["se.clone.page.type"],context:{typeCode:this.pageInfo.typeCode}}]}onClickOnClone(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Clone");this.clonePageWizardService.openClonePageWizard(this.pageInfo)}};Ni.$inject=["dropdownMenuData","clonePageWizardService","userTrackingService"];Ni=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-clone-page-item",template:`<div *seHasOperationPermission="clonePagePermission"><a class="se-dropdown-item fd-menu__item" (click)="onClickOnClone()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.clone"></span></a></div>`}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,vi,m.UserTrackingService])],Ni);window.__smartedit__.addDecoratorPayload("Component","DeletePageItemComponent",{selector:"se-delete-page-item",template:`<div *seHasOperationPermission="deletePagePermission"><div class="se-dropdown-item__delete-wrapper"><div class="se-dropdown-item__delete-link-wrapper" [ngClass]="{'se-dropdown-item__delete-link-wrapper--disabled': !isDeletePageEnabled}"><a class="se-dropdown-item se-dropdown-item__delete fd-menu__item" [ngClass]="{'se-dropdown-item--disabled': !isDeletePageEnabled}" (click)="isDeletePageEnabled && onClickOnDeletePage()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.trash"></span></a></div><se-tooltip *ngIf="!isDeletePageEnabled" class="se-dropdown-item__delete-page-popover" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span se-tooltip-trigger class="sap-icon--message-error"></span><div se-tooltip-body class="popover-tooltip"><span [translate]="tooltipMessage"></span></div></se-tooltip></div></div>`,styles:[`.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`]});let Fi=class DeletePageItemComponent{constructor(e,t,o,n,s){this.dropdownMenuData=e;this.managePageService=t;this.systemEventService=o;this.catalogService=n;this.userTrackingService=s;this.isDeletePageEnabled=false;this.tooltipMessage="se.cms.tooltip.movetotrash"}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.pageInfo=this.dropdownMenuData.selectedItem;yield this.getDisableDeleteTooltipMessage();this.setDeletePermissions()}))}onClickOnDeletePage(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Trash");const e=yield this.catalogService.retrieveUriContext();yield this.managePageService.softDeletePage(this.pageInfo,e);this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE)}))}setDeletePermissions(){this.deletePagePermission=[{names:["se.delete.page.type"],context:{typeCode:this.pageInfo.typeCode}},{names:["se.act.on.page.in.workflow"],context:{pageInfo:this.pageInfo}}]}getDisableDeleteTooltipMessage(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.retrieveUriContext();const t=yield this.managePageService.isPageTrashable(this.pageInfo,e);this.isDeletePageEnabled=t;if(this.isDeletePageEnabled){this.tooltipMessage=null;return}this.tooltipMessage=yield this.managePageService.getDisabledTrashTooltipMessage(this.pageInfo,e)}))}};Fi.$inject=["dropdownMenuData","managePageService","systemEventService","catalogService","userTrackingService"];Fi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-delete-page-item",template:`<div *seHasOperationPermission="deletePagePermission"><div class="se-dropdown-item__delete-wrapper"><div class="se-dropdown-item__delete-link-wrapper" [ngClass]="{'se-dropdown-item__delete-link-wrapper--disabled': !isDeletePageEnabled}"><a class="se-dropdown-item se-dropdown-item__delete fd-menu__item" [ngClass]="{'se-dropdown-item--disabled': !isDeletePageEnabled}" (click)="isDeletePageEnabled && onClickOnDeletePage()"><span class="se-dropdown-item--label" translate="se.cms.actionitem.page.trash"></span></a></div><se-tooltip *ngIf="!isDeletePageEnabled" class="se-dropdown-item__delete-page-popover" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span se-tooltip-trigger class="sap-icon--message-error"></span><div se-tooltip-body class="popover-tooltip"><span [translate]="tooltipMessage"></span></div></se-tooltip></div></div>`,styles:[`.se-dropdown-item__delete-wrapper{display:flex;flex-direction:row;align-items:center;width:100%}.se-dropdown-item__delete-page-popover{margin-right:16px}.se-dropdown-item__delete-page-popover .sap-icon--message-error{color:#0a6ed1}.se-dropdown-item__delete-link-wrapper{width:100%}.se-dropdown-item__delete-link-wrapper--disabled{cursor:not-allowed}`]}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,t.ManagePageService,m.SystemEventService,m.ICatalogService,m.UserTrackingService])],Fi);window.__smartedit__.addDecoratorPayload("Component","SynchronizeCatalogComponent",{selector:"se-synchronize-catalog",template:`<div class="se-synchronize-catalog"><div class="se-synchronize-catalog__sync-info"><div *ngIf="isSyncJobFinished()"><label class="se-synchronize-catalog__sync-info__sync-label" *ngIf="catalogVersion.active"><span translate="se.cms.cataloginfo.lastsyncedfrom"></span>&nbsp; <span>{{ syncJobStatus.source }}</span></label> <label class="se-synchronize-catalog__sync-info__sync-label" *ngIf="!catalogVersion.active" translate="se.cms.cataloginfo.lastsynced"></label> <span class="se-synchronize-catalog__sync-info__last-synched">{{ syncJobStatus.syncEndTime | date: 'M/d/yy h:mm a' }}</span></div><span class="se-synchronize-catalog__in-progress" *ngIf="isSyncJobInProgress()" translate="se.sync.status.synced.inprogress"></span> <span class="label-error se-synchronize-catalog__sync-failed" *ngIf="isSyncJobFailed()" translate="se.sync.status.synced.syncfailed"></span></div><ng-container *seHasOperationPermission="syncCatalogPermission"><ng-container *ngIf="!catalogVersion.active"><button class="se-synchronize-catalog__sync-btn fd-button--emphasized" [disabled]="!isSyncButtonEnabled()" (click)="syncCatalog()" translate="se.cms.cataloginfo.btn.sync"></button></ng-container></ng-container></div>`,styles:[`.se-synchronize-catalog{display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.se-synchronize-catalog__sync-info{display:flex;flex-direction:row;align-items:center}.se-synchronize-catalog__sync-btn{margin-left:20px}.se-synchronize-catalog__sync-info__sync-label:first-child{font-weight:700}.se-synchronize-catalog__sync-info__last-synched,.se-synchronize-catalog__sync-info__sync-label{color:#6a6d70;display:block;text-align:right;margin:0}.se-synchronize-catalog__in-progress{color:#0a7e3e}.se-synchronize-catalog__sync-failed{color:#b00}`],providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush});let zi=class SynchronizeCatalogComponent{constructor(e,t,o,n,s,a){this.synchronizationService=e;this.confirmationModalService=t;this.systemEventService=o;this.l10nPipe=n;this.cdr=s;this.userTrackingService=a}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.syncJobStatus={syncStartTime:"",syncEndTime:"",status:null,source:"",target:""};this.targetCatalogVersion=this.activeCatalogVersion.version;this.sourceCatalogVersion=!this.catalogVersion.active?this.catalogVersion.version:null;this.syncCatalogPermission=[{names:["se.sync.catalog"],context:{catalogId:this.catalog.catalogId,catalogVersion:this.sourceCatalogVersion,targetCatalogVersion:this.targetCatalogVersion}}];this.catalogDto={catalogId:this.catalog.catalogId,targetCatalogVersion:this.targetCatalogVersion,sourceCatalogVersion:this.sourceCatalogVersion};this.synchronizationService.startAutoGetSyncData(this.catalogDto,(e=>this.updateSyncStatusData(e)));yield this.callGetSyncData()}))}ngOnDestroy(){this.synchronizationService.stopAutoGetSyncData(this.catalogDto)}isSyncJobFinished(){return this.syncJobStatus.status===p.JOB_STATUS.FINISHED}isSyncJobInProgress(){return this.syncJobStatus.status===p.JOB_STATUS.RUNNING||this.syncJobStatus.status===p.JOB_STATUS.UNKNOWN}isSyncJobFailed(){return this.syncJobStatus.status===p.JOB_STATUS.ERROR||this.syncJobStatus.status===p.JOB_STATUS.FAILURE}isSyncButtonEnabled(){return!this.isSyncJobInProgress()}syncCatalog(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION,"Sync");const e=yield this.translateCatalogName(this.catalog.name);yield this.confirmationModalService.confirm({title:"se.sync.confirmation.title",description:"se.sync.confirm.msg",descriptionPlaceholders:{catalogName:e}}).catch((()=>Promise.reject()));const t=yield this.synchronizationService.updateCatalogSync(this.catalogDto);this.updateSyncStatusData(t);this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE,t)}))}translateCatalogName(e){return __awaiter(this,void 0,void 0,(function*(){return this.l10nPipe.transform(e).pipe(g.take(1)).toPromise()}))}callGetSyncData(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.synchronizationService.getCatalogSyncStatus(this.catalogDto);this.updateSyncStatusData(e)}))}updateSyncStatusData(e){this.syncJobStatus={syncStartTime:e.creationDate,syncEndTime:e.endDate,status:e.syncStatus,source:e.sourceCatalogVersion?e.sourceCatalogVersion:"",target:e.targetCatalogVersion?e.targetCatalogVersion:""};if(!this.cdr.destroyed){this.cdr.detectChanges()}}};zi.$inject=["synchronizationService","confirmationModalService","systemEventService","l10nPipe","cdr","userTrackingService"];__decorate([s.Input(),__metadata("design:type",Object)],zi.prototype,"catalog",void 0);__decorate([s.Input(),__metadata("design:type",Object)],zi.prototype,"catalogVersion",void 0);__decorate([s.Input(),__metadata("design:type",Object)],zi.prototype,"activeCatalogVersion",void 0);zi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-synchronize-catalog",template:`<div class="se-synchronize-catalog"><div class="se-synchronize-catalog__sync-info"><div *ngIf="isSyncJobFinished()"><label class="se-synchronize-catalog__sync-info__sync-label" *ngIf="catalogVersion.active"><span translate="se.cms.cataloginfo.lastsyncedfrom"></span>&nbsp; <span>{{ syncJobStatus.source }}</span></label> <label class="se-synchronize-catalog__sync-info__sync-label" *ngIf="!catalogVersion.active" translate="se.cms.cataloginfo.lastsynced"></label> <span class="se-synchronize-catalog__sync-info__last-synched">{{ syncJobStatus.syncEndTime | date: 'M/d/yy h:mm a' }}</span></div><span class="se-synchronize-catalog__in-progress" *ngIf="isSyncJobInProgress()" translate="se.sync.status.synced.inprogress"></span> <span class="label-error se-synchronize-catalog__sync-failed" *ngIf="isSyncJobFailed()" translate="se.sync.status.synced.syncfailed"></span></div><ng-container *seHasOperationPermission="syncCatalogPermission"><ng-container *ngIf="!catalogVersion.active"><button class="se-synchronize-catalog__sync-btn fd-button--emphasized" [disabled]="!isSyncButtonEnabled()" (click)="syncCatalog()" translate="se.cms.cataloginfo.btn.sync"></button></ng-container></ng-container></div>`,styles:[`.se-synchronize-catalog{display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.se-synchronize-catalog__sync-info{display:flex;flex-direction:row;align-items:center}.se-synchronize-catalog__sync-btn{margin-left:20px}.se-synchronize-catalog__sync-info__sync-label:first-child{font-weight:700}.se-synchronize-catalog__sync-info__last-synched,.se-synchronize-catalog__sync-info__sync-label{color:#6a6d70;display:block;text-align:right;margin:0}.se-synchronize-catalog__in-progress{color:#0a7e3e}.se-synchronize-catalog__sync-failed{color:#b00}`],providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[p.SynchronizationService,m.IConfirmationModalService,m.SystemEventService,m.L10nPipe,s.ChangeDetectorRef,m.UserTrackingService])],zi);window.__smartedit__.addDecoratorPayload("Component","PageSynchronizationHeaderComponent",{selector:"se-page-synchronization-header",template:`<ng-container *ngIf="ready"><div class="se-sync-panel-header"><span class="se-sync-panel-header__sub-header" [translate]="getSubHeaderText()"></span></div><div *ngIf="isNewPage()" class="se-sync-panel-new-page"><div class="se-sync-panel-new-page__header" translate="se.cms.synchronization.page.new.header"></div><div class="se-sync-panel-new-page__message">{{ headerText }}</div></div><div class="se-sync-panel-header__timestamp" *ngIf="!isNewPage()"><div translate="se.cms.synchronization.panel.lastsync.text"></div><span class="se-sync-panel-header__timestamp-text">{{ syncStatus.lastSyncStatus | date: 'M/d/yy h:mm a' }}</span></div></ng-container>`,styles:[`.se-sync-panel-header{padding:0 20px 20px;border-bottom:1px solid #d9d9d9;min-width:400px}.se-sync-panel-header__sub-header{padding-top:4px;color:#51555a}.se-sync-panel-header__timestamp{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a;position:absolute;left:20px;bottom:23px;width:150px}.se-sync-panel-new-page{padding:20px}.se-sync-panel-new-page__header{font-weight:700;padding-bottom:4px}.se-sync-panel-new-page__message{white-space:normal}`],providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush});let Li=class PageSynchronizationHeaderComponent{constructor(e,t,o,n,s,a){this.sharedDataService=e;this.catalogService=t;this.cmsitemsRestService=o;this.translateService=n;this.l10nPipe=s;this.cdr=a;this.ready=false}ngOnChanges(){return __awaiter(this,void 0,void 0,(function*(){if(!this.syncStatus){return}this.ready=false;yield this.updateHeaderText();this.ready=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getSubHeaderText(){if(this.isDefaultSubHeader()){return"se.cms.synchronization.page.header"}else if(this.isSyncOldHomeHeader()){return"se.cms.synchronization.page.header.old.homepage"}}isNewPage(){return this.pageSyncConditions.pageHasNoDepOrNoSyncStatus}isSyncOldHomeHeader(){return this.pageSyncConditions.pageHasSyncStatus&&!this.pageSyncConditions.canSyncHomepage}isDefaultSubHeader(){return!this.isSyncOldHomeHeader()&&!this.isNewPage()}updateHeaderText(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.sharedDataService.get(m.EXPERIENCE_STORAGE_KEY);const{catalogId:t,catalogName:o}=yield this.getCurrentCatalogIdFromExperience(e);const n=yield this.catalogService.getActiveContentCatalogVersionByCatalogId(t);const s=yield this.pageSyncConditions.pageHasUnavailableDependencies?this.fetchUnavailableDependencies():null;this.headerText=this.pageSyncConditions.pageHasUnavailableDependencies?this.translateService.instant("se.cms.synchronization.page.unavailable.items.description",{itemNames:s,catalogName:o,catalogVersion:n}):this.translateService.instant("se.cms.synchronization.page.new.description",{catalogName:o,catalogVersion:n})}))}userIsInsidePage(e){return!!e}getCurrentCatalogIdFromExperience({pageContext:e,catalogDescriptor:t}){return __awaiter(this,void 0,void 0,(function*(){const o=this.userIsInsidePage(e)?e.catalogId:t.catalogId;const n=this.userIsInsidePage(e)?e.catalogName:t.name;const s=yield this.l10nPipe.transform(n).pipe(g.take(1)).toPromise();return{catalogId:o,catalogName:s}}))}fetchUnavailableDependencies(){const e=this.syncStatus.unavailableDependencies.map((({itemId:e})=>e));return this.cmsitemsRestService.getByIds(e).then((({response:e})=>e.map((({name:e})=>e)).join(", ")))}};Li.$inject=["sharedDataService","catalogService","cmsitemsRestService","translateService","l10nPipe","cdr"];__decorate([s.Input(),__metadata("design:type",Object)],Li.prototype,"syncStatus",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Li.prototype,"pageSyncConditions",void 0);Li=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-synchronization-header",template:`<ng-container *ngIf="ready"><div class="se-sync-panel-header"><span class="se-sync-panel-header__sub-header" [translate]="getSubHeaderText()"></span></div><div *ngIf="isNewPage()" class="se-sync-panel-new-page"><div class="se-sync-panel-new-page__header" translate="se.cms.synchronization.page.new.header"></div><div class="se-sync-panel-new-page__message">{{ headerText }}</div></div><div class="se-sync-panel-header__timestamp" *ngIf="!isNewPage()"><div translate="se.cms.synchronization.panel.lastsync.text"></div><span class="se-sync-panel-header__timestamp-text">{{ syncStatus.lastSyncStatus | date: 'M/d/yy h:mm a' }}</span></div></ng-container>`,styles:[`.se-sync-panel-header{padding:0 20px 20px;border-bottom:1px solid #d9d9d9;min-width:400px}.se-sync-panel-header__sub-header{padding-top:4px;color:#51555a}.se-sync-panel-header__timestamp{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a;position:absolute;left:20px;bottom:23px;width:150px}.se-sync-panel-new-page{padding:20px}.se-sync-panel-new-page__header{font-weight:700;padding-bottom:4px}.se-sync-panel-new-page__message{white-space:normal}`],providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.ISharedDataService,m.ICatalogService,m.CmsitemsRestService,v.TranslateService,m.L10nPipe,s.ChangeDetectorRef])],Li);const Vi="PAGE_SYNC_STATUS_READY";window.__smartedit__.addDecoratorPayload("Component","PageSynchronizationPanelComponent",{selector:"se-page-synchronization-panel",template:`<se-page-synchronization-header class="se-sync-panel__sync-status" [syncStatus]="syncStatus" [pageSyncConditions]="pageSyncConditions"></se-page-synchronization-header><se-synchronization-panel *ngIf="!showFooter" [itemId]="cmsPage.uuid" [showFooter]="false" [getSyncStatus]="getSyncStatus" [performSync]="performSync" (selectedItemsUpdate)="onSelectedItemsUpdate($event)" (syncStatusReady)="onSyncStatusReady($event)" (getApi)="onGetApi($event)"></se-synchronization-panel><se-synchronization-panel *ngIf="showFooter" [itemId]="cmsPage.uuid" [getSyncStatus]="getSyncStatus" [performSync]="performSync" (syncStatusReady)="onSyncStatusReady($event)" (getApi)="onGetApi($event)"></se-synchronization-panel>`});let Ui=class PageSynchronizationPanelComponent{constructor(e,t,o,n,a){this.pageService=e;this.homepageService=t;this.crossFrameEventService=o;this.syncPollingService=n;this.translateService=a;this.getSyncStatus=()=>__awaiter(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.homepageService.canSyncHomepage(this.cmsPage,this.uriContext),this.syncPollingService.getSyncStatus(this.cmsPage.uuid,this.uriContext),this.evaluateIfSyncIsApproved()]);this.pageSyncConditions.canSyncHomepage=e;this.syncStatus=t;return this.syncStatus}));this.performSync=e=>this.syncPollingService.performSync(e,this.uriContext);this.syncStatusReady=e=>{this.pageSyncConditions.pageHasUnavailableDependencies=e.unavailableDependencies.length>0;this.pageSyncConditions.pageHasSyncStatus=!!e.lastSyncStatus;this.pageSyncConditions.pageHasNoDepOrNoSyncStatus=this.pageSyncConditions.pageHasUnavailableDependencies||!this.pageSyncConditions.pageHasSyncStatus;this.pageSyncConditions=u.cloneDeep(this.pageSyncConditions);if(this.pageSyncConditions.pageHasUnavailableDependencies){this.hidePageSync()}else if(!this.pageSyncConditions.pageHasSyncStatus){this.showPageSync()}else{this.enableSlotsSync()}this.crossFrameEventService.publish(Vi,this.pageSyncConditions)};this.selectedItemsUpdate=new s.EventEmitter;this.showFooter=true;this.syncStatus=null;this.pageSyncConditions={canSyncHomepage:false,pageHasUnavailableDependencies:false,pageHasSyncStatus:false,pageHasNoDepOrNoSyncStatus:false}}ngOnInit(){this.unSubPageUpdatedEvent=this.crossFrameEventService.subscribe(m.EVENTS.PAGE_UPDATED,(()=>this.evaluateIfSyncIsApproved()))}ngOnDestroy(){this.unSubPageUpdatedEvent()}onGetApi(e){this.synchronizationPanelApi=e;this.synchronizationPanelApi.disableItem=e=>!this.pageSyncConditions.canSyncHomepage&&e===this.syncStatus}onSyncStatusReady(e){this.syncStatusReady(e)}onSelectedItemsUpdate(e){this.selectedItemsUpdate.emit(e)}syncItems(){return this.synchronizationPanel.syncItems()}evaluateIfSyncIsApproved(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageService.isPageApproved(this.cmsPage.uuid);if(!e){this.disablePageSync()}}))}disablePageSync(){this.synchronizationPanelApi.setMessage({type:m.IAlertServiceType.WARNING,description:this.translateService.instant("se.cms.synchronization.slot.disabled.msg")});this.synchronizationPanelApi.disableItemList(true)}hidePageSync(){this.synchronizationPanelApi.displayItemList(false)}showPageSync(){this.synchronizationPanelApi.selectAll();this.synchronizationPanelApi.displayItemList(false)}enableSlotsSync(){this.synchronizationPanelApi.displayItemList(true)}};Ui.$inject=["pageService","homepageService","crossFrameEventService","syncPollingService","translateService"];__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ui.prototype,"selectedItemsUpdate",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Ui.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Object)],Ui.prototype,"cmsPage",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Ui.prototype,"showFooter",void 0);__decorate([s.ViewChild(p.SynchronizationPanelComponent,{static:false}),__metadata("design:type",p.SynchronizationPanelComponent)],Ui.prototype,"synchronizationPanel",void 0);Ui=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-synchronization-panel",template:`<se-page-synchronization-header class="se-sync-panel__sync-status" [syncStatus]="syncStatus" [pageSyncConditions]="pageSyncConditions"></se-page-synchronization-header><se-synchronization-panel *ngIf="!showFooter" [itemId]="cmsPage.uuid" [showFooter]="false" [getSyncStatus]="getSyncStatus" [performSync]="performSync" (selectedItemsUpdate)="onSelectedItemsUpdate($event)" (syncStatusReady)="onSyncStatusReady($event)" (getApi)="onGetApi($event)"></se-synchronization-panel><se-synchronization-panel *ngIf="showFooter" [itemId]="cmsPage.uuid" [getSyncStatus]="getSyncStatus" [performSync]="performSync" (syncStatusReady)="onSyncStatusReady($event)" (getApi)="onGetApi($event)"></se-synchronization-panel>`}),__metadata("design:paramtypes",[m.IPageService,t.HomepageService,m.CrossFrameEventService,m.ISyncPollingService,v.TranslateService])],Ui);window.__smartedit__.addDecoratorPayload("Component","PageSynchronizationPanelModalComponent",{selector:"se-page-synchronization-panel-modal",template:`\n        <se-page-synchronization-panel\n            *ngIf="isReady"\n            (selectedItemsUpdate)="onSelectedItemsUpdate($event)"\n            [uriContext]="data.uriContext"\n            [cmsPage]="data.cmsPage"\n            [showFooter]="false"\n        ></se-page-synchronization-panel>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush});let ji=class PageSynchronizationPanelModalComponent{constructor(e,t){this.modalManager=e;this.cdr=t;this.syncBtnId="sync"}ngOnInit(){this.modalManager.addButtons([{id:this.syncBtnId,label:"se.cms.actionitem.page.sync",style:m.ModalButtonStyle.Primary,action:m.ModalButtonAction.Close,disabled:true,callback:()=>C.from(this.pageSynchronizationPanelComponent.syncItems())},{id:"cancel",label:"se.cms.component.confirmation.modal.cancel",style:m.ModalButtonStyle.Default,action:m.ModalButtonAction.Dismiss}]);this.modalManager.getModalData().pipe(g.take(1)).subscribe((e=>{this.data=e;this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}onSelectedItemsUpdate(e){if(e.length===0||this.data.cmsPage.displayStatus!=="READY_TO_SYNC"){this.modalManager.disableButton(this.syncBtnId);return}this.modalManager.enableButton(this.syncBtnId)}};__decorate([s.ViewChild(Ui,{static:false}),__metadata("design:type",Ui)],ji.prototype,"pageSynchronizationPanelComponent",void 0);ji=__decorate([s.Component({selector:"se-page-synchronization-panel-modal",template:`\n        <se-page-synchronization-panel\n            *ngIf="isReady"\n            (selectedItemsUpdate)="onSelectedItemsUpdate($event)"\n            [uriContext]="data.uriContext"\n            [cmsPage]="data.cmsPage"\n            [showFooter]="false"\n        ></se-page-synchronization-panel>\n    `,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.ModalManagerService,s.ChangeDetectorRef])],ji);window.__smartedit__.addDecoratorPayload("Component","PageSyncMenuToolbarItemComponent",{selector:"se-page-sync-menu-toolbar-item",template:`<ng-container *seHasOperationPermission="'se.sync.catalog'"><fd-popover [(isOpen)]="toolbarItem.isOpen" [closeOnOutsideClick]="true"><fd-popover-control><button type="button" class="btn toolbar-action--button" [attr.aria-expanded]="toolbarItem.isOpen"><span class="icon-synchronize se-toolbar-menu-ddlb--button__icon"><span *ngIf="isNotInSync" class="hyicon hyicon-caution se-toolbar-menu-ddlb--button__caution"></span> </span><span class="toolbar-action-button__txt" [ngClass]="{'se-toolbar-menu-ddlb--button__txt': isNotInSync }" [translate]="toolbarItem.name"></span></button></fd-popover-control><fd-popover-body><div *ngIf="toolbarItem.isOpen && isReady" class="toolbar-action--include se-sync-menu-content__dropdown"><se-prevent-vertical-overflow><div class="se-sync-menu-content__header"><span class="se-sync-menu-content__header-title" translate="se.cms.synchronization.page.title"></span><se-help *ngIf="!syncPageConditions?.canSyncHomepage && !syncPageConditions?.pageHasNoDepOrNoSyncStatus" class="se-page-sync__y-help"><span>{{ helpText }}</span></se-help></div><se-page-synchronization-panel [cmsPage]="cmsPage" [uriContext]="uriContext"></se-page-synchronization-panel></se-prevent-vertical-overflow></div></fd-popover-body></fd-popover></ng-container>`,styles:[`.se-toolbar-menu-ddlb--button__icon{position:relative}.se-toolbar-menu-ddlb--button__caution{position:absolute;color:#e9730c;right:-9px;bottom:1px}.se-sync-menu-content__header{padding:15px 20px 0}.se-sync-menu-content__header-title{text-transform:capitalize;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-sync-menu-content__dropdown{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;max-width:400px}.se-sync-menu-content__dropdown::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-sync-menu-content__dropdown::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-sync-menu-content__dropdown::after,.se-sync-menu-content__dropdown::before{left:14px}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let $i=class PageSyncMenuToolbarItemComponent{constructor(e,t,o,n,s,a,r,d,p,m){this.crossFrameEventService=e;this.systemEventService=t;this.catalogService=o;this.pageService=n;this.pageInfoService=s;this.syncPollingService=a;this.translateService=r;this.logService=d;this.cdr=p;this.toolbarItem=m;this.isReady=false}ngOnInit(){this.unRegisterPageChange=this.crossFrameEventService.subscribe(m.EVENTS.PAGE_CHANGE,(()=>this.setup()));this.unRegisterSyncPageConditions=this.systemEventService.subscribe(Vi,((e,t)=>{this.syncPageConditions=t;this.setHelpText();if(!this.cdr.destroyed){this.cdr.detectChanges()}}));return this.setup()}ngOnDestroy(){this.unRegisterSyncPageConditions();this.unRegisterPageChange();if(this.unRegisterSyncPolling){this.unRegisterSyncPolling()}}setup(){return __awaiter(this,void 0,void 0,(function*(){this.isReady=false;this.isNotInSync=false;if(!this.cdr.destroyed){this.cdr.detectChanges()}try{[this.cmsPage,this.uriContext]=yield this.fetchSynchronizationPanelInfo();const e=yield this.catalogService.isContentCatalogVersionNonActive();if(!e){return}}catch(e){this.logService.error("Failed to setup PageSyncMenuToolbarItemComponent",e);return}this.subscribeSyncPolling();this.fetchSyncStatusAndSetIsNotInSync();this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}fetchSynchronizationPanelInfo(){return __awaiter(this,void 0,void 0,(function*(){return Promise.all([this.pageService.getCurrentPageInfo(),this.catalogService.retrieveUriContext()]).catch((e=>{this.logService.error("Failed to fetch Synchronization Panel Info",e);throw new Error(e)}))}))}subscribeSyncPolling(){if(this.unRegisterSyncPolling){this.unRegisterSyncPolling()}this.unRegisterSyncPolling=this.crossFrameEventService.subscribe(p.DEFAULT_SYNCHRONIZATION_POLLING.FAST_FETCH,(()=>this.fetchSyncStatusAndSetIsNotInSync()))}fetchSyncStatusAndSetIsNotInSync(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.fetchSyncStatus();this.isNotInSync=!p.synchronizationUtils.isInSync(e);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}fetchSyncStatus(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUUID();return this.syncPollingService.getSyncStatus(e)}))}setHelpText(){let e=this.translateService.instant("se.cms.synchronization.page.header");if(!this.syncPageConditions.pageHasNoDepOrNoSyncStatus){e+=` ${this.translateService.instant("se.cms.synchronization.page.header.help")}`}this.helpText=e}};$i.$inject=["crossFrameEventService","systemEventService","catalogService","pageService","pageInfoService","syncPollingService","translateService","logService","cdr","toolbarItem"];$i=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-sync-menu-toolbar-item",template:`<ng-container *seHasOperationPermission="'se.sync.catalog'"><fd-popover [(isOpen)]="toolbarItem.isOpen" [closeOnOutsideClick]="true"><fd-popover-control><button type="button" class="btn toolbar-action--button" [attr.aria-expanded]="toolbarItem.isOpen"><span class="icon-synchronize se-toolbar-menu-ddlb--button__icon"><span *ngIf="isNotInSync" class="hyicon hyicon-caution se-toolbar-menu-ddlb--button__caution"></span> </span><span class="toolbar-action-button__txt" [ngClass]="{'se-toolbar-menu-ddlb--button__txt': isNotInSync }" [translate]="toolbarItem.name"></span></button></fd-popover-control><fd-popover-body><div *ngIf="toolbarItem.isOpen && isReady" class="toolbar-action--include se-sync-menu-content__dropdown"><se-prevent-vertical-overflow><div class="se-sync-menu-content__header"><span class="se-sync-menu-content__header-title" translate="se.cms.synchronization.page.title"></span><se-help *ngIf="!syncPageConditions?.canSyncHomepage && !syncPageConditions?.pageHasNoDepOrNoSyncStatus" class="se-page-sync__y-help"><span>{{ helpText }}</span></se-help></div><se-page-synchronization-panel [cmsPage]="cmsPage" [uriContext]="uriContext"></se-page-synchronization-panel></se-prevent-vertical-overflow></div></fd-popover-body></fd-popover></ng-container>`,styles:[`.se-toolbar-menu-ddlb--button__icon{position:relative}.se-toolbar-menu-ddlb--button__caution{position:absolute;color:#e9730c;right:-9px;bottom:1px}.se-sync-menu-content__header{padding:15px 20px 0}.se-sync-menu-content__header-title{text-transform:capitalize;font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-sync-menu-content__dropdown{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;max-width:400px}.se-sync-menu-content__dropdown::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-sync-menu-content__dropdown::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-sync-menu-content__dropdown::after,.se-sync-menu-content__dropdown::before{left:14px}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(9,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[m.CrossFrameEventService,m.SystemEventService,m.ICatalogService,m.IPageService,m.IPageInfoService,m.ISyncPollingService,v.TranslateService,m.LogService,s.ChangeDetectorRef,Object])],$i);window.__smartedit__.addDecoratorPayload("Component","CatalogDetailsSyncComponent",{selector:"se-catalog-details-sync",template:`\n        <se-synchronize-catalog\n            [catalog]="catalogDetails.catalog"\n            [catalogVersion]="catalogDetails.catalogVersion"\n            [activeCatalogVersion]="catalogDetails.activeCatalogVersion"\n        >\n        </se-synchronize-catalog>\n    `});let Bi=class CatalogDetailsSyncComponent{constructor(e){this.catalogDetails=e}};Bi.$inject=["catalogDetails"];Bi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-catalog-details-sync",template:`\n        <se-synchronize-catalog\n            [catalog]="catalogDetails.catalog"\n            [catalogVersion]="catalogDetails.catalogVersion"\n            [activeCatalogVersion]="catalogDetails.activeCatalogVersion"\n        >\n        </se-synchronize-catalog>\n    `}),__param(0,s.Inject(m.CATALOG_DETAILS_ITEM_DATA)),__metadata("design:paramtypes",[Object])],Bi);let Gi=class SynchronizationModule{};Gi=__decorate([s.NgModule({imports:[f.CommonModule,m.TranslationModule.forChild(),S.PopoverModule,m.L10nPipeModule,m.HasOperationPermissionDirectiveModule,p.SynchronizationPanelModule,m.PreventVerticalOverflowModule,m.HelpModule],declarations:[zi,Li,Ui,ji,$i,Bi],entryComponents:[zi,Li,Ui,ji,$i,Bi]})],Gi);window.__smartedit__.addDecoratorPayload("Component","SyncPageItemComponent",{selector:"se-sync-page-item",template:`<div *seHasOperationPermission="syncPagePermission"><a class="se-dropdown-item fd-menu__item" (click)="sync()" translate="se.cms.actionitem.page.sync"></a></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let Hi=class SyncPageItemComponent{constructor(e,t,o,n,s,a){this.dropdownMenuData=e;this.catalogService=t;this.systemEventService=o;this.modalService=n;this.logService=s;this.userTrackingService=a}ngOnInit(){this.pageInfo=this.dropdownMenuData.selectedItem;this.syncPagePermission=[{names:["se.act.on.page.in.workflow"],context:{pageInfo:this.pageInfo}}]}sync(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Sync");const e=yield this.catalogService.retrieveUriContext();try{yield this.modalService.open({component:ji,templateConfig:{title:"se.cms.synchronization.pagelist.modal.title.prefix",titleSuffix:"se.cms.pageeditormodal.editpagetab.title"},config:{modalPanelClass:"modal-md"},data:{cmsPage:this.pageInfo,uriContext:e}}).afterClosed.toPromise();this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE)}catch(e){this.logService.debug("Page Synchronization Panel Modal dismissed",e)}}))}};Hi.$inject=["dropdownMenuData","catalogService","systemEventService","modalService","logService","userTrackingService"];Hi=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-sync-page-item",template:`<div *seHasOperationPermission="syncPagePermission"><a class="se-dropdown-item fd-menu__item" (click)="sync()" translate="se.cms.actionitem.page.sync"></a></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.DROPDOWN_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,m.ICatalogService,m.SystemEventService,m.IModalService,m.LogService,m.UserTrackingService])],Hi);window.__smartedit__.addDecoratorPayload("Component","TrashListDropdownItemsWrapperComponent",{selector:"se-trash-list-dropdown-items-wrapper",template:`<div\n        *seHasOperationPermission="'se.edit.page'"\n        class="paged-list-table__body__td paged-list-table__body__td-menu"\n    >\n        <se-dropdown-menu\n            [dropdownItems]="dropdownItems"\n            [selectedItem]="item"\n            class="pull-right"\n        ></se-dropdown-menu>\n    </div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let Wi=class TrashListDropdownItemsWrapperComponent{constructor(e,t,o,n){this.route=e;this.data=t;this.catalogVersionPermissionService=o;this.cdr=n;this.dropdownItems=[];this.loaded=false}ngOnInit(){return this.setDropdownItems()}setDropdownItems(){return __awaiter(this,void 0,void 0,(function*(){this.item=this.data.item;const e=yield this.catalogVersionPermissionService.hasSyncPermissionToActiveCatalogVersion(this.route.snapshot.params.catalogId,this.route.snapshot.params.catalogVersion);this.addDropdownItem(Di);if(e){this.addDropdownItem(Ri)}this.addDropdownItem(ki);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}addDropdownItem(e){this.dropdownItems=this.dropdownItems.concat({component:e})}};Wi=__decorate([s.Component({selector:"se-trash-list-dropdown-items-wrapper",template:`<div\n        *seHasOperationPermission="'se.edit.page'"\n        class="paged-list-table__body__td paged-list-table__body__td-menu"\n    >\n        <se-dropdown-menu\n            [dropdownItems]="dropdownItems"\n            [selectedItem]="item"\n            class="pull-right"\n        ></se-dropdown-menu>\n    </div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(1,s.Inject(m.DATA_TABLE_COMPONENT_DATA)),__metadata("design:paramtypes",[w.ActivatedRoute,Object,m.ICatalogVersionPermissionService,s.ChangeDetectorRef])],Wi);window.__smartedit__.addDecoratorPayload("Component","BaseWrapperComponent",{template:""});let qi=class BaseWrapperComponent{constructor(e){this.data=e}ngOnInit(){this.item=this.data.item}};qi=__decorate([s.Component({template:""}),__param(0,s.Inject(m.DATA_TABLE_COMPONENT_DATA)),__metadata("design:paramtypes",[Object])],qi);window.__smartedit__.addDecoratorPayload("Component","ModifiedTimeWrapperComponent",{selector:"se-modified-time-wrapper",template:`<div>{{ item.modifiedtime | date: 'short' }}</div>`});let Ki=class ModifiedTimeWrapperComponent extends qi{};Ki=__decorate([s.Component({selector:"se-modified-time-wrapper",template:`<div>{{ item.modifiedtime | date: 'short' }}</div>`})],Ki);window.__smartedit__.addDecoratorPayload("Component","NumberOfRestrictionsWrapperComponent",{selector:"se-number-of-restrictions-wrapper",template:`<se-restrictions-viewer [restrictions]="item.restrictions"></se-restrictions-viewer>`});let Yi=class NumberOfRestrictionsWrapperComponent extends qi{};Yi=__decorate([s.Component({selector:"se-number-of-restrictions-wrapper",template:`<se-restrictions-viewer [restrictions]="item.restrictions"></se-restrictions-viewer>`})],Yi);window.__smartedit__.addDecoratorPayload("Component","PageStatusWrapperComponent",{selector:"se-page-status-wrapper",template:`<div>\n        <se-page-display-status\n            [cmsPage]="item"\n            [showLastSyncTime]="false"\n        ></se-page-display-status>\n    </div>`});let Zi=class PageStatusWrapperComponent extends qi{};Zi=__decorate([s.Component({selector:"se-page-status-wrapper",template:`<div>\n        <se-page-display-status\n            [cmsPage]="item"\n            [showLastSyncTime]="false"\n        ></se-page-display-status>\n    </div>`})],Zi);window.__smartedit__.addDecoratorPayload("Component","PageNameWrapperComponent",{selector:"se-page-name-wrapper",template:`\n        <a href="" (click)="goToPage($event)">\n            <se-homepage-icon\n                class="homepage-icon__page-list"\n                [cmsPage]="item"\n                [uriContext]="uriContext"\n            ></se-homepage-icon>\n            {{ item.name }}\n        </a>\n    `});let Xi=class PageNameWrapperComponent{constructor(e,t,o,n){this.data=e;this.route=t;this.experienceService=o;this.urlService=n}ngOnInit(){this.item=this.data.item;({siteId:this.siteUid,catalogId:this.catalogId,catalogVersion:this.catalogVersion}=this.route.snapshot.params);this.uriContext=u.merge(this.urlService.buildUriContext(this.siteUid,this.catalogId,this.catalogVersion),this.urlService.buildPageUriContext(this.siteUid,this.catalogId,this.catalogVersion))}goToPage(e){e.preventDefault();if(this.item.uid){this.experienceService.loadExperience({siteId:this.siteUid,catalogId:this.catalogId,catalogVersion:this.catalogVersion,pageId:this.item.uid})}}};Xi=__decorate([s.Component({selector:"se-page-name-wrapper",template:`\n        <a href="" (click)="goToPage($event)">\n            <se-homepage-icon\n                class="homepage-icon__page-list"\n                [cmsPage]="item"\n                [uriContext]="uriContext"\n            ></se-homepage-icon>\n            {{ item.name }}\n        </a>\n    `}),__param(0,s.Inject(m.DATA_TABLE_COMPONENT_DATA)),__metadata("design:paramtypes",[Object,w.ActivatedRoute,m.IExperienceService,m.IUrlService])],Xi);window.__smartedit__.addDecoratorPayload("Component","PageListDropdownItemsWrapperComponent",{selector:"se-page-list-dropdown-items-wrapper",template:`<div\n        *seHasOperationPermission="'se.edit.page'"\n        class="paged-list-table__body__td paged-list-table__body__td-menu"\n    >\n        <se-dropdown-menu\n            [dropdownItems]="dropdownItems"\n            [selectedItem]="item"\n            class="pull-right"\n        ></se-dropdown-menu>\n    </div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let Qi=class PageListDropdownItemsWrapperComponent{constructor(e,t,o,n,s){this.route=e;this.data=t;this.catalogVersionPermissionService=o;this.managePageService=n;this.cdr=s;this.dropdownItems=[]}ngOnInit(){return this.setDropdownItems()}setDropdownItems(){return __awaiter(this,void 0,void 0,(function*(){this.item=this.data.item;const{catalogId:e,catalogVersion:t}=this.route.snapshot.params;const[o,n]=yield Promise.all([this.catalogVersionPermissionService.hasSyncPermissionToActiveCatalogVersion(e,t),this.managePageService.isPageCloneable(this.data.item.uuid,this.data.item.catalogVersion)]);this.addDropdownItem(Mi);if(o){this.addDropdownItem(Hi)}if(n){this.addDropdownItem(Ni)}this.addDropdownItem(Fi);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}addDropdownItem(e){this.dropdownItems=this.dropdownItems.concat({component:e})}};Qi=__decorate([s.Component({selector:"se-page-list-dropdown-items-wrapper",template:`<div\n        *seHasOperationPermission="'se.edit.page'"\n        class="paged-list-table__body__td paged-list-table__body__td-menu"\n    >\n        <se-dropdown-menu\n            [dropdownItems]="dropdownItems"\n            [selectedItem]="item"\n            class="pull-right"\n        ></se-dropdown-menu>\n    </div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(1,s.Inject(m.DATA_TABLE_COMPONENT_DATA)),__metadata("design:paramtypes",[w.ActivatedRoute,Object,m.ICatalogVersionPermissionService,t.ManagePageService,s.ChangeDetectorRef])],Qi);window.__smartedit__.addDecoratorPayload("Component","PageListComponent",{selector:"se-page-list",template:`<div class="se-page-list"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell se-toolbar--shortcut" imageRoot="imageRoot" toolbarName="smartEditPagesToolbar"></se-toolbar><div *ngIf="isReady"><div class="se-page-list__header"><span class="se-page-list__catalog-name" translate="se.cms.pagelist.title"></span><p class="se-page-list__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</p></div><div class="se-page-list__body"><div class="se-page-list__table-header"><span class="se-paged-list__page-count-wrapper"><span class="span-page-list__page-count-text" translate="se.pagelist.countsearchresult"></span> <span>&nbsp;</span> <span class="se-page-list__page-count">({{ count }})</span></span><div class="se-page-list__table-header--right"><div class="fd-form__group se-page-list__search"><div class="se-input-group"><input type="search" class="se-input-group__input-area ySEPage-list-search-input" maxlength="255" name="query" [ngModel]="query" (ngModelChange)="onQueryChange($event)" [placeholder]="'se.cms.pagelist.searchplaceholder' | translate"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="query" aria-label="clear" class="se-input-group__addon se-input-group__clear-btn" (click)="reset()"><span class="sap-icon--decline"></span></div></div></div><button class="fd-button se-page-list__add" (click)="openAddPageWizard()" translate="se.cms.addpagewizard.addpage"></button></div></div><div class="se-page-list__table-body"><se-dynamic-paged-list [config]="pageListConfig" [mask]="query" (getApi)="getApi($event);" (onItemsUpdate)="onPageItemsUpdate($event.pagination)"></se-dynamic-paged-list></div></div></div></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});let Ji=class PageListComponent{constructor(e,t,o,n,s,a,r){this.activatedRoute=e;this.urlService=t;this.catalogService=o;this.addPageWizardService=n;this.systemEventService=s;this.cdr=a;this.userTrackingService=r;const{snapshot:{params:d}}=this.activatedRoute;this.isReady=false;this.count=0;this.catalogId=d.catalogId;this.catalogVersion=d.catalogVersion;this.siteUid=d.siteId;this.catalogName={};this.pageUriContext=this.urlService.buildPageUriContext(this.siteUid,this.catalogId,this.catalogVersion);this.uriContext=this.urlService.buildUriContext(this.siteUid,this.catalogId,this.catalogVersion);this.pageListConfig={sortBy:"name",reversed:false,itemsPerPage:10,displayCount:true,keys:[],queryParams:{catalogId:this.catalogId,catalogVersion:this.catalogVersion,typeCode:"AbstractPage",itemSearchParams:"pageStatus:active",fields:"PAGE_LIST"},uri:m.cmsitemsUri};this.query="";this.querySubject$=new C.Subject;this.querySubscription=this.querySubject$.pipe(g.debounceTime(500),g.distinctUntilChanged()).subscribe((e=>{this.query=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnInit(){return this.initialize()}ngOnDestroy(){this.eventUnsubscribe();this.querySubscription.unsubscribe()}onPageItemsUpdate(e){this.count=e.totalCount}onContentCatalogUpdate(){if(this.dynamicPagedListApi){this.dynamicPagedListApi.reloadItems()}}onQueryChange(e){this.querySubject$.next(e)}getApi(e){this.dynamicPagedListApi=e}openAddPageWizard(){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_MANAGEMENT,"Create Page");yield this.addPageWizardService.openAddPageWizard();this.dynamicPagedListApi.reloadItems()}))}reset(){this.querySubject$.next("")}retrieveCatalogName(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.getContentCatalogsForSite(this.siteUid);this.catalogName=e.find((e=>e.catalogId===this.catalogId)).name}))}initialize(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.isContentCatalogVersionNonActive();this.pageListConfig.keys=[{property:"name",i18n:"se.cms.pagelist.headerpagename",sortable:true,component:Xi},{property:"uid",i18n:"se.cms.pagelist.headerpageid",sortable:true},{property:"itemtype",i18n:"se.cms.pagelist.headerpagetype",sortable:true},{property:"label",i18n:"se.cms.pagelist.headerpagelable",sortable:false},{property:"masterTemplateId",i18n:"se.cms.pagelist.headerpagetemplate",sortable:false},{property:"numberOfRestrictions",i18n:"se.cms.pagelist.headerrestrictions",sortable:false,component:Yi}];if(e){this.pageListConfig.keys.push({property:"pageStatus",i18n:"se.cms.pagelist.headerpagestatus",sortable:false,component:Zi})}this.pageListConfig.keys.push({property:"dropdownitems",i18n:"",sortable:false,component:Qi});yield this.retrieveCatalogName();this.eventUnsubscribe=this.systemEventService.subscribe(m.EVENT_CONTENT_CATALOG_UPDATE,(()=>this.onContentCatalogUpdate()));this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};Ji.$inject=["activatedRoute","urlService","catalogService","addPageWizardService","systemEventService","cdr","userTrackingService"];Ji=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-list",template:`<div class="se-page-list"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell se-toolbar--shortcut" imageRoot="imageRoot" toolbarName="smartEditPagesToolbar"></se-toolbar><div *ngIf="isReady"><div class="se-page-list__header"><span class="se-page-list__catalog-name" translate="se.cms.pagelist.title"></span><p class="se-page-list__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</p></div><div class="se-page-list__body"><div class="se-page-list__table-header"><span class="se-paged-list__page-count-wrapper"><span class="span-page-list__page-count-text" translate="se.pagelist.countsearchresult"></span> <span>&nbsp;</span> <span class="se-page-list__page-count">({{ count }})</span></span><div class="se-page-list__table-header--right"><div class="fd-form__group se-page-list__search"><div class="se-input-group"><input type="search" class="se-input-group__input-area ySEPage-list-search-input" maxlength="255" name="query" [ngModel]="query" (ngModelChange)="onQueryChange($event)" [placeholder]="'se.cms.pagelist.searchplaceholder' | translate"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="query" aria-label="clear" class="se-input-group__addon se-input-group__clear-btn" (click)="reset()"><span class="sap-icon--decline"></span></div></div></div><button class="fd-button se-page-list__add" (click)="openAddPageWizard()" translate="se.cms.addpagewizard.addpage"></button></div></div><div class="se-page-list__table-body"><se-dynamic-paged-list [config]="pageListConfig" [mask]="query" (getApi)="getApi($event);" (onItemsUpdate)="onPageItemsUpdate($event.pagination)"></se-dynamic-paged-list></div></div></div></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__metadata("design:paramtypes",[w.ActivatedRoute,m.IUrlService,m.ICatalogService,t.AddPageWizardService,m.SystemEventService,s.ChangeDetectorRef,m.UserTrackingService])],Ji);window.__smartedit__.addDecoratorPayload("Component","PageListLinkComponent",{selector:"se-page-list-link",template:`<div><a class="page-list-link-item__link" [href]="getLink()" translate="se.cms.cataloginfo.pagelist" (click)="onClick()"></a></div>`});let eo=class PageListLinkComponent{constructor(e,t){this.catalogDetails=e;this.userTrackingService=t}getLink(){const{siteId:e,catalog:{catalogId:t},catalogVersion:{version:o}}=this.catalogDetails;return`#!/${m.NG_ROUTE_PREFIX}/pages/${e}/${t}/${o}`}onClick(){const{catalogVersion:{version:e}}=this.catalogDetails;this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION,e+"- Pages")}};eo.$inject=["catalogDetails","userTrackingService"];eo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-list-link",template:`<div><a class="page-list-link-item__link" [href]="getLink()" translate="se.cms.cataloginfo.pagelist" (click)="onClick()"></a></div>`}),__param(0,s.Inject(m.CATALOG_DETAILS_ITEM_DATA)),__metadata("design:paramtypes",[Object,m.UserTrackingService])],eo);window.__smartedit__.addDecoratorPayload("Component","PagesLinkComponent",{selector:"se-pages-link",template:`<div class="se-page-list__page-link--left" (click)="backToPagelist()"><span class="se-page-list__page-link-icon icon-navigation-left-arrow"></span> <a class="se-page-list__page-link-anchor">{{ 'se.cms.back.to.pagelist' | translate }}</a></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`]});let to=class PagesLinkComponent{constructor(e,t){this.route=e;this.seRouting=t}ngOnInit(){this.siteId=this.route.snapshot.params.siteId;this.catalogId=this.route.snapshot.params.catalogId;this.catalogVersion=this.route.snapshot.params.catalogVersion}backToPagelist(){this.seRouting.go(`${m.NG_ROUTE_PREFIX}${p.PAGE_LIST_PATH}`.replace(":siteId",this.siteId).replace(":catalogId",this.catalogId).replace(":catalogVersion",this.catalogVersion))}};to.$inject=["route","seRouting"];to=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-pages-link",template:`<div class="se-page-list__page-link--left" (click)="backToPagelist()"><span class="se-page-list__page-link-icon icon-navigation-left-arrow"></span> <a class="se-page-list__page-link-anchor">{{ 'se.cms.back.to.pagelist' | translate }}</a></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`]}),__metadata("design:paramtypes",[w.ActivatedRoute,m.SmarteditRoutingService])],to);window.__smartedit__.addDecoratorPayload("Component","RestrictionsModalComponent",{selector:"se-restrictions-modal",template:`<div class="se-restrictions-list fd-menu__list fd-menu__list--separated"><div class="se-restriction__item fd-menu__item" *ngFor="let restriction of restrictions"><div class="se-restrictions-list__item-content"><div class="se-restriction__item-name">{{ restriction.name }}</div><div class="se-restriction__item-type-and-id">{{ restriction.type | seL10n | async }}</div><div class="se-restriction__item-description">{{ restriction.description }}</div></div></div></div>`,styles:[`#restrictions-label{display:none}.se-restriction__select{text-transform:capitalize;width:100%}.se-restrictions-list__item-content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;cursor:default;flex-grow:1}#userGroups-selector .se-generic-editor-multiple-dropdown__match li[draggable=true]{display:flex;flex-direction:row;align-items:center;justify-content:center;display:inline-flex!important;border:1px solid #d9d9d9;margin:4px 0 4px 8px;padding:4px 8px;border-radius:4px;background-color:var(--fd-token-background-color);color:#51555a;min-height:28px}`]});let io=class RestrictionsModalComponent{constructor(e,t,o){this.modalRef=e;this.cmsitemsRestService=t;this.cdr=o}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.cmsitemsRestService.getByIdsNoCache(this.modalRef.data.modalData,"FULL");this.restrictions=e.response?e.response:[e];if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};io=__decorate([s.Component({selector:"se-restrictions-modal",template:`<div class="se-restrictions-list fd-menu__list fd-menu__list--separated"><div class="se-restriction__item fd-menu__item" *ngFor="let restriction of restrictions"><div class="se-restrictions-list__item-content"><div class="se-restriction__item-name">{{ restriction.name }}</div><div class="se-restriction__item-type-and-id">{{ restriction.type | seL10n | async }}</div><div class="se-restriction__item-description">{{ restriction.description }}</div></div></div></div>`,styles:[`#restrictions-label{display:none}.se-restriction__select{text-transform:capitalize;width:100%}.se-restrictions-list__item-content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;cursor:default;flex-grow:1}#userGroups-selector .se-generic-editor-multiple-dropdown__match li[draggable=true]{display:flex;flex-direction:row;align-items:center;justify-content:center;display:inline-flex!important;border:1px solid #d9d9d9;margin:4px 0 4px 8px;padding:4px 8px;border-radius:4px;background-color:var(--fd-token-background-color);color:#51555a;min-height:28px}`]}),__metadata("design:paramtypes",[S.ModalRef,m.CmsitemsRestService,s.ChangeDetectorRef])],io);window.__smartedit__.addDecoratorPayload("Component","RestrictionsViewerComponent",{selector:"se-restrictions-viewer",template:`<div *ngIf="restrictions?.length > 0; else noRestrictions"><a href="" class="show-restrictions-btn" (click)="showRestrictions($event)">{{restrictions.length}}</a></div><ng-template #noRestrictions><div>-</div></ng-template>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let oo=class RestrictionsViewerComponent{constructor(e,t){this.modalService=e;this.logService=t}showRestrictions(e){e.preventDefault();return this.modalService.open({component:io,data:this.restrictions,templateConfig:{title:"se.cms.restrictionsviewer.title",isDismissButtonVisible:true},config:{modalPanelClass:"modal-md"}}).afterClosed.toPromise().catch((()=>{this.logService.warn("RestrictionsViewer - modal closed without any action")}))}};oo.$inject=["modalService","logService"];__decorate([s.Input(),__metadata("design:type",Array)],oo.prototype,"restrictions",void 0);oo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-restrictions-viewer",template:`<div *ngIf="restrictions?.length > 0; else noRestrictions"><a href="" class="show-restrictions-btn" (click)="showRestrictions($event)">{{restrictions.length}}</a></div><ng-template #noRestrictions><div>-</div></ng-template>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.ModalService,m.LogService])],oo);window.__smartedit__.addDecoratorPayload("Component","TrashLinkComponent",{selector:"se-trash-link",template:`<div *ngIf="isNonActiveCatalog" (click)="goToTrash()" class="se-page-list__page-link--right"><a translate="se.cms.pagelist.trashcan.link.text" [translateParams]="trashedPagesTranslationData" class="se-page-list__page-link-anchor"></a> <span class="se-page-list__page-link-icon sap-icon--navigation-right-arrow"></span></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`]});let no=class TrashLinkComponent{constructor(e,t,o,n,s,a){this.route=e;this.routingsService=t;this.managePageService=o;this.urlService=n;this.catalogService=s;this.systemEventService=a;this.isNonActiveCatalog=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){({siteId:this.siteId,catalogId:this.catalogId,catalogVersion:this.catalogVersion}=this.route.snapshot.params);this.uriContext=this.urlService.buildUriContext(this.siteId,this.catalogId,this.catalogVersion);const e=yield this.catalogService.isContentCatalogVersionNonActive();this.isNonActiveCatalog=e;if(e){this.updateTrashedPagesCount()}this.unsubscribeContentCatalogUpdateEvent=this.systemEventService.subscribe(m.EVENT_CONTENT_CATALOG_UPDATE,(()=>this.updateTrashedPagesCount()))}))}ngOnDestroy(){this.unsubscribeContentCatalogUpdateEvent()}updateTrashedPagesCount(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.managePageService.getSoftDeletedPagesCount(this.uriContext);this.trashedPagesTranslationData={totalCount:e}}))}goToTrash(){this.routingsService.go(`${m.NG_ROUTE_PREFIX}${p.TRASHED_PAGE_LIST_PATH}`.replace(":siteId",this.siteId).replace(":catalogId",this.catalogId).replace(":catalogVersion",this.catalogVersion))}};no.$inject=["route","routingsService","managePageService","urlService","catalogService","systemEventService"];no=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-trash-link",template:`<div *ngIf="isNonActiveCatalog" (click)="goToTrash()" class="se-page-list__page-link--right"><a translate="se.cms.pagelist.trashcan.link.text" [translateParams]="trashedPagesTranslationData" class="se-page-list__page-link-anchor"></a> <span class="se-page-list__page-link-icon sap-icon--navigation-right-arrow"></span></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`]}),__metadata("design:paramtypes",[w.ActivatedRoute,m.SmarteditRoutingService,t.ManagePageService,m.IUrlService,m.ICatalogService,m.SystemEventService])],no);let so=class PageComponentsModule{};so=__decorate([s.NgModule({imports:[f.CommonModule,m.L10nPipeModule,a.FormsModule,m.TranslationModule.forChild(),m.HasOperationPermissionDirectiveModule,m.TooltipModule,si,m.SharedComponentsModule,m.SelectModule,m.SeGenericEditorModule,t.PageRestrictionsModule,b.ToolbarModule,m.ClientPagedListModule,S.PopoverModule],providers:[t.ContextAwarePageStructureService,Ge,Ai,Pi,Oi,pi,vi],declarations:[Ri,Di,ki,to,oo,io,Yi,Zi,Ki,Wi,li,ci,Hi,yi,Ti,Ze,He,We,Ke,qe,Ye,hi,mi,gi,di,ri,fi,_i,ui,Mi,Ni,Fi,eo,Ji,Xi,Qi,no,Ei,bi,wi,Ii,Ci,xi],entryComponents:[Ri,Di,ki,to,oo,io,Yi,Zi,Ki,Wi,li,ci,Hi,yi,Ti,Ze,He,We,Ke,qe,Ye,hi,mi,gi,di,ri,fi,_i,ui,Mi,Ni,Fi,eo,Xi,Qi,no,Ei,bi,wi,Ii,Ci,xi],exports:[Ti]})],so);let ao=class NodeAncestryService{buildOrderedListOfAncestors(e,t){const o=u.reverse(this.fetchAncestors(e,t));let n=-1;return o.map((e=>{const t=++n;return Object.assign(Object.assign({},u.cloneDeep(e)),{level:t,formattedLevel:t===0?"se.cms.navigationcomponent.management.node.level.root":"se.cms.navigationcomponent.management.node.level.non.root"})}))}fetchAncestors(e,t){const o=e.find((e=>e.uid===t));if(!o){return[]}return[o].concat(this.fetchAncestors(e,o.parentUid))}};ao=__decorate([m.SeDowngradeService()],ao);let ro=class NavigationEditorNodeService{constructor(e,t,o){this.cmsitemsRestService=e;this.nodeAncestryService=t;this.navigationNodeRestService=o.get(p.NAVIGATION_MANAGEMENT_RESOURCE_URI)}getNavigationNode(e,t){const o=Object.assign({identifier:e},t);return this.navigationNodeRestService.get(o)}updateNavigationNodePosition(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.cmsitemsRestService.getById(e.parent.uuid);t.children=t.children||[];const o=t.children.findIndex((t=>t===e.uuid));const n=e.position;if(o<0||e.position===undefined){throw new Error(`navigationEditorNodeService.updateNavigationNodePosition() - invalid index: move FROM [${o}] TO [${n}]`)}t.children.splice(n,0,t.children.splice(o,1)[0]);t.identifier=t.uuid;return this.cmsitemsRestService.update(t)}))}getNavigationNodeAncestry(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=Object.assign({ancestorTrailFrom:e},t);const n=yield this.navigationNodeRestService.get(o);return this.nodeAncestryService.buildOrderedListOfAncestors(m.apiUtils.getDataFromResponse(n),e)}))}};ro.$inject=["cmsitemsRestService","nodeAncestryService","restServiceFactory"];ro=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.CmsitemsRestService,ao,m.IRestServiceFactory])],ro);window.__smartedit__.addDecoratorPayload("Component","BreadcrumbComponent",{selector:"se-breadcrumb",template:`<div class="se-breadcrumb"><div *ngFor="let node of breadcrumb; index as idx; last as isLast" class="se-breadcrumb__node"><div class="se-breadcrumb__info" [ngClass]="{'se-breadcrumb__info--last': isLast}"><span class="se-breadcrumb__info--level">{{ node.formattedLevel | translate: node }}</span> <span class="se-breadcrumb__info--name">{{ node.name }}</span></div><div class="se-breadcrumb__divider" *ngIf="idx < breadcrumb.length - 1"><span class="sap-icon--navigation-right-arrow"></span></div></div></div>`,styles:[`.se-breadcrumb{border-bottom:1px solid #eeeeef;margin-bottom:35px}.se-breadcrumb__divider,.se-breadcrumb__info,.se-breadcrumb__node{display:inline-block}.se-breadcrumb__info--last{border-bottom:3px solid #0a6ed1;padding-top:10px;padding-bottom:10px}.se-breadcrumb__info--level{display:block;text-transform:uppercase;color:#51555a;font-family:"72",web,"Open Sans",sans-serif;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;font-weight:700}.se-breadcrumb__info--name{display:block;color:#51555a;font-family:"72",web,"Open Sans",sans-serif;font-size:1rem;line-height:1.4285714286;font-weight:400;font-weight:400}.se-breadcrumb__divider{margin-left:15px;margin-right:15px;margin-top:5px;vertical-align:top}.se-breadcrumb__node:last-child .se-breadcrumb__info--level,.se-breadcrumb__node:last-child .se-breadcrumb__info--name{color:#0a6ed1}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});let lo=class BreadcrumbComponent{constructor(e,t,o){this.navigationEditorNodeService=e;this.cmsitemsRestService=t;this.cdr=o}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){if(!this.nodeUid&&!this.nodeUuid){throw new Error("BreadcrumbComponent requires either nodeUid or nodeUuid")}const e=yield this.getUid();const t=yield this.navigationEditorNodeService.getNavigationNodeAncestry(e,this.uriContext);this.breadcrumb=t;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}getUid(){return __awaiter(this,void 0,void 0,(function*(){if(!this.nodeUid){const e=yield this.cmsitemsRestService.getById(this.nodeUuid);return e.uid}return this.nodeUid}))}};lo.$inject=["navigationEditorNodeService","cmsitemsRestService","cdr"];__decorate([s.Input(),__metadata("design:type",String)],lo.prototype,"nodeUid",void 0);__decorate([s.Input(),__metadata("design:type",String)],lo.prototype,"nodeUuid",void 0);__decorate([s.Input(),__metadata("design:type",Object)],lo.prototype,"uriContext",void 0);lo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-breadcrumb",template:`<div class="se-breadcrumb"><div *ngFor="let node of breadcrumb; index as idx; last as isLast" class="se-breadcrumb__node"><div class="se-breadcrumb__info" [ngClass]="{'se-breadcrumb__info--last': isLast}"><span class="se-breadcrumb__info--level">{{ node.formattedLevel | translate: node }}</span> <span class="se-breadcrumb__info--name">{{ node.name }}</span></div><div class="se-breadcrumb__divider" *ngIf="idx < breadcrumb.length - 1"><span class="sap-icon--navigation-right-arrow"></span></div></div></div>`,styles:[`.se-breadcrumb{border-bottom:1px solid #eeeeef;margin-bottom:35px}.se-breadcrumb__divider,.se-breadcrumb__info,.se-breadcrumb__node{display:inline-block}.se-breadcrumb__info--last{border-bottom:3px solid #0a6ed1;padding-top:10px;padding-bottom:10px}.se-breadcrumb__info--level{display:block;text-transform:uppercase;color:#51555a;font-family:"72",web,"Open Sans",sans-serif;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;font-weight:700}.se-breadcrumb__info--name{display:block;color:#51555a;font-family:"72",web,"Open Sans",sans-serif;font-size:1rem;line-height:1.4285714286;font-weight:400;font-weight:400}.se-breadcrumb__divider{margin-left:15px;margin-right:15px;margin-top:5px;vertical-align:top}.se-breadcrumb__node:last-child .se-breadcrumb__info--level,.se-breadcrumb__node:last-child .se-breadcrumb__info--name{color:#0a6ed1}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__metadata("design:paramtypes",[ro,m.CmsitemsRestService,s.ChangeDetectorRef])],lo);const co="selected_node";window.__smartedit__.addDecoratorPayload("Component","NavigationNodePickerRenderComponent",{selector:"se-navigation-node-picker-render",template:`<div class="se-tree-node__name col-xs-6" [title]="node.name | seL10n | async"><span>{{ node.name | seL10n | async }}</span></div><div class="col-sm-4 pull-right tree-node se-navigation-picker-renderer" (click)="pick(node)" *ngIf="isEditable()"><a translate="se.cms.navigationcomponent.management.node.selection.select.action" class="btn btn-link se-navigation-picker-renderer__btn"></a></div>`});let po=class NavigationNodePickerRenderComponent{constructor(e,t){this.parent=e;this.node=t}ngOnInit(){({pick:this.pick,isEditable:this.isEditable}=this.parent.nodeActions)}};po.$inject=["parent","node"];po=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-navigation-node-picker-render",template:`<div class="se-tree-node__name col-xs-6" [title]="node.name | seL10n | async"><span>{{ node.name | seL10n | async }}</span></div><div class="col-sm-4 pull-right tree-node se-navigation-picker-renderer" (click)="pick(node)" *ngIf="isEditable()"><a translate="se.cms.navigationcomponent.management.node.selection.select.action" class="btn btn-link se-navigation-picker-renderer__btn"></a></div>`}),__param(0,s.Inject(s.forwardRef((()=>m.TreeComponent)))),__param(1,s.Inject(m.TREE_NODE)),__metadata("design:paramtypes",[m.TreeComponent,Object])],po);window.__smartedit__.addDecoratorPayload("Component","NavigationNodePickerComponent",{selector:"se-navigation-node-picker",template:`<div class="categoryTable"><div class="tablehead clearfix hidden-xs se-navigation-editor-tree__head"><div translate="se.ytree.template.header.name" class="se-navigation-editor-tree__name col-md-offset-1 col-sm-5"></div></div><se-tree [nodeUri]="nodeURI" [rootNodeUid]="rootNodeUid" [nodeComponent]="nodePickerRenderComponent" [removeDefaultTemplate]="removeDefaultTemplate" [nodeActions]="actions"></se-tree></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let mo=class NavigationNodePickerComponent{constructor(e,t){this.cmsitemsRestService=e;this.systemEventService=t;this.nodePickerRenderComponent=po;this.removeDefaultTemplate=true;this.rootNodeUid=p.NAVIGATION_NODE_ROOT_NODE_UID;this.editable=true}ngOnInit(){this.nodeURI=new m.URIBuilder(p.NAVIGATION_MANAGEMENT_RESOURCE_URI).replaceParams(this.uriContext).build();this.actions={pick:(e,t)=>__awaiter(this,void 0,void 0,(function*(){const e={pageSize:10,currentPage:0,mask:t.uid,typeCode:"CMSNavigationNode",itemSearchParams:""};const o=yield this.cmsitemsRestService.get(e);const n=o.response.find((e=>e.uid===t.uid));const s={nodeUuid:n===null||n===void 0?void 0:n.uuid,nodeUid:t.uid};this.systemEventService.publishAsync(co,s)})),isEditable:()=>this.editable}}};mo.$inject=["cmsitemsRestService","systemEventService"];__decorate([s.Input(),__metadata("design:type",Object)],mo.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],mo.prototype,"editable",void 0);mo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-navigation-node-picker",template:`<div class="categoryTable"><div class="tablehead clearfix hidden-xs se-navigation-editor-tree__head"><div translate="se.ytree.template.header.name" class="se-navigation-editor-tree__name col-md-offset-1 col-sm-5"></div></div><se-tree [nodeUri]="nodeURI" [rootNodeUid]="rootNodeUid" [nodeComponent]="nodePickerRenderComponent" [removeDefaultTemplate]="removeDefaultTemplate" [nodeActions]="actions"></se-tree></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.CmsitemsRestService,m.SystemEventService])],mo);window.__smartedit__.addDecoratorPayload("Component","NavigationNodeSelectorComponent",{selector:"se-navigation-node-selector",template:`<div *ngIf="isReady"><div *ngIf="cmsItem[qualifier]" class="se-navigation-mode"><div class="se-navigation__node"><se-breadcrumb class="se-navigation__node-breadcrumb" [nodeUuid]="cmsItem[qualifier]" [uriContext]="uriContext"></se-breadcrumb><div class="se-navigation__node-button"><button class="btn btn-link btn-block se-navigation__button" (click)="remove($event)" [disabled]="!field.editable" translate="se.cms.navigationcomponent.management.node.selection.remove.action"></button></div></div><se-navigation-editor-tree [uriContext]="uriContext" [readOnly]="true" [rootNodeUid]="nodeUid"></se-navigation-editor-tree></div><div *ngIf="!cmsItem[qualifier]"><label translate="se.cms.navigationcomponent.management.node.selection.invite.action"></label><se-navigation-node-picker [uriContext]="uriContext" [editable]="field.editable"></se-navigation-node-picker></div></div>`,styles:[`.se-navigation__node{display:flex;background-color:#fafafa;padding:0 20px;margin:0 -20px 20px -20px;border-top:1px solid #eeeeef;border-bottom:1px solid #eeeeef}.se-navigation__node-breadcrumb{flex:10}.se-navigation__node-breadcrumb .se-breadcrumb{margin-bottom:0;border:none}.se-navigation__node-button{flex:2;display:flex}.se-navigation__button{font-size:15px;font-family:"72",web,"Open Sans",sans-serif;font-weight:700;align-self:flex-end;text-transform:capitalize}se-navigation-node-selector .se-navigation-editor-tree{margin:0}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});let go=class NavigationNodeSelectorComponent{constructor(e,t,o,n,s){this.data=e;this.catalogService=t;this.cmsitemsRestService=o;this.systemEventService=n;this.cdr=s;this.isReady=false;this.nodeUid=null;this.uriContext=null;({field:this.field,model:this.cmsItem,qualifier:this.qualifier}=this.data)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.retrieveUriContext();this.uriContext=e;if(this.cmsItem[this.qualifier]){const e=yield this.cmsitemsRestService.getById(this.cmsItem[this.qualifier]);this.nodeUid=e.uid;this.isReady=true}else{this.isReady=true}this.unregisterSubscription=this.systemEventService.subscribe(co,((e,{nodeUid:t,nodeUuid:o})=>{this.nodeUid=t;this.cmsItem[this.qualifier]=o;if(!this.cdr.destroyed){this.cdr.detectChanges()}}));if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}ngOnDestroy(){this.unregisterSubscription()}remove(){delete this.cmsItem[this.qualifier];if(!this.cdr.destroyed){this.cdr.detectChanges()}}};go.$inject=["data","catalogService","cmsitemsRestService","systemEventService","cdr"];go=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-navigation-node-selector",template:`<div *ngIf="isReady"><div *ngIf="cmsItem[qualifier]" class="se-navigation-mode"><div class="se-navigation__node"><se-breadcrumb class="se-navigation__node-breadcrumb" [nodeUuid]="cmsItem[qualifier]" [uriContext]="uriContext"></se-breadcrumb><div class="se-navigation__node-button"><button class="btn btn-link btn-block se-navigation__button" (click)="remove($event)" [disabled]="!field.editable" translate="se.cms.navigationcomponent.management.node.selection.remove.action"></button></div></div><se-navigation-editor-tree [uriContext]="uriContext" [readOnly]="true" [rootNodeUid]="nodeUid"></se-navigation-editor-tree></div><div *ngIf="!cmsItem[qualifier]"><label translate="se.cms.navigationcomponent.management.node.selection.invite.action"></label><se-navigation-node-picker [uriContext]="uriContext" [editable]="field.editable"></se-navigation-node-picker></div></div>`,styles:[`.se-navigation__node{display:flex;background-color:#fafafa;padding:0 20px;margin:0 -20px 20px -20px;border-top:1px solid #eeeeef;border-bottom:1px solid #eeeeef}.se-navigation__node-breadcrumb{flex:10}.se-navigation__node-breadcrumb .se-breadcrumb{margin-bottom:0;border:none}.se-navigation__node-button{flex:2;display:flex}.se-navigation__button{font-size:15px;font-family:"72",web,"Open Sans",sans-serif;font-weight:700;align-self:flex-end;text-transform:capitalize}se-navigation-node-selector .se-navigation-editor-tree{margin:0}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,m.ICatalogService,m.CmsitemsRestService,m.SystemEventService,s.ChangeDetectorRef])],go);window.__smartedit__.addDecoratorPayload("Component","NavigationEditorLinkComponent",{selector:"se-navigation-editor-link",template:`\n        <div class="nav-management-link-container">\n            <a\n                class="nav-management-link-item__link se-catalog-version__link"\n                [href]="getLink()"\n                translate="se.cms.cataloginfo.navigationmanagement"\n                (click)="onClick()"\n            ></a>\n        </div>\n    `});let uo=class NavigationEditorLinkComponent{constructor(e,t){this.catalogDetails=e;this.userTrackingService=t}getLink(){const{siteId:e,catalog:{catalogId:t},catalogVersion:{version:o}}=this.catalogDetails;return`#!/${m.NG_ROUTE_PREFIX}/navigations/${e}/${t}/${o}`}onClick(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION,this.catalogDetails.catalogVersion+" - Navigation")}};uo.$inject=["catalogDetails","userTrackingService"];uo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-navigation-editor-link",template:`\n        <div class="nav-management-link-container">\n            <a\n                class="nav-management-link-item__link se-catalog-version__link"\n                [href]="getLink()"\n                translate="se.cms.cataloginfo.navigationmanagement"\n                (click)="onClick()"\n            ></a>\n        </div>\n    `}),__param(0,s.Inject(m.CATALOG_DETAILS_ITEM_DATA)),__metadata("design:paramtypes",[Object,m.UserTrackingService])],uo);window.__smartedit__.addDecoratorPayload("Component","NavigationManagementPageComponent",{selector:"se-navigation-management-page",template:`<div class="se-navigation-management-page-list-template"><div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell se-toolbar--shortcut" imageRoot="imageRoot" toolbarName="smartEditNavigationToolbar"></se-toolbar></div><div class="se-navigation-editor-wrapper" *ngIf="readOnly !== undefined"><div class="se-navigation-editor-header"><h1 class="se-navigation-editor-header__title" translate="se.cms.navigationmanagement.title"></h1><h4 class="se-navigation-editor-header__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</h4></div><se-navigation-editor-tree [uriContext]="uriContext" [readOnly]="readOnly"></se-navigation-editor-tree></div></div>`,styles:[`.se-navigation-editor-wrapper{min-height:100vh;padding:95px 30px 30px 30px;background-color:#edeff0}.se-navigation-editor-header{position:relative;min-height:100%;background-color:#fff;font-family:"72",web,"Open Sans",sans-serif;margin:0 -30px 20px -30px;padding:16px 30px}.se-navigation-editor-header__title{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;color:#32363a;margin:0;padding:0}.se-navigation-editor-header__sub-title{font-size:1rem;line-height:1.4285714286;font-weight:400;color:#6a6d70;margin:0;padding:5px 0 0 0}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let ho=class NavigationManagementPageComponent{constructor(e,t,o,n,s){this.activatedRoute=e;this.urlService=t;this.permissionService=o;this.catalogService=n;this.cdr=s}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const{siteId:e,catalogId:t,catalogVersion:o}=this.activatedRoute.snapshot.params;this.catalogVersion=o;this.uriContext=this.urlService.buildUriContext(e,t,o);yield Promise.all([this.setCatalogName(e,t),this.setReadOnly()]);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}setCatalogName(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.catalogService.getContentCatalogsForSite(e);const n=o.find((e=>e.catalogId===t));this.catalogName=(n===null||n===void 0?void 0:n.name)||{}}))}setReadOnly(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.permissionService.isPermitted([{names:["se.edit.navigation"]}]);this.readOnly=!e}))}};ho.$inject=["activatedRoute","urlService","permissionService","catalogService","cdr"];ho=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-navigation-management-page",template:`<div class="se-navigation-management-page-list-template"><div class="se-toolbar-group"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell se-toolbar--shortcut" imageRoot="imageRoot" toolbarName="smartEditNavigationToolbar"></se-toolbar></div><div class="se-navigation-editor-wrapper" *ngIf="readOnly !== undefined"><div class="se-navigation-editor-header"><h1 class="se-navigation-editor-header__title" translate="se.cms.navigationmanagement.title"></h1><h4 class="se-navigation-editor-header__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</h4></div><se-navigation-editor-tree [uriContext]="uriContext" [readOnly]="readOnly"></se-navigation-editor-tree></div></div>`,styles:[`.se-navigation-editor-wrapper{min-height:100vh;padding:95px 30px 30px 30px;background-color:#edeff0}.se-navigation-editor-header{position:relative;min-height:100%;background-color:#fff;font-family:"72",web,"Open Sans",sans-serif;margin:0 -30px 20px -30px;padding:16px 30px}.se-navigation-editor-header__title{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;color:#32363a;margin:0;padding:0}.se-navigation-editor-header__sub-title{font-size:1rem;line-height:1.4285714286;font-weight:400;color:#6a6d70;margin:0;padding:5px 0 0 0}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[w.ActivatedRoute,m.IUrlService,m.IPermissionService,m.ICatalogService,s.ChangeDetectorRef])],ho);let vo=class NavigationNodeEditorModalService{constructor(e,t){this.genericEditorModalService=e;this.catalogService=t}open(e,t,o){return __awaiter(this,void 0,void 0,(function*(){let n=null;if(!o){const o=yield this.catalogService.getCatalogVersionUUid(e);n={catalogVersion:o,parent:t.uuid,itemtype:p.NAVIGATION_NODE_TYPECODE,visible:true}}return this.genericEditorModalService.open({componentUuid:o?o.uuid:null,componentType:p.NAVIGATION_NODE_TYPECODE,content:n,title:"se.cms.navigationmanagement.node.edit.title"},(e=>e),null,{modalPanelClass:"modal-stretched"})}))}};vo.$inject=["genericEditorModalService","catalogService"];vo=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[t.GenericEditorModalService,m.ICatalogService])],vo);var _o;let fo=_o=class NavigationEditorTreeActions{constructor(e,t,o,n,s,a){this.logService=e;this.cmsitemsRestService=t;this.confirmationModalService=o;this.navigationEditorNodeService=n;this.navigationNodeEditorModalService=s;this.userTrackingService=a}setup(e,t,o){this.readOnly=e;this.rootNodeUid=t;this.uriContext=o}getActions(){return{isReadOnly:()=>this.isReadOnly(),hasChildren:(e,t)=>this.hasChildren(e,t),fetchData:(e,t)=>this.fetchData(e,t),removeItem:(e,t)=>this.removeItem(e,t),performMove:(e,t,o)=>this.performMove(e,t,o),dragAndDrop:(e,t)=>this.dragAndDrop(e,t),moveUp:(e,t)=>this.moveUp(e,t),moveDown:(e,t)=>this.moveDown(e,t),isMoveUpAllowed:(e,t)=>this.isMoveUpAllowed(e,t),isMoveDownAllowed:(e,t)=>this.isMoveDownAllowed(e,t),refreshNode:(e,t)=>this.refreshNode(e,t),refreshParentNode:(e,t)=>this.refreshParentNode(e,t),editNavigationNode:(e,t)=>this.editNavigationNode(e,t),addTopLevelNode:(e,t)=>this.addTopLevelNode(e,t),getEntryString:(e,t)=>this.getEntryString(e,t),getEntryTooltipString:(e,t)=>this.getEntryTooltipString(e,t),addNewChild:(e,t)=>this.addNewChild(e,t),addNewSibling:(e,t)=>this.addNewSibling(e,t),getDropdownItems:e=>this.getDropdownItems(e),_findNodeById:(e,t)=>this._findNodeById(e,t),_expandIfNeeded:(e,t)=>this._expandIfNeeded(e,t)}}getNavigationNodeCMSItemByUid(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.cmsitemsRestService.get({typeCode:p.NAVIGATION_NODE_TYPECODE,pageSize:1,currentPage:0,itemSearchParams:"uid:"+e});return t.response[0]}))}hasNotMoved(e,t,o){return e.position===t&&e.parentUid===o.uid}getEntriesCommaSeparated(e){return e.map((e=>`${e.name} (${e.itemType})`)).join(", ")}isReadOnly(){return this.readOnly}hasChildren(e,t){return t.hasChildren}fetchData(e,t){return __awaiter(this,void 0,void 0,(function*(){if(t.initiated){return t.nodes}if(t.uid===p.NAVIGATION_NODE_ROOT_NODE_UID){t.initiated=false;const e=yield this.getNavigationNodeCMSItemByUid(this.rootNodeUid);u.assign(t,e)}t.removeAllNodes();return e.fetchChildren(t)}))}removeItem(e,t){return __awaiter(this,void 0,void 0,(function*(){if(this.readOnly){throw _o.READY_ONLY_ERROR_I18N}this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Delete");let o=true;try{yield this.confirmationModalService.confirm({description:"se.cms.navigationmanagement.navnode.removenode.confirmation.message",title:"se.cms.navigationmanagement.navnode.removenode.confirmation.title"})}catch(e){o=false}if(o){yield this.cmsitemsRestService.delete(t.uuid);this.refreshParentNode(e,t)}}))}performMove(e,t,o){return __awaiter(this,void 0,void 0,(function*(){if(this.readOnly){throw _o.READY_ONLY_ERROR_I18N}try{yield this.navigationEditorNodeService.updateNavigationNodePosition(t);if(!t){yield this.fetchData(e,e.root)}else if(o){yield this.refreshNode(e,t)}else{yield this.refreshParentNode(e,t)}}catch(e){this.logService.error(`Error updating node position:\n${e}`)}}))}dragAndDrop(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=t.sourceNode;const n=t.destinationNodes;const s=n.find((e=>e.uid!==o.uid));if(!s){return}const a=s.parent;if(this.hasNotMoved(o,t.position,a)){return}o.position=t.position;o.setParent(a);yield this.performMove(e,o,true);if(t.sourceParentNode.uid!==t.destinationParentNode.uid){this.refreshNode(e,t.sourceParentNode)}}))}moveUp(e,t){if(this.readOnly){throw _o.READY_ONLY_ERROR_I18N}this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Move Up");t.position=t.position-1;return this.performMove(e,t)}moveDown(e,t){if(this.readOnly){throw _o.READY_ONLY_ERROR_I18N}this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Move Down");t.position=t.position+1;return this.performMove(e,t)}isMoveUpAllowed(e,t){return t.position!==0}isMoveDownAllowed(e,t){t.parent.nodes=t.parent.nodes||[];return t.position<t.parent.nodes.length-1}refreshNode(e,t){t.setInitiated(false);return e.fetchChildren(t)}refreshParentNode(e,t){return this.refreshNode(e,t.parent)}editNavigationNode(e,t){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Edit");try{yield this.navigationNodeEditorModalService.open(this.uriContext,t.parent,t);yield this.refreshNode(e,t.parent);let o;if(t.parent.uid===p.NAVIGATION_NODE_ROOT_NODE_UID){o=t}else{o=t.parent}const n=yield this.navigationEditorNodeService.getNavigationNode(o.uid,this.uriContext);u.assign(o,n);if(t.parent.uid===p.NAVIGATION_NODE_ROOT_NODE_UID){return this.refreshNode(e,t)}return this.refreshParentNode(e,t)}catch(e){this.logService.warn("navigationNodeEditorModalService closed when editing navigation node")}}))}addTopLevelNode(e,t){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Create Top Level");const o=!!(yield this.addNewChild(e,t));if(o){const t=yield this.getNavigationNodeCMSItemByUid(this.rootNodeUid);yield this.fetchData(e,t)}}))}getEntryString(e,t){return this.getEntriesCommaSeparated(t.entries||[])}getEntryTooltipString(e,t){return["<div>",...(t.entries||[]).map((e=>`<div>${e.name} (${e.itemType})</div>`)),"</div>"].join("")}addNewChild(e,t){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Add a Child");const o=t?t:this._findNodeById(e,this.rootNodeUid);yield this._expandIfNeeded(e,t);try{yield this.navigationNodeEditorModalService.open(this.uriContext,o);return this.refreshNode(e,o)}catch(e){this.logService.warn("navigationNodeEditorModalService closed when adding new child")}}))}addNewSibling(e,t){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.NAVIGATION_MANAGEMENT,"Add a Sibling");const o=t.parent;try{yield this.navigationNodeEditorModalService.open(this.uriContext,o);return this.refreshNode(e,o)}catch(e){this.logService.warn("navigationNodeEditorModalService closed when adding new sibling")}}))}getDropdownItems(e){return[{key:"se.cms.navigationmanagement.navnode.edit",callback:t=>{this.editNavigationNode(e,t)}},{key:"se.cms.navigationmanagement.navnode.removenode",customCss:"se-dropdown-item__delete",callback:t=>{this.removeItem(e,t)}},{key:"se.cms.navigationmanagement.navnode.move.up",condition:t=>this.isMoveUpAllowed(e,t),callback:t=>{this.moveUp(e,t)}},{key:"se.cms.navigationmanagement.navnode.move.down",condition:t=>this.isMoveDownAllowed(e,t),callback:t=>{this.moveDown(e,t)}},{key:"se.cms.navigationmanagement.navnode.addchild",callback:t=>{this.addNewChild(e,t)}},{key:"se.cms.navigationmanagement.navnode.addsibling",callback:t=>{this.addNewSibling(e,t)}}]}_findNodeById(e,t){return e.getNodeById(t)}_expandIfNeeded(e,t){return t&&!t.isExpanded?e.toggle(t):Promise.resolve()}};fo.READY_ONLY_ERROR_I18N="navigation.in.readonly.mode";__decorate([m.InvalidateCache(m.cmsitemsEvictionTag),__metadata("design:type",Function),__metadata("design:paramtypes",[String]),__metadata("design:returntype",Promise)],fo.prototype,"getNavigationNodeCMSItemByUid",null);fo=_o=__decorate([s.Injectable(),__metadata("design:paramtypes",[m.LogService,m.CmsitemsRestService,m.IConfirmationModalService,ro,vo,m.UserTrackingService])],fo);let yo=class NavigationEditorTreeDragOptions{setup(e){this.dragAndDropHandler=e}getDragOptions(){return{onDropCallback:e=>this.onDropCallback(e),allowDropCallback:this.allowDropCallback,beforeDropCallback:this.beforeDropCallback}}onDropCallback(e){this.dragAndDropHandler(e)}allowDropCallback(e){return e.sourceNode.parent.uid===e.destinationNodes[0].parent.uid}beforeDropCallback(e){if(e.sourceNode.parent.uid!==e.destinationNodes[0].parent.uid){return Promise.resolve({confirmDropI18nKey:"se.cms.navigationmanagement.navnode.confirmation"})}return Promise.resolve(true)}};yo=__decorate([s.Injectable()],yo);window.__smartedit__.addDecoratorPayload("Component","NavigationNodeComponent",{selector:"se-navigation-node",template:`<div class="pull-right dropdown tree-node se-tree-node__actions col-sm-1" [hidden]="isReadOnly"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div><div class="se-tree-node__name col-xs-3" [title]="node.name | seL10n | async"><span>{{ node.name | seL10n | async }}</span></div><div class="pull-right tree-node se-tree-node__entry col-xs-5"><se-tooltip class="se-dropdown-item__delete-page-popover" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span se-tooltip-trigger class="se-tree-node__popover"><span>{{ entryString }} </span></span><span se-tooltip-body>{{ entryString }}</span></se-tooltip></div><div class="se-tree-node__title col-xs-2"><span [hidden]="!node.title">{{ node.title | seL10n | async }}</span></div>`,styles:[`se-navigation-node .se-dropdown-item__delete-page-popover,se-navigation-node .se-dropdown-item__delete-page-popover .se-tooltip{max-width:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let So=class NavigationNodeComponent{constructor(e,t){this.parent=e;this.node=t;this.dropdownItems=[]}ngOnInit(){const{getDropdownItems:e,isReadOnly:t,getEntryString:o}=this.parent.nodeActions;this.dropdownItems=e();this.isReadOnly=t();this.entryString=o(this.node)}};So=__decorate([s.Component({selector:"se-navigation-node",template:`<div class="pull-right dropdown tree-node se-tree-node__actions col-sm-1" [hidden]="isReadOnly"><se-dropdown-menu [dropdownItems]="dropdownItems" [selectedItem]="node" class="pull-right se-tree-node__actions--more-menu"></se-dropdown-menu></div><div class="se-tree-node__name col-xs-3" [title]="node.name | seL10n | async"><span>{{ node.name | seL10n | async }}</span></div><div class="pull-right tree-node se-tree-node__entry col-xs-5"><se-tooltip class="se-dropdown-item__delete-page-popover" [triggers]="['mouseenter', 'mouseleave']" [isChevronVisible]="true" [appendTo]="'body'"><span se-tooltip-trigger class="se-tree-node__popover"><span>{{ entryString }} </span></span><span se-tooltip-body>{{ entryString }}</span></se-tooltip></div><div class="se-tree-node__title col-xs-2"><span [hidden]="!node.title">{{ node.title | seL10n | async }}</span></div>`,styles:[`se-navigation-node .se-dropdown-item__delete-page-popover,se-navigation-node .se-dropdown-item__delete-page-popover .se-tooltip{max-width:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(s.forwardRef((()=>m.TreeComponent)))),__param(1,s.Inject(m.TREE_NODE)),__metadata("design:paramtypes",[m.TreeComponent,Object])],So);window.__smartedit__.addDecoratorPayload("Component","NavigationEditorTreeComponent",{selector:"se-navigation-editor-tree",template:`<div class="se-navigation-editor-tree__header" *ngIf="!readOnly"><button class="se-navigation-editor-tree__btn fd-button" (click)="actions.addTopLevelNode()"><span [translate]="'se.cms.navigationmanagement.add.top.level.node'" class="se-navigation-editor-tree__btn--text"></span></button></div><div class="se-navigation-editor-tree categoryTable"><div class="tablehead clearfix hidden-xs se-navigation-editor-tree__head"><div [translate]="'se.ytree.template.header.name'" class="se-navigation-editor-tree__name col-xs-3"></div><div [translate]="'se.ytree.template.header.title'" class="se-navigation-editor-tree__title col-xs-3"></div><div class="col-xs-1 pull-right"></div><div [translate]="'se.ytree.template.header.entry'" class="se-navigation-editor-tree__entry col-xs-5 pull-right"></div></div><se-tree [nodeUri]="nodeURI" [rootNodeUid]="rootNodeUid" [nodeComponent]="nodeComponent" [removeDefaultTemplate]="true" [nodeActions]="actions" [dragOptions]="dragOptions"></se-tree></div>`,styles:[`.se-navigation-editor-tree__header{height:55px;width:100%;border-radius:4px 4px 0 0;background-color:#fff;display:flex;align-items:center;justify-content:flex-end;padding-right:1rem}.se-navigation-editor-tree__name{padding-left:45px}.se-navigation-editor-tree__name.col-md-offset-1{margin-left:0}.se-navigation-editor-tree__title{padding-left:60px}.tablehead.se-navigation-editor-tree__head{border-top:1px solid #eeeeef;background-color:#fafafa;font-size:1rem;line-height:1.4285714286;font-weight:400;font-family:"72",web,"Open Sans",sans-serif;color:#6a6d70;height:40px;padding:10px 0}.fd-modal__body .se-navigation-editor-tree__entry,.modal-dialog .se-navigation-editor-tree__entry{width:155px;padding-left:55px}.fd-modal__body .se-navigation-editor-tree__name,.modal-dialog .se-navigation-editor-tree__name{width:200px}.fd-modal__body .se-navigation-editor-tree__head,.modal-dialog .se-navigation-editor-tree__head{margin:0 -20px 0 -20px;padding-left:20px;padding-right:20px}.se-navigation-editor-tree__btn{margin-right:1rem}`],providers:[yo,fo],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});let Co=class NavigationEditorTreeComponent{constructor(e,t){this.dragOptionsService=e;this.actionsService=t;this.nodeComponent=So}ngOnInit(){this.nodeURI=new m.URIBuilder(p.NAVIGATION_MANAGEMENT_RESOURCE_URI).replaceParams(this.uriContext).build();this.rootNodeUid=this.rootNodeUid||p.NAVIGATION_NODE_ROOT_NODE_UID;this.actionsService.setup(this.readOnly,this.rootNodeUid,this.uriContext);this.actions=this.actionsService.getActions();if(!this.readOnly){this.dragOptionsService.setup((e=>{this.actions.dragAndDrop(e)}));this.dragOptions=this.dragOptionsService.getDragOptions()}}};Co.$inject=["dragOptionsService","actionsService"];__decorate([s.Input(),__metadata("design:type",Object)],Co.prototype,"uriContext",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Co.prototype,"readOnly",void 0);__decorate([s.Input(),__metadata("design:type",String)],Co.prototype,"rootNodeUid",void 0);Co=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-navigation-editor-tree",template:`<div class="se-navigation-editor-tree__header" *ngIf="!readOnly"><button class="se-navigation-editor-tree__btn fd-button" (click)="actions.addTopLevelNode()"><span [translate]="'se.cms.navigationmanagement.add.top.level.node'" class="se-navigation-editor-tree__btn--text"></span></button></div><div class="se-navigation-editor-tree categoryTable"><div class="tablehead clearfix hidden-xs se-navigation-editor-tree__head"><div [translate]="'se.ytree.template.header.name'" class="se-navigation-editor-tree__name col-xs-3"></div><div [translate]="'se.ytree.template.header.title'" class="se-navigation-editor-tree__title col-xs-3"></div><div class="col-xs-1 pull-right"></div><div [translate]="'se.ytree.template.header.entry'" class="se-navigation-editor-tree__entry col-xs-5 pull-right"></div></div><se-tree [nodeUri]="nodeURI" [rootNodeUid]="rootNodeUid" [nodeComponent]="nodeComponent" [removeDefaultTemplate]="true" [nodeActions]="actions" [dragOptions]="dragOptions"></se-tree></div>`,styles:[`.se-navigation-editor-tree__header{height:55px;width:100%;border-radius:4px 4px 0 0;background-color:#fff;display:flex;align-items:center;justify-content:flex-end;padding-right:1rem}.se-navigation-editor-tree__name{padding-left:45px}.se-navigation-editor-tree__name.col-md-offset-1{margin-left:0}.se-navigation-editor-tree__title{padding-left:60px}.tablehead.se-navigation-editor-tree__head{border-top:1px solid #eeeeef;background-color:#fafafa;font-size:1rem;line-height:1.4285714286;font-weight:400;font-family:"72",web,"Open Sans",sans-serif;color:#6a6d70;height:40px;padding:10px 0}.fd-modal__body .se-navigation-editor-tree__entry,.modal-dialog .se-navigation-editor-tree__entry{width:155px;padding-left:55px}.fd-modal__body .se-navigation-editor-tree__name,.modal-dialog .se-navigation-editor-tree__name{width:200px}.fd-modal__body .se-navigation-editor-tree__head,.modal-dialog .se-navigation-editor-tree__head{margin:0 -20px 0 -20px;padding-left:20px;padding-right:20px}.se-navigation-editor-tree__btn{margin-right:1rem}`],providers:[yo,fo],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__metadata("design:paramtypes",[yo,fo])],Co);let bo=class NavigationModule{};bo=__decorate([s.NgModule({imports:[f.CommonModule,m.DropdownMenuModule,m.L10nPipeModule,m.TranslationModule.forChild(),m.NgTreeModule,m.TooltipModule,b.ToolbarModule],declarations:[Co,So,uo,lo,mo,po,go,ho],entryComponents:[Co,So,uo,lo,mo,po,go],exports:[Co],providers:[ao,ro,vo]})],bo);var Io;(function(e){e["content"]="content";e["product"]="product";e["category"]="category";e["external"]="external"})(Io||(Io={}));const wo=[{id:Io.content,structureApiMode:"CONTENT"},{id:Io.product,structureApiMode:"PRODUCT",hasCatalog:true},{id:Io.category,structureApiMode:"CATEGORY",hasCatalog:true},{id:Io.external,structureApiMode:"EXTERNAL"}];window.__smartedit__.addDecoratorPayload("Component","CmsLinkToSelectComponent",{selector:"se-cms-link-to-select",template:`<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="qualifier" [model]="optionModel"></se-generic-editor-dropdown>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let Eo=class CmsLinkToSelectComponent{constructor(e,t,o){this.cdr=e;this.systemEventService=t;this.data=o;({id:this.id,field:this.field,model:this.optionModel,qualifier:this.qualifier}=o)}ngOnInit(){const e=this.getLinkToValue(this.optionModel);if(e!==null){this.optionModel.linkTo=e}this.data.editor.api.considerFormDirty();this.data.editor.api.setAlwaysEnableSubmit(true);const t=`${this.id}${m.LINKED_DROPDOWN}`;this.unRegSelectValueChanged=this.systemEventService.subscribe(t,((e,t)=>this.onLinkToSelectValueChanged(t)))}ngOnDestroy(){this.unRegSelectValueChanged()}onLinkToSelectValueChanged({optionObject:e,qualifier:t}){if(this.qualifier!==t){return}if(!e){return}const o=e.id;const n=wo.find((({id:e})=>e===o));if(!n){throw new Error("Selected option is not supported")}if(o===this.optionModel.currentSelectedOptionValue){return}this.optionModel.currentSelectedOptionValue=o;this.optionModel.external=o!==Io.external;this.clearModel(n);this.systemEventService.publishAsync($,{content:this.optionModel,structureApiMode:n.structureApiMode,editorId:this.id});if(!this.cdr.destroyed){this.cdr.detectChanges()}}getLinkToValue(e){if(e.product){return Io.product}else if(e.contentPage){return Io.content}else if(e.category){return Io.category}else if(e.url||e.linkToggle&&e.linkToggle.urlLink||e.urlLink){return Io.external}return null}clearModel({id:e,hasCatalog:t}){if(e!==Io.category){delete this.optionModel.category}if(e!==Io.product){delete this.optionModel.product}if(!t){delete this.optionModel.productCatalog}if(e!==Io.content){delete this.optionModel.contentPage}if(e!==Io.external){delete this.optionModel.url;delete this.optionModel.urlLink;if(this.optionModel.linkToggle&&this.optionModel.linkToggle.urlLink){delete this.optionModel.linkToggle.urlLink}}}};Eo=__decorate([s.Component({selector:"se-cms-link-to-select",template:`<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="qualifier" [model]="optionModel"></se-generic-editor-dropdown>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(2,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[s.ChangeDetectorRef,m.SystemEventService,Object])],Eo);window.__smartedit__.addDecoratorPayload("Component","InfoPageNameComponent",{selector:"se-info-page-name",template:`<div class="se-page-info__name"><se-homepage-icon *ngIf="field.qualifier === 'name'" [cmsPage]="cmsPage" [uriContext]="uriContext"></se-homepage-icon><div id="{{ field.qualifier }}-homepage" class="se-page-info__name-value fd-form-control" [title]="field.qualifier">{{ model[qualifier] }}</div></div>`,styles:[`.se-page-info__name{display:flex;flex-direction:row;align-items:center}.se-page-info__name-value{word-break:break-all;white-space:normal}`]});let To=class InfoPageNameComponent{constructor(e,t,o){this.catalogService=e;this.pageService=t;({model:this.model,field:this.field,qualifier:this.qualifier}=o)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const[e,t]=yield Promise.all([this.catalogService.retrieveUriContext(),this.pageService.getCurrentPageInfo()]);this.uriContext=e;this.cmsPage=t}))}};To.$inject=["catalogService","pageService","data"];To=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-info-page-name",template:`<div class="se-page-info__name"><se-homepage-icon *ngIf="field.qualifier === 'name'" [cmsPage]="cmsPage" [uriContext]="uriContext"></se-homepage-icon><div id="{{ field.qualifier }}-homepage" class="se-page-info__name-value fd-form-control" [title]="field.qualifier">{{ model[qualifier] }}</div></div>`,styles:[`.se-page-info__name{display:flex;flex-direction:row;align-items:center}.se-page-info__name-value{word-break:break-all;white-space:normal}`]}),__param(2,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[m.ICatalogService,m.IPageService,Object])],To);window.__smartedit__.addDecoratorPayload("Component","LinkToggleComponent",{selector:"se-link-toggle",template:`<div class="se-link-toggle"><div class="se-link-toggle__row"><div class="se-form-control-row se-form-control-row--action"><label class="se-control-label se-link-toggle__label" for="external-link"><input class="fd-form__control se-link-toggle__input" id="external-link" name="linktoggle" type="radio" [(ngModel)]="model.linkToggle.external" (ngModelChange)="clearUrlLink()" [value]="true"/> {{ 'se.editor.linkto.external.label' | translate}}</label></div><div class="se-form-control-row se-form-control-row--action"><label class="se-control-label se-link-toggle__label" for="internal-link"><input class="fd-form__control se-link-toggle__input" id="internal-link" name="linktoggle" type="radio" [(ngModel)]="model.linkToggle.external" (ngModelChange)="clearUrlLink()" [value]="false"/> {{ 'se.editor.linkto.internal.label' | translate}}</label></div></div><input class="fd-form-control" id="urlLink" name="urlLink" type="text" [(ngModel)]="model.linkToggle.urlLink" (ngModelChange)="checkUrlLink()" [ngClass]="{ 'has-error': field.hasErrors }"/></div>`,styles:[`.se-link-toggle__row{display:flex;flex-direction:row;align-items:center}.se-form-control-row{margin-right:16px}.se-control-label.se-link-toggle__label{display:flex;flex-direction:row;align-items:center;margin:0}.fd-form__control.se-link-toggle__input{margin:0 4px 0 0}`]});let Po=class LinkToggleComponent{constructor(e){({field:this.field,model:this.model}=e);if(!this.model.linkToggle){this.model.linkToggle={}}if(this.model.linkToggle.external===undefined){this.model.linkToggle.external=true}}clearUrlLink(){this.model.linkToggle.urlLink=null}checkUrlLink(){if(this.model.linkToggle.urlLink===""){this.model.linkToggle.urlLink=null}}};Po=__decorate([s.Component({selector:"se-link-toggle",template:`<div class="se-link-toggle"><div class="se-link-toggle__row"><div class="se-form-control-row se-form-control-row--action"><label class="se-control-label se-link-toggle__label" for="external-link"><input class="fd-form__control se-link-toggle__input" id="external-link" name="linktoggle" type="radio" [(ngModel)]="model.linkToggle.external" (ngModelChange)="clearUrlLink()" [value]="true"/> {{ 'se.editor.linkto.external.label' | translate}}</label></div><div class="se-form-control-row se-form-control-row--action"><label class="se-control-label se-link-toggle__label" for="internal-link"><input class="fd-form__control se-link-toggle__input" id="internal-link" name="linktoggle" type="radio" [(ngModel)]="model.linkToggle.external" (ngModelChange)="clearUrlLink()" [value]="false"/> {{ 'se.editor.linkto.internal.label' | translate}}</label></div></div><input class="fd-form-control" id="urlLink" name="urlLink" type="text" [(ngModel)]="model.linkToggle.urlLink" (ngModelChange)="checkUrlLink()" [ngClass]="{ 'has-error': field.hasErrors }"/></div>`,styles:[`.se-link-toggle__row{display:flex;flex-direction:row;align-items:center}.se-form-control-row{margin-right:16px}.se-control-label.se-link-toggle__label{display:flex;flex-direction:row;align-items:center;margin:0}.fd-form__control.se-link-toggle__input{margin:0 4px 0 0}`]}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object])],Po);var Ao;(function(e){e["disabled"]="disabled"})(Ao||(Ao={}));window.__smartedit__.addDecoratorPayload("Component","MediaActionLabelComponent",{selector:"se-media-action-label",template:`<span class="se-media-action-label" [ngClass]="{ 'se-media-action-label--disabled': state === 'disabled' }" [translate]="i18nKey"></span>`,styles:[`.se-media-action-label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;color:#0a6ed1}.se-media-action-label--disabled{color:#6a6d70}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Oo=class MediaActionLabelComponent{};__decorate([s.Input(),__metadata("design:type",String)],Oo.prototype,"i18nKey",void 0);__decorate([s.Input(),__metadata("design:type",String)],Oo.prototype,"state",void 0);Oo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-action-label",template:`<span class="se-media-action-label" [ngClass]="{ 'se-media-action-label--disabled': state === 'disabled' }" [translate]="i18nKey"></span>`,styles:[`.se-media-action-label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;color:#0a6ed1}.se-media-action-label--disabled{color:#6a6d70}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],Oo);let xo=class MediaUploaderService{constructor(e){this.restServiceFactory=e;this.mediaRestService=this.restServiceFactory.get(m.MEDIA_RESOURCE_URI)}uploadMedia(e){var t;const o=new FormData;u.forEach(e,((e,t)=>{o.append(t,e)}));return this.mediaRestService.save(o,{headers:{enctype:"multipart/form-data",fileSize:""+((t=e===null||e===void 0?void 0:e.file)===null||t===void 0?void 0:t.size)}})}};xo.$inject=["restServiceFactory"];xo=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],xo);let Do=class MediaService{constructor(e){this.restServiceFactory=e}getPage(e,t,o,n){return __awaiter(this,void 0,void 0,(function*(){const s={catalogId:m.CONTEXT_CATALOG,catalogVersion:m.CONTEXT_CATALOG_VERSION};const a=this.contextParamsToCommaSeparated(s);const r={mask:e,params:a,pageSize:t,currentPage:o,mimeType:n};const d=yield this.restServiceFactory.get(m.MEDIAS_PATH).get(r);const p={results:[],pagination:d.pagination};p.results=d.media.map((e=>this.mediaDTOtoMedia(e)));return p}))}getMedia(e){return __awaiter(this,void 0,void 0,(function*(){const t=`${m.MEDIA_PATH}/${e}`;const o=yield this.restServiceFactory.get(t).get();return this.mediaDTOtoMedia(o)}))}contextParamsToCommaSeparated(e){return Object.keys(e).reduce(((t,o)=>{t+=`,${o}:${e[o]}`;return t}),"").substring(1)}mediaDTOtoMedia({uuid:e,code:t,description:o,altText:n,url:s,downloadUrl:a,mime:r}){return{id:e,code:t,description:o,altText:n,url:s,downloadUrl:a,mime:r}}};Do.$inject=["restServiceFactory"];Do=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory])],Do);let Ro=class MediaBackendValidationHandler{handleResponse(e,t){var o;t=t||[];if((o=e===null||e===void 0?void 0:e.error)===null||o===void 0?void 0:o.errors){e.error.errors.filter((e=>this.isValidationError(e))).forEach((({subject:e,message:o})=>{if(e){t.push({subject:e,message:o})}}));e.error.errors.filter((e=>this.isMediaFolderError(e))).forEach((({type:e,message:o})=>{t.push({subject:"folder",message:o})}));e.error.errors.filter((e=>this.isUploadSizeError(e))).forEach((()=>{t.push({subject:"code",message:"se.max.upload.size.exceeded.error"})}))}return t}isValidationError(e){return e.type==="ValidationError"}isUploadSizeError(e){return e.type==="MaxUploadSizeExceededError"}isMediaFolderError(e){return e.type==="UnknownIdentifierError"||e.type==="AmbiguousIdentifierException"}};Ro=__decorate([m.SeDowngradeService()],Ro);let ko=class MediaFolderService{constructor(e,t){this.restServiceFactory=e;this.settingsService=t;this.mediaFolderListService=this.restServiceFactory.get(m.MEDIA_FOLDER_PATH);this._mediaFolderFetchStrategy={fetchPage:(e,t,o)=>__awaiter(this,void 0,void 0,(function*(){return this.mediaFoldersFetchPage(e,t,o)})),fetchEntity:e=>__awaiter(this,void 0,void 0,(function*(){return Promise.resolve({id:e,name:e,qualifier:e})}))}}get mediaFoldersFetchStrategy(){return this._mediaFolderFetchStrategy}getDefaultFolder(){return __awaiter(this,void 0,void 0,(function*(){const{error:e,data:t}=yield m.promiseUtils.attempt(this.settingsService.get("smartedit.mediaUploadDefaultFolder"));if(e){return Promise.resolve("")}return t}))}getMediaFolders(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.mediaFolderListService.get({mask:e.mask,pageSize:e.pageSize,currentPage:e.currentPage});return t}))}mediaFoldersFetchPage(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const{mediaFolders:n,pagination:s}=yield this.getMediaFolders({mask:e,pageSize:t,currentPage:o});const a=n.map((e=>Object.assign(Object.assign({},e),{id:e.qualifier,name:e.qualifier})));return{pagination:s,results:a}}))}};ko.$inject=["restServiceFactory","settingsService"];__decorate([m.Cached({actions:[m.frequentlyChangingContent],tags:[m.userEvictionTag,m.perspectiveChangedEvictionTag,m.pageChangeEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],ko.prototype,"getMediaFolders",null);ko=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.RestServiceFactory,m.ISettingsService])],ko);let Mo=class MediaUtilService{getAcceptedFileTypes(e){const t=e||m.GenericEditorMediaType.DEFAULT;switch(t){case m.GenericEditorMediaType.IMAGE:return m.FILE_VALIDATION_CONFIG.ACCEPTED_FILE_TYPES.IMAGE;case m.GenericEditorMediaType.VIDEO:return m.FILE_VALIDATION_CONFIG.ACCEPTED_FILE_TYPES.VIDEO;case m.GenericEditorMediaType.PDF_DOCUMENT:return m.FILE_VALIDATION_CONFIG.ACCEPTED_FILE_TYPES.PDF_DOCUMENT;default:return m.FILE_VALIDATION_CONFIG.ACCEPTED_FILE_TYPES.DEFAULT}}};Mo=__decorate([m.SeDowngradeService()],Mo);const No="video";const Fo="mp4";window.__smartedit__.addDecoratorPayload("Component","MediaComponent",{selector:"se-media",template:`<div class="se-media"><se-media-selector *ngIf="!image" [id]="mediaSelectorId" [isDisabled]="isFieldDisabled" [mediaId]="mediaIdByLang[lang]" [mimeType]="field.allowMediaType" (mediaIdChange)="onMediaIdChange($event)"></se-media-selector><se-media-file-selector *ngIf="canShowFileSelector()" [labelI18nKey]="'se.upload.image.to.library'" [acceptedFileTypes]="acceptedFileTypes" [selectionMode]="'upload'" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelect($event)"></se-media-file-selector><se-media-upload-form *ngIf="image" class="se-media-upload-form-wrapper" [image]="image" [allowMediaType]="field.allowMediaType" [maxUploadFileSize]="maxUploadFileSize" (onCancel)="resetImage()" (onSelect)="onFileSelect($event)" (onUploadSuccess)="onMediaUploaded($event)"></se-media-upload-form><se-message *ngIf="previewMessage" [type]="'warning'"><ng-container se-message-description>{{ 'se.upload.video.cant.preview' | translate }}</ng-container></se-message><se-media-errors *ngIf="fileErrors.length > 0" [errors]="fileErrors" [maxUploadFileSize]="maxUploadFileSize"></se-media-errors></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let zo=class MediaComponent{constructor(e,t,o,n,s,a,r){this.cdr=e;this.fileValidationService=t;this.logService=o;this.mediaUtilService=n;this.mediaService=s;this.sharedDataService=a;this.previewMessage=false;({field:this.field,model:this.mediaIdByLang,qualifier:this.lang}=r);this.acceptedFileTypes=this.mediaUtilService.getAcceptedFileTypes(this.field.allowMediaType);this.fileErrors=[];this.image=null;this.isFieldDisabled=r.isFieldDisabled();this.mediaSelectorId=this.field.qualifier;this.field.allowMediaType=this.field.allowMediaType||m.GenericEditorMediaType.DEFAULT}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){if(this.mediaIdByLang[this.lang]){yield this.checkMediaPreview(this.mediaIdByLang[this.lang])}const e=yield this.sharedDataService.get(Y);this.maxUploadFileSize=e&&typeof e==="number"?e:m.FILE_VALIDATION_CONFIG.DEFAULT_MAX_UPLOAD_FILE_SIZE}))}onMediaIdChange(e){return __awaiter(this,void 0,void 0,(function*(){this.fileErrors=[];this.previewMessage=false;this.mediaIdByLang[this.lang]=e;if(e){yield this.checkMediaPreview(e)}}))}onFileSelect(e){return __awaiter(this,void 0,void 0,(function*(){this.mediaIdByLang[this.lang]=undefined;this.resetImage();const t=e[0];try{yield this.fileValidationService.validate(t,this.maxUploadFileSize,this.fileErrors);this.image=t}catch(e){this.logService.warn("Invalid file")}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}onMediaUploaded(e){return __awaiter(this,void 0,void 0,(function*(){this.resetImage();yield this.onMediaIdChange(e);if(this.field.initiated){this.field.initiated.length=0}}))}resetImage(){this.fileErrors=[];this.image=null}canShowFileSelector(){return this.mediaIdByLang&&!this.mediaIdByLang[this.lang]&&!this.image}canVideoPreview(e){if(e&&e.includes(No)&&e.indexOf(Fo)===-1){this.previewMessage=true}}checkMediaPreview(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.mediaService.getMedia(e);this.canVideoPreview(t===null||t===void 0?void 0:t.mime);if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};zo=__decorate([s.Component({selector:"se-media",template:`<div class="se-media"><se-media-selector *ngIf="!image" [id]="mediaSelectorId" [isDisabled]="isFieldDisabled" [mediaId]="mediaIdByLang[lang]" [mimeType]="field.allowMediaType" (mediaIdChange)="onMediaIdChange($event)"></se-media-selector><se-media-file-selector *ngIf="canShowFileSelector()" [labelI18nKey]="'se.upload.image.to.library'" [acceptedFileTypes]="acceptedFileTypes" [selectionMode]="'upload'" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelect($event)"></se-media-file-selector><se-media-upload-form *ngIf="image" class="se-media-upload-form-wrapper" [image]="image" [allowMediaType]="field.allowMediaType" [maxUploadFileSize]="maxUploadFileSize" (onCancel)="resetImage()" (onSelect)="onFileSelect($event)" (onUploadSuccess)="onMediaUploaded($event)"></se-media-upload-form><se-message *ngIf="previewMessage" [type]="'warning'"><ng-container se-message-description>{{ 'se.upload.video.cant.preview' | translate }}</ng-container></se-message><se-media-errors *ngIf="fileErrors.length > 0" [errors]="fileErrors" [maxUploadFileSize]="maxUploadFileSize"></se-media-errors></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(6,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[s.ChangeDetectorRef,m.IFileValidation,m.LogService,Mo,Do,m.ISharedDataService,Object])],zo);const Lo="clone_";var Vo;(function(e){e["widescreen"]="widescreen";e["desktop"]="desktop";e["tablet"]="tablet";e["mobile"]="mobile"})(Vo||(Vo={}));window.__smartedit__.addDecoratorPayload("Component","MediaContainerComponent",{selector:"se-media-container",template:`<div *ngIf="hasReadPermissionOnMediaRelatedTypes && advancedMediaContainerManagementEnabled"><se-media-container-selector [eventNameAffix]="selectorEventNameAffix" [isAdvancedCloning]="isAdvancedCloning()" [initialName]="initialMediaContainerName" [name]="getMediaContainerName()" [isEditable]="field.editable" (nameChange)="onMediaContainerNameChange($event)" (onCreate)="onMediaContainerCreate($event)" (onRemove)="onMediaContainerRemove()" (onSelect)="setMediaContainer($event)" (onCreationInProgressChange)="onMediaContainerCreationInProgressChange($event)"></se-media-container-selector></div><div class="se-media-container-field" *ngIf="canShowMediaFormatWithUploadForm()"><div class="se-media-container-field__media-list"><se-media-format class="se-media-container-cell" *ngFor="let format of field.options" [ngClass]="getMediaContainerCellClassName(format.id)" [errorMessages]="field.messages" [isEditable]="field.editable" [isUnderEdit]="isMediaFormatUnderEdit(format.id)" [isFieldDisabled]="isFieldDisabled()" [mediaUuid]="model[lang]?.medias[format.id]" [mediaFormat]="format.id" [mediaLabel]="format.label" [allowMediaType]="field.allowMediaType" (onFileSelect)="onFileSelect($event, format.id)" (onDelete)="removeMediaByFormat(format.id)"></se-media-format></div><se-media-upload-form *ngIf="image" class="se-media-upload-form-wrapper se-media-upload-form-wrapper--spaced" [image]="image.file" [allowMediaType]="field.allowMediaType" [maxUploadFileSize]="maxUploadFileSize" (onCancel)="resetImage()" (onSelect)="onFileSelect($event)" (onUploadSuccess)="onFileUploadSuccess($event, image.format)"></se-media-upload-form><se-media-errors [errors]="fileValidationErrors" [maxUploadFileSize]="maxUploadFileSize"></se-media-errors></div><div *ngIf="!hasReadPermissionOnMediaRelatedTypes"><span translate="se.cms.media.typepermissions.error" [translateParams]="{ containedTypes: field.containedTypes }"></span></div>`});let Uo=class MediaContainerComponent{constructor(e,t,o,n,s,a,r){this.systemEventService=e;this.logService=t;this.typePermissionsRestService=o;this.loadConfigManagerService=n;this.fileValidationService=s;this.sharedDataService=a;this.sessionStorage=window.sessionStorage;({field:this.field,model:this.model,editor:this.editor,qualifier:this.lang,isFieldDisabled:this.isFieldDisabled}=r);this.selectorEventNameAffix=`${this.field.qualifier}_${this.lang}`;if(this.field.dependsOnField){this.field.hideFieldWidget=true;const e=`${this.editor.id}${this.field.dependsOnField}${m.CLICK_DROPDOWN}`;this.unRegDependsOnValueChanged=this.systemEventService.subscribe(e,((e,t)=>this.onDependsOnValueChanged(t)))}}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){if(!this.model[this.lang]){this.setMediaContainer({catalogVersion:undefined,medias:{},qualifier:undefined,mediaContainerUuid:undefined})}const e=yield this.sharedDataService.get(Y);this.maxUploadFileSize=e&&typeof e==="number"?e:m.FILE_VALIDATION_CONFIG.DEFAULT_MAX_UPLOAD_FILE_SIZE;yield this.initHasReadPermissionOnMediaRelatedTypes();yield this.initAdvancedMediaContainerManagementEnabled();this.initialMediaContainerNameKey=`${this.editor.id}_InitialMediaContainerName_${this.lang}`;this.resetModelForClone();this.getInitialMediaContainerName()}))}getMediaContainerName(){var e;return((e=this.model[this.lang])===null||e===void 0?void 0:e.qualifier)||""}getInitialMediaContainerName(){var e,t;if(!!this.editor.initialContent.cloneComponent){const t=this.sessionStorage.getItem(this.initialMediaContainerNameKey);this.initialMediaContainerName=t||((e=this.model[this.lang])===null||e===void 0?void 0:e.qualifier)||""}else{this.initialMediaContainerName=((t=this.model[this.lang])===null||t===void 0?void 0:t.qualifier)||""}}getMediaContainerCellClassName(e){return`se-media-container-cell--${e}`}setMediaContainer(e){this.model[this.lang]=e}canShowMediaFormatWithUploadForm(){return this.hasReadPermissionOnMediaRelatedTypes&&(this.isMediaContainerSelected()||this.mediaContainerCreationInProgress||!this.advancedMediaContainerManagementEnabled)}isMediaFormatUnderEdit(e){var t;return e===((t=this.image)===null||t===void 0?void 0:t.format)}onFileSelect(e,t){var o;return __awaiter(this,void 0,void 0,(function*(){const n=t||((o=this.image)===null||o===void 0?void 0:o.format);this.resetImage();try{const t=e[0];yield this.fileValidationService.validate(t,this.maxUploadFileSize,this.fileValidationErrors);this.image={file:t,format:n}}catch(e){this.logService.warn("Invalid file")}}))}onFileUploadSuccess(e,t){this.setMediaUuidForFormat(e,t);this.resetErrors();this.resetImage()}resetErrors(){if(this.field.hasErrors){this.field.hasErrors=false;this.field.messages=[];const e=this.editor.form.group.controls;for(const t of Object.keys(e)){e[t].updateValueAndValidity()}}}onMediaContainerCreate(e){this.clearModel();this.onMediaContainerNameChange(e);this.model[this.lang].medias={}}onMediaContainerRemove(){this.clearModel()}onMediaContainerNameChange(e){this.model[this.lang].qualifier=e}onMediaContainerCreationInProgressChange(e){this.mediaContainerCreationInProgress=e}removeMediaByFormat(e){delete this.model[this.lang].medias[e]}isAdvancedCloning(){return!!this.editor.initialContent.cloneComponent}onDependsOnValueChanged(e){this.field.hideFieldWidget=e!==this.field.dependsOnValue;if(this.field.hideFieldWidget){if(this.model[this.lang]){this.setMediaContainer({catalogVersion:undefined,medias:{},qualifier:undefined,mediaContainerUuid:undefined})}const e=`mediaContainer_${this.selectorEventNameAffix}_${K}`;this.systemEventService.publishAsync(e)}}initAdvancedMediaContainerManagementEnabled(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.loadConfigManagerService.loadAsObject();this.advancedMediaContainerManagementEnabled=e.advancedMediaContainerManagement||false}))}initHasReadPermissionOnMediaRelatedTypes(){return __awaiter(this,void 0,void 0,(function*(){try{const e=yield this.typePermissionsRestService.hasAllPermissionsForTypes(this.field.containedTypes);this.hasReadPermissionOnMediaRelatedTypes=this.field.containedTypes.every((t=>e[t].read))}catch(e){this.hasReadPermissionOnMediaRelatedTypes=false;this.logService.warn("Failed to retrieve type permissions",e)}}))}setMediaUuidForFormat(e,t){this.model[this.lang].medias[t]=e}isMediaContainerSelected(){return!u.isEmpty(this.model[this.lang])}resetImage(){this.fileValidationErrors=[];this.image=null}clearModel(){Object.keys(this.model[this.lang]).forEach((e=>delete this.model[this.lang][e]))}resetModelForClone(){if(!!this.editor.initialContent.cloneComponent){if(this.model[this.lang]&&this.model[this.lang].mediaContainerUuid&&this.model[this.lang].qualifier){this.sessionStorage.setItem(this.initialMediaContainerNameKey,this.model[this.lang].qualifier);const e=`${Lo}${this.model[this.lang].qualifier.trim()}_${Date.now().toString().substr(7,10)}`;this.onMediaContainerNameChange(e);delete this.model[this.lang].mediaContainerUuid;delete this.model[this.lang].catalogVersion}}}};Uo.$inject=["systemEventService","logService","typePermissionsRestService","loadConfigManagerService","fileValidationService","sharedDataService","data"];Uo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-container",template:`<div *ngIf="hasReadPermissionOnMediaRelatedTypes && advancedMediaContainerManagementEnabled"><se-media-container-selector [eventNameAffix]="selectorEventNameAffix" [isAdvancedCloning]="isAdvancedCloning()" [initialName]="initialMediaContainerName" [name]="getMediaContainerName()" [isEditable]="field.editable" (nameChange)="onMediaContainerNameChange($event)" (onCreate)="onMediaContainerCreate($event)" (onRemove)="onMediaContainerRemove()" (onSelect)="setMediaContainer($event)" (onCreationInProgressChange)="onMediaContainerCreationInProgressChange($event)"></se-media-container-selector></div><div class="se-media-container-field" *ngIf="canShowMediaFormatWithUploadForm()"><div class="se-media-container-field__media-list"><se-media-format class="se-media-container-cell" *ngFor="let format of field.options" [ngClass]="getMediaContainerCellClassName(format.id)" [errorMessages]="field.messages" [isEditable]="field.editable" [isUnderEdit]="isMediaFormatUnderEdit(format.id)" [isFieldDisabled]="isFieldDisabled()" [mediaUuid]="model[lang]?.medias[format.id]" [mediaFormat]="format.id" [mediaLabel]="format.label" [allowMediaType]="field.allowMediaType" (onFileSelect)="onFileSelect($event, format.id)" (onDelete)="removeMediaByFormat(format.id)"></se-media-format></div><se-media-upload-form *ngIf="image" class="se-media-upload-form-wrapper se-media-upload-form-wrapper--spaced" [image]="image.file" [allowMediaType]="field.allowMediaType" [maxUploadFileSize]="maxUploadFileSize" (onCancel)="resetImage()" (onSelect)="onFileSelect($event)" (onUploadSuccess)="onFileUploadSuccess($event, image.format)"></se-media-upload-form><se-media-errors [errors]="fileValidationErrors" [maxUploadFileSize]="maxUploadFileSize"></se-media-errors></div><div *ngIf="!hasReadPermissionOnMediaRelatedTypes"><span translate="se.cms.media.typepermissions.error" [translateParams]="{ containedTypes: field.containedTypes }"></span></div>`}),__param(6,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[m.SystemEventService,m.LogService,p.TypePermissionsRestService,b.LoadConfigManagerService,m.IFileValidation,m.ISharedDataService,Object])],Uo);const jo=`${p.IMAGES_URL}/image_placeholder.png`;window.__smartedit__.addDecoratorPayload("Component","MediaContainerSelectorItemComponent",{selector:"se-media-container-selector-item",template:`<div class="media-container-selector-item__row"><img class="media-container-selector-item__img" [ngClass]="{ 'media-container-selector-item__img--selected': isSelected }" [src]="getThumbnailUrl(item.thumbnailUrl)"/><div class="media-container-selector-item__label">{{ item.qualifier }}</div></div>`,styles:[`.media-container-selector-item__row{display:grid;grid-template-columns:2fr 4fr;grid-column-gap:12px;width:100%;align-items:center;padding:0 8px}.media-container-selector-item__img{max-width:90%;max-height:100%;margin:12px}.media-container-selector-item__img--selected{max-width:35%;height:30px;margin:0}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let $o=class MediaContainerSelectorItemComponent{constructor(e){({item:this.item,selected:this.isSelected}=e)}getThumbnailUrl(e){return e||jo}};$o=__decorate([s.Component({selector:"se-media-container-selector-item",template:`<div class="media-container-selector-item__row"><img class="media-container-selector-item__img" [ngClass]="{ 'media-container-selector-item__img--selected': isSelected }" [src]="getThumbnailUrl(item.thumbnailUrl)"/><div class="media-container-selector-item__label">{{ item.qualifier }}</div></div>`,styles:[`.media-container-selector-item__row{display:grid;grid-template-columns:2fr 4fr;grid-column-gap:12px;width:100%;align-items:center;padding:0 8px}.media-container-selector-item__img{max-width:90%;max-height:100%;margin:12px}.media-container-selector-item__img--selected{max-width:35%;height:30px;margin:0}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],$o);const Bo="/cmswebservices/v1/catalogs/CURRENT_CONTEXT_CATALOG/versions/CURRENT_CONTEXT_CATALOG_VERSION/mediacontainers";const Go="mediaContainer";window.__smartedit__.addDecoratorPayload("Component","MediaContainerSelectorComponent",{selector:"se-media-container-selector",template:`<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="field.qualifier" [model]="mediaContainerNameModel" [showRemoveButton]="true" [itemComponent]="itemComponent" [actionableSearchItem]="actionableSearchItem" [(reset)]="reset"></se-generic-editor-dropdown><div *ngIf="isSelected() || creationInProgress"><label [for]="'media-container-qualifier-' + id" class="se-control-label required se-media-container-name-label">{{ 'se.cms.media.responsive.name' | lowercase | translate }}</label> <input type="text" name="media-container-qualifier" [id]="'media-container-qualifier-' + id" class="fd-form-control" [ngModel]="name" (ngModelChange)="onNameChange($event)" [readOnly]="isNameReadOnly()" [disabled]="!field.editable"/></div>`,styles:[`se-media-container-selector .se-media-container-name-label{margin-top:9px}se-media-container-selector .se-generic-editor-dropdown .se-item-printer{width:100%}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});let Ho=class MediaContainerSelectorComponent{constructor(e,t){this.cdr=e;this.systemEventService=t;this.nameChange=new s.EventEmitter;this.onCreate=new s.EventEmitter;this.onRemove=new s.EventEmitter;this.onSelect=new s.EventEmitter;this.onCreationInProgressChange=new s.EventEmitter;this.field={cmsStructureType:"EditableDropdown",qualifier:Go,required:true,uri:Bo,idAttribute:"qualifier",editable:true,paged:true};this.creationInProgress=false;this.itemComponent=$o}ngOnInit(){this.id=`${Go}_${this.eventNameAffix}`;this.field.editable=this.isEditable;this.mediaContainerNameModel={[Go]:this.initialName};const e=`${this.id}${m.LINKED_DROPDOWN}`;this.unRegSelectMediaContainer=this.systemEventService.subscribe(e,((e,t)=>this.onSelectItem(t)));const t=`${this.id}_${K}`;this.unRegClearSelectMediaContainer=this.systemEventService.subscribe(t,((e,t)=>this.clearSelectOption()));const o=`CREATE_MEDIA_CONTAINER_BUTTON_PRESSED_EVENT_${this.eventNameAffix}`;this.actionableSearchItem={eventId:o};this.unRegCreateMediaContainer=this.systemEventService.subscribe(o,((e,t)=>this.onCreateMediaContainer(t)))}ngOnDestroy(){this.unRegSelectMediaContainer();this.unRegCreateMediaContainer();this.unRegClearSelectMediaContainer()}onNameChange(e){this.nameChange.emit(e)}isNameReadOnly(){return!this.isAdvancedCloning&&!this.creationInProgress&&this.isSelected()}isSelected(){return!!this.mediaContainerNameModel[Go]}onSelectItem({optionObject:e}){this.setCreationInProgressAndEmit(false);if(!this.mediaContainerNameModel.mediaContainer){this.onSelect.emit({catalogVersion:undefined,medias:{},qualifier:undefined,mediaContainerUuid:undefined});this.onRemove.emit()}else if(!!e){this.onSelect.emit(e)}if(!this.cdr.destroyed){this.cdr.detectChanges()}}onCreateMediaContainer(e){this.clearSelectOption();this.setCreationInProgressAndEmit(true);this.onCreate.emit(e);if(!this.cdr.destroyed){this.cdr.detectChanges()}}setCreationInProgressAndEmit(e){this.creationInProgress=e;this.onCreationInProgressChange.emit(e)}clearSelectOption(){this.initialName=undefined;this.resetSelector()}resetSelector(){if(typeof this.reset==="function"){this.reset(true)}}};__decorate([s.Input(),__metadata("design:type",String)],Ho.prototype,"eventNameAffix",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Ho.prototype,"isAdvancedCloning",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ho.prototype,"name",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ho.prototype,"initialName",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Ho.prototype,"isEditable",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ho.prototype,"nameChange",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ho.prototype,"onCreate",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ho.prototype,"onRemove",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ho.prototype,"onSelect",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ho.prototype,"onCreationInProgressChange",void 0);Ho=__decorate([s.Component({selector:"se-media-container-selector",template:`<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="field.qualifier" [model]="mediaContainerNameModel" [showRemoveButton]="true" [itemComponent]="itemComponent" [actionableSearchItem]="actionableSearchItem" [(reset)]="reset"></se-generic-editor-dropdown><div *ngIf="isSelected() || creationInProgress"><label [for]="'media-container-qualifier-' + id" class="se-control-label required se-media-container-name-label">{{ 'se.cms.media.responsive.name' | lowercase | translate }}</label> <input type="text" name="media-container-qualifier" [id]="'media-container-qualifier-' + id" class="fd-form-control" [ngModel]="name" (ngModelChange)="onNameChange($event)" [readOnly]="isNameReadOnly()" [disabled]="!field.editable"/></div>`,styles:[`se-media-container-selector .se-media-container-name-label{margin-top:9px}se-media-container-selector .se-generic-editor-dropdown .se-item-printer{width:100%}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__metadata("design:paramtypes",[s.ChangeDetectorRef,m.SystemEventService])],Ho);window.__smartedit__.addDecoratorPayload("Component","MediaErrorsComponent",{selector:"se-media-errors",template:`<div class="se-media-error field-errors"><div *ngFor="let error of errors">{{ error.message | translate: { sizeLimitationOfFile: maxUploadFileSize } }}</div></div>`,styles:[`.se-media-error{color:#b00!important}`]});let Wo=class MediaErrorsComponent{};__decorate([s.Input(),__metadata("design:type",Array)],Wo.prototype,"errors",void 0);__decorate([s.Input(),__metadata("design:type",Number)],Wo.prototype,"maxUploadFileSize",void 0);Wo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-errors",template:`<div class="se-media-error field-errors"><div *ngFor="let error of errors">{{ error.message | translate: { sizeLimitationOfFile: maxUploadFileSize } }}</div></div>`,styles:[`.se-media-error{color:#b00!important}`]})],Wo);window.__smartedit__.addDecoratorPayload("Component","MediaFormatComponent",{selector:"se-media-format",template:`<div class="se-media-format" [ngClass]="mediaFormat"><div *ngIf="mediaLabel" class="se-media-format__screen-type" [translate]="mediaFormatI18nKey"></div><se-media-format-uploaded *ngIf="isMediaPreviewEnabled()" [media]="media" [replaceLabelI18nKey]="mediaSelectorI18nKeys.REPLACE" [acceptedFileTypes]="acceptedFileTypes" [isFieldDisabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)" (onDelete)="onRemoveButtonClick()"></se-media-format-uploaded><div class="se-media--absent" *ngIf="isMediaAbsent()"><se-media-file-selector *ngIf="isEditable" [selectionMode]="'upload'" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="isFieldDisabled ? 'file-selector-disabled' : ''" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><se-media-file-selector *ngIf="!isEditable" [selectionMode]="'upload'" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="!isEditable ? 'file-selector-disabled' : ''" [disabled]="!isEditable" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector></div><div *ngIf="isUnderEdit" class="se-media--edit-wrapper"><se-media-file-selector class="se-media--edit" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="'file-selector-disabled'" [disabled]="true" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><span class="se-media-preview--edit" [translate]="mediaSelectorI18nKeys.UNDER_EDIT"></span></div><ng-container *ngIf="!isUnderEdit"><div class="error-input se-media-format__error" *ngFor="let error of getErrors()"><span>{{ error }}</span></div></ng-container></div>`,styles:[`.se-media-format{height:100%}.se-media-format__screen-type{font-weight:700;padding-top:4px;padding-bottom:10px;color:#32363a}.se-media-format__error{color:#b00}.se-media--absent{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;border:1px dashed #d9d9d9}.se-media--edit-wrapper{height:100%}.se-media--edit{display:flex;flex-direction:row;align-items:center;justify-content:center}.se-media-preview--edit{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;display:block;font-style:italic}`,`.se-media-preview-container{position:relative}.se-media-preview-container .se-media-preview__image-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;background-color:#edeff0}.se-media-preview-container .se-media-preview__image-thumbnail{max-width:100%;max-height:100%}`],encapsulation:s.ViewEncapsulation.None});let qo=class MediaFormatComponent{constructor(e,t,o){this.mediaService=e;this.mediaUtilService=t;this.onFileSelect=new s.EventEmitter;this.onDelete=new s.EventEmitter;this.media=null;this.mediaSelectorI18nKeys=o}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.acceptedFileTypes=this.mediaUtilService.getAcceptedFileTypes(this.allowMediaType);this.mediaFormatI18nKey=`se.media.format.${this.mediaFormat}`;if(this.mediaUuid){return this.fetchAndSetMedia()}}))}ngOnChanges(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.mediaUuid;if(t&&!t.firstChange){if(this.mediaUuid){return this.fetchAndSetMedia()}else{this.media=null}}}))}onFileSelectorFileSelect(e){this.onFileSelect.emit(e)}onRemoveButtonClick(){this.onDelete.emit()}isMediaPreviewEnabled(){var e;return this.mediaUuid&&!this.isUnderEdit&&!!((e=this.media)===null||e===void 0?void 0:e.code)}isMediaAbsent(){return!this.mediaUuid&&!this.isUnderEdit}getErrors(){return(this.errorMessages||[]).filter((e=>e.format===this.mediaFormat)).map((e=>e.message))}fetchAndSetMedia(){return __awaiter(this,void 0,void 0,(function*(){this.media=yield this.mediaService.getMedia(this.mediaUuid)}))}};qo.$inject=["mediaService","mediaUtilService","mediaSelectorI18nKey"];__decorate([s.Input(),__metadata("design:type",Array)],qo.prototype,"errorMessages",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],qo.prototype,"isEditable",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],qo.prototype,"isUnderEdit",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],qo.prototype,"isFieldDisabled",void 0);__decorate([s.Input(),__metadata("design:type",String)],qo.prototype,"mediaUuid",void 0);__decorate([s.Input(),__metadata("design:type",String)],qo.prototype,"mediaFormat",void 0);__decorate([s.Input(),__metadata("design:type",String)],qo.prototype,"mediaLabel",void 0);__decorate([s.Input(),__metadata("design:type",String)],qo.prototype,"allowMediaType",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],qo.prototype,"onFileSelect",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],qo.prototype,"onDelete",void 0);qo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-format",template:`<div class="se-media-format" [ngClass]="mediaFormat"><div *ngIf="mediaLabel" class="se-media-format__screen-type" [translate]="mediaFormatI18nKey"></div><se-media-format-uploaded *ngIf="isMediaPreviewEnabled()" [media]="media" [replaceLabelI18nKey]="mediaSelectorI18nKeys.REPLACE" [acceptedFileTypes]="acceptedFileTypes" [isFieldDisabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)" (onDelete)="onRemoveButtonClick()"></se-media-format-uploaded><div class="se-media--absent" *ngIf="isMediaAbsent()"><se-media-file-selector *ngIf="isEditable" [selectionMode]="'upload'" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="isFieldDisabled ? 'file-selector-disabled' : ''" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><se-media-file-selector *ngIf="!isEditable" [selectionMode]="'upload'" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="!isEditable ? 'file-selector-disabled' : ''" [disabled]="!isEditable" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector></div><div *ngIf="isUnderEdit" class="se-media--edit-wrapper"><se-media-file-selector class="se-media--edit" [labelI18nKey]="mediaSelectorI18nKeys.UPLOAD" [acceptedFileTypes]="acceptedFileTypes" [customClass]="'file-selector-disabled'" [disabled]="true" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><span class="se-media-preview--edit" [translate]="mediaSelectorI18nKeys.UNDER_EDIT"></span></div><ng-container *ngIf="!isUnderEdit"><div class="error-input se-media-format__error" *ngFor="let error of getErrors()"><span>{{ error }}</span></div></ng-container></div>`,styles:[`.se-media-format{height:100%}.se-media-format__screen-type{font-weight:700;padding-top:4px;padding-bottom:10px;color:#32363a}.se-media-format__error{color:#b00}.se-media--absent{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;border:1px dashed #d9d9d9}.se-media--edit-wrapper{height:100%}.se-media--edit{display:flex;flex-direction:row;align-items:center;justify-content:center}.se-media-preview--edit{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;display:block;font-style:italic}`,`.se-media-preview-container{position:relative}.se-media-preview-container .se-media-preview__image-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;background-color:#edeff0}.se-media-preview-container .se-media-preview__image-thumbnail{max-width:100%;max-height:100%}`],encapsulation:s.ViewEncapsulation.None}),__param(2,s.Inject(m.MEDIA_SELECTOR_I18N_KEY_TOKEN)),__metadata("design:paramtypes",[Do,Mo,Object])],qo);window.__smartedit__.addDecoratorPayload("Component","MediaFormatUploadedComponent",{selector:"se-media-format-uploaded",template:`<div class="se-media--present"><div class="se-media--present-img-container se-media-preview-container"><div *ngIf="isImage()" class="se-media-preview__image-wrapper"><se-media-preview [imageUrl]="getSafeUrl()"></se-media-preview><img class="se-media-preview__image-thumbnail" [src]="getSafeUrl()"/></div><div *ngIf="isVideo()" class="se-media-preview__image-wrapper"><video class="se-media-preview__image-thumbnail" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-preview__image-wrapper"><iframe class="se-media-preview__image-thumbnail" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div></div><se-media-advanced-properties [code]="media.code" [description]="media.description" [altText]="media.altText"></se-media-advanced-properties><se-media-file-selector [labelI18nKey]="replaceLabelI18nKey" [acceptedFileTypes]="acceptedFileTypes" [customClass]="'media-format-present-replace' + (isFieldDisabled ? ' file-selector-disabled' : '')" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><se-media-remove-button [isDisabled]="isFieldDisabled" (clickHandler)="onRemoveButtonClick()"></se-media-remove-button></div>`,styles:[`.se-media-preview-container{position:relative}.se-media-preview-container .se-media-preview__image-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;background-color:#edeff0}.se-media-preview-container .se-media-preview__image-thumbnail{max-width:100%;max-height:100%}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Ko=class MediaFormatUploadedComponent{constructor(e){this.sanitizer=e;this.onFileSelect=new s.EventEmitter;this.onDelete=new s.EventEmitter}onFileSelectorFileSelect(e){this.onFileSelect.emit(e)}onRemoveButtonClick(){this.onDelete.emit()}isImage(){return!this.isVideo()&&!this.isPdf()}isVideo(){return this.media.mime&&this.media.mime.includes(m.GenericEditorMediaType.VIDEO)}isPdf(){return this.media.mime&&this.media.mime.includes(m.GenericEditorMediaType.PDF_DOCUMENT)}getSafeUrl(){return this.sanitizer.bypassSecurityTrustResourceUrl(this.media.url)}};Ko.$inject=["sanitizer"];__decorate([s.Input(),__metadata("design:type",Object)],Ko.prototype,"media",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ko.prototype,"replaceLabelI18nKey",void 0);__decorate([s.Input(),__metadata("design:type",Array)],Ko.prototype,"acceptedFileTypes",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Ko.prototype,"isFieldDisabled",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ko.prototype,"onFileSelect",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ko.prototype,"onDelete",void 0);Ko=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-format-uploaded",template:`<div class="se-media--present"><div class="se-media--present-img-container se-media-preview-container"><div *ngIf="isImage()" class="se-media-preview__image-wrapper"><se-media-preview [imageUrl]="getSafeUrl()"></se-media-preview><img class="se-media-preview__image-thumbnail" [src]="getSafeUrl()"/></div><div *ngIf="isVideo()" class="se-media-preview__image-wrapper"><video class="se-media-preview__image-thumbnail" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-preview__image-wrapper"><iframe class="se-media-preview__image-thumbnail" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div></div><se-media-advanced-properties [code]="media.code" [description]="media.description" [altText]="media.altText"></se-media-advanced-properties><se-media-file-selector [labelI18nKey]="replaceLabelI18nKey" [acceptedFileTypes]="acceptedFileTypes" [customClass]="'media-format-present-replace' + (isFieldDisabled ? ' file-selector-disabled' : '')" [disabled]="isFieldDisabled" (onFileSelect)="onFileSelectorFileSelect($event)"></se-media-file-selector><se-media-remove-button [isDisabled]="isFieldDisabled" (clickHandler)="onRemoveButtonClick()"></se-media-remove-button></div>`,styles:[`.se-media-preview-container{position:relative}.se-media-preview-container .se-media-preview__image-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;background-color:#edeff0}.se-media-preview-container .se-media-preview__image-thumbnail{max-width:100%;max-height:100%}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[r.DomSanitizer])],Ko);var Yo;(function(e){e["replace"]="replace";e["upload"]="upload"})(Yo||(Yo={}));window.__smartedit__.addDecoratorPayload("Component","MediaFileSelectorComponent",{selector:"se-media-file-selector",template:`<div class="se-file-selector" [ngClass]="customClass"><label *ngIf="!disabled" class="se-button se-button--text" [ngClass]="{ 'se-button--disabled': disabled,\n                     'se-file-selector__custombtn': customComponent, \n                     'se-file-selector__btn': !customComponent }"><ng-container *ngIf="customComponent"><ng-container *ngComponentOutlet="customComponent.component; injector: customComponent.injector"></ng-container></ng-container><span class="sap-icon--share se-media__action-icon" [ngClass]="{\n        'sap-icon--share': isReplaceMode(),\n        'sap-icon--upload': !isReplaceMode()\n    }"></span> <span class="se-file-selector__label">{{ labelI18nKey | translate }}</span><ng-container *ngIf="!customComponent"><input type="file" class="hide se-file-selector__input" [accept]="buildAcceptedFileTypesList()" (change)="onSelect($event.target.files)"/></ng-container></label></div>`,styles:[`.se-media-container-field__media-list{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:0 16px}.se-media-container-cell--mobile{order:4}.se-media-container-cell--desktop{order:2}.se-media-container-cell--tablet{order:3}.se-media-container-cell--widescreen{order:1}.se-media__action-icon{color:#0a6ed1;margin-right:8px;width:12px}.se-media__action-icon--basic{font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-media__action-icon--basic::before{vertical-align:middle}.se-media__action-icon--delete{color:#b00}.se-media-action-btn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px}.se-media-action-btn[disabled]{cursor:not-allowed;opacity:.4}.se-media-upload-form-wrapper{display:block}.se-media-upload-form-wrapper--spaced{margin-top:16px}.se-media-upload-form__header-folder fd-popover-control .selected-container .se-item-printer{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:156px}.se-media-upload-form__header-folder.is-invalid fd-popover-control .selected-container .fd-button{border-color:#b00}.se-file-selector{display:flex;flex-direction:row;align-items:center}.se-file-selector--disabled .se-file-selector__btn:focus,.se-file-selector--disabled .se-file-selector__btn:hover{cursor:not-allowed}.se-file-selector__btn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px;position:relative}.se-file-selector__btn[disabled]{cursor:not-allowed;opacity:.4}.se-file-selector--disabled .se-file-selector__btn:focus,.se-file-selector--disabled .se-file-selector__btn:hover{cursor:not-allowed}.se-file-selector__btn>:first-child{display:block;top:0}.se-file-selector__custombtn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px;position:relative}.se-file-selector__custombtn[disabled]{cursor:not-allowed;opacity:.4}.se-file-selector--disabled .se-file-selector__custombtn:focus,.se-file-selector--disabled .se-file-selector__custombtn:hover{cursor:not-allowed}.se-file-selector__custombtn>:first-child{position:absolute;width:100%;height:100%}.se-file-selector__label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;color:var(--sapInformativeColor)}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let Zo=class MediaFileSelectorComponent{constructor(e,t){this.injector=e;this.onFileSelect=new s.EventEmitter;if(t){this.initCustomComponent(t)}}ngOnInit(){this.disabled=this.disabled||false;this.customClass=this.customClass||"";this.selectionMode=this.selectionMode||Yo.replace}buildAcceptedFileTypesList(){return this.acceptedFileTypes.map((e=>`.${e}`)).join(",")}isReplaceMode(){return this.selectionMode===Yo.replace}onSelect(e){this.onFileSelect.emit(e)}initCustomComponent({component:e}){this.customComponent={component:e,injector:s.Injector.create({parent:this.injector,providers:[{provide:m.MEDIA_FILE_SELECTOR_CUSTOM_INJECTOR_TOKEN,useValue:{onSelect:e=>this.onSelect(e)}}]})}}};Zo.$inject=["injector","customSelector"];__decorate([s.Input(),__metadata("design:type",String)],Zo.prototype,"selectionMode",void 0);__decorate([s.Input(),__metadata("design:type",String)],Zo.prototype,"labelI18nKey",void 0);__decorate([s.Input(),__metadata("design:type",Array)],Zo.prototype,"acceptedFileTypes",void 0);__decorate([s.Input(),__metadata("design:type",String)],Zo.prototype,"customClass",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Zo.prototype,"disabled",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Zo.prototype,"onFileSelect",void 0);Zo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-file-selector",template:`<div class="se-file-selector" [ngClass]="customClass"><label *ngIf="!disabled" class="se-button se-button--text" [ngClass]="{ 'se-button--disabled': disabled,\n                     'se-file-selector__custombtn': customComponent, \n                     'se-file-selector__btn': !customComponent }"><ng-container *ngIf="customComponent"><ng-container *ngComponentOutlet="customComponent.component; injector: customComponent.injector"></ng-container></ng-container><span class="sap-icon--share se-media__action-icon" [ngClass]="{\n        'sap-icon--share': isReplaceMode(),\n        'sap-icon--upload': !isReplaceMode()\n    }"></span> <span class="se-file-selector__label">{{ labelI18nKey | translate }}</span><ng-container *ngIf="!customComponent"><input type="file" class="hide se-file-selector__input" [accept]="buildAcceptedFileTypesList()" (change)="onSelect($event.target.files)"/></ng-container></label></div>`,styles:[`.se-media-container-field__media-list{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:0 16px}.se-media-container-cell--mobile{order:4}.se-media-container-cell--desktop{order:2}.se-media-container-cell--tablet{order:3}.se-media-container-cell--widescreen{order:1}.se-media__action-icon{color:#0a6ed1;margin-right:8px;width:12px}.se-media__action-icon--basic{font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-media__action-icon--basic::before{vertical-align:middle}.se-media__action-icon--delete{color:#b00}.se-media-action-btn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px}.se-media-action-btn[disabled]{cursor:not-allowed;opacity:.4}.se-media-upload-form-wrapper{display:block}.se-media-upload-form-wrapper--spaced{margin-top:16px}.se-media-upload-form__header-folder fd-popover-control .selected-container .se-item-printer{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:156px}.se-media-upload-form__header-folder.is-invalid fd-popover-control .selected-container .fd-button{border-color:#b00}.se-file-selector{display:flex;flex-direction:row;align-items:center}.se-file-selector--disabled .se-file-selector__btn:focus,.se-file-selector--disabled .se-file-selector__btn:hover{cursor:not-allowed}.se-file-selector__btn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px;position:relative}.se-file-selector__btn[disabled]{cursor:not-allowed;opacity:.4}.se-file-selector--disabled .se-file-selector__btn:focus,.se-file-selector--disabled .se-file-selector__btn:hover{cursor:not-allowed}.se-file-selector__btn>:first-child{display:block;top:0}.se-file-selector__custombtn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px;position:relative}.se-file-selector__custombtn[disabled]{cursor:not-allowed;opacity:.4}.se-file-selector--disabled .se-file-selector__custombtn:focus,.se-file-selector--disabled .se-file-selector__custombtn:hover{cursor:not-allowed}.se-file-selector__custombtn>:first-child{position:absolute;width:100%;height:100%}.se-file-selector__label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;color:var(--sapInformativeColor)}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(1,s.Optional()),__param(1,s.Inject(m.MEDIA_FILE_SELECTOR_CUSTOM_TOKEN)),__metadata("design:paramtypes",[s.Injector,Object])],Zo);window.__smartedit__.addDecoratorPayload("Component","MediaPreviewComponent",{selector:"se-media-preview",template:`<se-tooltip [appendTo]="'body'" [placement]="'bottom'" [isChevronVisible]="true" [triggers]="['click']"><span se-tooltip-trigger><div class="sap-icon--search se-media-preview__icon"></div></span><div se-tooltip-body><img class="se-media-preview__image" [src]="imageUrl"/></div></se-tooltip>`,styles:[`.se-media-preview{display:block;cursor:pointer;position:absolute;height:24px;width:24px;top:0;right:0}.se-media-preview__icon{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400;outline:0;background-color:#0a6ed1;color:#fff;height:24px;width:24px}.se-media-preview__image{width:160px;height:auto}`],encapsulation:s.ViewEncapsulation.None,host:{"[class.se-media-preview]":"true"},changeDetection:s.ChangeDetectionStrategy.OnPush});let Xo=class MediaPreviewComponent{};__decorate([s.Input(),__metadata("design:type",String)],Xo.prototype,"imageUrl",void 0);Xo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-preview",template:`<se-tooltip [appendTo]="'body'" [placement]="'bottom'" [isChevronVisible]="true" [triggers]="['click']"><span se-tooltip-trigger><div class="sap-icon--search se-media-preview__icon"></div></span><div se-tooltip-body><img class="se-media-preview__image" [src]="imageUrl"/></div></se-tooltip>`,styles:[`.se-media-preview{display:block;cursor:pointer;position:absolute;height:24px;width:24px;top:0;right:0}.se-media-preview__icon{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400;outline:0;background-color:#0a6ed1;color:#fff;height:24px;width:24px}.se-media-preview__image{width:160px;height:auto}`],encapsulation:s.ViewEncapsulation.None,host:{"[class.se-media-preview]":"true"},changeDetection:s.ChangeDetectionStrategy.OnPush})],Xo);window.__smartedit__.addDecoratorPayload("Component","MediaRemoveButtonComponent",{selector:"se-media-remove-button",template:`<button type="button" class="se-media-action-btn se-media-remove-btn" [disabled]="isDisabled" (click)="clickHandler.emit($event)"><span class="se-media__action-icon se-media__action-icon--delete sap-icon--delete"></span> <span class="se-media-remove-btn-txt" [ngClass]="{ 'se-media-remove-btn-txt--disabled': isDisabled }" translate="se.media.format.remove"></span></button>`,styles:[`.se-media-remove-btn-txt{color:#b00}.se-media-remove-btn-txt--disabled{color:#6a6d70}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Qo=class MediaRemoveButtonComponent{constructor(){this.clickHandler=new s.EventEmitter}};__decorate([s.Input(),__metadata("design:type",Boolean)],Qo.prototype,"isDisabled",void 0);__decorate([s.Output(),__metadata("design:type",Object)],Qo.prototype,"clickHandler",void 0);Qo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-remove-button",template:`<button type="button" class="se-media-action-btn se-media-remove-btn" [disabled]="isDisabled" (click)="clickHandler.emit($event)"><span class="se-media__action-icon se-media__action-icon--delete sap-icon--delete"></span> <span class="se-media-remove-btn-txt" [ngClass]="{ 'se-media-remove-btn-txt--disabled': isDisabled }" translate="se.media.format.remove"></span></button>`,styles:[`.se-media-remove-btn-txt{color:#b00}.se-media-remove-btn-txt--disabled{color:#6a6d70}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],Qo);window.__smartedit__.addDecoratorPayload("Component","MediaAdvancedPropertiesComponent",{selector:"se-media-advanced-properties",template:`<se-tooltip [appendTo]="'body'" [placement]="'bottom'" [isChevronVisible]="true" [triggers]="['click']" class="se-media-advanced-info"><span se-tooltip-trigger class="se-media-advanced-info__trigger"><span class="sap-icon--message-information se-media__action-icon se-media__action-icon--basic" [title]="i18nKeys.INFORMATION | translate"></span><se-media-action-label [i18nKey]="i18nKeys.INFORMATION"></se-media-action-label></span><div se-tooltip-body><div class="se-media-advanced-info-body"><div class="se-media-advanced-info-row advanced-information-description" *ngIf="description"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.DESCRIPTION"></div><div class="se-media-advanced-info-row__description">{{ description }}</div></div><div class="se-media-advanced-info-row advanced-information-code"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.CODE"></div><div class="se-media-advanced-info-row__description">{{ code }}</div></div><div class="se-media-advanced-info-row advanced-information-alt-text" *ngIf="altText"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.ALT_TEXT"></div><div class="se-media-advanced-info-row__description">{{ altText }}</div></div></div></div></se-tooltip>`,styles:[`.se-media-container-field__media-list{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:0 16px}.se-media-container-cell--mobile{order:4}.se-media-container-cell--desktop{order:2}.se-media-container-cell--tablet{order:3}.se-media-container-cell--widescreen{order:1}.se-media__action-icon{color:#0a6ed1;margin-right:8px;width:12px}.se-media__action-icon--basic{font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-media__action-icon--basic::before{vertical-align:middle}.se-media__action-icon--delete{color:#b00}.se-media-action-btn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px}.se-media-action-btn[disabled]{cursor:not-allowed;opacity:.4}.se-media-upload-form-wrapper{display:block}.se-media-upload-form-wrapper--spaced{margin-top:16px}.se-media-upload-form__header-folder fd-popover-control .selected-container .se-item-printer{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:156px}.se-media-upload-form__header-folder.is-invalid fd-popover-control .selected-container .fd-button{border-color:#b00}.se-media-advanced-info{display:flex;flex-direction:row;align-items:center;display:inline-flex;height:32px;outline:0}.se-media-advanced-info__trigger{display:flex;align-items:center}.se-media-advanced-info-body{padding:11px}.se-media-advanced-info-row:not(:last-child){margin-bottom:16px}.se-media-advanced-info-row__description{color:#32363a;word-break:break-all;max-width:95%}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Jo=class MediaAdvancedPropertiesComponent{constructor(){this.i18nKeys={DESCRIPTION:"se.media.advanced.information.description",CODE:"se.media.advanced.information.code",ALT_TEXT:"se.media.advanced.information.alt.text",ADVANCED_INFORMATION:"se.media.advanced.information",INFORMATION:"se.media.information"}}};__decorate([s.Input(),__metadata("design:type",String)],Jo.prototype,"code",void 0);__decorate([s.Input(),__metadata("design:type",String)],Jo.prototype,"description",void 0);__decorate([s.Input(),__metadata("design:type",String)],Jo.prototype,"altText",void 0);Jo=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-advanced-properties",template:`<se-tooltip [appendTo]="'body'" [placement]="'bottom'" [isChevronVisible]="true" [triggers]="['click']" class="se-media-advanced-info"><span se-tooltip-trigger class="se-media-advanced-info__trigger"><span class="sap-icon--message-information se-media__action-icon se-media__action-icon--basic" [title]="i18nKeys.INFORMATION | translate"></span><se-media-action-label [i18nKey]="i18nKeys.INFORMATION"></se-media-action-label></span><div se-tooltip-body><div class="se-media-advanced-info-body"><div class="se-media-advanced-info-row advanced-information-description" *ngIf="description"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.DESCRIPTION"></div><div class="se-media-advanced-info-row__description">{{ description }}</div></div><div class="se-media-advanced-info-row advanced-information-code"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.CODE"></div><div class="se-media-advanced-info-row__description">{{ code }}</div></div><div class="se-media-advanced-info-row advanced-information-alt-text" *ngIf="altText"><div class="se-media-advanced-info-row__label se-control-label" [translate]="i18nKeys.ALT_TEXT"></div><div class="se-media-advanced-info-row__description">{{ altText }}</div></div></div></div></se-tooltip>`,styles:[`.se-media-container-field__media-list{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:0 16px}.se-media-container-cell--mobile{order:4}.se-media-container-cell--desktop{order:2}.se-media-container-cell--tablet{order:3}.se-media-container-cell--widescreen{order:1}.se-media__action-icon{color:#0a6ed1;margin-right:8px;width:12px}.se-media__action-icon--basic{font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-media__action-icon--basic::before{vertical-align:middle}.se-media__action-icon--delete{color:#b00}.se-media-action-btn{display:flex;flex-direction:row;align-items:center;padding:0;margin:0;border:none;box-shadow:none;outline:0;background-color:transparent;text-decoration:none;height:32px}.se-media-action-btn[disabled]{cursor:not-allowed;opacity:.4}.se-media-upload-form-wrapper{display:block}.se-media-upload-form-wrapper--spaced{margin-top:16px}.se-media-upload-form__header-folder fd-popover-control .selected-container .se-item-printer{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:156px}.se-media-upload-form__header-folder.is-invalid fd-popover-control .selected-container .fd-button{border-color:#b00}.se-media-advanced-info{display:flex;flex-direction:row;align-items:center;display:inline-flex;height:32px;outline:0}.se-media-advanced-info__trigger{display:flex;align-items:center}.se-media-advanced-info-body{padding:11px}.se-media-advanced-info-row:not(:last-child){margin-bottom:16px}.se-media-advanced-info-row__description{color:#32363a;word-break:break-all;max-width:95%}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],Jo);window.__smartedit__.addDecoratorPayload("Component","MediaPrinterComponent",{selector:"se-media-printer",template:`<div class="se-media-selector" *ngIf="isSelected"><span class="se-media-selector__left-section se-media-preview-container"><div *ngIf="isImage()" class="se-media-selector__left-section se-media-preview-container"><se-media-preview [imageUrl]="getSafeUrl()"></se-media-preview><img class="se-media-preview__image-thumbnail" [alt]="media.code" [src]="getSafeUrl()"/></div><div *ngIf="isVideo()" class="se-media-selector__left-section se-media-preview-container"><video class="se-media-preview__image-thumbnail" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-selector__left-section se-media-preview-container"><iframe class="se-media-preview__image-thumbnail" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div></span><span class="se-media-selector__right-section"><se-media-advanced-properties [code]="media.code" [description]="media.description" [altText]="media.altText"></se-media-advanced-properties><button class="se-media-action-btn replace-image" [disabled]="isDisabled()"><span class="sap-icon--share se-media__action-icon"></span><se-media-action-label [state]="isDisabled() ? 'disabled' : null" [i18nKey]="'se.upload.image.replace'"></se-media-action-label></button><se-media-remove-button [isDisabled]="isDisabled()" (clickHandler)="select.removeSelectedOption($event, media)"></se-media-remove-button></span></div><div class="se-media-selector__search" *ngIf="!isSelected"><div *ngIf="isImage()" class="se-media-selector__search-img-wrapper"><img [src]="getSafeUrl()" class="se-media-selector__search-img" [alt]="media.code"/></div><div *ngIf="isVideo()" class="se-media-selector__search-img-wrapper"><video class="se-media-selector__search-img" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-selector__search-img-wrapper"><iframe class="se-media-selector__search-img" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div><div class="se-media-selector__search-name">{{ media.code }}</div></div>`,styles:[`se-media-printer .se-media-selector{display:flex;flex-direction:row;align-items:center;position:relative}se-media-printer .se-media-selector__left-section{display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#eeeeef;position:relative;width:135px;height:80px}se-media-printer .se-media-selector__right-section{display:flex;flex-direction:column;margin-left:20px}se-media-printer .se-media-selector__search{display:flex;flex-direction:row;align-items:center}se-media-printer .se-media-selector__search-img-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#eeeeef;width:135px;height:80px;margin-right:16px}se-media-printer .se-media-selector__search-img{max-width:100%;max-height:100%;margin:5px}se-media-printer .se-media-selector__search-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:70%}`,`.se-media-preview-container{position:relative}.se-media-preview-container .se-media-preview__image-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;background-color:#edeff0}.se-media-preview-container .se-media-preview__image-thumbnail{max-width:100%;max-height:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let en=class MediaPrinterComponent{constructor(e,t){this.data=e;this.sanitizer=t;({item:this.media,selected:this.isSelected,select:this.select}=e)}isDisabled(){return this.select.isReadOnly}isImage(){return!this.isVideo()&&!this.isPdf()}isVideo(){return this.media.mime&&this.media.mime.includes(m.GenericEditorMediaType.VIDEO)}isPdf(){return this.media.mime&&this.media.mime.includes(m.GenericEditorMediaType.PDF_DOCUMENT)}getSafeUrl(){return this.sanitizer.bypassSecurityTrustResourceUrl(this.media.url)}};en=__decorate([s.Component({selector:"se-media-printer",template:`<div class="se-media-selector" *ngIf="isSelected"><span class="se-media-selector__left-section se-media-preview-container"><div *ngIf="isImage()" class="se-media-selector__left-section se-media-preview-container"><se-media-preview [imageUrl]="getSafeUrl()"></se-media-preview><img class="se-media-preview__image-thumbnail" [alt]="media.code" [src]="getSafeUrl()"/></div><div *ngIf="isVideo()" class="se-media-selector__left-section se-media-preview-container"><video class="se-media-preview__image-thumbnail" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-selector__left-section se-media-preview-container"><iframe class="se-media-preview__image-thumbnail" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div></span><span class="se-media-selector__right-section"><se-media-advanced-properties [code]="media.code" [description]="media.description" [altText]="media.altText"></se-media-advanced-properties><button class="se-media-action-btn replace-image" [disabled]="isDisabled()"><span class="sap-icon--share se-media__action-icon"></span><se-media-action-label [state]="isDisabled() ? 'disabled' : null" [i18nKey]="'se.upload.image.replace'"></se-media-action-label></button><se-media-remove-button [isDisabled]="isDisabled()" (clickHandler)="select.removeSelectedOption($event, media)"></se-media-remove-button></span></div><div class="se-media-selector__search" *ngIf="!isSelected"><div *ngIf="isImage()" class="se-media-selector__search-img-wrapper"><img [src]="getSafeUrl()" class="se-media-selector__search-img" [alt]="media.code"/></div><div *ngIf="isVideo()" class="se-media-selector__search-img-wrapper"><video class="se-media-selector__search-img" controls><source [src]="getSafeUrl()" type="video/mp4"/></video></div><div *ngIf="isPdf()" class="se-media-selector__search-img-wrapper"><iframe class="se-media-selector__search-img" [src]="getSafeUrl()" style="width: 100%;height: 100%;border: none;"></iframe></div><div class="se-media-selector__search-name">{{ media.code }}</div></div>`,styles:[`se-media-printer .se-media-selector{display:flex;flex-direction:row;align-items:center;position:relative}se-media-printer .se-media-selector__left-section{display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#eeeeef;position:relative;width:135px;height:80px}se-media-printer .se-media-selector__right-section{display:flex;flex-direction:column;margin-left:20px}se-media-printer .se-media-selector__search{display:flex;flex-direction:row;align-items:center}se-media-printer .se-media-selector__search-img-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#eeeeef;width:135px;height:80px;margin-right:16px}se-media-printer .se-media-selector__search-img{max-width:100%;max-height:100%;margin:5px}se-media-printer .se-media-selector__search-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:70%}`,`.se-media-preview-container{position:relative}.se-media-preview-container .se-media-preview__image-wrapper{display:flex;flex-direction:row;align-items:center;justify-content:center;height:75px;background-color:#edeff0}.se-media-preview-container .se-media-preview__image-thumbnail{max-width:100%;max-height:100%}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object,r.DomSanitizer])],en);window.__smartedit__.addDecoratorPayload("Component","MediaSelectorComponent",{selector:"se-media-selector",template:`<div class="media-selector"><se-select [id]="id" [(model)]="mediaId" (modelChange)="onMediaIdChange($event)" [fetchStrategy]="fetchStrategy" [isReadOnly]="isDisabled" [itemComponent]="mediaPrinterComponent"></se-select></div>`,styles:[`se-media-selector .se-select [has-selected-option] .toggle-button{min-height:100px}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush});let tn=class MediaSelectorComponent{constructor(e){this.mediaService=e;this.mediaPrinterComponent=en;this.mediaIdChange=new s.EventEmitter}ngOnInit(){this.fetchStrategy={fetchEntity:e=>this.mediaService.getMedia(e),fetchPage:(e,t,o)=>this.mediaService.getPage(e,t,o,this.mimeType)}}onMediaIdChange(e){this.mediaId=e;this.mediaIdChange.emit(e)}};tn.$inject=["mediaService"];__decorate([s.Input(),__metadata("design:type",String)],tn.prototype,"id",void 0);__decorate([s.Input(),__metadata("design:type",String)],tn.prototype,"mediaId",void 0);__decorate([s.Input(),__metadata("design:type",String)],tn.prototype,"mimeType",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],tn.prototype,"mediaIdChange",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],tn.prototype,"isDisabled",void 0);tn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-selector",template:`<div class="media-selector"><se-select [id]="id" [(model)]="mediaId" (modelChange)="onMediaIdChange($event)" [fetchStrategy]="fetchStrategy" [isReadOnly]="isDisabled" [itemComponent]="mediaPrinterComponent"></se-select></div>`,styles:[`se-media-selector .se-select [has-selected-option] .toggle-button{min-height:100px}`],encapsulation:s.ViewEncapsulation.None,changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[Do])],tn);window.__smartedit__.addDecoratorPayload("Component","MediaUploadFormComponent",{selector:"se-media-upload-form",template:`<div class="se-media-upload-form"><div class="se-media-upload-form__header"><div class="se-media-upload-form__header-content"><div class="se-media-upload-form__header-title" translate="se.upload.image.to.folder"></div><se-select id="se-media-upload-form__header-folder" class="se-media-upload-form__header-folder" [ngClass]="{ 'is-invalid': hasError() }" [multiSelect]="false" [controls]="false" [(model)]="folderSelected" (modelChange)="folderSelectedChanged($event)" [fetchStrategy]="folderFetchStrategy" [placeholder]="folderSelected"></se-select><div class="se-media-upload-form__header-actions"><button type="button" class="fd-button--light se-media-upload-btn__cancel fd-button--compact" translate="se.upload.image.cancel" (click)="cancel()"></button> <button type="button" class="fd-button se-media-upload-btn__submit fd-button--compact" translate="se.upload.image.submit" (click)="uploadMedia()"></button></div></div><div class="se-media-upload-form__header-error"><span class="upload-field-error fd-form__message fd-form__message--error" *ngFor="let error of folderErrors">{{ error | translate }}</span></div></div><div class="se-media-upload-form__replace-file"><div class="se-media-upload-form__file-name">{{ image.name }}</div><se-media-file-selector [labelI18nKey]="'se.upload.image.replace'" [acceptedFileTypes]="acceptedFileTypes" (onFileSelect)="onFileSelect($event)"></se-media-file-selector></div><form class="se-media-upload-form__file-info"><se-media-upload-field [fieldName]="'code'" [fieldValue]="imageParams?.code" [fieldErrors]="getErrorsForFieldByCode('code')" [isRequired]="true" [labelI18nKey]="'se.uploaded.image.code'" (fieldValueChange)="onChangeFieldValue($event, 'code')"></se-media-upload-field><se-media-upload-field [fieldName]="'description'" [fieldValue]="imageParams?.description" [fieldErrors]="getErrorsForFieldByCode('description')" [isRequired]="true" [labelI18nKey]="'se.uploaded.image.description'" (fieldValueChange)="onChangeFieldValue($event, 'description')"></se-media-upload-field><se-media-upload-field [fieldName]="'alt-text'" [fieldValue]="imageParams?.altText" [fieldErrors]="getErrorsForFieldByCode('altText')" [isRequired]="true" [labelI18nKey]="'se.uploaded.image.alt.text'" (fieldValueChange)="onChangeFieldValue($event, 'altText')"></se-media-upload-field></form><se-spinner [isSpinning]="isUploading"></se-spinner></div>`,styles:[`.se-media-upload-form{box-shadow:0 6px 12px rgba(0,0,0,.175);border-radius:4px}.se-media-upload-form__header{border-bottom:1px solid #d9d9d9;display:flex;flex-direction:column}.se-media-upload-form__header-content{display:flex;flex-direction:row;align-items:center;justify-content:space-between;height:53px;padding:20px}.se-media-upload-form__header-title{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-media-upload-form__header-folder{width:200px;margin-left:8px;margin-right:auto}.se-media-upload-form__header-error{padding-left:20px}.se-media-upload-form__replace-file{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:16px 20px 0}.se-media-upload-form__file-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:80%}.se-media-upload-form__file-info{display:grid;grid-template-columns:repeat(2,1fr);grid-gap:16px;padding:20px}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let on=class MediaUploadFormComponent{constructor(e,t,o,n,a,r){this.cdr=e;this.fileValidatorFactory=t;this.mediaBackendValidationHandler=o;this.mediaUploaderService=n;this.mediaFolderService=a;this.mediaUtilService=r;this.onCancel=new s.EventEmitter;this.onSelect=new s.EventEmitter;this.onUploadSuccess=new s.EventEmitter;this.fieldErrors=[];this.imageParams=null;this.fileValidator=this.fileValidatorFactory.build([{subject:"code",message:"se.uploaded.image.code.is.required",validate:e=>!!e}])}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.acceptedFileTypes=this.mediaUtilService.getAcceptedFileTypes(this.allowMediaType);this.folderFetchStrategy=this.mediaFolderService.mediaFoldersFetchStrategy;this.folderSelected=yield this.mediaFolderService.getDefaultFolder();this.cdr.markForCheck()}))}ngOnChanges(e){const t=e.image;if(t){const{name:e}=this.image;this.imageParams={code:e,description:e,altText:e}}}getErrorsForFieldByCode(e){return this.fieldErrors.filter((t=>t.subject===e)).map((e=>e.message))}uploadMedia(){return __awaiter(this,void 0,void 0,(function*(){this.fieldErrors=[];if(!this.fileValidator.validate(this.imageParams,this.maxUploadFileSize,this.fieldErrors)){return}const e=this.acceptedFileTypes.filter((e=>this.image&&this.image.type&&this.image.type.includes(e)));if(!e||e&&e.length<1){this.fieldErrors.push({subject:"code",message:m.FILE_VALIDATION_CONFIG.I18N_KEYS.FILE_TYPE_INVALID});return}this.isUploading=true;try{const e=yield this.mediaUploaderService.uploadMedia({file:this.image,code:m.stringUtils.escapeHtml(this.imageParams.code),description:m.stringUtils.escapeHtml(this.imageParams.description),altText:m.stringUtils.escapeHtml(this.imageParams.altText),folder:this.folderSelected?this.folderSelected:""});this.onMediaUploadSuccess(e)}catch(e){this.onMediaUploadFail(e)}finally{this.isUploading=false}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}cancel(){this.reset();this.onCancel.emit()}onChangeFieldValue(e,t){this.imageParams[t]=e}onFileSelect(e){this.onSelect.emit(e)}hasError(){var e;return((e=this.folderErrors)===null||e===void 0?void 0:e.length)>0}folderSelectedChanged(e){this.folderErrors=[]}onMediaUploadSuccess({uuid:e}){this.reset();this.onUploadSuccess.emit(e)}onMediaUploadFail(e){this.mediaBackendValidationHandler.handleResponse(e,this.fieldErrors);this.folderErrors=this.fieldErrors.filter((e=>e.subject==="folder")).map((e=>e.message))}reset(){this.imageParams=null;this.fieldErrors=[];this.isUploading=false}};on.$inject=["cdr","fileValidatorFactory","mediaBackendValidationHandler","mediaUploaderService","mediaFolderService","mediaUtilService"];__decorate([s.Input(),__metadata("design:type",File)],on.prototype,"image",void 0);__decorate([s.Input(),__metadata("design:type",String)],on.prototype,"allowMediaType",void 0);__decorate([s.Input(),__metadata("design:type",Number)],on.prototype,"maxUploadFileSize",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],on.prototype,"onCancel",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],on.prototype,"onSelect",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],on.prototype,"onUploadSuccess",void 0);on=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-upload-form",template:`<div class="se-media-upload-form"><div class="se-media-upload-form__header"><div class="se-media-upload-form__header-content"><div class="se-media-upload-form__header-title" translate="se.upload.image.to.folder"></div><se-select id="se-media-upload-form__header-folder" class="se-media-upload-form__header-folder" [ngClass]="{ 'is-invalid': hasError() }" [multiSelect]="false" [controls]="false" [(model)]="folderSelected" (modelChange)="folderSelectedChanged($event)" [fetchStrategy]="folderFetchStrategy" [placeholder]="folderSelected"></se-select><div class="se-media-upload-form__header-actions"><button type="button" class="fd-button--light se-media-upload-btn__cancel fd-button--compact" translate="se.upload.image.cancel" (click)="cancel()"></button> <button type="button" class="fd-button se-media-upload-btn__submit fd-button--compact" translate="se.upload.image.submit" (click)="uploadMedia()"></button></div></div><div class="se-media-upload-form__header-error"><span class="upload-field-error fd-form__message fd-form__message--error" *ngFor="let error of folderErrors">{{ error | translate }}</span></div></div><div class="se-media-upload-form__replace-file"><div class="se-media-upload-form__file-name">{{ image.name }}</div><se-media-file-selector [labelI18nKey]="'se.upload.image.replace'" [acceptedFileTypes]="acceptedFileTypes" (onFileSelect)="onFileSelect($event)"></se-media-file-selector></div><form class="se-media-upload-form__file-info"><se-media-upload-field [fieldName]="'code'" [fieldValue]="imageParams?.code" [fieldErrors]="getErrorsForFieldByCode('code')" [isRequired]="true" [labelI18nKey]="'se.uploaded.image.code'" (fieldValueChange)="onChangeFieldValue($event, 'code')"></se-media-upload-field><se-media-upload-field [fieldName]="'description'" [fieldValue]="imageParams?.description" [fieldErrors]="getErrorsForFieldByCode('description')" [isRequired]="true" [labelI18nKey]="'se.uploaded.image.description'" (fieldValueChange)="onChangeFieldValue($event, 'description')"></se-media-upload-field><se-media-upload-field [fieldName]="'alt-text'" [fieldValue]="imageParams?.altText" [fieldErrors]="getErrorsForFieldByCode('altText')" [isRequired]="true" [labelI18nKey]="'se.uploaded.image.alt.text'" (fieldValueChange)="onChangeFieldValue($event, 'altText')"></se-media-upload-field></form><se-spinner [isSpinning]="isUploading"></se-spinner></div>`,styles:[`.se-media-upload-form{box-shadow:0 6px 12px rgba(0,0,0,.175);border-radius:4px}.se-media-upload-form__header{border-bottom:1px solid #d9d9d9;display:flex;flex-direction:column}.se-media-upload-form__header-content{display:flex;flex-direction:row;align-items:center;justify-content:space-between;height:53px;padding:20px}.se-media-upload-form__header-title{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-media-upload-form__header-folder{width:200px;margin-left:8px;margin-right:auto}.se-media-upload-form__header-error{padding-left:20px}.se-media-upload-form__replace-file{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:16px 20px 0}.se-media-upload-form__file-name{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:80%}.se-media-upload-form__file-info{display:grid;grid-template-columns:repeat(2,1fr);grid-gap:16px;padding:20px}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[s.ChangeDetectorRef,m.FileValidatorFactory,Ro,xo,ko,Mo])],on);window.__smartedit__.addDecoratorPayload("Component","MediaUploadFieldComponent",{selector:"se-media-upload-field",template:`<div class="se-media-upload__file-info-field" [ngClass]="getContainerClassName()"><label class="se-control-label" [ngClass]="{ 'se-media-upload-has-error': hasError(), required: isRequired }" [translate]="labelI18nKey"></label> <input type="text" [ngClass]="{ 'is-invalid': hasError() }" class="fd-form__control" [attr.name]="fieldName" [ngModel]="fieldValue" (ngModelChange)="onChangeValue($event)"/> <span class="upload-field-error fd-form__message fd-form__message--error" [ngClass]="getErrorClassName()" *ngFor="let error of fieldErrors">{{ error | translate }}</span></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush});let nn=class MediaUploadFieldComponent{constructor(){this.isRequired=false;this.fieldValueChange=new s.EventEmitter}onChangeValue(e){this.fieldValueChange.emit(e)}hasError(){var e;return((e=this.fieldErrors)===null||e===void 0?void 0:e.length)>0}getContainerClassName(){return`se-media-upload__file-info-field--${this.fieldName}`}getErrorClassName(){return`upload-field-error--${this.fieldName}`}};__decorate([s.Input(),__metadata("design:type",String)],nn.prototype,"fieldValue",void 0);__decorate([s.Input(),__metadata("design:type",String)],nn.prototype,"fieldName",void 0);__decorate([s.Input(),__metadata("design:type",Array)],nn.prototype,"fieldErrors",void 0);__decorate([s.Input(),__metadata("design:type",Object)],nn.prototype,"isRequired",void 0);__decorate([s.Input(),__metadata("design:type",String)],nn.prototype,"labelI18nKey",void 0);__decorate([s.Output(),__metadata("design:type",Object)],nn.prototype,"fieldValueChange",void 0);nn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-media-upload-field",template:`<div class="se-media-upload__file-info-field" [ngClass]="getContainerClassName()"><label class="se-control-label" [ngClass]="{ 'se-media-upload-has-error': hasError(), required: isRequired }" [translate]="labelI18nKey"></label> <input type="text" [ngClass]="{ 'is-invalid': hasError() }" class="fd-form__control" [attr.name]="fieldName" [ngModel]="fieldValue" (ngModelChange)="onChangeValue($event)"/> <span class="upload-field-error fd-form__message fd-form__message--error" [ngClass]="getErrorClassName()" *ngFor="let error of fieldErrors">{{ error | translate }}</span></div>`,changeDetection:s.ChangeDetectionStrategy.OnPush})],nn);let sn=class MediaModule{};sn=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),f.CommonModule,a.FormsModule,m.TooltipModule,m.SelectModule,m.SpinnerModule,m.GenericEditorDropdownModule,m.MessageModule],providers:[Do,xo,Ro,ko,Mo,{provide:m.MEDIA_SELECTOR_I18N_KEY_TOKEN,useValue:m.MEDIA_SELECTOR_I18N_KEY},m.moduleUtils.bootstrap((e=>{}),[m.IFileValidation])],declarations:[Wo,Zo,Xo,Jo,tn,en,Oo,Qo,qo,Ko,on,nn,zo,Uo,Ho,$o],entryComponents:[Wo,Zo,Xo,Jo,tn,en,Oo,Qo,qo,Ko,on,nn,zo,Uo,$o]})],sn);window.__smartedit__.addDecoratorPayload("Component","MissingPrimaryContentPageComponent",{selector:"se-component-missing-primary-content-page",template:`<div><div><label class="missing-primary-content-page-message__label" [translate]="'se.cms.page.restore.content.page.noprimaryforvariation.msg'"></label></div><se-select id="se-page-restore-change-primary-selector-dropdown" [(model)]="cmsPage.label" [fetchStrategy]="fetchStrategy"></se-select></div>`,styles:[`.missing-primary-content-page-message__label{font-style:italic;padding-bottom:10px;display:block}`]});let an=class MissingPrimaryContentPageComponent{constructor(e,t,o){this.data=e;this.pageService=t;this.logService=o;this.CONTENT_PAGE_TYPE_CODE="ContentPage";this.ERROR_MSG="[MissingPrimaryContentPageComponent] - Cannot retrieve list of alternative content primary pages.";({model:this.cmsPage}=e)}ngOnInit(){this.fetchStrategy={fetchEntity:()=>this.fetchEntity(),fetchPage:(e,t,o)=>this.fetchPage(e,t,o)}}fetchEntity(){return Promise.resolve(this.getSelectItemFromPrimaryPage(this.cmsPage))}fetchPage(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.pageService.getPaginatedPrimaryPagesForPageType(this.CONTENT_PAGE_TYPE_CODE,null,{search:e,pageSize:t,currentPage:o});const s={pagination:n.pagination,results:null};s.results=n.response.map((e=>this.getSelectItemFromPrimaryPage(e)));return s}catch(e){this.logService.warn(this.ERROR_MSG,e)}}))}getSelectItemFromPrimaryPage(e){return{id:e.label,label:e.name}}};an=__decorate([s.Component({selector:"se-component-missing-primary-content-page",template:`<div><div><label class="missing-primary-content-page-message__label" [translate]="'se.cms.page.restore.content.page.noprimaryforvariation.msg'"></label></div><se-select id="se-page-restore-change-primary-selector-dropdown" [(model)]="cmsPage.label" [fetchStrategy]="fetchStrategy"></se-select></div>`,styles:[`.missing-primary-content-page-message__label{font-style:italic;padding-bottom:10px;display:block}`]}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,m.IPageService,m.LogService])],an);window.__smartedit__.addDecoratorPayload("Component","DuplicatePrimaryNonContentPageComponent",{selector:"se-component-duplicate-primary-non-content-page",template:`<div><label [translate]="label"></label></div>`});let rn=class DuplicatePrimaryNonContentPageComponent{constructor(e){this.data=e;this.PRODUCT_PAGE="ProductPage";this.labelI18nKeys={restoreCategory:"se.cms.page.restore.category.duplicate.primaryforvariation.error",restoreProduct:"se.cms.page.restore.product.duplicate.primaryforvariation.error"};({model:this.page}=e)}ngOnInit(){this.page.replace=true;this.label=this.page.typeCode===this.PRODUCT_PAGE?this.labelI18nKeys.restoreProduct:this.labelI18nKeys.restoreCategory}};rn=__decorate([s.Component({selector:"se-component-duplicate-primary-non-content-page",template:`<div><label [translate]="label"></label></div>`}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object])],rn);window.__smartedit__.addDecoratorPayload("Component","DuplicatePrimaryContentPageLabelComponent",{selector:"se-component-duplicate-primary-content-page-label",template:`<div><div class="fd-form__item fd-form__item--check"><input class="fd-form__control" type="radio" name="duplicateResolution" id="overwritePrimaryPageOption" [(ngModel)]="conflictResolution" (click)="selectResolution(RESOLUTION_OPTIONS.overwritePage)" [value]="RESOLUTION_OPTIONS.overwritePage"/> <label for="overwritePrimaryPageOption" class="fd-form__label" [translate]="'se.cms.page.restore.content.duplicate.primaryforvariation.option.overwrite'"></label></div><div class="fd-form__item fd-form__item--check"><input class="fd-form__control" type="radio" name="duplicateResolution" id="renamePrimaryPageOption" [(ngModel)]="conflictResolution" (click)="selectResolution(RESOLUTION_OPTIONS.renamePageLabel)" [value]="RESOLUTION_OPTIONS.renamePageLabel"/> <label for="renamePrimaryPageOption" class="fd-form__label" [translate]="'se.cms.page.restore.content.duplicate.primaryforvariation.option.rename'"></label></div><div class="rename-label-section" *ngIf="conflictResolution === RESOLUTION_OPTIONS.renamePageLabel"><label [translate]="'se.cms.page.restore.page.label'"></label> <input type="text" class="form-control" [(ngModel)]="page['label']"/></div></div>`,styles:[`.rename-label-section{display:block}`]});let ln=class DuplicatePrimaryContentPageLabelComponent{constructor(e){this.data=e;this.conflictResolution=null;this.RESOLUTION_OPTIONS={overwritePage:1,renamePageLabel:2};({model:this.page}=e);this.conflictResolution=this.RESOLUTION_OPTIONS.overwritePage;this.page.replace=true}selectResolution(e){this.page.replace=e===this.RESOLUTION_OPTIONS.overwritePage}};ln=__decorate([s.Component({selector:"se-component-duplicate-primary-content-page-label",template:`<div><div class="fd-form__item fd-form__item--check"><input class="fd-form__control" type="radio" name="duplicateResolution" id="overwritePrimaryPageOption" [(ngModel)]="conflictResolution" (click)="selectResolution(RESOLUTION_OPTIONS.overwritePage)" [value]="RESOLUTION_OPTIONS.overwritePage"/> <label for="overwritePrimaryPageOption" class="fd-form__label" [translate]="'se.cms.page.restore.content.duplicate.primaryforvariation.option.overwrite'"></label></div><div class="fd-form__item fd-form__item--check"><input class="fd-form__control" type="radio" name="duplicateResolution" id="renamePrimaryPageOption" [(ngModel)]="conflictResolution" (click)="selectResolution(RESOLUTION_OPTIONS.renamePageLabel)" [value]="RESOLUTION_OPTIONS.renamePageLabel"/> <label for="renamePrimaryPageOption" class="fd-form__label" [translate]="'se.cms.page.restore.content.duplicate.primaryforvariation.option.rename'"></label></div><div class="rename-label-section" *ngIf="conflictResolution === RESOLUTION_OPTIONS.renamePageLabel"><label [translate]="'se.cms.page.restore.page.label'"></label> <input type="text" class="form-control" [(ngModel)]="page['label']"/></div></div>`,styles:[`.rename-label-section{display:block}`]}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object])],ln);window.__smartedit__.addDecoratorPayload("Component","PageTypeEditorComponent",{selector:"se-page-type-editor",template:`<div class="se-edit-page-info__basic-tab"><div class="se-edit-page-info__page-type"><label class="se-control-label" translate="se.cms.pageinfo.page.type"></label><div class="form-readonly-text form-readonly-text__tight">{{ model.typeCode }}</div></div><div class="se-edit-page-info__page-template"><label class="se-control-label" translate="se.cms.pageinfo.page.template"></label><div class="form-readonly-text form-readonly-text__tight">{{ model.template }}</div></div></div>`,styles:[`.se-edit-page-info__basic-tab{display:grid;grid-template-columns:repeat(1,1fr)}`]});let cn=class PageTypeEditorComponent{constructor(e){({model:this.model}=e)}};cn=__decorate([s.Component({selector:"se-page-type-editor",template:`<div class="se-edit-page-info__basic-tab"><div class="se-edit-page-info__page-type"><label class="se-control-label" translate="se.cms.pageinfo.page.type"></label><div class="form-readonly-text form-readonly-text__tight">{{ model.typeCode }}</div></div><div class="se-edit-page-info__page-template"><label class="se-control-label" translate="se.cms.pageinfo.page.template"></label><div class="form-readonly-text form-readonly-text__tight">{{ model.template }}</div></div></div>`,styles:[`.se-edit-page-info__basic-tab{display:grid;grid-template-columns:repeat(1,1fr)}`]}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object])],cn);window.__smartedit__.addDecoratorPayload("Component","RestrictionsListComponent",{selector:"se-restrictions-list",template:`<div class="restrictions-list"><div class="restrictions-list__info"><label translate="se.cms.restrictions.criteria"></label> <span>&nbsp;{{ pageInfo.restrictionsCriteria }}</span></div><div class="restrictions-list__items" *ngFor="let restriction of restrictions"><div class="restrictions-list__item"><div class="restrictions-list__item-name">{{ restriction.name }}</div><div class="restrictions-list__item-type">{{ restriction.type | seL10n | async }}</div><div class="restrictions-list__item-description">{{ restriction.description }}</div></div></div></div>`});let dn=class RestrictionsListComponent{constructor(e,t,o){this.data=e;this.cmsitemsRestService=t;this.cdr=o;({model:this.pageInfo}=e);this.restrictions=[]}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.cmsitemsRestService.getByIdsNoCache(this.pageInfo.restrictions,"FULL");this.restrictions=e.response?e.response:[e];if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};dn=__decorate([s.Component({selector:"se-restrictions-list",template:`<div class="restrictions-list"><div class="restrictions-list__info"><label translate="se.cms.restrictions.criteria"></label> <span>&nbsp;{{ pageInfo.restrictionsCriteria }}</span></div><div class="restrictions-list__items" *ngFor="let restriction of restrictions"><div class="restrictions-list__item"><div class="restrictions-list__item-name">{{ restriction.name }}</div><div class="restrictions-list__item-type">{{ restriction.type | seL10n | async }}</div><div class="restrictions-list__item-description">{{ restriction.description }}</div></div></div></div>`}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,m.CmsitemsRestService,s.ChangeDetectorRef])],dn);window.__smartedit__.addDecoratorPayload("Component","SingeActiveCatalogAwareItemSelectorItemRendererComponent",{selector:"se-single-active-catalog-aware-item-selector-item-renderer",template:`\n        <span class="se-single-catalog-item">\n            <span\n                class="se-single-catalog-item__label"\n                title="{{ data.item.label | seL10n | async }}"\n                >{{ data.item.label | seL10n | async }}</span\n            >\n            <span\n                class="se-single-catalog-item__code"\n                title="{{ data.item.code | seL10n | async }}"\n            >\n                {{ data.item.code }}</span\n            >\n            <span\n                class="se-single-catalog-item__version"\n                title="{{ data.item.catalogId | seL10n | async }}"\n                >{{ data.item.catalogId }}</span\n            >\n        </span>\n    `});let pn=class SingeActiveCatalogAwareItemSelectorItemRendererComponent{constructor(e){this.data=e}};pn=__decorate([s.Component({selector:"se-single-active-catalog-aware-item-selector-item-renderer",template:`\n        <span class="se-single-catalog-item">\n            <span\n                class="se-single-catalog-item__label"\n                title="{{ data.item.label | seL10n | async }}"\n                >{{ data.item.label | seL10n | async }}</span\n            >\n            <span\n                class="se-single-catalog-item__code"\n                title="{{ data.item.code | seL10n | async }}"\n            >\n                {{ data.item.code }}</span\n            >\n            <span\n                class="se-single-catalog-item__version"\n                title="{{ data.item.catalogId | seL10n | async }}"\n                >{{ data.item.catalogId }}</span\n            >\n        </span>\n    `}),__param(0,s.Inject(m.ITEM_COMPONENT_DATA_TOKEN)),__metadata("design:paramtypes",[Object])],pn);var mn;(function(e){e["SingleOnlineProductSelector"]="product";e["SingleOnlineCategorySelector"]="category"})(mn||(mn={}));window.__smartedit__.addDecoratorPayload("Component","SingleActiveCatalogAwareItemSelectorComponent",{selector:"se-single-active-catalog-aware-item-selector",template:`<div *ngIf="propertyType"><div id="product-catalog"><label class="se-control-label" [ngClass]="{ 'required': field.required }" *ngIf="catalogs.length === 1">{{ catalogName | seL10n | async }}</label><se-generic-editor-dropdown id="se-catalog-selector-dropdown" *ngIf="catalogs.length > 1" [field]="productCatalogField" [qualifier]="'productCatalog'" [model]="model"></se-generic-editor-dropdown></div><div><label class="se-control-label" [translate]="mainDropDownI18nKey"></label><se-generic-editor-dropdown id="se-items-selector-dropdown" [field]="field" [qualifier]="qualifier" [model]="model" [itemComponent]="itemComponent" [(reset)]="reset"></se-generic-editor-dropdown></div></div><div class="product-catalog-item-type-missing" *ngIf="!propertyType" translate="se.cms.catalogawareitem.itemtype.notsupported"></div>`,styles:[`se-single-active-catalog-aware-item-selector .se-single-catalog-item{display:grid;grid-template-columns:2fr 1fr 2fr;grid-column-gap:1rem}se-single-active-catalog-aware-item-selector .se-single-catalog-item__code,se-single-active-catalog-aware-item-selector .se-single-catalog-item__label,se-single-active-catalog-aware-item-selector .se-single-catalog-item__version{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}se-single-active-catalog-aware-item-selector .selected-item>.se-item-printer{width:100%;padding-right:12px}`],encapsulation:s.ViewEncapsulation.None});let gn=class SingleActiveCatalogAwareItemSelectorComponent{constructor(e,t){this.data=e;this.catalogService=t;({editor:this.editor,field:this.field,model:this.model,qualifier:this.qualifier}=this.data);this.catalogName={};this.catalogs=[];this.itemComponent=pn;this.initProductCatalog=this.model.productCatalog}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.augmentDropdownAttributes();return this.initProductCatalogs()}))}ngDoCheck(){if(this.catalogs.length>1&&this.initProductCatalog!==this.model.productCatalog){this.initProductCatalog=this.model.productCatalog;this.resetSelector()}}augmentDropdownAttributes(){this.propertyType=this.getFieldPropertyType(this.field);if(this.propertyType){this.productCatalogField={idAttribute:"catalogId",labelAttributes:["name"],editable:this.field.editable,propertyType:"productCatalog"};this.mainDropDownI18nKey=this.field.i18nKey;delete this.field.i18nKey;this.field.paged=true;this.field.idAttribute="uid";this.field.labelAttributes=["name"];this.field.dependsOn="productCatalog";this.field.propertyType=this.propertyType}}initProductCatalogs(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.getProductCatalogsBySiteKey(p.CONTEXT_SITE_ID);this.catalogs=e;if(this.catalogs.length===1){this.model.productCatalog=this.catalogs[0].catalogId;this.editor.form.pristine.productCatalog=this.catalogs[0].catalogId;this.catalogName=this.catalogs[0].name}}))}getFieldPropertyType(e){const t=e.cmsStructureType;return mn[t]}resetSelector(){if(typeof this.reset==="function"){this.reset(true)}}};gn=__decorate([s.Component({selector:"se-single-active-catalog-aware-item-selector",template:`<div *ngIf="propertyType"><div id="product-catalog"><label class="se-control-label" [ngClass]="{ 'required': field.required }" *ngIf="catalogs.length === 1">{{ catalogName | seL10n | async }}</label><se-generic-editor-dropdown id="se-catalog-selector-dropdown" *ngIf="catalogs.length > 1" [field]="productCatalogField" [qualifier]="'productCatalog'" [model]="model"></se-generic-editor-dropdown></div><div><label class="se-control-label" [translate]="mainDropDownI18nKey"></label><se-generic-editor-dropdown id="se-items-selector-dropdown" [field]="field" [qualifier]="qualifier" [model]="model" [itemComponent]="itemComponent" [(reset)]="reset"></se-generic-editor-dropdown></div></div><div class="product-catalog-item-type-missing" *ngIf="!propertyType" translate="se.cms.catalogawareitem.itemtype.notsupported"></div>`,styles:[`se-single-active-catalog-aware-item-selector .se-single-catalog-item{display:grid;grid-template-columns:2fr 1fr 2fr;grid-column-gap:1rem}se-single-active-catalog-aware-item-selector .se-single-catalog-item__code,se-single-active-catalog-aware-item-selector .se-single-catalog-item__label,se-single-active-catalog-aware-item-selector .se-single-catalog-item__version{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}se-single-active-catalog-aware-item-selector .selected-item>.se-item-printer{width:100%;padding-right:12px}`],encapsulation:s.ViewEncapsulation.None}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object,m.ICatalogService])],gn);var un;(function(e){e["clone"]="clone";e["useExisting"]="reference";e["remove"]="remove"})(un||(un={}));window.__smartedit__.addDecoratorPayload("Component","SlotSharedCloneActionFieldComponent",{selector:"se-component-slot-shared-clone-action-field",template:`<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label for="components-in-slot-options" class="se-control-label" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot'"></label><div id="components-in-slot-options"><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="clone-all" [(ngModel)]="page.cloneAction" [value]="cloneAction.clone"/> <label for="clone-all" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot.cloneall'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="use-existing" [(ngModel)]="page.cloneAction" [value]="cloneAction.useExisting"/> <label for="use-existing" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot.useexisting'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="remove-all" [(ngModel)]="page.cloneAction" [value]="cloneAction.remove"/> <label for="remove-all" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot.removeall'"></label></div></div></div></div>`,styles:[`slot-shared-clone-action-field .fd-form__item--check{display:flex;align-items:baseline;flex-direction:column}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let hn=class SlotSharedCloneActionFieldComponent{constructor(e){this.data=e;this.cloneAction=un;({model:this.page}=e)}};hn=__decorate([s.Component({selector:"se-component-slot-shared-clone-action-field",template:`<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label for="components-in-slot-options" class="se-control-label" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot'"></label><div id="components-in-slot-options"><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="clone-all" [(ngModel)]="page.cloneAction" [value]="cloneAction.clone"/> <label for="clone-all" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot.cloneall'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="use-existing" [(ngModel)]="page.cloneAction" [value]="cloneAction.useExisting"/> <label for="use-existing" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot.useexisting'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="componentsInSlot" id="remove-all" [(ngModel)]="page.cloneAction" [value]="cloneAction.remove"/> <label for="remove-all" [translate]="'se.cms.slot.shared.replace.editor.componentsinslot.removeall'"></label></div></div></div></div>`,styles:[`slot-shared-clone-action-field .fd-form__item--check{display:flex;align-items:baseline;flex-direction:column}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object])],hn);window.__smartedit__.addDecoratorPayload("Component","SlotSharedSlotTypeFieldComponent",{selector:"se-component-slot-shared-slot-type-field",template:`<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label for="slot-replacement-type-options" class="se-control-label" [translate]="'se.cms.slot.shared.replace.editor.slotreplacementtype'"></label><div id="slot-replacement-type-options"><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="slotReplacementType" id="slot-type-custom" [(ngModel)]="page.isSlotCustom" [value]="true"/> <label for="slot-type-custom" [translate]="'se.cms.slot.shared.replace.editor.slotreplacementtype.nonshared'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="slotReplacementType" id="slot-type-local" [(ngModel)]="page.isSlotCustom" [value]="false"/> <label for="slot-type-local" [translate]="'se.cms.slot.shared.replace.editor.slotreplacementtype.local'"></label></div></div></div></div>`,styles:[`slot-shared-slot-type-field .fd-form__item--check{display:flex;align-items:baseline;flex-direction:column}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let vn=class SlotSharedSlotTypeFieldComponent{constructor(e){this.data=e;({model:this.page}=e)}};vn=__decorate([s.Component({selector:"se-component-slot-shared-slot-type-field",template:`<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label for="slot-replacement-type-options" class="se-control-label" [translate]="'se.cms.slot.shared.replace.editor.slotreplacementtype'"></label><div id="slot-replacement-type-options"><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="slotReplacementType" id="slot-type-custom" [(ngModel)]="page.isSlotCustom" [value]="true"/> <label for="slot-type-custom" [translate]="'se.cms.slot.shared.replace.editor.slotreplacementtype.nonshared'"></label></div><div class="se-form-control-row"><input class="fd-form__control" type="radio" name="slotReplacementType" id="slot-type-local" [(ngModel)]="page.isSlotCustom" [value]="false"/> <label for="slot-type-local" [translate]="'se.cms.slot.shared.replace.editor.slotreplacementtype.local'"></label></div></div></div></div>`,styles:[`slot-shared-slot-type-field .fd-form__item--check{display:flex;align-items:baseline;flex-direction:column}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(0,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[Object])],vn);var _n;(function(e){e["uploadThumbnail"]="UPLOAD_THUMBNAIL";e["noThumbnail"]="NO_THUMBNAIL"})(_n||(_n={}));window.__smartedit__.addDecoratorPayload("Component","ThumbnailSelectComponent",{selector:"se-thumbnail-select",template:`<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="qualifier" [model]="model"></se-generic-editor-dropdown>`});let fn=class ThumbnailSelectComponent{constructor(e,t){this.systemEventService=e;this.widget=t;({id:this.id,field:this.field,model:this.model,qualifier:this.qualifier}=t);if(this.field.dependsOnField){const e=`${this.id}${this.field.dependsOnField}${m.CLICK_DROPDOWN}`;this.unRegDependsOnValueChanged=this.systemEventService.subscribe(e,((e,t)=>this.onDependsOnValueChanged(t)))}this.optionEventId=`${this.id}${this.qualifier}${m.CLICK_DROPDOWN}`;const o=`${this.id}${m.LINKED_DROPDOWN}`;this.unRegSelectValueChanged=this.systemEventService.subscribe(o,((e,t)=>this.onThumbnailSelectValueChanged(t)))}ngOnDestroy(){this.unRegSelectValueChanged();this.unRegDependsOnValueChanged()}onThumbnailSelectValueChanged({optionObject:e,qualifier:t}){if(this.qualifier!==t){return}if(!e){return}const o=e.id;const n=Object.values(_n).includes(o);if(!n){throw new Error("Selected option is not supported")}if(!this.field.hideFieldWidget){this.systemEventService.publishAsync(this.optionEventId,o)}}onDependsOnValueChanged(e){this.field.hideFieldWidget=e!==this.field.dependsOnValue;if(this.field.hideFieldWidget){this.systemEventService.publishAsync(this.optionEventId,null)}else{this.systemEventService.publishAsync(this.optionEventId,this.model[this.qualifier])}}};fn=__decorate([s.Component({selector:"se-thumbnail-select",template:`<se-generic-editor-dropdown [id]="id" [field]="field" [qualifier]="qualifier" [model]="model"></se-generic-editor-dropdown>`}),__param(1,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[m.SystemEventService,Object])],fn);window.__smartedit__.addDecoratorPayload("Component","MuteBooleanComponent",{selector:"se-mute-boolean",template:`<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label" for="{{widget.qualifier}}-checkbox"><input type="checkbox" id="{{widget.qualifier}}-checkbox" class="se-boolean__input" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]"/> <span class="fd-toggle__switch" role="presentation"></span></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>`});let yn=class MuteBooleanComponent{constructor(e,t){this.systemEventService=e;this.widget=t;if(this.widget.field.dependsOnField){this.widget.field.hideFieldWidget=true;const e=`${this.widget.id}${this.widget.field.dependsOnField}${m.CLICK_DROPDOWN}`;this.unRegClickValueChanged=this.systemEventService.subscribe(e,((e,t)=>this.onDependencyValueChangedEvent(t)))}}onDependencyValueChangedEvent(e){this.widget.field.hideFieldWidget=e!==this.widget.field.dependsOnValue;if(this.widget.field.hideFieldWidget){this.widget.model[this.widget.qualifier]=false}}};yn=__decorate([s.Component({selector:"se-mute-boolean",template:`<div class="se-boolean fd-form__item fd-form__item--check"><span class="fd-toggle fd-toggle--xs fd-form__control"><label class="fd-form__label" for="{{widget.qualifier}}-checkbox"><input type="checkbox" id="{{widget.qualifier}}-checkbox" class="se-boolean__input" [placeholder]="(widget.field.tooltip || '') | translate" [attr.name]="widget.qualifier" [disabled]="!widget.field.editable" [(ngModel)]="widget.model[widget.qualifier]"/> <span class="fd-toggle__switch" role="presentation"></span></label></span><p *ngIf="widget.field.labelText && !widget.model[widget.qualifier]" class="se-boolean__text">{{widget.field.labelText| translate}}</p></div>`}),__param(1,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[m.SystemEventService,Object])],yn);window.__smartedit__.addDecoratorPayload("Component","WorkflowCreateVersionFieldComponent",{selector:"se-workflow-create-version-field",template:`<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label class="fd-form__label"><input type="checkbox" class="fd-form__control" name="createVersion" [(ngModel)]="model.createVersion"/> {{ 'se.cms.workflow.editor.create.version' | translate }}</label></div><div class="fd-form__item" *ngIf="model.createVersion"><label class="fd-form__label version-label__title" for="versionLabel" translate="se.cms.workflow.editor.create.version.label"></label> <input type="text" name="versionLabel" class="fd-form__control" [class.has-error]="field.hasErrors" [(ngModel)]="model.versionLabel"/></div></div>`,providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush});let Sn=class WorkflowCreateVersionFieldComponent{constructor(e,t,o,n){this.workflowService=e;this.data=t;this.cdr=o;this.l10nPipe=n;({field:this.field,model:this.model,editor:this.editor}=t)}ngOnInit(){this.unregisterOnChangeEvent=this.editor.api.addContentChangeEvent((()=>this.onCreateVersionChange()))}ngOnDestroy(){this.unregisterOnChangeEvent()}onCreateVersionChange(){return __awaiter(this,void 0,void 0,(function*(){if(this.model.createVersion===false){this.model.versionLabel=null;if(!this.cdr.destroyed){this.cdr.detectChanges()}return}if(!u.isEmpty(this.model.versionLabel)){return}if(this.model.decisionCode){const e=yield this.workflowService.getAllActionsForWorkflowCode(this.model.workflowCode);const t=e.find((e=>e.code===this.model.actionCode));const o=t.decisions.find((e=>e.code===this.model.decisionCode));const[n,s]=yield Promise.all([this.l10nPipe.transform(o.name).pipe(g.take(1)).toPromise(),this.l10nPipe.transform(t.name).pipe(g.take(1)).toPromise()]);this.model.versionLabel=`${n} for ${s}`;if(!this.cdr.destroyed){this.cdr.detectChanges()}return}const e=yield this.workflowService.getWorkflowTemplateByCode(this.model.templateCode);if(e){const t=yield this.l10nPipe.transform(e.name).pipe(g.take(1)).toPromise();this.model.versionLabel=`${t} workflow started`;if(!this.cdr.destroyed){this.cdr.detectChanges()}}}))}};Sn=__decorate([s.Component({selector:"se-workflow-create-version-field",template:`<div class="fd-form__set"><div class="fd-form__item fd-form__item--check"><label class="fd-form__label"><input type="checkbox" class="fd-form__control" name="createVersion" [(ngModel)]="model.createVersion"/> {{ 'se.cms.workflow.editor.create.version' | translate }}</label></div><div class="fd-form__item" *ngIf="model.createVersion"><label class="fd-form__label version-label__title" for="versionLabel" translate="se.cms.workflow.editor.create.version.label"></label> <input type="text" name="versionLabel" class="fd-form__control" [class.has-error]="field.hasErrors" [(ngModel)]="model.versionLabel"/></div></div>`,providers:[m.L10nPipe],changeDetection:s.ChangeDetectionStrategy.OnPush}),__param(1,s.Inject(m.GENERIC_EDITOR_WIDGET_DATA)),__metadata("design:paramtypes",[m.WorkflowService,Object,s.ChangeDetectorRef,m.L10nPipe])],Sn);let Cn=class CmsGenericEditorConfigurationService{constructor(e,t){this.editorFieldMappingService=e;this.genericEditorTabService=t;this.DEFAULT_PAGE_TAB_ID="information";this.CATEGORIES={PAGE:"PAGE",COMPONENT:"COMPONENT"};this.defaultTabPredicate=e=>e.category===this.CATEGORIES.PAGE?this.DEFAULT_PAGE_TAB_ID:null;this.isPagePredicate=(e,t,o)=>o.category===this.CATEGORIES.PAGE;this.isComponentPredicate=(e,t,o)=>o.category===this.CATEGORIES.COMPONENT}setDefaultEditorFieldMappings(){this.editorFieldMappingService.addFieldMapping("Media",null,null,{component:zo});this.editorFieldMappingService.addFieldMapping("MediaContainer",null,null,{component:Uo});this.editorFieldMappingService.addFieldMapping("NavigationNodeSelector",null,null,{component:go});this.editorFieldMappingService.addFieldMapping("MultiProductSelector",null,null,{component:Pt});this.editorFieldMappingService.addFieldMapping("MultiCategorySelector",null,null,{component:xt});this.editorFieldMappingService.addFieldMapping("CMSLinkToSelect",null,null,{component:Eo});this.editorFieldMappingService.addFieldMapping("OptionalCMSLinkToSelect",null,null,{component:Eo,tooltip:"se.cms.linkto.tooltip"});this.editorFieldMappingService.addFieldMapping("SingleOnlineProductSelector",null,null,{component:gn});this.editorFieldMappingService.addFieldMapping("SingleOnlineCategorySelector",null,null,{component:gn});this.editorFieldMappingService.addFieldMapping("CMSItemDropdown",null,null,{component:t.CmsComponentDropdownComponent});this.editorFieldMappingService.addFieldMapping("CMSComponentRestrictionsEditor",null,null,{component:t.ComponentRestrictionsEditorComponent});this.editorFieldMappingService.addFieldMapping("PageRestrictionsEditor",null,"restrictions",{component:t.PageRestrictionsEditorComponent});this.editorFieldMappingService.addFieldMapping("DisplayConditionEditor",null,"displayCondition",{component:Ci,hidePrefixLabel:true});this.editorFieldMappingService.addFieldMapping("ShortString",this.isPagePredicate,"typeCode",{component:cn,hidePrefixLabel:true});this.editorFieldMappingService.addFieldMapping("InfoPageName",this.isPagePredicate,null,{component:To});this.editorFieldMappingService.addFieldMapping("Boolean",null,"visible",{component:m.BooleanComponent,i18nKey:"type.component.abstractcmscomponent.visible.name"});this.editorFieldMappingService.addFieldMapping("LinkToggle",null,null,{component:Po});this.editorFieldMappingService.addFieldMapping("RestrictionsList",null,null,{component:dn,hidePrefixLabel:true});this.editorFieldMappingService.addFieldMapping("Video",null,null,{component:zo,allowMediaType:m.GenericEditorMediaType.VIDEO,tooltip:"se.cms.video.tooltip"});this.editorFieldMappingService.addFieldMapping("VideoMute",null,null,{component:yn,hideFieldWidget:true,dependsOnField:"autoPlay",dependsOnValue:"true"});this.editorFieldMappingService.addFieldMapping("VideoThumbnailSelector",null,null,{component:fn,hideFieldWidget:false,dependsOnField:"autoPlay",dependsOnValue:"false"});this.editorFieldMappingService.addFieldMapping("Thumbnail",null,null,{component:Uo,hideFieldWidget:true,hidePrefixLabel:true,dependsOnField:"thumbnailSelector",dependsOnValue:_n.uploadThumbnail,allowMediaType:m.GenericEditorMediaType.IMAGE});this.editorFieldMappingService.addFieldMapping("PDFFile",null,null,{component:zo,allowMediaType:m.GenericEditorMediaType.PDF_DOCUMENT});this.editorFieldMappingService.addFieldMapping("DuplicatePrimaryNonContentPageMessage",null,null,{component:rn,hidePrefixLabel:true});this.editorFieldMappingService.addFieldMapping("DuplicatePrimaryContentPage",null,null,{component:ln,hidePrefixLabel:false});this.editorFieldMappingService.addFieldMapping("MissingPrimaryContentPage",null,null,{component:an,hidePrefixLabel:false});this.editorFieldMappingService.addFieldMapping("WorkflowCreateVersionField",null,null,{component:Sn,hidePrefixLabel:false});this.editorFieldMappingService.addFieldMapping("SlotSharedCloneActionField",null,null,{component:hn,hidePrefixLabel:false});this.editorFieldMappingService.addFieldMapping("SlotSharedSlotTypeField",null,null,{component:vn,hidePrefixLabel:false})}setDefaultTabsConfiguration(){this.genericEditorTabService.configureTab("default",{priority:5});this.genericEditorTabService.configureTab("information",{priority:5});this.genericEditorTabService.configureTab("administration",{priority:4})}setDefaultTabFieldMappings(){this.genericEditorTabService.addComponentTypeDefaultTabPredicate(this.defaultTabPredicate);this.editorFieldMappingService.addFieldTabMapping(null,this.isComponentPredicate,"visible","visibility");this.editorFieldMappingService.addFieldTabMapping(null,this.isComponentPredicate,"restrictions","visibility");this.editorFieldMappingService.addFieldTabMapping(null,this.isComponentPredicate,"onlyOneRestrictionMustApply","visibility");this.editorFieldMappingService.addFieldTabMapping(null,this.isComponentPredicate,"uid","basicinfo");this.editorFieldMappingService.addFieldTabMapping(null,this.isComponentPredicate,"id","basicinfo");this.editorFieldMappingService.addFieldTabMapping(null,this.isComponentPredicate,"modifiedtime","basicinfo");this.editorFieldMappingService.addFieldTabMapping("DateTime",this.isComponentPredicate,"creationtime","basicinfo");this.editorFieldMappingService.addFieldTabMapping("DisplayConditionEditor",this.isPagePredicate,"displayCondition","displaycondition");this.editorFieldMappingService.addFieldTabMapping(null,this.isPagePredicate,"restrictions","restrictions")}};Cn.$inject=["editorFieldMappingService","genericEditorTabService"];Cn=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.EditorFieldMappingService,m.GenericEditorTabService])],Cn);let bn=class ProductDropdownPopulator extends m.DropdownPopulatorInterface{constructor(e,t,o,n){super(T,t,o);this.contextAwareCatalogService=e;this.uriDropdownPopulator=n}fetchPage(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.contextAwareCatalogService.getProductSearchUri(e.model.productCatalog);e.field.uri=t;return this.uriDropdownPopulator.fetchPage(e)}))}isPaged(){return true}getItem(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.contextAwareCatalogService.getProductItemUri();e.field.uri=t;return this.uriDropdownPopulator.getItem(e)}))}};bn.$inject=["contextAwareCatalogService","languageService","translateService","uriDropdownPopulator"];bn=__decorate([s.Injectable(),__metadata("design:paramtypes",[t.ContextAwareCatalogService,m.LanguageService,v.TranslateService,m.UriDropdownPopulator])],bn);let In=class ProductCatalogDropdownPopulator extends m.DropdownPopulatorInterface{constructor(e,t,o,n){super(T,t,n);this.catalogService=e;this.optionsDropdownPopulator=o}fetchAll(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.catalogService.getProductCatalogsBySiteKey(m.CONTEXT_SITE_ID);e.field.options=t.filter((e=>this.hasCatalogOneActiveVersion(e)));return this.optionsDropdownPopulator.fetchAll(e)}))}isPaged(){return false}hasCatalogOneActiveVersion(e){const t=e.versions.filter((e=>e.active===true));return t.length===1}};In.$inject=["catalogService","languageService","optionsDropdownPopulator","translateService"];In=__decorate([s.Injectable(),__metadata("design:paramtypes",[m.ICatalogService,m.LanguageService,m.OptionsDropdownPopulator,v.TranslateService])],In);let wn=class CategoryDropdownPopulator extends m.DropdownPopulatorInterface{constructor(e,t,o,n){super(T,t,o);this.contextAwareCatalogService=e;this.uriDropdownPopulator=n}fetchPage(e){return __awaiter(this,void 0,void 0,(function*(){if(e.model.productCatalog===undefined){throw new Error('"productCatalog" is required but it was not provided.')}const t=yield this.contextAwareCatalogService.getProductCategorySearchUri(e.model.productCatalog);e.field.uri=t;const o=yield this.languageService.getResolveLocale();e.field.params.langIsoCode=o;return this.uriDropdownPopulator.fetchPage(e)}))}getItem(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.contextAwareCatalogService.getProductCategoryItemUri();e.field.uri=t;return this.uriDropdownPopulator.getItem(e)}))}isPaged(){return true}};wn.$inject=["contextAwareCatalogService","languageService","translateService","uriDropdownPopulator"];wn=__decorate([s.Injectable(),__metadata("design:paramtypes",[t.ContextAwareCatalogService,m.LanguageService,v.TranslateService,m.UriDropdownPopulator])],wn);let En=class CmsLinkComponentContentPageDropdownPopulator extends m.DropdownPopulatorInterface{constructor(e,t,o,n){super(T,t,o);this.contextAwareCatalogService=e;this.uriDropdownPopulator=n}fetchPage(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.contextAwareCatalogService.getContentPageSearchUri();e.field.uri=t;return this.uriDropdownPopulator.fetchPage(e)}))}getItem(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.contextAwareCatalogService.getContentPageItemUri();e.field.uri=t;return this.uriDropdownPopulator.getItem(e)}))}isPaged(){return true}};En.$inject=["contextAwareCatalogService","languageService","translateService","uriDropdownPopulator"];En=__decorate([s.Injectable(),__metadata("design:paramtypes",[t.ContextAwareCatalogService,m.LanguageService,v.TranslateService,m.UriDropdownPopulator])],En);let Tn=class GenericEditorWidgetsModule{};Tn=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),a.FormsModule,f.CommonModule,m.L10nPipeModule,m.SelectModule,m.GenericEditorDropdownModule,Dt,so],providers:[Cn,{provide:m.CustomDropdownPopulatorsToken,useClass:bn,multi:true},{provide:m.CustomDropdownPopulatorsToken,useClass:In,multi:true},{provide:m.CustomDropdownPopulatorsToken,useClass:wn,multi:true},{provide:m.CustomDropdownPopulatorsToken,useClass:En,multi:true}],declarations:[Sn,an,rn,ln,dn,hn,vn,Eo,cn,gn,pn,Po,To,fn,yn],entryComponents:[Sn,an,rn,ln,dn,hn,vn,Eo,cn,gn,pn,Po,To,fn,yn],exports:[Sn,Dt]})],Tn);window.__smartedit__.addDecoratorPayload("Component","TrashedPageListComponent",{selector:"se-trashed-page-list",template:`<div class="se-page-list"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell ySmartEditTrashPageToolbar" imageRoot="imageRoot" toolbarName="smartEditTrashPageToolbar"></se-toolbar><div class="se-page-list__header"><span class="se-page-list__catalog-name" translate="se.cms.trashedpagelist.title"></span><p class="se-page-list__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</p></div><div class="se-page-list__body"><div class="se-page-list__table-header"><span class="se-paged-list__page-count-wrapper"><span class="span-page-list__page-count-text" translate="se.pagelist.countsearchresult"></span> <span>&nbsp;</span> <span class="se-page-list__page-count">({{ count }})</span></span><div class="fd-form__group se-page-list__search"><div class="se-input-group"><input type="search" class="se-input-group__input-area ySEPage-list-search-input" placeholder="{{ 'se.cms.pagelist.searchplaceholder' | translate }}" [ngModel]="mask" (ngModelChange)="onMaskChange($event)" name="mask"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="mask" aria-label="clear" class="se-input-group__addon se-input-group__clear-btn" (click)="reset()"><span class="sap-icon--decline"></span></div></div></div></div><div class="se-page-list__table-body"><se-dynamic-paged-list class="se-trashed-pages" [config]="trashedPageListConfig" [mask]="mask" (getApi)="getApi($event);" (onItemsUpdate)="onPageItemsUpdate($event.pagination)"></se-dynamic-paged-list></div></div></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None});let Pn=class TrashedPageListComponent{constructor(e,t,o,n,s){this.catalogService=e;this.route=t;this.urlService=o;this.systemEventService=n;this.cdr=s;this.mask="";this.dropdownItems=[];this.count=0;this.maskSubject$=new E.Subject}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){yield this.initialize();this.unsubscribeEventListener=this.systemEventService.subscribe(m.EVENT_CONTENT_CATALOG_UPDATE,this.onContentCatalogUpdate.bind(this));this.maskSubscription=this.maskSubject$.pipe(I.debounceTime(500),I.distinctUntilChanged()).subscribe((e=>{this.mask=e;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}))}ngOnDestroy(){this.unsubscribeEventListener();this.maskSubscription.unsubscribe()}onMaskChange(e){this.maskSubject$.next(e)}onPageItemsUpdate(e){this.count=e.totalCount}reset(){this.mask=""}getApi(e){this.dynamicPagedListApi=e}initialize(){return __awaiter(this,void 0,void 0,(function*(){this.setSiteParams();this.setUriContext();this.setTrashedListConfigBasis();this.setTrashedListColumns();return this.setCatalogName()}))}onContentCatalogUpdate(){if(this.dynamicPagedListApi){this.dynamicPagedListApi.reloadItems()}}setSiteParams(){this.siteUID=this.route.snapshot.params.siteId;this.catalogId=this.route.snapshot.params.catalogId;this.catalogVersion=this.route.snapshot.params.catalogVersion}setUriContext(){this.uriContext=this.urlService.buildUriContext(this.siteUID,this.catalogId,this.catalogVersion)}setTrashedListConfigBasis(){this.trashedPageListConfig={sortBy:"name",reversed:false,itemsPerPage:10,displayCount:true,uri:m.cmsitemsUri,queryParams:{catalogId:this.catalogId,catalogVersion:this.catalogVersion,typeCode:"AbstractPage",itemSearchParams:"pageStatus:deleted"},keys:[]}}setCatalogName(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.getContentCatalogsForSite(this.siteUID);this.catalogName=e.find((e=>e.catalogId===this.catalogId)).name}))}setTrashedListColumns(){this.trashedPageListConfig.keys=[{property:"name",i18n:"se.cms.pagelist.headerpagename",sortable:true},{property:"uid",i18n:"se.cms.pagelist.headerpageid",sortable:true},{property:"itemtype",i18n:"se.cms.pagelist.headerpagetype",sortable:true},{property:"label",i18n:"se.cms.pagelist.headerpagelable",sortable:false},{property:"numberOfRestrictions",i18n:"se.cms.pagelist.headerrestrictions",sortable:false,component:Yi},{property:"modifiedtime",i18n:"se.cms.trashedpagelist.trashed.date",sortable:true,component:Ki},{property:"pageStatus",i18n:"se.cms.pagelist.headerpagestatus",sortable:false,component:Zi},{property:"dropdownitems",i18n:"",sortable:false,component:Wi}]}};Pn.$inject=["catalogService","route","urlService","systemEventService","cdr"];Pn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-trashed-page-list",template:`<div class="se-page-list"><se-toolbar cssClass="se-toolbar--shell" imageRoot="imageRoot" toolbarName="smartEditHeaderToolbar"></se-toolbar><se-toolbar cssClass="se-toolbar--shell ySmartEditTrashPageToolbar" imageRoot="imageRoot" toolbarName="smartEditTrashPageToolbar"></se-toolbar><div class="se-page-list__header"><span class="se-page-list__catalog-name" translate="se.cms.trashedpagelist.title"></span><p class="se-page-list__sub-title">{{ catalogName | seL10n | async }} - {{ catalogVersion }}</p></div><div class="se-page-list__body"><div class="se-page-list__table-header"><span class="se-paged-list__page-count-wrapper"><span class="span-page-list__page-count-text" translate="se.pagelist.countsearchresult"></span> <span>&nbsp;</span> <span class="se-page-list__page-count">({{ count }})</span></span><div class="fd-form__group se-page-list__search"><div class="se-input-group"><input type="search" class="se-input-group__input-area ySEPage-list-search-input" placeholder="{{ 'se.cms.pagelist.searchplaceholder' | translate }}" [ngModel]="mask" (ngModelChange)="onMaskChange($event)" name="mask"/> <span class="sap-icon--search se-input-group__addon"></span><div *ngIf="mask" aria-label="clear" class="se-input-group__addon se-input-group__clear-btn" (click)="reset()"><span class="sap-icon--decline"></span></div></div></div></div><div class="se-page-list__table-body"><se-dynamic-paged-list class="se-trashed-pages" [config]="trashedPageListConfig" [mask]="mask" (getApi)="getApi($event);" (onItemsUpdate)="onPageItemsUpdate($event.pagination)"></se-dynamic-paged-list></div></div></div>`,styles:[`.se-page-list{background-color:#edeff0;min-height:100vh;height:100%}.se-page-list__page-link-anchor{text-decoration:none!important;color:#51555a}.se-page-list__page-link-anchor:hover{color:#0a6ed1}.se-page-list__header{padding:16px 30px;background-color:#fff}.se-page-list__page-link-icon{font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;color:#51555a}.se-page-list__catalog-name{font-size:1.7142857143rem;line-height:1.3333333333;font-weight:400;display:block;margin-bottom:4px}.se-page-list__sub-title{color:#6a6d70}.se-page-list__body{padding:20px 20px 70px}.se-page-list__page-link--left{cursor:pointer}.se-page-list__page-link--left .se-page-list__page-link-anchor{margin-left:3px}.se-page-list__page-link--right{cursor:pointer}.se-page-list__page-link--right .se-page-list__page-link-anchor{margin-right:3px}.se-page-list__table-header{display:flex;flex-direction:row;align-items:center;justify-content:space-between;background-color:#fff;height:56px;padding:20px;border-radius:4px 4px 0 0}.se-page-list__table-header--right{display:flex;flex-direction:row;align-items:center}.se-page-list__table-header .se-paged-list__page-count-wrapper{font-size:1.1428571429rem;line-height:1.25;font-weight:400;margin-right:auto}.se-page-list__table-body{padding-bottom:16px}.se-page-list__table-body .se-data-table__arrow{margin-left:2px}.se-page-list__table-body .se-paged-list-item{cursor:default}.se-page-list__search{margin-right:16px;width:380px}.se-page-list__add{text-transform:capitalize}.se-paged-list__header{font-size:1rem;line-height:1.4285714286;font-weight:400}.se-paged-list__header-dropdownitems,.se-paged-list__header-pageStatus,.se-paged-list__header-syncStatus{cursor:default}.se-paged-list-item-name a{text-decoration:none!important}.se-sync-btn__status--done{color:#0a7e3e}.se-sync-btn__status--not{color:#e9730c}.ySmartEditTrashPageToolbar{background-color:#fff}.fd-table td.se-paged-list-item-numberOfRestrictions,.fd-table td.se-paged-list-item-syncStatus,.fd-table th.se-paged-list__header-numberOfRestrictions,.fd-table th.se-paged-list__header-syncStatus{text-align:center}.fd-table td.se-paged-list-item-syncStatus{font-size:1.1428571429rem;line-height:1.25;font-weight:400}`],changeDetection:s.ChangeDetectionStrategy.OnPush,encapsulation:s.ViewEncapsulation.None}),__metadata("design:paramtypes",[m.ICatalogService,w.ActivatedRoute,m.IUrlService,m.SystemEventService,s.ChangeDetectorRef])],Pn);let An=class TrashedPageListModule{};An=__decorate([s.NgModule({imports:[f.CommonModule,m.SeTranslationModule.forChild(),a.FormsModule,b.ToolbarModule,m.L10nPipeModule,m.DynamicPagedListModule],declarations:[Pn]})],An);window.__smartedit__.addDecoratorPayload("Component","VersionItemContextComponent",{selector:"se-version-item-context",template:`<div class="se-version-item-context"><span class="sap-icon--navigation-right-arrow"></span><se-tooltip *ngIf="(pageVersion$ | async) as pageVersion" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [isChevronVisible]="true"><div se-tooltip-trigger class="se-version-item-context__info"><div class="se-version-item-context__info-label" [title]="pageVersion.label">{{ pageVersion.label }}</div><div class="se-version-item-context__info-date">{{ pageVersion.creationtime | date: 'M/d/yy h:mm a' }}</div></div><div se-tooltip-body class="se-version-item-context__description-wrapper"><span class="se-version-item-context__description">{{ pageVersion.description || (EMPTY_DESCRIPTION_MSG_KEY | translate) }}</span></div></se-tooltip><button type="button" (click)="deselectPageVersion()" class="se-version-item-context__remove-btn fd-button--light sap-icon--decline"></button></div>`,styles:[`.se-version-item-context{display:flex;flex-direction:row;align-items:center;height:40px;border-right:1px solid #d9d9d9}.se-version-item-context .sap-icon--navigation-right-arrow{padding-right:12px;color:#51555a}.se-version-item-context__info{display:flex;flex-direction:column}.se-version-item-context__info-label{font-weight:700;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:90px}.se-version-item-context__info-date{color:#6a6d70;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400}.se-version-item-context__remove-btn{padding:0;margin:8px;min-width:20px;height:20px;color:#32363a;background:0 0;border:transparent;line-height:1}.se-version-item-context__remove-btn::before{margin:0!important}.se-version-item-context__description-wrapper{word-wrap:break-word}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let On=class VersionItemContextComponent{constructor(e){this.pageVersionSelectionService=e;this.EMPTY_DESCRIPTION_MSG_KEY="se.cms.versions.no.description"}ngOnInit(){this.pageVersion$=this.pageVersionSelectionService.getSelectedPageVersion$();this.pageVersionSelectionService.hideToolbarContextIfNotNeeded()}deselectPageVersion(){this.pageVersionSelectionService.deselectPageVersion()}};On.$inject=["pageVersionSelectionService"];On=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-version-item-context",template:`<div class="se-version-item-context"><span class="sap-icon--navigation-right-arrow"></span><se-tooltip *ngIf="(pageVersion$ | async) as pageVersion" [triggers]="['mouseenter', 'mouseleave']" [placement]="'bottom'" [isChevronVisible]="true"><div se-tooltip-trigger class="se-version-item-context__info"><div class="se-version-item-context__info-label" [title]="pageVersion.label">{{ pageVersion.label }}</div><div class="se-version-item-context__info-date">{{ pageVersion.creationtime | date: 'M/d/yy h:mm a' }}</div></div><div se-tooltip-body class="se-version-item-context__description-wrapper"><span class="se-version-item-context__description">{{ pageVersion.description || (EMPTY_DESCRIPTION_MSG_KEY | translate) }}</span></div></se-tooltip><button type="button" (click)="deselectPageVersion()" class="se-version-item-context__remove-btn fd-button--light sap-icon--decline"></button></div>`,styles:[`.se-version-item-context{display:flex;flex-direction:row;align-items:center;height:40px;border-right:1px solid #d9d9d9}.se-version-item-context .sap-icon--navigation-right-arrow{padding-right:12px;color:#51555a}.se-version-item-context__info{display:flex;flex-direction:column}.se-version-item-context__info-label{font-weight:700;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:90px}.se-version-item-context__info-date{color:#6a6d70;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400}.se-version-item-context__remove-btn{padding:0;margin:8px;min-width:20px;height:20px;color:#32363a;background:0 0;border:transparent;line-height:1}.se-version-item-context__remove-btn::before{margin:0!important}.se-version-item-context__description-wrapper{word-wrap:break-word}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.PageVersionSelectionService])],On);window.__smartedit__.addDecoratorPayload("Component","VersionItemComponent",{selector:"se-version-item",template:`<div class="se-version-item" [ngClass]="{ 'se-version-item--selected': isSelectedVersion() }"><div class="se-version-item__header" [title]="pageVersion.label"><button class="se-version-item__label se-button--text" (click)="selectVersion()">{{ pageVersion.label }}</button><se-version-item-menu *ngIf="isVersionMenuEnabled()" [item]="pageVersion"></se-version-item-menu></div><div class="se-version-item__date">{{ pageVersion.creationtime | date: 'M/d/yy h:mm a' }}</div><div class="se-version-item__description" *ngIf="pageVersion.description"><se-more-text class="se-version-item__description-text" [text]="pageVersion.description" [limit]="32" [ellipsis]="'...'" [capitalizeLabel]="true"></se-more-text></div></div>`,styles:[`:host(.se-version-item--last) .se-version-item{border-bottom:none}.se-version-item{padding:10px 20px;border-bottom:1px solid #d9d9d9}.se-version-item:hover{background-color:#fafafa}.se-version-item--selected{background-color:rgba(10,110,209,.07)}.se-version-item--selected:hover{background-color:rgba(10,110,209,.1)}.se-version-item__header{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.se-version-item__label{font-weight:700;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:225px;color:#0a6ed1}.se-version-item__date{color:#6a6d70}.se-version-item__description{display:flex;flex-direction:row;align-items:center;max-width:260px}.se-version-item__description-text{padding-right:2px;width:230px;word-break:break-all;white-space:normal}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let xn=class VersionItemComponent{constructor(e,t,o){this.pageVersionSelectionService=e;this.perspectiveService=t;this.cMSModesService=o;this.VERSIONING_MODE_KEY=m.CMSModesService.VERSIONING_PERSPECTIVE_KEY}selectVersion(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.cMSModesService.isVersioningPerspectiveActive();if(!e){this.perspectiveService.switchTo(this.VERSIONING_MODE_KEY)}this.pageVersionSelectionService.selectPageVersion(this.pageVersion)}))}isSelectedVersion(){const e=this.pageVersionSelectionService.getSelectedPageVersion();return e&&e.uid===this.pageVersion.uid}isVersionMenuEnabled(){const e=this.perspectiveService.getActivePerspective();return e&&e.key===this.VERSIONING_MODE_KEY}};xn.$inject=["pageVersionSelectionService","perspectiveService","cMSModesService"];__decorate([s.Input(),__metadata("design:type",Object)],xn.prototype,"pageVersion",void 0);xn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-version-item",template:`<div class="se-version-item" [ngClass]="{ 'se-version-item--selected': isSelectedVersion() }"><div class="se-version-item__header" [title]="pageVersion.label"><button class="se-version-item__label se-button--text" (click)="selectVersion()">{{ pageVersion.label }}</button><se-version-item-menu *ngIf="isVersionMenuEnabled()" [item]="pageVersion"></se-version-item-menu></div><div class="se-version-item__date">{{ pageVersion.creationtime | date: 'M/d/yy h:mm a' }}</div><div class="se-version-item__description" *ngIf="pageVersion.description"><se-more-text class="se-version-item__description-text" [text]="pageVersion.description" [limit]="32" [ellipsis]="'...'" [capitalizeLabel]="true"></se-more-text></div></div>`,styles:[`:host(.se-version-item--last) .se-version-item{border-bottom:none}.se-version-item{padding:10px 20px;border-bottom:1px solid #d9d9d9}.se-version-item:hover{background-color:#fafafa}.se-version-item--selected{background-color:rgba(10,110,209,.07)}.se-version-item--selected:hover{background-color:rgba(10,110,209,.1)}.se-version-item__header{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.se-version-item__label{font-weight:700;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:225px;color:#0a6ed1}.se-version-item__date{color:#6a6d70}.se-version-item__description{display:flex;flex-direction:row;align-items:center;max-width:260px}.se-version-item__description-text{padding-right:2px;width:230px;word-break:break-all;white-space:normal}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.PageVersionSelectionService,m.IPerspectiveService,m.CMSModesService])],xn);let Dn=class ManagePageVersionService{constructor(e,t,o,n,s,a,r){this.alertService=e;this.experienceService=t;this.confirmationModalService=o;this.genericEditorModalService=n;this.pageInfoService=s;this.pageVersioningService=a;this.pageVersionSelectionService=r}createPageVersion(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUUID();const t=this.getComponentDataForEditor(e,null);return this.genericEditorModalService.open(t,(e=>__awaiter(this,void 0,void 0,(function*(){const t={versionId:e.uid};yield this.experienceService.updateExperience(t);this.alertService.showSuccess("se.cms.versions.create.alert.success");this.pageVersionSelectionService.selectPageVersion(e)}))))}))}editPageVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageInfoService.getPageUUID();const o=this.getComponentDataForEditor(t,e);return this.genericEditorModalService.open(o,(e=>{this.pageVersionSelectionService.updatePageVersionDetails(e)}))}))}deletePageVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.pageInfoService.getPageUUID();yield this.confirmationModalService.confirm({title:"se.cms.actionitem.page.version.delete.confirmation.title",description:"se.cms.actionitem.page.version.delete.confirmation.description"});yield this.pageVersioningService.deletePageVersion(t,e);this.alertService.showSuccess("se.cms.versions.delete.alert.success");const o=this.pageVersionSelectionService.getSelectedPageVersion();if(o&&o.uid===e){yield this.experienceService.updateExperience();this.pageVersionSelectionService.deselectPageVersion()}}))}getComponentDataForEditor(e,t){const o={title:t?"se.cms.versions.edit":"se.cms.versions.create",structure:{attributes:[{cmsStructureType:"ShortString",qualifier:"label",i18nKey:"se.cms.versions.editor.label.name",required:true},{cmsStructureType:"ShortString",qualifier:"description",i18nKey:"se.cms.versions.editor.description.name"}]},contentApi:this.pageVersioningService.getResourceURI().replace(":pageUuid",e)};if(t){o.content=t;o.componentUuid=t.uid;o.componentType="versioning"}return o}};Dn.$inject=["alertService","experienceService","confirmationModalService","genericEditorModalService","pageInfoService","pageVersioningService","pageVersionSelectionService"];Dn=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.IAlertService,m.IExperienceService,m.IConfirmationModalService,t.GenericEditorModalService,m.IPageInfoService,m.PageVersioningService,m.PageVersionSelectionService])],Dn);let Rn=class RollbackPageVersionService{constructor(e,t,o,n,s,a,r,d){this.logService=e;this.alertService=t;this.confirmationModalService=o;this.experienceService=n;this.pageInfoService=s;this.pageVersioningService=a;this.pageVersionSelectionService=r;this.systemEventService=d}rollbackPageVersion(e){return __awaiter(this,void 0,void 0,(function*(){const t=e||this.pageVersionSelectionService.getSelectedPageVersion();if(!!t){const e="se.cms.actionitem.page.version.rollback.confirmation";const o=yield this.pageInfoService.getPageUUID();yield this.showConfirmationModal(t.label,e);yield this.performRollback(o,t)}}))}showConfirmationModal(e,t){return this.confirmationModalService.confirm({title:`${t}.title`,description:`${t}.description`,descriptionPlaceholders:{versionLabel:e}})}performRollback(e,t){return __awaiter(this,void 0,void 0,(function*(){try{yield this.pageVersioningService.rollbackPageVersion(e,t.uid);this.systemEventService.publishAsync(m.EVENT_CONTENT_CATALOG_UPDATE);this.alertService.showSuccess("se.cms.versions.rollback.alert.success");yield this.experienceService.updateExperience({});this.pageVersionSelectionService.deselectPageVersion(false)}catch(e){this.logService.error("RollbackPageVersionService::performRollback - unable to perform page rollback")}}))}};Rn.$inject=["logService","alertService","confirmationModalService","experienceService","pageInfoService","pageVersioningService","pageVersionSelectionService","systemEventService"];Rn=__decorate([m.SeDowngradeService(),__metadata("design:paramtypes",[m.LogService,m.IAlertService,m.IConfirmationModalService,m.IExperienceService,m.IPageInfoService,m.PageVersioningService,m.PageVersionSelectionService,m.SystemEventService])],Rn);window.__smartedit__.addDecoratorPayload("Component","VersionItemMenuComponent",{selector:"se-version-item-menu",template:`<se-popup-overlay class="se-version-item-menu__popup-anchor" [ngClass]="{ 'se-version-item-menu__popup-anchor--open': isMenuOpen }" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><div *ngIf="menuItems.length > 0" (click)="onButtonClick($event)" class="sap-icon--overflow se-version-item-menu__toggle"></div><div se-popup-overlay-body class="se-version-item-menu fd-menu"><div class="se-version-item-menu__item fd-menu__list" *ngFor="let item of menuItems" (click)="executeItemCallback(item)"><span class="se-version-item-menu__item-link fd-menu__item">{{ item.i18nKey | translate }}</span></div></div></se-popup-overlay>`,styles:[`.se-version-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.se-version-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-version-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-version-item-menu::after,.se-version-item-menu::before{right:10px}.se-version-item-menu::after,.se-version-item-menu::before{display:none}.se-version-item-menu__item:last-child .se-version-item-menu__item-link{color:#b00}.se-version-item-menu__popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-version-item-menu__toggle{height:20px;width:20px;cursor:pointer}.sap-icon--overflow{color:#0a6ed1}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let kn=class VersionItemMenuComponent{constructor(e,t,o,n,s,a){this.managePageVersionService=e;this.pageVersionSelectionService=t;this.rollbackPageVersionService=o;this.permissionService=n;this.cdr=s;this.userTrackingService=a;this.menuItems=[];this.popupConfig={halign:"left",valign:"bottom"};this.isMenuOpen=false}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.menuItems=yield this.getPermittedButtons(this.getButtonsConfiguration());if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}onButtonClick(e){e.stopPropagation();this.isMenuOpen=!this.isMenuOpen}hideMenu(){this.isMenuOpen=false}executeItemCallback(e){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.VERSION_MANAGEMENT,e.i18nKey);e.callback(this.item);this.hideMenu()}getPermittedButtons(e){return __awaiter(this,void 0,void 0,(function*(){const t=e.map((e=>this.permissionService.isPermitted([{names:e.permissions}])));const o=yield Promise.all(t);return e.filter(((e,t)=>o[t]))}))}getButtonsConfiguration(){return[{i18nKey:"se.cms.version.item.menu.view.label",callback:e=>this.viewItemCallback(e),permissions:["se.version.page"]},{i18nKey:"se.cms.version.item.menu.edit.label",callback:e=>this.editItemCallback(e),permissions:["se.edit.version.page"]},{i18nKey:"se.cms.version.item.menu.rollback.label",callback:e=>this.rollbackItemCallback(e),permissions:["se.rollback.version.page.versions.menu"]},{i18nKey:"se.cms.version.item.menu.delete.label",callback:e=>this.deleteItemCallback(e),permissions:["se.delete.version.page"]}]}deleteItemCallback(e){this.managePageVersionService.deletePageVersion(e.uid)}editItemCallback(e){this.managePageVersionService.editPageVersion(e)}viewItemCallback(e){this.pageVersionSelectionService.selectPageVersion(e)}rollbackItemCallback(e){this.rollbackPageVersionService.rollbackPageVersion(e)}};kn.$inject=["managePageVersionService","pageVersionSelectionService","rollbackPageVersionService","permissionService","cdr","userTrackingService"];__decorate([s.Input(),__metadata("design:type",Object)],kn.prototype,"item",void 0);kn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-version-item-menu",template:`<se-popup-overlay class="se-version-item-menu__popup-anchor" [ngClass]="{ 'se-version-item-menu__popup-anchor--open': isMenuOpen }" [popupOverlay]="popupConfig" [popupOverlayTrigger]="isMenuOpen" (popupOverlayOnHide)="hideMenu()"><div *ngIf="menuItems.length > 0" (click)="onButtonClick($event)" class="sap-icon--overflow se-version-item-menu__toggle"></div><div se-popup-overlay-body class="se-version-item-menu fd-menu"><div class="se-version-item-menu__item fd-menu__list" *ngFor="let item of menuItems" (click)="executeItemCallback(item)"><span class="se-version-item-menu__item-link fd-menu__item">{{ item.i18nKey | translate }}</span></div></div></se-popup-overlay>`,styles:[`.se-version-item-menu{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;left:initial!important;right:0;transform:translate(5px,8px);right:-11px;top:-8px}.se-version-item-menu::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-version-item-menu::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-version-item-menu::after,.se-version-item-menu::before{right:10px}.se-version-item-menu::after,.se-version-item-menu::before{display:none}.se-version-item-menu__item:last-child .se-version-item-menu__item-link{color:#b00}.se-version-item-menu__popup-anchor{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-version-item-menu__toggle{height:20px;width:20px;cursor:pointer}.sap-icon--overflow{color:#0a6ed1}`],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[Dn,m.PageVersionSelectionService,Rn,m.IPermissionService,s.ChangeDetectorRef,m.UserTrackingService])],kn);window.__smartedit__.addDecoratorPayload("Component","VersionsSearchComponent",{selector:"se-versions-search",template:`<div class="se-versions-panel__search" *ngIf="showSearchControls"><div class="se-input-group"><input type="text" class="se-input-group__input-area" name="search-term" [ngModel]="searchTerm" (ngModelChange)="onChange($event)" [placeholder]="'se.cms.versions.search.placeholder' | translate"/> <span class="sap-icon--search se-input-group__addon"></span> <button class="se-input-group__addon se-input-group__clear-btn sap-icon--decline" [style.visibility]="showResetButton ? 'visible' : 'hidden'" (click)="resetSearchBox()"></button></div><span class="se-versions-panel__count" [translate]="'se.cms.versions.search.versions.found'" [translateParams]="{ versionsFound: versionsFoundCount }"></span></div>`,styles:[`.se-versions-panel__search{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:8px 20px;border-bottom:1px solid #d9d9d9}.se-versions-panel__count{display:flex;flex-direction:row;align-items:center;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;white-space:nowrap}.se-input-group{flex-grow:1;margin-right:16px}`],changeDetection:s.ChangeDetectionStrategy.OnPush});let Mn=class VersionsSearchComponent{constructor(){this.searchTermChange=new s.EventEmitter;this.showResetButton=false}ngOnInit(){this.initSearchInputFilter()}ngOnDestroy(){this.searchTermSubscription.unsubscribe()}onChange(e){this.searchTermSubject.next(e)}resetSearchBox(){this.setSearchTermAndEmit("")}initSearchInputFilter(){this.searchTermSubject=new C.Subject;this.searchTerm$=this.searchTermSubject.asObservable().pipe(g.debounceTime(500),g.distinctUntilChanged());this.searchTermSubscription=this.searchTerm$.subscribe((e=>this.setSearchTermAndEmit(e)))}setSearchTermAndEmit(e){this.searchTerm=e;this.showResetButton=this.searchTerm!=="";this.searchTermChange.emit(this.searchTerm)}};__decorate([s.Input(),__metadata("design:type",Number)],Mn.prototype,"versionsFoundCount",void 0);__decorate([s.Input(),__metadata("design:type",Boolean)],Mn.prototype,"showSearchControls",void 0);__decorate([s.Output(),__metadata("design:type",Object)],Mn.prototype,"searchTermChange",void 0);Mn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-versions-search",template:`<div class="se-versions-panel__search" *ngIf="showSearchControls"><div class="se-input-group"><input type="text" class="se-input-group__input-area" name="search-term" [ngModel]="searchTerm" (ngModelChange)="onChange($event)" [placeholder]="'se.cms.versions.search.placeholder' | translate"/> <span class="sap-icon--search se-input-group__addon"></span> <button class="se-input-group__addon se-input-group__clear-btn sap-icon--decline" [style.visibility]="showResetButton ? 'visible' : 'hidden'" (click)="resetSearchBox()"></button></div><span class="se-versions-panel__count" [translate]="'se.cms.versions.search.versions.found'" [translateParams]="{ versionsFound: versionsFoundCount }"></span></div>`,styles:[`.se-versions-panel__search{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:8px 20px;border-bottom:1px solid #d9d9d9}.se-versions-panel__count{display:flex;flex-direction:row;align-items:center;font-size:.8571428571rem;line-height:1.3333333333;font-weight:400;white-space:nowrap}.se-input-group{flex-grow:1;margin-right:16px}`],changeDetection:s.ChangeDetectionStrategy.OnPush})],Mn);window.__smartedit__.addDecoratorPayload("Component","VersionsPanelComponent",{selector:"se-versions-panel",template:`<div class="se-toolbar-menu-content--wrapper"><div class="se-toolbar-menu-content__header"><div class="se-toolbar-menu-content__header-title" translate="se.cms.actionitem.page.versions"></div><button class="se-versions-panel__manage-btn fd-button fd-button--compact" *ngIf="showManageButton" (click)="switchToVersioningMode()" translate="se.cms.toolbaritem.versioning.manageversions.name"></button></div><div class="se-versions-toolbar-menu-content__body" [ngClass]="{ 'se-versions-toolbar-menu-content__body--narrow': showManageButton }"><se-versions-search [versionsFoundCount]="versionsFound" [showSearchControls]="pageHasVersions()" (searchTermChange)="onSearchTermChanged($event)"></se-versions-search><div><se-infinite-scrolling class="se-versions-panel__infinite-scroll" *ngIf="pageHasVersionsOrIsLoading()" [pageSize]="10" [mask]="searchTerm" [fetchPage]="fetchPageOfVersions" (itemsChange)="onVersionItemsLoaded($event)"><div *ngFor="let item of versionItems; let isLast = last"><se-version-item [ngClass]="{ 'se-version-item--last': isLast }" [pageVersion]="item"></se-version-item></div></se-infinite-scrolling><div class="se-versions-panel__empty-list" *ngIf="!pageHasVersionsOrIsLoading()"><img src="static-resources/images/emptyVersions.svg" alt="no versions"/> <span class="se-versions-panel__no-versions-message" translate="se.cms.toolbaritem.versioning.noversionsfound"></span> <a class="se-versions-panel__manage-link fd-link" *ngIf="showManageLink" (click)="switchToVersioningMode()" translate="se.cms.toolbaritem.versioning.manageversionslink.name"></a></div></div></div></div>`,styles:[`.se-versions-panel .se-toolbar-menu-content__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px}.se-versions-panel .se-toolbar-menu-content__header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-versions-panel .se-versions-toolbar-menu-content__body .se-infinite-scrolling__container{width:340px;max-height:350px;overflow-y:auto;margin-bottom:8px}.se-versions-panel .se-versions-toolbar-menu-content__body--narrow .se-infinite-scrolling__container{width:300px}.se-versions-panel__empty-list{display:flex;flex-direction:column;align-items:center;color:#51555a;width:280px;padding:20px}.se-versions-panel__no-versions-message{padding:8px 0 4px}.se-versions-panel__manage-link{margin-bottom:20px;cursor:pointer}.se-versions-panel__manage-link:hover{text-decoration:none}`],encapsulation:s.ViewEncapsulation.None,host:{"[class.se-versions-panel]":"true"},changeDetection:s.ChangeDetectionStrategy.OnPush});let Nn=class VersionsPanelComponent{constructor(e,t,o,n){this.pageVersioningService=e;this.perspectiveService=t;this.logService=o;this.cdr=n;this.switchMode=new s.EventEmitter;this.searchTerm="";this.totalPageVersions=0;this.isLoading=true;this.VERSIONING_MODE_KEY=m.CMSModesService.VERSIONING_PERSPECTIVE_KEY;this.fetchPageOfVersions=(e,t,o)=>this.loadVersions(e,t,o)}ngOnInit(){this.showManageLink=this.canShowManageLink()}onVersionItemsLoaded(e){this.versionItems=e}onSearchTermChanged(e){this.searchTerm=e}switchToVersioningMode(){this.perspectiveService.switchTo(this.VERSIONING_MODE_KEY);this.switchMode.emit()}pageHasVersions(){return this.totalPageVersions>0}pageHasVersionsOrIsLoading(){return this.pageHasVersions()||this.isLoading}canShowManageButton(){return this.showManageLink&&this.pageHasVersions()}canShowManageLink(){const e=this.perspectiveService.getActivePerspective();return e&&e.key!==this.VERSIONING_MODE_KEY}loadVersions(e,t,o){return __awaiter(this,void 0,void 0,(function*(){try{const n=yield this.pageVersioningService.findPageVersions({pageUuid:this.pageUuid,currentPage:o,mask:e,pageSize:t});this.versionsFound=n.pagination.totalCount;if(this.isLoading){this.isLoading=false;this.totalPageVersions=this.versionsFound;this.showManageButton=this.canShowManageButton()}if(!this.cdr.destroyed){this.cdr.detectChanges()}return n}catch(e){this.logService.error(`Cannot find page versions for page ${this.pageUuid}.`);return null}}))}};Nn.$inject=["pageVersioningService","perspectiveService","logService","cdr"];__decorate([s.Input(),__metadata("design:type",String)],Nn.prototype,"pageUuid",void 0);__decorate([s.Output(),__metadata("design:type",Object)],Nn.prototype,"switchMode",void 0);Nn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-versions-panel",template:`<div class="se-toolbar-menu-content--wrapper"><div class="se-toolbar-menu-content__header"><div class="se-toolbar-menu-content__header-title" translate="se.cms.actionitem.page.versions"></div><button class="se-versions-panel__manage-btn fd-button fd-button--compact" *ngIf="showManageButton" (click)="switchToVersioningMode()" translate="se.cms.toolbaritem.versioning.manageversions.name"></button></div><div class="se-versions-toolbar-menu-content__body" [ngClass]="{ 'se-versions-toolbar-menu-content__body--narrow': showManageButton }"><se-versions-search [versionsFoundCount]="versionsFound" [showSearchControls]="pageHasVersions()" (searchTermChange)="onSearchTermChanged($event)"></se-versions-search><div><se-infinite-scrolling class="se-versions-panel__infinite-scroll" *ngIf="pageHasVersionsOrIsLoading()" [pageSize]="10" [mask]="searchTerm" [fetchPage]="fetchPageOfVersions" (itemsChange)="onVersionItemsLoaded($event)"><div *ngFor="let item of versionItems; let isLast = last"><se-version-item [ngClass]="{ 'se-version-item--last': isLast }" [pageVersion]="item"></se-version-item></div></se-infinite-scrolling><div class="se-versions-panel__empty-list" *ngIf="!pageHasVersionsOrIsLoading()"><img src="static-resources/images/emptyVersions.svg" alt="no versions"/> <span class="se-versions-panel__no-versions-message" translate="se.cms.toolbaritem.versioning.noversionsfound"></span> <a class="se-versions-panel__manage-link fd-link" *ngIf="showManageLink" (click)="switchToVersioningMode()" translate="se.cms.toolbaritem.versioning.manageversionslink.name"></a></div></div></div></div>`,styles:[`.se-versions-panel .se-toolbar-menu-content__header{padding:20px;display:flex;flex-direction:row;align-items:center;justify-content:space-between;border-bottom:1px solid #d9d9d9;height:53px;padding-top:15px;height:48px}.se-versions-panel .se-toolbar-menu-content__header:first-child{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#32363a}.se-versions-panel .se-versions-toolbar-menu-content__body .se-infinite-scrolling__container{width:340px;max-height:350px;overflow-y:auto;margin-bottom:8px}.se-versions-panel .se-versions-toolbar-menu-content__body--narrow .se-infinite-scrolling__container{width:300px}.se-versions-panel__empty-list{display:flex;flex-direction:column;align-items:center;color:#51555a;width:280px;padding:20px}.se-versions-panel__no-versions-message{padding:8px 0 4px}.se-versions-panel__manage-link{margin-bottom:20px;cursor:pointer}.se-versions-panel__manage-link:hover{text-decoration:none}`],encapsulation:s.ViewEncapsulation.None,host:{"[class.se-versions-panel]":"true"},changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[m.PageVersioningService,m.IPerspectiveService,m.LogService,s.ChangeDetectorRef])],Nn);window.__smartedit__.addDecoratorPayload("Component","PageVersionMenuComponent",{selector:"se-page-version-menu",template:`\n        <div\n            class="se-toolbar-menu-content se-toolbar-menu-content--versions"\n            *ngIf="actionItem.isOpen"\n        >\n            <se-versions-panel\n                *ngIf="pageUuid"\n                [pageUuid]="pageUuid"\n                (switchMode)="onSwitchMode()"\n            ></se-versions-panel>\n        </div>\n    `});let Fn=class PageVersionMenuComponent{constructor(e,t,o){this.pageInfoService=e;this.pageVersionSelectionService=t;this.actionItem=o}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.pageVersionSelectionService.showToolbarContextIfNeeded();this.pageUuid=yield this.pageInfoService.getPageUUID()}))}onSwitchMode(){this.actionItem.isOpen=false}};Fn.$inject=["pageInfoService","pageVersionSelectionService","actionItem"];Fn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-version-menu",template:`\n        <div\n            class="se-toolbar-menu-content se-toolbar-menu-content--versions"\n            *ngIf="actionItem.isOpen"\n        >\n            <se-versions-panel\n                *ngIf="pageUuid"\n                [pageUuid]="pageUuid"\n                (switchMode)="onSwitchMode()"\n            ></se-versions-panel>\n        </div>\n    `}),__param(2,s.Inject(m.TOOLBAR_ITEM)),__metadata("design:paramtypes",[m.IPageInfoService,m.PageVersionSelectionService,Object])],Fn);let zn=class VersioningModule{};zn=__decorate([s.NgModule({imports:[m.TranslationModule.forChild(),f.CommonModule,a.FormsModule,m.TooltipModule,m.PopupOverlayModule,m.MoreTextModule,m.InfiniteScrollingModule],declarations:[On,kn,xn,Mn,Nn,Fn],entryComponents:[Fn,On],providers:[Dn,Rn]})],zn);window.__smartedit__.addDecoratorPayload("Component","PageTreeComponent",{selector:"se-page-tree-component",template:`<div><div class="se-page-tree-node" [ngClass]="component.isExpanded && 'se-page-tree-node-expand'" [attr.node-smartedit-element-uuid]="!component.isHidden ?\n                     component.elementUuid :\n                     'hidden-component-has-no-uuid'"><div (click)="onClickComponentNode($event)" class="se-page-tree-component-node--content"><span [ngClass]="component.isExpanded ?\n                                'sap-icon--navigation-down-arrow' :\n                                'sap-icon--navigation-right-arrow'" class="se-page-tree-node--icon se-page-tree-component-node se-page-tree-component-node--icon"></span> <span class="se-page-tree-node--icon se-page-tree-component-node--icon sap-icon--vertical-grip"></span> <span class="se-page-tree-node--icon se-page-tree-component-node--icon sap-icon--background"></span><div class="se-page-tree-component-node--name"><span class="se-page-tree-component-node--name--up">{{component.name}}</span> <span class="se-page-tree-component-node--name--down">{{component.typeCode}}</span></div></div><se-page-tree-component-menu [component]="component" [slotId]="slotId" [slotUuid]="slotUuid" class="se-page-tree-component-node-menu"></se-page-tree-component-menu></div></div>`,styles:[`.se-page-tree-component-node{margin-left:8px}.se-page-tree-component-node--icon{height:32px}.se-page-tree-component-node--name{display:flex;flex-direction:column;font-family:"72";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);overflow:hidden}.se-page-tree-component-node--name--up{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-component-node--name--down{font-style:oblique;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-component-node-menu{margin:0 0 0 auto}.se-page-tree-component-node--content{min-width:calc(100% - 88.25px);display:flex}`,`.se-page-tree-node{height:48px;display:flex;align-items:center;padding:0 12px;border-bottom:1px solid #f1f1f1;width:100%}.se-page-tree-node-expand{background:#e7f1fa}.se-page-tree-node--icon{font-size:14px;line-height:16px;color:var(--sapContent_IconColor);margin-right:10px}.se-page-tree-slot-node--name{font-family:"72";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-slot-node-menu{margin:0 0 0 auto;min-width:60px}.se-page-tree-slot-node-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}`]});let Ln=class PageTreeComponent{constructor(e,t,o){this.pageTreeNodeService=e;this.nodeInfoService=t;this.logService=o;this.onComponentExpanded=new s.EventEmitter;this.publishComponentInterval=null}onClickComponentNode(e){return __awaiter(this,void 0,void 0,(function*(){clearInterval(this.publishComponentInterval);this.component.isExpanded=!this.component.isExpanded;if(this.component.isExpanded){this.onComponentExpanded.emit(this.component);yield this.pageTreeNodeService.scrollToElement(this.component.elementUuid);if(!(yield this.checkComponentAndPublishSelected())){let e=0;this.publishComponentInterval=setInterval((()=>__awaiter(this,void 0,void 0,(function*(){if(yield this.checkComponentAndPublishSelected()){clearInterval(this.publishComponentInterval)}if(e>Xe){this.logService.error(`PageTreeComponent:: onClickComponentNode error: smartedit-element ${this.component.elementUuid} is not existed`);clearInterval(this.publishComponentInterval)}e++}))),Qe)}}else{this.nodeInfoService.publishComponentSelected(this.component,false,this.slotElementUuid)}}))}checkComponentAndPublishSelected(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageTreeNodeService.existedSmartEditElement(this.component.elementUuid);if(e){this.nodeInfoService.publishComponentSelected(this.component,true,this.slotElementUuid);return true}return false}))}};Ln.$inject=["pageTreeNodeService","nodeInfoService","logService"];__decorate([s.Input(),__metadata("design:type",Object)],Ln.prototype,"component",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ln.prototype,"slotId",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ln.prototype,"slotUuid",void 0);__decorate([s.Input(),__metadata("design:type",String)],Ln.prototype,"slotElementUuid",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Ln.prototype,"onComponentExpanded",void 0);Ln=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-tree-component",template:`<div><div class="se-page-tree-node" [ngClass]="component.isExpanded && 'se-page-tree-node-expand'" [attr.node-smartedit-element-uuid]="!component.isHidden ?\n                     component.elementUuid :\n                     'hidden-component-has-no-uuid'"><div (click)="onClickComponentNode($event)" class="se-page-tree-component-node--content"><span [ngClass]="component.isExpanded ?\n                                'sap-icon--navigation-down-arrow' :\n                                'sap-icon--navigation-right-arrow'" class="se-page-tree-node--icon se-page-tree-component-node se-page-tree-component-node--icon"></span> <span class="se-page-tree-node--icon se-page-tree-component-node--icon sap-icon--vertical-grip"></span> <span class="se-page-tree-node--icon se-page-tree-component-node--icon sap-icon--background"></span><div class="se-page-tree-component-node--name"><span class="se-page-tree-component-node--name--up">{{component.name}}</span> <span class="se-page-tree-component-node--name--down">{{component.typeCode}}</span></div></div><se-page-tree-component-menu [component]="component" [slotId]="slotId" [slotUuid]="slotUuid" class="se-page-tree-component-node-menu"></se-page-tree-component-menu></div></div>`,styles:[`.se-page-tree-component-node{margin-left:8px}.se-page-tree-component-node--icon{height:32px}.se-page-tree-component-node--name{display:flex;flex-direction:column;font-family:"72";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);overflow:hidden}.se-page-tree-component-node--name--up{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-component-node--name--down{font-style:oblique;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-component-node-menu{margin:0 0 0 auto}.se-page-tree-component-node--content{min-width:calc(100% - 88.25px);display:flex}`,`.se-page-tree-node{height:48px;display:flex;align-items:center;padding:0 12px;border-bottom:1px solid #f1f1f1;width:100%}.se-page-tree-node-expand{background:#e7f1fa}.se-page-tree-node--icon{font-size:14px;line-height:16px;color:var(--sapContent_IconColor);margin-right:10px}.se-page-tree-slot-node--name{font-family:"72";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-slot-node-menu{margin:0 0 0 auto;min-width:60px}.se-page-tree-slot-node-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}`]}),__metadata("design:paramtypes",[m.IPageTreeNodeService,t.NodeInfoService,m.LogService])],Ln);window.__smartedit__.addDecoratorPayload("Component","PageTreeSlot",{selector:"se-page-tree-slot",template:`<div><div class="se-page-tree-node" [ngClass]="node.isExpanded && 'se-page-tree-node-expand'" [attr.node-smartedit-element-uuid]="node.elementUuid"><span (click)="onClickSlotNode($event)" [ngClass]="node.isExpanded ?\n                    'sap-icon--navigation-down-arrow' :\n                    'sap-icon--navigation-right-arrow'" class="se-page-tree-node--icon"></span> <span class="se-page-tree-slot-node--name" (click)="onClickSlotNode($event)">{{node.componentId}}</span><div class="se-page-tree-slot-node-menu"><span class="se-page-tree-slot-node-menu--icon sap-icon--chain-link"></span> <span class="se-page-tree-slot-node-menu--icon sap-icon--synchronize"></span></div></div><div *ngIf="node.isExpanded && node.componentNodes.length"><div *ngFor="let child of node.componentNodes"><se-page-tree-component [component]="child" [slotId]="node.componentId" [slotUuid]="node.componentUuid" [slotElementUuid]="node.elementUuid" (onComponentExpanded)="onComponentExpanded($event)"></se-page-tree-component></div></div></div>`,styles:[`.se-page-tree-node{height:48px;display:flex;align-items:center;padding:0 12px;border-bottom:1px solid #f1f1f1;width:100%}.se-page-tree-node-expand{background:#e7f1fa}.se-page-tree-node--icon{font-size:14px;line-height:16px;color:var(--sapContent_IconColor);margin-right:10px}.se-page-tree-slot-node--name{font-family:"72";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-slot-node-menu{margin:0 0 0 auto;min-width:60px}.se-page-tree-slot-node-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}`]});let Vn=class PageTreeSlot{constructor(e,t,o,n){this.pageTreeNodeService=e;this.nodeInfoService=t;this.logService=o;this.userTrackingService=n;this.onSlotExpanded=new s.EventEmitter;this.publishSlotInterval=null}onClickSlotNode(e){return __awaiter(this,void 0,void 0,(function*(){this.userTrackingService.trackingUserAction(m.USER_TRACKING_FUNCTIONALITY.PAGE_STRUCTURE,"Slot");clearInterval(this.publishSlotInterval);this.node.isExpanded=!this.node.isExpanded;if(!this.node.isExpanded){this.node.componentNodes.forEach((e=>e.isExpanded=false));this.nodeInfoService.publishSlotSelected(this.node)}else{this.onSlotExpanded.emit(this.node);yield this.pageTreeNodeService.scrollToElement(this.node.elementUuid);if(!(yield this.checkSlotAndPublishSelected())){let e=0;this.publishSlotInterval=setInterval((()=>__awaiter(this,void 0,void 0,(function*(){if(yield this.checkSlotAndPublishSelected()){clearInterval(this.publishSlotInterval)}if(e>Xe){this.logService.error(`PageTreeComponent:: onClickSlotNode error: smartedit-element ${this.node.elementUuid} is not existed`);clearInterval(this.publishSlotInterval)}e++}))),Qe)}}}))}onComponentExpanded(e){this.node.componentNodes.filter((t=>t.elementUuid!==e.elementUuid)).forEach((e=>{if(e.isExpanded){e.isExpanded=false;this.nodeInfoService.publishComponentSelected(e,false,this.node.elementUuid)}}))}checkSlotAndPublishSelected(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageTreeNodeService.existedSmartEditElement(this.node.elementUuid);if(e){this.nodeInfoService.publishSlotSelected(this.node);return true}return false}))}};Vn.$inject=["pageTreeNodeService","nodeInfoService","logService","userTrackingService"];__decorate([s.Input(),__metadata("design:type",Object)],Vn.prototype,"node",void 0);__decorate([s.Output(),__metadata("design:type",s.EventEmitter)],Vn.prototype,"onSlotExpanded",void 0);Vn=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-tree-slot",template:`<div><div class="se-page-tree-node" [ngClass]="node.isExpanded && 'se-page-tree-node-expand'" [attr.node-smartedit-element-uuid]="node.elementUuid"><span (click)="onClickSlotNode($event)" [ngClass]="node.isExpanded ?\n                    'sap-icon--navigation-down-arrow' :\n                    'sap-icon--navigation-right-arrow'" class="se-page-tree-node--icon"></span> <span class="se-page-tree-slot-node--name" (click)="onClickSlotNode($event)">{{node.componentId}}</span><div class="se-page-tree-slot-node-menu"><span class="se-page-tree-slot-node-menu--icon sap-icon--chain-link"></span> <span class="se-page-tree-slot-node-menu--icon sap-icon--synchronize"></span></div></div><div *ngIf="node.isExpanded && node.componentNodes.length"><div *ngFor="let child of node.componentNodes"><se-page-tree-component [component]="child" [slotId]="node.componentId" [slotUuid]="node.componentUuid" [slotElementUuid]="node.elementUuid" (onComponentExpanded)="onComponentExpanded($event)"></se-page-tree-component></div></div></div>`,styles:[`.se-page-tree-node{height:48px;display:flex;align-items:center;padding:0 12px;border-bottom:1px solid #f1f1f1;width:100%}.se-page-tree-node-expand{background:#e7f1fa}.se-page-tree-node--icon{font-size:14px;line-height:16px;color:var(--sapContent_IconColor);margin-right:10px}.se-page-tree-slot-node--name{font-family:"72";font-size:14px;line-height:16px;color:var(--sapContent_LabelColor);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.se-page-tree-slot-node-menu{margin:0 0 0 auto;min-width:60px}.se-page-tree-slot-node-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}`]}),__metadata("design:paramtypes",[m.IPageTreeNodeService,t.NodeInfoService,m.LogService,m.UserTrackingService])],Vn);window.__smartedit__.addDecoratorPayload("Component","PageTreePanel",{selector:"se-page-tree",template:`<div class="se-page-tree"><div class="se-page-tree--header"><span class="se-page-tree--header--icon sap-icon--Chart-Tree-Map"></span> <span class="se-page-tree--header--title">{{ 'se.page.tree.title' | translate }}</span></div><div *ngFor="let node of slotNodes"><se-page-tree-slot [node]="node" (onSlotExpanded)="onSlotExpanded($event)"></se-page-tree-slot></div></div>`,styles:[`.se-page-tree{background:#fff;width:100%;height:100%;filter:drop-shadow(0 4px 4px rgba(0, 0, 0, .25));border-radius:4px;overflow-y:scroll}.se-page-tree::-webkit-scrollbar{display:none}.se-page-tree--header{height:48px;padding:0 12px;display:flex;align-items:center;box-shadow:0 1px 0 #dedede}.se-page-tree--header--icon{width:16px;height:18px;line-height:19px;font-size:16px;color:var(--sapContent_IconColor);text-align:center}.se-page-tree--header--title{font-family:"72";font-size:18px;line-height:21px;margin:0 10px;color:#595959}`]});let Un=class PageTreePanel{constructor(e,t,o,n,s){this.crossFrameEventService=e;this.nodeInfoService=t;this.yjQuery=o;this.cdr=n;this.logService=s;this.slotNodes=null;this.scrollToNodeInterval=null;this.expandComponentNodeInterval=null;this.crossFrameEventService.subscribe(m.EVENT_OPEN_IN_PAGE_TREE,this.handleEventOpenInPageTree.bind(this));this.crossFrameEventService.subscribe(m.EVENT_PART_REFRESH_TREE_NODE,((e,t)=>__awaiter(this,void 0,void 0,(function*(){return this.slotNodes=yield this.nodeInfoService.updatePartTreeNodesInfo(t)}))));this.crossFrameEventService.subscribe(m.EVENT_OVERALL_REFRESH_TREE_NODE,(()=>__awaiter(this,void 0,void 0,(function*(){return this.slotNodes=yield this.nodeInfoService.buildNodesInfo()}))))}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.slotNodes=yield this.nodeInfoService.buildNodesInfo()}))}onSlotExpanded(e){this.slotNodes.filter((t=>e.elementUuid!==t.elementUuid)).forEach((e=>{e.isExpanded=false;e.componentNodes.forEach((e=>e.isExpanded=false))}))}handleEventOpenInPageTree(e,t){clearInterval(this.expandComponentNodeInterval);if(!this.expandComponentNode(t)){let e=0;this.expandComponentNodeInterval=setInterval((()=>{if(this.expandComponentNode(t)){clearInterval(this.expandComponentNodeInterval)}if(e>Xe){this.logService.error(`PageTreeComponent:: handleEventOpenInPageTree error: expand component node ${t} failed`);clearInterval(this.expandComponentNodeInterval)}e++}),Qe)}}expandComponentNode(e){if(this.slotNodes){this.slotNodes.forEach((t=>{let o=null;t.componentNodes.forEach((t=>{if(t.elementUuid===e){t.isExpanded=true;o=t}else{t.isExpanded=false}}));if(o){t.isExpanded=true;this.scrollToNodeByInterval(o.elementUuid)}else{t.isExpanded=false}}));return true}return false}scrollToNode(e){const t=this.yjQuery(`div[node-smartedit-element-uuid="${e}"]`).get().shift();if(t){t.scrollIntoView({behavior:"smooth",block:"center"});return true}return false}scrollToNodeByInterval(e){clearInterval(this.scrollToNodeInterval);if(!this.scrollToNode(e)){let t=0;this.scrollToNodeInterval=setInterval((()=>{if(this.scrollToNode(e)){clearInterval(this.scrollToNodeInterval)}if(t>Xe){this.logService.error(`PageTreeComponent:: scrollToNodeByInterval error: scroll to tree node ${e} failed!`);clearInterval(this.scrollToNodeInterval)}t++}),Qe)}}};Un.$inject=["crossFrameEventService","nodeInfoService","yjQuery","cdr","logService"];Un=__decorate([m.SeDowngradeComponent(),s.Component({selector:"se-page-tree",template:`<div class="se-page-tree"><div class="se-page-tree--header"><span class="se-page-tree--header--icon sap-icon--Chart-Tree-Map"></span> <span class="se-page-tree--header--title">{{ 'se.page.tree.title' | translate }}</span></div><div *ngFor="let node of slotNodes"><se-page-tree-slot [node]="node" (onSlotExpanded)="onSlotExpanded($event)"></se-page-tree-slot></div></div>`,styles:[`.se-page-tree{background:#fff;width:100%;height:100%;filter:drop-shadow(0 4px 4px rgba(0, 0, 0, .25));border-radius:4px;overflow-y:scroll}.se-page-tree::-webkit-scrollbar{display:none}.se-page-tree--header{height:48px;padding:0 12px;display:flex;align-items:center;box-shadow:0 1px 0 #dedede}.se-page-tree--header--icon{width:16px;height:18px;line-height:19px;font-size:16px;color:var(--sapContent_IconColor);text-align:center}.se-page-tree--header--title{font-family:"72";font-size:18px;line-height:21px;margin:0 10px;color:#595959}`]}),__param(2,s.Inject(m.YJQUERY_TOKEN)),__metadata("design:paramtypes",[m.CrossFrameEventService,t.NodeInfoService,Function,s.ChangeDetectorRef,m.LogService])],Un);class ParentMenu{constructor(){this.remainOpenMap={}}}window.__smartedit__.addDecoratorPayload("Component","PageTreeMenuItemOverlayComponent",{template:`\n        <div *ngIf="item.action.component">\n            <ng-container\n                *ngComponentOutlet="item.action.component; injector: componentInjector"\n            ></ng-container>\n        </div>\n    `,selector:"se-contextual-menu-item-overlay"});let jn=class PageTreeMenuItemOverlayComponent{constructor(e,t,o){this.data=e;this.parent=t;this.injector=o}ngOnInit(){this.createComponentInjector()}get item(){return this.data.item}createComponentInjector(){this.componentInjector=s.Injector.create({parent:this.injector,providers:[{provide:m.CONTEXTUAL_MENU_ITEM_DATA,useValue:{componentAttributes:this.parent.componentAttributes,setRemainOpen:(e,t)=>this.parent.setRemainOpen(e,t)}}]})}};jn=__decorate([s.Component({template:`\n        <div *ngIf="item.action.component">\n            <ng-container\n                *ngComponentOutlet="item.action.component; injector: componentInjector"\n            ></ng-container>\n        </div>\n    `,selector:"se-contextual-menu-item-overlay"}),__param(0,s.Inject(m.POPUP_OVERLAY_DATA)),__metadata("design:paramtypes",[Object,ParentMenu,s.Injector])],jn);window.__smartedit__.addDecoratorPayload("Component","PageTreeMoreItemsComponent",{selector:"se-page-tree-more-items",styles:[`.se-page-tree-component-menu{margin:0 0 0 auto;display:flex;flex-direction:row}.se-page-tree-component-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}.se-page-tree-component-more{min-width:118px}.se-page-tree-component-more-menu{display:block}.se-page-tree-component-more-menu--span{margin-left:12px;font-family:"72";font-size:14px;line-height:24px;color:#000;display:block;min-width:104px}.is-storefront .fd-popover__popper{border-radius:0}`],template:`\n        <div class="se-page-tree-component-more">\n            <ul id="{{ parent.component.uid }}-{{ parent.component.typeCode }}-more-menu">\n                <li\n                    *ngFor="let item of parent.getItems(); let $index = index"\n                    [attr.data-smartedit-id]="parent.component.uid"\n                    [attr.data-smartedit-type]="parent.component.typeCode"\n                    class="se-page-tree-component-more-menu"\n                >\n                    <se-popup-overlay\n                        [popupOverlay]="itemTemplateOverlayWrapper"\n                        [popupOverlayTrigger]="parent.canShowTemplate(item)"\n                        [popupOverlayData]="{ item: item }"\n                        (popupOverlayOnHide)="parent.onHideItemPopup(true)"\n                    >\n                        <span\n                            class="se-page-tree-component-more-menu--span"\n                            (click)="parent.triggerMenuItemAction(item, $event)"\n                        >\n                            {{ item.i18nKey | translate }}\n                        </span>\n                    </se-popup-overlay>\n                </li>\n            </ul>\n        </div>\n    `});let $n=class PageTreeMoreItemsComponent{constructor(e){this.parent=e;this.itemTemplateOverlayWrapper={component:jn}}};$n=__decorate([s.Component({selector:"se-page-tree-more-items",styles:[`.se-page-tree-component-menu{margin:0 0 0 auto;display:flex;flex-direction:row}.se-page-tree-component-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}.se-page-tree-component-more{min-width:118px}.se-page-tree-component-more-menu{display:block}.se-page-tree-component-more-menu--span{margin-left:12px;font-family:"72";font-size:14px;line-height:24px;color:#000;display:block;min-width:104px}.is-storefront .fd-popover__popper{border-radius:0}`],template:`\n        <div class="se-page-tree-component-more">\n            <ul id="{{ parent.component.uid }}-{{ parent.component.typeCode }}-more-menu">\n                <li\n                    *ngFor="let item of parent.getItems(); let $index = index"\n                    [attr.data-smartedit-id]="parent.component.uid"\n                    [attr.data-smartedit-type]="parent.component.typeCode"\n                    class="se-page-tree-component-more-menu"\n                >\n                    <se-popup-overlay\n                        [popupOverlay]="itemTemplateOverlayWrapper"\n                        [popupOverlayTrigger]="parent.canShowTemplate(item)"\n                        [popupOverlayData]="{ item: item }"\n                        (popupOverlayOnHide)="parent.onHideItemPopup(true)"\n                    >\n                        <span\n                            class="se-page-tree-component-more-menu--span"\n                            (click)="parent.triggerMenuItemAction(item, $event)"\n                        >\n                            {{ item.i18nKey | translate }}\n                        </span>\n                    </se-popup-overlay>\n                </li>\n            </ul>\n        </div>\n    `}),__metadata("design:paramtypes",[ParentMenu])],$n);var Bn;window.__smartedit__.addDecoratorPayload("Component","PageTreeComponentMenuComponent",{selector:"se-page-tree-component-menu",template:`<div class="se-page-tree-component-menu"><span [ngClass]="component.isHidden ? 'sap-icon--hide' : 'sap-icon--show'" class="se-page-tree-component-menu--icon"></span><se-popup-overlay *ngIf="!!leftButton" [popupOverlay]="itemTemplateOverlayWrapper" [popupOverlayTrigger]="canShowTemplate(leftButton)" [popupOverlayData]="{ item: leftButton }" (popupOverlayOnHide)="onHideItemPopup(false)"><span class="se-page-tree-component-menu--icon" [ngClass]="leftButton.displayIconClass" (click)="triggerMenuItemAction(leftButton, $event)"></span></se-popup-overlay><se-popup-overlay [popupOverlay]="moreMenuPopupConfig" [popupOverlayTrigger]="moreMenuIsOpen"><span *ngIf="items && items.length > 0" (click)="toggleMoreMenu()" class="se-page-tree-component-menu--icon sap-icon--overflow"></span></se-popup-overlay></div>`,styles:[`.se-page-tree-component-menu{margin:0 0 0 auto;display:flex;flex-direction:row}.se-page-tree-component-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}.se-page-tree-component-more{min-width:118px}.se-page-tree-component-more-menu{display:block}.se-page-tree-component-more-menu--span{margin-left:12px;font-family:"72";font-size:14px;line-height:24px;color:#000;display:block;min-width:104px}.is-storefront .fd-popover__popper{border-radius:0}`],providers:[{provide:ParentMenu,useExisting:s.forwardRef((()=>Bn))}],changeDetection:s.ChangeDetectionStrategy.OnPush});let Gn=Bn=class PageTreeComponentMenuComponent{constructor(e,t){this.pageTreeComponentMenuService=e;this.cdr=t;this.remainOpenMap={};this.moreMenuIsOpen=false;this.moreMenuPopupConfig={component:$n,halign:"left"};this.itemTemplateOverlayWrapper={component:jn}}getItems(){return this.items}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){this.componentAttributes={smarteditCatalogVersionUuid:this.component.catalogVersion,smarteditComponentId:this.component.uid,smarteditComponentType:this.component.typeCode,smarteditComponentUuid:this.component.uuid,smarteditElementUuid:this.component.elementUuid};this.menuConfiguration={componentType:this.component.typeCode,componentId:this.component.uid,componentUuid:this.component.uuid,containerType:this.component.containerType,containerId:this.component.containerId,componentAttributes:this.componentAttributes,slotId:this.slotId,slotUuid:this.slotUuid,isComponentHidden:this.component.isHidden};const e=yield this.pageTreeComponentMenuService.getPageTreeComponentMenus(this.menuConfiguration);if(e&&e.length>0){this.items=e.filter((e=>!!e));this.leftButton=this.items.shift()}if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}setRemainOpen(e,t){this.remainOpenMap[e]=t}showOverlay(e){if(e){return true}return Object.keys(this.remainOpenMap).reduce(((e,t)=>e||this.remainOpenMap[t]),false)}canShowTemplate(e){return this.displayedItem===e}onHideItemPopup(e=false){this.displayedItem=null;if(e){this.moreMenuIsOpen=false}}triggerMenuItemAction(e,t){this.moreMenuIsOpen=false;if(e.action.component){if(this.displayedItem===e){this.displayedItem=null}else{this.displayedItem=e}}else if(e.action.callback){e.action.callback(this.menuConfiguration,t)}}toggleMoreMenu(){this.moreMenuIsOpen=!this.moreMenuIsOpen}};__decorate([s.Input(),__metadata("design:type",Object)],Gn.prototype,"component",void 0);__decorate([s.Input(),__metadata("design:type",String)],Gn.prototype,"slotId",void 0);__decorate([s.Input(),__metadata("design:type",String)],Gn.prototype,"slotUuid",void 0);Gn=Bn=__decorate([s.Component({selector:"se-page-tree-component-menu",template:`<div class="se-page-tree-component-menu"><span [ngClass]="component.isHidden ? 'sap-icon--hide' : 'sap-icon--show'" class="se-page-tree-component-menu--icon"></span><se-popup-overlay *ngIf="!!leftButton" [popupOverlay]="itemTemplateOverlayWrapper" [popupOverlayTrigger]="canShowTemplate(leftButton)" [popupOverlayData]="{ item: leftButton }" (popupOverlayOnHide)="onHideItemPopup(false)"><span class="se-page-tree-component-menu--icon" [ngClass]="leftButton.displayIconClass" (click)="triggerMenuItemAction(leftButton, $event)"></span></se-popup-overlay><se-popup-overlay [popupOverlay]="moreMenuPopupConfig" [popupOverlayTrigger]="moreMenuIsOpen"><span *ngIf="items && items.length > 0" (click)="toggleMoreMenu()" class="se-page-tree-component-menu--icon sap-icon--overflow"></span></se-popup-overlay></div>`,styles:[`.se-page-tree-component-menu{margin:0 0 0 auto;display:flex;flex-direction:row}.se-page-tree-component-menu--icon{margin:0 0 0 16px;font-size:14px;line-height:16px;color:var(--sapContent_IconColor)}.se-page-tree-component-more{min-width:118px}.se-page-tree-component-more-menu{display:block}.se-page-tree-component-more-menu--span{margin-left:12px;font-family:"72";font-size:14px;line-height:24px;color:#000;display:block;min-width:104px}.is-storefront .fd-popover__popper{border-radius:0}`],providers:[{provide:ParentMenu,useExisting:s.forwardRef((()=>Bn))}],changeDetection:s.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[t.PageTreeComponentMenuService,s.ChangeDetectorRef])],Gn);let Hn=class PageTreeModule{};Hn=__decorate([s.NgModule({imports:[f.CommonModule,m.PopupOverlayModule,m.TranslationModule.forChild()],declarations:[Un,Vn,Ln,$n,jn,Gn],entryComponents:[Un,Vn,Ln,$n,jn,Gn]})],Hn);t.CmssmarteditContainerModule=class CmssmarteditContainerModule{};t.CmssmarteditContainerModule=__decorate([m.SeEntryModule("cmssmarteditContainer"),s.NgModule({imports:[p.CmsCommonsModule,r.BrowserModule,d.UpgradeModule,m.SharedComponentsModule,m.SeGenericEditorModule,m.MessageModule,m.TooltipModule,si,zn,Gi,m.SeTranslationModule.forChild(),m.L10nPipeModule,bo,Tn,sn,so,An,St,t.CmsComponentsModule,Hn,a.FormsModule,m.SeRouteService.provideNgRoute([{path:`${m.NG_ROUTE_PREFIX}${p.TRASHED_PAGE_LIST_PATH}`,component:Pn,canActivate:[t.ExperienceGuard]},{path:`${m.NG_ROUTE_PREFIX}${p.PAGE_LIST_PATH}`,component:Ji,canActivate:[t.ExperienceGuard],titleI18nKey:"se.cms.pagelist.title",priority:20},{path:`${m.NG_ROUTE_PREFIX}${p.NAVIGATION_MANAGEMENT_PAGE_PATH}`,component:ho,titleI18nKey:"se.cms.toolbaritem.navigationmenu.name",canActivate:[t.ExperienceGuard],priority:10}],{useHash:true,initialNavigation:true,onSameUrlNavigation:"reload"})],providers:[Se,t.PageRestrictionsCriteriaService,t.ExperienceGuard,t.ActionableAlertService,t.PageRestrictionsCriteriaService,t.PageRestoredAlertService,t.PageRestoreModalService,t.HomepageService,t.ManagePageService,Ce,t.PageTypesRestrictionTypesService,Pe,t.RestrictionTypesService,t.ProductCategoryService,ye,we,Ee,Ie,Te,Oe,Ae,xe,t.RestrictionsService,t.PageRestrictionsService,t.GenericEditorModalService,t.RestrictionsStepHandlerFactory,Be,t.PageDisplayConditionsService,t.PageTemplateService,De,t.CmsDragAndDropService,t.DisplayConditionsEditorModel,t.ContextAwareCatalogService,t.RulesAndPermissionsRegistrationService,t.AddPageWizardService,t.ClonePageAlertService,t.NodeInfoService,t.PageTreeComponentMenuService,{provide:n.HTTP_INTERCEPTORS,useClass:p.VersionExperienceInterceptor,multi:true},{provide:n.HTTP_INTERCEPTORS,useClass:m.ResponseAdapterInterceptor,multi:true},{provide:p.IPageContentSlotsComponentsRestService,useClass:be},{provide:m.ISyncPollingService,useClass:t.SyncPollingService},{provide:p.IRemoveComponentService,useClass:t.RemoveComponentService},{provide:m.IPageService,useClass:t.PageService},{provide:p.IContextAwareEditableItemService,useClass:t.ContextAwareEditableItemService},{provide:m.IEditorModalService,useClass:t.EditorModalService},{provide:p.IComponentVisibilityAlertService,useClass:t.ComponentVisibilityAlertService},{provide:p.IComponentSharedService,useClass:t.ComponentSharedService},{provide:m.ISlotRestrictionsService,useClass:t.SlotRestrictionsService},{provide:p.ISlotVisibilityService,useClass:t.SlotVisibilityService},{provide:p.IEditorEnablerService,useClass:t.EditorEnablerService},{provide:p.IComponentMenuConditionAndCallbackService,useClass:t.ComponentMenuConditionAndCallbackService},m.moduleUtils.bootstrap(((e,o,n,s,a,r,d,p,g,u,v,f,S,C,b,I,w,E)=>__awaiter(void 0,void 0,void 0,(function*(){const S=e.getToolbarService("smartEditTrashPageToolbar");S.addItems([{key:"se.cms.pages.list.link",type:m.ToolbarItemType.TEMPLATE,component:to,priority:1,section:m.ToolbarSection.left}]);o.register();n.setDefaultEditorFieldMappings();n.setDefaultTabFieldMappings();n.setDefaultTabsConfiguration();const C=yield E.get("smartedit.pagetree.enabled");if(C==="true"){s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageTreeMenu",nameI18nKey:"se.cms.toolbaritem.pagetreemenu.name",type:"ACTION",iconClassName:"icon-tree se-toolbar-menu-ddlb--button__icon",priority:100,section:"left",callback:()=>{I.publish(m.EVENT_PAGE_TREE_PANEL_SWITCH)},permissions:["se.read.page"]});w.registerTreeComponent({component:Un})}s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.componentMenuTemplate",type:"HYBRID_ACTION",nameI18nKey:"se.cms.componentmenu.btn.label.addcomponent",descriptionI18nKey:"cms.toolbaritem.componentmenutemplate.description",priority:101,section:"left",dropdownPosition:"left",iconClassName:"icon-add se-toolbar-menu-ddlb--button__icon",callback:()=>{a.publish(k,{})},component:t.ComponentMenuComponent,permissions:["se.add.component"],keepAliveOnClose:true});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageInfoMenu",type:"TEMPLATE",nameI18nKey:"se.cms.pageinfo.menu.btn.label",priority:140,section:"left",component:xi,permissions:["se.read.page"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.clonePageMenu",type:"ACTION",nameI18nKey:"se.cms.clonepage.menu.btn.label",iconClassName:"icon-duplicate se-toolbar-menu-ddlb--button__icon",callback:()=>{r.openClonePageWizard()},priority:130,section:"left",permissions:["se.clone.page"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageSyncMenu",nameI18nKey:"se.cms.toolbaritem.pagesyncmenu.name",type:"TEMPLATE",component:$i,priority:102,section:"left",permissions:["se.sync.page"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"deletePageMenu",nameI18nKey:"se.cms.actionitem.page.trash",type:"TEMPLATE",component:yi,priority:150,section:"left",permissions:["se.delete.page.menu"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageVersionsMenu",type:"HYBRID_ACTION",nameI18nKey:"se.cms.actionitem.page.versions",priority:104,section:"left",iconClassName:"icon-timesheet se-toolbar-menu-ddlb--button__icon",component:Fn,contextComponent:On,permissions:["se.version.page"],keepAliveOnClose:true});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.createVersionMenu",type:"ACTION",nameI18nKey:"se.cms.actionitem.page.versions.create",iconClassName:"icon-add se-toolbar-menu-ddlb--button__icon",callback:()=>{d.createPageVersion()},priority:120,section:"left",permissions:["se.version.page","se.create.version.page"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.rollbackVersionMenu",type:"ACTION",nameI18nKey:"se.cms.actionitem.page.versions.rollback",iconClassName:"hyicon hyicon-rollback se-toolbar-menu-ddlb--button__icon",callback:()=>{p.rollbackPageVersion()},priority:120,section:"left",permissions:["se.version.page","se.rollback.version.page"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageWorkflowMenu",type:"TEMPLATE",nameI18nKey:"se.cms.workflow.toolbar.view.workflow.menu",component:qt,priority:110,section:"right"});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageDisplayStatus",type:"TEMPLATE",nameI18nKey:"se.cms.page.display.status",component:$t,priority:120,section:"right",permissions:["se.show.page.status"]});s.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"se.cms.pageApprovalSelector",type:"TEMPLATE",nameI18nKey:"se.cms.page.approval.selector",component:kt,priority:165,section:"right",permissions:["se.force.page.approval"]});const b=e.getToolbarService("smartEditHeaderToolbar");b.addItems([{key:"se.cms.workflowInbox",type:m.ToolbarItemType.TEMPLATE,component:Xt,priority:5,section:m.ToolbarSection.right,dropdownPosition:m.ToolbarDropDownPosition.right}]);const T=e.getToolbarService("smartEditNavigationToolbar");T.addItems([{key:"se.cms.shortcut",type:m.ToolbarItemType.TEMPLATE,component:m.ShortcutLinkComponent,priority:1,section:m.ToolbarSection.left}]);const P=e.getToolbarService("smartEditPagesToolbar");P.addItems([{key:"se.cms.shortcut",type:m.ToolbarItemType.TEMPLATE,component:m.ShortcutLinkComponent,priority:1,section:m.ToolbarSection.left},{key:"se.cms.trash.page.link",type:m.ToolbarItemType.TEMPLATE,component:no,priority:1,section:m.ToolbarSection.right}]);g.addItems([{component:eo},{component:uo}]);g.addItems([{component:Bi}],m.CATALOG_DETAILS_COLUMNS.RIGHT);s.register({key:"se.cms.html5DragAndDrop.outer",nameI18nKey:"se.cms.dragAndDrop.name",descriptionI18nKey:"se.cms.dragAndDrop.description",enablingCallback:()=>{u.register();u.apply()},disablingCallback:()=>{u.unregister()}});v.register({key:m.CMSModesService.BASIC_PERSPECTIVE_KEY,nameI18nKey:"se.cms.perspective.basic.name",descriptionI18nKey:"se.hotkey.tooltip",features:["se.contextualMenu","se.cms.dragandropbutton","se.cms.remove","se.cms.edit","se.cms.componentMenuTemplate","se.cms.clonePageMenu","se.cms.pageInfoMenu","se.emptySlotFix","se.cms.html5DragAndDrop","disableSharedSlotEditing","sharedSlotDisabledDecorator","se.cms.html5DragAndDrop.outer","externalComponentDecorator","externalcomponentbutton","externalSlotDisabledDecorator","clonecomponentbutton","deletePageMenu","se.cms.pageWorkflowMenu","se.cms.pageDisplayStatus","se.cms.pageApprovalSelector","se.cms.sharedcomponentbutton"],perspectives:[]});v.register({key:m.CMSModesService.ADVANCED_PERSPECTIVE_KEY,nameI18nKey:"se.cms.perspective.advanced.name",descriptionI18nKey:"se.hotkey.tooltip",features:["se.slotContextualMenu","se.slotSyncButton","se.slotSharedButton","se.slotContextualMenuVisibility","se.contextualMenu","se.cms.dragandropbutton","se.cms.remove","se.cms.edit","se.cms.componentMenuTemplate","se.cms.clonePageMenu","se.cms.pageInfoMenu","se.cms.pageSyncMenu","se.emptySlotFix","se.cms.html5DragAndDrop","se.cms.html5DragAndDrop.outer","syncIndicator","externalComponentDecorator","externalcomponentbutton","clonecomponentbutton","slotUnsharedButton","deletePageMenu","se.cms.pageVersionsMenu","se.cms.pageWorkflowMenu","se.cms.pageDisplayStatus","se.cms.pageApprovalSelector","se.cms.sharedcomponentbutton","se.cms.pageTreeMenu","se.cms.openInPageTreeButton"],perspectives:[]});v.register({key:m.CMSModesService.VERSIONING_PERSPECTIVE_KEY,nameI18nKey:"se.cms.perspective.versioning.name",descriptionI18nKey:"se.cms.perspective.versioning.description",features:["se.cms.pageVersionsMenu","se.cms.createVersionMenu","se.cms.rollbackVersionMenu","se.cms.pageInfoMenu","disableSharedSlotEditing","sharedSlotDisabledDecorator","externalSlotDisabledDecorator","externalComponentDecorator"],perspectives:[],permissions:["se.version.page"],isHotkeyDisabled:true});f.addSelector(`.${m.COMPONENT_CLASS}`,(()=>{u.update()}))}))),[m.IToolbarServiceFactory,t.RulesAndPermissionsRegistrationService,Cn,m.IFeatureService,m.SystemEventService,vi,Dn,Rn,m.ICatalogDetailsService,t.CmsDragAndDropService,m.IPerspectiveService,m.InViewElementObserver,m.IEditorModalService,p.IComponentVisibilityAlertService,t.NodeInfoService,m.CrossFrameEventService,m.IPageTreeService,m.ISettingsService])],declarations:[t.GenericEditorModalComponent,t.PageRestoredAlertComponent,t.ClonePageAlertComponent],entryComponents:[t.GenericEditorModalComponent,t.PageRestoredAlertComponent,t.ClonePageAlertComponent]})],t.CmssmarteditContainerModule);t.CMS_EVENT_HIDE_REPLACE_PARENT_HOMEPAGE_INFO=ke;t.CMS_EVENT_SHOW_REPLACE_PARENT_HOMEPAGE_INFO=Re;t.ENABLE_CLONE_ON_DROP=ze;t.INTERVAL_MILLISEC=Qe;t.INTERVAL_RETRIES=Xe;t.OPEN_COMPONENT_EVENT=k;t.PRODUCT_CATEGORY_RESOURCE_BASE_URI=Le;t.PRODUCT_CATEGORY_RESOURCE_URI=Ve;t.PRODUCT_CATEGORY_SEARCH_RESOURCE_URI=Ue;t.RESET_COMPONENT_MENU_EVENT=F;t.RestrictionsStepHandler=RestrictionsStepHandler},962:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=o(86);var s=o(105);var a=o(0);var r=o(4);var d=o(20);var p=o(3);var m=o(42);var g=o(46);var u=o(93);var v=o(136);(function(){var e=e||window.angular;var t=null;try{t=e.module("cmscommonsTemplates")}catch(e){}t=t||e.module("cmscommonsTemplates",[]);t.run(["$templateCache",function(e){e.put("ExternalComponentButtonComponent.html",'<div class="se-ctx-menu-btn__msg" *ngIf="isReady">{{ catalogVersion }}</div>');e.put("SharedComponentButtonComponent.html",'<div class="se-ctx-menu-btn__msg"><div class="se-ctx-menu-btn__msg-title" translate="se.cms.contextmenu.shared.component.info.title"></div><div *ngIf="isReady" class="se-ctx-menu-btn__msg-description" [translate]="message"></div><se-spinner [isSpinning]="!isReady"></se-spinner></div>');e.put("SynchronizationPanelComponent.html",'<div class="se-sync-panel"><se-message *ngIf="message" [type]="message.type"><ng-container se-message-description>{{ message.description }}</ng-container></se-message><div class="se-sync-panel__sync-info" [style.visibility]="showItemList ? \'visible\': \'hidden\'"><se-spinner [isSpinning]="isLoading"></se-spinner><se-synchronization-panel-item *ngFor="let item of getAllItems(); let i = index" class="se-sync-panel__row" [index]="i" [item]="item" [rootItem]="getRootItem()" [selectAllLabel]="selectAllLabel" [disableList]="disableList" [disableItem]="api.disableItem" (selectionChange)="selectionChange($event)"></se-synchronization-panel-item></div><div class="se-sync-panel__footer" *ngIf="showFooter"><button class="se-sync-panel__sync-btn fd-button--emphasized" [disabled]="isSyncButtonDisabled()" (click)="syncItems()" translate="se.cms.actionitem.page.sync"></button></div></div>');e.put("SynchronizationPanelItemComponent.html",'<div class="se-sync-panel-item-checkbox fd-form__item"><input *ngIf="!item.isExternal" type="checkbox" [id]="\'sync-info__checkbox_\' + index" class="se-sync-panel-item-checkbox__field fd-form__control" [(ngModel)]="item.selected" (ngModelChange)="onSelectionChange()" [attr.disabled]="isItemDisabled() ? true : null"/> <label *ngIf="index === 0" [for]="\'sync-info__checkbox_\' + index" class="se-sync-panel-item-checkbox__label se-sync-panel-item-checkbox__label--select-all fd-form__label" [title]="getSelectAllLabel() | translate" [translate]="getSelectAllLabel()"></label> <label *ngIf="index !== 0 && !item.isExternal" [for]="\'sync-info__checkbox_\' + index" class="se-sync-panel-item-checkbox__label fd-form__label" [title]="item.name | translate" [translate]="item.name"></label><se-tooltip *ngIf="index !== 0 && item.isExternal" [isChevronVisible]="true" [triggers]="[\'mouseenter\', \'mouseleave\']"><label se-tooltip-trigger [for]="\'sync-info__checkbox_\' + index" class="se-sync-panel-item-checkbox__label fd-form__label" [translate]="item.name"></label><div se-tooltip-body translate="se.cms.synchronization.slot.external.component"></div></se-tooltip></div><span *ngIf="showPopoverOverSyncIcon()"><se-tooltip [isChevronVisible]="true" [appendTo]="\'body\'" [placement]="\'left\'" [triggers]="[\'mouseenter\', \'mouseleave\']" [title]="getInfoTitle()" class="pull-right se-sync-panel-item-info-icon" [ngClass]="{ \'se-sync-panel--icon-globe\': item.isExternal }"><ng-container *ngIf="!item.isExternal" se-tooltip-trigger><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></ng-container><span *ngIf="item.isExternal" class="sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body><ng-container *ngIf="!item.isExternal"><div *ngFor="let dependentItem of item.dependentItemTypesOutOfSync">{{ dependentItem.i18nKey | translate }}</div></ng-container><div *ngIf="item.isExternal">{{ item.catalogVersionName | seL10n | async }}</div></div></se-tooltip></span><span *ngIf="!showPopoverOverSyncIcon()" class="pull-right se-sync-panel-item-info-icon"><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></span><ng-template #syncInfoIcon><span [attr.status]="item.status" class="se-sync-panel-item-info-icon__icon" [ngClass]="{                \'sap-icon--accept\': isInSync(),                \'sap-icon--message-warning\': !isInSync()            }"></span></ng-template>')}])})();function __decorate(e,t,o,n){var s=arguments.length,a=s<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,o):n,r;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,o,n);else for(var d=e.length-1;d>=0;d--)if(r=e[d])a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a;return s>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){function adopt(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function fulfilled(e){try{step(n.next(e))}catch(e){s(e)}}function rejected(e){try{step(n["throw"](e))}catch(e){s(e)}}function step(e){e.done?o(e.value):adopt(e.value).then(fulfilled,rejected)}step((n=n.apply(e,t||[])).next())}))}t.AssetsService=class AssetsService{constructor(e){this.testModeService=e;this.TEST_ASSETS_SRC="/web/webroot";this.PROD_ASSETS_SRC="/cmssmartedit"}getAssetsRoot(){return this.testModeService.isE2EMode()?this.TEST_ASSETS_SRC:this.PROD_ASSETS_SRC}};t.AssetsService.$inject=["testModeService"];t.AssetsService=__decorate([n.SeDowngradeService(),__metadata("design:paramtypes",[n.TestModeService])],t.AssetsService);const f="WORKFLOW_CREATED_EVENT";const S="WORKFLOW_FINISHED_EVENT";const C=new n.EvictionTag({event:f});const b=new n.EvictionTag({event:S});const I=new n.EvictionTag({event:"WORKFLOW_TASKS_MENU_OPENED_EVENT"});const w=new n.EvictionTag({event:"SLOT_UPDATE_EVENT"});class IContextAwareEditableItemService{isItemEditable(e){"proxyFunction";return null}}const E="CURRENT_CONTEXT_CATALOG";const T="CURRENT_CONTEXT_CATALOG_VERSION";const P="CURRENT_CONTEXT_SITE_ID";const A="CURRENT_PAGE_CONTEXT_CATALOG";const O="CURRENT_PAGE_CONTEXT_CATALOG_VERSION";const x="/cmswebservices/v1/types";const D=`/cmswebservices/v1/sites/${P}/catalogs/${E}/versions/${T}/items`;const k=`/cmswebservices/v1/sites/${n.PAGE_CONTEXT_SITE_ID}/catalogs/${A}/versions/${O}/pagescontentslotscomponents`;const F=`/cmswebservices/v1/catalogs/${A}/versions/${O}/pages/:pageUid/contentslots/:slotUid/typerestrictions`;const V=`/cmswebservices/v1/catalogs/${A}/versions/${O}/pages/:pageUid/typerestrictions`;const U=`/cmswebservices/v1/sites/${P}/catalogs/${E}/versions/${T}/pages`;const $="/pages/:siteId/:catalogId/:catalogVersion";const K="/trashedpages/:siteId/:catalogId/:catalogVersion";const Y=`/cmswebservices/v1/sites/${n.PAGE_CONTEXT_SITE_ID}/catalogs/${A}/versions/${O}/pagescontentslots`;const X=`/cmswebservices/v1/sites/:${P}/catalogs/:${E}/versions/:${T}/pagetemplates`;const J="/navigations/:siteId/:catalogId/:catalogVersion";const ee=`/cmswebservices/v1/sites/:${P}/catalogs/:${E}/versions/:${T}/navigations`;const te=`/cmswebservices/v1/sites/:${P}/catalogs/:${E}/versions/:${T}/navigations/:navigationUid/entries`;const ie="/cmswebservices/v1/navigationentrytypes";const oe=`/cmswebservices/v1/sites/${n.PAGE_CONTEXT_SITE_ID}/catalogs/${A}/versions/${O}/pagesrestrictions`;const ne="/cmswebservices/v1/sites/:siteUID/catalogs/:catalogId/versions/:catalogVersion/pagesrestrictions";const se="/cmswebservices/v1/restrictiontypes";const ae="/cmswebservices/v1/pagetypesrestrictiontypes";const re="/cmswebservices/v1/pagetypes";const le=`/cmssmarteditwebservices/v1/sites/${n.PAGE_CONTEXT_SITE_ID}/catalogs/${A}/versions/${O}/synchronizations/versions/:target/pages/:pageUid`;const ce=`/cmssmarteditwebservices/v1/sites/${P}/catalogs/${E}/versions/${T}/synchronizations/versions/:target`;class IPageContentSlotsComponentsRestService{clearCache(){"proxyFunction"}getSlotsToComponentsMapForPageUid(e){"proxyFunction";return null}getComponentsForSlot(e){"proxyFunction";return null}}t.SynchronizationResourceService=class SynchronizationResourceService{constructor(e){this.restServiceFactory=e}getPageSynchronizationGetRestService(e){const t=new n.URIBuilder(le).replaceParams(e).build();return this.restServiceFactory.get(t)}getPageSynchronizationPostRestService(e){const t=new n.URIBuilder(ce).replaceParams(e).build();return this.restServiceFactory.get(t)}};t.SynchronizationResourceService.$inject=["restServiceFactory"];t.SynchronizationResourceService=__decorate([n.SeDowngradeService(),__metadata("design:paramtypes",[n.IRestServiceFactory])],t.SynchronizationResourceService);t.ComponentService=class ComponentService{constructor(e,t,o,n){this.restServiceFactory=e;this.cmsitemsRestService=t;this.pageInfoService=o;this.pageContentSlotsComponentsRestService=n;this.pageComponentTypesRestServiceURI="/cmssmarteditwebservices/v1/catalogs/:catalogId/versions/:catalogVersion/pages/:pageId/types";this.pageComponentTypesRestService=this.restServiceFactory.get(this.pageComponentTypesRestServiceURI);this.restServiceForAddExistingComponent=this.restServiceFactory.get(k)}getSupportedComponentTypesForCurrentPage(e){return this.pageComponentTypesRestService.get(e)}createNewComponent(e,t){const o={name:e.name,slotId:e.targetSlotId,pageId:e.pageId,position:e.position,typeCode:e.componentType,itemtype:e.componentType,catalogVersion:e.catalogVersionUuid,uid:"",uuid:""};if(typeof t==="object"){for(const e in t){if(t.hasOwnProperty(e)){o[e]=t[e]}}}else if(t){throw new Error(`ComponentService.createNewComponent() - Illegal componentPayload - [${t}]`)}return this.cmsitemsRestService.create(o)}updateComponent(e){return this.cmsitemsRestService.update(e)}addExistingComponent(e,t,o,n){return this.restServiceForAddExistingComponent.save({pageId:e,slotId:o,componentId:t,position:n})}loadComponentItem(e){return this.cmsitemsRestService.getById(e)}loadPagedComponentItemsByCatalogVersion(e){const t={pageSize:e.pageSize,currentPage:e.page,mask:e.mask,sort:"name",typeCode:"AbstractCMSComponent",catalogId:e.catalogId,catalogVersion:e.catalogVersion,itemSearchParams:""};return this.cmsitemsRestService.get(t)}getSlotsForComponent(e){return __awaiter(this,void 0,void 0,(function*(){const t=yield this.getContentSlotsForComponents();return Object.entries(t).filter((([,t])=>t.find((t=>t.uuid===e)))).map((([e])=>e))}))}getContentSlotsForComponents(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.pageInfoService.getPageUID();return yield this.pageContentSlotsComponentsRestService.getSlotsToComponentsMapForPageUid(e)}))}};t.ComponentService.$inject=["restServiceFactory","cmsitemsRestService","pageInfoService","pageContentSlotsComponentsRestService"];__decorate([n.Cached({actions:[n.rarelyChangingContent],tags:[n.pageChangeEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",Promise)],t.ComponentService.prototype,"getSupportedComponentTypesForCurrentPage",null);t.ComponentService=__decorate([n.SeDowngradeService(),__metadata("design:paramtypes",[n.IRestServiceFactory,n.CmsitemsRestService,n.IPageInfoService,IPageContentSlotsComponentsRestService])],t.ComponentService);(function(e){e["TEMPLATE"]="TEMPLATE";e["PAGE"]="PAGE";e["OVERRIDE"]="OVERRIDE"})(t.SlotStatus||(t.SlotStatus={}));(function(e){e["RUNNING"]="RUNNING";e["ERROR"]="ERROR";e["FAILURE"]="FAILURE";e["FINISHED"]="FINISHED";e["UNKNOWN"]="UNKNOWN";e["ABORTED"]="ABORTED";e["PENDING"]="PENDING"})(t.JOB_STATUS||(t.JOB_STATUS={}));(function(e){e["COMPONENT"]="COMPONENT";e["PREVIEW"]="PREVIEW";e["PAGE"]="PAGE";e["RESTRICTION"]="RESTRICTION"})(t.StructureTypeCategory||(t.StructureTypeCategory={}));const de={UNAVAILABLE:"UNAVAILABLE",IN_SYNC:"IN_SYNC",NOT_SYNC:"NOT_SYNC",IN_PROGRESS:"IN_PROGRESS",SYNC_FAILED:"SYNC_FAILED"};const pe={SLOW_POLLING_TIME:2e4,FAST_POLLING_TIME:4e3,SPEED_UP:"syncPollingSpeedUp",SLOW_DOWN:"syncPollingSlowDown",FAST_FETCH:"syncFastFetch",FETCH_SYNC_STATUS_ONCE:"fetchSyncStatusOnce"};const me={CATALOG_SYNCHRONIZED:"CATALOG_SYNCHRONIZED_EVENT"};(function(e){e["Unavailable"]="UNAVAILABLE";e["InSync"]="IN_SYNC";e["NotSync"]="NOT_SYNC";e["InProgress"]="IN_PROGRESS";e["SyncFailed"]="SYNC_FAILED"})(t.SynchronizationStatus||(t.SynchronizationStatus={}));class SynchronizationUtils{isInSync(e){return e.status===t.SynchronizationStatus.InSync}isInNotSync(e){return e.status===t.SynchronizationStatus.NotSync}isSyncInFailed(e){return e.status===t.SynchronizationStatus.SyncFailed}isSyncInProgress(e){return e.status===t.SynchronizationStatus.InProgress}isExternalItem(e){return!!e.isExternal}}const ge=new SynchronizationUtils;class SyncQueue{constructor(){this.items=[]}getItems(){return this.items}addItems(e){this.items=this.items.concat(e)}removeItem(e){this.items=this.items.filter((t=>t!==e.itemId))}itemExists(e){return this.getItems().includes(e.itemId)}isEmpty(){return this.getItems().length===0}hasAtLeastOneItem(){return this.getItems().length>0}emptyItems(){this.items=[]}}window.__smartedit__.addDecoratorPayload("Component","SynchronizationPanelComponent",{selector:"se-synchronization-panel",template:`<div class="se-sync-panel"><se-message *ngIf="message" [type]="message.type"><ng-container se-message-description>{{ message.description }}</ng-container></se-message><div class="se-sync-panel__sync-info" [style.visibility]="showItemList ? 'visible': 'hidden'"><se-spinner [isSpinning]="isLoading"></se-spinner><se-synchronization-panel-item *ngFor="let item of getAllItems(); let i = index" class="se-sync-panel__row" [index]="i" [item]="item" [rootItem]="getRootItem()" [selectAllLabel]="selectAllLabel" [disableList]="disableList" [disableItem]="api.disableItem" (selectionChange)="selectionChange($event)"></se-synchronization-panel-item></div><div class="se-sync-panel__footer" *ngIf="showFooter"><button class="se-sync-panel__sync-btn fd-button--emphasized" [disabled]="isSyncButtonDisabled()" (click)="syncItems()" translate="se.cms.actionitem.page.sync"></button></div></div>`,styles:[`.se-sync-panel__sync-info{max-height:300px;overflow-y:auto}.se-sync-panel__row{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:0 20px;height:40px;border-bottom:1px solid #d9d9d9}.se-sync-panel__row:first-child{height:50px}.se-sync-panel__row:last-child{border-bottom:none}.se-sync-panel__footer{padding:20px;border-top:1px solid #d9d9d9;display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.se-sync-panel__sync-btn{text-transform:capitalize;padding:0 20px;margin-left:8px}`]});t.SynchronizationPanelComponent=class SynchronizationPanelComponent{constructor(e,t,o,n,s,r,d,p,m,g){this.waitDialogService=e;this.logService=t;this.crossFrameEventService=o;this.systemEventService=n;this.timerService=s;this.alertService=r;this.translateService=d;this.sharedDataService=p;this.catalogService=m;this.userTrackingService=g;this.getApi=new a.EventEmitter;this.selectedItemsUpdate=new a.EventEmitter;this.syncStatusReady=new a.EventEmitter;this.showFooter=true;this.showItemList=true;this.message=null;this.disableList=false;this.isLoading=false;this.SYNC_POLLING_SPEED_PREFIX="syncPanel-";this.syncQueue=new SyncQueue;this.api={selectAll:()=>{if(!this.isRootItemExist()){throw new Error("Synchronization status is not available. The 'selectAll' function should be used with 'onSyncStatusReady' event.")}this.toogleRootItem(true)},displayItemList:e=>{this.showItemList=e},disableItemList:e=>{this.disableList=e},setMessage:e=>{this.message=e},disableItem:null}}ngOnInit(){this.getApi.emit(this.api);this.unsubscribeFastFetch=this.crossFrameEventService.subscribe(pe.FAST_FETCH,((e,t)=>this.fetchSyncStatus(t)));this.fetchSyncStatus();this.resynchTimer=this.timerService.createTimer((()=>this.fetchSyncStatus()),pe.SLOW_POLLING_TIME);this.resynchTimer.start()}ngOnDestroy(){const e=this.timerService.createTimer((()=>{if(this.syncQueue.isEmpty()){this.resynchTimer.teardown();this.unsubscribeFastFetch();this.systemEventService.publishAsync(pe.SLOW_DOWN,this.SYNC_POLLING_SPEED_PREFIX+this.itemId);this.toggleWaitModal(false);e.teardown()}else{this.toggleWaitModal(true)}}),200);e.start()}syncItems(){const e=this.getSelectedItemPayloads();const t=e.map((e=>e.itemId));this.userTrackingService.trackingUserAction(n.USER_TRACKING_FUNCTIONALITY.TOOL_BAR,"Sync");this.syncQueue.addItems(t);if(this.atLeastOneSelectedItemExists()){this.toggleWaitModal(true);return this.performSync(e).then((()=>{this.speedUpPolling()}),(()=>{this.logService.warn("[synchronizationPanel] - Could not perform synchronization.");this.toggleWaitModal(false);this.syncQueue.emptyItems()}))}else{return Promise.resolve()}}selectionChange(e){if(e===0){this.toggleAllDependentItems()}this.saveCurrentlySelectedItemsInStorage();this.selectedItemsUpdate.emit(this.getSelectedItems())}isSyncButtonDisabled(){return this.disableList||this.noSelectedItems()||this.syncQueue.hasAtLeastOneItem()}fetchSyncStatus(e){return __awaiter(this,void 0,void 0,(function*(){if(e&&e.itemId!==this.itemId){return}this.isLoading=true;const t=yield this.getSyncStatus(this.itemId);this.setRootItem(t);this.restoreSelectionAfterFetchingUpdatedItems();this.markExternalItems();this.showSyncErrors();this.updateSyncQueue();this.setExternalItemsCatalogVersionName();if(this.syncQueue.isEmpty()){this.slowDownPolling();this.toggleWaitModal(false)}this.syncStatusReady.emit(this.getRootItem());this.isLoading=false}))}markExternalItems(){const e=this.getRootItem();const t=e.catalogVersionUuid;const o=this.getDependentItems();o.forEach((e=>{e.isExternal=e.catalogVersionUuid!==t}))}getAllItems(){return this.isRootItemExist()?[this.getRootItem(),...this.getDependentItems()]:[]}setExternalItemsCatalogVersionName(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.getCurrentExperience();const t=this.getAllItems();const o=t.filter((e=>ge.isExternalItem(e)));const n=o.map((t=>new Promise((o=>__awaiter(this,void 0,void 0,(function*(){const{catalogName:n}=yield this.catalogService.getCatalogVersionByUuid(t.catalogVersionUuid,e.siteDescriptor.uid);t.catalogVersionName=n;o(t)}))))));yield Promise.all(n)}))}slowDownPolling(){this.resynchTimer.restart(pe.SLOW_POLLING_TIME);this.systemEventService.publishAsync(pe.SLOW_DOWN,this.SYNC_POLLING_SPEED_PREFIX+this.itemId)}speedUpPolling(){this.resynchTimer.restart(pe.FAST_POLLING_TIME);this.systemEventService.publishAsync(pe.SPEED_UP,this.SYNC_POLLING_SPEED_PREFIX+this.itemId)}setRootItem(e){this.rootItem=e}getRootItem(){return this.rootItem}isRootItemExist(){return this.getRootItem()!=null}getDependentItems(){return this.isRootItemExist()?this.getRootItem().selectedDependencies:[]}getCurrentExperience(){return this.sharedDataService.get(n.EXPERIENCE_STORAGE_KEY)}getSelectedItemPayloads(){return this.getSelectedItems().map((({itemId:e,itemType:t})=>({itemId:e,itemType:t})))}getSelectedItems(){return this.getAllItems().filter((e=>e.selected))}toogleRootItem(e){if(this.isRootItemExist()){const t=this.getRootItem();t.selected=e;this.selectionChange(0)}}toggleAllDependentItems(){this.getDependentItems().filter((e=>!ge.isInSync(e))).filter((e=>!ge.isExternalItem(e))).forEach((e=>{e.selected=this.getRootItem().selected}))}toggleWaitModal(e){if(e){this.waitDialogService.showWaitModal("se.sync.synchronizing")}else{this.waitDialogService.hideWaitModal()}}saveCurrentlySelectedItemsInStorage(){this.selectedItemsStorage=this.getSelectedItems()}getSelectedItemsFromStorage(){return this.selectedItemsStorage||[]}restoreSelectionAfterFetchingUpdatedItems(){const e=this.getSelectedItemsFromStorage();const t=e.map((e=>e.itemId));this.getAllItems().filter((e=>!ge.isInSync(e))).filter((e=>t.indexOf(e.itemId)>-1)).forEach((e=>e.selected=true))}updateSyncQueue(){const e=this.syncQueue.hasAtLeastOneItem();const t=this.getAllItems();t.filter((e=>this.syncQueue.itemExists(e))).filter((e=>!(ge.isSyncInProgress(e)||ge.isInNotSync(e)))).forEach((e=>this.syncQueue.removeItem(e)));t.filter((e=>!this.syncQueue.itemExists(e))).filter((e=>ge.isSyncInProgress(e))).forEach((e=>this.syncQueue.addItems([e.itemId])));const o=this.syncQueue.isEmpty();if(e&&o){this.systemEventService.publishAsync(n.EVENT_CONTENT_CATALOG_UPDATE)}}showSyncErrors(){const e=this.getAllItems().filter((e=>this.syncQueue.itemExists(e))).filter((e=>ge.isSyncInFailed(e))).map((e=>e.itemId));if(e.length>0){this.alertService.showDanger({message:this.translateService.instant("se.cms.synchronization.panel.failure.message",{items:e.join(" ")})})}}atLeastOneSelectedItemExists(){return this.getSelectedItems().length>0}noSelectedItems(){return this.getSelectedItems().length===0}};t.SynchronizationPanelComponent.$inject=["waitDialogService","logService","crossFrameEventService","systemEventService","timerService","alertService","translateService","sharedDataService","catalogService","userTrackingService"];__decorate([a.Input(),__metadata("design:type",String)],t.SynchronizationPanelComponent.prototype,"itemId",void 0);__decorate([a.Input(),__metadata("design:type",String)],t.SynchronizationPanelComponent.prototype,"selectAllLabel",void 0);__decorate([a.Input(),__metadata("design:type",Function)],t.SynchronizationPanelComponent.prototype,"getSyncStatus",void 0);__decorate([a.Input(),__metadata("design:type",Function)],t.SynchronizationPanelComponent.prototype,"performSync",void 0);__decorate([a.Input(),__metadata("design:type",Boolean)],t.SynchronizationPanelComponent.prototype,"showFooter",void 0);__decorate([a.Output(),__metadata("design:type",Object)],t.SynchronizationPanelComponent.prototype,"getApi",void 0);__decorate([a.Output(),__metadata("design:type",Object)],t.SynchronizationPanelComponent.prototype,"selectedItemsUpdate",void 0);__decorate([a.Output(),__metadata("design:type",Object)],t.SynchronizationPanelComponent.prototype,"syncStatusReady",void 0);t.SynchronizationPanelComponent=__decorate([n.SeDowngradeComponent(),a.Component({selector:"se-synchronization-panel",template:`<div class="se-sync-panel"><se-message *ngIf="message" [type]="message.type"><ng-container se-message-description>{{ message.description }}</ng-container></se-message><div class="se-sync-panel__sync-info" [style.visibility]="showItemList ? 'visible': 'hidden'"><se-spinner [isSpinning]="isLoading"></se-spinner><se-synchronization-panel-item *ngFor="let item of getAllItems(); let i = index" class="se-sync-panel__row" [index]="i" [item]="item" [rootItem]="getRootItem()" [selectAllLabel]="selectAllLabel" [disableList]="disableList" [disableItem]="api.disableItem" (selectionChange)="selectionChange($event)"></se-synchronization-panel-item></div><div class="se-sync-panel__footer" *ngIf="showFooter"><button class="se-sync-panel__sync-btn fd-button--emphasized" [disabled]="isSyncButtonDisabled()" (click)="syncItems()" translate="se.cms.actionitem.page.sync"></button></div></div>`,styles:[`.se-sync-panel__sync-info{max-height:300px;overflow-y:auto}.se-sync-panel__row{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:0 20px;height:40px;border-bottom:1px solid #d9d9d9}.se-sync-panel__row:first-child{height:50px}.se-sync-panel__row:last-child{border-bottom:none}.se-sync-panel__footer{padding:20px;border-top:1px solid #d9d9d9;display:flex;flex-direction:row;align-items:center;justify-content:flex-end}.se-sync-panel__sync-btn{text-transform:capitalize;padding:0 20px;margin-left:8px}`]}),__metadata("design:paramtypes",[n.IWaitDialogService,n.LogService,n.CrossFrameEventService,n.SystemEventService,n.TimerService,n.IAlertService,s.TranslateService,n.ISharedDataService,n.ICatalogService,n.UserTrackingService])],t.SynchronizationPanelComponent);window.__smartedit__.addDecoratorPayload("Component","SynchronizationPanelItemComponent",{selector:"se-synchronization-panel-item",template:`<div class="se-sync-panel-item-checkbox fd-form__item"><input *ngIf="!item.isExternal" type="checkbox" [id]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__field fd-form__control" [(ngModel)]="item.selected" (ngModelChange)="onSelectionChange()" [attr.disabled]="isItemDisabled() ? true : null"/> <label *ngIf="index === 0" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label se-sync-panel-item-checkbox__label--select-all fd-form__label" [title]="getSelectAllLabel() | translate" [translate]="getSelectAllLabel()"></label> <label *ngIf="index !== 0 && !item.isExternal" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form__label" [title]="item.name | translate" [translate]="item.name"></label><se-tooltip *ngIf="index !== 0 && item.isExternal" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><label se-tooltip-trigger [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form__label" [translate]="item.name"></label><div se-tooltip-body translate="se.cms.synchronization.slot.external.component"></div></se-tooltip></div><span *ngIf="showPopoverOverSyncIcon()"><se-tooltip [isChevronVisible]="true" [appendTo]="'body'" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [title]="getInfoTitle()" class="pull-right se-sync-panel-item-info-icon" [ngClass]="{ 'se-sync-panel--icon-globe': item.isExternal }"><ng-container *ngIf="!item.isExternal" se-tooltip-trigger><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></ng-container><span *ngIf="item.isExternal" class="sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body><ng-container *ngIf="!item.isExternal"><div *ngFor="let dependentItem of item.dependentItemTypesOutOfSync">{{ dependentItem.i18nKey | translate }}</div></ng-container><div *ngIf="item.isExternal">{{ item.catalogVersionName | seL10n | async }}</div></div></se-tooltip></span><span *ngIf="!showPopoverOverSyncIcon()" class="pull-right se-sync-panel-item-info-icon"><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></span><ng-template #syncInfoIcon><span [attr.status]="item.status" class="se-sync-panel-item-info-icon__icon" [ngClass]="{\n                'sap-icon--accept': isInSync(),\n                'sap-icon--message-warning': !isInSync()\n            }"></span></ng-template>`,styles:[`.se-sync-panel-item-checkbox{display:flex;flex-direction:row;align-items:center;margin:0!important}.se-sync-panel-item-checkbox__field{margin:0}.se-sync-panel-item-checkbox__label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:190px!important;margin:0!important;padding-left:8px;color:#32363a;text-transform:capitalize}.se-sync-panel-item-checkbox__label--select-all{font-weight:700!important}.se-sync-panel-item-info-icon{font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-sync-panel-item-info-icon__icon.sap-icon--accept{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#0a7e3e}.se-sync-panel-item-info-icon__icon.sap-icon--message-warning{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#e9730c}`]});t.SynchronizationPanelItemComponent=class SynchronizationPanelItemComponent{constructor(){this.selectionChange=new a.EventEmitter}getSelectAllLabel(){return this.selectAllLabel||"se.cms.synchronization.page.select.all.slots"}isItemDisabled(){var e;if(this.disableList||this.disableItem&&this.disableItem(this.item)){return true}return this.item!==this.rootItem&&!!((e=this.rootItem)===null||e===void 0?void 0:e.selected)||ge.isInSync(this.item)}showPopoverOverSyncIcon(){var e;return((e=this.item.dependentItemTypesOutOfSync)===null||e===void 0?void 0:e.length)>0||ge.isExternalItem(this.item)}getInfoTitle(){return!ge.isExternalItem(this.item)?"se.cms.synchronization.panel.update.title":""}isInSync(){return ge.isInSync(this.item)}onSelectionChange(){this.selectionChange.emit(this.index)}};__decorate([a.Input(),__metadata("design:type",Number)],t.SynchronizationPanelItemComponent.prototype,"index",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.SynchronizationPanelItemComponent.prototype,"item",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.SynchronizationPanelItemComponent.prototype,"rootItem",void 0);__decorate([a.Input(),__metadata("design:type",String)],t.SynchronizationPanelItemComponent.prototype,"selectAllLabel",void 0);__decorate([a.Input(),__metadata("design:type",Boolean)],t.SynchronizationPanelItemComponent.prototype,"disableList",void 0);__decorate([a.Input(),__metadata("design:type",Function)],t.SynchronizationPanelItemComponent.prototype,"disableItem",void 0);__decorate([a.Output(),__metadata("design:type",Object)],t.SynchronizationPanelItemComponent.prototype,"selectionChange",void 0);t.SynchronizationPanelItemComponent=__decorate([n.SeDowngradeComponent(),a.Component({selector:"se-synchronization-panel-item",template:`<div class="se-sync-panel-item-checkbox fd-form__item"><input *ngIf="!item.isExternal" type="checkbox" [id]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__field fd-form__control" [(ngModel)]="item.selected" (ngModelChange)="onSelectionChange()" [attr.disabled]="isItemDisabled() ? true : null"/> <label *ngIf="index === 0" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label se-sync-panel-item-checkbox__label--select-all fd-form__label" [title]="getSelectAllLabel() | translate" [translate]="getSelectAllLabel()"></label> <label *ngIf="index !== 0 && !item.isExternal" [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form__label" [title]="item.name | translate" [translate]="item.name"></label><se-tooltip *ngIf="index !== 0 && item.isExternal" [isChevronVisible]="true" [triggers]="['mouseenter', 'mouseleave']"><label se-tooltip-trigger [for]="'sync-info__checkbox_' + index" class="se-sync-panel-item-checkbox__label fd-form__label" [translate]="item.name"></label><div se-tooltip-body translate="se.cms.synchronization.slot.external.component"></div></se-tooltip></div><span *ngIf="showPopoverOverSyncIcon()"><se-tooltip [isChevronVisible]="true" [appendTo]="'body'" [placement]="'left'" [triggers]="['mouseenter', 'mouseleave']" [title]="getInfoTitle()" class="pull-right se-sync-panel-item-info-icon" [ngClass]="{ 'se-sync-panel--icon-globe': item.isExternal }"><ng-container *ngIf="!item.isExternal" se-tooltip-trigger><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></ng-container><span *ngIf="item.isExternal" class="sap-icon--globe" se-tooltip-trigger></span><div se-tooltip-body><ng-container *ngIf="!item.isExternal"><div *ngFor="let dependentItem of item.dependentItemTypesOutOfSync">{{ dependentItem.i18nKey | translate }}</div></ng-container><div *ngIf="item.isExternal">{{ item.catalogVersionName | seL10n | async }}</div></div></se-tooltip></span><span *ngIf="!showPopoverOverSyncIcon()" class="pull-right se-sync-panel-item-info-icon"><ng-container *ngTemplateOutlet="syncInfoIcon"></ng-container></span><ng-template #syncInfoIcon><span [attr.status]="item.status" class="se-sync-panel-item-info-icon__icon" [ngClass]="{\n                'sap-icon--accept': isInSync(),\n                'sap-icon--message-warning': !isInSync()\n            }"></span></ng-template>`,styles:[`.se-sync-panel-item-checkbox{display:flex;flex-direction:row;align-items:center;margin:0!important}.se-sync-panel-item-checkbox__field{margin:0}.se-sync-panel-item-checkbox__label{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;word-break:break-all;max-width:190px!important;margin:0!important;padding-left:8px;color:#32363a;text-transform:capitalize}.se-sync-panel-item-checkbox__label--select-all{font-weight:700!important}.se-sync-panel-item-info-icon{font-size:1.1428571429rem;line-height:1.25;font-weight:400}.se-sync-panel-item-info-icon__icon.sap-icon--accept{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#0a7e3e}.se-sync-panel-item-info-icon__icon.sap-icon--message-warning{font-size:1.1428571429rem;line-height:1.25;font-weight:400;color:#e9730c}`]})],t.SynchronizationPanelItemComponent);const ue=[{provide:"SYNCHRONIZATION_STATUSES",useValue:de},{provide:"SYNCHRONIZATION_POLLING",useValue:pe},{provide:"SYNCHRONIZATION_EVENT",useValue:me}];t.SynchronizationPanelModule=class SynchronizationPanelModule{};t.SynchronizationPanelModule=__decorate([a.NgModule({imports:[r.CommonModule,d.FormsModule,n.TranslationModule.forChild(),n.TooltipModule,n.MessageModule,n.SpinnerModule,n.L10nPipeModule],declarations:[t.SynchronizationPanelComponent,t.SynchronizationPanelItemComponent],entryComponents:[t.SynchronizationPanelComponent],providers:[...ue,n.moduleUtils.initialize((()=>{n.diBridgeUtils.downgradeService("SYNCHRONIZATION_STATUSES",null,"SYNCHRONIZATION_STATUSES");n.diBridgeUtils.downgradeService("SYNCHRONIZATION_POLLING",null,"SYNCHRONIZATION_POLLING");n.diBridgeUtils.downgradeService("SYNCHRONIZATION_EVENT",null,"SYNCHRONIZATION_EVENT")}))],exports:[t.SynchronizationPanelComponent]})],t.SynchronizationPanelModule);const he=5e3;t.SynchronizationService=class SynchronizationService{constructor(e,t,o,n,s,a){this.restServiceFactory=e;this.timerService=t;this.translateService=o;this.alertService=n;this.authenticationService=s;this.crossFrameEventService=a;this.BASE_URL="/cmswebservices";this.SYNC_JOB_INFO_BY_TARGET_URI="/cmswebservices/v1/catalogs/:catalog/synchronizations/targetversions/:target";this.SYNC_JOB_INFO_BY_SOURCE_AND_TARGET_URI="/cmswebservices/v1/catalogs/:catalog/versions/:source/synchronizations/versions/:target";this.intervalHandle={};this.syncRequested=[];this.syncJobInfoByTargetRestService=this.restServiceFactory.get(this.SYNC_JOB_INFO_BY_TARGET_URI);this.syncJobInfoBySourceAndTargetRestService=this.restServiceFactory.get(this.SYNC_JOB_INFO_BY_SOURCE_AND_TARGET_URI,"catalog")}updateCatalogSync(e){return __awaiter(this,void 0,void 0,(function*(){const t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);this.addCatalogSyncRequest(t);try{const t=yield this.syncJobInfoBySourceAndTargetRestService.save({catalog:e.catalogId,source:e.sourceCatalogVersion,target:e.targetCatalogVersion});return t}catch(t){const o=this.translateService.instant("sync.running.error.msg",{catalogName:e.name});if(t.statusText==="Conflict"){this.alertService.showDanger({message:o})}return null}}))}getCatalogSyncStatus(e){if(e.sourceCatalogVersion){return this.getSyncJobInfoBySourceAndTarget(e)}else{return this.getLastSyncJobInfoByTarget(e)}}getSyncJobInfoBySourceAndTarget(e){return this.syncJobInfoBySourceAndTargetRestService.get({catalog:e.catalogId,source:e.sourceCatalogVersion,target:e.targetCatalogVersion})}getLastSyncJobInfoByTarget(e){return this.syncJobInfoByTargetRestService.get({catalog:e.catalogId,target:e.targetCatalogVersion})}startAutoGetSyncData(e,t){const{catalogId:o,sourceCatalogVersion:n,targetCatalogVersion:s}=e;const a=this._getJobKey(o,n,s);const r=this.timerService.createTimer((()=>this._autoSyncCallback(e,t,a)),he);r.start();this.intervalHandle[a]=r}stopAutoGetSyncData(e){const t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);if(this.intervalHandle[t]){if(this.syncRequested.indexOf(t)>-1){this.intervalHandle[t].discardWhenNextSynced=true}else{this.intervalHandle[t].stop();this.intervalHandle[t]=undefined}}}_autoSyncCallback(e,t,o){return __awaiter(this,void 0,void 0,(function*(){const n=yield this.authenticationService.isAuthenticated(this.BASE_URL);if(!n){this.stopAutoGetSyncData(e)}const s=yield this.getCatalogSyncStatus(e);const a=this.syncRequestedCallback(e)(s);t(a);if(!this.intervalHandle[o]){this.startAutoGetSyncData(e,t)}}))}syncRequestedCallback(e){const t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);return o=>{if(this.catalogSyncInProgress(t)){if(this.catalogSyncFinished(o)){this.removeCatalogSyncRequest(t);this.crossFrameEventService.publish(me.CATALOG_SYNCHRONIZED,e)}if(this.intervalHandle[t].discardWhenNextSynced&&this.catalogSyncFinished(o)||this.catalogSyncAborted(o)){this.intervalHandle[t].stop();this.intervalHandle[t]=undefined;this.removeCatalogSyncRequest(t)}}return o}}catalogSyncInProgress(e){return this.syncRequested.indexOf(e)>-1}catalogSyncFinished(e){return e.syncStatus===t.JOB_STATUS.FINISHED}catalogSyncAborted(e){return e.syncStatus===t.JOB_STATUS.ABORTED}removeCatalogSyncRequest(e){const t=this.syncRequested.indexOf(e);if(t>-1){this.syncRequested.splice(t,1)}}addCatalogSyncRequest(e){if(this.syncRequested.indexOf(e)===-1){this.syncRequested.push(e)}}_getJobKey(e,t,o){return e+"_"+t+"_"+o}};t.SynchronizationService.$inject=["restServiceFactory","timerService","translateService","alertService","authenticationService","crossFrameEventService"];t.SynchronizationService=__decorate([n.OperationContextRegistered("/cmswebservices/v1/catalogs/:catalog/synchronizations/targetversions/:target",n.OPERATION_CONTEXT.CMS),n.OperationContextRegistered("/cmswebservices/v1/catalogs/:catalog/versions/:source/synchronizations/versions/:target",n.OPERATION_CONTEXT.CMS),n.SeDowngradeService(),__metadata("design:paramtypes",[n.IRestServiceFactory,n.TimerService,s.TranslateService,n.IAlertService,n.IAuthenticationService,n.CrossFrameEventService])],t.SynchronizationService);t.CMSTimeService=class CMSTimeService{constructor(e){this.translate=e}getTimeAgo(e){const t=Math.floor(p.duration(e).asDays());const o=Math.floor(p.duration(e).asHours());if(t>=1){return t+" "+this.translate.instant("se.cms.actionitem.page.workflow.action.started.days.ago")}else if(o>=1){return o+" "+this.translate.instant("se.cms.actionitem.page.workflow.action.started.hours.ago")}return"<1 "+this.translate.instant("se.cms.actionitem.page.workflow.action.started.hours.ago")}};t.CMSTimeService.$inject=["translate"];t.CMSTimeService=__decorate([n.SeDowngradeService(),__metadata("design:paramtypes",[s.TranslateService])],t.CMSTimeService);var ve;t.VersionExperienceInterceptor=ve=class VersionExperienceInterceptor{constructor(e){this.sharedDataService=e}intercept(e,t){if(this.isGET(e)&&this.isPreviewDataTypeResourceEndpoint(e.url)){return m.from(this.sharedDataService.get(n.EXPERIENCE_STORAGE_KEY)).pipe(g.switchMap((o=>{if(o.versionId){const o=e.clone({url:e.url.replace(ve.MODE_DEFAULT,ve.MODE_PREVIEW_VERSION)});return t.handle(o)}else{return t.handle(e)}})))}else{return t.handle(e)}}isGET(e){return e.method==="GET"}isPreviewDataTypeResourceEndpoint(e){return e.indexOf(x)>-1&&e.indexOf(ve.PREVIEW_DATA_TYPE)>-1}};t.VersionExperienceInterceptor.MODE_DEFAULT="DEFAULT";t.VersionExperienceInterceptor.MODE_PREVIEW_VERSION="PREVIEWVERSION";t.VersionExperienceInterceptor.PREVIEW_DATA_TYPE="PreviewData";t.VersionExperienceInterceptor=ve=__decorate([a.Injectable(),__metadata("design:paramtypes",[n.ISharedDataService])],t.VersionExperienceInterceptor);class IComponentSharedService{isComponentShared(e){"proxyFunction";return null}}(function(e){e["CREATE"]="create";e["READ"]="read";e["CHANGE"]="change";e["REMOVE"]="remove"})(t.TypePermissionNames||(t.TypePermissionNames={}));t.TypePermissionsRestService=class TypePermissionsRestService{constructor(e,t,o){this.logService=e;this.sessionService=t;this.URI="/permissionswebservices/v1/permissions/types/search";this.resource=o.get(this.URI)}hasCreatePermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.CREATE)}hasReadPermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.READ)}hasUpdatePermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.CHANGE)}hasDeletePermissionForTypes(e){return this.getPermissionsForTypesAndName(e,t.TypePermissionNames.REMOVE)}hasAllPermissionsForTypes(e){return __awaiter(this,void 0,void 0,(function*(){const o={};const n=yield this.getAllPermissionsForTypes(e);return n.reduce(((e,o)=>{if(o.permissions){e[o.id]={};e[o.id][t.TypePermissionNames.READ]=this.getPermissionByNameAndResult(o,t.TypePermissionNames.READ);e[o.id][t.TypePermissionNames.CHANGE]=this.getPermissionByNameAndResult(o,t.TypePermissionNames.CHANGE);e[o.id][t.TypePermissionNames.CREATE]=this.getPermissionByNameAndResult(o,t.TypePermissionNames.CREATE);e[o.id][t.TypePermissionNames.REMOVE]=this.getPermissionByNameAndResult(o,t.TypePermissionNames.REMOVE)}return e}),o)}))}getAllPermissionsForTypes(e){return __awaiter(this,void 0,void 0,(function*(){if(e.length===0){return[]}const o=yield this.sessionService.getCurrentUsername();if(!o){return[]}try{const n=[t.TypePermissionNames.CREATE,t.TypePermissionNames.CHANGE,t.TypePermissionNames.READ,t.TypePermissionNames.REMOVE].join(",");const s=yield this.resource.queryByPost({principalUid:o},{types:e.join(","),permissionNames:n});return s.permissionsList||[]}catch(t){if(t){this.logService.error(`TypePermissionsRestService - no composed types ${e} exist`)}return Promise.reject(t)}}))}getPermissionByNameAndResult(e,t){const o=e.permissions.find((e=>e.key===t));return JSON.parse(o.value)}getPermissionsForTypesAndName(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getAllPermissionsForTypes(e);return o.reduce(((e,o)=>{if(o.permissions){e[o.id]=this.getPermissionByNameAndResult(o,t)}return e}),{})}))}};t.TypePermissionsRestService.$inject=["logService","sessionService","restServiceFactory"];__decorate([n.Cached({actions:[n.rarelyChangingContent],tags:[n.authorizationEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Promise)],t.TypePermissionsRestService.prototype,"getAllPermissionsForTypes",null);t.TypePermissionsRestService=__decorate([n.SeDowngradeService(),__metadata("design:paramtypes",[n.LogService,n.ISessionService,n.IRestServiceFactory])],t.TypePermissionsRestService);var _e;(function(e){e["READ"]="read";e["CHANGE"]="change"})(_e||(_e={}));t.AttributePermissionsRestService=class AttributePermissionsRestService{constructor(e,t,o){this.sessionService=t;this.logService=o;this.ATTRIBUTE_PERMISSIONS_URI="/permissionswebservices/v1/permissions/attributes/search";this.permissionRestService=e.get(this.ATTRIBUTE_PERMISSIONS_URI)}hasReadPermissionOnAttributesInType(e,t){return this.getPermissionsForAttributesAndNameByType(e,t,_e.READ)}hasChangePermissionOnAttributesInType(e,t){return this.getPermissionsForAttributesAndNameByType(e,t,_e.CHANGE)}getAllPermissionsForAttributes(e){return __awaiter(this,void 0,void 0,(function*(){if(e.length<=0){return[]}const t=yield this.sessionService.getCurrentUsername();if(!t){return[]}try{const o=yield this.permissionRestService.queryByPost({principalUid:t},{attributes:e.join(","),permissionNames:_e.CHANGE+","+_e.READ});return o.permissionsList||[]}catch(t){if(t){this.logService.error(`AttributePermissionsRestService - couldn't retrieve attribute permissions ${e}`)}return[]}}))}getPermissionsForAttributesAndNameByType(e,t,o){const n=t.map((t=>e+"."+t));return this.getPermissionsForAttributesAndName(n,o).then((t=>t[e]))}getPermissionsForAttributesAndName(e,t){return __awaiter(this,void 0,void 0,(function*(){const o=yield this.getAllPermissionsForAttributes(e);const n=this.concatPermissionsNotFound(e,o);return n.reduce(((e,o)=>{if(o.permissions){const n=this.parsePermissionsResultId(o.id);if(!e[n.type]){e[n.type]={}}e[n.type][n.attribute]=this.getPermissionByNameFromResult(o,t)}return e}),{})}))}parsePermissionsResultId(e){const t=e.split(".");if(t.length!==2){throw new Error("AttributePermissionsRestService - Received invalid attribute permissions")}return{type:t[0],attribute:t[1]}}getPermissionByNameFromResult(e,t){const o=e.permissions.find((e=>e.key===t));return JSON.parse(o.value)}concatPermissionsNotFound(e,t){const o=t.map((e=>e.id));const n=u.difference(e,o);return t.concat(n.map((e=>({id:e,permissions:[{key:_e.READ,value:"false"},{key:_e.CHANGE,value:"false"}]}))))}};t.AttributePermissionsRestService.$inject=["restServiceFactory","sessionService","logService"];__decorate([n.Cached({actions:[n.rarelyChangingContent],tags:[n.authorizationEvictionTag]}),__metadata("design:type",Function),__metadata("design:paramtypes",[Array]),__metadata("design:returntype",Promise)],t.AttributePermissionsRestService.prototype,"getAllPermissionsForAttributes",null);t.AttributePermissionsRestService=__decorate([n.SeDowngradeService(),__metadata("design:paramtypes",[n.IRestServiceFactory,n.ISessionService,n.LogService])],t.AttributePermissionsRestService);class IRemoveComponentService{removeComponent(e){"proxyFunction";return null}}class ISlotVisibilityService{getHiddenComponents(e){"proxyFunction";return null}reloadSlotsInfo(){"proxyFunction";return null}}class IEditorEnablerService{enableForComponents(e){"proxyFunction"}onClickEditButton({slotUuid:e,componentAttributes:t}){"proxyFunction";return null}isSlotEditableForNonExternalComponent(e){"proxyFunction";return null}}class IComponentMenuConditionAndCallbackService{externalCondition(e){"proxyFunction";return null}sharedCondition(e){"proxyFunction";return null}removeCondition(e){"proxyFunction";return null}removeCallback(e,t){"proxyFunction";return null}cloneCondition(e){"proxyFunction";return null}cloneCallback(e){"proxyFunction";return null}editConditionForHiddenComponent(e){"proxyFunction";return null}}window.__smartedit__.addDecoratorPayload("Component","ActionableAlertComponent",{selector:"se-actionable-alert",changeDetection:a.ChangeDetectionStrategy.OnPush,template:`<div>\n        <p>{{ description | translate: descriptionDetails }}</p>\n        <div>\n            <a href (click)="onHyperLinkClick($event)">{{\n                hyperlinkLabel | translate: hyperlinkDetails\n            }}</a>\n        </div>\n    </div> `});t.ActionableAlertComponent=class ActionableAlertComponent{constructor(){this.hyperLinkClick=new a.EventEmitter}onHyperLinkClick(e){e.preventDefault();this.hyperLinkClick.emit()}};__decorate([a.Input(),__metadata("design:type",String)],t.ActionableAlertComponent.prototype,"description",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.ActionableAlertComponent.prototype,"descriptionDetails",void 0);__decorate([a.Input(),__metadata("design:type",String)],t.ActionableAlertComponent.prototype,"hyperlinkLabel",void 0);__decorate([a.Input(),__metadata("design:type",Object)],t.ActionableAlertComponent.prototype,"hyperlinkDetails",void 0);__decorate([a.Output(),__metadata("design:type",a.EventEmitter)],t.ActionableAlertComponent.prototype,"hyperLinkClick",void 0);t.ActionableAlertComponent=__decorate([a.Component({selector:"se-actionable-alert",changeDetection:a.ChangeDetectionStrategy.OnPush,template:`<div>\n        <p>{{ description | translate: descriptionDetails }}</p>\n        <div>\n            <a href (click)="onHyperLinkClick($event)">{{\n                hyperlinkLabel | translate: hyperlinkDetails\n            }}</a>\n        </div>\n    </div> `}),__metadata("design:paramtypes",[])],t.ActionableAlertComponent);window.__smartedit__.addDecoratorPayload("Component","SharedComponentButtonComponent",{selector:"shared-component-button",template:`<div class="se-ctx-menu-btn__msg"><div class="se-ctx-menu-btn__msg-title" translate="se.cms.contextmenu.shared.component.info.title"></div><div *ngIf="isReady" class="se-ctx-menu-btn__msg-description" [translate]="message"></div><se-spinner [isSpinning]="!isReady"></se-spinner></div>`,styles:[`.se-ctx-menu-btn__msg{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;box-shadow:0 0 4px 0 #d9d9d9;font-size:1.1428571429rem;line-height:1.25;font-weight:400;white-space:normal;padding:20px;width:250px}.se-ctx-menu-btn__msg::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-ctx-menu-btn__msg::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-ctx-menu-btn__msg::after,.se-ctx-menu-btn__msg::before{left:14px}.se-ctx-menu-btn__msg-title{font-weight:700;color:#32363a;margin-bottom:8px}.se-ctx-menu-btn__msg-description{color:#51555a}`],changeDetection:a.ChangeDetectionStrategy.OnPush});t.SharedComponentButtonComponent=class SharedComponentButtonComponent{constructor(e,t,o){this.contextAwareEditableItemService=t;this.cdr=o;this.isReady=false;({componentAttributes:{smarteditComponentId:this.smarteditComponentId}}=e)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.contextAwareEditableItemService.isItemEditable(this.smarteditComponentId);this.message=`se.cms.contextmenu.shared.component.info.msg${e?".editable":""}`;this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};t.SharedComponentButtonComponent=__decorate([a.Component({selector:"shared-component-button",template:`<div class="se-ctx-menu-btn__msg"><div class="se-ctx-menu-btn__msg-title" translate="se.cms.contextmenu.shared.component.info.title"></div><div *ngIf="isReady" class="se-ctx-menu-btn__msg-description" [translate]="message"></div><se-spinner [isSpinning]="!isReady"></se-spinner></div>`,styles:[`.se-ctx-menu-btn__msg{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;box-shadow:0 0 4px 0 #d9d9d9;font-size:1.1428571429rem;line-height:1.25;font-weight:400;white-space:normal;padding:20px;width:250px}.se-ctx-menu-btn__msg::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-ctx-menu-btn__msg::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-ctx-menu-btn__msg::after,.se-ctx-menu-btn__msg::before{left:14px}.se-ctx-menu-btn__msg-title{font-weight:700;color:#32363a;margin-bottom:8px}.se-ctx-menu-btn__msg-description{color:#51555a}`],changeDetection:a.ChangeDetectionStrategy.OnPush}),__param(0,a.Inject(n.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,IContextAwareEditableItemService,a.ChangeDetectorRef])],t.SharedComponentButtonComponent);window.__smartedit__.addDecoratorPayload("Component","ExternalComponentButtonComponent",{selector:"se-external-component-button",template:`<div class="se-ctx-menu-btn__msg" *ngIf="isReady">{{ catalogVersion }}</div>`,styles:[`.se-ctx-menu-btn__msg{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;box-shadow:0 0 4px 0 #d9d9d9;font-size:1.1428571429rem;line-height:1.25;font-weight:400;white-space:normal;padding:20px;width:250px}.se-ctx-menu-btn__msg::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-ctx-menu-btn__msg::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-ctx-menu-btn__msg::after,.se-ctx-menu-btn__msg::before{left:14px}.se-ctx-menu-btn__msg-title{font-weight:700;color:#32363a;margin-bottom:8px}.se-ctx-menu-btn__msg-description{color:#51555a}`],providers:[n.L10nPipe],changeDetection:a.ChangeDetectionStrategy.OnPush});t.ExternalComponentButtonComponent=class ExternalComponentButtonComponent{constructor(e,t,o,n){this.catalogService=t;this.l10nPipe=o;this.cdr=n;this.isReady=false;({componentAttributes:{smarteditCatalogVersionUuid:this.catalogVersionUuid}}=e)}ngOnInit(){return __awaiter(this,void 0,void 0,(function*(){const e=yield this.catalogService.getCatalogVersionByUuid(this.catalogVersionUuid);const t=yield this.l10nPipe.transform(e.catalogName).pipe(g.take(1)).toPromise();this.catalogVersion=`${t} (${e.version})`;this.isReady=true;if(!this.cdr.destroyed){this.cdr.detectChanges()}}))}};t.ExternalComponentButtonComponent=__decorate([a.Component({selector:"se-external-component-button",template:`<div class="se-ctx-menu-btn__msg" *ngIf="isReady">{{ catalogVersion }}</div>`,styles:[`.se-ctx-menu-btn__msg{box-shadow:0 6px 12px rgba(0,0,0,.175);background-color:#fff;border-radius:4px!important;min-width:100px;width:fit-content;position:absolute;border:1px solid #d9d9d9;z-index:2000;top:96%;box-shadow:0 0 4px 0 #d9d9d9;font-size:1.1428571429rem;line-height:1.25;font-weight:400;white-space:normal;padding:20px;width:250px}.se-ctx-menu-btn__msg::before{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#d9d9d9;border-bottom-color:var(var(--fd-color-neutral-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-8px}.se-ctx-menu-btn__msg::after{height:0;width:0;border-style:solid;border-width:0 8px 8px 8px;border-bottom-color:#fff;border-bottom-color:var(var(--fd-color-background-4));border-left-color:transparent;border-right-color:transparent;content:"";position:absolute;top:-7px}.se-ctx-menu-btn__msg::after,.se-ctx-menu-btn__msg::before{left:14px}.se-ctx-menu-btn__msg-title{font-weight:700;color:#32363a;margin-bottom:8px}.se-ctx-menu-btn__msg-description{color:#51555a}`],providers:[n.L10nPipe],changeDetection:a.ChangeDetectionStrategy.OnPush}),__param(0,a.Inject(n.CONTEXTUAL_MENU_ITEM_DATA)),__metadata("design:paramtypes",[Object,n.ICatalogService,n.L10nPipe,a.ChangeDetectorRef])],t.ExternalComponentButtonComponent);class IComponentVisibilityAlertService{checkAndAlertOnComponentVisibility(e){"proxyFunction";return null}}window.__smartedit__.addDecoratorPayload("Component","ComponentVisibilityAlertComponent",{selector:"se-component-visibility-alert",template:`<div>\n        <p [translate]="message"></p>\n        <div>\n            <a (click)="onClick()" [translate]="hyperlinkLabel"></a>\n        </div>\n    </div>`,changeDetection:a.ChangeDetectionStrategy.OnPush});t.ComponentVisibilityAlertComponent=class ComponentVisibilityAlertComponent{constructor(e,t,o){this.editorModalService=e;this.componentVisibilityAlertService=t;this.alertRef=o;this.hyperlinkLabel="se.cms.component.visibility.alert.hyperlink";({component:this.component,message:this.message}=this.alertRef.data)}onClick(){return __awaiter(this,void 0,void 0,(function*(){this.alertRef.dismiss();this.checkProvidedArguments(this.component);const e=yield this.editorModalService.openAndRerenderSlot(this.component.itemType,this.component.itemId,"visibilityTab");this.componentVisibilityAlertService.checkAndAlertOnComponentVisibility({itemId:e.uuid,itemType:e.itemtype,catalogVersion:e.catalogVersion,restricted:e.restricted,slotId:this.component.slotId,visible:e.visible})}))}checkProvidedArguments(e){const t=[e.itemId,e.itemType,e.slotId];const o=t.filter((e=>e&&!n.stringUtils.isBlank(e)));if(o.length!==t.length){throw new Error("componentVisibilityAlertService.checkAndAlertOnComponentVisibility - missing properly typed parameters")}}};t.ComponentVisibilityAlertComponent.$inject=["editorModalService","componentVisibilityAlertService","alertRef"];t.ComponentVisibilityAlertComponent=__decorate([n.SeDowngradeComponent(),a.Component({selector:"se-component-visibility-alert",template:`<div>\n        <p [translate]="message"></p>\n        <div>\n            <a (click)="onClick()" [translate]="hyperlinkLabel"></a>\n        </div>\n    </div>`,changeDetection:a.ChangeDetectionStrategy.OnPush}),__metadata("design:paramtypes",[n.IEditorModalService,IComponentVisibilityAlertService,v.AlertRef])],t.ComponentVisibilityAlertComponent);t.ComponentVisibilityAlertModule=class ComponentVisibilityAlertModule{};t.ComponentVisibilityAlertModule=__decorate([a.NgModule({imports:[n.TranslationModule.forChild()],declarations:[t.ComponentVisibilityAlertComponent],entryComponents:[t.ComponentVisibilityAlertComponent]})],t.ComponentVisibilityAlertModule);t.CmsCommonsModule=class CmsCommonsModule{};t.CmsCommonsModule=__decorate([a.NgModule({imports:[r.CommonModule,n.SpinnerModule,s.TranslateModule.forChild(),t.SynchronizationPanelModule,t.ComponentVisibilityAlertModule],providers:[t.AttributePermissionsRestService,t.CMSTimeService,t.SynchronizationService,t.TypePermissionsRestService,t.ComponentService,t.SynchronizationResourceService,t.AssetsService],declarations:[t.ActionableAlertComponent,t.SharedComponentButtonComponent,t.ExternalComponentButtonComponent],entryComponents:[t.SharedComponentButtonComponent,t.ExternalComponentButtonComponent],exports:[t.ActionableAlertComponent,t.SharedComponentButtonComponent,t.ExternalComponentButtonComponent,t.SynchronizationPanelModule,t.ComponentVisibilityAlertModule]})],t.CmsCommonsModule);(function(e){e["DRAG_STARTED"]="CMS_DRAG_STARTED";e["DRAG_STOPPED"]="CMS_DRAG_STOPPED";e["DRAG_OVER"]="CMS_DRAG_OVER";e["DRAG_LEAVE"]="CMS_DRAG_LEAVE"})(t.DRAG_AND_DROP_EVENTS||(t.DRAG_AND_DROP_EVENTS={}));const fe="COMPONENT_CREATED_EVENT";const ye="COMPONENT_REMOVED_EVENT";const Se="COMPONENT_UPDATED_EVENT";const Ce="CMSITEMS_UPDATE";const be="EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV";const Ie="CMSNavigationNode";const we="root";const Ee="/cmssmartedit/images";t.CATALOG_SYNC_INTERVAL_IN_MILLISECONDS=he;t.CMSITEMS_UPDATE_EVENT=Ce;t.COMPONENT_CREATED_EVENT=fe;t.COMPONENT_REMOVED_EVENT=ye;t.COMPONENT_UPDATED_EVENT=Se;t.CONTENT_SLOTS_TYPE_RESTRICTION_RESOURCE_URI=V;t.CONTENT_SLOT_TYPE_RESTRICTION_RESOURCE_URI=F;t.CONTEXTUAL_PAGES_RESTRICTIONS_RESOURCE_URI=oe;t.CONTEXT_CATALOG=E;t.CONTEXT_CATALOG_VERSION=T;t.CONTEXT_SITE_ID=P;t.DEFAULT_SYNCHRONIZATION_EVENT=me;t.DEFAULT_SYNCHRONIZATION_POLLING=pe;t.DEFAULT_SYNCHRONIZATION_STATUSES=de;t.EVENT_PAGE_STATUS_UPDATED_IN_ACTIVE_CV=be;t.GET_PAGE_SYNCHRONIZATION_RESOURCE_URI=le;t.IComponentMenuConditionAndCallbackService=IComponentMenuConditionAndCallbackService;t.IComponentSharedService=IComponentSharedService;t.IComponentVisibilityAlertService=IComponentVisibilityAlertService;t.IContextAwareEditableItemService=IContextAwareEditableItemService;t.IEditorEnablerService=IEditorEnablerService;t.IMAGES_URL=Ee;t.IPageContentSlotsComponentsRestService=IPageContentSlotsComponentsRestService;t.IRemoveComponentService=IRemoveComponentService;t.ISlotVisibilityService=ISlotVisibilityService;t.ITEMS_RESOURCE_URI=D;t.NAVIGATION_MANAGEMENT_ENTRIES_RESOURCE_URI=te;t.NAVIGATION_MANAGEMENT_ENTRY_TYPES_RESOURCE_URI=ie;t.NAVIGATION_MANAGEMENT_PAGE_PATH=J;t.NAVIGATION_MANAGEMENT_RESOURCE_URI=ee;t.NAVIGATION_NODE_ROOT_NODE_UID=we;t.NAVIGATION_NODE_TYPECODE=Ie;t.PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI=k;t.PAGES_CONTENT_SLOT_RESOURCE_URI=Y;t.PAGES_LIST_RESOURCE_URI=U;t.PAGES_RESTRICTIONS_RESOURCE_URI=ne;t.PAGE_CONTEXT_CATALOG=A;t.PAGE_CONTEXT_CATALOG_VERSION=O;t.PAGE_LIST_PATH=$;t.PAGE_TEMPLATES_URI=X;t.PAGE_TYPES_RESTRICTION_TYPES_URI=ae;t.PAGE_TYPES_URI=re;t.POST_PAGE_SYNCHRONIZATION_RESOURCE_URI=ce;t.RESTRICTION_TYPES_URI=se;t.SynchronizationUtils=SynchronizationUtils;t.TRASHED_PAGE_LIST_PATH=K;t.TYPES_RESOURCE_URI=x;t.WORKFLOW_CREATED_EVENT=f;t.WORKFLOW_FINISHED_EVENT=S;t.slotEvictionTag=w;t.synchronizationUtils=ge;t.workflowCompletedEvictionTag=b;t.workflowCreatedEvictionTag=C;t.workflowTasksMenuOpenedEvictionTag=I}});